
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.41390377283096313
distance x is tensor(111.8828, device='cuda:0')
benign distance is  tensor(111.8828, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8500365018844604
distance x is tensor(121.1203, device='cuda:0')
benign distance is  tensor(121.1203, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3998189866542816
distance x is tensor(123.4599, device='cuda:0')
benign distance is  tensor(123.4599, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5411497950553894
distance x is tensor(114.4381, device='cuda:0')
benign distance is  tensor(114.4381, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7954856157302856
distance x is tensor(100.1236, device='cuda:0')
benign distance is  tensor(100.1236, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5882387161254883
distance x is tensor(116.2220, device='cuda:0')
benign distance is  tensor(116.2220, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2531020641326904
distance x is tensor(113.1066, device='cuda:0')
benign distance is  tensor(113.1066, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3524075448513031
distance x is tensor(124.6218, device='cuda:0')
benign distance is  tensor(124.6218, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4399486184120178
distance x is tensor(136.6943, device='cuda:0')
benign distance is  tensor(136.6943, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5924867391586304
distance x is tensor(134.9669, device='cuda:0')
benign distance is  tensor(134.9669, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5790435075759888
distance x is tensor(121.8152, device='cuda:0')
benign distance is  tensor(121.8152, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3244841396808624
distance x is tensor(126.5759, device='cuda:0')
benign distance is  tensor(126.5759, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4379059374332428
distance x is tensor(132.9319, device='cuda:0')
benign distance is  tensor(132.9319, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3774985074996948
distance x is tensor(144.9664, device='cuda:0')
benign distance is  tensor(144.9664, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7954835295677185
distance x is tensor(134.9229, device='cuda:0')
benign distance is  tensor(134.9229, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.2529158592224121
distance x is tensor(143.0085, device='cuda:0')
benign distance is  tensor(143.0085, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3132694959640503
distance x is tensor(124.2953, device='cuda:0')
benign distance is  tensor(124.2953, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6707582473754883
distance x is tensor(151.3176, device='cuda:0')
benign distance is  tensor(151.3176, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2456493079662323
distance x is tensor(123.7806, device='cuda:0')
benign distance is  tensor(123.7806, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.6497911810874939
distance x is tensor(126.4466, device='cuda:0')
benign distance is  tensor(126.4466, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.109455406665802
distance x is tensor(128.9228, device='cuda:0')
benign distance is  tensor(128.9228, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.12450821697711945
distance x is tensor(120.7088, device='cuda:0')
benign distance is  tensor(120.7088, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.46703124046325684
distance x is tensor(139.1115, device='cuda:0')
benign distance is  tensor(139.1115, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8832862973213196
distance x is tensor(132.2157, device='cuda:0')
benign distance is  tensor(132.2157, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3822680413722992
distance x is tensor(142.7541, device='cuda:0')
benign distance is  tensor(142.7541, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.4018000066280365
distance x is tensor(121.0391, device='cuda:0')
benign distance is  tensor(121.0391, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.39193999767303467
distance x is tensor(140.2959, device='cuda:0')
benign distance is  tensor(140.2959, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.2419677972793579
distance x is tensor(134.4691, device='cuda:0')
benign distance is  tensor(134.4691, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.63094562292099
distance x is tensor(127.5842, device='cuda:0')
benign distance is  tensor(127.5842, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.3875625729560852
distance x is tensor(136.4177, device='cuda:0')
benign distance is  tensor(136.4177, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.39054402709007263
distance x is tensor(123.8664, device='cuda:0')
benign distance is  tensor(123.8664, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6633861064910889
distance x is tensor(131.2621, device='cuda:0')
benign distance is  tensor(131.2621, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7459107637405396
distance x is tensor(142.0739, device='cuda:0')
benign distance is  tensor(142.0739, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.371865451335907
distance x is tensor(126.8188, device='cuda:0')
benign distance is  tensor(126.8188, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.3056625425815582
distance x is tensor(138.2051, device='cuda:0')
benign distance is  tensor(138.2051, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.04413565248250961
distance x is tensor(123.9711, device='cuda:0')
benign distance is  tensor(123.9711, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.743203341960907
distance x is tensor(130.6306, device='cuda:0')
benign distance is  tensor(130.6306, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.31733566522598267
distance x is tensor(124.3520, device='cuda:0')
benign distance is  tensor(124.3520, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.21968498826026917
distance x is tensor(127.5412, device='cuda:0')
benign distance is  tensor(127.5412, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.32102060317993164
distance x is tensor(130.4220, device='cuda:0')
benign distance is  tensor(130.4220, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.1474383920431137
distance x is tensor(127.9218, device='cuda:0')
benign distance is  tensor(127.9218, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.3896600604057312
distance x is tensor(129.2429, device='cuda:0')
benign distance is  tensor(129.2429, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.18994341790676117
distance x is tensor(127.5186, device='cuda:0')
benign distance is  tensor(127.5186, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.08647648245096207
distance x is tensor(134.1013, device='cuda:0')
benign distance is  tensor(134.1013, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.44697532057762146
distance x is tensor(134.9017, device='cuda:0')
benign distance is  tensor(134.9017, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5207599401473999
distance x is tensor(127.5319, device='cuda:0')
benign distance is  tensor(127.5319, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9671859741210938
distance x is tensor(130.7295, device='cuda:0')
benign distance is  tensor(130.7295, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.2161109447479248
distance x is tensor(137.1254, device='cuda:0')
benign distance is  tensor(137.1254, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.3398781716823578
mal_entropy is 0.17438490688800812
user_PLR len size 20
counter_tensor is  tensor([15., 15., 15., 15., 14., 15., 14., 14., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([0.0006, 0.0006, 0.0006, 0.0006, 0.0002, 0.0006, 0.0002, 0.0002, 0.0830,
        0.0830, 0.0830, 0.0830, 0.0830, 0.0830, 0.0830, 0.0830, 0.0830, 0.0830,
        0.0830, 0.0830])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 88.31% 

Test Accuracy: 87.22% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.025439739227295
distance x is tensor(123.1556, device='cuda:0')
benign distance is  tensor(123.1556, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.746477484703064
distance x is tensor(129.0800, device='cuda:0')
benign distance is  tensor(129.0800, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6450098156929016
distance x is tensor(127.6926, device='cuda:0')
benign distance is  tensor(127.6926, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4535500109195709
distance x is tensor(114.9275, device='cuda:0')
benign distance is  tensor(114.9275, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6309848427772522
distance x is tensor(104.7730, device='cuda:0')
benign distance is  tensor(104.7730, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0474379062652588
distance x is tensor(118.5129, device='cuda:0')
benign distance is  tensor(118.5129, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6456598043441772
distance x is tensor(120.6328, device='cuda:0')
benign distance is  tensor(120.6328, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.16449250280857086
distance x is tensor(131.9604, device='cuda:0')
benign distance is  tensor(131.9604, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.7090346217155457
mal_entropy is 0.3129977285861969
user_PLR len size 28
counter_tensor is  tensor([13., 12.,  1., 22., 13., 13., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 15., 12., 12., 15., 27., 12., 26.])
count_res tensor([6.0482e-07, 2.2250e-07, 3.7161e-12, 4.9009e-03, 6.0482e-07, 6.0482e-07,
        2.2250e-07, 2.2250e-07, 1.2148e-05, 1.2148e-05, 1.2148e-05, 1.2148e-05,
        1.2148e-05, 1.2148e-05, 1.2148e-05, 1.2148e-05, 1.2148e-05, 1.2148e-05,
        1.2148e-05, 1.2148e-05, 2.2250e-07, 4.4691e-06, 2.2250e-07, 2.2250e-07,
        4.4691e-06, 7.2736e-01, 2.2250e-07, 2.6758e-01])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 87.76% 

Test Accuracy: 86.84% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.47030848264694214
distance x is tensor(124.8711, device='cuda:0')
benign distance is  tensor(124.8711, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.719333827495575
distance x is tensor(128.0410, device='cuda:0')
benign distance is  tensor(128.0410, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.049407720565796
distance x is tensor(138.4828, device='cuda:0')
benign distance is  tensor(138.4828, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3211815059185028
distance x is tensor(131.8704, device='cuda:0')
benign distance is  tensor(131.8704, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.41493168473243713
distance x is tensor(134.2767, device='cuda:0')
benign distance is  tensor(134.2767, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1183996200561523
distance x is tensor(127.1610, device='cuda:0')
benign distance is  tensor(127.1610, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.23126542568206787
distance x is tensor(132.9788, device='cuda:0')
benign distance is  tensor(132.9788, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.37738198041915894
distance x is tensor(129.9265, device='cuda:0')
benign distance is  tensor(129.9265, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.85235995054245
distance x is tensor(147.9780, device='cuda:0')
benign distance is  tensor(147.9780, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.28766611218452454
distance x is tensor(143.5155, device='cuda:0')
benign distance is  tensor(143.5155, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0807154178619385
distance x is tensor(133.3214, device='cuda:0')
benign distance is  tensor(133.3214, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.30935949087142944
distance x is tensor(130.9147, device='cuda:0')
benign distance is  tensor(130.9147, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5838386416435242
distance x is tensor(132.3735, device='cuda:0')
benign distance is  tensor(132.3735, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4504488408565521
distance x is tensor(111.0077, device='cuda:0')
benign distance is  tensor(111.0077, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3867098391056061
distance x is tensor(136.1985, device='cuda:0')
benign distance is  tensor(136.1985, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6724860668182373
distance x is tensor(130.1448, device='cuda:0')
benign distance is  tensor(130.1448, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.6414266228675842
mal_entropy is 0.12390267848968506
user_PLR len size 28
counter_tensor is  tensor([27., 13., 13., 13.,  0., 12., 13., 13., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 13., 13., 13., 27., 13., 13., 16., 27.])
count_res tensor([3.3331e-01, 2.7716e-07, 2.7716e-07, 2.7716e-07, 6.2646e-13, 1.0196e-07,
        2.7716e-07, 2.7716e-07, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06,
        5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06,
        5.5668e-06, 5.5668e-06, 2.7716e-07, 2.7716e-07, 2.7716e-07, 3.3331e-01,
        2.7716e-07, 2.7716e-07, 5.5668e-06, 3.3331e-01])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 88.52% 

Test Accuracy: 88.12% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5491360425949097
distance x is tensor(104.5553, device='cuda:0')
benign distance is  tensor(104.5553, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5072048902511597
distance x is tensor(116.6784, device='cuda:0')
benign distance is  tensor(116.6784, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.23783020675182343
distance x is tensor(128.5661, device='cuda:0')
benign distance is  tensor(128.5661, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6814666986465454
distance x is tensor(124.1985, device='cuda:0')
benign distance is  tensor(124.1985, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3812847137451172
distance x is tensor(110.2360, device='cuda:0')
benign distance is  tensor(110.2360, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3210218548774719
distance x is tensor(126.7688, device='cuda:0')
benign distance is  tensor(126.7688, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2821117043495178
distance x is tensor(133.7224, device='cuda:0')
benign distance is  tensor(133.7224, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7881730794906616
distance x is tensor(137.0339, device='cuda:0')
benign distance is  tensor(137.0339, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3203856348991394
distance x is tensor(136.3475, device='cuda:0')
benign distance is  tensor(136.3475, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5680273771286011
distance x is tensor(150.0045, device='cuda:0')
benign distance is  tensor(150.0045, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.1349875926971436
distance x is tensor(142.6643, device='cuda:0')
benign distance is  tensor(142.6643, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3336564898490906
distance x is tensor(121.4958, device='cuda:0')
benign distance is  tensor(121.4958, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.20546777546405792
distance x is tensor(135.2904, device='cuda:0')
benign distance is  tensor(135.2904, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.853923499584198
distance x is tensor(134.9994, device='cuda:0')
benign distance is  tensor(134.9994, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.17984595894813538
distance x is tensor(146.5910, device='cuda:0')
benign distance is  tensor(146.5910, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.13733363151550293
distance x is tensor(110.4112, device='cuda:0')
benign distance is  tensor(110.4112, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8000000005000001
mal_loss is 0.4080487787723541
mal_entropy is 0.21109639108181
user_PLR len size 36
counter_tensor is  tensor([ 1., 13.,  0., 18.,  7., 13., 12., 35., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 27., 12., 30., 13., 12., 24., 12., 14.,
        35., 35., 34., 35., 12., 12.,  0., 18.])
count_res tensor([3.9174e-16, 6.3757e-11, 1.4411e-16, 9.4623e-09, 1.5804e-13, 6.3757e-11,
        2.3455e-11, 2.2856e-01, 3.8174e-06, 3.8174e-06, 3.8174e-06, 3.8174e-06,
        3.8174e-06, 3.8174e-06, 3.8174e-06, 3.8174e-06, 3.8174e-06, 3.8174e-06,
        3.8174e-06, 3.8174e-06, 7.6674e-05, 2.3455e-11, 1.5400e-03, 6.3757e-11,
        2.3455e-11, 3.8174e-06, 2.3455e-11, 1.7331e-10, 2.2856e-01, 2.2856e-01,
        8.4083e-02, 2.2856e-01, 2.3455e-11, 2.3455e-11, 1.4411e-16, 9.4623e-09])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 88.88% 

Test Accuracy: 87.99% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6111857295036316
distance x is tensor(116.5202, device='cuda:0')
benign distance is  tensor(116.5202, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1067047119140625
distance x is tensor(124.6040, device='cuda:0')
benign distance is  tensor(124.6040, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.11066029965877533
distance x is tensor(129.6246, device='cuda:0')
benign distance is  tensor(129.6246, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.918205738067627
distance x is tensor(125.8561, device='cuda:0')
benign distance is  tensor(125.8561, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.33094674348831177
distance x is tensor(103.4814, device='cuda:0')
benign distance is  tensor(103.4814, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5862213373184204
distance x is tensor(130.3293, device='cuda:0')
benign distance is  tensor(130.3293, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.10332200676202774
distance x is tensor(115.0300, device='cuda:0')
benign distance is  tensor(115.0300, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.24652311205863953
distance x is tensor(117.0740, device='cuda:0')
benign distance is  tensor(117.0740, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4538334012031555
distance x is tensor(126.2362, device='cuda:0')
benign distance is  tensor(126.2362, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6515395045280457
distance x is tensor(130.9290, device='cuda:0')
benign distance is  tensor(130.9290, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1138447523117065
distance x is tensor(127.2967, device='cuda:0')
benign distance is  tensor(127.2967, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9469963312149048
distance x is tensor(122.0786, device='cuda:0')
benign distance is  tensor(122.0786, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4575679302215576
distance x is tensor(125.1176, device='cuda:0')
benign distance is  tensor(125.1176, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4500042796134949
distance x is tensor(114.5442, device='cuda:0')
benign distance is  tensor(114.5442, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5841017365455627
distance x is tensor(135.5718, device='cuda:0')
benign distance is  tensor(135.5718, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9739185571670532
distance x is tensor(120.8176, device='cuda:0')
benign distance is  tensor(120.8176, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.5755010843276978
distance x is tensor(135.2116, device='cuda:0')
benign distance is  tensor(135.2116, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.2278902530670166
distance x is tensor(130.8397, device='cuda:0')
benign distance is  tensor(130.8397, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.31332579255104065
distance x is tensor(131.8490, device='cuda:0')
benign distance is  tensor(131.8490, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.2141033113002777
distance x is tensor(141.8135, device='cuda:0')
benign distance is  tensor(141.8135, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.2575815916061401
distance x is tensor(121.0380, device='cuda:0')
benign distance is  tensor(121.0380, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.44976621866226196
distance x is tensor(133.4875, device='cuda:0')
benign distance is  tensor(133.4875, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.10375483334064484
distance x is tensor(133.6339, device='cuda:0')
benign distance is  tensor(133.6339, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.2690262794494629
distance x is tensor(133.0044, device='cuda:0')
benign distance is  tensor(133.0044, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.48686009645462036
mal_entropy is 0.08750351518392563
user_PLR len size 28
counter_tensor is  tensor([14., 17., 12., 15., 12., 12., 12., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 21., 12., 12., 12., 12.,  0., 12.])
count_res tensor([1.1286e-06, 2.2669e-05, 1.5274e-07, 3.0679e-06, 1.5274e-07, 1.5274e-07,
        1.5274e-07, 4.9932e-01, 8.3394e-06, 8.3394e-06, 8.3394e-06, 8.3394e-06,
        8.3394e-06, 8.3394e-06, 8.3394e-06, 8.3394e-06, 8.3394e-06, 8.3394e-06,
        8.3394e-06, 8.3394e-06, 4.9932e-01, 1.2377e-03, 1.5274e-07, 1.5274e-07,
        1.5274e-07, 1.5274e-07, 9.3848e-13, 1.5274e-07])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 88.83% 

Test Accuracy: 87.61% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4888822138309479
distance x is tensor(121.0573, device='cuda:0')
benign distance is  tensor(121.0573, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.522086501121521
distance x is tensor(125.1411, device='cuda:0')
benign distance is  tensor(125.1411, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.22910937666893005
distance x is tensor(134.5428, device='cuda:0')
benign distance is  tensor(134.5428, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5246405601501465
distance x is tensor(127.2397, device='cuda:0')
benign distance is  tensor(127.2397, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3541031777858734
distance x is tensor(117.6825, device='cuda:0')
benign distance is  tensor(117.6825, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9215601086616516
distance x is tensor(129.6715, device='cuda:0')
benign distance is  tensor(129.6715, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.28299403190612793
distance x is tensor(125.6182, device='cuda:0')
benign distance is  tensor(125.6182, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.19628538191318512
distance x is tensor(106.6964, device='cuda:0')
benign distance is  tensor(106.6964, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3414284586906433
distance x is tensor(103.3880, device='cuda:0')
benign distance is  tensor(103.3880, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.11710792779922485
distance x is tensor(143.2639, device='cuda:0')
benign distance is  tensor(143.2639, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.42039579153060913
distance x is tensor(139.8771, device='cuda:0')
benign distance is  tensor(139.8771, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.28575173020362854
distance x is tensor(137.8520, device='cuda:0')
benign distance is  tensor(137.8520, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5237277746200562
distance x is tensor(132.6603, device='cuda:0')
benign distance is  tensor(132.6603, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.1750684231519699
distance x is tensor(139.6288, device='cuda:0')
benign distance is  tensor(139.6288, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.12341602146625519
distance x is tensor(128.8933, device='cuda:0')
benign distance is  tensor(128.8933, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.33364859223365784
distance x is tensor(132.2659, device='cuda:0')
benign distance is  tensor(132.2659, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.6485242247581482
mal_entropy is 0.1360388845205307
user_PLR len size 44
counter_tensor is  tensor([16., 43., 40.,  1., 43., 40.,  1., 18., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 23., 32., 43., 39.,  0., 43.,  0., 38.,
        42., 38., 22., 43., 36., 38.,  0., 38., 41., 42., 12.,  1.,  0., 34.,
        12.,  0.])
count_res tensor([3.1236e-13, 1.6619e-01, 8.2741e-03, 9.5552e-20, 1.6619e-01, 8.2741e-03,
        9.5552e-20, 2.3080e-12, 2.7757e-06, 2.7757e-06, 2.7757e-06, 2.7757e-06,
        2.7757e-06, 2.7757e-06, 2.7757e-06, 2.7757e-06, 2.7757e-06, 2.7757e-06,
        2.7757e-06, 2.7757e-06, 3.4254e-10, 2.7757e-06, 1.6619e-01, 3.0439e-03,
        3.5151e-20, 1.6619e-01, 3.5151e-20, 1.1198e-03, 6.1138e-02, 1.1198e-03,
        1.2601e-10, 1.6619e-01, 1.5155e-04, 1.1198e-03, 3.5151e-20, 1.1198e-03,
        2.2491e-02, 6.1138e-02, 5.7211e-15, 9.5552e-20, 3.5151e-20, 2.0510e-05,
        5.7211e-15, 3.5151e-20])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 89.55% 

Test Accuracy: 88.56% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.17043475806713104
distance x is tensor(112.9234, device='cuda:0')
benign distance is  tensor(112.9234, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6013575196266174
distance x is tensor(109.2979, device='cuda:0')
benign distance is  tensor(109.2979, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.03066776692867279
distance x is tensor(134.3522, device='cuda:0')
benign distance is  tensor(134.3522, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4884684681892395
distance x is tensor(114.9611, device='cuda:0')
benign distance is  tensor(114.9611, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5599589347839355
distance x is tensor(113.9135, device='cuda:0')
benign distance is  tensor(113.9135, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3718635141849518
distance x is tensor(118.8176, device='cuda:0')
benign distance is  tensor(118.8176, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.20993728935718536
distance x is tensor(123.6562, device='cuda:0')
benign distance is  tensor(123.6562, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.44273677468299866
distance x is tensor(118.3700, device='cuda:0')
benign distance is  tensor(118.3700, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.16618040204048157
distance x is tensor(132.8028, device='cuda:0')
benign distance is  tensor(132.8028, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5744266510009766
distance x is tensor(132.2009, device='cuda:0')
benign distance is  tensor(132.2009, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.2571571469306946
distance x is tensor(130.2388, device='cuda:0')
benign distance is  tensor(130.2388, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4642884135246277
distance x is tensor(124.3831, device='cuda:0')
benign distance is  tensor(124.3831, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.22545985877513885
distance x is tensor(129.7260, device='cuda:0')
benign distance is  tensor(129.7260, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1371842920780182
distance x is tensor(116.1225, device='cuda:0')
benign distance is  tensor(116.1225, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2531055212020874
distance x is tensor(123.8770, device='cuda:0')
benign distance is  tensor(123.8770, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.844025731086731
distance x is tensor(144.3641, device='cuda:0')
benign distance is  tensor(144.3641, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4064103960990906
distance x is tensor(118.7543, device='cuda:0')
benign distance is  tensor(118.7543, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5192896127700806
distance x is tensor(153.0642, device='cuda:0')
benign distance is  tensor(153.0642, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.1445969045162201
distance x is tensor(126.1118, device='cuda:0')
benign distance is  tensor(126.1118, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8919820785522461
distance x is tensor(115.6516, device='cuda:0')
benign distance is  tensor(115.6516, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.29471826553344727
distance x is tensor(132.2916, device='cuda:0')
benign distance is  tensor(132.2916, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4715021252632141
distance x is tensor(121.2604, device='cuda:0')
benign distance is  tensor(121.2604, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5533518195152283
distance x is tensor(138.1713, device='cuda:0')
benign distance is  tensor(138.1713, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7352706789970398
distance x is tensor(127.2970, device='cuda:0')
benign distance is  tensor(127.2970, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.1137029305100441
distance x is tensor(120.4455, device='cuda:0')
benign distance is  tensor(120.4455, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.486574649810791
distance x is tensor(131.1311, device='cuda:0')
benign distance is  tensor(131.1311, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.08184273540973663
distance x is tensor(111.5569, device='cuda:0')
benign distance is  tensor(111.5569, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.5203686952590942
distance x is tensor(131.3373, device='cuda:0')
benign distance is  tensor(131.3373, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.40226349234580994
distance x is tensor(131.8950, device='cuda:0')
benign distance is  tensor(131.8950, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.2665237486362457
distance x is tensor(124.7257, device='cuda:0')
benign distance is  tensor(124.7257, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6775151491165161
distance x is tensor(129.8190, device='cuda:0')
benign distance is  tensor(129.8190, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.8307244181632996
distance x is tensor(134.1211, device='cuda:0')
benign distance is  tensor(134.1211, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.6307147741317749
mal_entropy is 0.08763711899518967
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 88.31% 

Test Accuracy: 87.30% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2009943723678589
distance x is tensor(126.2638, device='cuda:0')
benign distance is  tensor(126.2638, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.694916844367981
distance x is tensor(109.5279, device='cuda:0')
benign distance is  tensor(109.5279, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.01570301130414009
distance x is tensor(128.8002, device='cuda:0')
benign distance is  tensor(128.8002, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4598521590232849
distance x is tensor(125.8685, device='cuda:0')
benign distance is  tensor(125.8685, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5870286226272583
distance x is tensor(95.6276, device='cuda:0')
benign distance is  tensor(95.6276, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.6460249423980713
distance x is tensor(132.4956, device='cuda:0')
benign distance is  tensor(132.4956, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.21403472125530243
distance x is tensor(127.5172, device='cuda:0')
benign distance is  tensor(127.5172, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.17948618531227112
distance x is tensor(111.2756, device='cuda:0')
benign distance is  tensor(111.2756, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.7291471362113953
mal_entropy is 0.11852572113275528
user_PLR len size 36
counter_tensor is  tensor([ 0., 33., 12.,  0., 35.,  0., 25., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 23., 30., 35., 12., 35.,  0., 32., 35.,
        12., 12., 12., 33., 31., 35.,  0., 12.])
count_res tensor([1.1795e-16, 2.5316e-02, 1.9196e-11, 1.1795e-16, 1.8706e-01, 1.1795e-16,
        8.4927e-06, 1.9196e-11, 3.1243e-06, 3.1243e-06, 3.1243e-06, 3.1243e-06,
        3.1243e-06, 3.1243e-06, 3.1243e-06, 3.1243e-06, 3.1243e-06, 3.1243e-06,
        3.1243e-06, 3.1243e-06, 1.1494e-06, 1.2604e-03, 1.8706e-01, 1.9196e-11,
        1.8706e-01, 1.1795e-16, 9.3134e-03, 1.8706e-01, 1.9196e-11, 1.9196e-11,
        1.9196e-11, 2.5316e-02, 3.4262e-03, 1.8706e-01, 1.1795e-16, 1.9196e-11])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 89.59% 

Test Accuracy: 88.71% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.42145174741744995
distance x is tensor(110.9882, device='cuda:0')
benign distance is  tensor(110.9882, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4369317889213562
distance x is tensor(127.5260, device='cuda:0')
benign distance is  tensor(127.5260, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.11833381652832031
distance x is tensor(128.3770, device='cuda:0')
benign distance is  tensor(128.3770, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9321937561035156
distance x is tensor(118.4571, device='cuda:0')
benign distance is  tensor(118.4571, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5048788785934448
distance x is tensor(103.1850, device='cuda:0')
benign distance is  tensor(103.1850, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7349693179130554
distance x is tensor(134.0417, device='cuda:0')
benign distance is  tensor(134.0417, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2641584277153015
distance x is tensor(127.8579, device='cuda:0')
benign distance is  tensor(127.8579, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8082884550094604
distance x is tensor(112.5173, device='cuda:0')
benign distance is  tensor(112.5173, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6313577890396118
distance x is tensor(128.9691, device='cuda:0')
benign distance is  tensor(128.9691, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.604870617389679
distance x is tensor(125.6745, device='cuda:0')
benign distance is  tensor(125.6745, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8504725694656372
distance x is tensor(116.2789, device='cuda:0')
benign distance is  tensor(116.2789, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9331458806991577
distance x is tensor(117.7056, device='cuda:0')
benign distance is  tensor(117.7056, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.254838764667511
distance x is tensor(132.9725, device='cuda:0')
benign distance is  tensor(132.9725, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1734374463558197
distance x is tensor(107.3806, device='cuda:0')
benign distance is  tensor(107.3806, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3107568621635437
distance x is tensor(124.8510, device='cuda:0')
benign distance is  tensor(124.8510, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5096116065979004
distance x is tensor(128.2127, device='cuda:0')
benign distance is  tensor(128.2127, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.4350668787956238
distance x is tensor(133.0912, device='cuda:0')
benign distance is  tensor(133.0912, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6075795888900757
distance x is tensor(126.2328, device='cuda:0')
benign distance is  tensor(126.2328, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3165445625782013
distance x is tensor(127.2293, device='cuda:0')
benign distance is  tensor(127.2293, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.2547909617424011
distance x is tensor(139.4487, device='cuda:0')
benign distance is  tensor(139.4487, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.598277747631073
distance x is tensor(117.7301, device='cuda:0')
benign distance is  tensor(117.7301, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.40630245208740234
distance x is tensor(135.8762, device='cuda:0')
benign distance is  tensor(135.8762, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.36211901903152466
distance x is tensor(126.7414, device='cuda:0')
benign distance is  tensor(126.7414, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.18845519423484802
distance x is tensor(125.2256, device='cuda:0')
benign distance is  tensor(125.2256, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.5985462665557861
mal_entropy is 0.09649448841810226
user_PLR len size 28
counter_tensor is  tensor([12., 12., 12., 14., 27., 12., 26.,  0., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 26., 15., 12., 12., 12., 12., 12., 12.])
count_res tensor([1.7621e-07, 1.7621e-07, 1.7621e-07, 1.3021e-06, 5.7605e-01, 1.7621e-07,
        2.1192e-01, 1.0827e-12, 9.6210e-06, 9.6210e-06, 9.6210e-06, 9.6210e-06,
        9.6210e-06, 9.6210e-06, 9.6210e-06, 9.6210e-06, 9.6210e-06, 9.6210e-06,
        9.6210e-06, 9.6210e-06, 2.1192e-01, 3.5394e-06, 1.7621e-07, 1.7621e-07,
        1.7621e-07, 1.7621e-07, 1.7621e-07, 1.7621e-07])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 89.12% 

Test Accuracy: 88.21% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5820313692092896
distance x is tensor(117.7233, device='cuda:0')
benign distance is  tensor(117.7233, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1516988277435303
distance x is tensor(131.5873, device='cuda:0')
benign distance is  tensor(131.5873, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3734983503818512
distance x is tensor(137.1148, device='cuda:0')
benign distance is  tensor(137.1148, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5663411021232605
distance x is tensor(124.0469, device='cuda:0')
benign distance is  tensor(124.0469, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.21350225806236267
distance x is tensor(79.8650, device='cuda:0')
benign distance is  tensor(79.8650, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.44503751397132874
distance x is tensor(130.9091, device='cuda:0')
benign distance is  tensor(130.9091, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5457399487495422
distance x is tensor(116.8037, device='cuda:0')
benign distance is  tensor(116.8037, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6390115022659302
distance x is tensor(119.3605, device='cuda:0')
benign distance is  tensor(119.3605, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2282387912273407
distance x is tensor(125.9771, device='cuda:0')
benign distance is  tensor(125.9771, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.810403048992157
distance x is tensor(161.9894, device='cuda:0')
benign distance is  tensor(161.9894, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5780237913131714
distance x is tensor(128.7156, device='cuda:0')
benign distance is  tensor(128.7156, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3092857003211975
distance x is tensor(127.4836, device='cuda:0')
benign distance is  tensor(127.4836, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.1293516904115677
distance x is tensor(146.3728, device='cuda:0')
benign distance is  tensor(146.3728, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6810771226882935
distance x is tensor(140.0167, device='cuda:0')
benign distance is  tensor(140.0167, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.17961160838603973
distance x is tensor(139.8548, device='cuda:0')
benign distance is  tensor(139.8548, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.9793760180473328
distance x is tensor(142.5873, device='cuda:0')
benign distance is  tensor(142.5873, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.4577111601829529
mal_entropy is 0.06872694194316864
user_PLR len size 36
counter_tensor is  tensor([12., 15., 21., 17., 33., 12., 12., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 13., 30., 22., 34., 31., 12., 12., 13.,
        12., 31., 14., 34., 30., 12., 12., 12.])
count_res tensor([1.1137e-10, 2.2370e-09, 9.0246e-07, 1.6529e-08, 1.4688e-01, 1.1137e-10,
        1.1137e-10, 1.1137e-10, 1.8126e-05, 1.8126e-05, 1.8126e-05, 1.8126e-05,
        1.8126e-05, 1.8126e-05, 1.8126e-05, 1.8126e-05, 1.8126e-05, 1.8126e-05,
        1.8126e-05, 1.8126e-05, 3.0274e-10, 7.3127e-03, 2.4531e-06, 3.9926e-01,
        1.9878e-02, 1.1137e-10, 1.1137e-10, 3.0274e-10, 1.1137e-10, 1.9878e-02,
        8.2293e-10, 3.9926e-01, 7.3127e-03, 1.1137e-10, 1.1137e-10, 1.1137e-10])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 88.87% 

Test Accuracy: 88.11% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.34079837799072266
distance x is tensor(106.5751, device='cuda:0')
benign distance is  tensor(106.5751, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8099157214164734
distance x is tensor(115.5574, device='cuda:0')
benign distance is  tensor(115.5574, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1111762523651123
distance x is tensor(136.3259, device='cuda:0')
benign distance is  tensor(136.3259, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2763385772705078
distance x is tensor(112.8242, device='cuda:0')
benign distance is  tensor(112.8242, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.45363155007362366
distance x is tensor(98.9197, device='cuda:0')
benign distance is  tensor(98.9197, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3114646077156067
distance x is tensor(136.4249, device='cuda:0')
benign distance is  tensor(136.4249, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.10027362406253815
distance x is tensor(123.9957, device='cuda:0')
benign distance is  tensor(123.9957, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.06738724559545517
distance x is tensor(116.7992, device='cuda:0')
benign distance is  tensor(116.7992, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.44843071699142456
distance x is tensor(130.3917, device='cuda:0')
benign distance is  tensor(130.3917, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5428619980812073
distance x is tensor(127.1438, device='cuda:0')
benign distance is  tensor(127.1438, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6949747800827026
distance x is tensor(127.0416, device='cuda:0')
benign distance is  tensor(127.0416, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.35002976655960083
distance x is tensor(108.8667, device='cuda:0')
benign distance is  tensor(108.8667, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3849622309207916
distance x is tensor(119.5055, device='cuda:0')
benign distance is  tensor(119.5055, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2535998225212097
distance x is tensor(124.0405, device='cuda:0')
benign distance is  tensor(124.0405, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5568380355834961
distance x is tensor(146.5454, device='cuda:0')
benign distance is  tensor(146.5454, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6871004104614258
distance x is tensor(139.7540, device='cuda:0')
benign distance is  tensor(139.7540, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.2529105544090271
distance x is tensor(127.8184, device='cuda:0')
benign distance is  tensor(127.8184, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.34083420038223267
distance x is tensor(132.5184, device='cuda:0')
benign distance is  tensor(132.5184, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.31542518734931946
distance x is tensor(146.4591, device='cuda:0')
benign distance is  tensor(146.4591, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.17838039994239807
distance x is tensor(117.0162, device='cuda:0')
benign distance is  tensor(117.0162, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4314073622226715
distance x is tensor(131.9630, device='cuda:0')
benign distance is  tensor(131.9630, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.3013630509376526
distance x is tensor(126.6133, device='cuda:0')
benign distance is  tensor(126.6133, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.2613508999347687
distance x is tensor(130.7533, device='cuda:0')
benign distance is  tensor(130.7533, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.14028427004814148
distance x is tensor(131.5536, device='cuda:0')
benign distance is  tensor(131.5536, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.4868946969509125
mal_entropy is 0.0762355700135231
user_PLR len size 20
counter_tensor is  tensor([14., 14., 16., 14., 15., 19., 16., 16., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([0.0002, 0.0002, 0.0015, 0.0002, 0.0005, 0.0296, 0.0015, 0.0015, 0.0804,
        0.0804, 0.0804, 0.0804, 0.0804, 0.0804, 0.0804, 0.0804, 0.0804, 0.0804,
        0.0804, 0.0804])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 87.15% 

Test Accuracy: 85.93% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.1273200809955597
distance x is tensor(119.5005, device='cuda:0')
benign distance is  tensor(119.5005, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.006545901298523
distance x is tensor(147.9251, device='cuda:0')
benign distance is  tensor(147.9251, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5996825695037842
distance x is tensor(153.0089, device='cuda:0')
benign distance is  tensor(153.0089, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.47548970580101013
distance x is tensor(146.4381, device='cuda:0')
benign distance is  tensor(146.4381, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.26983147859573364
distance x is tensor(116.5757, device='cuda:0')
benign distance is  tensor(116.5757, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5448580980300903
distance x is tensor(146.1866, device='cuda:0')
benign distance is  tensor(146.1866, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.542887270450592
distance x is tensor(133.0178, device='cuda:0')
benign distance is  tensor(133.0178, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3393005132675171
distance x is tensor(127.1573, device='cuda:0')
benign distance is  tensor(127.1573, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8000000005000001
mal_loss is 0.6900397539138794
mal_entropy is 0.131678968667984
user_PLR len size 52
counter_tensor is  tensor([ 4., 22., 17., 50., 44., 17., 23.,  6., 36., 36., 36., 36., 36., 36.,
        36., 36., 36., 36., 36., 36., 35., 47., 39., 51., 35., 35., 42., 44.,
        48.,  6., 43., 51., 45.,  5., 50., 35., 48., 11.,  8., 49., 51., 13.,
        11., 15., 51., 43., 42., 45., 39., 51., 28., 51.])
count_res tensor([5.5369e-22, 3.6355e-14, 2.4496e-16, 5.2579e-02, 1.3033e-04, 2.4496e-16,
        9.8824e-14, 4.0912e-21, 4.3721e-08, 4.3721e-08, 4.3721e-08, 4.3721e-08,
        4.3721e-08, 4.3721e-08, 4.3721e-08, 4.3721e-08, 4.3721e-08, 4.3721e-08,
        4.3721e-08, 4.3721e-08, 1.6084e-08, 2.6178e-03, 8.7816e-07, 1.4292e-01,
        1.6084e-08, 1.6084e-08, 1.7638e-05, 1.3033e-04, 7.1158e-03, 4.0912e-21,
        4.7946e-05, 1.4292e-01, 3.5427e-04, 1.5051e-21, 5.2579e-02, 1.6084e-08,
        7.1158e-03, 6.0719e-19, 3.0230e-20, 1.9343e-02, 1.4292e-01, 4.4866e-18,
        6.0719e-19, 3.3152e-17, 1.4292e-01, 4.7946e-05, 1.7638e-05, 3.5427e-04,
        8.7816e-07, 1.4292e-01, 1.4667e-11, 1.4292e-01])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 89.71% 

Test Accuracy: 88.71% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.31843000650405884
distance x is tensor(102.6929, device='cuda:0')
benign distance is  tensor(102.6929, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7996946573257446
distance x is tensor(112.4686, device='cuda:0')
benign distance is  tensor(112.4686, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.09363700449466705
distance x is tensor(117.3616, device='cuda:0')
benign distance is  tensor(117.3616, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5683649182319641
distance x is tensor(113.9885, device='cuda:0')
benign distance is  tensor(113.9885, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.43789783120155334
distance x is tensor(91.9486, device='cuda:0')
benign distance is  tensor(91.9486, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.672683835029602
distance x is tensor(124.9833, device='cuda:0')
benign distance is  tensor(124.9833, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.28516703844070435
distance x is tensor(120.1404, device='cuda:0')
benign distance is  tensor(120.1404, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.22001226246356964
distance x is tensor(107.0552, device='cuda:0')
benign distance is  tensor(107.0552, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3708108365535736
distance x is tensor(121.2423, device='cuda:0')
benign distance is  tensor(121.2423, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.570438802242279
distance x is tensor(120.1671, device='cuda:0')
benign distance is  tensor(120.1671, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6877800226211548
distance x is tensor(132.0065, device='cuda:0')
benign distance is  tensor(132.0065, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.581335186958313
distance x is tensor(119.9081, device='cuda:0')
benign distance is  tensor(119.9081, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9778369069099426
distance x is tensor(131.5203, device='cuda:0')
benign distance is  tensor(131.5203, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.07031406462192535
distance x is tensor(106.7663, device='cuda:0')
benign distance is  tensor(106.7663, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.38008955121040344
distance x is tensor(124.4987, device='cuda:0')
benign distance is  tensor(124.4987, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4551662802696228
distance x is tensor(126.1597, device='cuda:0')
benign distance is  tensor(126.1597, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4016743302345276
distance x is tensor(123.6338, device='cuda:0')
benign distance is  tensor(123.6338, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6603705286979675
distance x is tensor(146.9821, device='cuda:0')
benign distance is  tensor(146.9821, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.39231622219085693
distance x is tensor(124.5195, device='cuda:0')
benign distance is  tensor(124.5195, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4005110263824463
distance x is tensor(126.0526, device='cuda:0')
benign distance is  tensor(126.0526, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.18376336991786957
distance x is tensor(116.7087, device='cuda:0')
benign distance is  tensor(116.7087, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.23441028594970703
distance x is tensor(124.4099, device='cuda:0')
benign distance is  tensor(124.4099, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4263440668582916
distance x is tensor(132.3727, device='cuda:0')
benign distance is  tensor(132.3727, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8434990644454956
distance x is tensor(124.3674, device='cuda:0')
benign distance is  tensor(124.3674, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.1417277604341507
distance x is tensor(138.3811, device='cuda:0')
benign distance is  tensor(138.3811, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.48719555139541626
distance x is tensor(124.4730, device='cuda:0')
benign distance is  tensor(124.4730, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.502507746219635
distance x is tensor(132.3134, device='cuda:0')
benign distance is  tensor(132.3134, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.21020416915416718
distance x is tensor(128.3417, device='cuda:0')
benign distance is  tensor(128.3417, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8576368093490601
distance x is tensor(126.4039, device='cuda:0')
benign distance is  tensor(126.4039, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.2841435968875885
distance x is tensor(133.8419, device='cuda:0')
benign distance is  tensor(133.8419, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.1445068120956421
distance x is tensor(121.1138, device='cuda:0')
benign distance is  tensor(121.1138, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.28156328201293945
distance x is tensor(134.8207, device='cuda:0')
benign distance is  tensor(134.8207, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.1629694402217865
distance x is tensor(123.0306, device='cuda:0')
benign distance is  tensor(123.0306, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.32360249757766724
distance x is tensor(128.9461, device='cuda:0')
benign distance is  tensor(128.9461, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.16475607454776764
distance x is tensor(123.2479, device='cuda:0')
benign distance is  tensor(123.2479, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.2199581414461136
distance x is tensor(123.0158, device='cuda:0')
benign distance is  tensor(123.0158, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.08144313097000122
distance x is tensor(135.2790, device='cuda:0')
benign distance is  tensor(135.2790, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.3850683569908142
distance x is tensor(131.5474, device='cuda:0')
benign distance is  tensor(131.5474, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8948540687561035
distance x is tensor(131.0179, device='cuda:0')
benign distance is  tensor(131.0179, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.4533194601535797
distance x is tensor(130.8478, device='cuda:0')
benign distance is  tensor(130.8478, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.3033847212791443
mal_entropy is 0.08314637839794159
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 88.70% 

Test Accuracy: 87.71% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.1980646550655365
distance x is tensor(114.9596, device='cuda:0')
benign distance is  tensor(114.9596, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.44430655241012573
distance x is tensor(113.6580, device='cuda:0')
benign distance is  tensor(113.6580, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.45233505964279175
distance x is tensor(134.4350, device='cuda:0')
benign distance is  tensor(134.4350, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5253468751907349
distance x is tensor(127.6537, device='cuda:0')
benign distance is  tensor(127.6537, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7863093614578247
distance x is tensor(100.2911, device='cuda:0')
benign distance is  tensor(100.2911, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.509019672870636
distance x is tensor(134.7189, device='cuda:0')
benign distance is  tensor(134.7189, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.11448502540588379
distance x is tensor(123.1237, device='cuda:0')
benign distance is  tensor(123.1237, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.13623350858688354
distance x is tensor(116.4018, device='cuda:0')
benign distance is  tensor(116.4018, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.805140495300293
mal_entropy is 0.1612878143787384
user_PLR len size 28
counter_tensor is  tensor([12., 12., 25., 12., 12., 12., 26., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 25., 21., 12., 12., 26., 12., 27.])
count_res tensor([1.5226e-07, 1.5226e-07, 6.7361e-02, 1.5226e-07, 1.5226e-07, 1.5226e-07,
        1.8311e-01, 1.5226e-07, 8.3130e-06, 8.3130e-06, 8.3130e-06, 8.3130e-06,
        8.3130e-06, 8.3130e-06, 8.3130e-06, 8.3130e-06, 8.3130e-06, 8.3130e-06,
        8.3130e-06, 8.3130e-06, 1.5226e-07, 6.7361e-02, 1.2338e-03, 1.5226e-07,
        1.5226e-07, 1.8311e-01, 1.5226e-07, 4.9773e-01])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 89.06% 

Test Accuracy: 88.12% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6209585666656494
distance x is tensor(128.7088, device='cuda:0')
benign distance is  tensor(128.7088, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.29558414220809937
distance x is tensor(147.1764, device='cuda:0')
benign distance is  tensor(147.1764, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.36058008670806885
distance x is tensor(130.6126, device='cuda:0')
benign distance is  tensor(130.6126, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4791039526462555
distance x is tensor(135.5223, device='cuda:0')
benign distance is  tensor(135.5223, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.20148217678070068
distance x is tensor(135.7213, device='cuda:0')
benign distance is  tensor(135.7213, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6671041250228882
distance x is tensor(124.2887, device='cuda:0')
benign distance is  tensor(124.2887, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.20612852275371552
distance x is tensor(123.5888, device='cuda:0')
benign distance is  tensor(123.5888, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.23421521484851837
distance x is tensor(124.2767, device='cuda:0')
benign distance is  tensor(124.2767, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4875022768974304
distance x is tensor(137.5266, device='cuda:0')
benign distance is  tensor(137.5266, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6972528100013733
distance x is tensor(130.7849, device='cuda:0')
benign distance is  tensor(130.7849, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.38032060861587524
distance x is tensor(133.6334, device='cuda:0')
benign distance is  tensor(133.6334, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.43110474944114685
distance x is tensor(128.9224, device='cuda:0')
benign distance is  tensor(128.9224, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.13751617074012756
distance x is tensor(141.0930, device='cuda:0')
benign distance is  tensor(141.0930, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.02515089511871338
distance x is tensor(107.6296, device='cuda:0')
benign distance is  tensor(107.6296, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.25310006737709045
distance x is tensor(146.4199, device='cuda:0')
benign distance is  tensor(146.4199, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9370571374893188
distance x is tensor(94.1512, device='cuda:0')
benign distance is  tensor(94.1512, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.2453717738389969
mal_entropy is 0.0804305225610733
user_PLR len size 36
counter_tensor is  tensor([22., 17., 32., 35., 33.,  6., 11., 17., 18., 18., 18., 18., 18., 18.,
        18., 18., 18., 18., 18., 18., 33.,  7., 17., 34., 13., 22., 35., 22.,
        30., 33., 24., 28., 33., 35., 28., 25.])
count_res tensor([5.6969e-07, 3.8385e-09, 1.2548e-02, 2.5204e-01, 3.4110e-02, 6.4110e-14,
        9.5148e-12, 3.8385e-09, 1.0434e-08, 1.0434e-08, 1.0434e-08, 1.0434e-08,
        1.0434e-08, 1.0434e-08, 1.0434e-08, 1.0434e-08, 1.0434e-08, 1.0434e-08,
        1.0434e-08, 1.0434e-08, 3.4110e-02, 1.7427e-13, 3.8385e-09, 9.2720e-02,
        7.0305e-11, 5.6969e-07, 2.5204e-01, 5.6969e-07, 1.6982e-03, 3.4110e-02,
        4.2095e-06, 2.2983e-04, 3.4110e-02, 2.5204e-01, 2.2983e-04, 1.1443e-05])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 89.53% 

Test Accuracy: 88.82% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.14190731942653656
distance x is tensor(112.7274, device='cuda:0')
benign distance is  tensor(112.7274, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5451902151107788
distance x is tensor(124.2553, device='cuda:0')
benign distance is  tensor(124.2553, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.31683650612831116
distance x is tensor(133.2783, device='cuda:0')
benign distance is  tensor(133.2783, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.23552027344703674
distance x is tensor(115.8729, device='cuda:0')
benign distance is  tensor(115.8729, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.43975120782852173
distance x is tensor(90.0912, device='cuda:0')
benign distance is  tensor(90.0912, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.523469090461731
distance x is tensor(132.6015, device='cuda:0')
benign distance is  tensor(132.6015, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.16548219323158264
distance x is tensor(118.8510, device='cuda:0')
benign distance is  tensor(118.8510, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0941238403320312
distance x is tensor(109.3433, device='cuda:0')
benign distance is  tensor(109.3433, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3603893518447876
distance x is tensor(127.8237, device='cuda:0')
benign distance is  tensor(127.8237, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8527754545211792
distance x is tensor(151.7745, device='cuda:0')
benign distance is  tensor(151.7745, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.735470175743103
distance x is tensor(120.6295, device='cuda:0')
benign distance is  tensor(120.6295, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.21866583824157715
distance x is tensor(125.6975, device='cuda:0')
benign distance is  tensor(125.6975, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.2419493943452835
distance x is tensor(132.1496, device='cuda:0')
benign distance is  tensor(132.1496, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6868109107017517
distance x is tensor(124.2766, device='cuda:0')
benign distance is  tensor(124.2766, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.04168263077735901
distance x is tensor(138.0954, device='cuda:0')
benign distance is  tensor(138.0954, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4021759629249573
distance x is tensor(121.7195, device='cuda:0')
benign distance is  tensor(121.7195, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.24816294014453888
distance x is tensor(128.8261, device='cuda:0')
benign distance is  tensor(128.8261, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.06614905595779419
distance x is tensor(120.2186, device='cuda:0')
benign distance is  tensor(120.2186, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.4822250306606293
distance x is tensor(132.6783, device='cuda:0')
benign distance is  tensor(132.6783, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.11228235065937042
distance x is tensor(116.3879, device='cuda:0')
benign distance is  tensor(116.3879, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.679155707359314
distance x is tensor(135.2688, device='cuda:0')
benign distance is  tensor(135.2688, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.2938157916069031
distance x is tensor(128.8393, device='cuda:0')
benign distance is  tensor(128.8393, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.3069245517253876
distance x is tensor(119.6907, device='cuda:0')
benign distance is  tensor(119.6907, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.11333320289850235
distance x is tensor(128.6995, device='cuda:0')
benign distance is  tensor(128.6995, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.29490771889686584
mal_entropy is 0.11969852447509766
user_PLR len size 36
counter_tensor is  tensor([ 0., 12., 12.,  2., 19., 13., 25., 13., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 12., 12., 17., 12., 16., 33., 34., 14.,
        13., 35., 35., 35., 12., 13.,  0., 12.])
count_res tensor([1.7997e-16, 2.9291e-11, 2.9291e-11, 1.3298e-15, 3.2121e-08, 7.9620e-11,
        1.2959e-05, 7.9620e-11, 4.7672e-06, 4.7672e-06, 4.7672e-06, 4.7672e-06,
        4.7672e-06, 4.7672e-06, 4.7672e-06, 4.7672e-06, 4.7672e-06, 4.7672e-06,
        4.7672e-06, 4.7672e-06, 2.9291e-11, 2.9291e-11, 4.3471e-09, 2.9291e-11,
        1.5992e-09, 3.8629e-02, 1.0500e-01, 2.1643e-10, 7.9620e-11, 2.8543e-01,
        2.8543e-01, 2.8543e-01, 2.9291e-11, 7.9620e-11, 1.7997e-16, 2.9291e-11])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 89.14% 

Test Accuracy: 88.51% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9199771881103516
distance x is tensor(119.7654, device='cuda:0')
benign distance is  tensor(119.7654, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9531927108764648
distance x is tensor(123.1176, device='cuda:0')
benign distance is  tensor(123.1176, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.12432676553726196
distance x is tensor(125.7722, device='cuda:0')
benign distance is  tensor(125.7722, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.34896475076675415
distance x is tensor(118.1644, device='cuda:0')
benign distance is  tensor(118.1644, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5872294306755066
distance x is tensor(121.2632, device='cuda:0')
benign distance is  tensor(121.2632, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6935788989067078
distance x is tensor(120.5509, device='cuda:0')
benign distance is  tensor(120.5509, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3830530643463135
distance x is tensor(114.6772, device='cuda:0')
benign distance is  tensor(114.6772, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4594801366329193
distance x is tensor(115.2748, device='cuda:0')
benign distance is  tensor(115.2748, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7675601840019226
distance x is tensor(135.7278, device='cuda:0')
benign distance is  tensor(135.7278, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6674994230270386
distance x is tensor(121.3911, device='cuda:0')
benign distance is  tensor(121.3911, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5341301560401917
distance x is tensor(113.1216, device='cuda:0')
benign distance is  tensor(113.1216, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.19399793446063995
distance x is tensor(117.4396, device='cuda:0')
benign distance is  tensor(117.4396, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7097314596176147
distance x is tensor(130.8652, device='cuda:0')
benign distance is  tensor(130.8652, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1759907603263855
distance x is tensor(112.9333, device='cuda:0')
benign distance is  tensor(112.9333, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5403007864952087
distance x is tensor(140.1034, device='cuda:0')
benign distance is  tensor(140.1034, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9702836871147156
distance x is tensor(101.4728, device='cuda:0')
benign distance is  tensor(101.4728, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.16452810168266296
distance x is tensor(143.4783, device='cuda:0')
benign distance is  tensor(143.4783, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6763311624526978
distance x is tensor(120.9031, device='cuda:0')
benign distance is  tensor(120.9031, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.2724810838699341
distance x is tensor(136.4362, device='cuda:0')
benign distance is  tensor(136.4362, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.9183265566825867
distance x is tensor(138.6437, device='cuda:0')
benign distance is  tensor(138.6437, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8075275421142578
distance x is tensor(139.9688, device='cuda:0')
benign distance is  tensor(139.9688, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.24408869445323944
distance x is tensor(128.3031, device='cuda:0')
benign distance is  tensor(128.3031, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.3487919270992279
distance x is tensor(127.7742, device='cuda:0')
benign distance is  tensor(127.7742, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.14983013272285461
distance x is tensor(135.8305, device='cuda:0')
benign distance is  tensor(135.8305, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.6854360699653625
mal_entropy is 0.04127934202551842
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 87.47% 

Test Accuracy: 86.75% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4032866954803467
distance x is tensor(135.4409, device='cuda:0')
benign distance is  tensor(135.4409, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8631628155708313
distance x is tensor(135.6373, device='cuda:0')
benign distance is  tensor(135.6373, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3868253827095032
distance x is tensor(149.5168, device='cuda:0')
benign distance is  tensor(149.5168, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7653546929359436
distance x is tensor(130.4352, device='cuda:0')
benign distance is  tensor(130.4352, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.24387815594673157
distance x is tensor(120.1081, device='cuda:0')
benign distance is  tensor(120.1081, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4260365962982178
distance x is tensor(150.9649, device='cuda:0')
benign distance is  tensor(150.9649, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.15024062991142273
distance x is tensor(131.4676, device='cuda:0')
benign distance is  tensor(131.4676, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.35891613364219666
distance x is tensor(144.1151, device='cuda:0')
benign distance is  tensor(144.1151, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.9927532076835632
mal_entropy is 0.08690864592790604
user_PLR len size 44
counter_tensor is  tensor([41., 36., 43., 23., 40., 37., 42., 20., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 26., 36., 43., 39., 19., 42., 37., 41.,
        39., 42., 24., 32., 17., 40., 21., 42., 25., 29., 43., 29., 41., 24.,
        30., 15.])
count_res tensor([2.6955e-02, 1.8162e-04, 1.9917e-01, 4.1053e-10, 9.9163e-03, 4.9370e-04,
        7.3272e-02, 2.0439e-11, 3.3265e-06, 3.3265e-06, 3.3265e-06, 3.3265e-06,
        3.3265e-06, 3.3265e-06, 3.3265e-06, 3.3265e-06, 3.3265e-06, 3.3265e-06,
        3.3265e-06, 3.3265e-06, 8.2457e-09, 1.8162e-04, 1.9917e-01, 3.6480e-03,
        7.5191e-12, 7.3272e-02, 4.9370e-04, 2.6955e-02, 3.6480e-03, 7.3272e-02,
        1.1159e-09, 3.3265e-06, 1.0176e-12, 9.9163e-03, 5.5559e-11, 7.3272e-02,
        3.0334e-09, 1.6562e-07, 1.9917e-01, 1.6562e-07, 2.6955e-02, 1.1159e-09,
        4.5020e-07, 1.3772e-13])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 89.59% 

Test Accuracy: 88.76% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2867373526096344
distance x is tensor(105.2932, device='cuda:0')
benign distance is  tensor(105.2932, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5292043685913086
distance x is tensor(115.6084, device='cuda:0')
benign distance is  tensor(115.6084, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.07209373265504837
distance x is tensor(129.8663, device='cuda:0')
benign distance is  tensor(129.8663, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6421046257019043
distance x is tensor(110.7065, device='cuda:0')
benign distance is  tensor(110.7065, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5736643671989441
distance x is tensor(90.4247, device='cuda:0')
benign distance is  tensor(90.4247, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.42334088683128357
distance x is tensor(129.6613, device='cuda:0')
benign distance is  tensor(129.6613, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.17633207142353058
distance x is tensor(124.6645, device='cuda:0')
benign distance is  tensor(124.6645, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.16342172026634216
distance x is tensor(115.6344, device='cuda:0')
benign distance is  tensor(115.6344, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.19945025444030762
distance x is tensor(134.0647, device='cuda:0')
benign distance is  tensor(134.0647, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6756240129470825
distance x is tensor(125.9447, device='cuda:0')
benign distance is  tensor(125.9447, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5098094344139099
distance x is tensor(108.3811, device='cuda:0')
benign distance is  tensor(108.3811, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8212131261825562
distance x is tensor(112.1854, device='cuda:0')
benign distance is  tensor(112.1854, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.366202712059021
distance x is tensor(131.0743, device='cuda:0')
benign distance is  tensor(131.0743, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2777268886566162
distance x is tensor(113.1498, device='cuda:0')
benign distance is  tensor(113.1498, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.28348296880722046
distance x is tensor(126.4069, device='cuda:0')
benign distance is  tensor(126.4069, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.22855046391487122
distance x is tensor(117.2139, device='cuda:0')
benign distance is  tensor(117.2139, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2527032196521759
distance x is tensor(128.9584, device='cuda:0')
benign distance is  tensor(128.9584, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.39221110939979553
distance x is tensor(130.4719, device='cuda:0')
benign distance is  tensor(130.4719, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.153916597366333
distance x is tensor(129.3761, device='cuda:0')
benign distance is  tensor(129.3761, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.11460614204406738
distance x is tensor(126.5192, device='cuda:0')
benign distance is  tensor(126.5192, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.29833662509918213
distance x is tensor(124.0189, device='cuda:0')
benign distance is  tensor(124.0189, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5310897827148438
distance x is tensor(123.9981, device='cuda:0')
benign distance is  tensor(123.9981, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.34222573041915894
distance x is tensor(132.7225, device='cuda:0')
benign distance is  tensor(132.7225, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5051795840263367
distance x is tensor(124.1147, device='cuda:0')
benign distance is  tensor(124.1147, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.22603771090507507
distance x is tensor(136.8552, device='cuda:0')
benign distance is  tensor(136.8552, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.2850993871688843
distance x is tensor(134.6541, device='cuda:0')
benign distance is  tensor(134.6541, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.015168477781116962
distance x is tensor(122.1708, device='cuda:0')
benign distance is  tensor(122.1708, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.2083265781402588
distance x is tensor(122.4643, device='cuda:0')
benign distance is  tensor(122.4643, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.34679076075553894
distance x is tensor(130.9076, device='cuda:0')
benign distance is  tensor(130.9076, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.19130058586597443
distance x is tensor(127.8685, device='cuda:0')
benign distance is  tensor(127.8685, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.35859543085098267
distance x is tensor(134.2344, device='cuda:0')
benign distance is  tensor(134.2344, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.253505676984787
distance x is tensor(132.1733, device='cuda:0')
benign distance is  tensor(132.1733, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.31854763627052307
mal_entropy is 0.1428418904542923
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 88.26% 

Test Accuracy: 87.46% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.285420686006546
distance x is tensor(137.4570, device='cuda:0')
benign distance is  tensor(137.4570, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8215292096138
distance x is tensor(137.9792, device='cuda:0')
benign distance is  tensor(137.9792, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.17340750992298126
distance x is tensor(126.6540, device='cuda:0')
benign distance is  tensor(126.6540, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6236174702644348
distance x is tensor(117.2280, device='cuda:0')
benign distance is  tensor(117.2280, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.26071274280548096
distance x is tensor(109.7909, device='cuda:0')
benign distance is  tensor(109.7909, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4704289436340332
distance x is tensor(141.1901, device='cuda:0')
benign distance is  tensor(141.1901, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.42524248361587524
distance x is tensor(124.5537, device='cuda:0')
benign distance is  tensor(124.5537, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5300126075744629
distance x is tensor(135.3327, device='cuda:0')
benign distance is  tensor(135.3327, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.8764190673828125
mal_entropy is 0.18200233578681946
user_PLR len size 44
counter_tensor is  tensor([26., 13., 42.,  9., 42., 43., 27., 18., 31., 31., 31., 31., 31., 31.,
        31., 31., 31., 31., 31., 31., 34., 34., 41., 39., 27., 32., 30., 43.,
        29., 42., 41., 39., 24., 23., 22., 26., 10., 41., 40., 10., 39., 40.,
         5.,  9.])
count_res tensor([1.1297e-08, 2.5536e-14, 1.0039e-01, 4.6771e-16, 1.0039e-01, 2.7289e-01,
        3.0710e-08, 3.7899e-12, 1.6767e-06, 1.6767e-06, 1.6767e-06, 1.6767e-06,
        1.6767e-06, 1.6767e-06, 1.6767e-06, 1.6767e-06, 1.6767e-06, 1.6767e-06,
        1.6767e-06, 1.6767e-06, 3.3677e-05, 3.3677e-05, 3.6931e-02, 4.9981e-03,
        3.0710e-08, 4.5577e-06, 6.1682e-07, 2.7289e-01, 2.2691e-07, 1.0039e-01,
        3.6931e-02, 4.9981e-03, 1.5289e-09, 5.6246e-10, 2.0692e-10, 1.1297e-08,
        1.2714e-15, 3.6931e-02, 1.3586e-02, 1.2714e-15, 4.9981e-03, 1.3586e-02,
        8.5663e-18, 4.6771e-16])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 89.69% 

Test Accuracy: 88.87% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4738852083683014
distance x is tensor(121.6230, device='cuda:0')
benign distance is  tensor(121.6230, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3086179792881012
distance x is tensor(119.6958, device='cuda:0')
benign distance is  tensor(119.6958, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.10178804397583008
distance x is tensor(122.9552, device='cuda:0')
benign distance is  tensor(122.9552, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0313470363616943
distance x is tensor(117.7223, device='cuda:0')
benign distance is  tensor(117.7223, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.29819291830062866
distance x is tensor(104.8286, device='cuda:0')
benign distance is  tensor(104.8286, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.43722882866859436
distance x is tensor(114.8486, device='cuda:0')
benign distance is  tensor(114.8486, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.11679204553365707
distance x is tensor(128.0930, device='cuda:0')
benign distance is  tensor(128.0930, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.46863022446632385
distance x is tensor(126.3522, device='cuda:0')
benign distance is  tensor(126.3522, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2234027087688446
distance x is tensor(142.4503, device='cuda:0')
benign distance is  tensor(142.4503, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3326001465320587
distance x is tensor(126.1292, device='cuda:0')
benign distance is  tensor(126.1292, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7913333177566528
distance x is tensor(115.5202, device='cuda:0')
benign distance is  tensor(115.5202, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6901375651359558
distance x is tensor(126.8745, device='cuda:0')
benign distance is  tensor(126.8745, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.1643114984035492
distance x is tensor(129.7483, device='cuda:0')
benign distance is  tensor(129.7483, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3505622148513794
distance x is tensor(114.1488, device='cuda:0')
benign distance is  tensor(114.1488, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.30164116621017456
distance x is tensor(138.4088, device='cuda:0')
benign distance is  tensor(138.4088, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.210291862487793
distance x is tensor(122.5461, device='cuda:0')
benign distance is  tensor(122.5461, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.19296865165233612
distance x is tensor(160.9698, device='cuda:0')
benign distance is  tensor(160.9698, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5275564193725586
distance x is tensor(119.0392, device='cuda:0')
benign distance is  tensor(119.0392, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.43755197525024414
distance x is tensor(138.1898, device='cuda:0')
benign distance is  tensor(138.1898, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3921528458595276
distance x is tensor(137.0295, device='cuda:0')
benign distance is  tensor(137.0295, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.4888778626918793
distance x is tensor(125.8448, device='cuda:0')
benign distance is  tensor(125.8448, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.1915840208530426
distance x is tensor(134.0706, device='cuda:0')
benign distance is  tensor(134.0706, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.05873485282063484
distance x is tensor(134.4354, device='cuda:0')
benign distance is  tensor(134.4354, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.31183668971061707
distance x is tensor(144.4338, device='cuda:0')
benign distance is  tensor(144.4338, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.41819295287132263
distance x is tensor(141.8031, device='cuda:0')
benign distance is  tensor(141.8031, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.1988251507282257
distance x is tensor(139.5804, device='cuda:0')
benign distance is  tensor(139.5804, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.3303050398826599
distance x is tensor(139.4090, device='cuda:0')
benign distance is  tensor(139.4090, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.6642685532569885
distance x is tensor(128.5099, device='cuda:0')
benign distance is  tensor(128.5099, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.29542332887649536
distance x is tensor(124.1581, device='cuda:0')
benign distance is  tensor(124.1581, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.27785056829452515
distance x is tensor(128.7625, device='cuda:0')
benign distance is  tensor(128.7625, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.4424508512020111
distance x is tensor(122.4984, device='cuda:0')
benign distance is  tensor(122.4984, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.3375946879386902
distance x is tensor(119.1269, device='cuda:0')
benign distance is  tensor(119.1269, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.27629002928733826
mal_entropy is 0.098301462829113
user_PLR len size 28
counter_tensor is  tensor([12., 13., 21., 14., 21., 13., 15., 22., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 18., 20.,  1., 24., 27., 13., 24., 26.])
count_res tensor([2.0664e-07, 5.6169e-07, 1.6744e-03, 1.5268e-06, 1.6744e-03, 5.6169e-07,
        4.1504e-06, 4.5514e-03, 1.1282e-05, 1.1282e-05, 1.1282e-05, 1.1282e-05,
        1.1282e-05, 1.1282e-05, 1.1282e-05, 1.1282e-05, 1.1282e-05, 1.1282e-05,
        1.1282e-05, 1.1282e-05, 8.3363e-05, 6.1597e-04, 3.4512e-12, 3.3631e-02,
        6.7549e-01, 5.6169e-07, 3.3631e-02, 2.4850e-01])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 88.39% 

Test Accuracy: 87.39% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4485044479370117
distance x is tensor(118.2793, device='cuda:0')
benign distance is  tensor(118.2793, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.39648789167404175
distance x is tensor(132.6463, device='cuda:0')
benign distance is  tensor(132.6463, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.16623622179031372
distance x is tensor(120.4919, device='cuda:0')
benign distance is  tensor(120.4919, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.17841090261936188
distance x is tensor(136.8917, device='cuda:0')
benign distance is  tensor(136.8917, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.1848963499069214
distance x is tensor(108.3516, device='cuda:0')
benign distance is  tensor(108.3516, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5756770372390747
distance x is tensor(142.2052, device='cuda:0')
benign distance is  tensor(142.2052, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.548227071762085
distance x is tensor(120.5324, device='cuda:0')
benign distance is  tensor(120.5324, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.36678361892700195
distance x is tensor(121.9913, device='cuda:0')
benign distance is  tensor(121.9913, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3138574957847595
distance x is tensor(143.3703, device='cuda:0')
benign distance is  tensor(143.3703, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7824699878692627
distance x is tensor(156.2475, device='cuda:0')
benign distance is  tensor(156.2475, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.36718398332595825
distance x is tensor(136.6389, device='cuda:0')
benign distance is  tensor(136.6389, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.25459742546081543
distance x is tensor(126.2590, device='cuda:0')
benign distance is  tensor(126.2590, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.1282767355442047
distance x is tensor(97.2625, device='cuda:0')
benign distance is  tensor(97.2625, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5118080973625183
distance x is tensor(132.5523, device='cuda:0')
benign distance is  tensor(132.5523, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.6342028379440308
distance x is tensor(152.3855, device='cuda:0')
benign distance is  tensor(152.3855, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5443459749221802
distance x is tensor(118.8102, device='cuda:0')
benign distance is  tensor(118.8102, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.7464673519134521
mal_entropy is 0.07199970632791519
user_PLR len size 28
counter_tensor is  tensor([24., 12., 18., 23., 27., 22., 27., 16., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 25., 25., 26., 26., 27., 12., 12.])
count_res tensor([1.2198e-02, 7.4946e-08, 3.0236e-05, 4.4874e-03, 2.4500e-01, 1.6508e-03,
        2.4500e-01, 4.0919e-06, 4.0919e-06, 4.0919e-06, 4.0919e-06, 4.0919e-06,
        4.0919e-06, 4.0919e-06, 4.0919e-06, 4.0919e-06, 4.0919e-06, 4.0919e-06,
        4.0919e-06, 4.0919e-06, 7.4946e-08, 3.3157e-02, 3.3157e-02, 9.0131e-02,
        9.0131e-02, 2.4500e-01, 7.4946e-08, 7.4946e-08])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 89.85% 

Test Accuracy: 88.88% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.24526353180408478
distance x is tensor(104.0357, device='cuda:0')
benign distance is  tensor(104.0357, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4769654870033264
distance x is tensor(120.4469, device='cuda:0')
benign distance is  tensor(120.4469, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1186235100030899
distance x is tensor(118.7889, device='cuda:0')
benign distance is  tensor(118.7889, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.224527508020401
distance x is tensor(119.0009, device='cuda:0')
benign distance is  tensor(119.0009, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.755882203578949
distance x is tensor(80.2839, device='cuda:0')
benign distance is  tensor(80.2839, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6462306380271912
distance x is tensor(133.7810, device='cuda:0')
benign distance is  tensor(133.7810, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.11615566164255142
distance x is tensor(100.6230, device='cuda:0')
benign distance is  tensor(100.6230, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6830256581306458
distance x is tensor(123.0426, device='cuda:0')
benign distance is  tensor(123.0426, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.26825955510139465
distance x is tensor(139.7553, device='cuda:0')
benign distance is  tensor(139.7553, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6607695817947388
distance x is tensor(123.9252, device='cuda:0')
benign distance is  tensor(123.9252, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7033044695854187
distance x is tensor(129.2068, device='cuda:0')
benign distance is  tensor(129.2068, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7002836465835571
distance x is tensor(119.2434, device='cuda:0')
benign distance is  tensor(119.2434, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.2524767518043518
distance x is tensor(126.9004, device='cuda:0')
benign distance is  tensor(126.9004, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.06482881307601929
distance x is tensor(106.2667, device='cuda:0')
benign distance is  tensor(106.2667, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5749679803848267
distance x is tensor(138.1236, device='cuda:0')
benign distance is  tensor(138.1236, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4291355013847351
distance x is tensor(126.8125, device='cuda:0')
benign distance is  tensor(126.8125, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.33133119344711304
mal_entropy is 0.07669013738632202
user_PLR len size 20
counter_tensor is  tensor([12., 13., 13., 13., 12., 13., 13., 19., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7112e-05, 7.3699e-05, 7.3699e-05, 7.3699e-05, 2.7112e-05, 7.3699e-05,
        7.3699e-05, 2.9732e-02, 8.0820e-02, 8.0820e-02, 8.0820e-02, 8.0820e-02,
        8.0820e-02, 8.0820e-02, 8.0820e-02, 8.0820e-02, 8.0820e-02, 8.0820e-02,
        8.0820e-02, 8.0820e-02])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 88.37% 

Test Accuracy: 87.60% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.29815873503685
distance x is tensor(146.3456, device='cuda:0')
benign distance is  tensor(146.3456, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5447261929512024
distance x is tensor(152.6532, device='cuda:0')
benign distance is  tensor(152.6532, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.09649692475795746
distance x is tensor(152.5992, device='cuda:0')
benign distance is  tensor(152.5992, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.43821603059768677
distance x is tensor(147.1925, device='cuda:0')
benign distance is  tensor(147.1925, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.11892905086278915
distance x is tensor(109.9798, device='cuda:0')
benign distance is  tensor(109.9798, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5696864128112793
distance x is tensor(151.0912, device='cuda:0')
benign distance is  tensor(151.0912, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2796589732170105
distance x is tensor(127.2439, device='cuda:0')
benign distance is  tensor(127.2439, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4120299220085144
distance x is tensor(138.3854, device='cuda:0')
benign distance is  tensor(138.3854, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.9970420598983765
mal_entropy is 0.0062928954139351845
user_PLR len size 52
counter_tensor is  tensor([35., 27., 43., 30., 51., 45., 51., 46., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 44., 26., 51., 28., 24., 50., 32., 22.,
        41., 14., 46., 37., 19., 37., 17., 50., 42., 46., 15., 34., 48., 19.,
        28., 18., 34., 29., 38., 17., 49., 51., 28., 48.])
count_res tensor([2.2530e-08, 7.5579e-12, 6.7160e-05, 1.5180e-10, 2.0020e-01, 4.9625e-04,
        2.0020e-01, 1.3489e-03, 3.3437e-06, 3.3437e-06, 3.3437e-06, 3.3437e-06,
        3.3437e-06, 3.3437e-06, 3.3437e-06, 3.3437e-06, 3.3437e-06, 3.3437e-06,
        3.3437e-06, 3.3437e-06, 1.8256e-04, 2.7804e-12, 2.0020e-01, 2.0544e-11,
        3.7628e-13, 7.3650e-02, 1.1217e-09, 5.0924e-14, 9.0891e-06, 1.7083e-17,
        1.3489e-03, 1.6647e-07, 2.5354e-15, 1.6647e-07, 3.4313e-16, 7.3650e-02,
        2.4707e-05, 1.3489e-03, 4.6437e-17, 8.2882e-09, 9.9674e-03, 2.5354e-15,
        2.0544e-11, 9.3271e-16, 8.2882e-09, 5.5845e-11, 4.5252e-07, 3.4313e-16,
        2.7094e-02, 2.0020e-01, 2.0544e-11, 9.9674e-03])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 89.85% 

Test Accuracy: 88.60% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7414838075637817
distance x is tensor(134.1292, device='cuda:0')
benign distance is  tensor(134.1292, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3043515086174011
distance x is tensor(144.3209, device='cuda:0')
benign distance is  tensor(144.3209, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.33024269342422485
distance x is tensor(129.3965, device='cuda:0')
benign distance is  tensor(129.3965, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.41203370690345764
distance x is tensor(128.9007, device='cuda:0')
benign distance is  tensor(128.9007, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5640636682510376
distance x is tensor(88.4468, device='cuda:0')
benign distance is  tensor(88.4468, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.28163012862205505
distance x is tensor(140.7397, device='cuda:0')
benign distance is  tensor(140.7397, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1309954822063446
distance x is tensor(102.8436, device='cuda:0')
benign distance is  tensor(102.8436, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4927971363067627
distance x is tensor(140.4542, device='cuda:0')
benign distance is  tensor(140.4542, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4974803924560547
distance x is tensor(135.3113, device='cuda:0')
benign distance is  tensor(135.3113, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7952844500541687
distance x is tensor(128.3615, device='cuda:0')
benign distance is  tensor(128.3615, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.37765926122665405
distance x is tensor(126.0799, device='cuda:0')
benign distance is  tensor(126.0799, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5228421092033386
distance x is tensor(126.6129, device='cuda:0')
benign distance is  tensor(126.6129, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.31328028440475464
distance x is tensor(139.5264, device='cuda:0')
benign distance is  tensor(139.5264, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.16626785695552826
distance x is tensor(120.2120, device='cuda:0')
benign distance is  tensor(120.2120, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4015042781829834
distance x is tensor(140.6748, device='cuda:0')
benign distance is  tensor(140.6748, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9824881553649902
distance x is tensor(122.4387, device='cuda:0')
benign distance is  tensor(122.4387, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.40678954124450684
distance x is tensor(142.7276, device='cuda:0')
benign distance is  tensor(142.7276, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.2823929488658905
distance x is tensor(152.4329, device='cuda:0')
benign distance is  tensor(152.4329, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.544562578201294
distance x is tensor(124.6716, device='cuda:0')
benign distance is  tensor(124.6716, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.5175877809524536
distance x is tensor(133.1925, device='cuda:0')
benign distance is  tensor(133.1925, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.29749828577041626
distance x is tensor(142.8967, device='cuda:0')
benign distance is  tensor(142.8967, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7351036071777344
distance x is tensor(138.0595, device='cuda:0')
benign distance is  tensor(138.0595, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5022826790809631
distance x is tensor(152.8869, device='cuda:0')
benign distance is  tensor(152.8869, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.20627132058143616
distance x is tensor(135.5025, device='cuda:0')
benign distance is  tensor(135.5025, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3785819709300995
distance x is tensor(147.9585, device='cuda:0')
benign distance is  tensor(147.9585, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.4015277922153473
distance x is tensor(144.5598, device='cuda:0')
benign distance is  tensor(144.5598, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.2191298007965088
distance x is tensor(144.4541, device='cuda:0')
benign distance is  tensor(144.4541, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4682767987251282
distance x is tensor(148.8082, device='cuda:0')
benign distance is  tensor(148.8082, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.45358261466026306
distance x is tensor(140.2289, device='cuda:0')
benign distance is  tensor(140.2289, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6069866418838501
distance x is tensor(146.9104, device='cuda:0')
benign distance is  tensor(146.9104, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.41450586915016174
distance x is tensor(143.2767, device='cuda:0')
benign distance is  tensor(143.2767, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.24489445984363556
distance x is tensor(137.3573, device='cuda:0')
benign distance is  tensor(137.3573, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.11344431340694427
distance x is tensor(162.3243, device='cuda:0')
benign distance is  tensor(162.3243, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.11068794876337051
distance x is tensor(149.9703, device='cuda:0')
benign distance is  tensor(149.9703, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.07837654650211334
distance x is tensor(121.6725, device='cuda:0')
benign distance is  tensor(121.6725, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.49060362577438354
distance x is tensor(132.7621, device='cuda:0')
benign distance is  tensor(132.7621, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.21115510165691376
distance x is tensor(133.8834, device='cuda:0')
benign distance is  tensor(133.8834, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.41719165444374084
distance x is tensor(130.2360, device='cuda:0')
benign distance is  tensor(130.2360, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.27058061957359314
distance x is tensor(151.4385, device='cuda:0')
benign distance is  tensor(151.4385, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.1378290206193924
distance x is tensor(146.4701, device='cuda:0')
benign distance is  tensor(146.4701, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.42622989416122437
mal_entropy is 0.10061504691839218
user_PLR len size 28
counter_tensor is  tensor([12., 16., 12., 27., 12., 27., 15., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 12., 25., 12., 12., 12.,  0.])
count_res tensor([1.4324e-07, 7.8208e-06, 1.4324e-07, 4.6826e-01, 1.4324e-07, 4.6826e-01,
        2.8771e-06, 1.4324e-07, 7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06,
        7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06,
        7.8208e-06, 7.8208e-06, 1.4324e-07, 1.4324e-07, 1.4324e-07, 6.3372e-02,
        1.4324e-07, 1.4324e-07, 1.4324e-07, 8.8011e-13])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 88.88% 

Test Accuracy: 87.79% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.1228446513414383
distance x is tensor(137.5146, device='cuda:0')
benign distance is  tensor(137.5146, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.38291287422180176
distance x is tensor(139.6209, device='cuda:0')
benign distance is  tensor(139.6209, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.28886300325393677
distance x is tensor(138.8020, device='cuda:0')
benign distance is  tensor(138.8020, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.859265923500061
distance x is tensor(104.6075, device='cuda:0')
benign distance is  tensor(104.6075, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3813776671886444
distance x is tensor(107.5302, device='cuda:0')
benign distance is  tensor(107.5302, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9743694067001343
distance x is tensor(112.4411, device='cuda:0')
benign distance is  tensor(112.4411, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.18531635403633118
distance x is tensor(115.7038, device='cuda:0')
benign distance is  tensor(115.7038, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.0686318427324295
distance x is tensor(126.1348, device='cuda:0')
benign distance is  tensor(126.1348, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.24848327040672302
distance x is tensor(134.0237, device='cuda:0')
benign distance is  tensor(134.0237, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.19299428164958954
distance x is tensor(143.9353, device='cuda:0')
benign distance is  tensor(143.9353, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5509182214736938
distance x is tensor(143.3133, device='cuda:0')
benign distance is  tensor(143.3133, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.28387483954429626
distance x is tensor(140.7531, device='cuda:0')
benign distance is  tensor(140.7531, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.17062488198280334
distance x is tensor(144.9008, device='cuda:0')
benign distance is  tensor(144.9008, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.36128509044647217
distance x is tensor(135.1897, device='cuda:0')
benign distance is  tensor(135.1897, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.20382869243621826
distance x is tensor(123.2909, device='cuda:0')
benign distance is  tensor(123.2909, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.1836632490158081
distance x is tensor(143.1771, device='cuda:0')
benign distance is  tensor(143.1771, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.5920718908309937
mal_entropy is 0.15823210775852203
user_PLR len size 28
counter_tensor is  tensor([17., 26., 23., 27., 26., 22., 18., 15., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 22., 21., 26., 27., 27., 27., 18., 22.])
count_res tensor([8.8238e-06, 7.1500e-02, 3.5598e-03, 1.9436e-01, 7.1500e-02, 1.3096e-03,
        2.3986e-05, 1.1942e-06, 3.2461e-06, 3.2461e-06, 3.2461e-06, 3.2461e-06,
        3.2461e-06, 3.2461e-06, 3.2461e-06, 3.2461e-06, 3.2461e-06, 3.2461e-06,
        3.2461e-06, 3.2461e-06, 1.3096e-03, 4.8177e-04, 7.1500e-02, 1.9436e-01,
        1.9436e-01, 1.9436e-01, 2.3986e-05, 1.3096e-03])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 89.62% 

Test Accuracy: 88.39% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9277924299240112
distance x is tensor(122.0414, device='cuda:0')
benign distance is  tensor(122.0414, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4703589975833893
distance x is tensor(127.9458, device='cuda:0')
benign distance is  tensor(127.9458, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2173607349395752
distance x is tensor(126.5927, device='cuda:0')
benign distance is  tensor(126.5927, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3284982740879059
distance x is tensor(121.5182, device='cuda:0')
benign distance is  tensor(121.5182, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.746797502040863
distance x is tensor(96.1963, device='cuda:0')
benign distance is  tensor(96.1963, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1984535455703735
distance x is tensor(139.6482, device='cuda:0')
benign distance is  tensor(139.6482, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.38424405455589294
distance x is tensor(104.6932, device='cuda:0')
benign distance is  tensor(104.6932, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6472389101982117
distance x is tensor(126.3390, device='cuda:0')
benign distance is  tensor(126.3390, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.12551145255565643
distance x is tensor(136.9243, device='cuda:0')
benign distance is  tensor(136.9243, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.21898634731769562
distance x is tensor(139.3139, device='cuda:0')
benign distance is  tensor(139.3139, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3327721953392029
distance x is tensor(137.6331, device='cuda:0')
benign distance is  tensor(137.6331, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6329768300056458
distance x is tensor(113.9473, device='cuda:0')
benign distance is  tensor(113.9473, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.48177385330200195
distance x is tensor(123.9453, device='cuda:0')
benign distance is  tensor(123.9453, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.15180298686027527
distance x is tensor(82.0685, device='cuda:0')
benign distance is  tensor(82.0685, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4914412498474121
distance x is tensor(144.5250, device='cuda:0')
benign distance is  tensor(144.5250, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3906196057796478
distance x is tensor(129.4563, device='cuda:0')
benign distance is  tensor(129.4563, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.7813853025436401
mal_entropy is 0.02847656048834324
user_PLR len size 28
counter_tensor is  tensor([12., 17., 12., 27., 12., 12., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 25., 12., 12., 27.,  0., 12., 12., 12.])
count_res tensor([1.4324e-07, 2.1259e-05, 1.4324e-07, 4.6826e-01, 1.4324e-07, 1.4324e-07,
        1.4324e-07, 1.4324e-07, 7.8207e-06, 7.8207e-06, 7.8207e-06, 7.8207e-06,
        7.8207e-06, 7.8207e-06, 7.8207e-06, 7.8207e-06, 7.8207e-06, 7.8207e-06,
        7.8207e-06, 7.8207e-06, 6.3372e-02, 1.4324e-07, 1.4324e-07, 4.6826e-01,
        8.8010e-13, 1.4324e-07, 1.4324e-07, 1.4324e-07])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 88.97% 

Test Accuracy: 87.89% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.32078778743743896
distance x is tensor(139.9387, device='cuda:0')
benign distance is  tensor(139.9387, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4779878556728363
distance x is tensor(127.5932, device='cuda:0')
benign distance is  tensor(127.5932, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.29327017068862915
distance x is tensor(131.8834, device='cuda:0')
benign distance is  tensor(131.8834, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2591097056865692
distance x is tensor(92.1511, device='cuda:0')
benign distance is  tensor(92.1511, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.31613072752952576
distance x is tensor(124.1614, device='cuda:0')
benign distance is  tensor(124.1614, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8379057049751282
distance x is tensor(149.4575, device='cuda:0')
benign distance is  tensor(149.4575, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.34832650423049927
distance x is tensor(114.2288, device='cuda:0')
benign distance is  tensor(114.2288, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.15401235222816467
distance x is tensor(129.5396, device='cuda:0')
benign distance is  tensor(129.5396, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3430545926094055
distance x is tensor(137.8355, device='cuda:0')
benign distance is  tensor(137.8355, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5966019630432129
distance x is tensor(155.2067, device='cuda:0')
benign distance is  tensor(155.2067, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2709876596927643
distance x is tensor(132.1292, device='cuda:0')
benign distance is  tensor(132.1292, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.1978835016489029
distance x is tensor(113.7464, device='cuda:0')
benign distance is  tensor(113.7464, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0142438411712646
distance x is tensor(128.5063, device='cuda:0')
benign distance is  tensor(128.5063, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.372135728597641
distance x is tensor(139.7754, device='cuda:0')
benign distance is  tensor(139.7754, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.24025824666023254
distance x is tensor(149.8104, device='cuda:0')
benign distance is  tensor(149.8104, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.2771819531917572
distance x is tensor(138.0493, device='cuda:0')
benign distance is  tensor(138.0493, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8000000005000001
mal_loss is 0.25722092390060425
mal_entropy is 0.134341761469841
user_PLR len size 36
counter_tensor is  tensor([12., 12., 35., 35.,  0., 12., 34., 35., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 12., 35., 12., 12., 12., 35., 35., 12.,
        12., 12., 12., 12., 31., 31., 12., 12.])
count_res tensor([1.6022e-11, 1.6022e-11, 1.5614e-01, 1.5614e-01, 9.8445e-17, 1.6022e-11,
        5.7439e-02, 1.5614e-01, 2.6077e-06, 2.6077e-06, 2.6077e-06, 2.6077e-06,
        2.6077e-06, 2.6077e-06, 2.6077e-06, 2.6077e-06, 2.6077e-06, 2.6077e-06,
        2.6077e-06, 2.6077e-06, 1.6022e-11, 1.5614e-01, 1.6022e-11, 1.6022e-11,
        1.6022e-11, 1.5614e-01, 1.5614e-01, 1.6022e-11, 1.6022e-11, 1.6022e-11,
        1.6022e-11, 1.6022e-11, 2.8597e-03, 2.8597e-03, 1.6022e-11, 1.6022e-11])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 89.77% 

Test Accuracy: 88.72% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.19997353851795197
distance x is tensor(129.6506, device='cuda:0')
benign distance is  tensor(129.6506, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6478814482688904
distance x is tensor(128.7333, device='cuda:0')
benign distance is  tensor(128.7333, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.36130642890930176
distance x is tensor(122.5277, device='cuda:0')
benign distance is  tensor(122.5277, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5995056629180908
distance x is tensor(87.9677, device='cuda:0')
benign distance is  tensor(87.9677, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2959257662296295
distance x is tensor(84.8261, device='cuda:0')
benign distance is  tensor(84.8261, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0623294115066528
distance x is tensor(130.1991, device='cuda:0')
benign distance is  tensor(130.1991, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.34517624974250793
distance x is tensor(95.6737, device='cuda:0')
benign distance is  tensor(95.6737, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2553246319293976
distance x is tensor(126.7082, device='cuda:0')
benign distance is  tensor(126.7082, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.18327732384204865
distance x is tensor(132.2636, device='cuda:0')
benign distance is  tensor(132.2636, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4196920394897461
distance x is tensor(133.1789, device='cuda:0')
benign distance is  tensor(133.1789, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.24029850959777832
distance x is tensor(122.5154, device='cuda:0')
benign distance is  tensor(122.5154, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.36181920766830444
distance x is tensor(124.6368, device='cuda:0')
benign distance is  tensor(124.6368, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5129836797714233
distance x is tensor(134.3964, device='cuda:0')
benign distance is  tensor(134.3964, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.17184031009674072
distance x is tensor(102.5491, device='cuda:0')
benign distance is  tensor(102.5491, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.42787104845046997
distance x is tensor(145.2200, device='cuda:0')
benign distance is  tensor(145.2200, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6639012694358826
distance x is tensor(131.5735, device='cuda:0')
benign distance is  tensor(131.5735, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.1330956369638443
distance x is tensor(155.4296, device='cuda:0')
benign distance is  tensor(155.4296, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.2916034758090973
distance x is tensor(131.6487, device='cuda:0')
benign distance is  tensor(131.6487, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.6117265820503235
distance x is tensor(139.5215, device='cuda:0')
benign distance is  tensor(139.5215, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.6474040150642395
distance x is tensor(136.2851, device='cuda:0')
benign distance is  tensor(136.2851, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9494197964668274
distance x is tensor(135.8228, device='cuda:0')
benign distance is  tensor(135.8228, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.1758524477481842
distance x is tensor(125.2977, device='cuda:0')
benign distance is  tensor(125.2977, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.25747188925743103
distance x is tensor(137.7396, device='cuda:0')
benign distance is  tensor(137.7396, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.07467285543680191
distance x is tensor(137.2729, device='cuda:0')
benign distance is  tensor(137.2729, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.2299261838197708
mal_entropy is 0.042676594108343124
user_PLR len size 20
counter_tensor is  tensor([14., 14., 14., 13., 19., 14., 14., 13., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.0019e-04, 2.0019e-04, 2.0019e-04, 7.3645e-05, 2.9711e-02, 2.0019e-04,
        2.0019e-04, 7.3645e-05, 8.0762e-02, 8.0762e-02, 8.0762e-02, 8.0762e-02,
        8.0762e-02, 8.0762e-02, 8.0762e-02, 8.0762e-02, 8.0762e-02, 8.0762e-02,
        8.0762e-02, 8.0762e-02])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 88.23% 

Test Accuracy: 87.30% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.08601219952106476
distance x is tensor(136.7493, device='cuda:0')
benign distance is  tensor(136.7493, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.363408625125885
distance x is tensor(158.1410, device='cuda:0')
benign distance is  tensor(158.1410, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6085928678512573
distance x is tensor(135.2935, device='cuda:0')
benign distance is  tensor(135.2935, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7973971366882324
distance x is tensor(150.7554, device='cuda:0')
benign distance is  tensor(150.7554, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5686042904853821
distance x is tensor(123.8114, device='cuda:0')
benign distance is  tensor(123.8114, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.40266767144203186
distance x is tensor(151.4812, device='cuda:0')
benign distance is  tensor(151.4812, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.35600921511650085
distance x is tensor(130.1046, device='cuda:0')
benign distance is  tensor(130.1046, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1543220430612564
distance x is tensor(148.7675, device='cuda:0')
benign distance is  tensor(148.7675, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.9696338772773743
mal_entropy is 0.027561543509364128
user_PLR len size 52
counter_tensor is  tensor([39., 39., 22., 22., 18., 49., 51., 22., 39., 39., 39., 39., 39., 39.,
        39., 39., 39., 39., 39., 39., 51., 44., 36., 51., 35., 46., 48., 50.,
        46.,  7., 46., 41.,  6., 16., 41., 47., 51., 25.,  6., 19., 37., 19.,
        44., 51., 40., 39., 47., 40., 50., 50., 24., 25.])
count_res tensor([9.6795e-07, 9.6795e-07, 4.0073e-14, 4.0073e-14, 7.3395e-16, 2.1321e-02,
        1.5754e-01, 4.0073e-14, 9.6795e-07, 9.6795e-07, 9.6795e-07, 9.6795e-07,
        9.6795e-07, 9.6795e-07, 9.6795e-07, 9.6795e-07, 9.6795e-07, 9.6795e-07,
        9.6795e-07, 9.6795e-07, 1.5754e-01, 1.4366e-04, 4.8191e-08, 1.5754e-01,
        1.7729e-08, 1.0615e-03, 7.8434e-03, 5.7955e-02, 1.0615e-03, 1.2258e-20,
        1.0615e-03, 7.1522e-06, 4.5096e-21, 9.9330e-17, 7.1522e-06, 2.8854e-03,
        1.5754e-01, 8.0488e-13, 4.5096e-21, 1.9951e-15, 1.3100e-07, 1.9951e-15,
        1.4366e-04, 1.5754e-01, 2.6312e-06, 9.6795e-07, 2.8854e-03, 2.6312e-06,
        5.7955e-02, 5.7955e-02, 2.9610e-13, 8.0488e-13])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 89.74% 

Test Accuracy: 88.69% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.44737595319747925
distance x is tensor(125.2361, device='cuda:0')
benign distance is  tensor(125.2361, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8982127904891968
distance x is tensor(120.5226, device='cuda:0')
benign distance is  tensor(120.5226, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.40230950713157654
distance x is tensor(124.0922, device='cuda:0')
benign distance is  tensor(124.0922, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1921800374984741
distance x is tensor(114.8640, device='cuda:0')
benign distance is  tensor(114.8640, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.619456946849823
distance x is tensor(88.5147, device='cuda:0')
benign distance is  tensor(88.5147, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6662712097167969
distance x is tensor(126.0231, device='cuda:0')
benign distance is  tensor(126.0231, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.16583232581615448
distance x is tensor(82.4829, device='cuda:0')
benign distance is  tensor(82.4829, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4080421030521393
distance x is tensor(121.8805, device='cuda:0')
benign distance is  tensor(121.8805, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2952791750431061
distance x is tensor(125.3103, device='cuda:0')
benign distance is  tensor(125.3103, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.29939737915992737
distance x is tensor(129.5728, device='cuda:0')
benign distance is  tensor(129.5728, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7481628656387329
distance x is tensor(133.2529, device='cuda:0')
benign distance is  tensor(133.2529, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.24200022220611572
distance x is tensor(121.6965, device='cuda:0')
benign distance is  tensor(121.6965, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.29720988869667053
distance x is tensor(129.7270, device='cuda:0')
benign distance is  tensor(129.7270, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.22206418216228485
distance x is tensor(102.9842, device='cuda:0')
benign distance is  tensor(102.9842, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.378062903881073
distance x is tensor(132.9047, device='cuda:0')
benign distance is  tensor(132.9047, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.18312934041023254
distance x is tensor(121.1831, device='cuda:0')
benign distance is  tensor(121.1831, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5398644804954529
distance x is tensor(127.3561, device='cuda:0')
benign distance is  tensor(127.3561, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8692741394042969
distance x is tensor(139.4509, device='cuda:0')
benign distance is  tensor(139.4509, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.21802513301372528
distance x is tensor(139.4193, device='cuda:0')
benign distance is  tensor(139.4193, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.16911660134792328
distance x is tensor(119.8039, device='cuda:0')
benign distance is  tensor(119.8039, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.8751489520072937
distance x is tensor(123.3357, device='cuda:0')
benign distance is  tensor(123.3357, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6969748735427856
distance x is tensor(126.2185, device='cuda:0')
benign distance is  tensor(126.2185, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.27791306376457214
distance x is tensor(141.0630, device='cuda:0')
benign distance is  tensor(141.0630, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.33925285935401917
distance x is tensor(115.3880, device='cuda:0')
benign distance is  tensor(115.3880, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7764957547187805
distance x is tensor(127.8715, device='cuda:0')
benign distance is  tensor(127.8715, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.506081223487854
distance x is tensor(128.7762, device='cuda:0')
benign distance is  tensor(128.7762, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.9172744750976562
distance x is tensor(137.2063, device='cuda:0')
benign distance is  tensor(137.2063, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.1566440314054489
distance x is tensor(116.4312, device='cuda:0')
benign distance is  tensor(116.4312, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.37043288350105286
distance x is tensor(138.3812, device='cuda:0')
benign distance is  tensor(138.3812, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.30836647748947144
distance x is tensor(134.4425, device='cuda:0')
benign distance is  tensor(134.4425, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.26946699619293213
distance x is tensor(121.1514, device='cuda:0')
benign distance is  tensor(121.1514, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.29839736223220825
distance x is tensor(123.8382, device='cuda:0')
benign distance is  tensor(123.8382, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.03751958906650543
distance x is tensor(130.9892, device='cuda:0')
benign distance is  tensor(130.9892, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.16593605279922485
distance x is tensor(126.2796, device='cuda:0')
benign distance is  tensor(126.2796, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.1721843034029007
distance x is tensor(119.4396, device='cuda:0')
benign distance is  tensor(119.4396, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.40865325927734375
distance x is tensor(122.0851, device='cuda:0')
benign distance is  tensor(122.0851, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.13227015733718872
distance x is tensor(131.5983, device='cuda:0')
benign distance is  tensor(131.5983, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5505190491676331
distance x is tensor(123.9821, device='cuda:0')
benign distance is  tensor(123.9821, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.707912266254425
distance x is tensor(136.4999, device='cuda:0')
benign distance is  tensor(136.4999, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.4093506932258606
distance x is tensor(130.0979, device='cuda:0')
benign distance is  tensor(130.0979, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.06997714936733246
mal_entropy is 0.07722251117229462
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 19., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7119e-05, 2.7119e-05, 2.7119e-05, 2.9739e-02, 2.7119e-05, 2.7119e-05,
        2.7119e-05, 2.7119e-05, 8.0839e-02, 8.0839e-02, 8.0839e-02, 8.0839e-02,
        8.0839e-02, 8.0839e-02, 8.0839e-02, 8.0839e-02, 8.0839e-02, 8.0839e-02,
        8.0839e-02, 8.0839e-02])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 88.48% 

Test Accuracy: 86.99% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4916188716888428
distance x is tensor(148.6069, device='cuda:0')
benign distance is  tensor(148.6069, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.10949981212615967
distance x is tensor(142.4856, device='cuda:0')
benign distance is  tensor(142.4856, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.22671575844287872
distance x is tensor(141.9910, device='cuda:0')
benign distance is  tensor(141.9910, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5397166013717651
distance x is tensor(133.6802, device='cuda:0')
benign distance is  tensor(133.6802, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7426792979240417
distance x is tensor(119.4424, device='cuda:0')
benign distance is  tensor(119.4424, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5078173279762268
distance x is tensor(138.6426, device='cuda:0')
benign distance is  tensor(138.6426, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3450937867164612
distance x is tensor(105.9594, device='cuda:0')
benign distance is  tensor(105.9594, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.432303249835968
distance x is tensor(137.4023, device='cuda:0')
benign distance is  tensor(137.4023, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.6914516091346741
mal_entropy is 0.10337541252374649
user_PLR len size 36
counter_tensor is  tensor([30., 25., 20., 28., 35., 29., 32., 32., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 34., 19., 23., 21., 23., 31., 19., 35.,
        35., 19., 34., 34., 25., 33., 30., 30.])
count_res tensor([1.5381e-03, 1.0363e-05, 6.9828e-08, 2.0816e-04, 2.2827e-01, 5.6583e-04,
        1.1365e-02, 1.1365e-02, 3.8125e-06, 3.8125e-06, 3.8125e-06, 3.8125e-06,
        3.8125e-06, 3.8125e-06, 3.8125e-06, 3.8125e-06, 3.8125e-06, 3.8125e-06,
        3.8125e-06, 3.8125e-06, 8.3976e-02, 2.5688e-08, 1.4025e-06, 1.8981e-07,
        1.4025e-06, 4.1809e-03, 2.5688e-08, 2.2827e-01, 2.2827e-01, 2.5688e-08,
        8.3976e-02, 8.3976e-02, 1.0363e-05, 3.0893e-02, 1.5381e-03, 1.5381e-03])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 89.72% 

Test Accuracy: 88.73% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.17552277445793152
distance x is tensor(128.8811, device='cuda:0')
benign distance is  tensor(128.8811, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4676227569580078
distance x is tensor(136.9581, device='cuda:0')
benign distance is  tensor(136.9581, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.12153676897287369
distance x is tensor(125.7118, device='cuda:0')
benign distance is  tensor(125.7118, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.0943002700805664
distance x is tensor(110.1850, device='cuda:0')
benign distance is  tensor(110.1850, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2507196068763733
distance x is tensor(78.3494, device='cuda:0')
benign distance is  tensor(78.3494, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.2781732678413391
distance x is tensor(135.4178, device='cuda:0')
benign distance is  tensor(135.4178, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.13552223145961761
distance x is tensor(88.8903, device='cuda:0')
benign distance is  tensor(88.8903, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4229215085506439
distance x is tensor(121.0703, device='cuda:0')
benign distance is  tensor(121.0703, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6578415036201477
distance x is tensor(132.3139, device='cuda:0')
benign distance is  tensor(132.3139, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5599082112312317
distance x is tensor(134.3809, device='cuda:0')
benign distance is  tensor(134.3809, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5592770576477051
distance x is tensor(121.6957, device='cuda:0')
benign distance is  tensor(121.6957, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6725891828536987
distance x is tensor(110.0077, device='cuda:0')
benign distance is  tensor(110.0077, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.28301990032196045
distance x is tensor(130.5418, device='cuda:0')
benign distance is  tensor(130.5418, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.17330190539360046
distance x is tensor(113.4413, device='cuda:0')
benign distance is  tensor(113.4413, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5006126165390015
distance x is tensor(139.0219, device='cuda:0')
benign distance is  tensor(139.0219, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.2610584795475006
distance x is tensor(135.6727, device='cuda:0')
benign distance is  tensor(135.6727, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.026093583554029465
distance x is tensor(148.5663, device='cuda:0')
benign distance is  tensor(148.5663, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.2179878205060959
distance x is tensor(127.8300, device='cuda:0')
benign distance is  tensor(127.8300, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.280896931886673
distance x is tensor(144.5107, device='cuda:0')
benign distance is  tensor(144.5107, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.16297093033790588
distance x is tensor(142.2729, device='cuda:0')
benign distance is  tensor(142.2729, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5500451922416687
distance x is tensor(137.4380, device='cuda:0')
benign distance is  tensor(137.4380, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.3019121289253235
distance x is tensor(141.1032, device='cuda:0')
benign distance is  tensor(141.1032, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.19674785435199738
distance x is tensor(129.1582, device='cuda:0')
benign distance is  tensor(129.1582, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.3462452292442322
distance x is tensor(121.4281, device='cuda:0')
benign distance is  tensor(121.4281, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.11056572198867798
mal_entropy is 0.12762926518917084
user_PLR len size 28
counter_tensor is  tensor([14., 27.,  2., 13., 26., 14., 27., 16., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 14., 27., 14., 27., 14., 19., 14., 26.])
count_res tensor([4.7723e-07, 2.1113e-01, 2.9322e-12, 1.7556e-07, 7.7672e-02, 4.7723e-07,
        2.1113e-01, 3.5263e-06, 3.5263e-06, 3.5263e-06, 3.5263e-06, 3.5263e-06,
        3.5263e-06, 3.5263e-06, 3.5263e-06, 3.5263e-06, 3.5263e-06, 3.5263e-06,
        3.5263e-06, 3.5263e-06, 4.7723e-07, 2.1113e-01, 4.7723e-07, 2.1113e-01,
        4.7723e-07, 7.0828e-05, 4.7723e-07, 7.7672e-02])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 89.76% 

Test Accuracy: 88.60% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.19786281883716583
distance x is tensor(134.7894, device='cuda:0')
benign distance is  tensor(134.7894, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7970045208930969
distance x is tensor(123.3550, device='cuda:0')
benign distance is  tensor(123.3550, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.38061705231666565
distance x is tensor(142.7601, device='cuda:0')
benign distance is  tensor(142.7601, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7447934150695801
distance x is tensor(106.1597, device='cuda:0')
benign distance is  tensor(106.1597, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8849879503250122
distance x is tensor(91.2228, device='cuda:0')
benign distance is  tensor(91.2228, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0713398456573486
distance x is tensor(149.6449, device='cuda:0')
benign distance is  tensor(149.6449, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0811306238174438
distance x is tensor(90.9325, device='cuda:0')
benign distance is  tensor(90.9325, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4423794746398926
distance x is tensor(124.1311, device='cuda:0')
benign distance is  tensor(124.1311, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.372141033411026
distance x is tensor(130.1057, device='cuda:0')
benign distance is  tensor(130.1057, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4739512503147125
distance x is tensor(136.4438, device='cuda:0')
benign distance is  tensor(136.4438, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.04383518174290657
distance x is tensor(140.6506, device='cuda:0')
benign distance is  tensor(140.6506, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.24166814982891083
distance x is tensor(109.8888, device='cuda:0')
benign distance is  tensor(109.8888, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.06379696726799011
distance x is tensor(131.6901, device='cuda:0')
benign distance is  tensor(131.6901, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5885447859764099
distance x is tensor(137.0299, device='cuda:0')
benign distance is  tensor(137.0299, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.22080545127391815
distance x is tensor(152.0538, device='cuda:0')
benign distance is  tensor(152.0538, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6920035481452942
distance x is tensor(122.5849, device='cuda:0')
benign distance is  tensor(122.5849, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.5647009611129761
mal_entropy is 0.07309967279434204
user_PLR len size 28
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 26., 12., 27., 12., 26., 27., 12., 13.])
count_res tensor([1.1181e-07, 1.1181e-07, 1.1181e-07, 1.1181e-07, 1.1181e-07, 1.1181e-07,
        1.1181e-07, 1.1181e-07, 6.1045e-06, 6.1045e-06, 6.1045e-06, 6.1045e-06,
        6.1045e-06, 6.1045e-06, 6.1045e-06, 6.1045e-06, 6.1045e-06, 6.1045e-06,
        6.1045e-06, 6.1045e-06, 1.3446e-01, 1.1181e-07, 3.6550e-01, 1.1181e-07,
        1.3446e-01, 3.6550e-01, 1.1181e-07, 3.0393e-07])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 89.17% 

Test Accuracy: 88.36% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.015935366973280907
distance x is tensor(136.6882, device='cuda:0')
benign distance is  tensor(136.6882, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5158456563949585
distance x is tensor(136.2087, device='cuda:0')
benign distance is  tensor(136.2087, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.010424336418509483
distance x is tensor(141.2219, device='cuda:0')
benign distance is  tensor(141.2219, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5645502805709839
distance x is tensor(126.7268, device='cuda:0')
benign distance is  tensor(126.7268, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6390597820281982
distance x is tensor(101.9719, device='cuda:0')
benign distance is  tensor(101.9719, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7870269417762756
distance x is tensor(140.9489, device='cuda:0')
benign distance is  tensor(140.9489, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2934544086456299
distance x is tensor(116.8108, device='cuda:0')
benign distance is  tensor(116.8108, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.21756641566753387
distance x is tensor(133.2295, device='cuda:0')
benign distance is  tensor(133.2295, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.567401647567749
distance x is tensor(138.0176, device='cuda:0')
benign distance is  tensor(138.0176, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6994322538375854
distance x is tensor(141.5499, device='cuda:0')
benign distance is  tensor(141.5499, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.48842939734458923
distance x is tensor(101.7098, device='cuda:0')
benign distance is  tensor(101.7098, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.17980770766735077
distance x is tensor(122.7494, device='cuda:0')
benign distance is  tensor(122.7494, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.29500293731689453
distance x is tensor(119.6656, device='cuda:0')
benign distance is  tensor(119.6656, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.10023270547389984
distance x is tensor(103.7924, device='cuda:0')
benign distance is  tensor(103.7924, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.21963000297546387
distance x is tensor(137.3455, device='cuda:0')
benign distance is  tensor(137.3455, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7322161793708801
distance x is tensor(136.2446, device='cuda:0')
benign distance is  tensor(136.2446, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.46003788709640503
mal_entropy is 0.05829954147338867
user_PLR len size 28
counter_tensor is  tensor([25., 16., 20., 27., 20., 24., 24., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 16., 21., 18., 27., 24., 27., 26.])
count_res tensor([2.3923e-02, 2.9523e-06, 1.6119e-04, 1.7676e-01, 1.6119e-04, 8.8006e-03,
        8.8006e-03, 1.7676e-01, 2.9523e-06, 2.9523e-06, 2.9523e-06, 2.9523e-06,
        2.9523e-06, 2.9523e-06, 2.9523e-06, 2.9523e-06, 2.9523e-06, 2.9523e-06,
        2.9523e-06, 2.9523e-06, 1.7676e-01, 2.9523e-06, 4.3816e-04, 2.1815e-05,
        1.7676e-01, 8.8006e-03, 1.7676e-01, 6.5028e-02])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 89.51% 

Test Accuracy: 88.62% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.04747939854860306
distance x is tensor(116.2966, device='cuda:0')
benign distance is  tensor(116.2966, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4981287121772766
distance x is tensor(134.2947, device='cuda:0')
benign distance is  tensor(134.2947, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3437105119228363
distance x is tensor(126.2676, device='cuda:0')
benign distance is  tensor(126.2676, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3910102844238281
distance x is tensor(89.0997, device='cuda:0')
benign distance is  tensor(89.0997, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2111845314502716
distance x is tensor(91.6739, device='cuda:0')
benign distance is  tensor(91.6739, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.39093300700187683
distance x is tensor(127.1358, device='cuda:0')
benign distance is  tensor(127.1358, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.44981688261032104
distance x is tensor(106.0639, device='cuda:0')
benign distance is  tensor(106.0639, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2669205069541931
distance x is tensor(108.8593, device='cuda:0')
benign distance is  tensor(108.8593, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.4905206561088562
distance x is tensor(113.2676, device='cuda:0')
benign distance is  tensor(113.2676, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.3832521438598633
distance x is tensor(146.7711, device='cuda:0')
benign distance is  tensor(146.7711, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7354631423950195
distance x is tensor(137.1559, device='cuda:0')
benign distance is  tensor(137.1559, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.14115110039710999
distance x is tensor(125.3420, device='cuda:0')
benign distance is  tensor(125.3420, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5163677334785461
distance x is tensor(115.7588, device='cuda:0')
benign distance is  tensor(115.7588, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.1134880781173706
distance x is tensor(129.7215, device='cuda:0')
benign distance is  tensor(129.7215, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7231589555740356
distance x is tensor(114.3095, device='cuda:0')
benign distance is  tensor(114.3095, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.20946893095970154
distance x is tensor(118.7852, device='cuda:0')
benign distance is  tensor(118.7852, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.13864848017692566
mal_entropy is 0.09066377580165863
user_PLR len size 52
counter_tensor is  tensor([ 0., 15., 51., 50.,  0., 49., 45., 34., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 13., 24.,  0., 12., 14., 51.,  0., 51.,
         0.,  0., 51., 16., 42., 13., 12., 48., 48.,  0.,  0., 51., 51., 46.,
        12.,  0., 51.,  0.,  0., 50., 12., 13.,  0.,  0.])
count_res tensor([8.8913e-24, 2.9066e-17, 1.2531e-01, 4.6099e-02, 8.8913e-24, 1.6959e-02,
        3.1061e-04, 5.1878e-09, 2.0929e-06, 2.0929e-06, 2.0929e-06, 2.0929e-06,
        2.0929e-06, 2.0929e-06, 2.0929e-06, 2.0929e-06, 2.0929e-06, 2.0929e-06,
        2.0929e-06, 2.0929e-06, 3.9336e-18, 2.3552e-13, 8.8913e-24, 1.4471e-18,
        1.0693e-17, 1.2531e-01, 8.8913e-24, 1.2531e-01, 8.8913e-24, 8.8913e-24,
        1.2531e-01, 7.9009e-17, 1.5464e-05, 3.9336e-18, 1.4471e-18, 6.2388e-03,
        6.2388e-03, 8.8913e-24, 8.8913e-24, 1.2531e-01, 1.2531e-01, 8.4433e-04,
        1.4471e-18, 8.8913e-24, 1.2531e-01, 8.8913e-24, 8.8913e-24, 4.6099e-02,
        1.4471e-18, 3.9336e-18, 8.8913e-24, 8.8913e-24])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 89.99% 

Test Accuracy: 89.00% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3940914571285248
distance x is tensor(107.7506, device='cuda:0')
benign distance is  tensor(107.7506, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.33147531747817993
distance x is tensor(129.6616, device='cuda:0')
benign distance is  tensor(129.6616, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.25574517250061035
distance x is tensor(131.7394, device='cuda:0')
benign distance is  tensor(131.7394, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6860272884368896
distance x is tensor(103.0244, device='cuda:0')
benign distance is  tensor(103.0244, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3293536305427551
distance x is tensor(79.7249, device='cuda:0')
benign distance is  tensor(79.7249, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.49393758177757263
distance x is tensor(132.0024, device='cuda:0')
benign distance is  tensor(132.0024, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3266119360923767
distance x is tensor(92.4874, device='cuda:0')
benign distance is  tensor(92.4874, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.16223843395709991
distance x is tensor(116.0827, device='cuda:0')
benign distance is  tensor(116.0827, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.21259590983390808
distance x is tensor(129.3672, device='cuda:0')
benign distance is  tensor(129.3672, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5211571455001831
distance x is tensor(134.3161, device='cuda:0')
benign distance is  tensor(134.3161, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.45651865005493164
distance x is tensor(120.6810, device='cuda:0')
benign distance is  tensor(120.6810, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9842157363891602
distance x is tensor(120.8251, device='cuda:0')
benign distance is  tensor(120.8251, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3015986382961273
distance x is tensor(129.4306, device='cuda:0')
benign distance is  tensor(129.4306, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5005711913108826
distance x is tensor(95.3284, device='cuda:0')
benign distance is  tensor(95.3284, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.09447739273309708
distance x is tensor(136.9607, device='cuda:0')
benign distance is  tensor(136.9607, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7302520871162415
distance x is tensor(121.8822, device='cuda:0')
benign distance is  tensor(121.8822, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.41177624464035034
distance x is tensor(124.2956, device='cuda:0')
benign distance is  tensor(124.2956, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5868672728538513
distance x is tensor(146.7390, device='cuda:0')
benign distance is  tensor(146.7390, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.32595735788345337
distance x is tensor(135.5556, device='cuda:0')
benign distance is  tensor(135.5556, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.16817088425159454
distance x is tensor(117.2806, device='cuda:0')
benign distance is  tensor(117.2806, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4357781410217285
distance x is tensor(125.6197, device='cuda:0')
benign distance is  tensor(125.6197, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.2798268795013428
distance x is tensor(127.1349, device='cuda:0')
benign distance is  tensor(127.1349, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.21197588741779327
distance x is tensor(134.0507, device='cuda:0')
benign distance is  tensor(134.0507, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.11720075458288193
distance x is tensor(121.6500, device='cuda:0')
benign distance is  tensor(121.6500, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.2339657098054886
distance x is tensor(140.9386, device='cuda:0')
benign distance is  tensor(140.9386, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.40961652994155884
distance x is tensor(123.5125, device='cuda:0')
benign distance is  tensor(123.5125, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.05893241614103317
distance x is tensor(133.1893, device='cuda:0')
benign distance is  tensor(133.1893, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.48695802688598633
distance x is tensor(133.2405, device='cuda:0')
benign distance is  tensor(133.2405, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9358352422714233
distance x is tensor(130.4860, device='cuda:0')
benign distance is  tensor(130.4860, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.3289223611354828
distance x is tensor(128.6664, device='cuda:0')
benign distance is  tensor(128.6664, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  1.03878915309906
distance x is tensor(131.4228, device='cuda:0')
benign distance is  tensor(131.4228, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.2045789211988449
distance x is tensor(123.8264, device='cuda:0')
benign distance is  tensor(123.8264, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.4402920603752136
distance x is tensor(128.2301, device='cuda:0')
benign distance is  tensor(128.2301, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.5660520792007446
distance x is tensor(131.9019, device='cuda:0')
benign distance is  tensor(131.9019, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.14143843948841095
distance x is tensor(118.8121, device='cuda:0')
benign distance is  tensor(118.8121, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.06518242508172989
distance x is tensor(146.2366, device='cuda:0')
benign distance is  tensor(146.2366, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.2684953510761261
distance x is tensor(127.1715, device='cuda:0')
benign distance is  tensor(127.1715, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5008768439292908
distance x is tensor(118.6686, device='cuda:0')
benign distance is  tensor(118.6686, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.29578766226768494
distance x is tensor(143.5947, device='cuda:0')
benign distance is  tensor(143.5947, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.15098752081394196
distance x is tensor(128.8664, device='cuda:0')
benign distance is  tensor(128.8664, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.2980879247188568
mal_entropy is 0.08979244530200958
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 88.88% 

Test Accuracy: 87.79% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4143981337547302
distance x is tensor(134.7824, device='cuda:0')
benign distance is  tensor(134.7824, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.1281113177537918
distance x is tensor(161.8092, device='cuda:0')
benign distance is  tensor(161.8092, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3339536786079407
distance x is tensor(148.0235, device='cuda:0')
benign distance is  tensor(148.0235, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3358260691165924
distance x is tensor(122.6758, device='cuda:0')
benign distance is  tensor(122.6758, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2118157148361206
distance x is tensor(114.4583, device='cuda:0')
benign distance is  tensor(114.4583, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.48909813165664673
distance x is tensor(142.0450, device='cuda:0')
benign distance is  tensor(142.0450, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2177448719739914
distance x is tensor(111.3176, device='cuda:0')
benign distance is  tensor(111.3176, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.22572866082191467
distance x is tensor(141.1727, device='cuda:0')
benign distance is  tensor(141.1727, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.45461979508399963
mal_entropy is 0.08754245191812515
user_PLR len size 28
counter_tensor is  tensor([27., 27., 21., 23., 27., 27., 27., 26., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 17., 25., 25., 19., 27., 26., 15., 26.])
count_res tensor([1.3521e-01, 1.3521e-01, 3.3516e-04, 2.4765e-03, 1.3521e-01, 1.3521e-01,
        1.3521e-01, 4.9742e-02, 2.2583e-06, 2.2583e-06, 2.2583e-06, 2.2583e-06,
        2.2583e-06, 2.2583e-06, 2.2583e-06, 2.2583e-06, 2.2583e-06, 2.2583e-06,
        2.2583e-06, 2.2583e-06, 6.1387e-06, 1.8299e-02, 1.8299e-02, 4.5359e-05,
        1.3521e-01, 4.9742e-02, 8.3078e-07, 4.9742e-02])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 89.68% 

Test Accuracy: 88.68% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2364758998155594
distance x is tensor(121.6179, device='cuda:0')
benign distance is  tensor(121.6179, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7150286436080933
distance x is tensor(127.3168, device='cuda:0')
benign distance is  tensor(127.3168, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6149436831474304
distance x is tensor(142.3718, device='cuda:0')
benign distance is  tensor(142.3718, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.39891067147254944
distance x is tensor(119.7570, device='cuda:0')
benign distance is  tensor(119.7570, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3409406542778015
distance x is tensor(74.8608, device='cuda:0')
benign distance is  tensor(74.8608, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3412936329841614
distance x is tensor(124.8743, device='cuda:0')
benign distance is  tensor(124.8743, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.33342766761779785
distance x is tensor(95.7878, device='cuda:0')
benign distance is  tensor(95.7878, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3815167248249054
distance x is tensor(120.3942, device='cuda:0')
benign distance is  tensor(120.3942, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.22105535864830017
distance x is tensor(144.5394, device='cuda:0')
benign distance is  tensor(144.5394, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.19428180158138275
distance x is tensor(139.4960, device='cuda:0')
benign distance is  tensor(139.4960, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3737747073173523
distance x is tensor(114.4518, device='cuda:0')
benign distance is  tensor(114.4518, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5116385221481323
distance x is tensor(141.3483, device='cuda:0')
benign distance is  tensor(141.3483, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5001004934310913
distance x is tensor(117.7584, device='cuda:0')
benign distance is  tensor(117.7584, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.015285685658454895
distance x is tensor(106.3780, device='cuda:0')
benign distance is  tensor(106.3780, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5904601812362671
distance x is tensor(143.8844, device='cuda:0')
benign distance is  tensor(143.8844, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4400476813316345
distance x is tensor(140.1344, device='cuda:0')
benign distance is  tensor(140.1344, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.7220584750175476
mal_entropy is 0.07217992097139359
user_PLR len size 28
counter_tensor is  tensor([22., 15., 18., 27., 26., 17., 27., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 19., 27., 16., 24., 18., 17., 26., 20.])
count_res tensor([1.4055e-03, 1.2816e-06, 2.5742e-05, 2.0859e-01, 7.6736e-02, 9.4700e-06,
        2.0859e-01, 2.0859e-01, 3.4838e-06, 3.4838e-06, 3.4838e-06, 3.4838e-06,
        3.4838e-06, 3.4838e-06, 3.4838e-06, 3.4838e-06, 3.4838e-06, 3.4838e-06,
        3.4838e-06, 3.4838e-06, 6.9974e-05, 2.0859e-01, 3.4838e-06, 1.0385e-02,
        2.5742e-05, 9.4700e-06, 7.6736e-02, 1.9021e-04])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 89.81% 

Test Accuracy: 88.85% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.627522349357605
distance x is tensor(145.6281, device='cuda:0')
benign distance is  tensor(145.6281, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.779229462146759
distance x is tensor(130.8736, device='cuda:0')
benign distance is  tensor(130.8736, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.623784065246582
distance x is tensor(128.1960, device='cuda:0')
benign distance is  tensor(128.1960, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5967048406600952
distance x is tensor(99.0068, device='cuda:0')
benign distance is  tensor(99.0068, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4102233052253723
distance x is tensor(83.6794, device='cuda:0')
benign distance is  tensor(83.6794, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.41425958275794983
distance x is tensor(140.1051, device='cuda:0')
benign distance is  tensor(140.1051, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.005556201562285423
distance x is tensor(92.3757, device='cuda:0')
benign distance is  tensor(92.3757, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5451439023017883
distance x is tensor(115.3727, device='cuda:0')
benign distance is  tensor(115.3727, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2924361228942871
distance x is tensor(147.5815, device='cuda:0')
benign distance is  tensor(147.5815, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.20673957467079163
distance x is tensor(138.2818, device='cuda:0')
benign distance is  tensor(138.2818, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.36776453256607056
distance x is tensor(148.2187, device='cuda:0')
benign distance is  tensor(148.2187, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.25301364064216614
distance x is tensor(117.7105, device='cuda:0')
benign distance is  tensor(117.7105, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.29124581813812256
distance x is tensor(122.6093, device='cuda:0')
benign distance is  tensor(122.6093, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.14121992886066437
distance x is tensor(138.9291, device='cuda:0')
benign distance is  tensor(138.9291, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.23657222092151642
distance x is tensor(156.0859, device='cuda:0')
benign distance is  tensor(156.0859, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5714709162712097
distance x is tensor(143.3190, device='cuda:0')
benign distance is  tensor(143.3190, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.1806035339832306
mal_entropy is 0.0753251165151596
user_PLR len size 44
counter_tensor is  tensor([ 0., 39.,  0., 43., 40., 12., 40., 12., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 12., 37., 43.,  0., 12., 12., 13.,  0.,
         0., 40., 12.,  0., 12., 20., 12., 43., 43., 42.,  0., 12., 41., 41.,
         0., 12.])
count_res tensor([4.3984e-20, 3.8087e-03, 4.3984e-20, 2.0795e-01, 1.0353e-02, 7.1585e-15,
        1.0353e-02, 7.1585e-15, 3.4731e-06, 3.4731e-06, 3.4731e-06, 3.4731e-06,
        3.4731e-06, 3.4731e-06, 3.4731e-06, 3.4731e-06, 3.4731e-06, 3.4731e-06,
        3.4731e-06, 3.4731e-06, 7.1585e-15, 5.1545e-04, 2.0795e-01, 4.3984e-20,
        7.1585e-15, 7.1585e-15, 1.9459e-14, 4.3984e-20, 4.3984e-20, 1.0353e-02,
        7.1585e-15, 4.3984e-20, 7.1585e-15, 2.1339e-11, 7.1585e-15, 2.0795e-01,
        2.0795e-01, 7.6500e-02, 4.3984e-20, 7.1585e-15, 2.8143e-02, 2.8143e-02,
        4.3984e-20, 7.1585e-15])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 89.79% 

Test Accuracy: 88.76% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.0847432091832161
distance x is tensor(131.5560, device='cuda:0')
benign distance is  tensor(131.5560, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5859106183052063
distance x is tensor(129.0659, device='cuda:0')
benign distance is  tensor(129.0659, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2016657143831253
distance x is tensor(124.8209, device='cuda:0')
benign distance is  tensor(124.8209, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7466300129890442
distance x is tensor(96.3142, device='cuda:0')
benign distance is  tensor(96.3142, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.20582827925682068
distance x is tensor(85.6522, device='cuda:0')
benign distance is  tensor(85.6522, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3229053020477295
distance x is tensor(123.7825, device='cuda:0')
benign distance is  tensor(123.7825, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.16119500994682312
distance x is tensor(102.7565, device='cuda:0')
benign distance is  tensor(102.7565, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7646768689155579
distance x is tensor(111.5861, device='cuda:0')
benign distance is  tensor(111.5861, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.25452733039855957
distance x is tensor(118.6463, device='cuda:0')
benign distance is  tensor(118.6463, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7850834131240845
distance x is tensor(126.4248, device='cuda:0')
benign distance is  tensor(126.4248, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.23693029582500458
distance x is tensor(119.9547, device='cuda:0')
benign distance is  tensor(119.9547, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4729430675506592
distance x is tensor(127.2159, device='cuda:0')
benign distance is  tensor(127.2159, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.2106141597032547
distance x is tensor(141.7797, device='cuda:0')
benign distance is  tensor(141.7797, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.07839875668287277
distance x is tensor(111.0406, device='cuda:0')
benign distance is  tensor(111.0406, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.1435694396495819
distance x is tensor(133.2215, device='cuda:0')
benign distance is  tensor(133.2215, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6398138999938965
distance x is tensor(140.4116, device='cuda:0')
benign distance is  tensor(140.4116, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.33921724557876587
distance x is tensor(154.4804, device='cuda:0')
benign distance is  tensor(154.4804, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6204318404197693
distance x is tensor(133.9263, device='cuda:0')
benign distance is  tensor(133.9263, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.040335435420274734
distance x is tensor(134.7530, device='cuda:0')
benign distance is  tensor(134.7530, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3512844145298004
distance x is tensor(141.1113, device='cuda:0')
benign distance is  tensor(141.1113, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.84095299243927
distance x is tensor(132.8287, device='cuda:0')
benign distance is  tensor(132.8287, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.16783860325813293
distance x is tensor(136.8789, device='cuda:0')
benign distance is  tensor(136.8789, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.2085711508989334
distance x is tensor(137.9524, device='cuda:0')
benign distance is  tensor(137.9524, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.3692116141319275
distance x is tensor(123.4508, device='cuda:0')
benign distance is  tensor(123.4508, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7438751459121704
distance x is tensor(144.2735, device='cuda:0')
benign distance is  tensor(144.2735, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.04009467363357544
distance x is tensor(152.7658, device='cuda:0')
benign distance is  tensor(152.7658, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.2641619145870209
distance x is tensor(135.7096, device='cuda:0')
benign distance is  tensor(135.7096, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.29101234674453735
distance x is tensor(134.5494, device='cuda:0')
benign distance is  tensor(134.5494, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8174848556518555
distance x is tensor(133.1198, device='cuda:0')
benign distance is  tensor(133.1198, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.24066343903541565
distance x is tensor(133.8781, device='cuda:0')
benign distance is  tensor(133.8781, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.31086769700050354
distance x is tensor(132.5112, device='cuda:0')
benign distance is  tensor(132.5112, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.23143994808197021
distance x is tensor(145.9147, device='cuda:0')
benign distance is  tensor(145.9147, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.41388463973999023
mal_entropy is 0.10241645574569702
user_PLR len size 20
counter_tensor is  tensor([19., 19., 18., 13., 18., 14., 18., 14., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7981e-02, 2.7981e-02, 1.0294e-02, 6.9357e-05, 1.0294e-02, 1.8853e-04,
        1.0294e-02, 1.8853e-04, 7.6059e-02, 7.6059e-02, 7.6059e-02, 7.6059e-02,
        7.6059e-02, 7.6059e-02, 7.6059e-02, 7.6059e-02, 7.6059e-02, 7.6059e-02,
        7.6059e-02, 7.6059e-02])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 88.65% 

Test Accuracy: 87.42% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8183751106262207
distance x is tensor(145.6993, device='cuda:0')
benign distance is  tensor(145.6993, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5513149499893188
distance x is tensor(144.3917, device='cuda:0')
benign distance is  tensor(144.3917, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.22508592903614044
distance x is tensor(145.0555, device='cuda:0')
benign distance is  tensor(145.0555, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6951915621757507
distance x is tensor(121.6364, device='cuda:0')
benign distance is  tensor(121.6364, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.42397817969322205
distance x is tensor(126.4789, device='cuda:0')
benign distance is  tensor(126.4789, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7207109332084656
distance x is tensor(148.0417, device='cuda:0')
benign distance is  tensor(148.0417, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.04340698570013046
distance x is tensor(123.9606, device='cuda:0')
benign distance is  tensor(123.9606, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.676953136920929
distance x is tensor(150.8497, device='cuda:0')
benign distance is  tensor(150.8497, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.7500000005
mal_loss is 2.876600503921509
mal_entropy is 0.10374927520751953
user_PLR len size 44
counter_tensor is  tensor([38., 19., 43., 25., 16., 37., 41., 30., 28., 28., 28., 28., 28., 28.,
        28., 28., 28., 28., 28., 28., 41., 42., 42., 37., 18., 38., 12., 43.,
        24., 41., 22., 36., 38., 42., 42., 16., 43., 35., 43., 32., 13., 42.,
        13., 37.])
count_res tensor([1.0739e-03, 6.0168e-12, 1.5938e-01, 2.4274e-09, 2.9956e-13, 3.9506e-04,
        2.1570e-02, 3.6025e-07, 4.8755e-08, 4.8755e-08, 4.8755e-08, 4.8755e-08,
        4.8755e-08, 4.8755e-08, 4.8755e-08, 4.8755e-08, 4.8755e-08, 4.8755e-08,
        4.8755e-08, 4.8755e-08, 2.1570e-02, 5.8633e-02, 5.8633e-02, 3.9506e-04,
        2.2135e-12, 1.0739e-03, 5.4866e-15, 1.5938e-01, 8.9297e-10, 2.1570e-02,
        1.2085e-10, 1.4534e-04, 1.0739e-03, 5.8633e-02, 5.8633e-02, 2.9956e-13,
        1.5938e-01, 5.3466e-05, 1.5938e-01, 2.6619e-06, 1.4914e-14, 5.8633e-02,
        1.4914e-14, 3.9506e-04])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 89.92% 

Test Accuracy: 88.64% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.34221282601356506
distance x is tensor(114.0955, device='cuda:0')
benign distance is  tensor(114.0955, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.34680765867233276
distance x is tensor(137.8503, device='cuda:0')
benign distance is  tensor(137.8503, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2013399302959442
distance x is tensor(127.8931, device='cuda:0')
benign distance is  tensor(127.8931, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.36533746123313904
distance x is tensor(99.0369, device='cuda:0')
benign distance is  tensor(99.0369, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3715471625328064
distance x is tensor(106.1154, device='cuda:0')
benign distance is  tensor(106.1154, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4905034899711609
distance x is tensor(124.9577, device='cuda:0')
benign distance is  tensor(124.9577, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.06993654370307922
distance x is tensor(86.2465, device='cuda:0')
benign distance is  tensor(86.2465, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.08511471748352051
distance x is tensor(120.1967, device='cuda:0')
benign distance is  tensor(120.1967, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.14220407605171204
distance x is tensor(109.2592, device='cuda:0')
benign distance is  tensor(109.2592, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.23426632583141327
distance x is tensor(132.7312, device='cuda:0')
benign distance is  tensor(132.7312, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5722435712814331
distance x is tensor(102.2830, device='cuda:0')
benign distance is  tensor(102.2830, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3579517602920532
distance x is tensor(114.7058, device='cuda:0')
benign distance is  tensor(114.7058, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.14556927978992462
distance x is tensor(117.4402, device='cuda:0')
benign distance is  tensor(117.4402, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.252469003200531
distance x is tensor(102.7268, device='cuda:0')
benign distance is  tensor(102.7268, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8433297872543335
distance x is tensor(137.2543, device='cuda:0')
benign distance is  tensor(137.2543, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5614219903945923
distance x is tensor(139.5493, device='cuda:0')
benign distance is  tensor(139.5493, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.32156848907470703
distance x is tensor(131.8990, device='cuda:0')
benign distance is  tensor(131.8990, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5092793703079224
distance x is tensor(141.4446, device='cuda:0')
benign distance is  tensor(141.4446, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3001157343387604
distance x is tensor(135.3176, device='cuda:0')
benign distance is  tensor(135.3176, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.24728348851203918
distance x is tensor(129.2607, device='cuda:0')
benign distance is  tensor(129.2607, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.45409274101257324
distance x is tensor(143.8847, device='cuda:0')
benign distance is  tensor(143.8847, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.3930380940437317
distance x is tensor(133.7321, device='cuda:0')
benign distance is  tensor(133.7321, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.06283054500818253
distance x is tensor(142.8637, device='cuda:0')
benign distance is  tensor(142.8637, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4741348624229431
distance x is tensor(123.3852, device='cuda:0')
benign distance is  tensor(123.3852, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.3898200988769531
distance x is tensor(137.7294, device='cuda:0')
benign distance is  tensor(137.7294, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.20761287212371826
distance x is tensor(140.5187, device='cuda:0')
benign distance is  tensor(140.5187, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.1680932193994522
distance x is tensor(129.7960, device='cuda:0')
benign distance is  tensor(129.7960, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.12147340923547745
distance x is tensor(127.8282, device='cuda:0')
benign distance is  tensor(127.8282, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.1793866902589798
distance x is tensor(139.8769, device='cuda:0')
benign distance is  tensor(139.8769, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5508691668510437
distance x is tensor(130.9486, device='cuda:0')
benign distance is  tensor(130.9486, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.35150784254074097
distance x is tensor(142.5985, device='cuda:0')
benign distance is  tensor(142.5985, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.8811208605766296
distance x is tensor(134.0259, device='cuda:0')
benign distance is  tensor(134.0259, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.5560466051101685
mal_entropy is 0.027261389419436455
user_PLR len size 20
counter_tensor is  tensor([13., 19., 14., 19., 13., 19., 19., 13., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([6.7663e-05, 2.7297e-02, 1.8393e-04, 2.7297e-02, 6.7663e-05, 2.7297e-02,
        2.7297e-02, 6.7663e-05, 7.4202e-02, 7.4202e-02, 7.4202e-02, 7.4202e-02,
        7.4202e-02, 7.4202e-02, 7.4202e-02, 7.4202e-02, 7.4202e-02, 7.4202e-02,
        7.4202e-02, 7.4202e-02])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 88.94% 

Test Accuracy: 87.78% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.80810546875
distance x is tensor(155.3479, device='cuda:0')
benign distance is  tensor(155.3479, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.26556897163391113
distance x is tensor(163.7706, device='cuda:0')
benign distance is  tensor(163.7706, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3716665208339691
distance x is tensor(144.4895, device='cuda:0')
benign distance is  tensor(144.4895, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1658834218978882
distance x is tensor(138.4673, device='cuda:0')
benign distance is  tensor(138.4673, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5994121432304382
distance x is tensor(141.6378, device='cuda:0')
benign distance is  tensor(141.6378, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.1776086986064911
distance x is tensor(161.5472, device='cuda:0')
benign distance is  tensor(161.5472, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.20235797762870789
distance x is tensor(118.3253, device='cuda:0')
benign distance is  tensor(118.3253, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4731629490852356
distance x is tensor(153.2404, device='cuda:0')
benign distance is  tensor(153.2404, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 1.2653599977493286
mal_entropy is 0.054001279175281525
user_PLR len size 36
counter_tensor is  tensor([26., 21., 28., 34., 31., 28., 23., 31., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 35., 34., 34., 33., 23., 25., 22., 35.,
        28., 23., 33., 30., 31., 28., 21., 35.])
count_res tensor([2.7795e-05, 1.8728e-07, 2.0538e-04, 8.2855e-02, 4.1251e-03, 2.0538e-04,
        1.3838e-06, 4.1251e-03, 3.7616e-06, 3.7616e-06, 3.7616e-06, 3.7616e-06,
        3.7616e-06, 3.7616e-06, 3.7616e-06, 3.7616e-06, 3.7616e-06, 3.7616e-06,
        3.7616e-06, 3.7616e-06, 2.2522e-01, 8.2855e-02, 8.2855e-02, 3.0481e-02,
        1.3838e-06, 1.0225e-05, 5.0908e-07, 2.2522e-01, 2.0538e-04, 1.3838e-06,
        3.0481e-02, 1.5175e-03, 4.1251e-03, 2.0538e-04, 1.8728e-07, 2.2522e-01])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 89.92% 

Test Accuracy: 88.92% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.27758869528770447
distance x is tensor(116.5691, device='cuda:0')
benign distance is  tensor(116.5691, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3248707950115204
distance x is tensor(135.1326, device='cuda:0')
benign distance is  tensor(135.1326, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.046943299472332
distance x is tensor(120.9509, device='cuda:0')
benign distance is  tensor(120.9509, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4237373471260071
distance x is tensor(101.8632, device='cuda:0')
benign distance is  tensor(101.8632, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.185423344373703
distance x is tensor(91.8612, device='cuda:0')
benign distance is  tensor(91.8612, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8879238367080688
distance x is tensor(127.6848, device='cuda:0')
benign distance is  tensor(127.6848, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4068002700805664
distance x is tensor(111.4633, device='cuda:0')
benign distance is  tensor(111.4633, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5489571690559387
distance x is tensor(132.6629, device='cuda:0')
benign distance is  tensor(132.6629, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.39755937457084656
distance x is tensor(126.8387, device='cuda:0')
benign distance is  tensor(126.8387, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.720873236656189
distance x is tensor(131.7025, device='cuda:0')
benign distance is  tensor(131.7025, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7758747339248657
distance x is tensor(132.3741, device='cuda:0')
benign distance is  tensor(132.3741, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3477674722671509
distance x is tensor(133.7847, device='cuda:0')
benign distance is  tensor(133.7847, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7214315533638
distance x is tensor(131.5221, device='cuda:0')
benign distance is  tensor(131.5221, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.31460192799568176
distance x is tensor(123.9864, device='cuda:0')
benign distance is  tensor(123.9864, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5876080393791199
distance x is tensor(132.4815, device='cuda:0')
benign distance is  tensor(132.4815, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5678490996360779
distance x is tensor(118.7946, device='cuda:0')
benign distance is  tensor(118.7946, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.5109262466430664
distance x is tensor(138.8956, device='cuda:0')
benign distance is  tensor(138.8956, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5848251581192017
distance x is tensor(127.1239, device='cuda:0')
benign distance is  tensor(127.1239, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.13522282242774963
distance x is tensor(134.9098, device='cuda:0')
benign distance is  tensor(134.9098, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.085857629776001
distance x is tensor(147.6723, device='cuda:0')
benign distance is  tensor(147.6723, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.3218622207641602
distance x is tensor(145.8132, device='cuda:0')
benign distance is  tensor(145.8132, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.367535799741745
distance x is tensor(148.9438, device='cuda:0')
benign distance is  tensor(148.9438, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.34275054931640625
distance x is tensor(130.6755, device='cuda:0')
benign distance is  tensor(130.6755, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.39581140875816345
distance x is tensor(124.7878, device='cuda:0')
benign distance is  tensor(124.7878, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.3195206820964813
mal_entropy is 0.10796608030796051
user_PLR len size 36
counter_tensor is  tensor([14., 13., 34., 31., 33., 35., 30., 12., 23., 23., 23., 23., 23., 23.,
        23., 23., 23., 23., 23., 23., 14., 14., 13., 14.,  2., 15., 35., 35.,
        34., 14., 14., 35.,  0., 27., 14., 35.])
count_res tensor([1.2859e-10, 4.7307e-11, 6.2389e-02, 3.1062e-03, 2.2952e-02, 1.6959e-01,
        1.1427e-03, 1.7403e-11, 1.0420e-06, 1.0420e-06, 1.0420e-06, 1.0420e-06,
        1.0420e-06, 1.0420e-06, 1.0420e-06, 1.0420e-06, 1.0420e-06, 1.0420e-06,
        1.0420e-06, 1.0420e-06, 1.2859e-10, 1.2859e-10, 4.7307e-11, 1.2859e-10,
        7.9010e-16, 3.4955e-10, 1.6959e-01, 1.6959e-01, 6.2389e-02, 1.2859e-10,
        1.2859e-10, 1.6959e-01, 1.0693e-16, 5.6891e-05, 1.2859e-10, 1.6959e-01])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 89.76% 

Test Accuracy: 89.08% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6386938095092773
distance x is tensor(121.5723, device='cuda:0')
benign distance is  tensor(121.5723, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3560813069343567
distance x is tensor(129.8882, device='cuda:0')
benign distance is  tensor(129.8882, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2642868459224701
distance x is tensor(108.7964, device='cuda:0')
benign distance is  tensor(108.7964, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6601969599723816
distance x is tensor(101.4957, device='cuda:0')
benign distance is  tensor(101.4957, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.36055833101272583
distance x is tensor(97.3642, device='cuda:0')
benign distance is  tensor(97.3642, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.2129942625761032
distance x is tensor(130.6346, device='cuda:0')
benign distance is  tensor(130.6346, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3829367756843567
distance x is tensor(88.2269, device='cuda:0')
benign distance is  tensor(88.2269, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.32978111505508423
distance x is tensor(113.5513, device='cuda:0')
benign distance is  tensor(113.5513, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.27210092544555664
distance x is tensor(125.0962, device='cuda:0')
benign distance is  tensor(125.0962, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.629861056804657
distance x is tensor(141.3761, device='cuda:0')
benign distance is  tensor(141.3761, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.41831502318382263
distance x is tensor(125.8407, device='cuda:0')
benign distance is  tensor(125.8407, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.6267834901809692
distance x is tensor(106.4107, device='cuda:0')
benign distance is  tensor(106.4107, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.1052054762840271
distance x is tensor(126.1496, device='cuda:0')
benign distance is  tensor(126.1496, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5379838347434998
distance x is tensor(137.9246, device='cuda:0')
benign distance is  tensor(137.9246, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2849130630493164
distance x is tensor(144.6847, device='cuda:0')
benign distance is  tensor(144.6847, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4591917097568512
distance x is tensor(116.9508, device='cuda:0')
benign distance is  tensor(116.9508, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3596351444721222
distance x is tensor(137.2689, device='cuda:0')
benign distance is  tensor(137.2689, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.09423793852329254
distance x is tensor(137.2954, device='cuda:0')
benign distance is  tensor(137.2954, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.4887210726737976
distance x is tensor(130.8851, device='cuda:0')
benign distance is  tensor(130.8851, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.21105077862739563
distance x is tensor(122.7618, device='cuda:0')
benign distance is  tensor(122.7618, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5896195769309998
distance x is tensor(144.9181, device='cuda:0')
benign distance is  tensor(144.9181, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.21232983469963074
distance x is tensor(127.9802, device='cuda:0')
benign distance is  tensor(127.9802, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.3535149097442627
distance x is tensor(121.6798, device='cuda:0')
benign distance is  tensor(121.6798, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.14114271104335785
distance x is tensor(121.2031, device='cuda:0')
benign distance is  tensor(121.2031, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.27674970030784607
mal_entropy is 0.06108895689249039
user_PLR len size 28
counter_tensor is  tensor([13., 14., 26., 15., 14., 21., 11., 27., 15., 15., 15., 15., 15., 15.,
        15., 15., 15., 15., 15., 15., 15., 16., 15., 16., 14., 14., 15., 23.])
count_res tensor([5.9873e-07, 1.6275e-06, 2.6489e-01, 4.4241e-06, 1.6275e-06, 1.7848e-03,
        8.1030e-08, 7.2004e-01, 4.4241e-06, 4.4241e-06, 4.4241e-06, 4.4241e-06,
        4.4241e-06, 4.4241e-06, 4.4241e-06, 4.4241e-06, 4.4241e-06, 4.4241e-06,
        4.4241e-06, 4.4241e-06, 4.4241e-06, 1.2026e-05, 4.4241e-06, 1.2026e-05,
        1.6275e-06, 1.6275e-06, 4.4241e-06, 1.3188e-02])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 89.26% 

Test Accuracy: 88.12% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.17830407619476318
distance x is tensor(147.3869, device='cuda:0')
benign distance is  tensor(147.3869, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4120331406593323
distance x is tensor(141.6119, device='cuda:0')
benign distance is  tensor(141.6119, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.172578364610672
distance x is tensor(135.0839, device='cuda:0')
benign distance is  tensor(135.0839, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6031832695007324
distance x is tensor(124.6469, device='cuda:0')
benign distance is  tensor(124.6469, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.46812310814857483
distance x is tensor(105.9864, device='cuda:0')
benign distance is  tensor(105.9864, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3627017140388489
distance x is tensor(145.0723, device='cuda:0')
benign distance is  tensor(145.0723, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.20479345321655273
distance x is tensor(114.0492, device='cuda:0')
benign distance is  tensor(114.0492, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.997416615486145
distance x is tensor(109.9449, device='cuda:0')
benign distance is  tensor(109.9449, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.36878126859664917
distance x is tensor(141.2952, device='cuda:0')
benign distance is  tensor(141.2952, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.49532514810562134
distance x is tensor(153.6404, device='cuda:0')
benign distance is  tensor(153.6404, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.2980896234512329
distance x is tensor(144.6832, device='cuda:0')
benign distance is  tensor(144.6832, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.20895259082317352
distance x is tensor(152.1424, device='cuda:0')
benign distance is  tensor(152.1424, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6605547070503235
distance x is tensor(138.9091, device='cuda:0')
benign distance is  tensor(138.9091, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.24264559149742126
distance x is tensor(130.7281, device='cuda:0')
benign distance is  tensor(130.7281, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4480116367340088
distance x is tensor(152.7982, device='cuda:0')
benign distance is  tensor(152.7982, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3222757875919342
distance x is tensor(150.2966, device='cuda:0')
benign distance is  tensor(150.2966, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.6734005212783813
mal_entropy is 0.040358953177928925
user_PLR len size 20
counter_tensor is  tensor([16., 19., 16., 19., 19., 18., 19., 19., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([0.0013, 0.0263, 0.0013, 0.0263, 0.0263, 0.0097, 0.0263, 0.0263, 0.0714,
        0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714, 0.0714,
        0.0714, 0.0714])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 88.08% 

Test Accuracy: 87.07% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6928187012672424
distance x is tensor(179.9139, device='cuda:0')
benign distance is  tensor(179.9139, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5478083491325378
distance x is tensor(184.2073, device='cuda:0')
benign distance is  tensor(184.2073, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5891421437263489
distance x is tensor(170.0142, device='cuda:0')
benign distance is  tensor(170.0142, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.34379813075065613
distance x is tensor(163.9729, device='cuda:0')
benign distance is  tensor(163.9729, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5235820412635803
distance x is tensor(169.8142, device='cuda:0')
benign distance is  tensor(169.8142, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.8123462200164795
distance x is tensor(187.4681, device='cuda:0')
benign distance is  tensor(187.4681, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.34491199254989624
distance x is tensor(162.7014, device='cuda:0')
benign distance is  tensor(162.7014, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6489255428314209
distance x is tensor(153.9901, device='cuda:0')
benign distance is  tensor(153.9901, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.8198826909065247
mal_entropy is 0.030980879440903664
user_PLR len size 52
counter_tensor is  tensor([41., 32., 27., 34., 26., 42., 39., 35., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 51., 51., 44., 30., 45., 39., 51., 35.,
        25., 26., 39., 41., 32., 30., 35., 36., 22., 28., 29., 51., 37., 38.,
        22., 50., 51., 50., 41., 51., 49., 35., 48., 40.])
count_res tensor([6.5562e-06, 8.0909e-10, 5.4516e-12, 5.9784e-09, 2.0055e-12, 1.7822e-05,
        8.8728e-07, 1.6251e-08, 2.4119e-06, 2.4119e-06, 2.4119e-06, 2.4119e-06,
        2.4119e-06, 2.4119e-06, 2.4119e-06, 2.4119e-06, 2.4119e-06, 2.4119e-06,
        2.4119e-06, 2.4119e-06, 1.4441e-01, 1.4441e-01, 1.3168e-04, 1.0950e-10,
        3.5795e-04, 8.8728e-07, 1.4441e-01, 1.6251e-08, 7.3780e-13, 2.0055e-12,
        8.8728e-07, 6.5562e-06, 8.0909e-10, 1.0950e-10, 1.6251e-08, 4.4175e-08,
        3.6733e-14, 1.4819e-11, 4.0282e-11, 1.4441e-01, 1.2008e-07, 3.2641e-07,
        3.6733e-14, 5.3125e-02, 1.4441e-01, 5.3125e-02, 6.5562e-06, 1.4441e-01,
        1.9544e-02, 1.6251e-08, 7.1897e-03, 2.4119e-06])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 89.83% 

Test Accuracy: 88.76% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3999031186103821
distance x is tensor(139.3080, device='cuda:0')
benign distance is  tensor(139.3080, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.23478808999061584
distance x is tensor(129.4511, device='cuda:0')
benign distance is  tensor(129.4511, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2203039675951004
distance x is tensor(120.4499, device='cuda:0')
benign distance is  tensor(120.4499, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.38459116220474243
distance x is tensor(117.4214, device='cuda:0')
benign distance is  tensor(117.4214, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.372886061668396
distance x is tensor(102.7735, device='cuda:0')
benign distance is  tensor(102.7735, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6603347063064575
distance x is tensor(114.6416, device='cuda:0')
benign distance is  tensor(114.6416, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7598013877868652
distance x is tensor(96.8971, device='cuda:0')
benign distance is  tensor(96.8971, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1598537713289261
distance x is tensor(104.5726, device='cuda:0')
benign distance is  tensor(104.5726, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.08771510422229767
distance x is tensor(115.9237, device='cuda:0')
benign distance is  tensor(115.9237, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.46305355429649353
distance x is tensor(136.1271, device='cuda:0')
benign distance is  tensor(136.1271, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4122595191001892
distance x is tensor(104.8479, device='cuda:0')
benign distance is  tensor(104.8479, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5799410939216614
distance x is tensor(115.4309, device='cuda:0')
benign distance is  tensor(115.4309, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6889282464981079
distance x is tensor(114.5227, device='cuda:0')
benign distance is  tensor(114.5227, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.38707032799720764
distance x is tensor(104.1547, device='cuda:0')
benign distance is  tensor(104.1547, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3730698227882385
distance x is tensor(139.4435, device='cuda:0')
benign distance is  tensor(139.4435, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.670989453792572
distance x is tensor(135.7511, device='cuda:0')
benign distance is  tensor(135.7511, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.30934515595436096
distance x is tensor(131.6565, device='cuda:0')
benign distance is  tensor(131.6565, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7532202005386353
distance x is tensor(148.6674, device='cuda:0')
benign distance is  tensor(148.6674, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.049072351306676865
distance x is tensor(133.2205, device='cuda:0')
benign distance is  tensor(133.2205, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.28707262873649597
distance x is tensor(107.0954, device='cuda:0')
benign distance is  tensor(107.0954, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.33537963032722473
distance x is tensor(128.6017, device='cuda:0')
benign distance is  tensor(128.6017, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.39942666888237
distance x is tensor(130.1577, device='cuda:0')
benign distance is  tensor(130.1577, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.34184572100639343
distance x is tensor(134.2777, device='cuda:0')
benign distance is  tensor(134.2777, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.279859334230423
distance x is tensor(116.3319, device='cuda:0')
benign distance is  tensor(116.3319, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.34189572930336
distance x is tensor(145.4819, device='cuda:0')
benign distance is  tensor(145.4819, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5934590101242065
distance x is tensor(125.8790, device='cuda:0')
benign distance is  tensor(125.8790, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.0942569226026535
distance x is tensor(137.1365, device='cuda:0')
benign distance is  tensor(137.1365, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.1647719442844391
distance x is tensor(137.2895, device='cuda:0')
benign distance is  tensor(137.2895, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.24382679164409637
distance x is tensor(131.8965, device='cuda:0')
benign distance is  tensor(131.8965, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.1059095710515976
distance x is tensor(133.7166, device='cuda:0')
benign distance is  tensor(133.7166, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.1532270908355713
distance x is tensor(143.0489, device='cuda:0')
benign distance is  tensor(143.0489, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.08083099871873856
distance x is tensor(139.1855, device='cuda:0')
benign distance is  tensor(139.1855, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.38207584619522095
distance x is tensor(129.7370, device='cuda:0')
benign distance is  tensor(129.7370, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.381965696811676
distance x is tensor(126.1155, device='cuda:0')
benign distance is  tensor(126.1155, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.04863124340772629
distance x is tensor(126.2252, device='cuda:0')
benign distance is  tensor(126.2252, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.14585590362548828
distance x is tensor(147.5875, device='cuda:0')
benign distance is  tensor(147.5875, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.19058352708816528
distance x is tensor(134.6972, device='cuda:0')
benign distance is  tensor(134.6972, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.9873763918876648
distance x is tensor(135.5441, device='cuda:0')
benign distance is  tensor(135.5441, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7322177886962891
distance x is tensor(138.0315, device='cuda:0')
benign distance is  tensor(138.0315, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.2587911784648895
distance x is tensor(134.5460, device='cuda:0')
benign distance is  tensor(134.5460, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.2835000157356262
mal_entropy is 0.09042130410671234
user_PLR len size 20
counter_tensor is  tensor([13., 19., 17., 16., 18., 13., 13., 19., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([7.0460e-05, 2.8425e-02, 3.8470e-03, 1.4152e-03, 1.0457e-02, 7.0460e-05,
        7.0460e-05, 2.8425e-02, 7.7268e-02, 7.7268e-02, 7.7268e-02, 7.7268e-02,
        7.7268e-02, 7.7268e-02, 7.7268e-02, 7.7268e-02, 7.7268e-02, 7.7268e-02,
        7.7268e-02, 7.7268e-02])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 88.93% 

Test Accuracy: 87.96% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.39026084542274475
distance x is tensor(148.8073, device='cuda:0')
benign distance is  tensor(148.8073, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7561076879501343
distance x is tensor(155.6956, device='cuda:0')
benign distance is  tensor(155.6956, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3516605794429779
distance x is tensor(137.5559, device='cuda:0')
benign distance is  tensor(137.5559, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6886386275291443
distance x is tensor(130.4485, device='cuda:0')
benign distance is  tensor(130.4485, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.28592389822006226
distance x is tensor(122.1086, device='cuda:0')
benign distance is  tensor(122.1086, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6132782697677612
distance x is tensor(154.2164, device='cuda:0')
benign distance is  tensor(154.2164, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1553921401500702
distance x is tensor(130.1722, device='cuda:0')
benign distance is  tensor(130.1722, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.03567070513963699
distance x is tensor(132.2036, device='cuda:0')
benign distance is  tensor(132.2036, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.6688302755355835
mal_entropy is 0.005011071916669607
user_PLR len size 36
counter_tensor is  tensor([35., 28., 32., 32., 32., 33., 33., 25., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 28., 23., 35., 24., 35., 34., 35., 24.,
        34., 21., 23., 20., 32., 35., 23., 29.])
count_res tensor([1.6103e-01, 1.4684e-04, 8.0170e-03, 8.0170e-03, 8.0170e-03, 2.1792e-02,
        2.1792e-02, 7.3106e-06, 2.6894e-06, 2.6894e-06, 2.6894e-06, 2.6894e-06,
        2.6894e-06, 2.6894e-06, 2.6894e-06, 2.6894e-06, 2.6894e-06, 2.6894e-06,
        2.6894e-06, 2.6894e-06, 1.4684e-04, 9.8938e-07, 1.6103e-01, 2.6894e-06,
        1.6103e-01, 5.9238e-02, 1.6103e-01, 2.6894e-06, 5.9238e-02, 1.3390e-07,
        9.8938e-07, 4.9258e-08, 8.0170e-03, 1.6103e-01, 9.8938e-07, 3.9914e-04])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 90.24% 

Test Accuracy: 89.01% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 90.24%
|----0th round Training Accuracy : 88.31%
|----1th round Training Accuracy : 87.76%
|----2th round Training Accuracy : 88.52%
|----3th round Training Accuracy : 88.88%
|----4th round Training Accuracy : 88.83%
|----5th round Training Accuracy : 89.55%
|----6th round Training Accuracy : 88.31%
|----7th round Training Accuracy : 89.59%
|----8th round Training Accuracy : 89.12%
|----9th round Training Accuracy : 88.87%
|----10th round Training Accuracy : 87.15%
|----11th round Training Accuracy : 89.71%
|----12th round Training Accuracy : 88.70%
|----13th round Training Accuracy : 89.06%
|----14th round Training Accuracy : 89.53%
|----15th round Training Accuracy : 89.14%
|----16th round Training Accuracy : 87.47%
|----17th round Training Accuracy : 89.59%
|----18th round Training Accuracy : 88.26%
|----19th round Training Accuracy : 89.69%
|----20th round Training Accuracy : 88.39%
|----21th round Training Accuracy : 89.85%
|----22th round Training Accuracy : 88.37%
|----23th round Training Accuracy : 89.85%
|----24th round Training Accuracy : 88.88%
|----25th round Training Accuracy : 89.62%
|----26th round Training Accuracy : 88.97%
|----27th round Training Accuracy : 89.77%
|----28th round Training Accuracy : 88.23%
|----29th round Training Accuracy : 89.74%
|----30th round Training Accuracy : 88.48%
|----31th round Training Accuracy : 89.72%
|----32th round Training Accuracy : 89.76%
|----33th round Training Accuracy : 89.17%
|----34th round Training Accuracy : 89.51%
|----35th round Training Accuracy : 89.99%
|----36th round Training Accuracy : 88.88%
|----37th round Training Accuracy : 89.68%
|----38th round Training Accuracy : 89.81%
|----39th round Training Accuracy : 89.79%
|----40th round Training Accuracy : 88.65%
|----41th round Training Accuracy : 89.92%
|----42th round Training Accuracy : 88.94%
|----43th round Training Accuracy : 89.92%
|----44th round Training Accuracy : 89.76%
|----45th round Training Accuracy : 89.26%
|----46th round Training Accuracy : 88.08%
|----47th round Training Accuracy : 89.83%
|----48th round Training Accuracy : 88.93%
|----49th round Training Accuracy : 90.24%
|----Final Test Accuracy: 89.01%
|----0th round Final Test Accuracy : 87.22%
|----1th round Final Test Accuracy : 86.84%
|----2th round Final Test Accuracy : 88.12%
|----3th round Final Test Accuracy : 87.99%
|----4th round Final Test Accuracy : 87.61%
|----5th round Final Test Accuracy : 88.56%
|----6th round Final Test Accuracy : 87.30%
|----7th round Final Test Accuracy : 88.71%
|----8th round Final Test Accuracy : 88.21%
|----9th round Final Test Accuracy : 88.11%
|----10th round Final Test Accuracy : 85.93%
|----11th round Final Test Accuracy : 88.71%
|----12th round Final Test Accuracy : 87.71%
|----13th round Final Test Accuracy : 88.12%
|----14th round Final Test Accuracy : 88.82%
|----15th round Final Test Accuracy : 88.51%
|----16th round Final Test Accuracy : 86.75%
|----17th round Final Test Accuracy : 88.76%
|----18th round Final Test Accuracy : 87.46%
|----19th round Final Test Accuracy : 88.87%
|----20th round Final Test Accuracy : 87.39%
|----21th round Final Test Accuracy : 88.88%
|----22th round Final Test Accuracy : 87.60%
|----23th round Final Test Accuracy : 88.60%
|----24th round Final Test Accuracy : 87.79%
|----25th round Final Test Accuracy : 88.39%
|----26th round Final Test Accuracy : 87.89%
|----27th round Final Test Accuracy : 88.72%
|----28th round Final Test Accuracy : 87.30%
|----29th round Final Test Accuracy : 88.69%
|----30th round Final Test Accuracy : 86.99%
|----31th round Final Test Accuracy : 88.73%
|----32th round Final Test Accuracy : 88.60%
|----33th round Final Test Accuracy : 88.36%
|----34th round Final Test Accuracy : 88.62%
|----35th round Final Test Accuracy : 89.00%
|----36th round Final Test Accuracy : 87.79%
|----37th round Final Test Accuracy : 88.68%
|----38th round Final Test Accuracy : 88.85%
|----39th round Final Test Accuracy : 88.76%
|----40th round Final Test Accuracy : 87.42%
|----41th round Final Test Accuracy : 88.64%
|----42th round Final Test Accuracy : 87.78%
|----43th round Final Test Accuracy : 88.92%
|----44th round Final Test Accuracy : 89.08%
|----45th round Final Test Accuracy : 88.12%
|----46th round Final Test Accuracy : 87.07%
|----47th round Final Test Accuracy : 88.76%
|----48th round Final Test Accuracy : 87.96%
|----49th round Final Test Accuracy : 89.01%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 3342.5576
