
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.421193927526474
distance x is tensor(117.3108, device='cuda:0')
benign distance is  tensor(117.3108, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9390668869018555
distance x is tensor(119.7104, device='cuda:0')
benign distance is  tensor(119.7104, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4667542576789856
distance x is tensor(127.7148, device='cuda:0')
benign distance is  tensor(127.7148, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6856712102890015
distance x is tensor(114.4868, device='cuda:0')
benign distance is  tensor(114.4868, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8249980807304382
distance x is tensor(109.7340, device='cuda:0')
benign distance is  tensor(109.7340, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.2534821629524231
distance x is tensor(119.6778, device='cuda:0')
benign distance is  tensor(119.6778, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3907772898674011
distance x is tensor(101.2269, device='cuda:0')
benign distance is  tensor(101.2269, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.21385860443115234
distance x is tensor(125.9403, device='cuda:0')
benign distance is  tensor(125.9403, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.1335134506225586
distance x is tensor(138.2954, device='cuda:0')
benign distance is  tensor(138.2954, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4159150719642639
distance x is tensor(135.3769, device='cuda:0')
benign distance is  tensor(135.3769, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.29143571853637695
distance x is tensor(119.1146, device='cuda:0')
benign distance is  tensor(119.1146, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.2481101006269455
distance x is tensor(127.3116, device='cuda:0')
benign distance is  tensor(127.3116, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.34435945749282837
distance x is tensor(131.0992, device='cuda:0')
benign distance is  tensor(131.0992, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1964077204465866
distance x is tensor(144.8509, device='cuda:0')
benign distance is  tensor(144.8509, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.191890001296997
distance x is tensor(134.7369, device='cuda:0')
benign distance is  tensor(134.7369, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3058233857154846
distance x is tensor(134.3062, device='cuda:0')
benign distance is  tensor(134.3062, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.1956276297569275
distance x is tensor(128.9899, device='cuda:0')
benign distance is  tensor(128.9899, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7614797353744507
distance x is tensor(146.5209, device='cuda:0')
benign distance is  tensor(146.5209, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3521665930747986
distance x is tensor(125.5678, device='cuda:0')
benign distance is  tensor(125.5678, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.520588219165802
distance x is tensor(123.1424, device='cuda:0')
benign distance is  tensor(123.1424, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.12443193048238754
distance x is tensor(129.8040, device='cuda:0')
benign distance is  tensor(129.8040, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.42873215675354004
distance x is tensor(130.1975, device='cuda:0')
benign distance is  tensor(130.1975, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4523623585700989
distance x is tensor(136.6502, device='cuda:0')
benign distance is  tensor(136.6502, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7671785354614258
distance x is tensor(130.8102, device='cuda:0')
benign distance is  tensor(130.8102, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.46802228689193726
distance x is tensor(147.8206, device='cuda:0')
benign distance is  tensor(147.8206, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.45003825426101685
distance x is tensor(121.7803, device='cuda:0')
benign distance is  tensor(121.7803, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.938412070274353
distance x is tensor(136.7413, device='cuda:0')
benign distance is  tensor(136.7413, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5510765314102173
distance x is tensor(138.6256, device='cuda:0')
benign distance is  tensor(138.6256, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6564226746559143
distance x is tensor(121.7894, device='cuda:0')
benign distance is  tensor(121.7894, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5169672966003418
distance x is tensor(132.5702, device='cuda:0')
benign distance is  tensor(132.5702, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.30831387639045715
distance x is tensor(127.1718, device='cuda:0')
benign distance is  tensor(127.1718, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.42551881074905396
distance x is tensor(133.2503, device='cuda:0')
benign distance is  tensor(133.2503, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.35472387075424194
distance x is tensor(133.6405, device='cuda:0')
benign distance is  tensor(133.6405, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.3060718774795532
distance x is tensor(125.2335, device='cuda:0')
benign distance is  tensor(125.2335, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6598284840583801
distance x is tensor(140.0954, device='cuda:0')
benign distance is  tensor(140.0954, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.19435173273086548
distance x is tensor(123.2413, device='cuda:0')
benign distance is  tensor(123.2413, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7339758276939392
distance x is tensor(130.6418, device='cuda:0')
benign distance is  tensor(130.6418, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.24954667687416077
distance x is tensor(127.0762, device='cuda:0')
benign distance is  tensor(127.0762, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.4218032956123352
distance x is tensor(125.8675, device='cuda:0')
benign distance is  tensor(125.8675, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.06610923260450363
distance x is tensor(127.1868, device='cuda:0')
benign distance is  tensor(127.1868, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.10474486649036407
distance x is tensor(127.6240, device='cuda:0')
benign distance is  tensor(127.6240, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.4335111975669861
distance x is tensor(124.9327, device='cuda:0')
benign distance is  tensor(124.9327, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.24466118216514587
distance x is tensor(134.0849, device='cuda:0')
benign distance is  tensor(134.0849, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.11399273574352264
distance x is tensor(132.4645, device='cuda:0')
benign distance is  tensor(132.4645, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.43908292055130005
distance x is tensor(134.9981, device='cuda:0')
benign distance is  tensor(134.9981, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5911277532577515
distance x is tensor(128.3779, device='cuda:0')
benign distance is  tensor(128.3779, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.0152418613433838
distance x is tensor(131.5107, device='cuda:0')
benign distance is  tensor(131.5107, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.1843903809785843
distance x is tensor(138.3038, device='cuda:0')
benign distance is  tensor(138.3038, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 17., 15.,  8.,  8.,  8.,
         8.,  8.,  8.,  9., 11., 13.])
count_res tensor([5.5521e-03, 5.5521e-03, 5.5521e-03, 5.5521e-03, 5.5521e-03, 5.5521e-03,
        5.5521e-03, 5.5521e-03, 2.0425e-03, 8.2400e-01, 1.1152e-01, 1.0169e-04,
        1.0169e-04, 1.0169e-04, 1.0169e-04, 1.0169e-04, 1.0169e-04, 2.7642e-04,
        2.0425e-03, 1.5092e-02])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 87.94% 

Test Accuracy: 87.25% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6385788321495056
distance x is tensor(100.5621, device='cuda:0')
benign distance is  tensor(100.5621, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5183044672012329
distance x is tensor(110.8241, device='cuda:0')
benign distance is  tensor(110.8241, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.12289204448461533
distance x is tensor(119.6983, device='cuda:0')
benign distance is  tensor(119.6983, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4914523959159851
distance x is tensor(110.7814, device='cuda:0')
benign distance is  tensor(110.7814, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6206387877464294
distance x is tensor(99.2368, device='cuda:0')
benign distance is  tensor(99.2368, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.528227686882019
distance x is tensor(113.2363, device='cuda:0')
benign distance is  tensor(113.2363, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5811275839805603
distance x is tensor(103.1200, device='cuda:0')
benign distance is  tensor(103.1200, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8849291801452637
distance x is tensor(112.4996, device='cuda:0')
benign distance is  tensor(112.4996, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 27., 13., 12., 12., 12., 12., 13., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16.,  2., 12., 12., 12., 12., 27., 12., 26.])
count_res tensor([1.2918e-07, 4.2228e-01, 3.5114e-07, 1.2918e-07, 1.2918e-07, 1.2918e-07,
        1.2918e-07, 3.5114e-07, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06,
        7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06,
        7.0528e-06, 7.0528e-06, 5.8646e-12, 1.2918e-07, 1.2918e-07, 1.2918e-07,
        1.2918e-07, 4.2228e-01, 1.2918e-07, 1.5535e-01])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 88.79% 

Test Accuracy: 87.75% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.19456346333026886
distance x is tensor(117.7780, device='cuda:0')
benign distance is  tensor(117.7780, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.675843358039856
distance x is tensor(84.5444, device='cuda:0')
benign distance is  tensor(84.5444, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2707200348377228
distance x is tensor(132.0873, device='cuda:0')
benign distance is  tensor(132.0873, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.30585259199142456
distance x is tensor(122.7965, device='cuda:0')
benign distance is  tensor(122.7965, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5856383442878723
distance x is tensor(96.1706, device='cuda:0')
benign distance is  tensor(96.1706, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1763713359832764
distance x is tensor(135.4523, device='cuda:0')
benign distance is  tensor(135.4523, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.37638217210769653
distance x is tensor(125.4018, device='cuda:0')
benign distance is  tensor(125.4018, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4355519413948059
distance x is tensor(121.7306, device='cuda:0')
benign distance is  tensor(121.7306, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.33593541383743286
distance x is tensor(144.2376, device='cuda:0')
benign distance is  tensor(144.2376, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.1662253439426422
distance x is tensor(132.6830, device='cuda:0')
benign distance is  tensor(132.6830, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1801612377166748
distance x is tensor(131.2725, device='cuda:0')
benign distance is  tensor(131.2725, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5967581272125244
distance x is tensor(131.7811, device='cuda:0')
benign distance is  tensor(131.7811, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.2451474964618683
distance x is tensor(132.4010, device='cuda:0')
benign distance is  tensor(132.4010, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.43469271063804626
distance x is tensor(119.6491, device='cuda:0')
benign distance is  tensor(119.6491, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.21154698729515076
distance x is tensor(133.5681, device='cuda:0')
benign distance is  tensor(133.5681, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7336799502372742
distance x is tensor(134.0406, device='cuda:0')
benign distance is  tensor(134.0406, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 26., 12., 12., 12., 26., 12., 15., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16.,  0., 12., 12., 14., 12., 12., 12., 27.])
count_res tensor([1.7621e-07, 2.1192e-01, 1.7621e-07, 1.7621e-07, 1.7621e-07, 2.1192e-01,
        1.7621e-07, 3.5394e-06, 9.6210e-06, 9.6210e-06, 9.6210e-06, 9.6210e-06,
        9.6210e-06, 9.6210e-06, 9.6210e-06, 9.6210e-06, 9.6210e-06, 9.6210e-06,
        9.6210e-06, 9.6210e-06, 1.0827e-12, 1.7621e-07, 1.7621e-07, 1.3021e-06,
        1.7621e-07, 1.7621e-07, 1.7621e-07, 5.7605e-01])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 88.27% 

Test Accuracy: 88.13% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3710922300815582
distance x is tensor(125.8877, device='cuda:0')
benign distance is  tensor(125.8877, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4988701343536377
distance x is tensor(123.7527, device='cuda:0')
benign distance is  tensor(123.7527, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.20471656322479248
distance x is tensor(137.9268, device='cuda:0')
benign distance is  tensor(137.9268, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8896867632865906
distance x is tensor(127.2424, device='cuda:0')
benign distance is  tensor(127.2424, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.23347091674804688
distance x is tensor(124.7120, device='cuda:0')
benign distance is  tensor(124.7120, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6756206750869751
distance x is tensor(122.2290, device='cuda:0')
benign distance is  tensor(122.2290, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.35485631227493286
distance x is tensor(130.7818, device='cuda:0')
benign distance is  tensor(130.7818, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1965218484401703
distance x is tensor(120.9770, device='cuda:0')
benign distance is  tensor(120.9770, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.36602783203125
distance x is tensor(144.9107, device='cuda:0')
benign distance is  tensor(144.9107, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6975485682487488
distance x is tensor(149.1472, device='cuda:0')
benign distance is  tensor(149.1472, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5188580751419067
distance x is tensor(131.9549, device='cuda:0')
benign distance is  tensor(131.9549, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.24585488438606262
distance x is tensor(136.0823, device='cuda:0')
benign distance is  tensor(136.0823, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.504338800907135
distance x is tensor(138.0705, device='cuda:0')
benign distance is  tensor(138.0705, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5892382860183716
distance x is tensor(132.9255, device='cuda:0')
benign distance is  tensor(132.9255, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.36653417348861694
distance x is tensor(145.9543, device='cuda:0')
benign distance is  tensor(145.9543, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.545961856842041
distance x is tensor(98.2624, device='cuda:0')
benign distance is  tensor(98.2624, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([33., 13., 12., 35., 35., 20.,  1., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 12., 12.,  0., 10., 22.,  3.,  0., 33.,
        12., 29., 12., 35., 12., 19., 12., 12.])
count_res tensor([4.1345e-02, 8.5217e-11, 3.1350e-11, 3.0550e-01, 3.0550e-01, 9.3452e-08,
        5.2359e-16, 3.1350e-11, 5.1023e-06, 5.1023e-06, 5.1023e-06, 5.1023e-06,
        5.1023e-06, 5.1023e-06, 5.1023e-06, 5.1023e-06, 5.1023e-06, 5.1023e-06,
        5.1023e-06, 5.1023e-06, 3.1350e-11, 3.1350e-11, 1.9262e-16, 4.2427e-12,
        6.9052e-07, 3.8689e-15, 1.9262e-16, 4.1345e-02, 3.1350e-11, 7.5725e-04,
        3.1350e-11, 3.0550e-01, 3.1350e-11, 3.4379e-08, 3.1350e-11, 3.1350e-11])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 89.16% 

Test Accuracy: 88.24% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6546183228492737
distance x is tensor(114.2292, device='cuda:0')
benign distance is  tensor(114.2292, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8880883455276489
distance x is tensor(113.9632, device='cuda:0')
benign distance is  tensor(113.9632, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3151152431964874
distance x is tensor(142.1847, device='cuda:0')
benign distance is  tensor(142.1847, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6949154734611511
distance x is tensor(101.6295, device='cuda:0')
benign distance is  tensor(101.6295, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8364081382751465
distance x is tensor(95.4020, device='cuda:0')
benign distance is  tensor(95.4020, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0905553102493286
distance x is tensor(130.8639, device='cuda:0')
benign distance is  tensor(130.8639, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3407576084136963
distance x is tensor(139.7016, device='cuda:0')
benign distance is  tensor(139.7016, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8106696009635925
distance x is tensor(138.4119, device='cuda:0')
benign distance is  tensor(138.4119, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8322569727897644
distance x is tensor(153.4137, device='cuda:0')
benign distance is  tensor(153.4137, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6020393967628479
distance x is tensor(135.9991, device='cuda:0')
benign distance is  tensor(135.9991, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5843430757522583
distance x is tensor(129.6600, device='cuda:0')
benign distance is  tensor(129.6600, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5252249836921692
distance x is tensor(125.5276, device='cuda:0')
benign distance is  tensor(125.5276, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6827309131622314
distance x is tensor(136.2816, device='cuda:0')
benign distance is  tensor(136.2816, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.650117039680481
distance x is tensor(134.7844, device='cuda:0')
benign distance is  tensor(134.7844, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7257418632507324
distance x is tensor(139.3467, device='cuda:0')
benign distance is  tensor(139.3467, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4626208245754242
distance x is tensor(146.1810, device='cuda:0')
benign distance is  tensor(146.1810, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.09109338372945786
distance x is tensor(149.1678, device='cuda:0')
benign distance is  tensor(149.1678, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5994921922683716
distance x is tensor(125.8933, device='cuda:0')
benign distance is  tensor(125.8933, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5586308240890503
distance x is tensor(143.7191, device='cuda:0')
benign distance is  tensor(143.7191, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.560023844242096
distance x is tensor(152.4193, device='cuda:0')
benign distance is  tensor(152.4193, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7032855153083801
distance x is tensor(144.9301, device='cuda:0')
benign distance is  tensor(144.9301, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.30183660984039307
distance x is tensor(135.3862, device='cuda:0')
benign distance is  tensor(135.3862, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.3345227837562561
distance x is tensor(151.7513, device='cuda:0')
benign distance is  tensor(151.7513, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6613051891326904
distance x is tensor(138.1044, device='cuda:0')
benign distance is  tensor(138.1044, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([26., 12., 12., 12., 12., 14., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 25., 12., 27., 12.,  0., 12., 12., 16.])
count_res tensor([2.4469e-01, 2.0347e-07, 2.0347e-07, 2.0347e-07, 2.0347e-07, 1.5034e-06,
        2.0347e-07, 2.0347e-07, 1.1109e-05, 1.1109e-05, 1.1109e-05, 1.1109e-05,
        1.1109e-05, 1.1109e-05, 1.1109e-05, 1.1109e-05, 1.1109e-05, 1.1109e-05,
        1.1109e-05, 1.1109e-05, 9.0017e-02, 2.0347e-07, 6.6514e-01, 2.0347e-07,
        1.2502e-12, 2.0347e-07, 2.0347e-07, 1.1109e-05])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 87.98% 

Test Accuracy: 87.50% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8726646304130554
distance x is tensor(116.8107, device='cuda:0')
benign distance is  tensor(116.8107, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.47828587889671326
distance x is tensor(124.4816, device='cuda:0')
benign distance is  tensor(124.4816, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.034939639270305634
distance x is tensor(137.0172, device='cuda:0')
benign distance is  tensor(137.0172, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7685092687606812
distance x is tensor(120.4446, device='cuda:0')
benign distance is  tensor(120.4446, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5131788849830627
distance x is tensor(114.7539, device='cuda:0')
benign distance is  tensor(114.7539, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8205188512802124
distance x is tensor(130.2951, device='cuda:0')
benign distance is  tensor(130.2951, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.116297647356987
distance x is tensor(125.6343, device='cuda:0')
benign distance is  tensor(125.6343, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3049803674221039
distance x is tensor(129.1537, device='cuda:0')
benign distance is  tensor(129.1537, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.722460150718689
distance x is tensor(132.4011, device='cuda:0')
benign distance is  tensor(132.4011, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.06151767820119858
distance x is tensor(130.7948, device='cuda:0')
benign distance is  tensor(130.7948, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.9473104476928711
distance x is tensor(94.4025, device='cuda:0')
benign distance is  tensor(94.4025, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.20328696072101593
distance x is tensor(138.9495, device='cuda:0')
benign distance is  tensor(138.9495, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.3091334104537964
distance x is tensor(138.5679, device='cuda:0')
benign distance is  tensor(138.5679, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7142980098724365
distance x is tensor(136.0931, device='cuda:0')
benign distance is  tensor(136.0931, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7128812670707703
distance x is tensor(128.7243, device='cuda:0')
benign distance is  tensor(128.7243, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.11688685417175293
distance x is tensor(129.3985, device='cuda:0')
benign distance is  tensor(129.3985, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 44
counter_tensor is  tensor([ 8., 15., 13., 26., 30., 13., 26., 13., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32.,  0., 43., 42., 12., 12., 43., 13., 42.,
        31.,  0., 17., 43., 19., 39., 12.,  2.,  5., 12., 43., 13.,  1., 13.,
        13., 21.])
count_res tensor([1.3262e-16, 1.4544e-13, 1.9683e-14, 8.7078e-09, 4.7543e-07, 1.9683e-14,
        8.7078e-09, 1.9683e-14, 3.5130e-06, 3.5130e-06, 3.5130e-06, 3.5130e-06,
        3.5130e-06, 3.5130e-06, 3.5130e-06, 3.5130e-06, 3.5130e-06, 3.5130e-06,
        3.5130e-06, 3.5130e-06, 4.4489e-20, 2.1034e-01, 7.7379e-02, 7.2408e-15,
        7.2408e-15, 2.1034e-01, 1.9683e-14, 7.7379e-02, 1.2924e-06, 4.4489e-20,
        1.0746e-12, 2.1034e-01, 7.9405e-12, 3.8525e-03, 7.2408e-15, 3.2873e-19,
        6.6027e-18, 7.2408e-15, 2.1034e-01, 1.9683e-14, 1.2093e-19, 1.9683e-14,
        1.9683e-14, 5.8673e-11])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 89.01% 

Test Accuracy: 88.44% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7171651721000671
distance x is tensor(108.7047, device='cuda:0')
benign distance is  tensor(108.7047, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5285689234733582
distance x is tensor(138.5812, device='cuda:0')
benign distance is  tensor(138.5812, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.09100176393985748
distance x is tensor(124.5533, device='cuda:0')
benign distance is  tensor(124.5533, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.45391225814819336
distance x is tensor(110.6602, device='cuda:0')
benign distance is  tensor(110.6602, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7356568574905396
distance x is tensor(96.5234, device='cuda:0')
benign distance is  tensor(96.5234, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4459151327610016
distance x is tensor(117.0821, device='cuda:0')
benign distance is  tensor(117.0821, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.29723766446113586
distance x is tensor(123.0428, device='cuda:0')
benign distance is  tensor(123.0428, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.32668179273605347
distance x is tensor(118.3740, device='cuda:0')
benign distance is  tensor(118.3740, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4962950646877289
distance x is tensor(135.7265, device='cuda:0')
benign distance is  tensor(135.7265, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4314054846763611
distance x is tensor(127.9117, device='cuda:0')
benign distance is  tensor(127.9117, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5684276819229126
distance x is tensor(110.4019, device='cuda:0')
benign distance is  tensor(110.4019, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.2597143054008484
distance x is tensor(131.9418, device='cuda:0')
benign distance is  tensor(131.9418, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7158426642417908
distance x is tensor(124.7882, device='cuda:0')
benign distance is  tensor(124.7882, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.21800699830055237
distance x is tensor(121.9016, device='cuda:0')
benign distance is  tensor(121.9016, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.31944265961647034
distance x is tensor(141.2339, device='cuda:0')
benign distance is  tensor(141.2339, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7670530080795288
distance x is tensor(138.9000, device='cuda:0')
benign distance is  tensor(138.9000, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2091716080904007
distance x is tensor(122.0500, device='cuda:0')
benign distance is  tensor(122.0500, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9747069478034973
distance x is tensor(143.5992, device='cuda:0')
benign distance is  tensor(143.5992, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.20518004894256592
distance x is tensor(127.3281, device='cuda:0')
benign distance is  tensor(127.3281, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.36585819721221924
distance x is tensor(118.9463, device='cuda:0')
benign distance is  tensor(118.9463, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.34855371713638306
distance x is tensor(131.0126, device='cuda:0')
benign distance is  tensor(131.0126, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.996756911277771
distance x is tensor(123.0710, device='cuda:0')
benign distance is  tensor(123.0710, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.24488303065299988
distance x is tensor(132.8109, device='cuda:0')
benign distance is  tensor(132.8109, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5864203572273254
distance x is tensor(112.2810, device='cuda:0')
benign distance is  tensor(112.2810, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.09749642759561539
distance x is tensor(117.8356, device='cuda:0')
benign distance is  tensor(117.8356, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.409222275018692
distance x is tensor(119.2043, device='cuda:0')
benign distance is  tensor(119.2043, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.15645401179790497
distance x is tensor(136.2511, device='cuda:0')
benign distance is  tensor(136.2511, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.4126294255256653
distance x is tensor(143.0816, device='cuda:0')
benign distance is  tensor(143.0816, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.30939796566963196
distance x is tensor(138.5589, device='cuda:0')
benign distance is  tensor(138.5589, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.18439748883247375
distance x is tensor(128.0707, device='cuda:0')
benign distance is  tensor(128.0707, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.4804713726043701
distance x is tensor(127.4861, device='cuda:0')
benign distance is  tensor(127.4861, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.24023428559303284
distance x is tensor(131.0729, device='cuda:0')
benign distance is  tensor(131.0729, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 17., 16.,  8.,  8.,  8.,
         8.,  8.,  8.,  9., 11., 12.])
count_res tensor([4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03,
        4.6969e-03, 4.6969e-03, 1.7279e-03, 6.9708e-01, 2.5644e-01, 8.6027e-05,
        8.6027e-05, 8.6027e-05, 8.6027e-05, 8.6027e-05, 8.6027e-05, 2.3384e-04,
        1.7279e-03, 4.6969e-03])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 87.48% 

Test Accuracy: 86.73% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.49179357290267944
distance x is tensor(103.4326, device='cuda:0')
benign distance is  tensor(103.4326, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7960543632507324
distance x is tensor(104.9648, device='cuda:0')
benign distance is  tensor(104.9648, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.06293708831071854
distance x is tensor(108.3674, device='cuda:0')
benign distance is  tensor(108.3674, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8001598119735718
distance x is tensor(98.5099, device='cuda:0')
benign distance is  tensor(98.5099, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8001626133918762
distance x is tensor(100.3429, device='cuda:0')
benign distance is  tensor(100.3429, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0444389581680298
distance x is tensor(106.9172, device='cuda:0')
benign distance is  tensor(106.9172, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.21607919037342072
distance x is tensor(110.2542, device='cuda:0')
benign distance is  tensor(110.2542, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.40041032433509827
distance x is tensor(109.4183, device='cuda:0')
benign distance is  tensor(109.4183, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([20., 30., 12.,  0., 21., 17.,  0., 32., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 35., 12., 34., 12., 12., 12., 19., 13.,
        12., 35., 12., 12., 12., 33.,  0.,  2.])
count_res tensor([1.1950e-07, 2.6321e-03, 4.0086e-11, 2.4630e-16, 3.2482e-07, 5.9493e-09,
        2.4630e-16, 1.9449e-02, 6.5243e-06, 6.5243e-06, 6.5243e-06, 6.5243e-06,
        6.5243e-06, 6.5243e-06, 6.5243e-06, 6.5243e-06, 6.5243e-06, 6.5243e-06,
        6.5243e-06, 6.5243e-06, 3.9063e-01, 4.0086e-11, 1.4371e-01, 4.0086e-11,
        4.0086e-11, 4.0086e-11, 4.3960e-08, 1.0897e-10, 4.0086e-11, 3.9063e-01,
        4.0086e-11, 4.0086e-11, 4.0086e-11, 5.2867e-02, 2.4630e-16, 1.8199e-15])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 89.26% 

Test Accuracy: 88.14% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8022823333740234
distance x is tensor(105.5548, device='cuda:0')
benign distance is  tensor(105.5548, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.48572254180908203
distance x is tensor(112.0618, device='cuda:0')
benign distance is  tensor(112.0618, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.15370364487171173
distance x is tensor(124.4417, device='cuda:0')
benign distance is  tensor(124.4417, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6801577210426331
distance x is tensor(105.1530, device='cuda:0')
benign distance is  tensor(105.1530, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5705313086509705
distance x is tensor(96.7440, device='cuda:0')
benign distance is  tensor(96.7440, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6075841784477234
distance x is tensor(123.8719, device='cuda:0')
benign distance is  tensor(123.8719, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.19453337788581848
distance x is tensor(113.4044, device='cuda:0')
benign distance is  tensor(113.4044, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.34039101004600525
distance x is tensor(131.6825, device='cuda:0')
benign distance is  tensor(131.6825, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.01879235729575157
distance x is tensor(134.6601, device='cuda:0')
benign distance is  tensor(134.6601, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.14399240911006927
distance x is tensor(113.8207, device='cuda:0')
benign distance is  tensor(113.8207, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5320207476615906
distance x is tensor(130.2551, device='cuda:0')
benign distance is  tensor(130.2551, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8454706072807312
distance x is tensor(128.6642, device='cuda:0')
benign distance is  tensor(128.6642, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7254882454872131
distance x is tensor(125.7857, device='cuda:0')
benign distance is  tensor(125.7857, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.13699722290039062
distance x is tensor(127.2430, device='cuda:0')
benign distance is  tensor(127.2430, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0495328903198242
distance x is tensor(131.8808, device='cuda:0')
benign distance is  tensor(131.8808, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.478888601064682
distance x is tensor(126.9723, device='cuda:0')
benign distance is  tensor(126.9723, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.4468561112880707
distance x is tensor(112.4519, device='cuda:0')
benign distance is  tensor(112.4519, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.49298182129859924
distance x is tensor(119.8256, device='cuda:0')
benign distance is  tensor(119.8256, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5157064199447632
distance x is tensor(130.9477, device='cuda:0')
benign distance is  tensor(130.9477, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.090010404586792
distance x is tensor(138.4917, device='cuda:0')
benign distance is  tensor(138.4917, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9271749258041382
distance x is tensor(125.0164, device='cuda:0')
benign distance is  tensor(125.0164, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.530760645866394
distance x is tensor(127.2090, device='cuda:0')
benign distance is  tensor(127.2090, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.16877250373363495
distance x is tensor(126.1865, device='cuda:0')
benign distance is  tensor(126.1865, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.3382953107357025
distance x is tensor(130.7221, device='cuda:0')
benign distance is  tensor(130.7221, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 12.,  0., 12., 13., 27., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 24., 12., 15., 12., 13., 27., 13., 12.])
count_res tensor([1.4922e-07, 1.4922e-07, 9.1684e-13, 1.4922e-07, 4.0562e-07, 4.8781e-01,
        1.4922e-07, 1.4922e-07, 8.1472e-06, 8.1472e-06, 8.1472e-06, 8.1472e-06,
        8.1472e-06, 8.1472e-06, 8.1472e-06, 8.1472e-06, 8.1472e-06, 8.1472e-06,
        8.1472e-06, 8.1472e-06, 2.4286e-02, 1.4922e-07, 2.9972e-06, 1.4922e-07,
        4.0562e-07, 4.8781e-01, 4.0562e-07, 1.4922e-07])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 89.19% 

Test Accuracy: 88.45% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3949897289276123
distance x is tensor(120.5638, device='cuda:0')
benign distance is  tensor(120.5638, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5858302712440491
distance x is tensor(131.4543, device='cuda:0')
benign distance is  tensor(131.4543, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.14984320104122162
distance x is tensor(139.2990, device='cuda:0')
benign distance is  tensor(139.2990, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.885377049446106
distance x is tensor(127.5275, device='cuda:0')
benign distance is  tensor(127.5275, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7388659715652466
distance x is tensor(121.4622, device='cuda:0')
benign distance is  tensor(121.4622, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4830954074859619
distance x is tensor(107.0846, device='cuda:0')
benign distance is  tensor(107.0846, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6535326242446899
distance x is tensor(126.4372, device='cuda:0')
benign distance is  tensor(126.4372, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.22446072101593018
distance x is tensor(124.0577, device='cuda:0')
benign distance is  tensor(124.0577, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3413756191730499
distance x is tensor(132.3242, device='cuda:0')
benign distance is  tensor(132.3242, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.33665579557418823
distance x is tensor(142.5530, device='cuda:0')
benign distance is  tensor(142.5530, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.25219327211380005
distance x is tensor(138.3139, device='cuda:0')
benign distance is  tensor(138.3139, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2970699369907379
distance x is tensor(125.5040, device='cuda:0')
benign distance is  tensor(125.5040, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4380488395690918
distance x is tensor(142.8453, device='cuda:0')
benign distance is  tensor(142.8453, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5148822069168091
distance x is tensor(107.0127, device='cuda:0')
benign distance is  tensor(107.0127, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4351121783256531
distance x is tensor(152.3910, device='cuda:0')
benign distance is  tensor(152.3910, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8695304989814758
distance x is tensor(128.5147, device='cuda:0')
benign distance is  tensor(128.5147, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([22., 22., 35., 12.,  0.,  1., 12., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 12., 12., 35., 12., 35., 28., 12., 32.,
        12., 20., 12.,  0.,  0., 34., 12., 12.])
count_res tensor([6.6115e-07, 6.6115e-07, 2.9250e-01, 3.0016e-11, 1.8443e-16, 5.0132e-16,
        3.0016e-11, 3.0016e-11, 4.8853e-06, 4.8853e-06, 4.8853e-06, 4.8853e-06,
        4.8853e-06, 4.8853e-06, 4.8853e-06, 4.8853e-06, 4.8853e-06, 4.8853e-06,
        4.8853e-06, 4.8853e-06, 3.0016e-11, 3.0016e-11, 2.9250e-01, 3.0016e-11,
        2.9250e-01, 2.6673e-04, 3.0016e-11, 1.4563e-02, 3.0016e-11, 8.9477e-08,
        3.0016e-11, 1.8443e-16, 1.8443e-16, 1.0761e-01, 3.0016e-11, 3.0016e-11])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 89.02% 

Test Accuracy: 88.49% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4996054172515869
distance x is tensor(122.2407, device='cuda:0')
benign distance is  tensor(122.2407, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.42302703857421875
distance x is tensor(115.1258, device='cuda:0')
benign distance is  tensor(115.1258, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.0832059308886528
distance x is tensor(114.5338, device='cuda:0')
benign distance is  tensor(114.5338, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.48291778564453125
distance x is tensor(120.1907, device='cuda:0')
benign distance is  tensor(120.1907, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2974192202091217
distance x is tensor(114.7567, device='cuda:0')
benign distance is  tensor(114.7567, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4877170920372009
distance x is tensor(123.7109, device='cuda:0')
benign distance is  tensor(123.7109, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.31289878487586975
distance x is tensor(128.9778, device='cuda:0')
benign distance is  tensor(128.9778, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.40066948533058167
distance x is tensor(124.6607, device='cuda:0')
benign distance is  tensor(124.6607, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.20171935856342316
distance x is tensor(141.4932, device='cuda:0')
benign distance is  tensor(141.4932, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5867440700531006
distance x is tensor(140.2934, device='cuda:0')
benign distance is  tensor(140.2934, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5076862573623657
distance x is tensor(119.5126, device='cuda:0')
benign distance is  tensor(119.5126, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.13290207087993622
distance x is tensor(152.7714, device='cuda:0')
benign distance is  tensor(152.7714, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5563744902610779
distance x is tensor(134.0158, device='cuda:0')
benign distance is  tensor(134.0158, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.17774616181850433
distance x is tensor(134.1270, device='cuda:0')
benign distance is  tensor(134.1270, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5730795860290527
distance x is tensor(131.3521, device='cuda:0')
benign distance is  tensor(131.3521, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8707529902458191
distance x is tensor(134.7824, device='cuda:0')
benign distance is  tensor(134.7824, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.2505679726600647
distance x is tensor(138.9974, device='cuda:0')
benign distance is  tensor(138.9974, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.3817714750766754
distance x is tensor(123.8712, device='cuda:0')
benign distance is  tensor(123.8712, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.4411434531211853
distance x is tensor(109.0202, device='cuda:0')
benign distance is  tensor(109.0202, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.19885006546974182
distance x is tensor(133.1046, device='cuda:0')
benign distance is  tensor(133.1046, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.33903878927230835
distance x is tensor(118.8201, device='cuda:0')
benign distance is  tensor(118.8201, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.42392945289611816
distance x is tensor(128.6685, device='cuda:0')
benign distance is  tensor(128.6685, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.4389491677284241
distance x is tensor(122.1952, device='cuda:0')
benign distance is  tensor(122.1952, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.6243242621421814
distance x is tensor(127.1161, device='cuda:0')
benign distance is  tensor(127.1161, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 19.,  9., 16.,  8.,  8.,  8.,
         8.,  8.,  8., 10., 10., 12.])
count_res tensor([8.6158e-04, 8.6158e-04, 8.6158e-04, 8.6158e-04, 8.6158e-04, 8.6158e-04,
        8.6158e-04, 8.6158e-04, 9.4483e-01, 4.2895e-05, 4.7041e-02, 1.5780e-05,
        1.5780e-05, 1.5780e-05, 1.5780e-05, 1.5780e-05, 1.5780e-05, 1.1660e-04,
        1.1660e-04, 8.6158e-04])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 87.08% 

Test Accuracy: 86.63% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.36279404163360596
distance x is tensor(102.9332, device='cuda:0')
benign distance is  tensor(102.9332, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6675418615341187
distance x is tensor(114.2350, device='cuda:0')
benign distance is  tensor(114.2350, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2393745630979538
distance x is tensor(106.4904, device='cuda:0')
benign distance is  tensor(106.4904, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5278868079185486
distance x is tensor(103.2775, device='cuda:0')
benign distance is  tensor(103.2775, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.19304987788200378
distance x is tensor(117.9928, device='cuda:0')
benign distance is  tensor(117.9928, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.757837176322937
distance x is tensor(113.5925, device='cuda:0')
benign distance is  tensor(113.5925, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.31690657138824463
distance x is tensor(117.3357, device='cuda:0')
benign distance is  tensor(117.3357, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3509671092033386
distance x is tensor(116.6034, device='cuda:0')
benign distance is  tensor(116.6034, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 52
counter_tensor is  tensor([12., 12., 12., 12., 20., 12., 51., 46., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 51., 12., 12., 51.,  1.,  0., 12., 51.,
        21.,  0.,  1., 12., 46.,  0., 33., 51., 51., 50., 28., 51., 51., 12.,
        43.,  1.,  0.,  6., 12.,  4., 46., 19., 26.,  0.])
count_res tensor([1.3767e-18, 1.3767e-18, 1.3767e-18, 1.3767e-18, 4.1037e-15, 1.3767e-18,
        1.1921e-01, 8.0322e-04, 1.9910e-06, 1.9910e-06, 1.9910e-06, 1.9910e-06,
        1.9910e-06, 1.9910e-06, 1.9910e-06, 1.9910e-06, 1.9910e-06, 1.9910e-06,
        1.9910e-06, 1.9910e-06, 1.1921e-01, 1.3767e-18, 1.3767e-18, 1.1921e-01,
        2.2992e-23, 8.4584e-24, 1.3767e-18, 1.1921e-01, 1.1155e-14, 8.4584e-24,
        2.2992e-23, 1.3767e-18, 8.0322e-04, 8.4584e-24, 1.8156e-09, 1.1921e-01,
        1.1921e-01, 4.3855e-02, 1.2233e-11, 1.1921e-01, 1.1921e-01, 1.3767e-18,
        3.9990e-05, 2.2992e-23, 8.4584e-24, 3.4124e-21, 1.3767e-18, 4.6182e-22,
        8.0322e-04, 1.5097e-15, 1.6556e-12, 8.4584e-24])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 89.65% 

Test Accuracy: 88.94% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7614537477493286
distance x is tensor(103.9299, device='cuda:0')
benign distance is  tensor(103.9299, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.565420925617218
distance x is tensor(119.8154, device='cuda:0')
benign distance is  tensor(119.8154, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.339483380317688
distance x is tensor(124.6681, device='cuda:0')
benign distance is  tensor(124.6681, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5677002668380737
distance x is tensor(101.9826, device='cuda:0')
benign distance is  tensor(101.9826, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1185262203216553
distance x is tensor(101.7356, device='cuda:0')
benign distance is  tensor(101.7356, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.18760260939598083
distance x is tensor(106.4236, device='cuda:0')
benign distance is  tensor(106.4236, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.45124348998069763
distance x is tensor(118.6889, device='cuda:0')
benign distance is  tensor(118.6889, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.37408000230789185
distance x is tensor(115.9982, device='cuda:0')
benign distance is  tensor(115.9982, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6731085777282715
distance x is tensor(130.5934, device='cuda:0')
benign distance is  tensor(130.5934, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.38467639684677124
distance x is tensor(119.4584, device='cuda:0')
benign distance is  tensor(119.4584, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9738166928291321
distance x is tensor(117.2074, device='cuda:0')
benign distance is  tensor(117.2074, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9626232981681824
distance x is tensor(112.1066, device='cuda:0')
benign distance is  tensor(112.1066, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.40167236328125
distance x is tensor(113.9272, device='cuda:0')
benign distance is  tensor(113.9272, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.188018336892128
distance x is tensor(117.1458, device='cuda:0')
benign distance is  tensor(117.1458, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4247685372829437
distance x is tensor(123.2301, device='cuda:0')
benign distance is  tensor(123.2301, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1204255819320679
distance x is tensor(130.1054, device='cuda:0')
benign distance is  tensor(130.1054, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.37104493379592896
distance x is tensor(117.2125, device='cuda:0')
benign distance is  tensor(117.2125, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9324795603752136
distance x is tensor(137.7986, device='cuda:0')
benign distance is  tensor(137.7986, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.22890499234199524
distance x is tensor(118.1246, device='cuda:0')
benign distance is  tensor(118.1246, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3168737292289734
distance x is tensor(107.7048, device='cuda:0')
benign distance is  tensor(107.7048, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.43952029943466187
distance x is tensor(121.9679, device='cuda:0')
benign distance is  tensor(121.9679, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.48995986580848694
distance x is tensor(112.1288, device='cuda:0')
benign distance is  tensor(112.1288, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.07815561443567276
distance x is tensor(131.9258, device='cuda:0')
benign distance is  tensor(131.9258, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.28737807273864746
distance x is tensor(109.2090, device='cuda:0')
benign distance is  tensor(109.2090, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.26618704199790955
distance x is tensor(116.2157, device='cuda:0')
benign distance is  tensor(116.2157, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6336559057235718
distance x is tensor(117.5466, device='cuda:0')
benign distance is  tensor(117.5466, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.21507683396339417
distance x is tensor(125.2975, device='cuda:0')
benign distance is  tensor(125.2975, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.6442376375198364
distance x is tensor(132.8736, device='cuda:0')
benign distance is  tensor(132.8736, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9379806518554688
distance x is tensor(125.1265, device='cuda:0')
benign distance is  tensor(125.1265, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.40924936532974243
distance x is tensor(123.9844, device='cuda:0')
benign distance is  tensor(123.9844, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.13449440896511078
distance x is tensor(127.8636, device='cuda:0')
benign distance is  tensor(127.8636, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.5912352800369263
distance x is tensor(117.9372, device='cuda:0')
benign distance is  tensor(117.9372, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.3737051486968994
distance x is tensor(117.8859, device='cuda:0')
benign distance is  tensor(117.8859, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.4540700912475586
distance x is tensor(115.2152, device='cuda:0')
benign distance is  tensor(115.2152, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.19300439953804016
distance x is tensor(115.0226, device='cuda:0')
benign distance is  tensor(115.0226, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.5251897573471069
distance x is tensor(118.6744, device='cuda:0')
benign distance is  tensor(118.6744, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.4801163077354431
distance x is tensor(133.7243, device='cuda:0')
benign distance is  tensor(133.7243, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.945422351360321
distance x is tensor(120.6771, device='cuda:0')
benign distance is  tensor(120.6771, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9161258935928345
distance x is tensor(121.3280, device='cuda:0')
benign distance is  tensor(121.3280, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5848512053489685
distance x is tensor(112.1906, device='cuda:0')
benign distance is  tensor(112.1906, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 19.,  9., 15.,  8.,  8.,  8.,
         8.,  8.,  9., 10.,  9., 13.])
count_res tensor([8.8667e-04, 8.8667e-04, 8.8667e-04, 8.8667e-04, 8.8667e-04, 8.8667e-04,
        8.8667e-04, 8.8667e-04, 9.7235e-01, 4.4145e-05, 1.7809e-02, 1.6240e-05,
        1.6240e-05, 1.6240e-05, 1.6240e-05, 1.6240e-05, 4.4145e-05, 1.2000e-04,
        4.4145e-05, 2.4102e-03])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 88.55% 

Test Accuracy: 87.99% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6171395182609558
distance x is tensor(100.0847, device='cuda:0')
benign distance is  tensor(100.0847, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2611696124076843
distance x is tensor(107.6029, device='cuda:0')
benign distance is  tensor(107.6029, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.31851640343666077
distance x is tensor(116.4460, device='cuda:0')
benign distance is  tensor(116.4460, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4252609610557556
distance x is tensor(103.0618, device='cuda:0')
benign distance is  tensor(103.0618, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5060526132583618
distance x is tensor(87.3107, device='cuda:0')
benign distance is  tensor(87.3107, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8191478848457336
distance x is tensor(100.1715, device='cuda:0')
benign distance is  tensor(100.1715, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4020240902900696
distance x is tensor(106.0064, device='cuda:0')
benign distance is  tensor(106.0064, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.46840938925743103
distance x is tensor(111.3561, device='cuda:0')
benign distance is  tensor(111.3561, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([26., 25., 12., 12., 13., 12., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 13., 13., 25., 17., 12.,  0., 12.])
count_res tensor([5.7589e-01, 2.1186e-01, 4.7887e-07, 4.7887e-07, 1.3017e-06, 4.7887e-07,
        4.7887e-07, 4.7887e-07, 2.6145e-05, 2.6145e-05, 2.6145e-05, 2.6145e-05,
        2.6145e-05, 2.6145e-05, 2.6145e-05, 2.6145e-05, 2.6145e-05, 2.6145e-05,
        2.6145e-05, 2.6145e-05, 4.7887e-07, 1.3017e-06, 1.3017e-06, 2.1186e-01,
        7.1071e-05, 4.7887e-07, 2.9423e-12, 4.7887e-07])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 88.92% 

Test Accuracy: 88.27% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2323973178863525
distance x is tensor(81.9425, device='cuda:0')
benign distance is  tensor(81.9425, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.454756498336792
distance x is tensor(110.0789, device='cuda:0')
benign distance is  tensor(110.0789, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3674403131008148
distance x is tensor(128.6117, device='cuda:0')
benign distance is  tensor(128.6117, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5490449070930481
distance x is tensor(125.9358, device='cuda:0')
benign distance is  tensor(125.9358, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6787261366844177
distance x is tensor(124.4152, device='cuda:0')
benign distance is  tensor(124.4152, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1421403884887695
distance x is tensor(122.0280, device='cuda:0')
benign distance is  tensor(122.0280, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.28667476773262024
distance x is tensor(127.8886, device='cuda:0')
benign distance is  tensor(127.8886, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.10899219661951065
distance x is tensor(125.0844, device='cuda:0')
benign distance is  tensor(125.0844, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2974441647529602
distance x is tensor(144.1619, device='cuda:0')
benign distance is  tensor(144.1619, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4642532765865326
distance x is tensor(131.8692, device='cuda:0')
benign distance is  tensor(131.8692, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3822591304779053
distance x is tensor(135.0742, device='cuda:0')
benign distance is  tensor(135.0742, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.233555555343628
distance x is tensor(121.7330, device='cuda:0')
benign distance is  tensor(121.7330, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6391127109527588
distance x is tensor(129.7126, device='cuda:0')
benign distance is  tensor(129.7126, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.565713107585907
distance x is tensor(134.5395, device='cuda:0')
benign distance is  tensor(134.5395, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5140896439552307
distance x is tensor(139.9192, device='cuda:0')
benign distance is  tensor(139.9192, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6231881380081177
distance x is tensor(135.7683, device='cuda:0')
benign distance is  tensor(135.7683, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([13.,  0.,  4., 13., 18., 12., 16.,  0., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 20., 13., 35., 15., 31., 28., 29.,  1.,
        33., 17., 29., 16.,  0., 12., 12., 33.])
count_res tensor([2.1539e-10, 4.8686e-16, 2.6582e-14, 2.1539e-10, 3.1967e-08, 7.9239e-11,
        4.3263e-09, 4.8686e-16, 1.2897e-05, 1.2897e-05, 1.2897e-05, 1.2897e-05,
        1.2897e-05, 1.2897e-05, 1.2897e-05, 1.2897e-05, 1.2897e-05, 1.2897e-05,
        1.2897e-05, 1.2897e-05, 2.3621e-07, 2.1539e-10, 7.7217e-01, 1.5916e-09,
        1.4143e-02, 7.0413e-04, 1.9140e-03, 1.3234e-15, 1.0450e-01, 1.1760e-08,
        1.9140e-03, 4.3263e-09, 4.8686e-16, 7.9239e-11, 7.9239e-11, 1.0450e-01])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 87.95% 

Test Accuracy: 87.23% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.10040061175823212
distance x is tensor(139.3921, device='cuda:0')
benign distance is  tensor(139.3921, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8199472427368164
distance x is tensor(143.1393, device='cuda:0')
benign distance is  tensor(143.1393, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3749299645423889
distance x is tensor(137.8255, device='cuda:0')
benign distance is  tensor(137.8255, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.36046338081359863
distance x is tensor(138.3275, device='cuda:0')
benign distance is  tensor(138.3275, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5296452045440674
distance x is tensor(148.7045, device='cuda:0')
benign distance is  tensor(148.7045, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5586098432540894
distance x is tensor(138.8952, device='cuda:0')
benign distance is  tensor(138.8952, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8890508413314819
distance x is tensor(146.4299, device='cuda:0')
benign distance is  tensor(146.4299, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.29029136896133423
distance x is tensor(138.1896, device='cuda:0')
benign distance is  tensor(138.1896, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.147306889295578
distance x is tensor(146.9730, device='cuda:0')
benign distance is  tensor(146.9730, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6916474103927612
distance x is tensor(156.6581, device='cuda:0')
benign distance is  tensor(156.6581, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.41860342025756836
distance x is tensor(140.5648, device='cuda:0')
benign distance is  tensor(140.5648, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.1513061672449112
distance x is tensor(151.1804, device='cuda:0')
benign distance is  tensor(151.1804, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.36684390902519226
distance x is tensor(150.1029, device='cuda:0')
benign distance is  tensor(150.1029, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7183699607849121
distance x is tensor(147.3074, device='cuda:0')
benign distance is  tensor(147.3074, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.20984236896038055
distance x is tensor(153.1605, device='cuda:0')
benign distance is  tensor(153.1605, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6294605135917664
distance x is tensor(141.9127, device='cuda:0')
benign distance is  tensor(141.9127, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.734345018863678
distance x is tensor(150.3551, device='cuda:0')
benign distance is  tensor(150.3551, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.2021152228116989
distance x is tensor(149.1136, device='cuda:0')
benign distance is  tensor(149.1136, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.1983320564031601
distance x is tensor(86.0235, device='cuda:0')
benign distance is  tensor(86.0235, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.18365906178951263
distance x is tensor(155.5159, device='cuda:0')
benign distance is  tensor(155.5159, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.15106216073036194
distance x is tensor(144.3516, device='cuda:0')
benign distance is  tensor(144.3516, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.34640786051750183
distance x is tensor(140.1909, device='cuda:0')
benign distance is  tensor(140.1909, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.18106932938098907
distance x is tensor(141.9425, device='cuda:0')
benign distance is  tensor(141.9425, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.14491017162799835
distance x is tensor(145.9031, device='cuda:0')
benign distance is  tensor(145.9031, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([12.,  0.,  4., 12., 35., 12., 12., 14., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 13., 12., 12.,  0., 12., 33.,  7., 35.,
        12., 31., 35., 35., 34., 13., 12.,  0.])
count_res tensor([2.2695e-11, 1.3944e-16, 7.6132e-15, 2.2695e-11, 2.2115e-01, 2.2695e-11,
        2.2695e-11, 1.6769e-10, 3.6937e-06, 3.6937e-06, 3.6937e-06, 3.6937e-06,
        3.6937e-06, 3.6937e-06, 3.6937e-06, 3.6937e-06, 3.6937e-06, 3.6937e-06,
        3.6937e-06, 3.6937e-06, 6.1690e-11, 2.2695e-11, 2.2695e-11, 1.3944e-16,
        2.2695e-11, 2.9930e-02, 1.5291e-13, 2.2115e-01, 2.2695e-11, 4.0506e-03,
        2.2115e-01, 2.2115e-01, 8.1358e-02, 6.1690e-11, 2.2695e-11, 1.3944e-16])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 89.62% 

Test Accuracy: 88.79% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.17184588313102722
distance x is tensor(108.4590, device='cuda:0')
benign distance is  tensor(108.4590, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4962399899959564
distance x is tensor(102.6576, device='cuda:0')
benign distance is  tensor(102.6576, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1459173560142517
distance x is tensor(123.9496, device='cuda:0')
benign distance is  tensor(123.9496, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9403488039970398
distance x is tensor(128.3281, device='cuda:0')
benign distance is  tensor(128.3281, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7272589206695557
distance x is tensor(89.6759, device='cuda:0')
benign distance is  tensor(89.6759, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.45089444518089294
distance x is tensor(119.6492, device='cuda:0')
benign distance is  tensor(119.6492, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5508044958114624
distance x is tensor(115.4676, device='cuda:0')
benign distance is  tensor(115.4676, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.28726136684417725
distance x is tensor(127.8581, device='cuda:0')
benign distance is  tensor(127.8581, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8423887491226196
distance x is tensor(142.5619, device='cuda:0')
benign distance is  tensor(142.5619, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5644561052322388
distance x is tensor(124.8829, device='cuda:0')
benign distance is  tensor(124.8829, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0343818664550781
distance x is tensor(116.3045, device='cuda:0')
benign distance is  tensor(116.3045, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6736631393432617
distance x is tensor(122.9628, device='cuda:0')
benign distance is  tensor(122.9628, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5995306968688965
distance x is tensor(127.3355, device='cuda:0')
benign distance is  tensor(127.3355, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.26042166352272034
distance x is tensor(122.2395, device='cuda:0')
benign distance is  tensor(122.2395, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5261617302894592
distance x is tensor(136.8543, device='cuda:0')
benign distance is  tensor(136.8543, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.20432564616203308
distance x is tensor(134.5491, device='cuda:0')
benign distance is  tensor(134.5491, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.19470557570457458
distance x is tensor(139.2808, device='cuda:0')
benign distance is  tensor(139.2808, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.8192326426506042
distance x is tensor(123.4929, device='cuda:0')
benign distance is  tensor(123.4929, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.2785053849220276
distance x is tensor(126.7790, device='cuda:0')
benign distance is  tensor(126.7790, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.7871297597885132
distance x is tensor(136.1039, device='cuda:0')
benign distance is  tensor(136.1039, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7232818007469177
distance x is tensor(137.9910, device='cuda:0')
benign distance is  tensor(137.9910, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.31991517543792725
distance x is tensor(123.7395, device='cuda:0')
benign distance is  tensor(123.7395, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.8449721336364746
distance x is tensor(133.1273, device='cuda:0')
benign distance is  tensor(133.1273, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.26889321208000183
distance x is tensor(118.6095, device='cuda:0')
benign distance is  tensor(118.6095, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 17., 16.,  8.,  8.,  8.,
         8.,  9.,  8., 11.,  8., 12.])
count_res tensor([4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03,
        4.6969e-03, 4.6969e-03, 1.7279e-03, 6.9708e-01, 2.5644e-01, 8.6027e-05,
        8.6027e-05, 8.6027e-05, 8.6027e-05, 2.3384e-04, 8.6027e-05, 1.7279e-03,
        8.6027e-05, 4.6969e-03])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 88.77% 

Test Accuracy: 87.89% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8845941424369812
distance x is tensor(100.4412, device='cuda:0')
benign distance is  tensor(100.4412, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4388851225376129
distance x is tensor(102.1854, device='cuda:0')
benign distance is  tensor(102.1854, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.14288190007209778
distance x is tensor(114.9244, device='cuda:0')
benign distance is  tensor(114.9244, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.19413191080093384
distance x is tensor(105.3563, device='cuda:0')
benign distance is  tensor(105.3563, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.33102598786354065
distance x is tensor(99.8220, device='cuda:0')
benign distance is  tensor(99.8220, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8296138644218445
distance x is tensor(115.6993, device='cuda:0')
benign distance is  tensor(115.6993, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.525080144405365
distance x is tensor(103.8146, device='cuda:0')
benign distance is  tensor(103.8146, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6517232060432434
distance x is tensor(123.1975, device='cuda:0')
benign distance is  tensor(123.1975, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 44
counter_tensor is  tensor([42., 12.,  0., 12., 42., 41.,  0., 39., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32.,  0., 12., 12., 12., 14., 42., 12., 38.,
         0.,  6.,  0., 19., 12., 43., 41.,  0., 42., 12., 42., 14., 12., 43.,
         0., 12.])
count_res tensor([8.8960e-02, 8.3246e-15, 5.1148e-20, 8.3246e-15, 8.8960e-02, 3.2727e-02,
        5.1148e-20, 4.4291e-03, 4.0388e-06, 4.0388e-06, 4.0388e-06, 4.0388e-06,
        4.0388e-06, 4.0388e-06, 4.0388e-06, 4.0388e-06, 4.0388e-06, 4.0388e-06,
        4.0388e-06, 4.0388e-06, 5.1148e-20, 8.3246e-15, 8.3246e-15, 8.3246e-15,
        6.1511e-14, 8.8960e-02, 8.3246e-15, 1.6294e-03, 5.1148e-20, 2.0635e-17,
        5.1148e-20, 9.1290e-12, 8.3246e-15, 2.4182e-01, 3.2727e-02, 5.1148e-20,
        8.8960e-02, 8.3246e-15, 8.8960e-02, 6.1511e-14, 8.3246e-15, 2.4182e-01,
        5.1148e-20, 8.3246e-15])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 89.80% 

Test Accuracy: 88.87% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6340429186820984
distance x is tensor(94.5734, device='cuda:0')
benign distance is  tensor(94.5734, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6138790845870972
distance x is tensor(110.6659, device='cuda:0')
benign distance is  tensor(110.6659, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.19296680390834808
distance x is tensor(122.9490, device='cuda:0')
benign distance is  tensor(122.9490, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.47211113572120667
distance x is tensor(113.1145, device='cuda:0')
benign distance is  tensor(113.1145, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5197416543960571
distance x is tensor(98.8507, device='cuda:0')
benign distance is  tensor(98.8507, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7092941403388977
distance x is tensor(108.4850, device='cuda:0')
benign distance is  tensor(108.4850, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3260645270347595
distance x is tensor(116.0656, device='cuda:0')
benign distance is  tensor(116.0656, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.21121004223823547
distance x is tensor(113.3939, device='cuda:0')
benign distance is  tensor(113.3939, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3757520318031311
distance x is tensor(131.1396, device='cuda:0')
benign distance is  tensor(131.1396, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.413903146982193
distance x is tensor(134.7925, device='cuda:0')
benign distance is  tensor(134.7925, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5817724466323853
distance x is tensor(110.3268, device='cuda:0')
benign distance is  tensor(110.3268, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.38213834166526794
distance x is tensor(116.9658, device='cuda:0')
benign distance is  tensor(116.9658, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.46354007720947266
distance x is tensor(112.3404, device='cuda:0')
benign distance is  tensor(112.3404, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.03401771932840347
distance x is tensor(123.5356, device='cuda:0')
benign distance is  tensor(123.5356, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5221735835075378
distance x is tensor(121.5973, device='cuda:0')
benign distance is  tensor(121.5973, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5737512111663818
distance x is tensor(130.7350, device='cuda:0')
benign distance is  tensor(130.7350, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.1416582465171814
distance x is tensor(127.8042, device='cuda:0')
benign distance is  tensor(127.8042, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8765432238578796
distance x is tensor(134.7727, device='cuda:0')
benign distance is  tensor(134.7727, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.47021451592445374
distance x is tensor(120.4198, device='cuda:0')
benign distance is  tensor(120.4198, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7467330098152161
distance x is tensor(135.7473, device='cuda:0')
benign distance is  tensor(135.7473, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.28294792771339417
distance x is tensor(129.2511, device='cuda:0')
benign distance is  tensor(129.2511, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0433709621429443
distance x is tensor(100.2420, device='cuda:0')
benign distance is  tensor(100.2420, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.48984041810035706
distance x is tensor(127.4960, device='cuda:0')
benign distance is  tensor(127.4960, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.249498650431633
distance x is tensor(113.0902, device='cuda:0')
benign distance is  tensor(113.0902, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.20431752502918243
distance x is tensor(133.7470, device='cuda:0')
benign distance is  tensor(133.7470, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.26864343881607056
distance x is tensor(113.7087, device='cuda:0')
benign distance is  tensor(113.7087, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.4488467276096344
distance x is tensor(131.6592, device='cuda:0')
benign distance is  tensor(131.6592, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.38672780990600586
distance x is tensor(132.4831, device='cuda:0')
benign distance is  tensor(132.4831, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.3625414967536926
distance x is tensor(129.5042, device='cuda:0')
benign distance is  tensor(129.5042, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.844664454460144
distance x is tensor(121.1322, device='cuda:0')
benign distance is  tensor(121.1322, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.44328469038009644
distance x is tensor(134.9166, device='cuda:0')
benign distance is  tensor(134.9166, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.43261170387268066
distance x is tensor(130.6317, device='cuda:0')
benign distance is  tensor(130.6317, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 19., 18., 16.,  8.,  8.,  8.,
         9., 10.,  8.,  2.,  8., 10.])
count_res tensor([6.3977e-04, 6.3977e-04, 6.3977e-04, 6.3977e-04, 6.3977e-04, 6.3977e-04,
        6.3977e-04, 6.3977e-04, 7.0159e-01, 2.5810e-01, 3.4930e-02, 1.1718e-05,
        1.1718e-05, 1.1718e-05, 3.1852e-05, 8.6583e-05, 1.1718e-05, 2.9045e-08,
        1.1718e-05, 8.6583e-05])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 88.56% 

Test Accuracy: 87.87% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2702130675315857
distance x is tensor(91.8443, device='cuda:0')
benign distance is  tensor(91.8443, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5406235456466675
distance x is tensor(105.7036, device='cuda:0')
benign distance is  tensor(105.7036, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2000666856765747
distance x is tensor(113.8503, device='cuda:0')
benign distance is  tensor(113.8503, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4486345648765564
distance x is tensor(110.4974, device='cuda:0')
benign distance is  tensor(110.4974, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5547480583190918
distance x is tensor(93.0993, device='cuda:0')
benign distance is  tensor(93.0993, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.001312255859375
distance x is tensor(109.8599, device='cuda:0')
benign distance is  tensor(109.8599, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1195968389511108
distance x is tensor(113.9764, device='cuda:0')
benign distance is  tensor(113.9764, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6892572045326233
distance x is tensor(117.9914, device='cuda:0')
benign distance is  tensor(117.9914, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 44
counter_tensor is  tensor([42.,  7., 12., 12., 43.,  5., 13., 43., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 43.,  0., 42., 12., 43., 12., 12.,  0.,
        20.,  0., 23.,  0., 12., 42.,  7., 42., 12., 24., 42., 13., 12., 26.,
         0., 12.])
count_res tensor([6.2997e-02, 3.9721e-17, 5.8951e-15, 5.8951e-15, 1.7124e-01, 5.3756e-18,
        1.6024e-14, 1.7124e-01, 2.8601e-06, 2.8601e-06, 2.8601e-06, 2.8601e-06,
        2.8601e-06, 2.8601e-06, 2.8601e-06, 2.8601e-06, 2.8601e-06, 2.8601e-06,
        2.8601e-06, 2.8601e-06, 1.7124e-01, 3.6220e-20, 6.2997e-02, 5.8951e-15,
        1.7124e-01, 5.8951e-15, 5.8951e-15, 3.6220e-20, 1.7573e-11, 3.6220e-20,
        3.5296e-10, 3.6220e-20, 5.8951e-15, 6.2997e-02, 3.9721e-17, 6.2997e-02,
        5.8951e-15, 9.5945e-10, 6.2997e-02, 1.6024e-14, 5.8951e-15, 7.0894e-09,
        3.6220e-20, 5.8951e-15])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 89.79% 

Test Accuracy: 88.92% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7323275208473206
distance x is tensor(104.9244, device='cuda:0')
benign distance is  tensor(104.9244, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4900578558444977
distance x is tensor(119.3553, device='cuda:0')
benign distance is  tensor(119.3553, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.32747846841812134
distance x is tensor(128.1888, device='cuda:0')
benign distance is  tensor(128.1888, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.99708491563797
distance x is tensor(104.9304, device='cuda:0')
benign distance is  tensor(104.9304, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6486240029335022
distance x is tensor(96.8962, device='cuda:0')
benign distance is  tensor(96.8962, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.050741195678711
distance x is tensor(116.6920, device='cuda:0')
benign distance is  tensor(116.6920, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.165850430727005
distance x is tensor(119.9302, device='cuda:0')
benign distance is  tensor(119.9302, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3795391321182251
distance x is tensor(114.6098, device='cuda:0')
benign distance is  tensor(114.6098, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5365486145019531
distance x is tensor(135.2612, device='cuda:0')
benign distance is  tensor(135.2612, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3101116120815277
distance x is tensor(127.7104, device='cuda:0')
benign distance is  tensor(127.7104, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5935169458389282
distance x is tensor(113.2751, device='cuda:0')
benign distance is  tensor(113.2751, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6911329030990601
distance x is tensor(121.6190, device='cuda:0')
benign distance is  tensor(121.6190, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0767723321914673
distance x is tensor(119.0843, device='cuda:0')
benign distance is  tensor(119.0843, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1318695992231369
distance x is tensor(121.2155, device='cuda:0')
benign distance is  tensor(121.2155, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7093538045883179
distance x is tensor(124.7006, device='cuda:0')
benign distance is  tensor(124.7006, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0227962732315063
distance x is tensor(128.5148, device='cuda:0')
benign distance is  tensor(128.5148, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.6948350071907043
distance x is tensor(136.4724, device='cuda:0')
benign distance is  tensor(136.4724, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.48279279470443726
distance x is tensor(124.3839, device='cuda:0')
benign distance is  tensor(124.3839, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.6007291674613953
distance x is tensor(125.4826, device='cuda:0')
benign distance is  tensor(125.4826, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5856651067733765
distance x is tensor(134.0067, device='cuda:0')
benign distance is  tensor(134.0067, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6003362536430359
distance x is tensor(134.1677, device='cuda:0')
benign distance is  tensor(134.1677, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.3449189066886902
distance x is tensor(125.3964, device='cuda:0')
benign distance is  tensor(125.3964, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.23165194690227509
distance x is tensor(124.8841, device='cuda:0')
benign distance is  tensor(124.8841, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.30036720633506775
distance x is tensor(119.3443, device='cuda:0')
benign distance is  tensor(119.3443, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.29011034965515137
distance x is tensor(120.8595, device='cuda:0')
benign distance is  tensor(120.8595, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.11976510286331177
distance x is tensor(122.0811, device='cuda:0')
benign distance is  tensor(122.0811, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.16873635351657867
distance x is tensor(115.8144, device='cuda:0')
benign distance is  tensor(115.8144, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.2956090569496155
distance x is tensor(135.7052, device='cuda:0')
benign distance is  tensor(135.7052, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6558043956756592
distance x is tensor(113.0192, device='cuda:0')
benign distance is  tensor(113.0192, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.33990463614463806
distance x is tensor(122.9436, device='cuda:0')
benign distance is  tensor(122.9436, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.1960315853357315
distance x is tensor(122.1948, device='cuda:0')
benign distance is  tensor(122.1948, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.617480993270874
distance x is tensor(113.1555, device='cuda:0')
benign distance is  tensor(113.1555, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 14., 12., 12., 12., 12., 12.,  0., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 12., 12., 12., 12., 23., 26., 18.])
count_res tensor([2.2063e-07, 1.6302e-06, 2.2063e-07, 2.2063e-07, 2.2063e-07, 2.2063e-07,
        2.2063e-07, 1.3556e-12, 1.2046e-05, 1.2046e-05, 1.2046e-05, 1.2046e-05,
        1.2046e-05, 1.2046e-05, 1.2046e-05, 1.2046e-05, 1.2046e-05, 1.2046e-05,
        1.2046e-05, 1.2046e-05, 7.2123e-01, 2.2063e-07, 2.2063e-07, 2.2063e-07,
        2.2063e-07, 1.3210e-02, 2.6532e-01, 8.9007e-05])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 89.03% 

Test Accuracy: 87.88% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.05406268313527107
distance x is tensor(119.4691, device='cuda:0')
benign distance is  tensor(119.4691, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7028058171272278
distance x is tensor(128.0370, device='cuda:0')
benign distance is  tensor(128.0370, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1798432171344757
distance x is tensor(132.9381, device='cuda:0')
benign distance is  tensor(132.9381, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.46323728561401367
distance x is tensor(117.9664, device='cuda:0')
benign distance is  tensor(117.9664, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.36930161714553833
distance x is tensor(110.4466, device='cuda:0')
benign distance is  tensor(110.4466, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4550287127494812
distance x is tensor(127.7394, device='cuda:0')
benign distance is  tensor(127.7394, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.37282752990722656
distance x is tensor(127.7432, device='cuda:0')
benign distance is  tensor(127.7432, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.43191710114479065
distance x is tensor(132.3190, device='cuda:0')
benign distance is  tensor(132.3190, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.14529384672641754
distance x is tensor(102.0993, device='cuda:0')
benign distance is  tensor(102.0993, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.0680291652679443
distance x is tensor(150.8484, device='cuda:0')
benign distance is  tensor(150.8484, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.37778621912002563
distance x is tensor(135.1354, device='cuda:0')
benign distance is  tensor(135.1354, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.16413861513137817
distance x is tensor(136.7473, device='cuda:0')
benign distance is  tensor(136.7473, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.13440240919589996
distance x is tensor(142.3686, device='cuda:0')
benign distance is  tensor(142.3686, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8516591191291809
distance x is tensor(128.6348, device='cuda:0')
benign distance is  tensor(128.6348, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3511093556880951
distance x is tensor(124.6255, device='cuda:0')
benign distance is  tensor(124.6255, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.25762853026390076
distance x is tensor(130.1218, device='cuda:0')
benign distance is  tensor(130.1218, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 12., 12., 12., 27., 12., 15., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 27., 12., 12., 12., 12.,  0., 27.])
count_res tensor([1.0196e-07, 1.0196e-07, 1.0196e-07, 1.0196e-07, 3.3331e-01, 1.0196e-07,
        2.0479e-06, 1.0196e-07, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06,
        5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06,
        5.5668e-06, 5.5668e-06, 1.0196e-07, 3.3331e-01, 1.0196e-07, 1.0196e-07,
        1.0196e-07, 1.0196e-07, 6.2647e-13, 3.3331e-01])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 89.13% 

Test Accuracy: 88.44% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9991452097892761
distance x is tensor(109.0924, device='cuda:0')
benign distance is  tensor(109.0924, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8746777772903442
distance x is tensor(119.6509, device='cuda:0')
benign distance is  tensor(119.6509, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.17659762501716614
distance x is tensor(127.5999, device='cuda:0')
benign distance is  tensor(127.5999, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6990925669670105
distance x is tensor(126.0404, device='cuda:0')
benign distance is  tensor(126.0404, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.21613052487373352
distance x is tensor(82.2343, device='cuda:0')
benign distance is  tensor(82.2343, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7173592448234558
distance x is tensor(128.5858, device='cuda:0')
benign distance is  tensor(128.5858, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7634246945381165
distance x is tensor(134.4078, device='cuda:0')
benign distance is  tensor(134.4078, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6997149586677551
distance x is tensor(123.6702, device='cuda:0')
benign distance is  tensor(123.6702, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2021007537841797
distance x is tensor(146.4494, device='cuda:0')
benign distance is  tensor(146.4494, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.37118783593177795
distance x is tensor(135.8498, device='cuda:0')
benign distance is  tensor(135.8498, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5412319898605347
distance x is tensor(122.9482, device='cuda:0')
benign distance is  tensor(122.9482, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5456820726394653
distance x is tensor(132.9079, device='cuda:0')
benign distance is  tensor(132.9079, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.28521543741226196
distance x is tensor(135.1133, device='cuda:0')
benign distance is  tensor(135.1133, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2659452557563782
distance x is tensor(129.8281, device='cuda:0')
benign distance is  tensor(129.8281, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9641720056533813
distance x is tensor(144.0810, device='cuda:0')
benign distance is  tensor(144.0810, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.970794677734375
distance x is tensor(128.0684, device='cuda:0')
benign distance is  tensor(128.0684, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 17., 15.,  8.,  8.,  8.,
         8.,  8.,  8.,  9., 11., 13.])
count_res tensor([5.5521e-03, 5.5521e-03, 5.5521e-03, 5.5521e-03, 5.5521e-03, 5.5521e-03,
        5.5521e-03, 5.5521e-03, 2.0425e-03, 8.2400e-01, 1.1152e-01, 1.0169e-04,
        1.0169e-04, 1.0169e-04, 1.0169e-04, 1.0169e-04, 1.0169e-04, 2.7642e-04,
        2.0425e-03, 1.5092e-02])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 88.71% 

Test Accuracy: 87.70% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8525562286376953
distance x is tensor(112.6939, device='cuda:0')
benign distance is  tensor(112.6939, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1386977434158325
distance x is tensor(113.0484, device='cuda:0')
benign distance is  tensor(113.0484, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.22979357838630676
distance x is tensor(126.1238, device='cuda:0')
benign distance is  tensor(126.1238, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6961353421211243
distance x is tensor(109.1254, device='cuda:0')
benign distance is  tensor(109.1254, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.252880334854126
distance x is tensor(74.3416, device='cuda:0')
benign distance is  tensor(74.3416, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9076544046401978
distance x is tensor(114.9974, device='cuda:0')
benign distance is  tensor(114.9974, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.37836986780166626
distance x is tensor(123.3342, device='cuda:0')
benign distance is  tensor(123.3342, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.12057896703481674
distance x is tensor(121.3203, device='cuda:0')
benign distance is  tensor(121.3203, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 52
counter_tensor is  tensor([12.,  9.,  0., 12., 51., 12., 49., 14., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 46., 51., 12.,  5., 33.,  0., 12., 47.,
         9., 12., 51.,  0., 16., 22.,  0., 49., 45.,  5.,  0., 51., 22., 37.,
         0., 12., 39., 12., 12., 13., 50., 51.,  0., 51.])
count_res tensor([1.7323e-18, 8.6248e-20, 1.0644e-23, 1.7323e-18, 1.5001e-01, 1.7323e-18,
        2.0301e-02, 1.2800e-17, 2.5054e-06, 2.5054e-06, 2.5054e-06, 2.5054e-06,
        2.5054e-06, 2.5054e-06, 2.5054e-06, 2.5054e-06, 2.5054e-06, 2.5054e-06,
        2.5054e-06, 2.5054e-06, 1.0107e-03, 1.5001e-01, 1.7323e-18, 1.5797e-21,
        2.2846e-09, 1.0644e-23, 1.7323e-18, 2.7475e-03, 8.6248e-20, 1.7323e-18,
        1.5001e-01, 1.0644e-23, 9.4582e-17, 3.8157e-14, 1.0644e-23, 2.0301e-02,
        3.7183e-04, 1.5797e-21, 1.0644e-23, 1.5001e-01, 3.8157e-14, 1.2474e-07,
        1.0644e-23, 1.7323e-18, 9.2168e-07, 1.7323e-18, 1.7323e-18, 4.7090e-18,
        5.5185e-02, 1.5001e-01, 1.0644e-23, 1.5001e-01])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 89.84% 

Test Accuracy: 89.22% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3155762851238251
distance x is tensor(114.1358, device='cuda:0')
benign distance is  tensor(114.1358, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3772008419036865
distance x is tensor(119.0054, device='cuda:0')
benign distance is  tensor(119.0054, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.05023114010691643
distance x is tensor(134.6569, device='cuda:0')
benign distance is  tensor(134.6569, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.20142126083374023
distance x is tensor(115.8447, device='cuda:0')
benign distance is  tensor(115.8447, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.20039168000221252
distance x is tensor(84.2137, device='cuda:0')
benign distance is  tensor(84.2137, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.41400060057640076
distance x is tensor(111.2606, device='cuda:0')
benign distance is  tensor(111.2606, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.09697531163692474
distance x is tensor(119.5791, device='cuda:0')
benign distance is  tensor(119.5791, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7503408193588257
distance x is tensor(122.4497, device='cuda:0')
benign distance is  tensor(122.4497, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.23978383839130402
distance x is tensor(126.6827, device='cuda:0')
benign distance is  tensor(126.6827, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.32656604051589966
distance x is tensor(124.6010, device='cuda:0')
benign distance is  tensor(124.6010, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.1724632978439331
distance x is tensor(113.4472, device='cuda:0')
benign distance is  tensor(113.4472, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3202943801879883
distance x is tensor(120.9798, device='cuda:0')
benign distance is  tensor(120.9798, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6254647374153137
distance x is tensor(120.9366, device='cuda:0')
benign distance is  tensor(120.9366, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.21655908226966858
distance x is tensor(116.1232, device='cuda:0')
benign distance is  tensor(116.1232, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.48205575346946716
distance x is tensor(125.1947, device='cuda:0')
benign distance is  tensor(125.1947, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.40475910902023315
distance x is tensor(118.0692, device='cuda:0')
benign distance is  tensor(118.0692, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2154051512479782
distance x is tensor(121.0177, device='cuda:0')
benign distance is  tensor(121.0177, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5261353850364685
distance x is tensor(139.3253, device='cuda:0')
benign distance is  tensor(139.3253, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.43607035279273987
distance x is tensor(136.0835, device='cuda:0')
benign distance is  tensor(136.0835, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2102527916431427
distance x is tensor(122.1750, device='cuda:0')
benign distance is  tensor(122.1750, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4307214617729187
distance x is tensor(142.6786, device='cuda:0')
benign distance is  tensor(142.6786, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.21428298950195312
distance x is tensor(111.3093, device='cuda:0')
benign distance is  tensor(111.3093, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.26299601793289185
distance x is tensor(135.7924, device='cuda:0')
benign distance is  tensor(135.7924, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.32382339239120483
distance x is tensor(126.4911, device='cuda:0')
benign distance is  tensor(126.4911, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.28426840901374817
distance x is tensor(139.2159, device='cuda:0')
benign distance is  tensor(139.2159, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5045477151870728
distance x is tensor(125.4591, device='cuda:0')
benign distance is  tensor(125.4591, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5516009330749512
distance x is tensor(120.3729, device='cuda:0')
benign distance is  tensor(120.3729, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.27782946825027466
distance x is tensor(124.6908, device='cuda:0')
benign distance is  tensor(124.6908, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6719772219657898
distance x is tensor(128.7612, device='cuda:0')
benign distance is  tensor(128.7612, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6651796698570251
distance x is tensor(129.0010, device='cuda:0')
benign distance is  tensor(129.0010, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.27182579040527344
distance x is tensor(127.2491, device='cuda:0')
benign distance is  tensor(127.2491, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.27964282035827637
distance x is tensor(124.9592, device='cuda:0')
benign distance is  tensor(124.9592, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.12185031175613403
distance x is tensor(125.0428, device='cuda:0')
benign distance is  tensor(125.0428, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.8405560255050659
distance x is tensor(113.8863, device='cuda:0')
benign distance is  tensor(113.8863, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.5902661085128784
distance x is tensor(130.8903, device='cuda:0')
benign distance is  tensor(130.8903, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.13746461272239685
distance x is tensor(130.4600, device='cuda:0')
benign distance is  tensor(130.4600, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.07093659788370132
distance x is tensor(137.4661, device='cuda:0')
benign distance is  tensor(137.4661, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.9494072794914246
distance x is tensor(127.6951, device='cuda:0')
benign distance is  tensor(127.6951, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  2.3237650394439697
distance x is tensor(137.8874, device='cuda:0')
benign distance is  tensor(137.8874, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5919713973999023
distance x is tensor(127.9108, device='cuda:0')
benign distance is  tensor(127.9108, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 15., 12., 12., 12., 12., 17., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 15., 12., 12., 12., 23., 25., 13.])
count_res tensor([1.9875e-06, 3.9920e-05, 1.9875e-06, 1.9875e-06, 1.9875e-06, 1.9875e-06,
        2.9497e-04, 1.9875e-06, 1.0851e-04, 1.0851e-04, 1.0851e-04, 1.0851e-04,
        1.0851e-04, 1.0851e-04, 1.0851e-04, 1.0851e-04, 1.0851e-04, 1.0851e-04,
        1.0851e-04, 1.0851e-04, 1.9875e-06, 3.9920e-05, 1.9875e-06, 1.9875e-06,
        1.9875e-06, 1.1900e-01, 8.7930e-01, 5.4026e-06])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 88.52% 

Test Accuracy: 87.34% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1682015657424927
distance x is tensor(118.5988, device='cuda:0')
benign distance is  tensor(118.5988, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1665832996368408
distance x is tensor(127.0096, device='cuda:0')
benign distance is  tensor(127.0096, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.17261144518852234
distance x is tensor(152.8038, device='cuda:0')
benign distance is  tensor(152.8038, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2351672202348709
distance x is tensor(126.9094, device='cuda:0')
benign distance is  tensor(126.9094, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.36200517416000366
distance x is tensor(124.4642, device='cuda:0')
benign distance is  tensor(124.4642, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9466229677200317
distance x is tensor(134.0624, device='cuda:0')
benign distance is  tensor(134.0624, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9646967649459839
distance x is tensor(133.6392, device='cuda:0')
benign distance is  tensor(133.6392, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6844593286514282
distance x is tensor(133.3268, device='cuda:0')
benign distance is  tensor(133.3268, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.4049820899963379
distance x is tensor(132.5518, device='cuda:0')
benign distance is  tensor(132.5518, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.18962162733078003
distance x is tensor(150.0576, device='cuda:0')
benign distance is  tensor(150.0576, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6870326399803162
distance x is tensor(125.4587, device='cuda:0')
benign distance is  tensor(125.4587, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.10268008708953857
distance x is tensor(135.1099, device='cuda:0')
benign distance is  tensor(135.1099, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8844691514968872
distance x is tensor(129.7646, device='cuda:0')
benign distance is  tensor(129.7646, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7119114995002747
distance x is tensor(138.7594, device='cuda:0')
benign distance is  tensor(138.7594, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7791423201560974
distance x is tensor(74.3658, device='cuda:0')
benign distance is  tensor(74.3658, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.46428221464157104
distance x is tensor(135.1922, device='cuda:0')
benign distance is  tensor(135.1922, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 12.,  3., 12., 27., 12., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 18., 21., 12., 12., 27., 12., 12.])
count_res tensor([1.5274e-07, 1.5274e-07, 1.8849e-11, 1.5274e-07, 4.9930e-01, 1.5274e-07,
        1.5274e-07, 1.5274e-07, 8.3391e-06, 8.3391e-06, 8.3391e-06, 8.3391e-06,
        8.3391e-06, 8.3391e-06, 8.3391e-06, 8.3391e-06, 8.3391e-06, 8.3391e-06,
        8.3391e-06, 8.3391e-06, 1.5274e-07, 6.1618e-05, 1.2376e-03, 1.5274e-07,
        1.5274e-07, 4.9930e-01, 1.5274e-07, 1.5274e-07])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 89.07% 

Test Accuracy: 88.48% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2170325219631195
distance x is tensor(131.9739, device='cuda:0')
benign distance is  tensor(131.9739, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8962286710739136
distance x is tensor(117.6638, device='cuda:0')
benign distance is  tensor(117.6638, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.18669268488883972
distance x is tensor(145.0902, device='cuda:0')
benign distance is  tensor(145.0902, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.16182200610637665
distance x is tensor(135.9588, device='cuda:0')
benign distance is  tensor(135.9588, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.32614749670028687
distance x is tensor(65.5105, device='cuda:0')
benign distance is  tensor(65.5105, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9017375707626343
distance x is tensor(128.1197, device='cuda:0')
benign distance is  tensor(128.1197, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2781926095485687
distance x is tensor(130.6116, device='cuda:0')
benign distance is  tensor(130.6116, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2625430226325989
distance x is tensor(125.6430, device='cuda:0')
benign distance is  tensor(125.6430, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6977530717849731
distance x is tensor(151.0203, device='cuda:0')
benign distance is  tensor(151.0203, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3312910795211792
distance x is tensor(145.9691, device='cuda:0')
benign distance is  tensor(145.9691, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7299814820289612
distance x is tensor(117.7767, device='cuda:0')
benign distance is  tensor(117.7767, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6548770666122437
distance x is tensor(128.4090, device='cuda:0')
benign distance is  tensor(128.4090, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.25399407744407654
distance x is tensor(126.1622, device='cuda:0')
benign distance is  tensor(126.1622, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5516584515571594
distance x is tensor(101.6663, device='cuda:0')
benign distance is  tensor(101.6663, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2166646420955658
distance x is tensor(134.7722, device='cuda:0')
benign distance is  tensor(134.7722, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5101751089096069
distance x is tensor(132.2650, device='cuda:0')
benign distance is  tensor(132.2650, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 12., 12., 12., 25., 12., 12.,  0., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 16., 27., 13., 12., 27., 12.])
count_res tensor([1.4324e-07, 1.4324e-07, 1.4324e-07, 1.4324e-07, 6.3372e-02, 1.4324e-07,
        1.4324e-07, 8.8011e-13, 7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06,
        7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06,
        7.8208e-06, 7.8208e-06, 1.4324e-07, 1.4324e-07, 7.8208e-06, 4.6826e-01,
        3.8937e-07, 1.4324e-07, 4.6826e-01, 1.4324e-07])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 88.95% 

Test Accuracy: 88.44% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.1116488128900528
distance x is tensor(118.4476, device='cuda:0')
benign distance is  tensor(118.4476, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.25539645552635193
distance x is tensor(125.1444, device='cuda:0')
benign distance is  tensor(125.1444, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.0772903636097908
distance x is tensor(125.4953, device='cuda:0')
benign distance is  tensor(125.4953, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6541942358016968
distance x is tensor(139.2663, device='cuda:0')
benign distance is  tensor(139.2663, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6386537551879883
distance x is tensor(104.5419, device='cuda:0')
benign distance is  tensor(104.5419, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6968045234680176
distance x is tensor(121.0640, device='cuda:0')
benign distance is  tensor(121.0640, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8409481048583984
distance x is tensor(127.5723, device='cuda:0')
benign distance is  tensor(127.5723, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2737653851509094
distance x is tensor(132.2030, device='cuda:0')
benign distance is  tensor(132.2030, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.8099806904792786
distance x is tensor(125.6368, device='cuda:0')
benign distance is  tensor(125.6368, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.926010012626648
distance x is tensor(147.0832, device='cuda:0')
benign distance is  tensor(147.0832, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5307664275169373
distance x is tensor(142.1605, device='cuda:0')
benign distance is  tensor(142.1605, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.23708948493003845
distance x is tensor(93.8385, device='cuda:0')
benign distance is  tensor(93.8385, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5313305854797363
distance x is tensor(142.1483, device='cuda:0')
benign distance is  tensor(142.1483, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8807241320610046
distance x is tensor(123.3527, device='cuda:0')
benign distance is  tensor(123.3527, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.19413530826568604
distance x is tensor(109.9668, device='cuda:0')
benign distance is  tensor(109.9668, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8509343266487122
distance x is tensor(128.7790, device='cuda:0')
benign distance is  tensor(128.7790, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([12., 35.,  0., 12.,  4., 12., 12., 31., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 18., 27., 12., 35., 35., 21., 34.,  0.,
        12.,  0., 16., 21., 12., 12., 12., 12.])
count_res tensor([3.0300e-11, 2.9527e-01, 1.8617e-16, 3.0300e-11, 1.0165e-14, 3.0300e-11,
        3.0300e-11, 5.4081e-03, 4.9315e-06, 4.9315e-06, 4.9315e-06, 4.9315e-06,
        4.9315e-06, 4.9315e-06, 4.9315e-06, 4.9315e-06, 4.9315e-06, 4.9315e-06,
        4.9315e-06, 4.9315e-06, 1.2224e-08, 9.9052e-05, 3.0300e-11, 2.9527e-01,
        2.9527e-01, 2.4553e-07, 1.0862e-01, 1.8617e-16, 3.0300e-11, 1.8617e-16,
        1.6543e-09, 2.4553e-07, 3.0300e-11, 3.0300e-11, 3.0300e-11, 3.0300e-11])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 89.73% 

Test Accuracy: 88.69% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5632212162017822
distance x is tensor(112.3980, device='cuda:0')
benign distance is  tensor(112.3980, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.733185887336731
distance x is tensor(102.4777, device='cuda:0')
benign distance is  tensor(102.4777, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.06040038913488388
distance x is tensor(133.0156, device='cuda:0')
benign distance is  tensor(133.0156, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7431120872497559
distance x is tensor(114.1719, device='cuda:0')
benign distance is  tensor(114.1719, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3356858491897583
distance x is tensor(103.2991, device='cuda:0')
benign distance is  tensor(103.2991, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4417567849159241
distance x is tensor(128.0120, device='cuda:0')
benign distance is  tensor(128.0120, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.0781046599149704
distance x is tensor(137.7375, device='cuda:0')
benign distance is  tensor(137.7375, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9617859125137329
distance x is tensor(132.4731, device='cuda:0')
benign distance is  tensor(132.4731, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.19944629073143005
distance x is tensor(130.6328, device='cuda:0')
benign distance is  tensor(130.6328, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.41768938302993774
distance x is tensor(133.5836, device='cuda:0')
benign distance is  tensor(133.5836, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1778547763824463
distance x is tensor(119.6823, device='cuda:0')
benign distance is  tensor(119.6823, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.1834962368011475
distance x is tensor(126.9055, device='cuda:0')
benign distance is  tensor(126.9055, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6972434520721436
distance x is tensor(136.3144, device='cuda:0')
benign distance is  tensor(136.3144, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7962354421615601
distance x is tensor(118.6569, device='cuda:0')
benign distance is  tensor(118.6569, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.39917469024658203
distance x is tensor(139.5629, device='cuda:0')
benign distance is  tensor(139.5629, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.45551347732543945
distance x is tensor(127.7273, device='cuda:0')
benign distance is  tensor(127.7273, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.4441256523132324
distance x is tensor(142.5034, device='cuda:0')
benign distance is  tensor(142.5034, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5284554362297058
distance x is tensor(128.8963, device='cuda:0')
benign distance is  tensor(128.8963, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.49749955534935
distance x is tensor(136.0208, device='cuda:0')
benign distance is  tensor(136.0208, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.093389868736267
distance x is tensor(136.0888, device='cuda:0')
benign distance is  tensor(136.0888, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8389633893966675
distance x is tensor(118.0616, device='cuda:0')
benign distance is  tensor(118.0616, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.3704034090042114
distance x is tensor(136.9163, device='cuda:0')
benign distance is  tensor(136.9163, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.32963699102401733
distance x is tensor(130.3253, device='cuda:0')
benign distance is  tensor(130.3253, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.46506446599960327
distance x is tensor(139.9111, device='cuda:0')
benign distance is  tensor(139.9111, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 17., 16.,  8.,  8.,  8.,
         8.,  9.,  8.,  8., 11., 12.])
count_res tensor([4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03,
        4.6969e-03, 4.6969e-03, 1.7279e-03, 6.9708e-01, 2.5644e-01, 8.6027e-05,
        8.6027e-05, 8.6027e-05, 8.6027e-05, 2.3384e-04, 8.6027e-05, 8.6027e-05,
        1.7279e-03, 4.6969e-03])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 88.83% 

Test Accuracy: 88.06% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.360811710357666
distance x is tensor(105.9358, device='cuda:0')
benign distance is  tensor(105.9358, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6627197861671448
distance x is tensor(97.5566, device='cuda:0')
benign distance is  tensor(97.5566, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.16718783974647522
distance x is tensor(126.7738, device='cuda:0')
benign distance is  tensor(126.7738, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.39819639921188354
distance x is tensor(109.7357, device='cuda:0')
benign distance is  tensor(109.7357, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3459208011627197
distance x is tensor(81.5739, device='cuda:0')
benign distance is  tensor(81.5739, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9391864538192749
distance x is tensor(120.0515, device='cuda:0')
benign distance is  tensor(120.0515, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3389071822166443
distance x is tensor(117.2571, device='cuda:0')
benign distance is  tensor(117.2571, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0286149978637695
distance x is tensor(130.6590, device='cuda:0')
benign distance is  tensor(130.6590, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 52
counter_tensor is  tensor([ 0., 50., 51., 50., 47., 51., 12., 43., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40.,  0., 51., 45.,  0.,  0., 49., 51.,  1.,
         0.,  0., 51., 13.,  1., 35., 17., 10., 19., 51.,  0., 50.,  0., 13.,
        12., 14.,  0., 50., 12., 12., 12., 48.,  0., 12.])
count_res tensor([9.2413e-24, 4.7914e-02, 1.3024e-01, 4.7914e-02, 2.3855e-03, 1.3024e-01,
        1.5041e-18, 4.3692e-05, 2.1753e-06, 2.1753e-06, 2.1753e-06, 2.1753e-06,
        2.1753e-06, 2.1753e-06, 2.1753e-06, 2.1753e-06, 2.1753e-06, 2.1753e-06,
        2.1753e-06, 2.1753e-06, 9.2413e-24, 1.3024e-01, 3.2284e-04, 9.2413e-24,
        9.2413e-24, 1.7626e-02, 1.3024e-01, 2.5121e-23, 9.2413e-24, 9.2413e-24,
        1.3024e-01, 4.0885e-18, 2.5121e-23, 1.4657e-08, 2.2322e-16, 2.0355e-19,
        1.6494e-15, 1.3024e-01, 9.2413e-24, 4.7914e-02, 9.2413e-24, 4.0885e-18,
        1.5041e-18, 1.1114e-17, 9.2413e-24, 4.7914e-02, 1.5041e-18, 1.5041e-18,
        1.5041e-18, 6.4844e-03, 9.2413e-24, 1.5041e-18])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 89.80% 

Test Accuracy: 88.98% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5284796953201294
distance x is tensor(102.9036, device='cuda:0')
benign distance is  tensor(102.9036, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2525080144405365
distance x is tensor(102.5490, device='cuda:0')
benign distance is  tensor(102.5490, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6520634293556213
distance x is tensor(117.8034, device='cuda:0')
benign distance is  tensor(117.8034, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.34034428000450134
distance x is tensor(118.7454, device='cuda:0')
benign distance is  tensor(118.7454, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0357064008712769
distance x is tensor(88.8400, device='cuda:0')
benign distance is  tensor(88.8400, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.2754916548728943
distance x is tensor(111.7215, device='cuda:0')
benign distance is  tensor(111.7215, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6123135685920715
distance x is tensor(122.8308, device='cuda:0')
benign distance is  tensor(122.8308, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.610823392868042
distance x is tensor(118.7782, device='cuda:0')
benign distance is  tensor(118.7782, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.38964611291885376
distance x is tensor(135.3719, device='cuda:0')
benign distance is  tensor(135.3719, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5315995216369629
distance x is tensor(127.6633, device='cuda:0')
benign distance is  tensor(127.6633, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7021526098251343
distance x is tensor(114.4551, device='cuda:0')
benign distance is  tensor(114.4551, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7845507860183716
distance x is tensor(127.0476, device='cuda:0')
benign distance is  tensor(127.0476, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8722749948501587
distance x is tensor(129.6323, device='cuda:0')
benign distance is  tensor(129.6323, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.34250766038894653
distance x is tensor(116.2958, device='cuda:0')
benign distance is  tensor(116.2958, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4604215621948242
distance x is tensor(126.4146, device='cuda:0')
benign distance is  tensor(126.4146, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.49843794107437134
distance x is tensor(128.0080, device='cuda:0')
benign distance is  tensor(128.0080, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4496263861656189
distance x is tensor(112.3769, device='cuda:0')
benign distance is  tensor(112.3769, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.314138650894165
distance x is tensor(133.1824, device='cuda:0')
benign distance is  tensor(133.1824, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.38711997866630554
distance x is tensor(121.6449, device='cuda:0')
benign distance is  tensor(121.6449, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.353231817483902
distance x is tensor(118.2012, device='cuda:0')
benign distance is  tensor(118.2012, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.41574352979660034
distance x is tensor(127.6206, device='cuda:0')
benign distance is  tensor(127.6206, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.1859807968139648
distance x is tensor(113.4451, device='cuda:0')
benign distance is  tensor(113.4451, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.39260825514793396
distance x is tensor(117.6746, device='cuda:0')
benign distance is  tensor(117.6746, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.49281883239746094
distance x is tensor(123.9881, device='cuda:0')
benign distance is  tensor(123.9881, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3579005300998688
distance x is tensor(126.0668, device='cuda:0')
benign distance is  tensor(126.0668, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.15481461584568024
distance x is tensor(130.6977, device='cuda:0')
benign distance is  tensor(130.6977, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.422518789768219
distance x is tensor(105.1625, device='cuda:0')
benign distance is  tensor(105.1625, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.3693162500858307
distance x is tensor(119.7096, device='cuda:0')
benign distance is  tensor(119.7096, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.21594662964344025
distance x is tensor(117.6996, device='cuda:0')
benign distance is  tensor(117.6996, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.44994688034057617
distance x is tensor(122.7609, device='cuda:0')
benign distance is  tensor(122.7609, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.2773316502571106
distance x is tensor(117.6487, device='cuda:0')
benign distance is  tensor(117.6487, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.3804226517677307
distance x is tensor(123.1340, device='cuda:0')
benign distance is  tensor(123.1340, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.09806586056947708
distance x is tensor(121.0577, device='cuda:0')
benign distance is  tensor(121.0577, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.31006115674972534
distance x is tensor(107.5755, device='cuda:0')
benign distance is  tensor(107.5755, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.21162912249565125
distance x is tensor(124.3494, device='cuda:0')
benign distance is  tensor(124.3494, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.8269079923629761
distance x is tensor(124.3438, device='cuda:0')
benign distance is  tensor(124.3438, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5571759343147278
distance x is tensor(135.7123, device='cuda:0')
benign distance is  tensor(135.7123, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.3737456500530243
distance x is tensor(135.7057, device='cuda:0')
benign distance is  tensor(135.7057, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.651696503162384
distance x is tensor(125.5759, device='cuda:0')
benign distance is  tensor(125.5759, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5605946779251099
distance x is tensor(132.8508, device='cuda:0')
benign distance is  tensor(132.8508, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 17., 15.,  8.,  8.,  8.,
         8.,  8.,  8.,  9., 11., 13.])
count_res tensor([5.5521e-03, 5.5521e-03, 5.5521e-03, 5.5521e-03, 5.5521e-03, 5.5521e-03,
        5.5521e-03, 5.5521e-03, 2.0425e-03, 8.2400e-01, 1.1152e-01, 1.0169e-04,
        1.0169e-04, 1.0169e-04, 1.0169e-04, 1.0169e-04, 1.0169e-04, 2.7642e-04,
        2.0425e-03, 1.5092e-02])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 89.12% 

Test Accuracy: 88.36% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6904817819595337
distance x is tensor(100.2995, device='cuda:0')
benign distance is  tensor(100.2995, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7274786829948425
distance x is tensor(100.3640, device='cuda:0')
benign distance is  tensor(100.3640, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5059642195701599
distance x is tensor(107.5029, device='cuda:0')
benign distance is  tensor(107.5029, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6589347720146179
distance x is tensor(101.9185, device='cuda:0')
benign distance is  tensor(101.9185, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6466400623321533
distance x is tensor(83.1072, device='cuda:0')
benign distance is  tensor(83.1072, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5709552764892578
distance x is tensor(93.6694, device='cuda:0')
benign distance is  tensor(93.6694, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1460970789194107
distance x is tensor(110.5047, device='cuda:0')
benign distance is  tensor(110.5047, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.40118616819381714
distance x is tensor(107.4603, device='cuda:0')
benign distance is  tensor(107.4603, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([15.,  0., 12., 13., 34., 35., 34., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 13., 12., 35., 13., 12.,  0., 34., 35.,
        12., 12., 35., 12.,  6., 16.,  0.,  0.])
count_res tensor([4.0384e-10, 1.2354e-16, 2.0106e-11, 5.4654e-11, 7.2079e-02, 1.9593e-01,
        7.2079e-02, 2.0106e-11, 3.2724e-06, 3.2724e-06, 3.2724e-06, 3.2724e-06,
        3.2724e-06, 3.2724e-06, 3.2724e-06, 3.2724e-06, 3.2724e-06, 3.2724e-06,
        3.2724e-06, 3.2724e-06, 5.4654e-11, 2.0106e-11, 1.9593e-01, 5.4654e-11,
        2.0106e-11, 1.2354e-16, 7.2079e-02, 1.9593e-01, 2.0106e-11, 2.0106e-11,
        1.9593e-01, 2.0106e-11, 4.9838e-14, 1.0978e-09, 1.2354e-16, 1.2354e-16])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 89.59% 

Test Accuracy: 89.03% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1774685382843018
distance x is tensor(103.3006, device='cuda:0')
benign distance is  tensor(103.3006, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5988364815711975
distance x is tensor(104.4220, device='cuda:0')
benign distance is  tensor(104.4220, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.18077735602855682
distance x is tensor(118.1427, device='cuda:0')
benign distance is  tensor(118.1427, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.39447566866874695
distance x is tensor(123.8396, device='cuda:0')
benign distance is  tensor(123.8396, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7424512505531311
distance x is tensor(66.6037, device='cuda:0')
benign distance is  tensor(66.6037, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7983406186103821
distance x is tensor(112.2332, device='cuda:0')
benign distance is  tensor(112.2332, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5750541090965271
distance x is tensor(121.0197, device='cuda:0')
benign distance is  tensor(121.0197, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.43607014417648315
distance x is tensor(116.0207, device='cuda:0')
benign distance is  tensor(116.0207, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.36815714836120605
distance x is tensor(142.1467, device='cuda:0')
benign distance is  tensor(142.1467, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4417983889579773
distance x is tensor(124.6748, device='cuda:0')
benign distance is  tensor(124.6748, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.569888710975647
distance x is tensor(108.4871, device='cuda:0')
benign distance is  tensor(108.4871, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3287966847419739
distance x is tensor(126.5821, device='cuda:0')
benign distance is  tensor(126.5821, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8050487637519836
distance x is tensor(126.3358, device='cuda:0')
benign distance is  tensor(126.3358, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.26609140634536743
distance x is tensor(122.1832, device='cuda:0')
benign distance is  tensor(122.1832, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.45982056856155396
distance x is tensor(128.2371, device='cuda:0')
benign distance is  tensor(128.2371, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.39794787764549255
distance x is tensor(137.9476, device='cuda:0')
benign distance is  tensor(137.9476, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.4439678192138672
distance x is tensor(137.4995, device='cuda:0')
benign distance is  tensor(137.4995, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5059493780136108
distance x is tensor(123.8795, device='cuda:0')
benign distance is  tensor(123.8795, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.42899975180625916
distance x is tensor(122.5712, device='cuda:0')
benign distance is  tensor(122.5712, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.1193978786468506
distance x is tensor(133.8051, device='cuda:0')
benign distance is  tensor(133.8051, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.4348151683807373
distance x is tensor(121.6966, device='cuda:0')
benign distance is  tensor(121.6966, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5503681898117065
distance x is tensor(132.6075, device='cuda:0')
benign distance is  tensor(132.6075, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4528709053993225
distance x is tensor(126.0153, device='cuda:0')
benign distance is  tensor(126.0153, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.1385558843612671
distance x is tensor(110.9308, device='cuda:0')
benign distance is  tensor(110.9308, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([13., 13., 13., 13., 13., 13., 13., 27., 15., 15., 15., 15., 15., 15.,
        15., 15., 15., 15., 15., 15., 13.,  0., 25., 18., 27., 13., 13., 13.])
count_res tensor([3.8938e-07, 3.8938e-07, 3.8938e-07, 3.8938e-07, 3.8938e-07, 3.8938e-07,
        3.8938e-07, 4.6827e-01, 2.8771e-06, 2.8771e-06, 2.8771e-06, 2.8771e-06,
        2.8771e-06, 2.8771e-06, 2.8771e-06, 2.8771e-06, 2.8771e-06, 2.8771e-06,
        2.8771e-06, 2.8771e-06, 3.8938e-07, 8.8012e-13, 6.3373e-02, 5.7789e-05,
        4.6827e-01, 3.8938e-07, 3.8938e-07, 3.8938e-07])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 89.66% 

Test Accuracy: 88.58% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.29904457926750183
distance x is tensor(120.8538, device='cuda:0')
benign distance is  tensor(120.8538, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.610662579536438
distance x is tensor(126.9530, device='cuda:0')
benign distance is  tensor(126.9530, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.04753033071756363
distance x is tensor(136.5101, device='cuda:0')
benign distance is  tensor(136.5101, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.822252094745636
distance x is tensor(119.2271, device='cuda:0')
benign distance is  tensor(119.2271, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4761194586753845
distance x is tensor(118.2127, device='cuda:0')
benign distance is  tensor(118.2127, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8725479245185852
distance x is tensor(104.4496, device='cuda:0')
benign distance is  tensor(104.4496, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1826537549495697
distance x is tensor(114.6801, device='cuda:0')
benign distance is  tensor(114.6801, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.40876561403274536
distance x is tensor(97.9880, device='cuda:0')
benign distance is  tensor(97.9880, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.6040652990341187
distance x is tensor(136.1292, device='cuda:0')
benign distance is  tensor(136.1292, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.44703245162963867
distance x is tensor(149.8413, device='cuda:0')
benign distance is  tensor(149.8413, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.16293497383594513
distance x is tensor(145.1744, device='cuda:0')
benign distance is  tensor(145.1744, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.24293068051338196
distance x is tensor(121.0958, device='cuda:0')
benign distance is  tensor(121.0958, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.8915144205093384
distance x is tensor(111.4461, device='cuda:0')
benign distance is  tensor(111.4461, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7795683741569519
distance x is tensor(125.7672, device='cuda:0')
benign distance is  tensor(125.7672, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.14483106136322021
distance x is tensor(135.2667, device='cuda:0')
benign distance is  tensor(135.2667, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6099788546562195
distance x is tensor(132.8612, device='cuda:0')
benign distance is  tensor(132.8612, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([13., 13., 13.,  0., 13., 15., 13., 24., 15., 15., 15., 15., 15., 15.,
        15., 15., 15., 15., 15., 15., 13., 20., 24., 26., 13., 14., 13., 13.])
count_res tensor([1.7750e-06, 1.7750e-06, 1.7750e-06, 4.0122e-12, 1.7750e-06, 1.3116e-05,
        1.7750e-06, 1.0628e-01, 1.3116e-05, 1.3116e-05, 1.3116e-05, 1.3116e-05,
        1.3116e-05, 1.3116e-05, 1.3116e-05, 1.3116e-05, 1.3116e-05, 1.3116e-05,
        1.3116e-05, 1.3116e-05, 1.7750e-06, 1.9466e-03, 1.0628e-01, 7.8530e-01,
        1.7750e-06, 4.8251e-06, 1.7750e-06, 1.7750e-06])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 88.25% 

Test Accuracy: 87.84% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4919244647026062
distance x is tensor(136.1186, device='cuda:0')
benign distance is  tensor(136.1186, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8308728933334351
distance x is tensor(117.5625, device='cuda:0')
benign distance is  tensor(117.5625, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.041835300624370575
distance x is tensor(139.9111, device='cuda:0')
benign distance is  tensor(139.9111, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.556740403175354
distance x is tensor(120.2428, device='cuda:0')
benign distance is  tensor(120.2428, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7857702970504761
distance x is tensor(111.8084, device='cuda:0')
benign distance is  tensor(111.8084, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1583802700042725
distance x is tensor(138.2999, device='cuda:0')
benign distance is  tensor(138.2999, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.28644704818725586
distance x is tensor(133.2502, device='cuda:0')
benign distance is  tensor(133.2502, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5329856872558594
distance x is tensor(131.7886, device='cuda:0')
benign distance is  tensor(131.7886, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4762645363807678
distance x is tensor(141.7086, device='cuda:0')
benign distance is  tensor(141.7086, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5033610463142395
distance x is tensor(140.3690, device='cuda:0')
benign distance is  tensor(140.3690, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.054610252380371
distance x is tensor(116.0651, device='cuda:0')
benign distance is  tensor(116.0651, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5396933555603027
distance x is tensor(87.7198, device='cuda:0')
benign distance is  tensor(87.7198, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6252806186676025
distance x is tensor(135.3802, device='cuda:0')
benign distance is  tensor(135.3802, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1994260847568512
distance x is tensor(130.1074, device='cuda:0')
benign distance is  tensor(130.1074, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.43808937072753906
distance x is tensor(138.7775, device='cuda:0')
benign distance is  tensor(138.7775, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6094146370887756
distance x is tensor(132.7826, device='cuda:0')
benign distance is  tensor(132.7826, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 12., 12., 12., 17., 12., 12., 11., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 25., 12., 23., 26., 16., 12.,  2., 12.])
count_res tensor([5.8625e-07, 5.8625e-07, 5.8625e-07, 5.8625e-07, 8.7007e-05, 5.8625e-07,
        5.8625e-07, 2.1567e-07, 3.2008e-05, 3.2008e-05, 3.2008e-05, 3.2008e-05,
        3.2008e-05, 3.2008e-05, 3.2008e-05, 3.2008e-05, 3.2008e-05, 3.2008e-05,
        3.2008e-05, 3.2008e-05, 2.5936e-01, 5.8625e-07, 3.5101e-02, 7.0503e-01,
        3.2008e-05, 5.8625e-07, 2.6616e-11, 5.8625e-07])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 89.01% 

Test Accuracy: 88.12% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4247261881828308
distance x is tensor(118.9182, device='cuda:0')
benign distance is  tensor(118.9182, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2505360543727875
distance x is tensor(116.4238, device='cuda:0')
benign distance is  tensor(116.4238, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2947557866573334
distance x is tensor(125.2054, device='cuda:0')
benign distance is  tensor(125.2054, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3113430440425873
distance x is tensor(116.9782, device='cuda:0')
benign distance is  tensor(116.9782, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3183542788028717
distance x is tensor(97.1635, device='cuda:0')
benign distance is  tensor(97.1635, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.22072558104991913
distance x is tensor(131.5222, device='cuda:0')
benign distance is  tensor(131.5222, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.19485318660736084
distance x is tensor(128.8007, device='cuda:0')
benign distance is  tensor(128.8007, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.06543568521738052
distance x is tensor(127.2955, device='cuda:0')
benign distance is  tensor(127.2955, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.565956711769104
distance x is tensor(130.8457, device='cuda:0')
benign distance is  tensor(130.8457, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.16659632325172424
distance x is tensor(134.2365, device='cuda:0')
benign distance is  tensor(134.2365, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.22232213616371155
distance x is tensor(122.0311, device='cuda:0')
benign distance is  tensor(122.0311, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.2978592813014984
distance x is tensor(86.0275, device='cuda:0')
benign distance is  tensor(86.0275, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.10210716724395752
distance x is tensor(124.7909, device='cuda:0')
benign distance is  tensor(124.7909, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.29960495233535767
distance x is tensor(125.9329, device='cuda:0')
benign distance is  tensor(125.9329, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.48353320360183716
distance x is tensor(120.7836, device='cuda:0')
benign distance is  tensor(120.7836, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.54600590467453
distance x is tensor(135.1231, device='cuda:0')
benign distance is  tensor(135.1231, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 52
counter_tensor is  tensor([14., 51.,  0., 12., 20.,  0.,  1.,  9., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40.,  0., 51.,  0., 47., 34.,  1., 50., 51.,
        48., 50., 28., 51.,  0.,  2.,  0., 21., 35., 37., 50., 45., 14., 12.,
        13., 13.,  2., 33., 13., 48., 17., 43.,  0., 12.])
count_res tensor([1.6333e-17, 1.9140e-01, 1.3581e-23, 2.2104e-18, 6.5890e-15, 1.3581e-23,
        3.6917e-23, 1.1005e-19, 3.1968e-06, 3.1968e-06, 3.1968e-06, 3.1968e-06,
        3.1968e-06, 3.1968e-06, 3.1968e-06, 3.1968e-06, 3.1968e-06, 3.1968e-06,
        3.1968e-06, 3.1968e-06, 1.3581e-23, 1.9140e-01, 1.3581e-23, 3.5057e-03,
        7.9240e-09, 3.6917e-23, 7.0414e-02, 1.9140e-01, 9.5295e-03, 7.0414e-02,
        1.9642e-11, 1.9140e-01, 1.3581e-23, 1.0035e-22, 1.3581e-23, 1.7911e-14,
        2.1540e-08, 1.5916e-07, 7.0414e-02, 4.7444e-04, 1.6333e-17, 2.2104e-18,
        6.0084e-18, 6.0084e-18, 1.0035e-22, 2.9151e-09, 6.0084e-18, 9.5295e-03,
        3.2805e-16, 6.4209e-05, 1.3581e-23, 2.2104e-18])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 90.00% 

Test Accuracy: 89.07% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.24965481460094452
distance x is tensor(116.8951, device='cuda:0')
benign distance is  tensor(116.8951, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7969683408737183
distance x is tensor(93.0293, device='cuda:0')
benign distance is  tensor(93.0293, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.02478046528995037
distance x is tensor(121.9171, device='cuda:0')
benign distance is  tensor(121.9171, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8287824392318726
distance x is tensor(109.0139, device='cuda:0')
benign distance is  tensor(109.0139, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.37938711047172546
distance x is tensor(87.4255, device='cuda:0')
benign distance is  tensor(87.4255, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6467064619064331
distance x is tensor(111.6573, device='cuda:0')
benign distance is  tensor(111.6573, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4100058078765869
distance x is tensor(120.9870, device='cuda:0')
benign distance is  tensor(120.9870, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2957789897918701
distance x is tensor(126.5231, device='cuda:0')
benign distance is  tensor(126.5231, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.813156247138977
distance x is tensor(131.1967, device='cuda:0')
benign distance is  tensor(131.1967, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5224850177764893
distance x is tensor(124.5732, device='cuda:0')
benign distance is  tensor(124.5732, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7713847160339355
distance x is tensor(112.6735, device='cuda:0')
benign distance is  tensor(112.6735, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7681587934494019
distance x is tensor(125.1679, device='cuda:0')
benign distance is  tensor(125.1679, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4852500855922699
distance x is tensor(127.4272, device='cuda:0')
benign distance is  tensor(127.4272, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.15862932801246643
distance x is tensor(125.5191, device='cuda:0')
benign distance is  tensor(125.5191, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.36466723680496216
distance x is tensor(130.9458, device='cuda:0')
benign distance is  tensor(130.9458, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5751630663871765
distance x is tensor(122.4999, device='cuda:0')
benign distance is  tensor(122.4999, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3542836308479309
distance x is tensor(120.5381, device='cuda:0')
benign distance is  tensor(120.5381, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4044821858406067
distance x is tensor(137.9823, device='cuda:0')
benign distance is  tensor(137.9823, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.01285164337605238
distance x is tensor(121.9952, device='cuda:0')
benign distance is  tensor(121.9952, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.0754995197057724
distance x is tensor(111.6593, device='cuda:0')
benign distance is  tensor(111.6593, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.17943961918354034
distance x is tensor(124.5653, device='cuda:0')
benign distance is  tensor(124.5653, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.34900787472724915
distance x is tensor(119.4386, device='cuda:0')
benign distance is  tensor(119.4386, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.14296522736549377
distance x is tensor(128.9909, device='cuda:0')
benign distance is  tensor(128.9909, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.27306312322616577
distance x is tensor(122.0342, device='cuda:0')
benign distance is  tensor(122.0342, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.40458840131759644
distance x is tensor(141.8756, device='cuda:0')
benign distance is  tensor(141.8756, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5715785026550293
distance x is tensor(121.1402, device='cuda:0')
benign distance is  tensor(121.1402, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5076800584793091
distance x is tensor(124.1530, device='cuda:0')
benign distance is  tensor(124.1530, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4606310725212097
distance x is tensor(115.9858, device='cuda:0')
benign distance is  tensor(115.9858, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.3967092037200928
distance x is tensor(128.6816, device='cuda:0')
benign distance is  tensor(128.6816, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6372203826904297
distance x is tensor(131.0968, device='cuda:0')
benign distance is  tensor(131.0968, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.42746859788894653
distance x is tensor(128.2059, device='cuda:0')
benign distance is  tensor(128.2059, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.32585978507995605
distance x is tensor(121.9865, device='cuda:0')
benign distance is  tensor(121.9865, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.11972205340862274
distance x is tensor(129.6573, device='cuda:0')
benign distance is  tensor(129.6573, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.5153650045394897
distance x is tensor(102.9717, device='cuda:0')
benign distance is  tensor(102.9717, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.43449950218200684
distance x is tensor(124.5335, device='cuda:0')
benign distance is  tensor(124.5335, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.41376185417175293
distance x is tensor(116.6037, device='cuda:0')
benign distance is  tensor(116.6037, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.4627482295036316
distance x is tensor(135.3143, device='cuda:0')
benign distance is  tensor(135.3143, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.24744673073291779
distance x is tensor(137.4715, device='cuda:0')
benign distance is  tensor(137.4715, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.5771797895431519
distance x is tensor(129.1378, device='cuda:0')
benign distance is  tensor(129.1378, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6527436971664429
distance x is tensor(123.4675, device='cuda:0')
benign distance is  tensor(123.4675, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 19.,  9., 16.,  8.,  8.,  8.,
         8.,  9.,  8.,  8., 11., 12.])
count_res tensor([8.6147e-04, 8.6147e-04, 8.6147e-04, 8.6147e-04, 8.6147e-04, 8.6147e-04,
        8.6147e-04, 8.6147e-04, 9.4471e-01, 4.2890e-05, 4.7035e-02, 1.5778e-05,
        1.5778e-05, 1.5778e-05, 1.5778e-05, 4.2890e-05, 1.5778e-05, 1.5778e-05,
        3.1692e-04, 8.6147e-04])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 89.23% 

Test Accuracy: 88.40% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7535966634750366
distance x is tensor(94.7947, device='cuda:0')
benign distance is  tensor(94.7947, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7661603689193726
distance x is tensor(96.2422, device='cuda:0')
benign distance is  tensor(96.2422, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.08137060701847076
distance x is tensor(120.0302, device='cuda:0')
benign distance is  tensor(120.0302, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6163804531097412
distance x is tensor(113.6732, device='cuda:0')
benign distance is  tensor(113.6732, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4078501760959625
distance x is tensor(86.9105, device='cuda:0')
benign distance is  tensor(86.9105, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4818541407585144
distance x is tensor(108.3700, device='cuda:0')
benign distance is  tensor(108.3700, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5574190020561218
distance x is tensor(113.4750, device='cuda:0')
benign distance is  tensor(113.4750, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5452627539634705
distance x is tensor(109.8142, device='cuda:0')
benign distance is  tensor(109.8142, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([13., 12., 12., 12., 27.,  0., 27., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 14., 12., 12., 27., 12., 12.])
count_res tensor([2.7716e-07, 1.0196e-07, 1.0196e-07, 1.0196e-07, 3.3331e-01, 6.2647e-13,
        3.3331e-01, 1.0196e-07, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06,
        5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06,
        5.5668e-06, 5.5668e-06, 1.0196e-07, 1.0196e-07, 7.5339e-07, 1.0196e-07,
        1.0196e-07, 3.3331e-01, 1.0196e-07, 1.0196e-07])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 89.67% 

Test Accuracy: 88.74% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.47737425565719604
distance x is tensor(126.8951, device='cuda:0')
benign distance is  tensor(126.8951, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9736040830612183
distance x is tensor(109.4980, device='cuda:0')
benign distance is  tensor(109.4980, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.20858773589134216
distance x is tensor(126.9068, device='cuda:0')
benign distance is  tensor(126.9068, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7295224666595459
distance x is tensor(123.5453, device='cuda:0')
benign distance is  tensor(123.5453, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5485810041427612
distance x is tensor(69.0410, device='cuda:0')
benign distance is  tensor(69.0410, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.28895241022109985
distance x is tensor(126.1419, device='cuda:0')
benign distance is  tensor(126.1419, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.15621474385261536
distance x is tensor(103.8199, device='cuda:0')
benign distance is  tensor(103.8199, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2824992537498474
distance x is tensor(124.0021, device='cuda:0')
benign distance is  tensor(124.0021, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.16098439693450928
distance x is tensor(145.2337, device='cuda:0')
benign distance is  tensor(145.2337, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4364771246910095
distance x is tensor(134.1261, device='cuda:0')
benign distance is  tensor(134.1261, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7315166592597961
distance x is tensor(121.4224, device='cuda:0')
benign distance is  tensor(121.4224, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.17984925210475922
distance x is tensor(142.8267, device='cuda:0')
benign distance is  tensor(142.8267, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6999772787094116
distance x is tensor(133.6224, device='cuda:0')
benign distance is  tensor(133.6224, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.15337109565734863
distance x is tensor(101.3089, device='cuda:0')
benign distance is  tensor(101.3089, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5620394349098206
distance x is tensor(131.6990, device='cuda:0')
benign distance is  tensor(131.6990, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.21669897437095642
distance x is tensor(127.9489, device='cuda:0')
benign distance is  tensor(127.9489, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 12.,  0., 16., 12., 12., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 12., 12., 12., 27., 26., 12., 12.])
count_res tensor([1.2918e-07, 1.2918e-07, 7.9369e-13, 7.0528e-06, 1.2918e-07, 1.2918e-07,
        1.2918e-07, 1.2918e-07, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06,
        7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06,
        7.0528e-06, 7.0528e-06, 4.2228e-01, 1.2918e-07, 1.2918e-07, 1.2918e-07,
        4.2228e-01, 1.5535e-01, 1.2918e-07, 1.2918e-07])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 89.50% 

Test Accuracy: 88.29% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5513697266578674
distance x is tensor(118.0576, device='cuda:0')
benign distance is  tensor(118.0576, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.77986079454422
distance x is tensor(110.0755, device='cuda:0')
benign distance is  tensor(110.0755, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.27400609850883484
distance x is tensor(130.0384, device='cuda:0')
benign distance is  tensor(130.0384, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9639707803726196
distance x is tensor(117.6592, device='cuda:0')
benign distance is  tensor(117.6592, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5183003544807434
distance x is tensor(87.7347, device='cuda:0')
benign distance is  tensor(87.7347, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8851249814033508
distance x is tensor(111.5113, device='cuda:0')
benign distance is  tensor(111.5113, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4522961676120758
distance x is tensor(123.9268, device='cuda:0')
benign distance is  tensor(123.9268, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.19615879654884338
distance x is tensor(125.6357, device='cuda:0')
benign distance is  tensor(125.6357, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3197406232357025
distance x is tensor(107.9706, device='cuda:0')
benign distance is  tensor(107.9706, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4979822635650635
distance x is tensor(137.9284, device='cuda:0')
benign distance is  tensor(137.9284, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.7818061113357544
distance x is tensor(125.9095, device='cuda:0')
benign distance is  tensor(125.9095, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.029648829251527786
distance x is tensor(117.3379, device='cuda:0')
benign distance is  tensor(117.3379, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.15698187053203583
distance x is tensor(114.7066, device='cuda:0')
benign distance is  tensor(114.7066, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6161602735519409
distance x is tensor(107.1171, device='cuda:0')
benign distance is  tensor(107.1171, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.05293159559369087
distance x is tensor(133.7238, device='cuda:0')
benign distance is  tensor(133.7238, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.22501525282859802
distance x is tensor(127.5983, device='cuda:0')
benign distance is  tensor(127.5983, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 44
counter_tensor is  tensor([12., 43., 31., 12., 43., 38., 12.,  0., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32.,  0., 12., 43., 25., 38., 25.,  0., 12.,
        43., 29., 15., 12.,  0., 31., 18.,  3., 12., 12., 12., 12., 12., 43.,
        12., 16.])
count_res tensor([6.8662e-15, 1.9945e-01, 1.2255e-06, 6.8662e-15, 1.9945e-01, 1.3439e-03,
        6.8662e-15, 4.2187e-20, 3.3312e-06, 3.3312e-06, 3.3312e-06, 3.3312e-06,
        3.3312e-06, 3.3312e-06, 3.3312e-06, 3.3312e-06, 3.3312e-06, 3.3312e-06,
        3.3312e-06, 3.3312e-06, 4.2187e-20, 6.8662e-15, 1.9945e-01, 3.0377e-09,
        1.3439e-03, 3.0377e-09, 4.2187e-20, 6.8662e-15, 1.9945e-01, 1.6585e-07,
        1.3791e-13, 6.8662e-15, 4.2187e-20, 1.2255e-06, 2.7700e-12, 8.4735e-19,
        6.8662e-15, 6.8662e-15, 6.8662e-15, 6.8662e-15, 6.8662e-15, 1.9945e-01,
        6.8662e-15, 3.7488e-13])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 89.89% 

Test Accuracy: 89.37% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.21411263942718506
distance x is tensor(110.0806, device='cuda:0')
benign distance is  tensor(110.0806, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.40839773416519165
distance x is tensor(97.1397, device='cuda:0')
benign distance is  tensor(97.1397, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.055078763514757156
distance x is tensor(125.7797, device='cuda:0')
benign distance is  tensor(125.7797, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2277560979127884
distance x is tensor(118.2055, device='cuda:0')
benign distance is  tensor(118.2055, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.627428412437439
distance x is tensor(74.0649, device='cuda:0')
benign distance is  tensor(74.0649, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5752832889556885
distance x is tensor(126.3425, device='cuda:0')
benign distance is  tensor(126.3425, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.36465343832969666
distance x is tensor(126.5358, device='cuda:0')
benign distance is  tensor(126.5358, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.667015790939331
distance x is tensor(134.5162, device='cuda:0')
benign distance is  tensor(134.5162, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.04478804022073746
distance x is tensor(141.7715, device='cuda:0')
benign distance is  tensor(141.7715, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4778521955013275
distance x is tensor(130.7767, device='cuda:0')
benign distance is  tensor(130.7767, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.11616595834493637
distance x is tensor(128.1154, device='cuda:0')
benign distance is  tensor(128.1154, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7492668032646179
distance x is tensor(129.8452, device='cuda:0')
benign distance is  tensor(129.8452, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.405416876077652
distance x is tensor(126.9407, device='cuda:0')
benign distance is  tensor(126.9407, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.0477621890604496
distance x is tensor(119.9800, device='cuda:0')
benign distance is  tensor(119.9800, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.11054470390081406
distance x is tensor(139.4813, device='cuda:0')
benign distance is  tensor(139.4813, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4314740300178528
distance x is tensor(141.0272, device='cuda:0')
benign distance is  tensor(141.0272, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.414937824010849
distance x is tensor(125.2605, device='cuda:0')
benign distance is  tensor(125.2605, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.8670350909233093
distance x is tensor(130.1451, device='cuda:0')
benign distance is  tensor(130.1451, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.336823970079422
distance x is tensor(133.0412, device='cuda:0')
benign distance is  tensor(133.0412, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.2663726806640625
distance x is tensor(138.7701, device='cuda:0')
benign distance is  tensor(138.7701, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.2284550666809082
distance x is tensor(138.4806, device='cuda:0')
benign distance is  tensor(138.4806, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.3407915532588959
distance x is tensor(132.0120, device='cuda:0')
benign distance is  tensor(132.0120, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.09859009087085724
distance x is tensor(138.5233, device='cuda:0')
benign distance is  tensor(138.5233, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.05107102543115616
distance x is tensor(128.8711, device='cuda:0')
benign distance is  tensor(128.8711, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.2787083685398102
distance x is tensor(133.8979, device='cuda:0')
benign distance is  tensor(133.8979, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.03958578407764435
distance x is tensor(133.8164, device='cuda:0')
benign distance is  tensor(133.8164, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.3193552494049072
distance x is tensor(105.6115, device='cuda:0')
benign distance is  tensor(105.6115, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.3544611930847168
distance x is tensor(133.3266, device='cuda:0')
benign distance is  tensor(133.3266, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.16592375934123993
distance x is tensor(139.4415, device='cuda:0')
benign distance is  tensor(139.4415, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.31666332483291626
distance x is tensor(123.3197, device='cuda:0')
benign distance is  tensor(123.3197, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.2094147950410843
distance x is tensor(128.6268, device='cuda:0')
benign distance is  tensor(128.6268, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.31024760007858276
distance x is tensor(134.9409, device='cuda:0')
benign distance is  tensor(134.9409, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 17., 16.,  8.,  8.,  8.,
         8.,  8.,  8.,  9., 11., 12.])
count_res tensor([4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03,
        4.6969e-03, 4.6969e-03, 1.7279e-03, 6.9708e-01, 2.5644e-01, 8.6027e-05,
        8.6027e-05, 8.6027e-05, 8.6027e-05, 8.6027e-05, 8.6027e-05, 2.3384e-04,
        1.7279e-03, 4.6969e-03])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 89.02% 

Test Accuracy: 88.58% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.40807294845581055
distance x is tensor(121.7260, device='cuda:0')
benign distance is  tensor(121.7260, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.26596421003341675
distance x is tensor(101.2411, device='cuda:0')
benign distance is  tensor(101.2411, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.20400932431221008
distance x is tensor(124.3710, device='cuda:0')
benign distance is  tensor(124.3710, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7655709981918335
distance x is tensor(119.6708, device='cuda:0')
benign distance is  tensor(119.6708, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.668925404548645
distance x is tensor(87.2914, device='cuda:0')
benign distance is  tensor(87.2914, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.19370749592781067
distance x is tensor(117.7758, device='cuda:0')
benign distance is  tensor(117.7758, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4058660864830017
distance x is tensor(111.5575, device='cuda:0')
benign distance is  tensor(111.5575, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1024438887834549
distance x is tensor(113.2533, device='cuda:0')
benign distance is  tensor(113.2533, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 44
counter_tensor is  tensor([ 1., 29., 12., 41., 12., 13., 40., 40., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 13., 14., 12., 30., 12., 42., 13., 15.,
        13.,  3., 41.,  0.,  0., 43., 42., 13., 12.,  0., 43., 12., 43.,  0.,
        12., 12.])
count_res tensor([1.4002e-19, 2.0251e-07, 8.3836e-15, 3.2959e-02, 8.3836e-15, 2.2789e-14,
        1.2125e-02, 1.2125e-02, 4.0674e-06, 4.0674e-06, 4.0674e-06, 4.0674e-06,
        4.0674e-06, 4.0674e-06, 4.0674e-06, 4.0674e-06, 4.0674e-06, 4.0674e-06,
        4.0674e-06, 4.0674e-06, 2.2789e-14, 6.1947e-14, 8.3836e-15, 5.5047e-07,
        8.3836e-15, 8.9591e-02, 2.2789e-14, 1.6839e-13, 2.2789e-14, 1.0346e-18,
        3.2959e-02, 5.1511e-20, 5.1511e-20, 2.4353e-01, 8.9591e-02, 2.2789e-14,
        8.3836e-15, 5.1511e-20, 2.4353e-01, 8.3836e-15, 2.4353e-01, 5.1511e-20,
        8.3836e-15, 8.3836e-15])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 89.81% 

Test Accuracy: 88.95% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.37891045212745667
distance x is tensor(104.6060, device='cuda:0')
benign distance is  tensor(104.6060, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.677597165107727
distance x is tensor(119.7370, device='cuda:0')
benign distance is  tensor(119.7370, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1109384298324585
distance x is tensor(124.7841, device='cuda:0')
benign distance is  tensor(124.7841, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.1766960620880127
distance x is tensor(121.8685, device='cuda:0')
benign distance is  tensor(121.8685, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5777853727340698
distance x is tensor(92.2506, device='cuda:0')
benign distance is  tensor(92.2506, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6691929697990417
distance x is tensor(123.0157, device='cuda:0')
benign distance is  tensor(123.0157, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1993001401424408
distance x is tensor(129.0466, device='cuda:0')
benign distance is  tensor(129.0466, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.38133561611175537
distance x is tensor(119.4443, device='cuda:0')
benign distance is  tensor(119.4443, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.1474049836397171
distance x is tensor(140.8657, device='cuda:0')
benign distance is  tensor(140.8657, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7005105018615723
distance x is tensor(139.5264, device='cuda:0')
benign distance is  tensor(139.5264, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4663424491882324
distance x is tensor(98.5178, device='cuda:0')
benign distance is  tensor(98.5178, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8390905261039734
distance x is tensor(128.5658, device='cuda:0')
benign distance is  tensor(128.5658, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.24950189888477325
distance x is tensor(106.6144, device='cuda:0')
benign distance is  tensor(106.6144, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.36684539914131165
distance x is tensor(117.1072, device='cuda:0')
benign distance is  tensor(117.1072, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3114882707595825
distance x is tensor(136.9497, device='cuda:0')
benign distance is  tensor(136.9497, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.736606240272522
distance x is tensor(124.5716, device='cuda:0')
benign distance is  tensor(124.5716, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.1429366022348404
distance x is tensor(119.3814, device='cuda:0')
benign distance is  tensor(119.3814, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.0437928438186646
distance x is tensor(138.3505, device='cuda:0')
benign distance is  tensor(138.3505, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.1783064901828766
distance x is tensor(134.1236, device='cuda:0')
benign distance is  tensor(134.1236, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.34438395500183105
distance x is tensor(115.9343, device='cuda:0')
benign distance is  tensor(115.9343, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.23044762015342712
distance x is tensor(118.6757, device='cuda:0')
benign distance is  tensor(118.6757, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6767770648002625
distance x is tensor(108.5463, device='cuda:0')
benign distance is  tensor(108.5463, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.37387657165527344
distance x is tensor(133.9589, device='cuda:0')
benign distance is  tensor(133.9589, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3407619595527649
distance x is tensor(124.1320, device='cuda:0')
benign distance is  tensor(124.1320, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.27554136514663696
distance x is tensor(125.2458, device='cuda:0')
benign distance is  tensor(125.2458, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.1937679648399353
distance x is tensor(116.4033, device='cuda:0')
benign distance is  tensor(116.4033, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.0850006490945816
distance x is tensor(132.4168, device='cuda:0')
benign distance is  tensor(132.4168, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.3922922611236572
distance x is tensor(135.4388, device='cuda:0')
benign distance is  tensor(135.4388, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.33662158250808716
distance x is tensor(136.8020, device='cuda:0')
benign distance is  tensor(136.8020, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7339813113212585
distance x is tensor(127.5705, device='cuda:0')
benign distance is  tensor(127.5705, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.084031343460083
distance x is tensor(127.3461, device='cuda:0')
benign distance is  tensor(127.3461, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.2619175910949707
distance x is tensor(129.5060, device='cuda:0')
benign distance is  tensor(129.5060, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 17., 16.,  8.,  8.,  8.,
         9.,  8.,  8., 11.,  8., 12.])
count_res tensor([4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03,
        4.6969e-03, 4.6969e-03, 1.7279e-03, 6.9708e-01, 2.5644e-01, 8.6027e-05,
        8.6027e-05, 8.6027e-05, 2.3384e-04, 8.6027e-05, 8.6027e-05, 1.7279e-03,
        8.6027e-05, 4.6969e-03])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 89.09% 

Test Accuracy: 88.10% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.24968025088310242
distance x is tensor(110.5726, device='cuda:0')
benign distance is  tensor(110.5726, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.45565885305404663
distance x is tensor(100.4692, device='cuda:0')
benign distance is  tensor(100.4692, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.27064090967178345
distance x is tensor(120.2651, device='cuda:0')
benign distance is  tensor(120.2651, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2959982752799988
distance x is tensor(110.5925, device='cuda:0')
benign distance is  tensor(110.5925, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6887305378913879
distance x is tensor(88.8320, device='cuda:0')
benign distance is  tensor(88.8320, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3275817930698395
distance x is tensor(109.9602, device='cuda:0')
benign distance is  tensor(109.9602, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5129387378692627
distance x is tensor(106.1530, device='cuda:0')
benign distance is  tensor(106.1530, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5879310965538025
distance x is tensor(116.9155, device='cuda:0')
benign distance is  tensor(116.9155, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([12., 12., 12., 35., 34., 21., 35., 35., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 12., 13., 13., 12.,  3.,  0.,  0., 10.,
        12., 34., 35., 12., 18., 13.,  0., 13.])
count_res tensor([2.1668e-11, 2.1668e-11, 2.1668e-11, 2.1115e-01, 7.7678e-02, 1.7558e-07,
        2.1115e-01, 2.1115e-01, 3.5266e-06, 3.5266e-06, 3.5266e-06, 3.5266e-06,
        3.5266e-06, 3.5266e-06, 3.5266e-06, 3.5266e-06, 3.5266e-06, 3.5266e-06,
        3.5266e-06, 3.5266e-06, 2.1668e-11, 5.8900e-11, 5.8900e-11, 2.1668e-11,
        2.6740e-15, 1.3313e-16, 1.3313e-16, 2.9324e-12, 2.1668e-11, 7.7678e-02,
        2.1115e-01, 2.1668e-11, 8.7415e-09, 5.8900e-11, 1.3313e-16, 5.8900e-11])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 89.52% 

Test Accuracy: 89.05% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.493792861700058
distance x is tensor(117.3877, device='cuda:0')
benign distance is  tensor(117.3877, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8114737272262573
distance x is tensor(116.1292, device='cuda:0')
benign distance is  tensor(116.1292, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.13678033649921417
distance x is tensor(129.7777, device='cuda:0')
benign distance is  tensor(129.7777, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6417444944381714
distance x is tensor(97.5880, device='cuda:0')
benign distance is  tensor(97.5880, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6350077390670776
distance x is tensor(89.8475, device='cuda:0')
benign distance is  tensor(89.8475, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6868886351585388
distance x is tensor(124.1436, device='cuda:0')
benign distance is  tensor(124.1436, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.28527191281318665
distance x is tensor(112.2071, device='cuda:0')
benign distance is  tensor(112.2071, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5989896059036255
distance x is tensor(112.6016, device='cuda:0')
benign distance is  tensor(112.6016, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.027696216478943825
distance x is tensor(148.3481, device='cuda:0')
benign distance is  tensor(148.3481, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.2654816508293152
distance x is tensor(134.0197, device='cuda:0')
benign distance is  tensor(134.0197, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3188759684562683
distance x is tensor(98.9369, device='cuda:0')
benign distance is  tensor(98.9369, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4085049629211426
distance x is tensor(140.3651, device='cuda:0')
benign distance is  tensor(140.3651, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5163334608078003
distance x is tensor(118.4240, device='cuda:0')
benign distance is  tensor(118.4240, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6294149160385132
distance x is tensor(123.5428, device='cuda:0')
benign distance is  tensor(123.5428, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4370501637458801
distance x is tensor(130.8545, device='cuda:0')
benign distance is  tensor(130.8545, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.27043479681015015
distance x is tensor(148.0252, device='cuda:0')
benign distance is  tensor(148.0252, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.29764434695243835
distance x is tensor(138.4718, device='cuda:0')
benign distance is  tensor(138.4718, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.3473101556301117
distance x is tensor(127.8938, device='cuda:0')
benign distance is  tensor(127.8938, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.36774942278862
distance x is tensor(129.5582, device='cuda:0')
benign distance is  tensor(129.5582, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3494807183742523
distance x is tensor(128.0337, device='cuda:0')
benign distance is  tensor(128.0337, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7102833986282349
distance x is tensor(129.6519, device='cuda:0')
benign distance is  tensor(129.6519, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.36905592679977417
distance x is tensor(147.9184, device='cuda:0')
benign distance is  tensor(147.9184, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.23279139399528503
distance x is tensor(131.7010, device='cuda:0')
benign distance is  tensor(131.7010, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.22920024394989014
distance x is tensor(123.6896, device='cuda:0')
benign distance is  tensor(123.6896, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([ 0., 14., 13., 35., 22., 14., 20., 13., 21., 21., 21., 22., 22., 22.,
        22., 22., 22., 22., 22., 22., 35., 13., 32., 14., 13., 15., 14.,  2.,
        13., 14.,  1., 35., 35., 34., 14.,  8.])
count_res tensor([1.4272e-16, 1.7164e-10, 6.3143e-11, 2.2636e-01, 5.1165e-07, 1.7164e-10,
        6.9245e-08, 6.3143e-11, 1.8823e-07, 1.8823e-07, 1.8823e-07, 5.1165e-07,
        5.1165e-07, 5.1165e-07, 5.1165e-07, 5.1165e-07, 5.1165e-07, 5.1165e-07,
        5.1165e-07, 5.1165e-07, 2.2636e-01, 6.3143e-11, 1.1270e-02, 1.7164e-10,
        6.3143e-11, 4.6657e-10, 1.7164e-10, 1.0546e-15, 6.3143e-11, 1.7164e-10,
        3.8796e-16, 2.2636e-01, 2.2636e-01, 8.3274e-02, 1.7164e-10, 4.2545e-13])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 89.56% 

Test Accuracy: 88.84% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.1374177634716034
distance x is tensor(114.2408, device='cuda:0')
benign distance is  tensor(114.2408, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6345198154449463
distance x is tensor(104.7727, device='cuda:0')
benign distance is  tensor(104.7727, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.46918565034866333
distance x is tensor(127.5187, device='cuda:0')
benign distance is  tensor(127.5187, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5635145306587219
distance x is tensor(109.8420, device='cuda:0')
benign distance is  tensor(109.8420, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8092318773269653
distance x is tensor(94.8511, device='cuda:0')
benign distance is  tensor(94.8511, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5949763059616089
distance x is tensor(116.6670, device='cuda:0')
benign distance is  tensor(116.6670, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3295726180076599
distance x is tensor(121.8463, device='cuda:0')
benign distance is  tensor(121.8463, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3508695662021637
distance x is tensor(124.9525, device='cuda:0')
benign distance is  tensor(124.9525, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2854474186897278
distance x is tensor(124.3810, device='cuda:0')
benign distance is  tensor(124.3810, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.3651840686798096
distance x is tensor(148.7599, device='cuda:0')
benign distance is  tensor(148.7599, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.15786176919937134
distance x is tensor(139.4614, device='cuda:0')
benign distance is  tensor(139.4614, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.029117083176970482
distance x is tensor(98.7245, device='cuda:0')
benign distance is  tensor(98.7245, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.26135310530662537
distance x is tensor(106.0565, device='cuda:0')
benign distance is  tensor(106.0565, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.405678927898407
distance x is tensor(106.9231, device='cuda:0')
benign distance is  tensor(106.9231, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5098022818565369
distance x is tensor(120.0638, device='cuda:0')
benign distance is  tensor(120.0638, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.32290834188461304
distance x is tensor(130.3032, device='cuda:0')
benign distance is  tensor(130.3032, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.5189585089683533
distance x is tensor(115.3902, device='cuda:0')
benign distance is  tensor(115.3902, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.1633617877960205
distance x is tensor(135.4520, device='cuda:0')
benign distance is  tensor(135.4520, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6071449518203735
distance x is tensor(126.0134, device='cuda:0')
benign distance is  tensor(126.0134, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.3269217014312744
distance x is tensor(119.9496, device='cuda:0')
benign distance is  tensor(119.9496, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.38360071182250977
distance x is tensor(131.1363, device='cuda:0')
benign distance is  tensor(131.1363, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.5536884069442749
distance x is tensor(137.6310, device='cuda:0')
benign distance is  tensor(137.6310, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.3082497715950012
distance x is tensor(122.5961, device='cuda:0')
benign distance is  tensor(122.5961, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.1257655769586563
distance x is tensor(132.6299, device='cuda:0')
benign distance is  tensor(132.6299, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 15., 12., 16., 12., 12., 12., 26., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 27., 12., 12., 12., 12., 12.])
count_res tensor([2.2360e-07, 4.4910e-06, 2.2360e-07, 1.2208e-05, 2.2360e-07, 2.2360e-07,
        2.2360e-07, 2.6890e-01, 1.2208e-05, 1.2208e-05, 1.2208e-05, 1.2208e-05,
        1.2208e-05, 1.2208e-05, 1.2208e-05, 1.2208e-05, 1.2208e-05, 1.2208e-05,
        1.2208e-05, 1.2208e-05, 2.2360e-07, 2.2360e-07, 7.3094e-01, 2.2360e-07,
        2.2360e-07, 2.2360e-07, 2.2360e-07, 2.2360e-07])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 88.73% 

Test Accuracy: 88.15% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.986193060874939
distance x is tensor(144.8508, device='cuda:0')
benign distance is  tensor(144.8508, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8267071843147278
distance x is tensor(133.4295, device='cuda:0')
benign distance is  tensor(133.4295, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2767287790775299
distance x is tensor(163.7950, device='cuda:0')
benign distance is  tensor(163.7950, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8081075549125671
distance x is tensor(126.8453, device='cuda:0')
benign distance is  tensor(126.8453, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0336062908172607
distance x is tensor(129.5353, device='cuda:0')
benign distance is  tensor(129.5353, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8643492460250854
distance x is tensor(135.9502, device='cuda:0')
benign distance is  tensor(135.9502, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.06672807037830353
distance x is tensor(138.1148, device='cuda:0')
benign distance is  tensor(138.1148, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.11995228379964828
distance x is tensor(127.1893, device='cuda:0')
benign distance is  tensor(127.1893, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.25096163153648376
distance x is tensor(149.5583, device='cuda:0')
benign distance is  tensor(149.5583, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.2734142243862152
distance x is tensor(151.4598, device='cuda:0')
benign distance is  tensor(151.4598, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.2395167052745819
distance x is tensor(109.6502, device='cuda:0')
benign distance is  tensor(109.6502, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7360574007034302
distance x is tensor(153.4689, device='cuda:0')
benign distance is  tensor(153.4689, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4622339606285095
distance x is tensor(154.9561, device='cuda:0')
benign distance is  tensor(154.9561, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.15059442818164825
distance x is tensor(148.3860, device='cuda:0')
benign distance is  tensor(148.3860, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.21543236076831818
distance x is tensor(157.7499, device='cuda:0')
benign distance is  tensor(157.7499, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6917184591293335
distance x is tensor(165.7611, device='cuda:0')
benign distance is  tensor(165.7611, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 19., 17.,  8.,  8.,  8.,  8.,
         8.,  8.,  8.,  9., 11., 12.])
count_res tensor([7.9707e-04, 7.9707e-04, 7.9707e-04, 7.9707e-04, 7.9707e-04, 7.9707e-04,
        7.9707e-04, 7.9707e-04, 8.7410e-01, 1.1830e-01, 1.4599e-05, 1.4599e-05,
        1.4599e-05, 1.4599e-05, 1.4599e-05, 1.4599e-05, 1.4599e-05, 3.9684e-05,
        2.9323e-04, 7.9707e-04])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 88.13% 

Test Accuracy: 87.53% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.44752365350723267
distance x is tensor(145.4630, device='cuda:0')
benign distance is  tensor(145.4630, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.30957385897636414
distance x is tensor(152.9125, device='cuda:0')
benign distance is  tensor(152.9125, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.03728494420647621
distance x is tensor(142.4694, device='cuda:0')
benign distance is  tensor(142.4694, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7279962301254272
distance x is tensor(139.3275, device='cuda:0')
benign distance is  tensor(139.3275, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5469965934753418
distance x is tensor(124.4415, device='cuda:0')
benign distance is  tensor(124.4415, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9075309038162231
distance x is tensor(132.8563, device='cuda:0')
benign distance is  tensor(132.8563, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3917657434940338
distance x is tensor(146.9275, device='cuda:0')
benign distance is  tensor(146.9275, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2865730822086334
distance x is tensor(125.3939, device='cuda:0')
benign distance is  tensor(125.3939, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 52
counter_tensor is  tensor([ 3., 34.,  2., 15., 13., 12., 51.,  0., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 34., 45., 49.,  4., 12., 22., 21., 51.,
        48.,  0., 14.,  1., 48., 47.,  1., 51., 45., 13., 12., 46., 18., 47.,
        12., 50., 13., 34.,  0.,  0.,  1., 50.,  0., 12.])
count_res tensor([3.5459e-22, 1.0300e-08, 1.3045e-22, 5.7711e-17, 7.8104e-18, 2.8733e-18,
        2.4881e-01, 1.7654e-23, 4.1555e-06, 4.1555e-06, 4.1555e-06, 4.1555e-06,
        4.1555e-06, 4.1555e-06, 4.1555e-06, 4.1555e-06, 4.1555e-06, 4.1555e-06,
        4.1555e-06, 4.1555e-06, 1.0300e-08, 6.1673e-04, 3.3672e-02, 9.6387e-22,
        2.8733e-18, 6.3288e-14, 2.3282e-14, 2.4881e-01, 1.2387e-02, 1.7654e-23,
        2.1231e-17, 4.7988e-23, 1.2387e-02, 4.5570e-03, 4.7988e-23, 2.4881e-01,
        6.1673e-04, 7.8104e-18, 2.8733e-18, 1.6764e-03, 1.1592e-15, 4.5570e-03,
        2.8733e-18, 9.1531e-02, 7.8104e-18, 1.0300e-08, 1.7654e-23, 1.7654e-23,
        4.7988e-23, 9.1531e-02, 1.7654e-23, 2.8733e-18])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 89.61% 

Test Accuracy: 88.83% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7102981805801392
distance x is tensor(112.1746, device='cuda:0')
benign distance is  tensor(112.1746, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9649249315261841
distance x is tensor(106.0304, device='cuda:0')
benign distance is  tensor(106.0304, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.14289362728595734
distance x is tensor(123.6218, device='cuda:0')
benign distance is  tensor(123.6218, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4309864044189453
distance x is tensor(119.8915, device='cuda:0')
benign distance is  tensor(119.8915, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5316478610038757
distance x is tensor(113.7056, device='cuda:0')
benign distance is  tensor(113.7056, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.08236266672611237
distance x is tensor(135.7602, device='cuda:0')
benign distance is  tensor(135.7602, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.12169083207845688
distance x is tensor(99.6756, device='cuda:0')
benign distance is  tensor(99.6756, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4749845564365387
distance x is tensor(114.1633, device='cuda:0')
benign distance is  tensor(114.1633, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.43391889333724976
distance x is tensor(132.7788, device='cuda:0')
benign distance is  tensor(132.7788, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.24885669350624084
distance x is tensor(133.4245, device='cuda:0')
benign distance is  tensor(133.4245, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5635008811950684
distance x is tensor(94.3193, device='cuda:0')
benign distance is  tensor(94.3193, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6214693784713745
distance x is tensor(136.5929, device='cuda:0')
benign distance is  tensor(136.5929, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.357120543718338
distance x is tensor(121.5917, device='cuda:0')
benign distance is  tensor(121.5917, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2337242066860199
distance x is tensor(122.3959, device='cuda:0')
benign distance is  tensor(122.3959, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.34083205461502075
distance x is tensor(136.4291, device='cuda:0')
benign distance is  tensor(136.4291, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.26657742261886597
distance x is tensor(132.0283, device='cuda:0')
benign distance is  tensor(132.0283, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3416886627674103
distance x is tensor(129.5217, device='cuda:0')
benign distance is  tensor(129.5217, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7723156213760376
distance x is tensor(166.6669, device='cuda:0')
benign distance is  tensor(166.6669, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.1517743021249771
distance x is tensor(134.5113, device='cuda:0')
benign distance is  tensor(134.5113, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.12187235057353973
distance x is tensor(130.7708, device='cuda:0')
benign distance is  tensor(130.7708, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.6076105833053589
distance x is tensor(133.7788, device='cuda:0')
benign distance is  tensor(133.7788, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.30798596143722534
distance x is tensor(110.8810, device='cuda:0')
benign distance is  tensor(110.8810, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3720296621322632
distance x is tensor(126.6206, device='cuda:0')
benign distance is  tensor(126.6206, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.590351939201355
distance x is tensor(122.2009, device='cuda:0')
benign distance is  tensor(122.2009, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.42739635705947876
distance x is tensor(138.4204, device='cuda:0')
benign distance is  tensor(138.4204, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.8960501551628113
distance x is tensor(123.8476, device='cuda:0')
benign distance is  tensor(123.8476, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.09798659384250641
distance x is tensor(133.8848, device='cuda:0')
benign distance is  tensor(133.8848, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5762417912483215
distance x is tensor(119.9549, device='cuda:0')
benign distance is  tensor(119.9549, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5585940480232239
distance x is tensor(122.9493, device='cuda:0')
benign distance is  tensor(122.9493, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.2634851634502411
distance x is tensor(135.7843, device='cuda:0')
benign distance is  tensor(135.7843, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7840663194656372
distance x is tensor(145.6597, device='cuda:0')
benign distance is  tensor(145.6597, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.17599353194236755
distance x is tensor(118.0338, device='cuda:0')
benign distance is  tensor(118.0338, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.18365153670310974
distance x is tensor(137.4539, device='cuda:0')
benign distance is  tensor(137.4539, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.0732743889093399
distance x is tensor(115.9807, device='cuda:0')
benign distance is  tensor(115.9807, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.4041202962398529
distance x is tensor(132.6014, device='cuda:0')
benign distance is  tensor(132.6014, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.34859907627105713
distance x is tensor(132.7594, device='cuda:0')
benign distance is  tensor(132.7594, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.2390325516462326
distance x is tensor(132.5850, device='cuda:0')
benign distance is  tensor(132.5850, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.2569236755371094
distance x is tensor(143.3105, device='cuda:0')
benign distance is  tensor(143.3105, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7892954349517822
distance x is tensor(128.9970, device='cuda:0')
benign distance is  tensor(128.9970, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.3688459098339081
distance x is tensor(122.3771, device='cuda:0')
benign distance is  tensor(122.3771, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 17., 15.,  8.,  8.,  8.,
         8.,  8.,  8.,  9., 12., 12.])
count_res tensor([5.5858e-03, 5.5858e-03, 5.5858e-03, 5.5858e-03, 5.5858e-03, 5.5858e-03,
        5.5858e-03, 5.5858e-03, 2.0549e-03, 8.2900e-01, 1.1219e-01, 1.0231e-04,
        1.0231e-04, 1.0231e-04, 1.0231e-04, 1.0231e-04, 1.0231e-04, 2.7810e-04,
        5.5858e-03, 5.5858e-03])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 89.03% 

Test Accuracy: 88.10% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.1771259605884552
distance x is tensor(118.9570, device='cuda:0')
benign distance is  tensor(118.9570, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9020035862922668
distance x is tensor(107.9588, device='cuda:0')
benign distance is  tensor(107.9588, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.01820196583867073
distance x is tensor(122.7716, device='cuda:0')
benign distance is  tensor(122.7716, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3333793580532074
distance x is tensor(107.6127, device='cuda:0')
benign distance is  tensor(107.6127, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2696923613548279
distance x is tensor(89.9724, device='cuda:0')
benign distance is  tensor(89.9724, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.33185452222824097
distance x is tensor(111.0659, device='cuda:0')
benign distance is  tensor(111.0659, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2069731056690216
distance x is tensor(86.1866, device='cuda:0')
benign distance is  tensor(86.1866, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7401639819145203
distance x is tensor(109.4591, device='cuda:0')
benign distance is  tensor(109.4591, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([35., 35., 17., 15., 34., 35., 35., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 35.,  0.,  0., 11.,  3., 13., 12.,  0.,
        12., 13., 12., 12., 12., 21., 11., 12.])
count_res tensor([1.8629e-01, 1.8629e-01, 2.8371e-09, 3.8396e-10, 6.8531e-02, 1.8629e-01,
        1.8629e-01, 1.9116e-11, 3.1113e-06, 3.1113e-06, 3.1113e-06, 3.1113e-06,
        3.1113e-06, 3.1113e-06, 3.1113e-06, 3.1113e-06, 3.1113e-06, 3.1113e-06,
        3.1113e-06, 3.1113e-06, 1.8629e-01, 1.1746e-16, 1.1746e-16, 7.0326e-12,
        2.3592e-15, 5.1964e-11, 1.9116e-11, 1.1746e-16, 1.9116e-11, 5.1964e-11,
        1.9116e-11, 1.9116e-11, 1.9116e-11, 1.5490e-07, 7.0326e-12, 1.9116e-11])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 89.82% 

Test Accuracy: 89.13% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 89.82%
|----0th round Training Accuracy : 87.94%
|----1th round Training Accuracy : 88.79%
|----2th round Training Accuracy : 88.27%
|----3th round Training Accuracy : 89.16%
|----4th round Training Accuracy : 87.98%
|----5th round Training Accuracy : 89.01%
|----6th round Training Accuracy : 87.48%
|----7th round Training Accuracy : 89.26%
|----8th round Training Accuracy : 89.19%
|----9th round Training Accuracy : 89.02%
|----10th round Training Accuracy : 87.08%
|----11th round Training Accuracy : 89.65%
|----12th round Training Accuracy : 88.55%
|----13th round Training Accuracy : 88.92%
|----14th round Training Accuracy : 87.95%
|----15th round Training Accuracy : 89.62%
|----16th round Training Accuracy : 88.77%
|----17th round Training Accuracy : 89.80%
|----18th round Training Accuracy : 88.56%
|----19th round Training Accuracy : 89.79%
|----20th round Training Accuracy : 89.03%
|----21th round Training Accuracy : 89.13%
|----22th round Training Accuracy : 88.71%
|----23th round Training Accuracy : 89.84%
|----24th round Training Accuracy : 88.52%
|----25th round Training Accuracy : 89.07%
|----26th round Training Accuracy : 88.95%
|----27th round Training Accuracy : 89.73%
|----28th round Training Accuracy : 88.83%
|----29th round Training Accuracy : 89.80%
|----30th round Training Accuracy : 89.12%
|----31th round Training Accuracy : 89.59%
|----32th round Training Accuracy : 89.66%
|----33th round Training Accuracy : 88.25%
|----34th round Training Accuracy : 89.01%
|----35th round Training Accuracy : 90.00%
|----36th round Training Accuracy : 89.23%
|----37th round Training Accuracy : 89.67%
|----38th round Training Accuracy : 89.50%
|----39th round Training Accuracy : 89.89%
|----40th round Training Accuracy : 89.02%
|----41th round Training Accuracy : 89.81%
|----42th round Training Accuracy : 89.09%
|----43th round Training Accuracy : 89.52%
|----44th round Training Accuracy : 89.56%
|----45th round Training Accuracy : 88.73%
|----46th round Training Accuracy : 88.13%
|----47th round Training Accuracy : 89.61%
|----48th round Training Accuracy : 89.03%
|----49th round Training Accuracy : 89.82%
|----Final Test Accuracy: 89.13%
|----0th round Final Test Accuracy : 87.25%
|----1th round Final Test Accuracy : 87.75%
|----2th round Final Test Accuracy : 88.13%
|----3th round Final Test Accuracy : 88.24%
|----4th round Final Test Accuracy : 87.50%
|----5th round Final Test Accuracy : 88.44%
|----6th round Final Test Accuracy : 86.73%
|----7th round Final Test Accuracy : 88.14%
|----8th round Final Test Accuracy : 88.45%
|----9th round Final Test Accuracy : 88.49%
|----10th round Final Test Accuracy : 86.63%
|----11th round Final Test Accuracy : 88.94%
|----12th round Final Test Accuracy : 87.99%
|----13th round Final Test Accuracy : 88.27%
|----14th round Final Test Accuracy : 87.23%
|----15th round Final Test Accuracy : 88.79%
|----16th round Final Test Accuracy : 87.89%
|----17th round Final Test Accuracy : 88.87%
|----18th round Final Test Accuracy : 87.87%
|----19th round Final Test Accuracy : 88.92%
|----20th round Final Test Accuracy : 87.88%
|----21th round Final Test Accuracy : 88.44%
|----22th round Final Test Accuracy : 87.70%
|----23th round Final Test Accuracy : 89.22%
|----24th round Final Test Accuracy : 87.34%
|----25th round Final Test Accuracy : 88.48%
|----26th round Final Test Accuracy : 88.44%
|----27th round Final Test Accuracy : 88.69%
|----28th round Final Test Accuracy : 88.06%
|----29th round Final Test Accuracy : 88.98%
|----30th round Final Test Accuracy : 88.36%
|----31th round Final Test Accuracy : 89.03%
|----32th round Final Test Accuracy : 88.58%
|----33th round Final Test Accuracy : 87.84%
|----34th round Final Test Accuracy : 88.12%
|----35th round Final Test Accuracy : 89.07%
|----36th round Final Test Accuracy : 88.40%
|----37th round Final Test Accuracy : 88.74%
|----38th round Final Test Accuracy : 88.29%
|----39th round Final Test Accuracy : 89.37%
|----40th round Final Test Accuracy : 88.58%
|----41th round Final Test Accuracy : 88.95%
|----42th round Final Test Accuracy : 88.10%
|----43th round Final Test Accuracy : 89.05%
|----44th round Final Test Accuracy : 88.84%
|----45th round Final Test Accuracy : 88.15%
|----46th round Final Test Accuracy : 87.53%
|----47th round Final Test Accuracy : 88.83%
|----48th round Final Test Accuracy : 88.10%
|----49th round Final Test Accuracy : 89.13%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 3403.0646
