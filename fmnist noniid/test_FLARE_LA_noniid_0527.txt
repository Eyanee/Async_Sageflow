
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7182720992714167
distance x is tensor(125.2764, device='cuda:1')
benign distance is  tensor(125.2764, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8608445506542921
distance x is tensor(105.2022, device='cuda:1')
benign distance is  tensor(105.2022, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6216265689581633
distance x is tensor(109.7246, device='cuda:1')
benign distance is  tensor(109.7246, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0872526373714209
distance x is tensor(145.4966, device='cuda:1')
benign distance is  tensor(145.4966, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7998565775342286
distance x is tensor(99.2950, device='cuda:1')
benign distance is  tensor(99.2950, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6469171065837145
distance x is tensor(94.8470, device='cuda:1')
benign distance is  tensor(94.8470, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1838535238057375
distance x is tensor(105.6997, device='cuda:1')
benign distance is  tensor(105.6997, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6883245036005974
distance x is tensor(84.5810, device='cuda:1')
benign distance is  tensor(84.5810, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9052855372428894
distance x is tensor(116.7584, device='cuda:1')
benign distance is  tensor(116.7584, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7177989659830928
distance x is tensor(124.9061, device='cuda:1')
benign distance is  tensor(124.9061, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0316957291215658
distance x is tensor(95.1045, device='cuda:1')
benign distance is  tensor(95.1045, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.150811541825533
distance x is tensor(122.0812, device='cuda:1')
benign distance is  tensor(122.0812, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.007323320955038
distance x is tensor(166.5674, device='cuda:1')
benign distance is  tensor(166.5674, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6159326070919633
distance x is tensor(67.0170, device='cuda:1')
benign distance is  tensor(67.0170, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.993991781026125
distance x is tensor(143.7983, device='cuda:1')
benign distance is  tensor(143.7983, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3322988376021385
distance x is tensor(126.9591, device='cuda:1')
benign distance is  tensor(126.9591, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.3658282049000263
distance x is tensor(147.5284, device='cuda:1')
benign distance is  tensor(147.5284, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6340565392747521
distance x is tensor(115.7107, device='cuda:1')
benign distance is  tensor(115.7107, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.0525547470897436
distance x is tensor(121.6684, device='cuda:1')
benign distance is  tensor(121.6684, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.72678317502141
distance x is tensor(119.3545, device='cuda:1')
benign distance is  tensor(119.3545, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0218372661620378
distance x is tensor(85.2630, device='cuda:1')
benign distance is  tensor(85.2630, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7843080163002014
distance x is tensor(212.6762, device='cuda:1')
benign distance is  tensor(212.6762, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0702515244483948
distance x is tensor(150.2272, device='cuda:1')
benign distance is  tensor(150.2272, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7017689980566502
distance x is tensor(115.0515, device='cuda:1')
benign distance is  tensor(115.0515, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.8711543958634138
distance x is tensor(120.0344, device='cuda:1')
benign distance is  tensor(120.0344, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5704855527728796
distance x is tensor(77.6988, device='cuda:1')
benign distance is  tensor(77.6988, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9558452032506466
distance x is tensor(139.4910, device='cuda:1')
benign distance is  tensor(139.4910, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.1738514080643654
distance x is tensor(117.6389, device='cuda:1')
benign distance is  tensor(117.6389, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7149506360292435
distance x is tensor(117.7019, device='cuda:1')
benign distance is  tensor(117.7019, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7145620249211788
distance x is tensor(121.9893, device='cuda:1')
benign distance is  tensor(121.9893, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4785029077902436
distance x is tensor(105.2991, device='cuda:1')
benign distance is  tensor(105.2991, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7139446940273046
distance x is tensor(172.0454, device='cuda:1')
benign distance is  tensor(172.0454, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7861065156757832
distance x is tensor(118.4644, device='cuda:1')
benign distance is  tensor(118.4644, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.7579000126570463
distance x is tensor(107.1142, device='cuda:1')
benign distance is  tensor(107.1142, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6331949476152658
distance x is tensor(147.0688, device='cuda:1')
benign distance is  tensor(147.0688, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.1304529309272766
distance x is tensor(129.2749, device='cuda:1')
benign distance is  tensor(129.2749, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8653472531586885
distance x is tensor(114.0639, device='cuda:1')
benign distance is  tensor(114.0639, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7940249601379037
distance x is tensor(83.2443, device='cuda:1')
benign distance is  tensor(83.2443, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7755362223833799
distance x is tensor(99.8523, device='cuda:1')
benign distance is  tensor(99.8523, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8307134807109833
distance x is tensor(116.9775, device='cuda:1')
benign distance is  tensor(116.9775, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.2696347534656525
distance x is tensor(112.5858, device='cuda:1')
benign distance is  tensor(112.5858, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.0637344643473625
distance x is tensor(140.1611, device='cuda:1')
benign distance is  tensor(140.1611, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.0966940056532621
distance x is tensor(141.9792, device='cuda:1')
benign distance is  tensor(141.9792, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.1584689393639565
distance x is tensor(98.6833, device='cuda:1')
benign distance is  tensor(98.6833, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5270360689610243
distance x is tensor(154.0694, device='cuda:1')
benign distance is  tensor(154.0694, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7321373196318746
distance x is tensor(140.4774, device='cuda:1')
benign distance is  tensor(140.4774, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7097784634679556
distance x is tensor(101.9556, device='cuda:1')
benign distance is  tensor(101.9556, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6087287282571197
distance x is tensor(130.5527, device='cuda:1')
benign distance is  tensor(130.5527, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 17., 16.,  8.,  8.,  8.,
         8.,  8.,  8., 10., 10., 12.])
count_res tensor([4.7001e-03, 4.7001e-03, 4.7001e-03, 4.7001e-03, 4.7001e-03, 4.7001e-03,
        4.7001e-03, 4.7001e-03, 1.7291e-03, 6.9756e-01, 2.5662e-01, 8.6086e-05,
        8.6086e-05, 8.6086e-05, 8.6086e-05, 8.6086e-05, 8.6086e-05, 6.3609e-04,
        6.3609e-04, 4.7001e-03])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 96.48% 

Test Accuracy: 86.96% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6844202186912298
distance x is tensor(105.3841, device='cuda:1')
benign distance is  tensor(105.3841, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7196767367422581
distance x is tensor(106.2997, device='cuda:1')
benign distance is  tensor(106.2997, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6280245296657085
distance x is tensor(105.4138, device='cuda:1')
benign distance is  tensor(105.4138, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8497883528470993
distance x is tensor(146.7957, device='cuda:1')
benign distance is  tensor(146.7957, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.811734015122056
distance x is tensor(89.9754, device='cuda:1')
benign distance is  tensor(89.9754, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6042840415611863
distance x is tensor(107.8440, device='cuda:1')
benign distance is  tensor(107.8440, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.128367269411683
distance x is tensor(97.0511, device='cuda:1')
benign distance is  tensor(97.0511, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6265874896198511
distance x is tensor(90.3181, device='cuda:1')
benign distance is  tensor(90.3181, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([24., 19., 12., 12., 12.,  0., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 26., 12., 27., 12., 12., 12., 12., 12.])
count_res tensor([3.5106e-02, 2.3654e-04, 2.1570e-07, 2.1570e-07, 2.1570e-07, 1.3253e-12,
        2.1570e-07, 2.1570e-07, 1.1777e-05, 1.1777e-05, 1.1777e-05, 1.1777e-05,
        1.1777e-05, 1.1777e-05, 1.1777e-05, 1.1777e-05, 1.1777e-05, 1.1777e-05,
        1.1777e-05, 1.1777e-05, 2.5940e-01, 2.1570e-07, 7.0512e-01, 2.1570e-07,
        2.1570e-07, 2.1570e-07, 2.1570e-07, 2.1570e-07])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 86.00% 

Test Accuracy: 84.69% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8774101929739118
distance x is tensor(124.2273, device='cuda:1')
benign distance is  tensor(124.2273, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7719111423939466
distance x is tensor(111.5547, device='cuda:1')
benign distance is  tensor(111.5547, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7340402398258448
distance x is tensor(115.0368, device='cuda:1')
benign distance is  tensor(115.0368, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1378059163689613
distance x is tensor(151.7310, device='cuda:1')
benign distance is  tensor(151.7310, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3219556771218777
distance x is tensor(102.8519, device='cuda:1')
benign distance is  tensor(102.8519, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6628083949908614
distance x is tensor(114.8261, device='cuda:1')
benign distance is  tensor(114.8261, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1984091009944677
distance x is tensor(120.5089, device='cuda:1')
benign distance is  tensor(120.5089, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7224258175119758
distance x is tensor(96.6043, device='cuda:1')
benign distance is  tensor(96.6043, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9728012569248676
distance x is tensor(93.5359, device='cuda:1')
benign distance is  tensor(93.5359, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.713444922119379
distance x is tensor(141.2141, device='cuda:1')
benign distance is  tensor(141.2141, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1708003543317318
distance x is tensor(36.3855, device='cuda:1')
benign distance is  tensor(36.3855, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4693690277636051
distance x is tensor(119.6590, device='cuda:1')
benign distance is  tensor(119.6590, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1594444662332535
distance x is tensor(185.3750, device='cuda:1')
benign distance is  tensor(185.3750, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8136108908802271
distance x is tensor(78.0705, device='cuda:1')
benign distance is  tensor(78.0705, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9168608579784632
distance x is tensor(143.4277, device='cuda:1')
benign distance is  tensor(143.4277, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3453692384064198
distance x is tensor(130.5178, device='cuda:1')
benign distance is  tensor(130.5178, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([13., 13.,  0., 13., 17., 13., 13., 13., 15., 15., 15., 15., 15., 15.,
        15., 15., 15., 15., 15., 15., 13., 27., 13., 13., 13., 27., 13., 26.])
count_res tensor([3.5115e-07, 3.5115e-07, 7.9372e-13, 3.5115e-07, 1.9172e-05, 3.5115e-07,
        3.5115e-07, 3.5115e-07, 2.5947e-06, 2.5947e-06, 2.5947e-06, 2.5947e-06,
        2.5947e-06, 2.5947e-06, 2.5947e-06, 2.5947e-06, 2.5947e-06, 2.5947e-06,
        2.5947e-06, 2.5947e-06, 3.5115e-07, 4.2230e-01, 3.5115e-07, 3.5115e-07,
        3.5115e-07, 4.2230e-01, 3.5115e-07, 1.5535e-01])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 90.08% 

Test Accuracy: 86.78% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7582949716597795
distance x is tensor(125.0041, device='cuda:1')
benign distance is  tensor(125.0041, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8384295459836721
distance x is tensor(111.8336, device='cuda:1')
benign distance is  tensor(111.8336, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5978174498304725
distance x is tensor(107.8896, device='cuda:1')
benign distance is  tensor(107.8896, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0649820156395435
distance x is tensor(150.6137, device='cuda:1')
benign distance is  tensor(150.6137, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8218187615275383
distance x is tensor(89.9823, device='cuda:1')
benign distance is  tensor(89.9823, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7980422740802169
distance x is tensor(105.8533, device='cuda:1')
benign distance is  tensor(105.8533, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.071643764153123
distance x is tensor(103.0505, device='cuda:1')
benign distance is  tensor(103.0505, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6190518755465746
distance x is tensor(89.9028, device='cuda:1')
benign distance is  tensor(89.9028, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.058339074254036
distance x is tensor(127.6308, device='cuda:1')
benign distance is  tensor(127.6308, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.763871131464839
distance x is tensor(95.3706, device='cuda:1')
benign distance is  tensor(95.3706, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.3009414114058018
distance x is tensor(132.6792, device='cuda:1')
benign distance is  tensor(132.6792, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8944597709923983
distance x is tensor(116.7656, device='cuda:1')
benign distance is  tensor(116.7656, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9088895376771688
distance x is tensor(89.7647, device='cuda:1')
benign distance is  tensor(89.7647, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7873179651796818
distance x is tensor(205.5889, device='cuda:1')
benign distance is  tensor(205.5889, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.044878389686346
distance x is tensor(154.8308, device='cuda:1')
benign distance is  tensor(154.8308, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6711109150201082
distance x is tensor(109.9851, device='cuda:1')
benign distance is  tensor(109.9851, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([12., 12.,  4., 12., 12., 12., 12., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 32., 14., 12., 12.,  0., 33.,  3., 23.,
        12., 21., 26., 28., 12., 33., 12., 35.])
count_res tensor([7.7641e-11, 7.7641e-11, 2.6046e-14, 7.7641e-11, 7.7641e-11, 7.7641e-11,
        7.7641e-11, 7.7641e-11, 1.2637e-05, 1.2637e-05, 1.2637e-05, 1.2637e-05,
        1.2637e-05, 1.2637e-05, 1.2637e-05, 1.2637e-05, 1.2637e-05, 1.2637e-05,
        1.2637e-05, 1.2637e-05, 3.7669e-02, 5.7370e-10, 7.7641e-11, 7.7641e-11,
        4.7705e-16, 1.0239e-01, 9.5817e-15, 4.6487e-06, 7.7641e-11, 6.2914e-07,
        9.3372e-05, 6.8993e-04, 7.7641e-11, 1.0239e-01, 7.7641e-11, 7.5660e-01])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 76.98% 

Test Accuracy: 79.08% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7804809603840113
distance x is tensor(116.7706, device='cuda:1')
benign distance is  tensor(116.7706, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9542050659656525
distance x is tensor(118.7047, device='cuda:1')
benign distance is  tensor(118.7047, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8518017940223217
distance x is tensor(122.9291, device='cuda:1')
benign distance is  tensor(122.9291, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0444379430264235
distance x is tensor(162.2588, device='cuda:1')
benign distance is  tensor(162.2588, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8350758999586105
distance x is tensor(99.8452, device='cuda:1')
benign distance is  tensor(99.8452, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6445546466857195
distance x is tensor(122.2972, device='cuda:1')
benign distance is  tensor(122.2972, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4180665202438831
distance x is tensor(106.2173, device='cuda:1')
benign distance is  tensor(106.2173, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6874755676835775
distance x is tensor(103.6069, device='cuda:1')
benign distance is  tensor(103.6069, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9549650680273771
distance x is tensor(111.0986, device='cuda:1')
benign distance is  tensor(111.0986, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8321325248107314
distance x is tensor(135.7845, device='cuda:1')
benign distance is  tensor(135.7845, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1847908906638622
distance x is tensor(65.8210, device='cuda:1')
benign distance is  tensor(65.8210, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.7281972095370293
distance x is tensor(113.3827, device='cuda:1')
benign distance is  tensor(113.3827, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0589365623891354
distance x is tensor(166.7751, device='cuda:1')
benign distance is  tensor(166.7751, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7727794777601957
distance x is tensor(72.4166, device='cuda:1')
benign distance is  tensor(72.4166, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9197780415415764
distance x is tensor(146.6049, device='cuda:1')
benign distance is  tensor(146.6049, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3127063140273094
distance x is tensor(81.9792, device='cuda:1')
benign distance is  tensor(81.9792, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.150837030261755
distance x is tensor(113.2532, device='cuda:1')
benign distance is  tensor(113.2532, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6525865588337183
distance x is tensor(94.1947, device='cuda:1')
benign distance is  tensor(94.1947, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9847839623689651
distance x is tensor(131.8276, device='cuda:1')
benign distance is  tensor(131.8276, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.6482320986688137
distance x is tensor(127.0342, device='cuda:1')
benign distance is  tensor(127.0342, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7906884774565697
distance x is tensor(120.8608, device='cuda:1')
benign distance is  tensor(120.8608, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8803652040660381
distance x is tensor(124.1923, device='cuda:1')
benign distance is  tensor(124.1923, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5860069878399372
distance x is tensor(118.4685, device='cuda:1')
benign distance is  tensor(118.4685, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.0060413107275963
distance x is tensor(175.3457, device='cuda:1')
benign distance is  tensor(175.3457, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([16., 13., 24., 12., 13.,  0., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 27., 26., 13., 12., 12., 12., 12.])
count_res tensor([1.1779e-05, 5.8646e-07, 3.5114e-02, 2.1574e-07, 5.8646e-07, 1.3256e-12,
        2.1574e-07, 2.1574e-07, 1.1779e-05, 1.1779e-05, 1.1779e-05, 1.1779e-05,
        1.1779e-05, 1.1779e-05, 1.1779e-05, 1.1779e-05, 1.1779e-05, 1.1779e-05,
        1.1779e-05, 1.1779e-05, 2.1574e-07, 7.0527e-01, 2.5946e-01, 5.8646e-07,
        2.1574e-07, 2.1574e-07, 2.1574e-07, 2.1574e-07])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 85.75% 

Test Accuracy: 84.68% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7486483920365572
distance x is tensor(127.1036, device='cuda:1')
benign distance is  tensor(127.1036, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7714349050074816
distance x is tensor(118.6692, device='cuda:1')
benign distance is  tensor(118.6692, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8556408770382404
distance x is tensor(113.6195, device='cuda:1')
benign distance is  tensor(113.6195, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9516212660819292
distance x is tensor(167.5663, device='cuda:1')
benign distance is  tensor(167.5663, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8262299364432693
distance x is tensor(99.7259, device='cuda:1')
benign distance is  tensor(99.7259, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8864861205220222
distance x is tensor(125.0945, device='cuda:1')
benign distance is  tensor(125.0945, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1676884610205889
distance x is tensor(101.6714, device='cuda:1')
benign distance is  tensor(101.6714, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6268904116004705
distance x is tensor(95.3186, device='cuda:1')
benign distance is  tensor(95.3186, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.6873185839504004
distance x is tensor(123.2862, device='cuda:1')
benign distance is  tensor(123.2862, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.8903433065861464
distance x is tensor(64.5291, device='cuda:1')
benign distance is  tensor(64.5291, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.9631792083382607
distance x is tensor(144.8358, device='cuda:1')
benign distance is  tensor(144.8358, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.9040355160832405
distance x is tensor(132.7738, device='cuda:1')
benign distance is  tensor(132.7738, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9171639792621136
distance x is tensor(122.4263, device='cuda:1')
benign distance is  tensor(122.4263, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7737011406570673
distance x is tensor(99.3985, device='cuda:1')
benign distance is  tensor(99.3985, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.8637793213129044
distance x is tensor(102.3262, device='cuda:1')
benign distance is  tensor(102.3262, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.6594121996313334
distance x is tensor(136.3003, device='cuda:1')
benign distance is  tensor(136.3003, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 44
counter_tensor is  tensor([13., 12., 21., 26., 27., 10., 27.,  0., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 28., 18., 12., 43., 32.,  0.,  1.,  0.,
        18., 41., 43., 42., 15., 42., 13., 12., 39.,  0., 12., 12., 33., 12.,
        12., 12.])
count_res tensor([3.2383e-14, 1.1913e-14, 9.6532e-11, 1.4327e-08, 3.8944e-08, 1.6123e-15,
        3.8944e-08, 7.3196e-20, 5.7798e-06, 5.7798e-06, 5.7798e-06, 5.7798e-06,
        5.7798e-06, 5.7798e-06, 5.7798e-06, 5.7798e-06, 5.7798e-06, 5.7798e-06,
        5.7798e-06, 5.7798e-06, 1.0586e-07, 4.8061e-12, 1.1913e-14, 3.4606e-01,
        5.7798e-06, 7.3196e-20, 1.9897e-19, 7.3196e-20, 4.8061e-12, 4.6834e-02,
        3.4606e-01, 1.2731e-01, 2.3928e-13, 1.2731e-01, 3.2383e-14, 1.1913e-14,
        6.3383e-03, 7.3196e-20, 1.1913e-14, 1.1913e-14, 1.5711e-05, 1.1913e-14,
        1.1913e-14, 1.1913e-14])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 87.16% 

Test Accuracy: 84.22% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8266583774238825
distance x is tensor(122.5603, device='cuda:1')
benign distance is  tensor(122.5603, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7583672851324081
distance x is tensor(108.8169, device='cuda:1')
benign distance is  tensor(108.8169, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7628689669072628
distance x is tensor(112.0246, device='cuda:1')
benign distance is  tensor(112.0246, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9709260817617178
distance x is tensor(152.6995, device='cuda:1')
benign distance is  tensor(152.6995, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9911413406953216
distance x is tensor(82.9826, device='cuda:1')
benign distance is  tensor(82.9826, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7881818134337664
distance x is tensor(100.0536, device='cuda:1')
benign distance is  tensor(100.0536, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.275562558323145
distance x is tensor(98.5375, device='cuda:1')
benign distance is  tensor(98.5375, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7558633591979742
distance x is tensor(87.0415, device='cuda:1')
benign distance is  tensor(87.0415, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9761965367943048
distance x is tensor(98.2318, device='cuda:1')
benign distance is  tensor(98.2318, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6292442670091987
distance x is tensor(107.5901, device='cuda:1')
benign distance is  tensor(107.5901, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9511799905449152
distance x is tensor(82.8950, device='cuda:1')
benign distance is  tensor(82.8950, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4226276651024818
distance x is tensor(115.2849, device='cuda:1')
benign distance is  tensor(115.2849, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2048489190638065
distance x is tensor(156.3008, device='cuda:1')
benign distance is  tensor(156.3008, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7936176303774118
distance x is tensor(73.9146, device='cuda:1')
benign distance is  tensor(73.9146, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9869159366935492
distance x is tensor(129.3493, device='cuda:1')
benign distance is  tensor(129.3493, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.251488046720624
distance x is tensor(129.3819, device='cuda:1')
benign distance is  tensor(129.3819, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1524642538279295
distance x is tensor(109.4409, device='cuda:1')
benign distance is  tensor(109.4409, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6429765056818724
distance x is tensor(99.8154, device='cuda:1')
benign distance is  tensor(99.8154, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9934883527457714
distance x is tensor(113.5511, device='cuda:1')
benign distance is  tensor(113.5511, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9402773939073086
distance x is tensor(115.1281, device='cuda:1')
benign distance is  tensor(115.1281, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.928230844438076
distance x is tensor(77.2351, device='cuda:1')
benign distance is  tensor(77.2351, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.904751630499959
distance x is tensor(211.2669, device='cuda:1')
benign distance is  tensor(211.2669, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1518350765109062
distance x is tensor(150.1166, device='cuda:1')
benign distance is  tensor(150.1166, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.667703477665782
distance x is tensor(109.0214, device='cuda:1')
benign distance is  tensor(109.0214, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.1328929774463177
distance x is tensor(120.6586, device='cuda:1')
benign distance is  tensor(120.6586, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.1564473509788513
distance x is tensor(139.3747, device='cuda:1')
benign distance is  tensor(139.3747, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.084011446684599
distance x is tensor(137.6774, device='cuda:1')
benign distance is  tensor(137.6774, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.9396567735821009
distance x is tensor(71.0090, device='cuda:1')
benign distance is  tensor(71.0090, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6452829148620367
distance x is tensor(146.7524, device='cuda:1')
benign distance is  tensor(146.7524, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7635678201913834
distance x is tensor(133.4680, device='cuda:1')
benign distance is  tensor(133.4680, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8735571168363094
distance x is tensor(95.7637, device='cuda:1')
benign distance is  tensor(95.7637, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6493961717933416
distance x is tensor(124.7042, device='cuda:1')
benign distance is  tensor(124.7042, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 17., 16.,  8.,  8.,  8.,
         8.,  8.,  8.,  9., 11., 12.])
count_res tensor([4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03,
        4.6969e-03, 4.6969e-03, 1.7279e-03, 6.9708e-01, 2.5644e-01, 8.6027e-05,
        8.6027e-05, 8.6027e-05, 8.6027e-05, 8.6027e-05, 8.6027e-05, 2.3384e-04,
        1.7279e-03, 4.6969e-03])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 83.65% 

Test Accuracy: 80.81% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5920897275209427
distance x is tensor(111.7330, device='cuda:1')
benign distance is  tensor(111.7330, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9448200166225433
distance x is tensor(100.1726, device='cuda:1')
benign distance is  tensor(100.1726, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6807552129030228
distance x is tensor(101.0862, device='cuda:1')
benign distance is  tensor(101.0862, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.920512530952692
distance x is tensor(150.7732, device='cuda:1')
benign distance is  tensor(150.7732, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8792200870811939
distance x is tensor(78.1547, device='cuda:1')
benign distance is  tensor(78.1547, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6978514911606908
distance x is tensor(98.2655, device='cuda:1')
benign distance is  tensor(98.2655, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1967673022300005
distance x is tensor(95.8875, device='cuda:1')
benign distance is  tensor(95.8875, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.71030318364501
distance x is tensor(89.4767, device='cuda:1')
benign distance is  tensor(89.4767, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([14., 31., 20.,  0., 16.,  0., 12., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 14., 35., 12., 16., 31., 35., 18., 35.,
        12., 13., 12., 14., 12., 12., 16.,  4.])
count_res tensor([2.4969e-10, 6.0312e-03, 1.0073e-07, 2.0762e-16, 1.8449e-09, 2.0762e-16,
        3.3791e-11, 3.3791e-11, 5.4997e-06, 5.4997e-06, 5.4997e-06, 5.4997e-06,
        5.4997e-06, 5.4997e-06, 5.4997e-06, 5.4997e-06, 5.4997e-06, 5.4997e-06,
        5.4997e-06, 5.4997e-06, 2.4969e-10, 3.2929e-01, 3.3791e-11, 1.8449e-09,
        6.0312e-03, 3.2929e-01, 1.3632e-08, 3.2929e-01, 3.3791e-11, 9.1855e-11,
        3.3791e-11, 2.4969e-10, 3.3791e-11, 3.3791e-11, 1.8449e-09, 1.1336e-14])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 84.96% 

Test Accuracy: 85.88% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7039933577179909
distance x is tensor(111.0015, device='cuda:1')
benign distance is  tensor(111.0015, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8246137499809265
distance x is tensor(105.0214, device='cuda:1')
benign distance is  tensor(105.0214, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.812653074041009
distance x is tensor(114.1014, device='cuda:1')
benign distance is  tensor(114.1014, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9086048323661089
distance x is tensor(160.1222, device='cuda:1')
benign distance is  tensor(160.1222, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.839314429089427
distance x is tensor(102.5035, device='cuda:1')
benign distance is  tensor(102.5035, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5550812957808375
distance x is tensor(98.7166, device='cuda:1')
benign distance is  tensor(98.7166, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0182141494005919
distance x is tensor(103.2738, device='cuda:1')
benign distance is  tensor(103.2738, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6343273222446442
distance x is tensor(94.1956, device='cuda:1')
benign distance is  tensor(94.1956, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0565758664160967
distance x is tensor(95.4644, device='cuda:1')
benign distance is  tensor(95.4644, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6836046632379293
distance x is tensor(124.1102, device='cuda:1')
benign distance is  tensor(124.1102, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2142791338264942
distance x is tensor(65.3316, device='cuda:1')
benign distance is  tensor(65.3316, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.8323099166154861
distance x is tensor(119.9750, device='cuda:1')
benign distance is  tensor(119.9750, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0203169975429773
distance x is tensor(155.3831, device='cuda:1')
benign distance is  tensor(155.3831, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.888963345438242
distance x is tensor(69.0892, device='cuda:1')
benign distance is  tensor(69.0892, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8773487657308578
distance x is tensor(134.0683, device='cuda:1')
benign distance is  tensor(134.0683, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.05610472522676
distance x is tensor(102.3153, device='cuda:1')
benign distance is  tensor(102.3153, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.0277689583599567
distance x is tensor(111.8548, device='cuda:1')
benign distance is  tensor(111.8548, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6379086435772479
distance x is tensor(66.1634, device='cuda:1')
benign distance is  tensor(66.1634, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8517010761424899
distance x is tensor(129.9298, device='cuda:1')
benign distance is  tensor(129.9298, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.8205209150910378
distance x is tensor(115.2659, device='cuda:1')
benign distance is  tensor(115.2659, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8161077201366425
distance x is tensor(123.1726, device='cuda:1')
benign distance is  tensor(123.1726, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9511115532368422
distance x is tensor(82.8434, device='cuda:1')
benign distance is  tensor(82.8434, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5556522058323026
distance x is tensor(120.6961, device='cuda:1')
benign distance is  tensor(120.6961, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.8648801036179066
distance x is tensor(166.2318, device='cuda:1')
benign distance is  tensor(166.2318, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 12., 20., 25., 12.,  0., 26., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 12., 12., 16., 12., 21., 12.])
count_res tensor([6.0357e-07, 6.0357e-07, 1.7992e-03, 2.6703e-01, 6.0357e-07, 3.7084e-12,
        7.2585e-01, 6.0357e-07, 3.2954e-05, 3.2954e-05, 3.2954e-05, 3.2954e-05,
        3.2954e-05, 3.2954e-05, 3.2954e-05, 3.2954e-05, 3.2954e-05, 3.2954e-05,
        3.2954e-05, 3.2954e-05, 6.0357e-07, 6.0357e-07, 6.0357e-07, 6.0357e-07,
        3.2954e-05, 6.0357e-07, 4.8907e-03, 6.0357e-07])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 82.16% 

Test Accuracy: 81.34% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6736997719854116
distance x is tensor(133.3670, device='cuda:1')
benign distance is  tensor(133.3670, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9204845204949379
distance x is tensor(116.4533, device='cuda:1')
benign distance is  tensor(116.4533, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8532730787992477
distance x is tensor(115.6175, device='cuda:1')
benign distance is  tensor(115.6175, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9387765787541866
distance x is tensor(152.8987, device='cuda:1')
benign distance is  tensor(152.8987, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2182992435991764
distance x is tensor(100.9753, device='cuda:1')
benign distance is  tensor(100.9753, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8268863800913095
distance x is tensor(110.2607, device='cuda:1')
benign distance is  tensor(110.2607, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5128656327724457
distance x is tensor(60.6532, device='cuda:1')
benign distance is  tensor(60.6532, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8565161339938641
distance x is tensor(110.8514, device='cuda:1')
benign distance is  tensor(110.8514, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.5339982733130455
distance x is tensor(102.0506, device='cuda:1')
benign distance is  tensor(102.0506, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7897438760846853
distance x is tensor(123.9192, device='cuda:1')
benign distance is  tensor(123.9192, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.040205430239439
distance x is tensor(126.9040, device='cuda:1')
benign distance is  tensor(126.9040, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9394511859863997
distance x is tensor(117.6020, device='cuda:1')
benign distance is  tensor(117.6020, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.3315696828067303
distance x is tensor(75.5051, device='cuda:1')
benign distance is  tensor(75.5051, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7327791415154934
distance x is tensor(211.1490, device='cuda:1')
benign distance is  tensor(211.1490, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.5703543722629547
distance x is tensor(158.9208, device='cuda:1')
benign distance is  tensor(158.9208, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.742513831704855
distance x is tensor(119.1459, device='cuda:1')
benign distance is  tensor(119.1459, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([31., 13., 32.,  0.,  0., 13., 13., 30., 22., 23., 23., 23., 23., 23.,
        23., 23., 23., 23., 23., 23., 13., 14., 12., 23., 35., 23., 12., 34.,
        34., 35.,  2., 13., 13., 13.,  1.,  0.])
count_res tensor([6.5164e-03, 9.9245e-11, 1.7714e-02, 2.2433e-16, 2.2433e-16, 9.9245e-11,
        9.9245e-11, 2.3973e-03, 8.0419e-07, 2.1860e-06, 2.1860e-06, 2.1860e-06,
        2.1860e-06, 2.1860e-06, 2.1860e-06, 2.1860e-06, 2.1860e-06, 2.1860e-06,
        2.1860e-06, 2.1860e-06, 9.9245e-11, 2.6978e-10, 3.6510e-11, 2.1860e-06,
        3.5579e-01, 2.1860e-06, 3.6510e-11, 1.3089e-01, 1.3089e-01, 3.5579e-01,
        1.6576e-15, 9.9245e-11, 9.9245e-11, 9.9245e-11, 6.0978e-16, 2.2433e-16])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 91.75% 

Test Accuracy: 85.24% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6875652726739645
distance x is tensor(116.6743, device='cuda:1')
benign distance is  tensor(116.6743, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7732619689777493
distance x is tensor(110.3438, device='cuda:1')
benign distance is  tensor(110.3438, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6909519638866186
distance x is tensor(110.8683, device='cuda:1')
benign distance is  tensor(110.8683, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7826959658414125
distance x is tensor(154.9927, device='cuda:1')
benign distance is  tensor(154.9927, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.871723192743957
distance x is tensor(92.5818, device='cuda:1')
benign distance is  tensor(92.5818, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7854198822751641
distance x is tensor(101.0917, device='cuda:1')
benign distance is  tensor(101.0917, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2146290391683578
distance x is tensor(97.9947, device='cuda:1')
benign distance is  tensor(97.9947, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5442384798079729
distance x is tensor(88.6719, device='cuda:1')
benign distance is  tensor(88.6719, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9520754236727953
distance x is tensor(100.8834, device='cuda:1')
benign distance is  tensor(100.8834, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7202426446601748
distance x is tensor(106.2862, device='cuda:1')
benign distance is  tensor(106.2862, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0532482359558344
distance x is tensor(72.9627, device='cuda:1')
benign distance is  tensor(72.9627, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2001477479934692
distance x is tensor(121.9761, device='cuda:1')
benign distance is  tensor(121.9761, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0725496038794518
distance x is tensor(162.8305, device='cuda:1')
benign distance is  tensor(162.8305, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7557696299627423
distance x is tensor(58.8157, device='cuda:1')
benign distance is  tensor(58.8157, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8208334185183048
distance x is tensor(144.2828, device='cuda:1')
benign distance is  tensor(144.2828, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.488457627594471
distance x is tensor(120.8710, device='cuda:1')
benign distance is  tensor(120.8710, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.79759731143713
distance x is tensor(117.3749, device='cuda:1')
benign distance is  tensor(117.3749, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.8439458291977644
distance x is tensor(87.1403, device='cuda:1')
benign distance is  tensor(87.1403, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6645888648927212
distance x is tensor(140.8812, device='cuda:1')
benign distance is  tensor(140.8812, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.624548278748989
distance x is tensor(122.9101, device='cuda:1')
benign distance is  tensor(122.9101, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7295311791822314
distance x is tensor(81.7750, device='cuda:1')
benign distance is  tensor(81.7750, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7231730539351702
distance x is tensor(85.2924, device='cuda:1')
benign distance is  tensor(85.2924, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7722249422222376
distance x is tensor(85.9093, device='cuda:1')
benign distance is  tensor(85.9093, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7026491016149521
distance x is tensor(112.5571, device='cuda:1')
benign distance is  tensor(112.5571, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 17., 16.,  8.,  8.,  8.,
         8.,  8.,  8.,  9., 11., 12.])
count_res tensor([4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03,
        4.6969e-03, 4.6969e-03, 1.7279e-03, 6.9708e-01, 2.5644e-01, 8.6027e-05,
        8.6027e-05, 8.6027e-05, 8.6027e-05, 8.6027e-05, 8.6027e-05, 2.3384e-04,
        1.7279e-03, 4.6969e-03])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 91.42% 

Test Accuracy: 81.79% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7145506115630269
distance x is tensor(110.4609, device='cuda:1')
benign distance is  tensor(110.4609, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6494898963719606
distance x is tensor(103.8274, device='cuda:1')
benign distance is  tensor(103.8274, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8006106968969107
distance x is tensor(103.1733, device='cuda:1')
benign distance is  tensor(103.1733, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7662507686764002
distance x is tensor(146.6342, device='cuda:1')
benign distance is  tensor(146.6342, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8065701508894563
distance x is tensor(90.5175, device='cuda:1')
benign distance is  tensor(90.5175, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7107387725263834
distance x is tensor(101.6077, device='cuda:1')
benign distance is  tensor(101.6077, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3936614133417606
distance x is tensor(93.3957, device='cuda:1')
benign distance is  tensor(93.3957, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.624344764277339
distance x is tensor(81.8348, device='cuda:1')
benign distance is  tensor(81.8348, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 52
counter_tensor is  tensor([ 2., 12., 19., 51., 50., 35., 12.,  0., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 37., 45., 24., 49., 50., 21., 27., 34.,
        30., 13., 30., 13.,  2., 50.,  0., 33., 15., 12., 20., 13., 12.,  9.,
        14., 12., 12., 12., 15., 23., 12., 47., 34., 23.])
count_res tensor([2.3199e-22, 5.1099e-18, 5.6037e-15, 4.4248e-01, 1.6278e-01, 4.9795e-08,
        5.1099e-18, 3.1396e-23, 7.3902e-06, 7.3902e-06, 7.3902e-06, 7.3902e-06,
        7.3902e-06, 7.3902e-06, 7.3902e-06, 7.3902e-06, 7.3902e-06, 7.3902e-06,
        7.3902e-06, 7.3902e-06, 3.6794e-07, 1.0968e-03, 8.3166e-13, 5.9884e-02,
        1.6278e-01, 4.1406e-14, 1.6704e-11, 1.8319e-08, 3.3552e-10, 1.3890e-17,
        3.3552e-10, 1.3890e-17, 2.3199e-22, 1.6278e-01, 3.1396e-23, 6.7390e-09,
        1.0264e-16, 5.1099e-18, 1.5232e-14, 1.3890e-17, 5.1099e-18, 2.5441e-19,
        3.7757e-17, 5.1099e-18, 5.1099e-18, 5.1099e-18, 1.0264e-16, 3.0595e-13,
        5.1099e-18, 8.1044e-03, 1.8319e-08, 3.0595e-13])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 86.11% 

Test Accuracy: 86.70% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7936444375663996
distance x is tensor(118.5815, device='cuda:1')
benign distance is  tensor(118.5815, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7978833448141813
distance x is tensor(108.1329, device='cuda:1')
benign distance is  tensor(108.1329, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7947547826915979
distance x is tensor(105.8712, device='cuda:1')
benign distance is  tensor(105.8712, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8172373902052641
distance x is tensor(117.6956, device='cuda:1')
benign distance is  tensor(117.6956, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9974798811599612
distance x is tensor(86.5196, device='cuda:1')
benign distance is  tensor(86.5196, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7521662749350071
distance x is tensor(99.8529, device='cuda:1')
benign distance is  tensor(99.8529, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9762658718973398
distance x is tensor(100.0607, device='cuda:1')
benign distance is  tensor(100.0607, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6847350718453526
distance x is tensor(86.5346, device='cuda:1')
benign distance is  tensor(86.5346, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9062697673216462
distance x is tensor(91.6695, device='cuda:1')
benign distance is  tensor(91.6695, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6594865964725614
distance x is tensor(125.1506, device='cuda:1')
benign distance is  tensor(125.1506, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0400771033018827
distance x is tensor(63.9060, device='cuda:1')
benign distance is  tensor(63.9060, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2662084847688675
distance x is tensor(112.4799, device='cuda:1')
benign distance is  tensor(112.4799, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0768078994005919
distance x is tensor(166.0602, device='cuda:1')
benign distance is  tensor(166.0602, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6538631999865174
distance x is tensor(59.2825, device='cuda:1')
benign distance is  tensor(59.2825, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7536770459264517
distance x is tensor(136.0557, device='cuda:1')
benign distance is  tensor(136.0557, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3812985867261887
distance x is tensor(111.2993, device='cuda:1')
benign distance is  tensor(111.2993, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.034441988915205
distance x is tensor(101.1461, device='cuda:1')
benign distance is  tensor(101.1461, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7128465240821242
distance x is tensor(103.1880, device='cuda:1')
benign distance is  tensor(103.1880, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.7736461106687784
distance x is tensor(124.7198, device='cuda:1')
benign distance is  tensor(124.7198, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8272972274571657
distance x is tensor(112.1714, device='cuda:1')
benign distance is  tensor(112.1714, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0469444040209055
distance x is tensor(70.7722, device='cuda:1')
benign distance is  tensor(70.7722, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7724945656955242
distance x is tensor(200.1715, device='cuda:1')
benign distance is  tensor(200.1715, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.23512988910079
distance x is tensor(145.5365, device='cuda:1')
benign distance is  tensor(145.5365, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.63360427133739
distance x is tensor(107.7795, device='cuda:1')
benign distance is  tensor(107.7795, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9985013715922832
distance x is tensor(115.7004, device='cuda:1')
benign distance is  tensor(115.7004, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6502588298171759
distance x is tensor(69.6390, device='cuda:1')
benign distance is  tensor(69.6390, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8690470363944769
distance x is tensor(130.3037, device='cuda:1')
benign distance is  tensor(130.3037, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2462481036782265
distance x is tensor(108.1705, device='cuda:1')
benign distance is  tensor(108.1705, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9087942857295275
distance x is tensor(111.3390, device='cuda:1')
benign distance is  tensor(111.3390, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9088812414556742
distance x is tensor(88.0499, device='cuda:1')
benign distance is  tensor(88.0499, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5757406912744045
distance x is tensor(125.7739, device='cuda:1')
benign distance is  tensor(125.7739, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7522640526294708
distance x is tensor(167.4030, device='cuda:1')
benign distance is  tensor(167.4030, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.210268510505557
distance x is tensor(103.0894, device='cuda:1')
benign distance is  tensor(103.0894, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.1643912829458714
distance x is tensor(138.1939, device='cuda:1')
benign distance is  tensor(138.1939, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.228633463382721
distance x is tensor(138.0034, device='cuda:1')
benign distance is  tensor(138.0034, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.3138820305466652
distance x is tensor(95.1886, device='cuda:1')
benign distance is  tensor(95.1886, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6082477513700724
distance x is tensor(142.5889, device='cuda:1')
benign distance is  tensor(142.5889, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.831714078783989
distance x is tensor(134.4646, device='cuda:1')
benign distance is  tensor(134.4646, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7714947201311588
distance x is tensor(103.5217, device='cuda:1')
benign distance is  tensor(103.5217, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6184499952942133
distance x is tensor(121.1378, device='cuda:1')
benign distance is  tensor(121.1378, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 13., 12., 12., 12., 12., 12., 12., 11., 16., 16.,  8.,  8.,  8.,
         8.,  8.,  9.,  9., 10., 12.])
count_res tensor([8.2913e-03, 2.2538e-02, 8.2913e-03, 8.2913e-03, 8.2913e-03, 8.2913e-03,
        8.2913e-03, 8.2913e-03, 3.0502e-03, 4.5269e-01, 4.5269e-01, 1.5186e-04,
        1.5186e-04, 1.5186e-04, 1.5186e-04, 1.5186e-04, 4.1280e-04, 4.1280e-04,
        1.1221e-03, 8.2913e-03])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 83.27% 

Test Accuracy: 84.65% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6489960923790932
distance x is tensor(110.8209, device='cuda:1')
benign distance is  tensor(110.8209, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7790970262140036
distance x is tensor(97.8700, device='cuda:1')
benign distance is  tensor(97.8700, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7553568929433823
distance x is tensor(96.0310, device='cuda:1')
benign distance is  tensor(96.0310, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9426008891314268
distance x is tensor(110.6192, device='cuda:1')
benign distance is  tensor(110.6192, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9914514627307653
distance x is tensor(74.4913, device='cuda:1')
benign distance is  tensor(74.4913, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.694775341078639
distance x is tensor(93.6552, device='cuda:1')
benign distance is  tensor(93.6552, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9510860331356525
distance x is tensor(91.5998, device='cuda:1')
benign distance is  tensor(91.5998, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6955649368464947
distance x is tensor(84.1127, device='cuda:1')
benign distance is  tensor(84.1127, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 15.,  9., 12., 14., 26., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 17., 12., 13., 12., 13., 12., 25.])
count_res tensor([6.0758e-07, 1.2204e-05, 3.0250e-08, 6.0758e-07, 4.4895e-06, 7.3068e-01,
        6.0758e-07, 6.0758e-07, 3.3173e-05, 3.3173e-05, 3.3173e-05, 3.3173e-05,
        3.3173e-05, 3.3173e-05, 3.3173e-05, 3.3173e-05, 3.3173e-05, 3.3173e-05,
        3.3173e-05, 3.3173e-05, 6.0758e-07, 9.0173e-05, 6.0758e-07, 1.6516e-06,
        6.0758e-07, 1.6516e-06, 6.0758e-07, 2.6880e-01])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 83.32% 

Test Accuracy: 84.75% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6150673050433397
distance x is tensor(120.6296, device='cuda:1')
benign distance is  tensor(120.6296, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0857174806296825
distance x is tensor(114.8192, device='cuda:1')
benign distance is  tensor(114.8192, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8413778655230999
distance x is tensor(114.3017, device='cuda:1')
benign distance is  tensor(114.3017, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0862811245024204
distance x is tensor(142.0692, device='cuda:1')
benign distance is  tensor(142.0692, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9225132372230291
distance x is tensor(99.8641, device='cuda:1')
benign distance is  tensor(99.8641, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6699611619114876
distance x is tensor(86.9672, device='cuda:1')
benign distance is  tensor(86.9672, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.050589468330145
distance x is tensor(116.4591, device='cuda:1')
benign distance is  tensor(116.4591, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7557865809649229
distance x is tensor(96.9171, device='cuda:1')
benign distance is  tensor(96.9171, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1041150745004416
distance x is tensor(112.9827, device='cuda:1')
benign distance is  tensor(112.9827, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7290265671908855
distance x is tensor(125.9796, device='cuda:1')
benign distance is  tensor(125.9796, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1886386685073376
distance x is tensor(70.1376, device='cuda:1')
benign distance is  tensor(70.1376, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.259104572236538
distance x is tensor(126.2887, device='cuda:1')
benign distance is  tensor(126.2887, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.059277780354023
distance x is tensor(164.5894, device='cuda:1')
benign distance is  tensor(164.5894, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7089705057442188
distance x is tensor(74.6700, device='cuda:1')
benign distance is  tensor(74.6700, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0660630352795124
distance x is tensor(135.6479, device='cuda:1')
benign distance is  tensor(135.6479, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.4191364236176014
distance x is tensor(117.0919, device='cuda:1')
benign distance is  tensor(117.0919, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([12., 12.,  0., 12., 28.,  0., 15., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 33., 12., 24., 34., 22., 12., 12., 15.,
        12., 12., 21., 21., 12., 30., 21., 12.])
count_res tensor([2.0079e-10, 2.0079e-10, 1.2337e-15, 2.0079e-10, 1.7842e-03, 1.2337e-15,
        4.0329e-09, 2.0079e-10, 3.2679e-05, 3.2679e-05, 3.2679e-05, 3.2679e-05,
        3.2679e-05, 3.2679e-05, 3.2679e-05, 3.2679e-05, 3.2679e-05, 3.2679e-05,
        3.2679e-05, 3.2679e-05, 2.6480e-01, 2.0079e-10, 3.2679e-05, 7.1980e-01,
        4.4226e-06, 2.0079e-10, 2.0079e-10, 4.0329e-09, 2.0079e-10, 2.0079e-10,
        1.6270e-06, 1.6270e-06, 2.0079e-10, 1.3184e-02, 1.6270e-06, 2.0079e-10])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 78.71% 

Test Accuracy: 78.64% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7976589575409889
distance x is tensor(137.4388, device='cuda:1')
benign distance is  tensor(137.4388, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8408213723450899
distance x is tensor(114.1626, device='cuda:1')
benign distance is  tensor(114.1626, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7769192270934582
distance x is tensor(113.6734, device='cuda:1')
benign distance is  tensor(113.6734, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8928634077310562
distance x is tensor(159.5116, device='cuda:1')
benign distance is  tensor(159.5116, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7104383986443281
distance x is tensor(97.1061, device='cuda:1')
benign distance is  tensor(97.1061, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6551589807495475
distance x is tensor(118.3008, device='cuda:1')
benign distance is  tensor(118.3008, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2967378236353397
distance x is tensor(104.3480, device='cuda:1')
benign distance is  tensor(104.3480, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6233083186671138
distance x is tensor(104.0406, device='cuda:1')
benign distance is  tensor(104.0406, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.3892141208052635
distance x is tensor(129.6451, device='cuda:1')
benign distance is  tensor(129.6451, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.758199755102396
distance x is tensor(122.4433, device='cuda:1')
benign distance is  tensor(122.4433, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.0752861481159925
distance x is tensor(133.6073, device='cuda:1')
benign distance is  tensor(133.6073, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8029663134366274
distance x is tensor(122.4527, device='cuda:1')
benign distance is  tensor(122.4527, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.005913957953453
distance x is tensor(84.2577, device='cuda:1')
benign distance is  tensor(84.2577, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7284069880843163
distance x is tensor(198.7097, device='cuda:1')
benign distance is  tensor(198.7097, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0903773922473192
distance x is tensor(148.0616, device='cuda:1')
benign distance is  tensor(148.0616, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7844896726310253
distance x is tensor(125.9057, device='cuda:1')
benign distance is  tensor(125.9057, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8504640143364668
distance x is tensor(118.4237, device='cuda:1')
benign distance is  tensor(118.4237, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.7377969101071358
distance x is tensor(98.8140, device='cuda:1')
benign distance is  tensor(98.8140, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6454385844990611
distance x is tensor(145.3693, device='cuda:1')
benign distance is  tensor(145.3693, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.3623440228402615
distance x is tensor(97.4314, device='cuda:1')
benign distance is  tensor(97.4314, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8277105763554573
distance x is tensor(105.8176, device='cuda:1')
benign distance is  tensor(105.8176, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8296924941241741
distance x is tensor(102.6434, device='cuda:1')
benign distance is  tensor(102.6434, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7344434084370732
distance x is tensor(98.5687, device='cuda:1')
benign distance is  tensor(98.5687, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8014300521463156
distance x is tensor(140.0807, device='cuda:1')
benign distance is  tensor(140.0807, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([13., 18.,  7.,  3.,  0., 22., 13., 13., 24., 24., 23., 23., 23., 23.,
        23., 23., 23., 23., 23., 23., 33., 19., 13., 35., 12., 13., 12., 15.,
        21., 12., 33., 28., 16., 13., 29., 13.])
count_res tensor([2.1893e-10, 3.2492e-08, 5.4266e-13, 9.9392e-15, 4.9485e-16, 1.7740e-06,
        2.1893e-10, 2.1893e-10, 1.3108e-05, 1.3108e-05, 4.8222e-06, 4.8222e-06,
        4.8222e-06, 4.8222e-06, 4.8222e-06, 4.8222e-06, 4.8222e-06, 4.8222e-06,
        4.8222e-06, 4.8222e-06, 1.0622e-01, 8.8321e-08, 2.1893e-10, 7.8483e-01,
        8.0538e-11, 2.1893e-10, 8.0538e-11, 1.6177e-09, 6.5261e-07, 8.0538e-11,
        1.0622e-01, 7.1567e-04, 4.3972e-09, 2.1893e-10, 1.9454e-03, 2.1893e-10])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 73.40% 

Test Accuracy: 79.02% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7771536018699408
distance x is tensor(115.4328, device='cuda:1')
benign distance is  tensor(115.4328, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9265471212565899
distance x is tensor(115.4072, device='cuda:1')
benign distance is  tensor(115.4072, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.811816830188036
distance x is tensor(131.5788, device='cuda:1')
benign distance is  tensor(131.5788, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0204876512289047
distance x is tensor(141.9620, device='cuda:1')
benign distance is  tensor(141.9620, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8416613200679421
distance x is tensor(94.6357, device='cuda:1')
benign distance is  tensor(94.6357, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7156386752612889
distance x is tensor(114.7060, device='cuda:1')
benign distance is  tensor(114.7060, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0243260068818927
distance x is tensor(103.3206, device='cuda:1')
benign distance is  tensor(103.3206, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7413678485900164
distance x is tensor(98.5907, device='cuda:1')
benign distance is  tensor(98.5907, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1824278868734837
distance x is tensor(114.1309, device='cuda:1')
benign distance is  tensor(114.1309, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7763079227879643
distance x is tensor(122.8947, device='cuda:1')
benign distance is  tensor(122.8947, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2711245696991682
distance x is tensor(56.8199, device='cuda:1')
benign distance is  tensor(56.8199, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.788058988749981
distance x is tensor(109.7564, device='cuda:1')
benign distance is  tensor(109.7564, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9024700801819563
distance x is tensor(158.1364, device='cuda:1')
benign distance is  tensor(158.1364, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.713835621252656
distance x is tensor(79.2172, device='cuda:1')
benign distance is  tensor(79.2172, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9872145075351
distance x is tensor(142.6177, device='cuda:1')
benign distance is  tensor(142.6177, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.4512509889900684
distance x is tensor(118.1480, device='cuda:1')
benign distance is  tensor(118.1480, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.278283704072237
distance x is tensor(117.4519, device='cuda:1')
benign distance is  tensor(117.4519, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7551237586885691
distance x is tensor(90.6239, device='cuda:1')
benign distance is  tensor(90.6239, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.955537723377347
distance x is tensor(132.9963, device='cuda:1')
benign distance is  tensor(132.9963, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.3732884302735329
distance x is tensor(70.7011, device='cuda:1')
benign distance is  tensor(70.7011, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8553719110786915
distance x is tensor(124.9568, device='cuda:1')
benign distance is  tensor(124.9568, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8657852616161108
distance x is tensor(115.4724, device='cuda:1')
benign distance is  tensor(115.4724, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5458275312557817
distance x is tensor(131.8062, device='cuda:1')
benign distance is  tensor(131.8062, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.1584117878228426
distance x is tensor(173.6196, device='cuda:1')
benign distance is  tensor(173.6196, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([16., 17., 17., 16., 15., 14., 14., 15., 18., 11., 11.,  6.,  6.,  3.,
         5.,  6.,  6.,  6.,  9.,  9.])
count_res tensor([6.3101e-02, 1.7153e-01, 1.7153e-01, 6.3101e-02, 2.3214e-02, 8.5398e-03,
        8.5398e-03, 2.3214e-02, 4.6626e-01, 4.2517e-04, 4.2517e-04, 2.8648e-06,
        2.8648e-06, 1.4263e-07, 1.0539e-06, 2.8648e-06, 2.8648e-06, 2.8648e-06,
        5.7541e-05, 5.7541e-05])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 79.56% 

Test Accuracy: 82.78% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7323311641812325
distance x is tensor(116.0611, device='cuda:1')
benign distance is  tensor(116.0611, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7902713529765606
distance x is tensor(89.2653, device='cuda:1')
benign distance is  tensor(89.2653, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7657618410885334
distance x is tensor(99.9355, device='cuda:1')
benign distance is  tensor(99.9355, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0818837620317936
distance x is tensor(132.9112, device='cuda:1')
benign distance is  tensor(132.9112, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8118782369419932
distance x is tensor(81.1353, device='cuda:1')
benign distance is  tensor(81.1353, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7721523684449494
distance x is tensor(94.6180, device='cuda:1')
benign distance is  tensor(94.6180, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0877208858728409
distance x is tensor(85.0358, device='cuda:1')
benign distance is  tensor(85.0358, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7438622517511249
distance x is tensor(86.4857, device='cuda:1')
benign distance is  tensor(86.4857, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 44
counter_tensor is  tensor([15., 13., 21.,  1., 12., 12.,  1., 22., 31., 31., 31., 31., 31., 31.,
        31., 31., 31., 31., 31., 31.,  1., 30., 23., 43., 14., 12., 29., 14.,
        21., 16., 20., 29., 13., 39., 43., 13., 22., 12., 15., 28., 26., 42.,
        25., 13.])
count_res tensor([2.8976e-13, 3.9214e-14, 1.1690e-10, 2.4094e-19, 1.4426e-14, 1.4426e-14,
        2.4094e-19, 3.1776e-10, 2.5748e-06, 2.5748e-06, 2.5748e-06, 2.5748e-06,
        2.5748e-06, 2.5748e-06, 2.5748e-06, 2.5748e-06, 2.5748e-06, 2.5748e-06,
        2.5748e-06, 2.5748e-06, 2.4094e-19, 9.4722e-07, 8.6375e-10, 4.1906e-01,
        1.0660e-13, 1.4426e-14, 3.4846e-07, 1.0660e-13, 1.1690e-10, 7.8764e-13,
        4.3004e-11, 3.4846e-07, 3.9214e-14, 7.6754e-03, 4.1906e-01, 3.9214e-14,
        3.1776e-10, 1.4426e-14, 2.8976e-13, 1.2819e-07, 1.7349e-08, 1.5416e-01,
        6.3823e-09, 3.9214e-14])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 82.95% 

Test Accuracy: 83.80% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6659295707941055
distance x is tensor(120.5463, device='cuda:1')
benign distance is  tensor(120.5463, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7100266441702843
distance x is tensor(100.1996, device='cuda:1')
benign distance is  tensor(100.1996, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7560141608119011
distance x is tensor(112.5719, device='cuda:1')
benign distance is  tensor(112.5719, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8565745465457439
distance x is tensor(129.2870, device='cuda:1')
benign distance is  tensor(129.2870, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8176048370078206
distance x is tensor(91.2505, device='cuda:1')
benign distance is  tensor(91.2505, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7087173387408257
distance x is tensor(98.9101, device='cuda:1')
benign distance is  tensor(98.9101, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0841730758547783
distance x is tensor(105.3059, device='cuda:1')
benign distance is  tensor(105.3059, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6286169141530991
distance x is tensor(92.2688, device='cuda:1')
benign distance is  tensor(92.2688, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9801892172545195
distance x is tensor(85.7622, device='cuda:1')
benign distance is  tensor(85.7622, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.1290705502033234
distance x is tensor(131.1642, device='cuda:1')
benign distance is  tensor(131.1642, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2080755904316902
distance x is tensor(77.3463, device='cuda:1')
benign distance is  tensor(77.3463, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.235808253288269
distance x is tensor(116.0864, device='cuda:1')
benign distance is  tensor(116.0864, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9703845307230949
distance x is tensor(156.8066, device='cuda:1')
benign distance is  tensor(156.8066, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7411630135029554
distance x is tensor(55.4627, device='cuda:1')
benign distance is  tensor(55.4627, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0808836072683334
distance x is tensor(128.8278, device='cuda:1')
benign distance is  tensor(128.8278, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.294813547283411
distance x is tensor(123.4425, device='cuda:1')
benign distance is  tensor(123.4425, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.0386224631220102
distance x is tensor(93.2616, device='cuda:1')
benign distance is  tensor(93.2616, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8234634008258581
distance x is tensor(111.1799, device='cuda:1')
benign distance is  tensor(111.1799, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9167245794087648
distance x is tensor(115.5138, device='cuda:1')
benign distance is  tensor(115.5138, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.0563181787729263
distance x is tensor(117.2618, device='cuda:1')
benign distance is  tensor(117.2618, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9197915606200695
distance x is tensor(73.9012, device='cuda:1')
benign distance is  tensor(73.9012, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7862304076552391
distance x is tensor(201.0354, device='cuda:1')
benign distance is  tensor(201.0354, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1684725880622864
distance x is tensor(125.1630, device='cuda:1')
benign distance is  tensor(125.1630, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7735270652920008
distance x is tensor(108.1419, device='cuda:1')
benign distance is  tensor(108.1419, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.3350237272679806
distance x is tensor(97.4466, device='cuda:1')
benign distance is  tensor(97.4466, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.0789372250437737
distance x is tensor(192.7798, device='cuda:1')
benign distance is  tensor(192.7798, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.948682202026248
distance x is tensor(142.7831, device='cuda:1')
benign distance is  tensor(142.7831, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.2355333231389523
distance x is tensor(67.6220, device='cuda:1')
benign distance is  tensor(67.6220, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7240198962390423
distance x is tensor(149.8747, device='cuda:1')
benign distance is  tensor(149.8747, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8248402811586857
distance x is tensor(129.6115, device='cuda:1')
benign distance is  tensor(129.6115, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9293372631072998
distance x is tensor(103.0712, device='cuda:1')
benign distance is  tensor(103.0712, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6396236130967736
distance x is tensor(130.8076, device='cuda:1')
benign distance is  tensor(130.8076, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 17., 16.,  8.,  8.,  8.,
         8.,  8.,  8.,  9., 11., 12.])
count_res tensor([4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03,
        4.6969e-03, 4.6969e-03, 1.7279e-03, 6.9708e-01, 2.5644e-01, 8.6027e-05,
        8.6027e-05, 8.6027e-05, 8.6027e-05, 8.6027e-05, 8.6027e-05, 2.3384e-04,
        1.7279e-03, 4.6969e-03])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 78.19% 

Test Accuracy: 79.17% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.695704453624785
distance x is tensor(110.1972, device='cuda:1')
benign distance is  tensor(110.1972, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8818897493183613
distance x is tensor(99.2789, device='cuda:1')
benign distance is  tensor(99.2789, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7183307837694883
distance x is tensor(107.7235, device='cuda:1')
benign distance is  tensor(107.7235, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8372629191726446
distance x is tensor(128.6489, device='cuda:1')
benign distance is  tensor(128.6489, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.946393322199583
distance x is tensor(81.4841, device='cuda:1')
benign distance is  tensor(81.4841, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6449245465919375
distance x is tensor(95.6459, device='cuda:1')
benign distance is  tensor(95.6459, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1474083475768566
distance x is tensor(91.4630, device='cuda:1')
benign distance is  tensor(91.4630, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6109012337401509
distance x is tensor(87.5956, device='cuda:1')
benign distance is  tensor(87.5956, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 44
counter_tensor is  tensor([12., 43., 42.,  0., 40.,  0., 32., 43., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 12.,  0.,  4., 12., 33., 12., 12.,  0.,
        43., 34., 13., 12., 12.,  3., 25.,  2., 43., 34., 34., 13., 12., 40.,
        12.,  0.])
count_res tensor([7.7046e-15, 2.2381e-01, 8.2335e-02, 4.7339e-20, 1.1143e-02, 4.7339e-20,
        3.7380e-06, 2.2381e-01, 3.7380e-06, 3.7380e-06, 3.7380e-06, 3.7380e-06,
        3.7380e-06, 3.7380e-06, 3.7380e-06, 3.7380e-06, 3.7380e-06, 3.7380e-06,
        3.7380e-06, 3.7380e-06, 7.7046e-15, 4.7339e-20, 2.5846e-18, 7.7046e-15,
        1.0161e-05, 7.7046e-15, 7.7046e-15, 4.7339e-20, 2.2381e-01, 2.7620e-05,
        2.0943e-14, 7.7046e-15, 7.7046e-15, 9.5082e-19, 3.4086e-09, 3.4979e-19,
        2.2381e-01, 2.7620e-05, 2.7620e-05, 2.0943e-14, 7.7046e-15, 1.1143e-02,
        7.7046e-15, 4.7339e-20])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 78.13% 

Test Accuracy: 85.01% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6321201417595148
distance x is tensor(115.8606, device='cuda:1')
benign distance is  tensor(115.8606, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7817403301596642
distance x is tensor(90.1366, device='cuda:1')
benign distance is  tensor(90.1366, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7536950260400772
distance x is tensor(103.9910, device='cuda:1')
benign distance is  tensor(103.9910, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0631205849349499
distance x is tensor(128.9398, device='cuda:1')
benign distance is  tensor(128.9398, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9437702149152756
distance x is tensor(80.4777, device='cuda:1')
benign distance is  tensor(80.4777, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7489719493314624
distance x is tensor(96.3200, device='cuda:1')
benign distance is  tensor(96.3200, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4424124136567116
distance x is tensor(89.1561, device='cuda:1')
benign distance is  tensor(89.1561, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.77464977838099
distance x is tensor(81.6515, device='cuda:1')
benign distance is  tensor(81.6515, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0732591859996319
distance x is tensor(71.6140, device='cuda:1')
benign distance is  tensor(71.6140, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.739381252322346
distance x is tensor(114.2581, device='cuda:1')
benign distance is  tensor(114.2581, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.057414148002863
distance x is tensor(64.4455, device='cuda:1')
benign distance is  tensor(64.4455, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2781366184353828
distance x is tensor(106.0142, device='cuda:1')
benign distance is  tensor(106.0142, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0008830279111862
distance x is tensor(155.1011, device='cuda:1')
benign distance is  tensor(155.1011, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7700014691799879
distance x is tensor(50.9529, device='cuda:1')
benign distance is  tensor(50.9529, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.966485895216465
distance x is tensor(130.1884, device='cuda:1')
benign distance is  tensor(130.1884, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3457876089960337
distance x is tensor(105.4488, device='cuda:1')
benign distance is  tensor(105.4488, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.2525235526263714
distance x is tensor(94.6940, device='cuda:1')
benign distance is  tensor(94.6940, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7854867745190859
distance x is tensor(74.0753, device='cuda:1')
benign distance is  tensor(74.0753, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.973655829206109
distance x is tensor(124.0661, device='cuda:1')
benign distance is  tensor(124.0661, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.3852171935141087
distance x is tensor(95.0984, device='cuda:1')
benign distance is  tensor(95.0984, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9271547179669142
distance x is tensor(104.8743, device='cuda:1')
benign distance is  tensor(104.8743, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.805860411375761
distance x is tensor(89.9972, device='cuda:1')
benign distance is  tensor(89.9972, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5752950832247734
distance x is tensor(118.6804, device='cuda:1')
benign distance is  tensor(118.6804, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7073059063404799
distance x is tensor(160.2445, device='cuda:1')
benign distance is  tensor(160.2445, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7122132983058691
distance x is tensor(115.2050, device='cuda:1')
benign distance is  tensor(115.2050, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.8662815578281879
distance x is tensor(84.5093, device='cuda:1')
benign distance is  tensor(84.5093, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6537851914763451
distance x is tensor(141.2477, device='cuda:1')
benign distance is  tensor(141.2477, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.431279979646206
distance x is tensor(105.6034, device='cuda:1')
benign distance is  tensor(105.6034, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6393058728426695
distance x is tensor(96.1536, device='cuda:1')
benign distance is  tensor(96.1536, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8810706045478582
distance x is tensor(88.6568, device='cuda:1')
benign distance is  tensor(88.6568, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7476209588348866
distance x is tensor(88.2085, device='cuda:1')
benign distance is  tensor(88.2085, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.6374926622956991
distance x is tensor(111.5632, device='cuda:1')
benign distance is  tensor(111.5632, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([15., 15., 14., 15., 15., 14., 26., 15., 12., 13., 13., 13., 13., 13.,
        13., 13., 13., 13., 13., 13., 15., 16.,  4., 27., 15., 27., 17., 15.])
count_res tensor([2.5947e-06, 2.5947e-06, 9.5453e-07, 2.5947e-06, 2.5947e-06, 9.5453e-07,
        1.5535e-01, 2.5947e-06, 1.2918e-07, 3.5115e-07, 3.5115e-07, 3.5115e-07,
        3.5115e-07, 3.5115e-07, 3.5115e-07, 3.5115e-07, 3.5115e-07, 3.5115e-07,
        3.5115e-07, 3.5115e-07, 2.5947e-06, 7.0531e-06, 4.3336e-11, 4.2230e-01,
        2.5947e-06, 4.2230e-01, 1.9172e-05, 2.5947e-06])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 74.76% 

Test Accuracy: 82.43% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6467923410236835
distance x is tensor(139.5071, device='cuda:1')
benign distance is  tensor(139.5071, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9678280279040337
distance x is tensor(103.2279, device='cuda:1')
benign distance is  tensor(103.2279, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7221613675355911
distance x is tensor(105.1832, device='cuda:1')
benign distance is  tensor(105.1832, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0457605570554733
distance x is tensor(139.6133, device='cuda:1')
benign distance is  tensor(139.6133, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.864734023809433
distance x is tensor(102.3468, device='cuda:1')
benign distance is  tensor(102.3468, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7286946848034859
distance x is tensor(102.7375, device='cuda:1')
benign distance is  tensor(102.7375, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3363817762583494
distance x is tensor(92.1209, device='cuda:1')
benign distance is  tensor(92.1209, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7199450340121984
distance x is tensor(89.7922, device='cuda:1')
benign distance is  tensor(89.7922, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.206871472299099
distance x is tensor(114.2808, device='cuda:1')
benign distance is  tensor(114.2808, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7816097047179937
distance x is tensor(110.4891, device='cuda:1')
benign distance is  tensor(110.4891, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9197706934064627
distance x is tensor(115.2816, device='cuda:1')
benign distance is  tensor(115.2816, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.0932911019772291
distance x is tensor(89.9632, device='cuda:1')
benign distance is  tensor(89.9632, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0829761326313019
distance x is tensor(78.7483, device='cuda:1')
benign distance is  tensor(78.7483, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9623200688511133
distance x is tensor(196.7919, device='cuda:1')
benign distance is  tensor(196.7919, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.3280800469219685
distance x is tensor(134.0954, device='cuda:1')
benign distance is  tensor(134.0954, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6853685220703483
distance x is tensor(109.3029, device='cuda:1')
benign distance is  tensor(109.3029, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 26.,  0., 14., 12., 12., 13., 12., 15., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 25., 12., 12., 15., 12., 27., 14., 12.])
count_res tensor([2.0347e-07, 2.4470e-01, 1.2502e-12, 1.5035e-06, 2.0347e-07, 2.0347e-07,
        5.5309e-07, 2.0347e-07, 4.0868e-06, 1.1109e-05, 1.1109e-05, 1.1109e-05,
        1.1109e-05, 1.1109e-05, 1.1109e-05, 1.1109e-05, 1.1109e-05, 1.1109e-05,
        1.1109e-05, 1.1109e-05, 9.0018e-02, 2.0347e-07, 2.0347e-07, 4.0868e-06,
        2.0347e-07, 6.6515e-01, 1.5035e-06, 2.0347e-07])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 76.20% 

Test Accuracy: 83.45% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7843053098767996
distance x is tensor(112.1905, device='cuda:1')
benign distance is  tensor(112.1905, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7485816138796508
distance x is tensor(80.9560, device='cuda:1')
benign distance is  tensor(80.9560, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7159791756421328
distance x is tensor(109.4591, device='cuda:1')
benign distance is  tensor(109.4591, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9401280954480171
distance x is tensor(140.7962, device='cuda:1')
benign distance is  tensor(140.7962, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0016794353723526
distance x is tensor(92.9679, device='cuda:1')
benign distance is  tensor(92.9679, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7908063605427742
distance x is tensor(106.5374, device='cuda:1')
benign distance is  tensor(106.5374, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.291534423828125
distance x is tensor(93.8993, device='cuda:1')
benign distance is  tensor(93.8993, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6546900188550353
distance x is tensor(84.5185, device='cuda:1')
benign distance is  tensor(84.5185, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.2194627821445465
distance x is tensor(90.5393, device='cuda:1')
benign distance is  tensor(90.5393, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7937939027324319
distance x is tensor(115.3874, device='cuda:1')
benign distance is  tensor(115.3874, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0336578264832497
distance x is tensor(69.6273, device='cuda:1')
benign distance is  tensor(69.6273, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.5161806680262089
distance x is tensor(117.1106, device='cuda:1')
benign distance is  tensor(117.1106, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1986290886998177
distance x is tensor(158.0706, device='cuda:1')
benign distance is  tensor(158.0706, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8665469419211149
distance x is tensor(28.1978, device='cuda:1')
benign distance is  tensor(28.1978, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8530779257416725
distance x is tensor(143.2395, device='cuda:1')
benign distance is  tensor(143.2395, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.313960701227188
distance x is tensor(132.6390, device='cuda:1')
benign distance is  tensor(132.6390, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([15., 15., 15., 15., 15., 15., 14., 14., 11., 13., 15.,  6.,  5.,  8.,
         5.,  5.,  7.,  7.,  9., 11.])
count_res tensor([1.2639e-01, 1.2639e-01, 1.2639e-01, 1.2639e-01, 1.2639e-01, 1.2639e-01,
        4.6496e-02, 4.6496e-02, 2.3149e-03, 1.7105e-02, 1.2639e-01, 1.5598e-05,
        5.7381e-06, 1.1525e-04, 5.7381e-06, 5.7381e-06, 4.2399e-05, 4.2399e-05,
        3.1329e-04, 2.3149e-03])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 83.94% 

Test Accuracy: 86.60% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6655040271580219
distance x is tensor(105.3847, device='cuda:1')
benign distance is  tensor(105.3847, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7329336414113641
distance x is tensor(90.1841, device='cuda:1')
benign distance is  tensor(90.1841, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.617921537719667
distance x is tensor(101.4016, device='cuda:1')
benign distance is  tensor(101.4016, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9185355976223946
distance x is tensor(123.3061, device='cuda:1')
benign distance is  tensor(123.3061, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8582686795853078
distance x is tensor(81.2014, device='cuda:1')
benign distance is  tensor(81.2014, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7468025339767337
distance x is tensor(102.0219, device='cuda:1')
benign distance is  tensor(102.0219, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.092257048934698
distance x is tensor(99.6660, device='cuda:1')
benign distance is  tensor(99.6660, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8391574863344431
distance x is tensor(76.9031, device='cuda:1')
benign distance is  tensor(76.9031, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 52
counter_tensor is  tensor([12., 21., 35.,  2.,  0., 11., 12., 15., 37., 37., 37., 37., 37., 37.,
        37., 37., 37., 37., 37., 37., 51., 23., 29., 51., 11., 51., 37., 27.,
        18., 36., 51., 16.,  0., 16., 28., 44., 50., 14., 31., 15., 16., 15.,
        47.,  0., 37., 25., 16., 14.,  1., 49., 16., 17.])
count_res tensor([2.5535e-18, 2.0691e-14, 2.4884e-08, 1.1593e-22, 1.5689e-23, 9.3939e-19,
        2.5535e-18, 5.1289e-17, 1.8387e-07, 1.8387e-07, 1.8387e-07, 1.8387e-07,
        1.8387e-07, 1.8387e-07, 1.8387e-07, 1.8387e-07, 1.8387e-07, 1.8387e-07,
        1.8387e-07, 1.8387e-07, 2.2112e-01, 1.5289e-13, 6.1680e-11, 2.2112e-01,
        9.3939e-19, 2.2112e-01, 1.8387e-07, 8.3475e-12, 1.0302e-15, 6.7641e-08,
        2.2112e-01, 1.3942e-16, 1.5689e-23, 1.3942e-16, 2.2691e-11, 2.0163e-04,
        8.1345e-02, 1.8868e-17, 4.5576e-10, 5.1289e-17, 1.3942e-16, 5.1289e-17,
        4.0499e-03, 1.5689e-23, 1.8387e-07, 1.1297e-12, 1.3942e-16, 1.8868e-17,
        4.2648e-23, 2.9925e-02, 1.3942e-16, 3.7898e-16])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 77.14% 

Test Accuracy: 84.52% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5944228954613209
distance x is tensor(121.2882, device='cuda:1')
benign distance is  tensor(121.2882, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7909574676305056
distance x is tensor(97.6866, device='cuda:1')
benign distance is  tensor(97.6866, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7854223791509867
distance x is tensor(104.3715, device='cuda:1')
benign distance is  tensor(104.3715, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9134497717022896
distance x is tensor(136.3619, device='cuda:1')
benign distance is  tensor(136.3619, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8383787460625172
distance x is tensor(101.0525, device='cuda:1')
benign distance is  tensor(101.0525, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8667144980281591
distance x is tensor(103.6210, device='cuda:1')
benign distance is  tensor(103.6210, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9727828502655029
distance x is tensor(90.3683, device='cuda:1')
benign distance is  tensor(90.3683, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7946143858134747
distance x is tensor(90.8618, device='cuda:1')
benign distance is  tensor(90.8618, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9961488526314497
distance x is tensor(86.6801, device='cuda:1')
benign distance is  tensor(86.6801, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7409277758561075
distance x is tensor(109.6244, device='cuda:1')
benign distance is  tensor(109.6244, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.190886002033949
distance x is tensor(73.3490, device='cuda:1')
benign distance is  tensor(73.3490, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.845781646668911
distance x is tensor(118.3440, device='cuda:1')
benign distance is  tensor(118.3440, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0249783117324114
distance x is tensor(152.2625, device='cuda:1')
benign distance is  tensor(152.2625, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8126548798754811
distance x is tensor(57.2157, device='cuda:1')
benign distance is  tensor(57.2157, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0312033519148827
distance x is tensor(131.1757, device='cuda:1')
benign distance is  tensor(131.1757, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3399388007819653
distance x is tensor(114.5764, device='cuda:1')
benign distance is  tensor(114.5764, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1213711462914944
distance x is tensor(100.0587, device='cuda:1')
benign distance is  tensor(100.0587, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7937332112342119
distance x is tensor(106.1771, device='cuda:1')
benign distance is  tensor(106.1771, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.7322780210524797
distance x is tensor(111.4812, device='cuda:1')
benign distance is  tensor(111.4812, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8816822320222855
distance x is tensor(103.7998, device='cuda:1')
benign distance is  tensor(103.7998, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.8890232602134347
distance x is tensor(80.6372, device='cuda:1')
benign distance is  tensor(80.6372, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8690491914749146
distance x is tensor(197.8379, device='cuda:1')
benign distance is  tensor(197.8379, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.044611781835556
distance x is tensor(128.0543, device='cuda:1')
benign distance is  tensor(128.0543, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7176910154521465
distance x is tensor(111.7129, device='cuda:1')
benign distance is  tensor(111.7129, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.0015637874603271
distance x is tensor(112.7422, device='cuda:1')
benign distance is  tensor(112.7422, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6922171358019114
distance x is tensor(67.8374, device='cuda:1')
benign distance is  tensor(67.8374, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8605425357818604
distance x is tensor(117.9207, device='cuda:1')
benign distance is  tensor(117.9207, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2329352535307407
distance x is tensor(103.1321, device='cuda:1')
benign distance is  tensor(103.1321, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7328633293509483
distance x is tensor(112.9234, device='cuda:1')
benign distance is  tensor(112.9234, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8363177124410868
distance x is tensor(94.2278, device='cuda:1')
benign distance is  tensor(94.2278, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4791589751839638
distance x is tensor(115.0920, device='cuda:1')
benign distance is  tensor(115.0920, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.8372483905404806
distance x is tensor(160.9353, device='cuda:1')
benign distance is  tensor(160.9353, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.3917845115065575
distance x is tensor(81.8199, device='cuda:1')
benign distance is  tensor(81.8199, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.2099641002714634
distance x is tensor(145.0909, device='cuda:1')
benign distance is  tensor(145.0909, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.0464705470949411
distance x is tensor(134.3882, device='cuda:1')
benign distance is  tensor(134.3882, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.0625690761953592
distance x is tensor(54.6575, device='cuda:1')
benign distance is  tensor(54.6575, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6408774759620428
distance x is tensor(145.5252, device='cuda:1')
benign distance is  tensor(145.5252, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8310111612081528
distance x is tensor(119.2732, device='cuda:1')
benign distance is  tensor(119.2732, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8087590709328651
distance x is tensor(96.6524, device='cuda:1')
benign distance is  tensor(96.6524, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5835090763866901
distance x is tensor(126.6614, device='cuda:1')
benign distance is  tensor(126.6614, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([14., 12.,  0., 13., 12., 22., 12., 14., 15., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 17., 12., 25., 26., 12., 13., 12., 13.])
count_res tensor([4.4303e-06, 5.9958e-07, 3.6839e-12, 1.6298e-06, 5.9958e-07, 1.3207e-02,
        5.9958e-07, 4.4303e-06, 1.2043e-05, 3.2736e-05, 3.2736e-05, 3.2736e-05,
        3.2736e-05, 3.2736e-05, 3.2736e-05, 3.2736e-05, 3.2736e-05, 3.2736e-05,
        3.2736e-05, 3.2736e-05, 8.8985e-05, 5.9958e-07, 2.6526e-01, 7.2105e-01,
        5.9958e-07, 1.6298e-06, 5.9958e-07, 1.6298e-06])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 67.58% 

Test Accuracy: 78.18% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7698748260736465
distance x is tensor(125.7853, device='cuda:1')
benign distance is  tensor(125.7853, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9389632642269135
distance x is tensor(105.0683, device='cuda:1')
benign distance is  tensor(105.0683, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9793484248220921
distance x is tensor(120.2717, device='cuda:1')
benign distance is  tensor(120.2717, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0891229547560215
distance x is tensor(147.5998, device='cuda:1')
benign distance is  tensor(147.5998, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2849216982722282
distance x is tensor(105.4292, device='cuda:1')
benign distance is  tensor(105.4292, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8039079769514501
distance x is tensor(112.6715, device='cuda:1')
benign distance is  tensor(112.6715, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2290233373641968
distance x is tensor(105.4367, device='cuda:1')
benign distance is  tensor(105.4367, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7451790478080511
distance x is tensor(93.3928, device='cuda:1')
benign distance is  tensor(93.3928, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8491607140749693
distance x is tensor(133.4390, device='cuda:1')
benign distance is  tensor(133.4390, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.8493979889899492
distance x is tensor(103.3253, device='cuda:1')
benign distance is  tensor(103.3253, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.8141742367297411
distance x is tensor(150.5830, device='cuda:1')
benign distance is  tensor(150.5830, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.0956162214279175
distance x is tensor(92.8084, device='cuda:1')
benign distance is  tensor(92.8084, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8090870771557093
distance x is tensor(114.2816, device='cuda:1')
benign distance is  tensor(114.2816, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8242087326943874
distance x is tensor(102.6621, device='cuda:1')
benign distance is  tensor(102.6621, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7617984749376774
distance x is tensor(98.9809, device='cuda:1')
benign distance is  tensor(98.9809, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7855644393712282
distance x is tensor(128.4520, device='cuda:1')
benign distance is  tensor(128.4520, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 12., 26., 16., 12.,  0., 20., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 27., 12., 12., 19., 12., 12.])
count_res tensor([2.2339e-07, 2.2339e-07, 2.6865e-01, 1.2197e-05, 2.2339e-07, 1.3726e-12,
        6.6592e-04, 2.2339e-07, 1.2197e-05, 1.2197e-05, 1.2197e-05, 1.2197e-05,
        1.2197e-05, 1.2197e-05, 1.2197e-05, 1.2197e-05, 1.2197e-05, 1.2197e-05,
        1.2197e-05, 1.2197e-05, 2.2339e-07, 2.2339e-07, 7.3028e-01, 2.2339e-07,
        2.2339e-07, 2.4498e-04, 2.2339e-07, 2.2339e-07])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 75.60% 

Test Accuracy: 80.99% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7616639519110322
distance x is tensor(131.4592, device='cuda:1')
benign distance is  tensor(131.4592, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8027310948818922
distance x is tensor(103.9021, device='cuda:1')
benign distance is  tensor(103.9021, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7829044498503208
distance x is tensor(102.9064, device='cuda:1')
benign distance is  tensor(102.9064, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.114760059863329
distance x is tensor(134.8057, device='cuda:1')
benign distance is  tensor(134.8057, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9921044427901506
distance x is tensor(97.1935, device='cuda:1')
benign distance is  tensor(97.1935, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8765913126990199
distance x is tensor(105.2683, device='cuda:1')
benign distance is  tensor(105.2683, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0565488040447235
distance x is tensor(100.2878, device='cuda:1')
benign distance is  tensor(100.2878, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6596632264554501
distance x is tensor(90.5660, device='cuda:1')
benign distance is  tensor(90.5660, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9089195653796196
distance x is tensor(105.4859, device='cuda:1')
benign distance is  tensor(105.4859, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7281096512451768
distance x is tensor(119.5196, device='cuda:1')
benign distance is  tensor(119.5196, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1775989569723606
distance x is tensor(53.7482, device='cuda:1')
benign distance is  tensor(53.7482, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2364065498113632
distance x is tensor(121.8212, device='cuda:1')
benign distance is  tensor(121.8212, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0591233782470226
distance x is tensor(158.1481, device='cuda:1')
benign distance is  tensor(158.1481, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8262238185852766
distance x is tensor(66.6179, device='cuda:1')
benign distance is  tensor(66.6179, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7751836869865656
distance x is tensor(154.7921, device='cuda:1')
benign distance is  tensor(154.7921, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.418706402182579
distance x is tensor(121.7688, device='cuda:1')
benign distance is  tensor(121.7688, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 12.,  0., 12., 14., 13., 27., 20., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 20., 12., 12., 26., 12., 12.])
count_res tensor([2.2330e-07, 2.2330e-07, 1.3720e-12, 2.2330e-07, 1.6500e-06, 6.0700e-07,
        7.2998e-01, 6.6565e-04, 1.2192e-05, 1.2192e-05, 1.2192e-05, 1.2192e-05,
        1.2192e-05, 1.2192e-05, 1.2192e-05, 1.2192e-05, 1.2192e-05, 1.2192e-05,
        1.2192e-05, 1.2192e-05, 2.2330e-07, 2.2330e-07, 6.6565e-04, 2.2330e-07,
        2.2330e-07, 2.6854e-01, 2.2330e-07, 2.2330e-07])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 69.07% 

Test Accuracy: 80.46% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6685378029942513
distance x is tensor(130.5178, device='cuda:1')
benign distance is  tensor(130.5178, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0069361738860607
distance x is tensor(96.0759, device='cuda:1')
benign distance is  tensor(96.0759, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8784507028758526
distance x is tensor(114.9065, device='cuda:1')
benign distance is  tensor(114.9065, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.103236997500062
distance x is tensor(140.1536, device='cuda:1')
benign distance is  tensor(140.1536, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9059323519468307
distance x is tensor(89.9086, device='cuda:1')
benign distance is  tensor(89.9086, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8126950822770596
distance x is tensor(109.0391, device='cuda:1')
benign distance is  tensor(109.0391, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2855957429856062
distance x is tensor(58.9637, device='cuda:1')
benign distance is  tensor(58.9637, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9793296493589878
distance x is tensor(100.6043, device='cuda:1')
benign distance is  tensor(100.6043, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.281177632510662
distance x is tensor(90.0657, device='cuda:1')
benign distance is  tensor(90.0657, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8485443573445082
distance x is tensor(111.1862, device='cuda:1')
benign distance is  tensor(111.1862, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9961420651525259
distance x is tensor(113.9388, device='cuda:1')
benign distance is  tensor(113.9388, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.0965557135641575
distance x is tensor(122.9553, device='cuda:1')
benign distance is  tensor(122.9553, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9831571616232395
distance x is tensor(80.1228, device='cuda:1')
benign distance is  tensor(80.1228, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7536573652178049
distance x is tensor(195.3850, device='cuda:1')
benign distance is  tensor(195.3850, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0662791673094034
distance x is tensor(114.8922, device='cuda:1')
benign distance is  tensor(114.8922, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7746850531548262
distance x is tensor(112.5514, device='cuda:1')
benign distance is  tensor(112.5514, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([14., 25., 17.,  1.,  1., 13., 12., 19., 22., 22., 23., 22., 23., 23.,
        23., 22., 23., 23., 23., 23., 25., 14., 12., 14., 14., 32., 13., 20.,
        24., 13., 15., 26., 13., 34., 23., 18.])
count_res tensor([1.8142e-09, 1.0862e-04, 3.6439e-08, 4.1006e-15, 4.1006e-15, 6.6740e-10,
        2.4552e-10, 2.6925e-07, 5.4080e-06, 5.4080e-06, 1.4700e-05, 5.4080e-06,
        1.4700e-05, 1.4700e-05, 1.4700e-05, 5.4080e-06, 1.4700e-05, 1.4700e-05,
        1.4700e-05, 1.4700e-05, 1.0862e-04, 1.8142e-09, 2.4552e-10, 1.8142e-09,
        1.8142e-09, 1.1912e-01, 6.6740e-10, 7.3189e-07, 3.9960e-05, 6.6740e-10,
        4.9314e-09, 2.9527e-04, 6.6740e-10, 8.8017e-01, 1.4700e-05, 9.9051e-08])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 78.30% 

Test Accuracy: 83.80% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.640654768794775
distance x is tensor(139.9442, device='cuda:1')
benign distance is  tensor(139.9442, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8188344370573759
distance x is tensor(111.7699, device='cuda:1')
benign distance is  tensor(111.7699, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8930823002010584
distance x is tensor(112.1731, device='cuda:1')
benign distance is  tensor(112.1731, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9524060115218163
distance x is tensor(145.3898, device='cuda:1')
benign distance is  tensor(145.3898, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1293388940393925
distance x is tensor(105.4335, device='cuda:1')
benign distance is  tensor(105.4335, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6409946102648973
distance x is tensor(110.4489, device='cuda:1')
benign distance is  tensor(110.4489, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.07200681976974
distance x is tensor(101.2379, device='cuda:1')
benign distance is  tensor(101.2379, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7755018146708608
distance x is tensor(94.5161, device='cuda:1')
benign distance is  tensor(94.5161, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.2674935162067413
distance x is tensor(102.8324, device='cuda:1')
benign distance is  tensor(102.8324, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6931340200826526
distance x is tensor(112.1907, device='cuda:1')
benign distance is  tensor(112.1907, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0935554280877113
distance x is tensor(70.8753, device='cuda:1')
benign distance is  tensor(70.8753, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.496948018670082
distance x is tensor(121.6331, device='cuda:1')
benign distance is  tensor(121.6331, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8903630636632442
distance x is tensor(166.6430, device='cuda:1')
benign distance is  tensor(166.6430, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8175648171454668
distance x is tensor(36.4281, device='cuda:1')
benign distance is  tensor(36.4281, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8826788794249296
distance x is tensor(140.7250, device='cuda:1')
benign distance is  tensor(140.7250, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.7137501053512096
distance x is tensor(124.0780, device='cuda:1')
benign distance is  tensor(124.0780, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.147598221898079
distance x is tensor(115.1142, device='cuda:1')
benign distance is  tensor(115.1142, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7428952679038048
distance x is tensor(92.9990, device='cuda:1')
benign distance is  tensor(92.9990, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.0495010185986757
distance x is tensor(121.6602, device='cuda:1')
benign distance is  tensor(121.6602, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.3291994519531727
distance x is tensor(114.9483, device='cuda:1')
benign distance is  tensor(114.9483, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8989058621227741
distance x is tensor(124.2711, device='cuda:1')
benign distance is  tensor(124.2711, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.0191982313990593
distance x is tensor(99.4130, device='cuda:1')
benign distance is  tensor(99.4130, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.473317950963974
distance x is tensor(121.3136, device='cuda:1')
benign distance is  tensor(121.3136, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7971221581101418
distance x is tensor(167.7894, device='cuda:1')
benign distance is  tensor(167.7894, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 16., 17., 15.,  8.,  3.,  8.,
         8.,  8.,  8.,  9., 11., 13.])
count_res tensor([4.2676e-03, 4.2676e-03, 4.2676e-03, 4.2676e-03, 4.2676e-03, 4.2676e-03,
        4.2676e-03, 4.2676e-03, 2.3300e-01, 6.3337e-01, 8.5717e-02, 7.8164e-05,
        5.2666e-07, 7.8164e-05, 7.8164e-05, 7.8164e-05, 7.8164e-05, 2.1247e-04,
        1.5700e-03, 1.1601e-02])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 72.70% 

Test Accuracy: 81.49% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6902201790362597
distance x is tensor(121.4634, device='cuda:1')
benign distance is  tensor(121.4634, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7886954974383116
distance x is tensor(109.4164, device='cuda:1')
benign distance is  tensor(109.4164, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7784767523407936
distance x is tensor(102.4511, device='cuda:1')
benign distance is  tensor(102.4511, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9660582039505243
distance x is tensor(142.0536, device='cuda:1')
benign distance is  tensor(142.0536, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.028830636292696
distance x is tensor(88.1370, device='cuda:1')
benign distance is  tensor(88.1370, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7845753245055676
distance x is tensor(102.7910, device='cuda:1')
benign distance is  tensor(102.7910, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2086061090230942
distance x is tensor(99.5735, device='cuda:1')
benign distance is  tensor(99.5735, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0024457443505526
distance x is tensor(99.2205, device='cuda:1')
benign distance is  tensor(99.2205, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 52
counter_tensor is  tensor([12.,  0., 39.,  0., 12.,  1.,  0., 31., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 12., 34.,  1., 50., 51., 12., 25., 51.,
         0., 41., 47., 12., 48., 28., 43., 12., 12.,  1., 23., 40., 46., 14.,
         0., 23., 15., 19., 13., 50., 39., 39.,  0., 28.])
count_res tensor([4.1079e-18, 2.5240e-23, 2.1856e-06, 2.5240e-23, 4.1079e-18, 6.8609e-23,
        2.5240e-23, 7.3319e-10, 5.9411e-06, 5.9411e-06, 5.9411e-06, 5.9411e-06,
        5.9411e-06, 5.9411e-06, 5.9411e-06, 5.9411e-06, 5.9411e-06, 5.9411e-06,
        5.9411e-06, 5.9411e-06, 4.1079e-18, 1.4727e-08, 6.8609e-23, 1.3086e-01,
        3.5572e-01, 4.1079e-18, 1.8174e-12, 3.5572e-01, 2.5240e-23, 1.6150e-05,
        6.5152e-03, 4.1079e-18, 1.7710e-02, 3.6503e-11, 1.1933e-04, 4.1079e-18,
        4.1079e-18, 6.8609e-23, 2.4596e-13, 5.9411e-06, 2.3968e-03, 3.0354e-17,
        2.5240e-23, 2.4596e-13, 8.2510e-17, 4.5049e-15, 1.1166e-17, 1.3086e-01,
        2.1856e-06, 2.1856e-06, 2.5240e-23, 3.6503e-11])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 89.60% 

Test Accuracy: 86.75% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5501520000398159
distance x is tensor(112.3600, device='cuda:1')
benign distance is  tensor(112.3600, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.735501391813159
distance x is tensor(104.6515, device='cuda:1')
benign distance is  tensor(104.6515, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7082730792462826
distance x is tensor(117.8798, device='cuda:1')
benign distance is  tensor(117.8798, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8176274634897709
distance x is tensor(146.9434, device='cuda:1')
benign distance is  tensor(146.9434, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7940026754513383
distance x is tensor(84.3256, device='cuda:1')
benign distance is  tensor(84.3256, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6676633888855577
distance x is tensor(109.2324, device='cuda:1')
benign distance is  tensor(109.2324, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2248853892087936
distance x is tensor(99.6240, device='cuda:1')
benign distance is  tensor(99.6240, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6336043886840343
distance x is tensor(87.0957, device='cuda:1')
benign distance is  tensor(87.0957, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1529740067198873
distance x is tensor(98.5527, device='cuda:1')
benign distance is  tensor(98.5527, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6013589389622211
distance x is tensor(109.1118, device='cuda:1')
benign distance is  tensor(109.1118, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8935522641986609
distance x is tensor(61.9832, device='cuda:1')
benign distance is  tensor(61.9832, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.313468974083662
distance x is tensor(110.2806, device='cuda:1')
benign distance is  tensor(110.2806, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7443362344056368
distance x is tensor(152.1916, device='cuda:1')
benign distance is  tensor(152.1916, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6994088497012854
distance x is tensor(57.7091, device='cuda:1')
benign distance is  tensor(57.7091, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9915779251605272
distance x is tensor(131.0057, device='cuda:1')
benign distance is  tensor(131.0057, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3580649644136429
distance x is tensor(119.7327, device='cuda:1')
benign distance is  tensor(119.7327, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.049021802842617
distance x is tensor(106.1195, device='cuda:1')
benign distance is  tensor(106.1195, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6410984648391604
distance x is tensor(105.5747, device='cuda:1')
benign distance is  tensor(105.5747, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9601762946695089
distance x is tensor(122.8115, device='cuda:1')
benign distance is  tensor(122.8115, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7299964521080256
distance x is tensor(112.2880, device='cuda:1')
benign distance is  tensor(112.2880, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9648702871054411
distance x is tensor(74.4928, device='cuda:1')
benign distance is  tensor(74.4928, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6797131672501564
distance x is tensor(206.3685, device='cuda:1')
benign distance is  tensor(206.3685, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.4100875817239285
distance x is tensor(133.3367, device='cuda:1')
benign distance is  tensor(133.3367, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7329827435314655
distance x is tensor(100.8227, device='cuda:1')
benign distance is  tensor(100.8227, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7459856756031513
distance x is tensor(118.1323, device='cuda:1')
benign distance is  tensor(118.1323, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.7483536023646593
distance x is tensor(83.7729, device='cuda:1')
benign distance is  tensor(83.7729, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6485879812389612
distance x is tensor(144.8330, device='cuda:1')
benign distance is  tensor(144.8330, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.1154943965375423
distance x is tensor(115.0209, device='cuda:1')
benign distance is  tensor(115.0209, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9359604604542255
distance x is tensor(92.6329, device='cuda:1')
benign distance is  tensor(92.6329, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8697007726877928
distance x is tensor(91.8965, device='cuda:1')
benign distance is  tensor(91.8965, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7440037466585636
distance x is tensor(85.4780, device='cuda:1')
benign distance is  tensor(85.4780, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8256857711821795
distance x is tensor(112.9043, device='cuda:1')
benign distance is  tensor(112.9043, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.0773962531238794
distance x is tensor(86.6928, device='cuda:1')
benign distance is  tensor(86.6928, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.36031873524189
distance x is tensor(143.0789, device='cuda:1')
benign distance is  tensor(143.0789, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.1745474189519882
distance x is tensor(134.0974, device='cuda:1')
benign distance is  tensor(134.0974, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.020011881366372
distance x is tensor(71.6443, device='cuda:1')
benign distance is  tensor(71.6443, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7445905823260546
distance x is tensor(132.5501, device='cuda:1')
benign distance is  tensor(132.5501, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5874814353883266
distance x is tensor(129.2025, device='cuda:1')
benign distance is  tensor(129.2025, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8841747306287289
distance x is tensor(106.8267, device='cuda:1')
benign distance is  tensor(106.8267, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5764327505603433
distance x is tensor(107.3760, device='cuda:1')
benign distance is  tensor(107.3760, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([13., 13., 12., 13., 13., 13., 13., 13., 11., 17., 15.,  8.,  7.,  7.,
         7.,  7.,  7.,  8., 11., 12.])
count_res tensor([1.4282e-02, 1.4282e-02, 5.2540e-03, 1.4282e-02, 1.4282e-02, 1.4282e-02,
        1.4282e-02, 1.4282e-02, 1.9328e-03, 7.7976e-01, 1.0553e-01, 9.6230e-05,
        3.5401e-05, 3.5401e-05, 3.5401e-05, 3.5401e-05, 3.5401e-05, 9.6230e-05,
        1.9328e-03, 5.2540e-03])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 89.46% 

Test Accuracy: 85.40% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6899163611233234
distance x is tensor(110.8377, device='cuda:1')
benign distance is  tensor(110.8377, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7974673938006163
distance x is tensor(93.7589, device='cuda:1')
benign distance is  tensor(93.7589, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7657154481858015
distance x is tensor(103.6650, device='cuda:1')
benign distance is  tensor(103.6650, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9213914442807436
distance x is tensor(141.8323, device='cuda:1')
benign distance is  tensor(141.8323, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8721831915900111
distance x is tensor(76.7807, device='cuda:1')
benign distance is  tensor(76.7807, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6015971032902598
distance x is tensor(97.4279, device='cuda:1')
benign distance is  tensor(97.4279, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.135210432112217
distance x is tensor(102.0907, device='cuda:1')
benign distance is  tensor(102.0907, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7484243586659431
distance x is tensor(83.2236, device='cuda:1')
benign distance is  tensor(83.2236, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([12., 12.,  9., 34., 12., 22., 15., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 14., 12.,  0., 13., 33., 25., 35., 16.,
        13., 12.,  1., 12., 17., 19., 33., 13.])
count_res tensor([6.2618e-11, 6.2618e-11, 3.1176e-12, 2.2448e-01, 6.2618e-11, 1.3793e-06,
        1.2577e-09, 6.2618e-11, 1.0191e-05, 1.0191e-05, 1.0191e-05, 1.0191e-05,
        1.0191e-05, 1.0191e-05, 1.0191e-05, 1.0191e-05, 1.0191e-05, 1.0191e-05,
        1.0191e-05, 1.0191e-05, 4.6269e-10, 6.2618e-11, 3.8474e-16, 1.7021e-10,
        8.2582e-02, 2.7703e-05, 6.1020e-01, 3.4188e-09, 1.7021e-10, 6.2618e-11,
        1.0458e-15, 6.2618e-11, 9.2934e-09, 6.8669e-08, 8.2582e-02, 1.7021e-10])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 93.99% 

Test Accuracy: 88.12% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7172387484461069
distance x is tensor(121.1101, device='cuda:1')
benign distance is  tensor(121.1101, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8317475505173206
distance x is tensor(95.8925, device='cuda:1')
benign distance is  tensor(95.8925, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6031367834657431
distance x is tensor(101.0979, device='cuda:1')
benign distance is  tensor(101.0979, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0001240316778421
distance x is tensor(139.6031, device='cuda:1')
benign distance is  tensor(139.6031, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8740322235971689
distance x is tensor(87.7056, device='cuda:1')
benign distance is  tensor(87.7056, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7592765185981989
distance x is tensor(103.3196, device='cuda:1')
benign distance is  tensor(103.3196, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1079107522964478
distance x is tensor(98.4013, device='cuda:1')
benign distance is  tensor(98.4013, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6477205213159323
distance x is tensor(103.4148, device='cuda:1')
benign distance is  tensor(103.4148, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0290285758674145
distance x is tensor(94.1350, device='cuda:1')
benign distance is  tensor(94.1350, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6875933664850891
distance x is tensor(123.2075, device='cuda:1')
benign distance is  tensor(123.2075, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0447535160928965
distance x is tensor(62.5517, device='cuda:1')
benign distance is  tensor(62.5517, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.514121014624834
distance x is tensor(123.0566, device='cuda:1')
benign distance is  tensor(123.0566, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8340736757963896
distance x is tensor(169.8453, device='cuda:1')
benign distance is  tensor(169.8453, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8649046206846833
distance x is tensor(53.1298, device='cuda:1')
benign distance is  tensor(53.1298, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8897958677262068
distance x is tensor(143.7188, device='cuda:1')
benign distance is  tensor(143.7188, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8736682925373316
distance x is tensor(122.8059, device='cuda:1')
benign distance is  tensor(122.8059, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.938765486702323
distance x is tensor(117.7725, device='cuda:1')
benign distance is  tensor(117.7725, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6170254861935973
distance x is tensor(79.4492, device='cuda:1')
benign distance is  tensor(79.4492, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.6588298892602324
distance x is tensor(116.5846, device='cuda:1')
benign distance is  tensor(116.5846, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.1167530938982964
distance x is tensor(106.6470, device='cuda:1')
benign distance is  tensor(106.6470, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8645045235753059
distance x is tensor(114.2486, device='cuda:1')
benign distance is  tensor(114.2486, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.800957502797246
distance x is tensor(93.5593, device='cuda:1')
benign distance is  tensor(93.5593, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5693338136188686
distance x is tensor(84.9374, device='cuda:1')
benign distance is  tensor(84.9374, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6536726169288158
distance x is tensor(164.2010, device='cuda:1')
benign distance is  tensor(164.2010, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 20., 10., 12., 12., 23., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 12., 23., 12.,  6., 16., 22.])
count_res tensor([6.8741e-06, 2.0491e-02, 9.3030e-07, 6.8741e-06, 6.8741e-06, 4.1158e-01,
        6.8741e-06, 6.8741e-06, 3.7531e-04, 3.7531e-04, 3.7531e-04, 3.7531e-04,
        3.7531e-04, 3.7531e-04, 3.7531e-04, 3.7531e-04, 3.7531e-04, 3.7531e-04,
        3.7531e-04, 3.7531e-04, 6.8741e-06, 6.8741e-06, 6.8741e-06, 4.1158e-01,
        6.8741e-06, 1.7039e-08, 3.7531e-04, 1.5141e-01])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 89.37% 

Test Accuracy: 86.72% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7212862707674503
distance x is tensor(118.5543, device='cuda:1')
benign distance is  tensor(118.5543, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6410468118265271
distance x is tensor(106.5072, device='cuda:1')
benign distance is  tensor(106.5072, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7306727636605501
distance x is tensor(102.9841, device='cuda:1')
benign distance is  tensor(102.9841, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9021060969680548
distance x is tensor(139.0349, device='cuda:1')
benign distance is  tensor(139.0349, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.859707223251462
distance x is tensor(93.0909, device='cuda:1')
benign distance is  tensor(93.0909, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7317043840885162
distance x is tensor(95.5511, device='cuda:1')
benign distance is  tensor(95.5511, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.314455196261406
distance x is tensor(89.1555, device='cuda:1')
benign distance is  tensor(89.1555, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7248043371364474
distance x is tensor(89.0992, device='cuda:1')
benign distance is  tensor(89.0992, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.068718446418643
distance x is tensor(103.4959, device='cuda:1')
benign distance is  tensor(103.4959, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8602210022509098
distance x is tensor(114.3860, device='cuda:1')
benign distance is  tensor(114.3860, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9294114708900452
distance x is tensor(124.8321, device='cuda:1')
benign distance is  tensor(124.8321, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9634034894406796
distance x is tensor(98.3417, device='cuda:1')
benign distance is  tensor(98.3417, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.014147600159049
distance x is tensor(74.8879, device='cuda:1')
benign distance is  tensor(74.8879, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8252449817955494
distance x is tensor(199.9388, device='cuda:1')
benign distance is  tensor(199.9388, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.076556533575058
distance x is tensor(126.5818, device='cuda:1')
benign distance is  tensor(126.5818, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8103480041027069
distance x is tensor(104.2048, device='cuda:1')
benign distance is  tensor(104.2048, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([13., 24., 13., 12., 12., 12., 12., 14., 14., 14., 15., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 17., 12., 13., 12.,  0., 26., 26., 15.])
count_res tensor([1.0582e-06, 6.3361e-02, 1.0582e-06, 3.8931e-07, 3.8931e-07, 3.8931e-07,
        3.8931e-07, 2.8766e-06, 2.8766e-06, 2.8766e-06, 7.8194e-06, 2.1255e-05,
        2.1255e-05, 2.1255e-05, 2.1255e-05, 2.1255e-05, 2.1255e-05, 2.1255e-05,
        2.1255e-05, 2.1255e-05, 5.7778e-05, 3.8931e-07, 1.0582e-06, 3.8931e-07,
        2.3920e-12, 4.6818e-01, 4.6818e-01, 7.8194e-06])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 80.48% 

Test Accuracy: 85.17% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6727463509887457
distance x is tensor(136.0475, device='cuda:1')
benign distance is  tensor(136.0475, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8554894998669624
distance x is tensor(116.3591, device='cuda:1')
benign distance is  tensor(116.3591, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7994996570050716
distance x is tensor(110.2107, device='cuda:1')
benign distance is  tensor(110.2107, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0452366601675749
distance x is tensor(140.7325, device='cuda:1')
benign distance is  tensor(140.7325, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2289826311171055
distance x is tensor(101.2481, device='cuda:1')
benign distance is  tensor(101.2481, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8722641738131642
distance x is tensor(109.9647, device='cuda:1')
benign distance is  tensor(109.9647, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4541180282831192
distance x is tensor(104.9513, device='cuda:1')
benign distance is  tensor(104.9513, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7522459411993623
distance x is tensor(97.0746, device='cuda:1')
benign distance is  tensor(97.0746, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0132420547306538
distance x is tensor(90.8881, device='cuda:1')
benign distance is  tensor(90.8881, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7150832950137556
distance x is tensor(127.7171, device='cuda:1')
benign distance is  tensor(127.7171, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0443721767514944
distance x is tensor(75.3135, device='cuda:1')
benign distance is  tensor(75.3135, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.1967561654746532
distance x is tensor(122.1799, device='cuda:1')
benign distance is  tensor(122.1799, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.3734001852571964
distance x is tensor(159.9728, device='cuda:1')
benign distance is  tensor(159.9728, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7975944699719548
distance x is tensor(39.3095, device='cuda:1')
benign distance is  tensor(39.3095, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9874046891927719
distance x is tensor(105.2717, device='cuda:1')
benign distance is  tensor(105.2717, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.4626307487487793
distance x is tensor(126.6163, device='cuda:1')
benign distance is  tensor(126.6163, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([15., 15., 10., 12., 24., 13., 13., 12., 15., 15., 16., 16., 16., 15.,
        15., 15., 15., 15., 15., 15., 12., 13., 17., 27., 13., 14., 14., 13.])
count_res tensor([5.8519e-06, 5.8519e-06, 3.9429e-08, 2.9135e-07, 4.7418e-02, 7.9196e-07,
        7.9196e-07, 2.9135e-07, 5.8519e-06, 5.8519e-06, 1.5907e-05, 1.5907e-05,
        1.5907e-05, 5.8519e-06, 5.8519e-06, 5.8519e-06, 5.8519e-06, 5.8519e-06,
        5.8519e-06, 5.8519e-06, 2.9135e-07, 7.9196e-07, 4.3240e-05, 9.5242e-01,
        7.9196e-07, 2.1528e-06, 2.1528e-06, 7.9196e-07])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 65.56% 

Test Accuracy: 77.47% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7800136897712946
distance x is tensor(133.9263, device='cuda:1')
benign distance is  tensor(133.9263, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9998766891658306
distance x is tensor(114.9910, device='cuda:1')
benign distance is  tensor(114.9910, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9891954176127911
distance x is tensor(120.5358, device='cuda:1')
benign distance is  tensor(120.5358, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9964125901460648
distance x is tensor(152.5981, device='cuda:1')
benign distance is  tensor(152.5981, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8583258613944054
distance x is tensor(99.6185, device='cuda:1')
benign distance is  tensor(99.6185, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8079445455223322
distance x is tensor(123.4317, device='cuda:1')
benign distance is  tensor(123.4317, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.387267928570509
distance x is tensor(108.8228, device='cuda:1')
benign distance is  tensor(108.8228, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8078496363013983
distance x is tensor(118.3601, device='cuda:1')
benign distance is  tensor(118.3601, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.9113411940634251
distance x is tensor(141.1840, device='cuda:1')
benign distance is  tensor(141.1840, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.9588698204606771
distance x is tensor(100.6390, device='cuda:1')
benign distance is  tensor(100.6390, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.0116198174655437
distance x is tensor(146.7446, device='cuda:1')
benign distance is  tensor(146.7446, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.7178780063986778
distance x is tensor(72.1434, device='cuda:1')
benign distance is  tensor(72.1434, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8340040072798729
distance x is tensor(129.7051, device='cuda:1')
benign distance is  tensor(129.7051, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.9590507186949253
distance x is tensor(111.0144, device='cuda:1')
benign distance is  tensor(111.0144, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.8099533189088106
distance x is tensor(108.2217, device='cuda:1')
benign distance is  tensor(108.2217, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8251504432410002
distance x is tensor(130.0958, device='cuda:1')
benign distance is  tensor(130.0958, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 52
counter_tensor is  tensor([14.,  8.,  0.,  6.,  0., 19.,  0., 51., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 34., 49., 16., 48., 11.,  0., 16., 17.,
        49., 33.,  3., 12.,  2., 12., 43., 45., 12., 12., 35., 12., 12., 50.,
         5., 27., 51.,  0., 17., 48., 51., 50., 42., 12.])
count_res tensor([2.0766e-17, 5.1474e-20, 1.7268e-23, 6.9662e-21, 1.7268e-23, 3.0819e-15,
        1.7268e-23, 2.4336e-01, 4.0645e-06, 4.0645e-06, 4.0645e-06, 4.0645e-06,
        4.0645e-06, 4.0645e-06, 4.0645e-06, 4.0645e-06, 4.0645e-06, 4.0645e-06,
        4.0645e-06, 4.0645e-06, 1.0075e-08, 3.2935e-02, 1.5344e-16, 1.2116e-02,
        1.0339e-18, 1.7268e-23, 1.5344e-16, 4.1710e-16, 3.2935e-02, 3.7064e-09,
        3.4683e-22, 2.8104e-18, 1.2759e-22, 2.8104e-18, 8.1638e-05, 6.0323e-04,
        2.8104e-18, 2.8104e-18, 2.7387e-08, 2.8104e-18, 2.8104e-18, 8.9527e-02,
        2.5627e-21, 9.1872e-12, 2.4336e-01, 1.7268e-23, 4.1710e-16, 1.2116e-02,
        2.4336e-01, 8.9527e-02, 3.0033e-05, 2.8104e-18])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 76.60% 

Test Accuracy: 84.30% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5370374135673046
distance x is tensor(141.1483, device='cuda:1')
benign distance is  tensor(141.1483, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8652482274919748
distance x is tensor(110.3118, device='cuda:1')
benign distance is  tensor(110.3118, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8311686534434557
distance x is tensor(111.2980, device='cuda:1')
benign distance is  tensor(111.2980, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9417782546952367
distance x is tensor(136.6282, device='cuda:1')
benign distance is  tensor(136.6282, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9368015229701996
distance x is tensor(97.0201, device='cuda:1')
benign distance is  tensor(97.0201, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7295410661026835
distance x is tensor(102.2399, device='cuda:1')
benign distance is  tensor(102.2399, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2599973697215319
distance x is tensor(99.2120, device='cuda:1')
benign distance is  tensor(99.2120, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7795467786490917
distance x is tensor(82.6960, device='cuda:1')
benign distance is  tensor(82.6960, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0231208894401789
distance x is tensor(82.8943, device='cuda:1')
benign distance is  tensor(82.8943, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.632309390231967
distance x is tensor(119.8597, device='cuda:1')
benign distance is  tensor(119.8597, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1314668860286474
distance x is tensor(62.3412, device='cuda:1')
benign distance is  tensor(62.3412, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.219418851658702
distance x is tensor(117.7474, device='cuda:1')
benign distance is  tensor(117.7474, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.089279767125845
distance x is tensor(157.0163, device='cuda:1')
benign distance is  tensor(157.0163, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7103278832510114
distance x is tensor(47.3224, device='cuda:1')
benign distance is  tensor(47.3224, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9462209437042475
distance x is tensor(128.3494, device='cuda:1')
benign distance is  tensor(128.3494, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2003952451050282
distance x is tensor(123.9776, device='cuda:1')
benign distance is  tensor(123.9776, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.3569290898740292
distance x is tensor(94.0198, device='cuda:1')
benign distance is  tensor(94.0198, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8517247326672077
distance x is tensor(108.5884, device='cuda:1')
benign distance is  tensor(108.5884, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.0983789581805468
distance x is tensor(124.7463, device='cuda:1')
benign distance is  tensor(124.7463, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8892200887203217
distance x is tensor(110.9982, device='cuda:1')
benign distance is  tensor(110.9982, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0434073116630316
distance x is tensor(80.1827, device='cuda:1')
benign distance is  tensor(80.1827, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6654454879462719
distance x is tensor(198.9839, device='cuda:1')
benign distance is  tensor(198.9839, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0400203466415405
distance x is tensor(134.7669, device='cuda:1')
benign distance is  tensor(134.7669, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8898830451071262
distance x is tensor(107.6350, device='cuda:1')
benign distance is  tensor(107.6350, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.2340808436274529
distance x is tensor(101.2392, device='cuda:1')
benign distance is  tensor(101.2392, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.0061478540301323
distance x is tensor(170.8850, device='cuda:1')
benign distance is  tensor(170.8850, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9936812426894903
distance x is tensor(123.3031, device='cuda:1')
benign distance is  tensor(123.3031, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.3942045234143734
distance x is tensor(100.9111, device='cuda:1')
benign distance is  tensor(100.9111, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7675816100090742
distance x is tensor(112.7969, device='cuda:1')
benign distance is  tensor(112.7969, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7885258384048939
distance x is tensor(101.3838, device='cuda:1')
benign distance is  tensor(101.3838, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5502296956256032
distance x is tensor(103.8774, device='cuda:1')
benign distance is  tensor(103.8774, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7436736430972815
distance x is tensor(162.8555, device='cuda:1')
benign distance is  tensor(162.8555, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.1239736806601286
distance x is tensor(104.4268, device='cuda:1')
benign distance is  tensor(104.4268, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.5945769250392914
distance x is tensor(136.0812, device='cuda:1')
benign distance is  tensor(136.0812, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.9573869667947292
distance x is tensor(145.5051, device='cuda:1')
benign distance is  tensor(145.5051, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.118772715330124
distance x is tensor(72.6692, device='cuda:1')
benign distance is  tensor(72.6692, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6519606336951256
distance x is tensor(138.1713, device='cuda:1')
benign distance is  tensor(138.1713, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7624030280858278
distance x is tensor(125.4434, device='cuda:1')
benign distance is  tensor(125.4434, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8661150429397821
distance x is tensor(97.1781, device='cuda:1')
benign distance is  tensor(97.1781, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.4821298737078905
distance x is tensor(115.3971, device='cuda:1')
benign distance is  tensor(115.3971, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 13., 12., 12., 13., 12., 12., 13., 11., 16., 15.,  8.,  8.,  8.,
         8.,  7.,  8., 10., 10., 12.])
count_res tensor([1.1164e-02, 3.0346e-02, 1.1164e-02, 1.1164e-02, 3.0346e-02, 1.1164e-02,
        1.1164e-02, 3.0346e-02, 4.1069e-03, 6.0952e-01, 2.2423e-01, 2.0447e-04,
        2.0447e-04, 2.0447e-04, 2.0447e-04, 7.5221e-05, 2.0447e-04, 1.5109e-03,
        1.5109e-03, 1.1164e-02])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 71.63% 

Test Accuracy: 82.23% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6129484428092837
distance x is tensor(112.1693, device='cuda:1')
benign distance is  tensor(112.1693, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8023020047694445
distance x is tensor(88.9832, device='cuda:1')
benign distance is  tensor(88.9832, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7239145021885633
distance x is tensor(95.8111, device='cuda:1')
benign distance is  tensor(95.8111, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8656914941966534
distance x is tensor(131.0978, device='cuda:1')
benign distance is  tensor(131.0978, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8873043153434992
distance x is tensor(81.0913, device='cuda:1')
benign distance is  tensor(81.0913, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7671029288321733
distance x is tensor(101.4821, device='cuda:1')
benign distance is  tensor(101.4821, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2637342885136604
distance x is tensor(91.6067, device='cuda:1')
benign distance is  tensor(91.6067, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7978949267417192
distance x is tensor(81.5714, device='cuda:1')
benign distance is  tensor(81.5714, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([22., 26., 12., 12., 12.,  7., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 13., 12., 12., 12., 12., 12., 13.])
count_res tensor([4.9010e-03, 2.6758e-01, 2.2250e-07, 2.2250e-07, 2.2250e-07, 1.4992e-09,
        2.2250e-07, 2.2250e-07, 1.2148e-05, 1.2148e-05, 1.2148e-05, 1.2148e-05,
        1.2148e-05, 1.2148e-05, 1.2148e-05, 1.2148e-05, 1.2148e-05, 1.2148e-05,
        1.2148e-05, 1.2148e-05, 7.2737e-01, 6.0483e-07, 2.2250e-07, 2.2250e-07,
        2.2250e-07, 2.2250e-07, 2.2250e-07, 6.0483e-07])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 73.86% 

Test Accuracy: 82.22% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7646275982260704
distance x is tensor(132.9642, device='cuda:1')
benign distance is  tensor(132.9642, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9721846431493759
distance x is tensor(96.4147, device='cuda:1')
benign distance is  tensor(96.4147, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8610687740147114
distance x is tensor(119.8876, device='cuda:1')
benign distance is  tensor(119.8876, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0921991728246212
distance x is tensor(157.0319, device='cuda:1')
benign distance is  tensor(157.0319, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0210266234353185
distance x is tensor(102.5518, device='cuda:1')
benign distance is  tensor(102.5518, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.810430746525526
distance x is tensor(114.0394, device='cuda:1')
benign distance is  tensor(114.0394, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.031033044680953
distance x is tensor(112.5076, device='cuda:1')
benign distance is  tensor(112.5076, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.905452623963356
distance x is tensor(94.4425, device='cuda:1')
benign distance is  tensor(94.4425, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.160557359457016
distance x is tensor(55.1720, device='cuda:1')
benign distance is  tensor(55.1720, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.915519030764699
distance x is tensor(136.0834, device='cuda:1')
benign distance is  tensor(136.0834, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.222557071596384
distance x is tensor(75.8577, device='cuda:1')
benign distance is  tensor(75.8577, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2001736797392368
distance x is tensor(125.6256, device='cuda:1')
benign distance is  tensor(125.6256, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9734890945255756
distance x is tensor(155.0330, device='cuda:1')
benign distance is  tensor(155.0330, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9099411405622959
distance x is tensor(54.2763, device='cuda:1')
benign distance is  tensor(54.2763, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9377131424844265
distance x is tensor(128.9885, device='cuda:1')
benign distance is  tensor(128.9885, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2218783721327782
distance x is tensor(126.0715, device='cuda:1')
benign distance is  tensor(126.0715, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 16., 12., 12., 12., 12.,  0., 23., 15., 15., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 18., 26., 12., 25., 14., 12.])
count_res tensor([5.8618e-07, 3.2005e-05, 5.8618e-07, 5.8618e-07, 5.8618e-07, 5.8618e-07,
        3.6016e-12, 3.5097e-02, 1.1774e-05, 1.1774e-05, 3.2005e-05, 3.2005e-05,
        3.2005e-05, 3.2005e-05, 3.2005e-05, 3.2005e-05, 3.2005e-05, 3.2005e-05,
        3.2005e-05, 3.2005e-05, 5.8618e-07, 5.8618e-07, 2.3648e-04, 7.0495e-01,
        5.8618e-07, 2.5934e-01, 4.3313e-06, 5.8618e-07])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 79.00% 

Test Accuracy: 82.54% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7312740925699472
distance x is tensor(126.3629, device='cuda:1')
benign distance is  tensor(126.3629, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0502484738826752
distance x is tensor(103.3691, device='cuda:1')
benign distance is  tensor(103.3691, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8837307319045067
distance x is tensor(111.7500, device='cuda:1')
benign distance is  tensor(111.7500, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0248073674738407
distance x is tensor(143.6399, device='cuda:1')
benign distance is  tensor(143.6399, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.000197833403945
distance x is tensor(90.0175, device='cuda:1')
benign distance is  tensor(90.0175, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7399335345253348
distance x is tensor(114.5127, device='cuda:1')
benign distance is  tensor(114.5127, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3233819343149662
distance x is tensor(97.7514, device='cuda:1')
benign distance is  tensor(97.7514, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7665140964090824
distance x is tensor(87.3134, device='cuda:1')
benign distance is  tensor(87.3134, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1282137222588062
distance x is tensor(114.6064, device='cuda:1')
benign distance is  tensor(114.6064, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8059456739574671
distance x is tensor(114.2670, device='cuda:1')
benign distance is  tensor(114.2670, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9013965893536806
distance x is tensor(118.4017, device='cuda:1')
benign distance is  tensor(118.4017, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.0906577706336975
distance x is tensor(74.5208, device='cuda:1')
benign distance is  tensor(74.5208, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.2667000778019428
distance x is tensor(85.9473, device='cuda:1')
benign distance is  tensor(85.9473, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7646910585463047
distance x is tensor(197.1830, device='cuda:1')
benign distance is  tensor(197.1830, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.4047586135566235
distance x is tensor(147.3661, device='cuda:1')
benign distance is  tensor(147.3661, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7706455513834953
distance x is tensor(113.9460, device='cuda:1')
benign distance is  tensor(113.9460, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 44
counter_tensor is  tensor([29., 41., 31.,  0., 26., 17., 12., 12., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 33., 27.,  0., 15., 21., 12., 23.,  3.,
        15., 13., 12., 14., 40., 12., 12., 42., 18., 43., 12., 25.,  3., 41.,
        12., 12.])
count_res tensor([4.9244e-07, 8.0147e-02, 3.6387e-06, 1.2526e-19, 2.4517e-08, 3.0257e-12,
        2.0387e-14, 2.0387e-14, 9.8909e-06, 9.8909e-06, 9.8909e-06, 9.8909e-06,
        9.8909e-06, 9.8909e-06, 9.8909e-06, 9.8909e-06, 9.8909e-06, 9.8909e-06,
        9.8909e-06, 9.8909e-06, 2.6886e-05, 6.6644e-08, 1.2526e-19, 4.0948e-13,
        1.6520e-10, 2.0387e-14, 1.2206e-09, 2.5159e-18, 4.0948e-13, 5.5417e-14,
        2.0387e-14, 1.5064e-13, 2.9484e-02, 2.0387e-14, 2.0387e-14, 2.1786e-01,
        8.2246e-12, 5.9221e-01, 2.0387e-14, 9.0193e-09, 2.5159e-18, 8.0147e-02,
        2.0387e-14, 2.0387e-14])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 80.16% 

Test Accuracy: 84.95% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8510690256953239
distance x is tensor(136.0036, device='cuda:1')
benign distance is  tensor(136.0036, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8580428371205926
distance x is tensor(102.5418, device='cuda:1')
benign distance is  tensor(102.5418, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8337515909224749
distance x is tensor(118.7266, device='cuda:1')
benign distance is  tensor(118.7266, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2399707771837711
distance x is tensor(156.3600, device='cuda:1')
benign distance is  tensor(156.3600, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8397967237979174
distance x is tensor(94.3710, device='cuda:1')
benign distance is  tensor(94.3710, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8595730643719435
distance x is tensor(104.9102, device='cuda:1')
benign distance is  tensor(104.9102, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2078317608684301
distance x is tensor(108.3058, device='cuda:1')
benign distance is  tensor(108.3058, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7719969898462296
distance x is tensor(93.6621, device='cuda:1')
benign distance is  tensor(93.6621, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0856039449572563
distance x is tensor(80.6701, device='cuda:1')
benign distance is  tensor(80.6701, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9678878411650658
distance x is tensor(81.5773, device='cuda:1')
benign distance is  tensor(81.5773, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1444494798779488
distance x is tensor(83.9417, device='cuda:1')
benign distance is  tensor(83.9417, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2475466579198837
distance x is tensor(121.6292, device='cuda:1')
benign distance is  tensor(121.6292, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2147254385054111
distance x is tensor(159.3859, device='cuda:1')
benign distance is  tensor(159.3859, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7644736878573895
distance x is tensor(52.1238, device='cuda:1')
benign distance is  tensor(52.1238, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9858507458120584
distance x is tensor(133.5495, device='cuda:1')
benign distance is  tensor(133.5495, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.320476595312357
distance x is tensor(119.3261, device='cuda:1')
benign distance is  tensor(119.3261, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9639159347862005
distance x is tensor(110.0399, device='cuda:1')
benign distance is  tensor(110.0399, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7880148030817509
distance x is tensor(126.0239, device='cuda:1')
benign distance is  tensor(126.0239, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9701557103544474
distance x is tensor(129.8045, device='cuda:1')
benign distance is  tensor(129.8045, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.3917055651545525
distance x is tensor(123.7525, device='cuda:1')
benign distance is  tensor(123.7525, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9714990258216858
distance x is tensor(109.3908, device='cuda:1')
benign distance is  tensor(109.3908, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.0628822818398476
distance x is tensor(115.8767, device='cuda:1')
benign distance is  tensor(115.8767, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5820068009197712
distance x is tensor(126.3251, device='cuda:1')
benign distance is  tensor(126.3251, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7535343449562788
distance x is tensor(163.7680, device='cuda:1')
benign distance is  tensor(163.7680, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7866648733615875
distance x is tensor(128.9799, device='cuda:1')
benign distance is  tensor(128.9799, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.8836638536304235
distance x is tensor(93.8038, device='cuda:1')
benign distance is  tensor(93.8038, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7834578473120928
distance x is tensor(145.8794, device='cuda:1')
benign distance is  tensor(145.8794, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.5061668157577515
distance x is tensor(112.9603, device='cuda:1')
benign distance is  tensor(112.9603, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6205367688089609
distance x is tensor(110.0285, device='cuda:1')
benign distance is  tensor(110.0285, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.9005565363913774
distance x is tensor(96.1911, device='cuda:1')
benign distance is  tensor(96.1911, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.8386567877605557
distance x is tensor(93.1098, device='cuda:1')
benign distance is  tensor(93.1098, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8799304328858852
distance x is tensor(126.9999, device='cuda:1')
benign distance is  tensor(126.9999, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([14., 13., 14., 13., 12., 13., 13., 13., 18., 16.,  8.,  6.,  7.,  7.,
         7.,  7.,  7.,  9., 11., 12.])
count_res tensor([1.5115e-02, 5.5604e-03, 1.5115e-02, 5.5604e-03, 2.0455e-03, 5.5604e-03,
        5.5604e-03, 5.5604e-03, 8.2523e-01, 1.1168e-01, 3.7465e-05, 5.0704e-06,
        1.3783e-05, 1.3783e-05, 1.3783e-05, 1.3783e-05, 1.3783e-05, 1.0184e-04,
        7.5251e-04, 2.0455e-03])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 79.52% 

Test Accuracy: 83.56% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6886621899902821
distance x is tensor(129.1217, device='cuda:1')
benign distance is  tensor(129.1217, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8820715472102165
distance x is tensor(112.4047, device='cuda:1')
benign distance is  tensor(112.4047, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7100350651890039
distance x is tensor(107.8868, device='cuda:1')
benign distance is  tensor(107.8868, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0117222480475903
distance x is tensor(155.7174, device='cuda:1')
benign distance is  tensor(155.7174, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0643658805638552
distance x is tensor(97.1607, device='cuda:1')
benign distance is  tensor(97.1607, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6790507161058486
distance x is tensor(105.7041, device='cuda:1')
benign distance is  tensor(105.7041, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1570950634777546
distance x is tensor(102.1560, device='cuda:1')
benign distance is  tensor(102.1560, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7574460562318563
distance x is tensor(91.2993, device='cuda:1')
benign distance is  tensor(91.2993, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 44
counter_tensor is  tensor([42., 42., 30.,  0.,  1.,  0., 35., 35., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 21., 43., 12., 35., 14.,  0., 12., 12.,
        43., 12., 42., 40., 31., 12.,  5., 34., 12., 12., 12., 14.,  0., 12.,
         0., 13.])
count_res tensor([1.1661e-01, 1.1661e-01, 7.1648e-07, 6.7046e-20, 1.8225e-19, 6.7046e-20,
        1.0634e-04, 1.0634e-04, 5.2941e-06, 5.2941e-06, 5.2941e-06, 5.2941e-06,
        5.2941e-06, 5.2941e-06, 5.2941e-06, 5.2941e-06, 5.2941e-06, 5.2941e-06,
        5.2941e-06, 5.2941e-06, 8.8421e-11, 3.1698e-01, 1.0912e-14, 1.0634e-04,
        8.0629e-14, 6.7046e-20, 1.0912e-14, 1.0912e-14, 3.1698e-01, 1.0912e-14,
        1.1661e-01, 1.5782e-02, 1.9476e-06, 1.0912e-14, 9.9505e-18, 3.9119e-05,
        1.0912e-14, 1.0912e-14, 1.0912e-14, 8.0629e-14, 6.7046e-20, 1.0912e-14,
        6.7046e-20, 2.9662e-14])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 79.27% 

Test Accuracy: 84.11% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6245774421840906
distance x is tensor(121.0455, device='cuda:1')
benign distance is  tensor(121.0455, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.002563964575529
distance x is tensor(97.3061, device='cuda:1')
benign distance is  tensor(97.3061, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7039768844842911
distance x is tensor(105.0488, device='cuda:1')
benign distance is  tensor(105.0488, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8319512363523245
distance x is tensor(131.8153, device='cuda:1')
benign distance is  tensor(131.8153, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9284241674467921
distance x is tensor(95.5486, device='cuda:1')
benign distance is  tensor(95.5486, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6240091575309634
distance x is tensor(99.0187, device='cuda:1')
benign distance is  tensor(99.0187, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0972344316542149
distance x is tensor(101.4547, device='cuda:1')
benign distance is  tensor(101.4547, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8402193486690521
distance x is tensor(85.7737, device='cuda:1')
benign distance is  tensor(85.7737, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9355701245367527
distance x is tensor(85.7055, device='cuda:1')
benign distance is  tensor(85.7055, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7809064127504826
distance x is tensor(119.7307, device='cuda:1')
benign distance is  tensor(119.7307, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9847330804914236
distance x is tensor(60.9682, device='cuda:1')
benign distance is  tensor(60.9682, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4870111532509327
distance x is tensor(112.8372, device='cuda:1')
benign distance is  tensor(112.8372, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0570158064365387
distance x is tensor(146.0983, device='cuda:1')
benign distance is  tensor(146.0983, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6661779973655939
distance x is tensor(54.8399, device='cuda:1')
benign distance is  tensor(54.8399, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.2517037484794855
distance x is tensor(128.4463, device='cuda:1')
benign distance is  tensor(128.4463, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1693450044840574
distance x is tensor(112.8821, device='cuda:1')
benign distance is  tensor(112.8821, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1954932063817978
distance x is tensor(71.6616, device='cuda:1')
benign distance is  tensor(71.6616, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7622012700885534
distance x is tensor(114.1943, device='cuda:1')
benign distance is  tensor(114.1943, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9493227265775204
distance x is tensor(113.4549, device='cuda:1')
benign distance is  tensor(113.4549, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7949768491089344
distance x is tensor(104.1213, device='cuda:1')
benign distance is  tensor(104.1213, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.003012364730239
distance x is tensor(72.0434, device='cuda:1')
benign distance is  tensor(72.0434, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6724097616970539
distance x is tensor(201.5484, device='cuda:1')
benign distance is  tensor(201.5484, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1248506791889668
distance x is tensor(133.4805, device='cuda:1')
benign distance is  tensor(133.4805, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6589096374809742
distance x is tensor(109.1549, device='cuda:1')
benign distance is  tensor(109.1549, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.0008380375802517
distance x is tensor(94.6889, device='cuda:1')
benign distance is  tensor(94.6889, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.1829648911952972
distance x is tensor(110.8333, device='cuda:1')
benign distance is  tensor(110.8333, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.3243428841233253
distance x is tensor(141.7131, device='cuda:1')
benign distance is  tensor(141.7131, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.8983495272696018
distance x is tensor(93.6279, device='cuda:1')
benign distance is  tensor(93.6279, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7700278088450432
distance x is tensor(153.5692, device='cuda:1')
benign distance is  tensor(153.5692, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8233639635145664
distance x is tensor(125.8827, device='cuda:1')
benign distance is  tensor(125.8827, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6644759047776461
distance x is tensor(106.4669, device='cuda:1')
benign distance is  tensor(106.4669, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5370510895736516
distance x is tensor(113.1957, device='cuda:1')
benign distance is  tensor(113.1957, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 17., 16.,  8.,  8.,  8.,
         8.,  8.,  8.,  9., 11., 12.])
count_res tensor([4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03,
        4.6969e-03, 4.6969e-03, 1.7279e-03, 6.9708e-01, 2.5644e-01, 8.6027e-05,
        8.6027e-05, 8.6027e-05, 8.6027e-05, 8.6027e-05, 8.6027e-05, 2.3384e-04,
        1.7279e-03, 4.6969e-03])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 77.29% 

Test Accuracy: 82.59% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6424398180097342
distance x is tensor(124.6770, device='cuda:1')
benign distance is  tensor(124.6770, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7275499012321234
distance x is tensor(84.8649, device='cuda:1')
benign distance is  tensor(84.8649, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7267696000635624
distance x is tensor(106.7813, device='cuda:1')
benign distance is  tensor(106.7813, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.262307483702898
distance x is tensor(132.7900, device='cuda:1')
benign distance is  tensor(132.7900, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9650802696123719
distance x is tensor(86.2833, device='cuda:1')
benign distance is  tensor(86.2833, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7234607711434364
distance x is tensor(97.6013, device='cuda:1')
benign distance is  tensor(97.6013, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4412408135831356
distance x is tensor(85.7646, device='cuda:1')
benign distance is  tensor(85.7646, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.761004138737917
distance x is tensor(80.1664, device='cuda:1')
benign distance is  tensor(80.1664, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([14., 13., 12., 24., 21., 12., 12., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 12., 23., 25., 12., 12., 23.,  1., 18.,
        28.,  0., 13., 27., 12., 26., 12., 32.])
count_res tensor([1.4742e-08, 5.4234e-09, 1.9952e-09, 3.2472e-04, 1.6167e-05, 1.9952e-09,
        1.9952e-09, 1.9952e-09, 3.2472e-04, 3.2472e-04, 3.2472e-04, 3.2472e-04,
        3.2472e-04, 3.2472e-04, 3.2472e-04, 3.2472e-04, 3.2472e-04, 3.2472e-04,
        3.2472e-04, 3.2472e-04, 1.9952e-09, 1.1946e-04, 8.8269e-04, 1.9952e-09,
        1.9952e-09, 1.1946e-04, 3.3323e-14, 8.0491e-07, 1.7729e-02, 1.2259e-14,
        5.4234e-09, 6.5223e-03, 1.9952e-09, 2.3994e-03, 1.9952e-09, 9.6799e-01])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 68.48% 

Test Accuracy: 77.97% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7670594789087772
distance x is tensor(130.3342, device='cuda:1')
benign distance is  tensor(130.3342, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9840721096843481
distance x is tensor(127.2663, device='cuda:1')
benign distance is  tensor(127.2663, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.068397656083107
distance x is tensor(127.3761, device='cuda:1')
benign distance is  tensor(127.3761, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.257441706955433
distance x is tensor(151.0877, device='cuda:1')
benign distance is  tensor(151.0877, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2680705226957798
distance x is tensor(106.8979, device='cuda:1')
benign distance is  tensor(106.8979, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8733130488544703
distance x is tensor(126.6256, device='cuda:1')
benign distance is  tensor(126.6256, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4296415708959103
distance x is tensor(122.5906, device='cuda:1')
benign distance is  tensor(122.5906, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8592169303447008
distance x is tensor(108.7834, device='cuda:1')
benign distance is  tensor(108.7834, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1703709829598665
distance x is tensor(113.9479, device='cuda:1')
benign distance is  tensor(113.9479, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7779830377548933
distance x is tensor(138.5648, device='cuda:1')
benign distance is  tensor(138.5648, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2813810743391514
distance x is tensor(88.3784, device='cuda:1')
benign distance is  tensor(88.3784, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.6435839608311653
distance x is tensor(118.7289, device='cuda:1')
benign distance is  tensor(118.7289, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.3935075998306274
distance x is tensor(224.8700, device='cuda:1')
benign distance is  tensor(224.8700, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.877097874879837
distance x is tensor(72.8885, device='cuda:1')
benign distance is  tensor(72.8885, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1401995345950127
distance x is tensor(142.4167, device='cuda:1')
benign distance is  tensor(142.4167, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.623464897274971
distance x is tensor(80.3175, device='cuda:1')
benign distance is  tensor(80.3175, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.171839103102684
distance x is tensor(126.9161, device='cuda:1')
benign distance is  tensor(126.9161, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9806740991771221
distance x is tensor(130.3061, device='cuda:1')
benign distance is  tensor(130.3061, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.3245165385305882
distance x is tensor(130.3943, device='cuda:1')
benign distance is  tensor(130.3943, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.6429043523967266
distance x is tensor(116.2945, device='cuda:1')
benign distance is  tensor(116.2945, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9975497294217348
distance x is tensor(134.5999, device='cuda:1')
benign distance is  tensor(134.5999, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9160170396789908
distance x is tensor(123.8998, device='cuda:1')
benign distance is  tensor(123.8998, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5877447472885251
distance x is tensor(131.1540, device='cuda:1')
benign distance is  tensor(131.1540, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.9160923883318901
distance x is tensor(177.1157, device='cuda:1')
benign distance is  tensor(177.1157, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([29.,  1., 11., 12., 20., 12., 14., 18., 24., 24., 24., 24., 24., 24.,
        23., 23., 23., 23., 23., 24., 14., 13., 14., 16., 34., 21., 12., 12.,
        12.,  5.,  1., 23., 24., 32., 26., 25.])
count_res tensor([5.8950e-03, 4.0760e-15, 8.9780e-11, 2.4405e-10, 7.2750e-07, 2.4405e-10,
        1.8033e-09, 9.8456e-08, 3.9720e-05, 3.9720e-05, 3.9720e-05, 3.9720e-05,
        3.9720e-05, 3.9720e-05, 1.4612e-05, 1.4612e-05, 1.4612e-05, 1.4612e-05,
        1.4612e-05, 3.9720e-05, 1.8033e-09, 6.6339e-10, 1.8033e-09, 1.3325e-08,
        8.7489e-01, 1.9775e-06, 2.4405e-10, 2.4405e-10, 2.4405e-10, 2.2254e-13,
        4.0760e-15, 1.4612e-05, 3.9720e-05, 1.1840e-01, 2.9349e-04, 1.0797e-04])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 94.85% 

Test Accuracy: 84.24% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6834771670401096
distance x is tensor(153.6730, device='cuda:1')
benign distance is  tensor(153.6730, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9363299589604139
distance x is tensor(106.6093, device='cuda:1')
benign distance is  tensor(106.6093, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7005019262433052
distance x is tensor(116.9218, device='cuda:1')
benign distance is  tensor(116.9218, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8891769032925367
distance x is tensor(159.2619, device='cuda:1')
benign distance is  tensor(159.2619, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8672338034957647
distance x is tensor(93.2731, device='cuda:1')
benign distance is  tensor(93.2731, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5511726504191756
distance x is tensor(118.5170, device='cuda:1')
benign distance is  tensor(118.5170, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1122725773602724
distance x is tensor(112.1522, device='cuda:1')
benign distance is  tensor(112.1522, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6237629437819123
distance x is tensor(96.5681, device='cuda:1')
benign distance is  tensor(96.5681, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1849935241043568
distance x is tensor(115.9850, device='cuda:1')
benign distance is  tensor(115.9850, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7827247306704521
distance x is tensor(131.9967, device='cuda:1')
benign distance is  tensor(131.9967, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8710498698055744
distance x is tensor(133.7392, device='cuda:1')
benign distance is  tensor(133.7392, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7588404286652803
distance x is tensor(116.1791, device='cuda:1')
benign distance is  tensor(116.1791, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.8753490019589663
distance x is tensor(87.8518, device='cuda:1')
benign distance is  tensor(87.8518, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5486996863037348
distance x is tensor(217.2527, device='cuda:1')
benign distance is  tensor(217.2527, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.428688656538725
distance x is tensor(156.1579, device='cuda:1')
benign distance is  tensor(156.1579, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7067834567278624
distance x is tensor(118.9757, device='cuda:1')
benign distance is  tensor(118.9757, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8063867520540953
distance x is tensor(129.4757, device='cuda:1')
benign distance is  tensor(129.4757, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.8338871076703072
distance x is tensor(103.2135, device='cuda:1')
benign distance is  tensor(103.2135, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6759673021733761
distance x is tensor(157.0160, device='cuda:1')
benign distance is  tensor(157.0160, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.0321254711598158
distance x is tensor(129.5549, device='cuda:1')
benign distance is  tensor(129.5549, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8296696040779352
distance x is tensor(65.8428, device='cuda:1')
benign distance is  tensor(65.8428, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7542848438024521
distance x is tensor(97.4086, device='cuda:1')
benign distance is  tensor(97.4086, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7623524628579617
distance x is tensor(106.2932, device='cuda:1')
benign distance is  tensor(106.2932, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.694931966252625
distance x is tensor(117.4311, device='cuda:1')
benign distance is  tensor(117.4311, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([13., 15., 12., 13., 26., 13., 13., 13., 15., 15., 15., 15., 15., 15.,
        15., 15., 15., 15., 15., 16., 13., 13., 13., 16., 27., 13., 13., 13.])
count_res tensor([6.0784e-07, 4.4914e-06, 2.2361e-07, 6.0784e-07, 2.6892e-01, 6.0784e-07,
        6.0784e-07, 6.0784e-07, 4.4914e-06, 4.4914e-06, 4.4914e-06, 4.4914e-06,
        4.4914e-06, 4.4914e-06, 4.4914e-06, 4.4914e-06, 4.4914e-06, 4.4914e-06,
        4.4914e-06, 1.2209e-05, 6.0784e-07, 6.0784e-07, 6.0784e-07, 1.2209e-05,
        7.3100e-01, 6.0784e-07, 6.0784e-07, 6.0784e-07])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 65.36% 

Test Accuracy: 79.64% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8707475755363703
distance x is tensor(141.2571, device='cuda:1')
benign distance is  tensor(141.2571, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0448134392499924
distance x is tensor(104.8032, device='cuda:1')
benign distance is  tensor(104.8032, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.074823759496212
distance x is tensor(120.0945, device='cuda:1')
benign distance is  tensor(120.0945, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9911527559161186
distance x is tensor(157.3428, device='cuda:1')
benign distance is  tensor(157.3428, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0707872807979584
distance x is tensor(85.8945, device='cuda:1')
benign distance is  tensor(85.8945, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7835450619459152
distance x is tensor(109.8395, device='cuda:1')
benign distance is  tensor(109.8395, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.441268015652895
distance x is tensor(120.0992, device='cuda:1')
benign distance is  tensor(120.0992, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9242215808480978
distance x is tensor(98.5660, device='cuda:1')
benign distance is  tensor(98.5660, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9480330683290958
distance x is tensor(102.2648, device='cuda:1')
benign distance is  tensor(102.2648, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9796809833496809
distance x is tensor(133.7327, device='cuda:1')
benign distance is  tensor(133.7327, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3201788440346718
distance x is tensor(78.1719, device='cuda:1')
benign distance is  tensor(78.1719, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3738023713231087
distance x is tensor(125.0951, device='cuda:1')
benign distance is  tensor(125.0951, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.127673476934433
distance x is tensor(136.0370, device='cuda:1')
benign distance is  tensor(136.0370, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.077441381290555
distance x is tensor(71.8345, device='cuda:1')
benign distance is  tensor(71.8345, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0441291835159063
distance x is tensor(138.9672, device='cuda:1')
benign distance is  tensor(138.9672, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.6272383034229279
distance x is tensor(126.3415, device='cuda:1')
benign distance is  tensor(126.3415, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([13., 13., 12., 13., 12., 12., 12., 13., 11., 17., 16.,  8.,  8.,  8.,
         8.,  8.,  7.,  8., 10., 11.])
count_res tensor([1.2419e-02, 1.2419e-02, 4.5689e-03, 1.2419e-02, 4.5689e-03, 4.5689e-03,
        4.5689e-03, 1.2419e-02, 1.6808e-03, 6.7808e-01, 2.4945e-01, 8.3682e-05,
        8.3682e-05, 8.3682e-05, 8.3682e-05, 8.3682e-05, 3.0785e-05, 8.3682e-05,
        6.1833e-04, 1.6808e-03])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 53.69% 

Test Accuracy: 73.59% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.749757919460535
distance x is tensor(132.0032, device='cuda:1')
benign distance is  tensor(132.0032, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2318111509084702
distance x is tensor(102.8887, device='cuda:1')
benign distance is  tensor(102.8887, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.007256891578436
distance x is tensor(104.8857, device='cuda:1')
benign distance is  tensor(104.8857, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9661676958203316
distance x is tensor(142.4654, device='cuda:1')
benign distance is  tensor(142.4654, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0836954433470964
distance x is tensor(91.0995, device='cuda:1')
benign distance is  tensor(91.0995, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9414499830454588
distance x is tensor(112.5496, device='cuda:1')
benign distance is  tensor(112.5496, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4156836830079556
distance x is tensor(104.0764, device='cuda:1')
benign distance is  tensor(104.0764, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0109383426606655
distance x is tensor(95.1103, device='cuda:1')
benign distance is  tensor(95.1103, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 52
counter_tensor is  tensor([ 0., 48., 30., 34., 32., 36., 12., 12., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 50., 50.,  0., 47., 12., 12.,  5., 15.,
        21., 51., 12., 13., 12., 51.,  8., 14., 19., 25., 38., 43., 31.,  0.,
        42., 24., 12., 12., 12., 12.,  0., 51.,  0., 26.])
count_res tensor([1.8650e-23, 1.3086e-02, 1.9930e-10, 1.0882e-08, 1.4727e-09, 8.0405e-08,
        3.0354e-18, 3.0354e-18, 4.3900e-06, 4.3900e-06, 4.3900e-06, 4.3900e-06,
        4.3900e-06, 4.3900e-06, 4.3900e-06, 4.3900e-06, 4.3900e-06, 4.3900e-06,
        4.3900e-06, 4.3900e-06, 9.6695e-02, 9.6695e-02, 1.8650e-23, 4.8142e-03,
        3.0354e-18, 3.0354e-18, 2.7679e-21, 6.0967e-17, 2.4596e-14, 2.6285e-01,
        3.0354e-18, 8.2511e-18, 3.0354e-18, 2.6285e-01, 5.5595e-20, 2.2429e-17,
        3.3287e-15, 1.3429e-12, 5.9412e-07, 8.8175e-05, 5.4176e-10, 1.8650e-23,
        3.2438e-05, 4.9402e-13, 3.0354e-18, 3.0354e-18, 3.0354e-18, 3.0354e-18,
        1.8650e-23, 2.6285e-01, 1.8650e-23, 3.6504e-12])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 76.92% 

Test Accuracy: 84.49% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6452838629484177
distance x is tensor(112.8777, device='cuda:1')
benign distance is  tensor(112.8777, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8968898477032781
distance x is tensor(103.6040, device='cuda:1')
benign distance is  tensor(103.6040, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8285820931196213
distance x is tensor(111.3962, device='cuda:1')
benign distance is  tensor(111.3962, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1709348820149899
distance x is tensor(138.0268, device='cuda:1')
benign distance is  tensor(138.0268, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8795534651726484
distance x is tensor(85.3881, device='cuda:1')
benign distance is  tensor(85.3881, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7744795549660921
distance x is tensor(109.7350, device='cuda:1')
benign distance is  tensor(109.7350, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.116057101637125
distance x is tensor(104.1311, device='cuda:1')
benign distance is  tensor(104.1311, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.801764789968729
distance x is tensor(85.2352, device='cuda:1')
benign distance is  tensor(85.2352, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9156973008066416
distance x is tensor(90.8365, device='cuda:1')
benign distance is  tensor(90.8365, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7006198074668646
distance x is tensor(124.5191, device='cuda:1')
benign distance is  tensor(124.5191, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9838369451463223
distance x is tensor(65.7048, device='cuda:1')
benign distance is  tensor(65.7048, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2092093788087368
distance x is tensor(116.5700, device='cuda:1')
benign distance is  tensor(116.5700, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0677541680634022
distance x is tensor(158.3596, device='cuda:1')
benign distance is  tensor(158.3596, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9016831070184708
distance x is tensor(35.3619, device='cuda:1')
benign distance is  tensor(35.3619, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0546627696603537
distance x is tensor(125.3344, device='cuda:1')
benign distance is  tensor(125.3344, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.5948721021413803
distance x is tensor(93.2902, device='cuda:1')
benign distance is  tensor(93.2902, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.0552426278591156
distance x is tensor(82.6700, device='cuda:1')
benign distance is  tensor(82.6700, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8317971639335155
distance x is tensor(118.8500, device='cuda:1')
benign distance is  tensor(118.8500, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.847935700789094
distance x is tensor(114.3793, device='cuda:1')
benign distance is  tensor(114.3793, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9969780594110489
distance x is tensor(104.9884, device='cuda:1')
benign distance is  tensor(104.9884, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.008144935593009
distance x is tensor(75.0351, device='cuda:1')
benign distance is  tensor(75.0351, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7374565862119198
distance x is tensor(199.9971, device='cuda:1')
benign distance is  tensor(199.9971, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1101887226104736
distance x is tensor(145.5511, device='cuda:1')
benign distance is  tensor(145.5511, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.709840252995491
distance x is tensor(111.5764, device='cuda:1')
benign distance is  tensor(111.5764, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.0399996265769005
distance x is tensor(117.5312, device='cuda:1')
benign distance is  tensor(117.5312, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7986873276531696
distance x is tensor(67.3289, device='cuda:1')
benign distance is  tensor(67.3289, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8259557392448187
distance x is tensor(117.7775, device='cuda:1')
benign distance is  tensor(117.7775, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.3654528371989727
distance x is tensor(107.6098, device='cuda:1')
benign distance is  tensor(107.6098, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.936491783708334
distance x is tensor(123.0419, device='cuda:1')
benign distance is  tensor(123.0419, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8147700820118189
distance x is tensor(89.1263, device='cuda:1')
benign distance is  tensor(89.1263, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6106296572834253
distance x is tensor(109.7884, device='cuda:1')
benign distance is  tensor(109.7884, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7697532922029495
distance x is tensor(160.8296, device='cuda:1')
benign distance is  tensor(160.8296, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.194682477042079
distance x is tensor(93.1651, device='cuda:1')
benign distance is  tensor(93.1651, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.305865090340376
distance x is tensor(121.6853, device='cuda:1')
benign distance is  tensor(121.6853, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.034365562722087
distance x is tensor(142.7682, device='cuda:1')
benign distance is  tensor(142.7682, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.0921392440795898
distance x is tensor(87.6171, device='cuda:1')
benign distance is  tensor(87.6171, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.8823699858039618
distance x is tensor(159.3635, device='cuda:1')
benign distance is  tensor(159.3635, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.9372096974402666
distance x is tensor(127.9120, device='cuda:1')
benign distance is  tensor(127.9120, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9529411550611258
distance x is tensor(106.1409, device='cuda:1')
benign distance is  tensor(106.1409, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6151373032480478
distance x is tensor(116.8567, device='cuda:1')
benign distance is  tensor(116.8567, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 17., 16.,  8.,  8.,  8.,
         8.,  8.,  8.,  9., 12., 11.])
count_res tensor([4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03,
        4.6969e-03, 4.6969e-03, 1.7279e-03, 6.9708e-01, 2.5644e-01, 8.6027e-05,
        8.6027e-05, 8.6027e-05, 8.6027e-05, 8.6027e-05, 8.6027e-05, 2.3384e-04,
        4.6969e-03, 1.7279e-03])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 71.54% 

Test Accuracy: 82.41% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6620015539228916
distance x is tensor(117.8637, device='cuda:1')
benign distance is  tensor(117.8637, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8128454033285379
distance x is tensor(102.8736, device='cuda:1')
benign distance is  tensor(102.8736, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8037122655659914
distance x is tensor(106.5767, device='cuda:1')
benign distance is  tensor(106.5767, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9833197612315416
distance x is tensor(136.4702, device='cuda:1')
benign distance is  tensor(136.4702, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9758092127740383
distance x is tensor(86.0505, device='cuda:1')
benign distance is  tensor(86.0505, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7834976678714156
distance x is tensor(102.4521, device='cuda:1')
benign distance is  tensor(102.4521, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.520643386989832
distance x is tensor(92.2448, device='cuda:1')
benign distance is  tensor(92.2448, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7184601621702313
distance x is tensor(80.8462, device='cuda:1')
benign distance is  tensor(80.8462, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([12.,  0., 32.,  0.,  0., 12., 13., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 31., 35., 12., 12., 35., 12., 15., 13.,
         1., 17., 12., 32., 34., 30., 12., 12.])
count_res tensor([4.1168e-11, 2.5294e-16, 1.9973e-02, 2.5294e-16, 2.5294e-16, 4.1168e-11,
        1.1191e-10, 4.1168e-11, 6.7002e-06, 6.7002e-06, 6.7002e-06, 6.7002e-06,
        6.7002e-06, 6.7002e-06, 6.7002e-06, 6.7002e-06, 6.7002e-06, 6.7002e-06,
        6.7002e-06, 6.7002e-06, 7.3477e-03, 4.0117e-01, 4.1168e-11, 4.1168e-11,
        4.0117e-01, 4.1168e-11, 8.2687e-10, 1.1191e-10, 6.8757e-16, 6.1098e-09,
        4.1168e-11, 1.9973e-02, 1.4758e-01, 2.7031e-03, 4.1168e-11, 4.1168e-11])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 88.08% 

Test Accuracy: 85.59% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 88.08%
|----0th round Training Accuracy : 96.48%
|----1th round Training Accuracy : 86.00%
|----2th round Training Accuracy : 90.08%
|----3th round Training Accuracy : 76.98%
|----4th round Training Accuracy : 85.75%
|----5th round Training Accuracy : 87.16%
|----6th round Training Accuracy : 83.65%
|----7th round Training Accuracy : 84.96%
|----8th round Training Accuracy : 82.16%
|----9th round Training Accuracy : 91.75%
|----10th round Training Accuracy : 91.42%
|----11th round Training Accuracy : 86.11%
|----12th round Training Accuracy : 83.27%
|----13th round Training Accuracy : 83.32%
|----14th round Training Accuracy : 78.71%
|----15th round Training Accuracy : 73.40%
|----16th round Training Accuracy : 79.56%
|----17th round Training Accuracy : 82.95%
|----18th round Training Accuracy : 78.19%
|----19th round Training Accuracy : 78.13%
|----20th round Training Accuracy : 74.76%
|----21th round Training Accuracy : 76.20%
|----22th round Training Accuracy : 83.94%
|----23th round Training Accuracy : 77.14%
|----24th round Training Accuracy : 67.58%
|----25th round Training Accuracy : 75.60%
|----26th round Training Accuracy : 69.07%
|----27th round Training Accuracy : 78.30%
|----28th round Training Accuracy : 72.70%
|----29th round Training Accuracy : 89.60%
|----30th round Training Accuracy : 89.46%
|----31th round Training Accuracy : 93.99%
|----32th round Training Accuracy : 89.37%
|----33th round Training Accuracy : 80.48%
|----34th round Training Accuracy : 65.56%
|----35th round Training Accuracy : 76.60%
|----36th round Training Accuracy : 71.63%
|----37th round Training Accuracy : 73.86%
|----38th round Training Accuracy : 79.00%
|----39th round Training Accuracy : 80.16%
|----40th round Training Accuracy : 79.52%
|----41th round Training Accuracy : 79.27%
|----42th round Training Accuracy : 77.29%
|----43th round Training Accuracy : 68.48%
|----44th round Training Accuracy : 94.85%
|----45th round Training Accuracy : 65.36%
|----46th round Training Accuracy : 53.69%
|----47th round Training Accuracy : 76.92%
|----48th round Training Accuracy : 71.54%
|----49th round Training Accuracy : 88.08%
|----Final Test Accuracy: 85.59%
|----0th round Final Test Accuracy : 86.96%
|----1th round Final Test Accuracy : 84.69%
|----2th round Final Test Accuracy : 86.78%
|----3th round Final Test Accuracy : 79.08%
|----4th round Final Test Accuracy : 84.68%
|----5th round Final Test Accuracy : 84.22%
|----6th round Final Test Accuracy : 80.81%
|----7th round Final Test Accuracy : 85.88%
|----8th round Final Test Accuracy : 81.34%
|----9th round Final Test Accuracy : 85.24%
|----10th round Final Test Accuracy : 81.79%
|----11th round Final Test Accuracy : 86.70%
|----12th round Final Test Accuracy : 84.65%
|----13th round Final Test Accuracy : 84.75%
|----14th round Final Test Accuracy : 78.64%
|----15th round Final Test Accuracy : 79.02%
|----16th round Final Test Accuracy : 82.78%
|----17th round Final Test Accuracy : 83.80%
|----18th round Final Test Accuracy : 79.17%
|----19th round Final Test Accuracy : 85.01%
|----20th round Final Test Accuracy : 82.43%
|----21th round Final Test Accuracy : 83.45%
|----22th round Final Test Accuracy : 86.60%
|----23th round Final Test Accuracy : 84.52%
|----24th round Final Test Accuracy : 78.18%
|----25th round Final Test Accuracy : 80.99%
|----26th round Final Test Accuracy : 80.46%
|----27th round Final Test Accuracy : 83.80%
|----28th round Final Test Accuracy : 81.49%
|----29th round Final Test Accuracy : 86.75%
|----30th round Final Test Accuracy : 85.40%
|----31th round Final Test Accuracy : 88.12%
|----32th round Final Test Accuracy : 86.72%
|----33th round Final Test Accuracy : 85.17%
|----34th round Final Test Accuracy : 77.47%
|----35th round Final Test Accuracy : 84.30%
|----36th round Final Test Accuracy : 82.23%
|----37th round Final Test Accuracy : 82.22%
|----38th round Final Test Accuracy : 82.54%
|----39th round Final Test Accuracy : 84.95%
|----40th round Final Test Accuracy : 83.56%
|----41th round Final Test Accuracy : 84.11%
|----42th round Final Test Accuracy : 82.59%
|----43th round Final Test Accuracy : 77.97%
|----44th round Final Test Accuracy : 84.24%
|----45th round Final Test Accuracy : 79.64%
|----46th round Final Test Accuracy : 73.59%
|----47th round Final Test Accuracy : 84.49%
|----48th round Final Test Accuracy : 82.41%
|----49th round Final Test Accuracy : 85.59%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 4195.6816
