
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8208379745483398
distance x is tensor(115.0982, device='cuda:0')
benign distance is  tensor(115.0982, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.45439019799232483
distance x is tensor(116.6786, device='cuda:0')
benign distance is  tensor(116.6786, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6592074632644653
distance x is tensor(126.9203, device='cuda:0')
benign distance is  tensor(126.9203, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9568931460380554
distance x is tensor(111.5407, device='cuda:0')
benign distance is  tensor(111.5407, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7794100046157837
distance x is tensor(103.2200, device='cuda:0')
benign distance is  tensor(103.2200, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.38823598623275757
distance x is tensor(116.7376, device='cuda:0')
benign distance is  tensor(116.7376, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7685805559158325
distance x is tensor(115.3942, device='cuda:0')
benign distance is  tensor(115.3942, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.19154225289821625
distance x is tensor(118.8969, device='cuda:0')
benign distance is  tensor(118.8969, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.1909889578819275
distance x is tensor(136.5835, device='cuda:0')
benign distance is  tensor(136.5835, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3720482885837555
distance x is tensor(134.6113, device='cuda:0')
benign distance is  tensor(134.6113, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.40939125418663025
distance x is tensor(123.3270, device='cuda:0')
benign distance is  tensor(123.3270, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.336122989654541
distance x is tensor(125.1960, device='cuda:0')
benign distance is  tensor(125.1960, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.294613242149353
distance x is tensor(129.9972, device='cuda:0')
benign distance is  tensor(129.9972, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2676628530025482
distance x is tensor(140.0901, device='cuda:0')
benign distance is  tensor(140.0901, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6060191988945007
distance x is tensor(138.4650, device='cuda:0')
benign distance is  tensor(138.4650, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.2739570736885071
distance x is tensor(143.4520, device='cuda:0')
benign distance is  tensor(143.4520, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4592522084712982
distance x is tensor(126.2457, device='cuda:0')
benign distance is  tensor(126.2457, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6751371622085571
distance x is tensor(148.2657, device='cuda:0')
benign distance is  tensor(148.2657, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4969528615474701
distance x is tensor(125.6940, device='cuda:0')
benign distance is  tensor(125.6940, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7454884648323059
distance x is tensor(124.2221, device='cuda:0')
benign distance is  tensor(124.2221, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.09700894355773926
distance x is tensor(126.8183, device='cuda:0')
benign distance is  tensor(126.8183, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.25471892952919006
distance x is tensor(120.7165, device='cuda:0')
benign distance is  tensor(120.7165, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.6123635768890381
distance x is tensor(144.7864, device='cuda:0')
benign distance is  tensor(144.7864, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.9729062914848328
distance x is tensor(131.2510, device='cuda:0')
benign distance is  tensor(131.2510, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.6848406791687012
distance x is tensor(146.0685, device='cuda:0')
benign distance is  tensor(146.0685, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5448963642120361
distance x is tensor(125.2765, device='cuda:0')
benign distance is  tensor(125.2765, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5101462602615356
distance x is tensor(147.8273, device='cuda:0')
benign distance is  tensor(147.8273, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3470436930656433
distance x is tensor(136.5437, device='cuda:0')
benign distance is  tensor(136.5437, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8365820646286011
distance x is tensor(126.1641, device='cuda:0')
benign distance is  tensor(126.1641, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9733543395996094
distance x is tensor(134.8442, device='cuda:0')
benign distance is  tensor(134.8442, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.23669734597206116
distance x is tensor(122.8407, device='cuda:0')
benign distance is  tensor(122.8407, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.5605652332305908
distance x is tensor(132.8846, device='cuda:0')
benign distance is  tensor(132.8846, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.4993188977241516
distance x is tensor(136.0133, device='cuda:0')
benign distance is  tensor(136.0133, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.26908838748931885
distance x is tensor(127.7638, device='cuda:0')
benign distance is  tensor(127.7638, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.2859329581260681
distance x is tensor(131.1370, device='cuda:0')
benign distance is  tensor(131.1370, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.10367022454738617
distance x is tensor(125.4830, device='cuda:0')
benign distance is  tensor(125.4830, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.2769525945186615
distance x is tensor(129.0491, device='cuda:0')
benign distance is  tensor(129.0491, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.32308217883110046
distance x is tensor(125.2024, device='cuda:0')
benign distance is  tensor(125.2024, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.2502773702144623
distance x is tensor(124.8036, device='cuda:0')
benign distance is  tensor(124.8036, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.11430446803569794
distance x is tensor(127.9630, device='cuda:0')
benign distance is  tensor(127.9630, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.12909488379955292
distance x is tensor(122.9747, device='cuda:0')
benign distance is  tensor(122.9747, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.32987669110298157
distance x is tensor(122.7723, device='cuda:0')
benign distance is  tensor(122.7723, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.1392425000667572
distance x is tensor(130.0537, device='cuda:0')
benign distance is  tensor(130.0537, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.12029744684696198
distance x is tensor(132.8220, device='cuda:0')
benign distance is  tensor(132.8220, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.34096866846084595
distance x is tensor(134.0926, device='cuda:0')
benign distance is  tensor(134.0926, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5260148644447327
distance x is tensor(130.1748, device='cuda:0')
benign distance is  tensor(130.1748, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9501428604125977
distance x is tensor(141.6754, device='cuda:0')
benign distance is  tensor(141.6754, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.28697794675827026
distance x is tensor(138.0439, device='cuda:0')
benign distance is  tensor(138.0439, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  0
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.24445362389087677
mal_entropy is 0.13273985683918
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([523.6279, 537.0522, 569.7926, 508.2947, 473.2762, 532.7653, 512.4362,
        557.3390, 631.8383, 631.8383, 631.8383, 631.8383, 631.8383, 631.8383,
        631.8383, 631.8383, 631.8383, 631.8383, 631.8383, 631.8383],
       device='cuda:0')
sorted_norm is   tensor([473.2762, 508.2947, 512.4362, 523.6279, 532.7653, 537.0522, 557.3390,
        569.7926, 631.8383, 631.8383, 631.8383, 631.8383, 631.8383, 631.8383,
        631.8383, 631.8383, 631.8383, 631.8383, 631.8383, 631.8383],
       device='cuda:0')
used idx is  tensor([ 4,  3,  6,  0,  5,  1,  7,  2, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 89.03% 

Test Accuracy: 88.46% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9356298446655273
distance x is tensor(112.9033, device='cuda:0')
benign distance is  tensor(112.9033, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8238991498947144
distance x is tensor(118.7762, device='cuda:0')
benign distance is  tensor(118.7762, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5839018821716309
distance x is tensor(121.9197, device='cuda:0')
benign distance is  tensor(121.9197, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5112298130989075
distance x is tensor(109.0197, device='cuda:0')
benign distance is  tensor(109.0197, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8736433982849121
distance x is tensor(110.0891, device='cuda:0')
benign distance is  tensor(110.0891, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.260625958442688
distance x is tensor(121.3116, device='cuda:0')
benign distance is  tensor(121.3116, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5805147290229797
distance x is tensor(127.7234, device='cuda:0')
benign distance is  tensor(127.7234, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.45015090703964233
distance x is tensor(126.8866, device='cuda:0')
benign distance is  tensor(126.8866, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  0
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8000000005000001
mal_loss is 0.7469087243080139
mal_entropy is 0.12117477506399155
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([506.9935, 539.0773, 540.9028, 479.2539, 486.2676, 542.4691, 562.8027,
        572.0284, 572.0284, 572.0284, 572.0284, 572.0284, 572.0284, 572.0284,
        572.0284, 572.0284, 572.0284, 572.0284, 572.0284, 572.0284, 698.3441,
        691.0182, 648.5397, 660.7278, 671.9215, 713.1828, 707.8062, 722.7327],
       device='cuda:0')
sorted_norm is   tensor([479.2539, 486.2676, 506.9935, 539.0773, 540.9028, 542.4691, 562.8027,
        572.0284, 572.0284, 572.0284, 572.0284, 572.0284, 572.0284, 572.0284,
        572.0284, 572.0284, 572.0284, 572.0284, 572.0284, 572.0284, 648.5397,
        660.7278, 671.9215, 691.0182, 698.3441, 707.8062, 713.1828, 722.7327],
       device='cuda:0')
used idx is  tensor([ 3,  4,  0,  1,  2,  5,  6, 19, 15, 18, 16, 17, 13, 12, 14,  7, 11, 10,
         8,  9, 22, 23], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 88.42% 

Test Accuracy: 87.70% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5926029682159424
distance x is tensor(119.6263, device='cuda:0')
benign distance is  tensor(119.6263, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.1858934611082077
distance x is tensor(133.1172, device='cuda:0')
benign distance is  tensor(133.1172, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7343876361846924
distance x is tensor(134.2932, device='cuda:0')
benign distance is  tensor(134.2932, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6727914810180664
distance x is tensor(121.3459, device='cuda:0')
benign distance is  tensor(121.3459, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9057393074035645
distance x is tensor(118.3229, device='cuda:0')
benign distance is  tensor(118.3229, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9329797625541687
distance x is tensor(130.3486, device='cuda:0')
benign distance is  tensor(130.3486, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6541733741760254
distance x is tensor(125.9796, device='cuda:0')
benign distance is  tensor(125.9796, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.935425877571106
distance x is tensor(111.5958, device='cuda:0')
benign distance is  tensor(111.5958, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4293879568576813
distance x is tensor(152.0445, device='cuda:0')
benign distance is  tensor(152.0445, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.32890525460243225
distance x is tensor(140.8777, device='cuda:0')
benign distance is  tensor(140.8777, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1810392141342163
distance x is tensor(137.8111, device='cuda:0')
benign distance is  tensor(137.8111, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0228259563446045
distance x is tensor(132.1422, device='cuda:0')
benign distance is  tensor(132.1422, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5086313486099243
distance x is tensor(140.7155, device='cuda:0')
benign distance is  tensor(140.7155, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.09085114300251007
distance x is tensor(148.5991, device='cuda:0')
benign distance is  tensor(148.5991, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6344844102859497
distance x is tensor(145.3323, device='cuda:0')
benign distance is  tensor(145.3323, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5702811479568481
distance x is tensor(161.0097, device='cuda:0')
benign distance is  tensor(161.0097, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  0
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.9860044717788696
mal_entropy is 0.16087046265602112
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([532.1757, 603.7788, 586.0641, 528.1947, 522.9233, 577.9039, 563.0148,
        500.1472, 697.4869, 697.4869, 697.4869, 697.4869, 697.4869, 697.4869,
        697.4869, 697.4869, 697.4869, 697.4869, 697.4869, 697.4869, 714.5996,
        805.1103, 719.5298, 721.9383, 721.0208, 698.0514, 781.8696, 726.2764],
       device='cuda:0')
sorted_norm is   tensor([500.1472, 522.9233, 528.1947, 532.1757, 563.0148, 577.9039, 586.0641,
        603.7788, 697.4869, 697.4869, 697.4869, 697.4869, 697.4869, 697.4869,
        697.4869, 697.4869, 697.4869, 697.4869, 697.4869, 697.4869, 698.0514,
        714.5996, 719.5298, 721.0208, 721.9383, 726.2764, 781.8696, 805.1103],
       device='cuda:0')
used idx is  tensor([ 7,  4,  3,  0,  6,  5,  2,  1, 19, 18, 16, 17, 13, 12, 14, 15, 11, 10,
         8,  9, 25, 20], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 88.70% 

Test Accuracy: 87.74% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4818233549594879
distance x is tensor(113.5574, device='cuda:0')
benign distance is  tensor(113.5574, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6109592914581299
distance x is tensor(130.3453, device='cuda:0')
benign distance is  tensor(130.3453, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4398210942745209
distance x is tensor(133.7362, device='cuda:0')
benign distance is  tensor(133.7362, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8040639162063599
distance x is tensor(128.1078, device='cuda:0')
benign distance is  tensor(128.1078, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0206125974655151
distance x is tensor(117.8452, device='cuda:0')
benign distance is  tensor(117.8452, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7143445014953613
distance x is tensor(135.0710, device='cuda:0')
benign distance is  tensor(135.0710, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.712539553642273
distance x is tensor(133.2697, device='cuda:0')
benign distance is  tensor(133.2697, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.08291782438755035
distance x is tensor(112.5135, device='cuda:0')
benign distance is  tensor(112.5135, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3477725386619568
distance x is tensor(143.7880, device='cuda:0')
benign distance is  tensor(143.7880, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6415281891822815
distance x is tensor(160.1583, device='cuda:0')
benign distance is  tensor(160.1583, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.48633116483688354
distance x is tensor(130.8183, device='cuda:0')
benign distance is  tensor(130.8183, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.15076832473278046
distance x is tensor(133.8583, device='cuda:0')
benign distance is  tensor(133.8583, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5438498258590698
distance x is tensor(136.0233, device='cuda:0')
benign distance is  tensor(136.0233, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0302830934524536
distance x is tensor(150.7144, device='cuda:0')
benign distance is  tensor(150.7144, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2483139932155609
distance x is tensor(144.6605, device='cuda:0')
benign distance is  tensor(144.6605, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7565250992774963
distance x is tensor(135.6176, device='cuda:0')
benign distance is  tensor(135.6176, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  0
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.45935073494911194
mal_entropy is 0.18233849108219147
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([507.8857, 589.9576, 578.2460, 557.0795, 511.6257, 608.0256, 568.8568,
        491.8618, 605.3826, 605.3826, 605.3826, 605.3826, 605.3826, 605.3826,
        605.3826, 605.3826, 605.3826, 605.3826, 605.3826, 605.3826, 856.7353,
        775.8377, 853.5307, 809.2917, 787.6533, 826.2380, 779.8661, 818.6572,
        771.4219, 720.4603, 719.5377, 698.5283, 722.9003, 754.6797, 742.5032,
        326.1987], device='cuda:0')
sorted_norm is   tensor([326.1987, 491.8618, 507.8857, 511.6257, 557.0795, 568.8568, 578.2460,
        589.9576, 605.3826, 605.3826, 605.3826, 605.3826, 605.3826, 605.3826,
        605.3826, 605.3826, 605.3826, 605.3826, 605.3826, 605.3826, 608.0256,
        698.5283, 719.5377, 720.4603, 722.9003, 742.5032, 754.6797, 771.4219,
        775.8377, 779.8661, 787.6533, 809.2917, 818.6572, 826.2380, 853.5307,
        856.7353], device='cuda:0')
used idx is  tensor([35,  7,  0,  4,  3,  6,  2,  1, 15, 18, 16, 17, 13, 12, 14, 19,  8, 11,
        10,  9,  5, 31, 30, 29, 32, 34, 33, 28], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 89.10% 

Test Accuracy: 88.58% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7884101271629333
distance x is tensor(116.2055, device='cuda:0')
benign distance is  tensor(116.2055, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9056218266487122
distance x is tensor(105.8186, device='cuda:0')
benign distance is  tensor(105.8186, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.20415261387825012
distance x is tensor(128.5195, device='cuda:0')
benign distance is  tensor(128.5195, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8124271631240845
distance x is tensor(123.0107, device='cuda:0')
benign distance is  tensor(123.0107, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9154046177864075
distance x is tensor(107.7805, device='cuda:0')
benign distance is  tensor(107.7805, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1548421382904053
distance x is tensor(135.1124, device='cuda:0')
benign distance is  tensor(135.1124, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2364438772201538
distance x is tensor(107.8224, device='cuda:0')
benign distance is  tensor(107.8224, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5153874158859253
distance x is tensor(91.2985, device='cuda:0')
benign distance is  tensor(91.2985, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.06337869167327881
distance x is tensor(136.4596, device='cuda:0')
benign distance is  tensor(136.4596, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3701973855495453
distance x is tensor(133.3600, device='cuda:0')
benign distance is  tensor(133.3600, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.40814119577407837
distance x is tensor(128.8590, device='cuda:0')
benign distance is  tensor(128.8590, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6862095594406128
distance x is tensor(124.4645, device='cuda:0')
benign distance is  tensor(124.4645, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7213695049285889
distance x is tensor(124.0350, device='cuda:0')
benign distance is  tensor(124.0350, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.026859086006879807
distance x is tensor(145.1131, device='cuda:0')
benign distance is  tensor(145.1131, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5511953830718994
distance x is tensor(134.4295, device='cuda:0')
benign distance is  tensor(134.4295, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8085741996765137
distance x is tensor(111.4658, device='cuda:0')
benign distance is  tensor(111.4658, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.6514853239059448
distance x is tensor(146.2517, device='cuda:0')
benign distance is  tensor(146.2517, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6531394124031067
distance x is tensor(133.2453, device='cuda:0')
benign distance is  tensor(133.2453, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.40130430459976196
distance x is tensor(142.5533, device='cuda:0')
benign distance is  tensor(142.5533, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.6542435884475708
distance x is tensor(137.4704, device='cuda:0')
benign distance is  tensor(137.4704, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9940087199211121
distance x is tensor(131.4391, device='cuda:0')
benign distance is  tensor(131.4391, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4187183976173401
distance x is tensor(140.3269, device='cuda:0')
benign distance is  tensor(140.3269, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.17708460986614227
distance x is tensor(129.6545, device='cuda:0')
benign distance is  tensor(129.6545, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.1616775542497635
distance x is tensor(137.5706, device='cuda:0')
benign distance is  tensor(137.5706, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  0
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.8675669431686401
mal_entropy is 0.08662205189466476
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([524.7522, 471.8581, 551.5843, 538.5826, 466.3672, 593.6092, 465.0045,
        404.1635, 622.2364, 622.2364, 622.2364, 622.2364, 622.2364, 622.2364,
        622.2364, 622.2364, 622.2364, 622.2364, 622.2364, 622.2364, 825.9651,
        796.3544, 819.0033, 787.8535, 805.1689, 783.3140, 794.9965, 787.4008],
       device='cuda:0')
sorted_norm is   tensor([404.1635, 465.0045, 466.3672, 471.8581, 524.7522, 538.5826, 551.5843,
        593.6092, 622.2364, 622.2364, 622.2364, 622.2364, 622.2364, 622.2364,
        622.2364, 622.2364, 622.2364, 622.2364, 622.2364, 622.2364, 783.3140,
        787.4008, 787.8535, 794.9965, 796.3544, 805.1689, 819.0033, 825.9651],
       device='cuda:0')
used idx is  tensor([ 7,  6,  4,  1,  0,  3,  2,  5, 19, 18, 16, 17, 13, 12, 14, 15, 11, 10,
         8,  9, 25, 27], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 88.82% 

Test Accuracy: 87.80% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5797486305236816
distance x is tensor(118.6834, device='cuda:0')
benign distance is  tensor(118.6834, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0420986413955688
distance x is tensor(121.4753, device='cuda:0')
benign distance is  tensor(121.4753, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.18531456589698792
distance x is tensor(125.3896, device='cuda:0')
benign distance is  tensor(125.3896, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4438939690589905
distance x is tensor(121.6057, device='cuda:0')
benign distance is  tensor(121.6057, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.40792855620384216
distance x is tensor(121.9456, device='cuda:0')
benign distance is  tensor(121.9456, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.13385808467865
distance x is tensor(124.4162, device='cuda:0')
benign distance is  tensor(124.4162, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4237840175628662
distance x is tensor(126.8403, device='cuda:0')
benign distance is  tensor(126.8403, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3259991705417633
distance x is tensor(112.0858, device='cuda:0')
benign distance is  tensor(112.0858, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.4502219259738922
distance x is tensor(122.4545, device='cuda:0')
benign distance is  tensor(122.4545, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.1414688378572464
distance x is tensor(135.7192, device='cuda:0')
benign distance is  tensor(135.7192, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.2999657690525055
distance x is tensor(131.2208, device='cuda:0')
benign distance is  tensor(131.2208, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.21544532477855682
distance x is tensor(126.4118, device='cuda:0')
benign distance is  tensor(126.4118, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.3492403030395508
distance x is tensor(136.9184, device='cuda:0')
benign distance is  tensor(136.9184, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.20359265804290771
distance x is tensor(127.4846, device='cuda:0')
benign distance is  tensor(127.4846, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.8854178190231323
distance x is tensor(131.0114, device='cuda:0')
benign distance is  tensor(131.0114, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.21144580841064453
distance x is tensor(131.8191, device='cuda:0')
benign distance is  tensor(131.8191, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.12126332521438599
mal_entropy is 0.14277732372283936
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([545.5720, 542.9899, 539.4401, 526.4324, 525.5665, 560.0167, 549.6974,
        491.8171, 579.7417, 579.7417, 579.7417, 579.7417, 579.7417, 579.7417,
        579.7417, 579.7417, 579.7417, 579.7417, 579.7417, 579.7417, 821.1119,
        810.2103, 834.8775, 847.3084, 855.8631, 825.5343, 875.0385, 718.1177,
        749.4099, 819.2756, 710.1886, 736.1272, 737.9006, 790.2516, 772.9214,
        538.5926, 689.1359, 670.5439, 660.6366, 644.7173, 639.9631, 732.0013,
        682.5067, 606.3184], device='cuda:0')
sorted_norm is   tensor([491.8171, 525.5665, 526.4324, 538.5926, 539.4401, 542.9899, 545.5720,
        549.6974, 560.0167, 579.7417, 579.7417, 579.7417, 579.7417, 579.7417,
        579.7417, 579.7417, 579.7417, 579.7417, 579.7417, 579.7417, 579.7417,
        606.3184, 639.9631, 644.7173, 660.6366, 670.5439, 682.5067, 689.1359,
        710.1886, 718.1177, 732.0013, 736.1272, 737.9006, 749.4099, 772.9214,
        790.2516, 810.2103, 819.2756, 821.1119, 825.5343, 834.8775, 847.3084,
        855.8631, 875.0385], device='cuda:0')
used idx is  tensor([ 7,  4,  3, 35,  2,  1,  0,  6,  5, 19, 16, 18, 13, 12, 14, 17, 11, 10,
         8,  9, 15, 43, 40, 39, 38, 37, 42, 36, 30, 27, 41, 31, 32, 28, 34],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 89.20% 

Test Accuracy: 88.72% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.18702298402786255
distance x is tensor(118.8851, device='cuda:0')
benign distance is  tensor(118.8851, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3800058364868164
distance x is tensor(119.7567, device='cuda:0')
benign distance is  tensor(119.7567, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3713044226169586
distance x is tensor(122.5090, device='cuda:0')
benign distance is  tensor(122.5090, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6196451187133789
distance x is tensor(108.1046, device='cuda:0')
benign distance is  tensor(108.1046, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7800443768501282
distance x is tensor(96.3284, device='cuda:0')
benign distance is  tensor(96.3284, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.44577327370643616
distance x is tensor(120.4258, device='cuda:0')
benign distance is  tensor(120.4258, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3904991149902344
distance x is tensor(115.5353, device='cuda:0')
benign distance is  tensor(115.5353, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4912777841091156
distance x is tensor(95.3809, device='cuda:0')
benign distance is  tensor(95.3809, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5572192072868347
distance x is tensor(134.9042, device='cuda:0')
benign distance is  tensor(134.9042, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5603433847427368
distance x is tensor(131.3598, device='cuda:0')
benign distance is  tensor(131.3598, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.29503539204597473
distance x is tensor(130.4595, device='cuda:0')
benign distance is  tensor(130.4595, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3080322742462158
distance x is tensor(122.5257, device='cuda:0')
benign distance is  tensor(122.5257, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.39137065410614014
distance x is tensor(133.9059, device='cuda:0')
benign distance is  tensor(133.9059, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.05722187086939812
distance x is tensor(132.1843, device='cuda:0')
benign distance is  tensor(132.1843, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3115667700767517
distance x is tensor(134.5172, device='cuda:0')
benign distance is  tensor(134.5172, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6025668382644653
distance x is tensor(122.6023, device='cuda:0')
benign distance is  tensor(122.6023, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4348319172859192
distance x is tensor(126.1400, device='cuda:0')
benign distance is  tensor(126.1400, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.505952000617981
distance x is tensor(140.6217, device='cuda:0')
benign distance is  tensor(140.6217, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.47709447145462036
distance x is tensor(126.1312, device='cuda:0')
benign distance is  tensor(126.1312, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.37175530195236206
distance x is tensor(124.1187, device='cuda:0')
benign distance is  tensor(124.1187, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.42891114950180054
distance x is tensor(124.8663, device='cuda:0')
benign distance is  tensor(124.8663, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8474146127700806
distance x is tensor(126.9030, device='cuda:0')
benign distance is  tensor(126.9030, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.10707841068506241
distance x is tensor(133.4779, device='cuda:0')
benign distance is  tensor(133.4779, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.1933540105819702
distance x is tensor(114.1213, device='cuda:0')
benign distance is  tensor(114.1213, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.2657727897167206
distance x is tensor(131.1656, device='cuda:0')
benign distance is  tensor(131.1656, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.5361016392707825
distance x is tensor(124.3526, device='cuda:0')
benign distance is  tensor(124.3526, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.14444079995155334
distance x is tensor(127.1332, device='cuda:0')
benign distance is  tensor(127.1332, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.6184015274047852
distance x is tensor(126.2322, device='cuda:0')
benign distance is  tensor(126.2322, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.19159045815467834
distance x is tensor(127.8490, device='cuda:0')
benign distance is  tensor(127.8490, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.3457539975643158
distance x is tensor(126.1138, device='cuda:0')
benign distance is  tensor(126.1138, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.5542255640029907
distance x is tensor(144.9005, device='cuda:0')
benign distance is  tensor(144.9005, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.66988205909729
distance x is tensor(124.1800, device='cuda:0')
benign distance is  tensor(124.1800, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.4749985635280609
mal_entropy is 0.0810752734541893
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([522.0286, 527.1088, 533.9349, 475.7856, 416.4682, 536.3228, 494.6449,
        425.9726, 551.9134, 551.9134, 551.9134, 551.9134, 551.9134, 551.9134,
        551.9134, 551.9134, 551.9134, 551.9134, 551.9134, 551.9134],
       device='cuda:0')
sorted_norm is   tensor([416.4682, 425.9726, 475.7856, 494.6449, 522.0286, 527.1088, 533.9349,
        536.3228, 551.9134, 551.9134, 551.9134, 551.9134, 551.9134, 551.9134,
        551.9134, 551.9134, 551.9134, 551.9134, 551.9134, 551.9134],
       device='cuda:0')
used idx is  tensor([ 4,  7,  3,  6,  0,  1,  2,  5, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 89.23% 

Test Accuracy: 88.55% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7691555023193359
distance x is tensor(122.8824, device='cuda:0')
benign distance is  tensor(122.8824, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6690751910209656
distance x is tensor(122.9201, device='cuda:0')
benign distance is  tensor(122.9201, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.10080728679895401
distance x is tensor(126.1452, device='cuda:0')
benign distance is  tensor(126.1452, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.42460736632347107
distance x is tensor(124.8946, device='cuda:0')
benign distance is  tensor(124.8946, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1860209703445435
distance x is tensor(115.8045, device='cuda:0')
benign distance is  tensor(115.8045, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5576280355453491
distance x is tensor(140.7464, device='cuda:0')
benign distance is  tensor(140.7464, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4348679184913635
distance x is tensor(120.6570, device='cuda:0')
benign distance is  tensor(120.6570, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.542369544506073
distance x is tensor(107.5002, device='cuda:0')
benign distance is  tensor(107.5002, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.9918559193611145
mal_entropy is 0.09179054945707321
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([547.7451, 545.1187, 546.3823, 561.3505, 490.5090, 607.0486, 518.3413,
        475.4652, 475.4652, 475.4652, 475.4652, 475.4652, 475.4652, 475.4652,
        475.4652, 475.4652, 475.4652, 475.4652, 475.4652, 475.4652, 744.1429,
        711.9417, 737.5687, 719.3694, 690.8984, 726.8680, 706.7925, 582.5230,
        655.4445, 645.8192, 633.5836, 616.1072, 643.8502, 638.5707, 672.6190,
        618.4984], device='cuda:0')
sorted_norm is   tensor([475.4652, 475.4652, 475.4652, 475.4652, 475.4652, 475.4652, 475.4652,
        475.4652, 475.4652, 475.4652, 475.4652, 475.4652, 475.4652, 490.5090,
        518.3413, 545.1187, 546.3823, 547.7451, 561.3505, 582.5230, 607.0486,
        616.1072, 618.4984, 633.5836, 638.5707, 643.8502, 645.8192, 655.4445,
        672.6190, 690.8984, 706.7925, 711.9417, 719.3694, 726.8680, 737.5687,
        744.1429], device='cuda:0')
used idx is  tensor([11, 10,  8, 19, 13, 18, 16, 17, 15, 12, 14,  9,  7,  4,  6,  1,  2,  0,
         3, 27,  5, 31, 35, 30, 33, 32, 29, 28], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 89.36% 

Test Accuracy: 88.36% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4508114457130432
distance x is tensor(127.7773, device='cuda:0')
benign distance is  tensor(127.7773, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8335277438163757
distance x is tensor(125.1167, device='cuda:0')
benign distance is  tensor(125.1167, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.34515026211738586
distance x is tensor(126.0031, device='cuda:0')
benign distance is  tensor(126.0031, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6107127070426941
distance x is tensor(112.4867, device='cuda:0')
benign distance is  tensor(112.4867, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1134116649627686
distance x is tensor(114.7785, device='cuda:0')
benign distance is  tensor(114.7785, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3069849014282227
distance x is tensor(126.2738, device='cuda:0')
benign distance is  tensor(126.2738, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.22704072296619415
distance x is tensor(135.1858, device='cuda:0')
benign distance is  tensor(135.1858, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.40134692192077637
distance x is tensor(66.0168, device='cuda:0')
benign distance is  tensor(66.0168, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4121266305446625
distance x is tensor(138.4542, device='cuda:0')
benign distance is  tensor(138.4542, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6111013293266296
distance x is tensor(144.9258, device='cuda:0')
benign distance is  tensor(144.9258, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6880195736885071
distance x is tensor(142.7811, device='cuda:0')
benign distance is  tensor(142.7811, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5268449187278748
distance x is tensor(143.8578, device='cuda:0')
benign distance is  tensor(143.8578, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8580816388130188
distance x is tensor(143.7141, device='cuda:0')
benign distance is  tensor(143.7141, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.47108322381973267
distance x is tensor(140.8440, device='cuda:0')
benign distance is  tensor(140.8440, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4279554486274719
distance x is tensor(136.1188, device='cuda:0')
benign distance is  tensor(136.1188, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.41012078523635864
distance x is tensor(137.2853, device='cuda:0')
benign distance is  tensor(137.2853, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.1774105280637741
distance x is tensor(150.0229, device='cuda:0')
benign distance is  tensor(150.0229, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.16099214553833
distance x is tensor(137.3255, device='cuda:0')
benign distance is  tensor(137.3255, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5305773615837097
distance x is tensor(134.5431, device='cuda:0')
benign distance is  tensor(134.5431, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.2760809063911438
distance x is tensor(149.0805, device='cuda:0')
benign distance is  tensor(149.0805, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.4787415862083435
distance x is tensor(137.1586, device='cuda:0')
benign distance is  tensor(137.1586, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5474578738212585
distance x is tensor(142.5389, device='cuda:0')
benign distance is  tensor(142.5389, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.21772246062755585
distance x is tensor(137.3754, device='cuda:0')
benign distance is  tensor(137.3754, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.2585420310497284
distance x is tensor(140.8021, device='cuda:0')
benign distance is  tensor(140.8021, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.1785997897386551
mal_entropy is 0.16379138827323914
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([564.7631, 553.0951, 553.5611, 496.0710, 495.0952, 555.1861, 578.6506,
        296.5281, 632.4263, 632.4263, 632.4263, 632.4263, 632.4263, 632.4263,
        632.4263, 632.4263, 632.4263, 632.4263, 632.4263, 632.4263, 634.3900,
        687.5663, 629.4762, 616.7219, 618.2656, 621.2606, 668.8832, 579.8887],
       device='cuda:0')
sorted_norm is   tensor([296.5281, 495.0952, 496.0710, 553.0951, 553.5611, 555.1861, 564.7631,
        578.6506, 579.8887, 616.7219, 618.2656, 621.2606, 629.4762, 632.4263,
        632.4263, 632.4263, 632.4263, 632.4263, 632.4263, 632.4263, 632.4263,
        632.4263, 632.4263, 632.4263, 632.4263, 634.3900, 668.8832, 687.5663],
       device='cuda:0')
used idx is  tensor([ 7,  4,  3,  1,  2,  5,  0,  6, 27, 23, 24, 25, 22, 16, 18, 14, 10,  8,
        12, 11, 15, 13], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 89.52% 

Test Accuracy: 88.38% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6270843744277954
distance x is tensor(111.8665, device='cuda:0')
benign distance is  tensor(111.8665, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8259169459342957
distance x is tensor(122.6550, device='cuda:0')
benign distance is  tensor(122.6550, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.15532299876213074
distance x is tensor(125.3293, device='cuda:0')
benign distance is  tensor(125.3293, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7351130247116089
distance x is tensor(118.4721, device='cuda:0')
benign distance is  tensor(118.4721, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.823047935962677
distance x is tensor(109.9853, device='cuda:0')
benign distance is  tensor(109.9853, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5471763014793396
distance x is tensor(126.8936, device='cuda:0')
benign distance is  tensor(126.8936, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4205797612667084
distance x is tensor(118.8172, device='cuda:0')
benign distance is  tensor(118.8172, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7844700217247009
distance x is tensor(89.9635, device='cuda:0')
benign distance is  tensor(89.9635, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.42694219946861267
distance x is tensor(136.3850, device='cuda:0')
benign distance is  tensor(136.3850, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6314020156860352
distance x is tensor(139.4230, device='cuda:0')
benign distance is  tensor(139.4230, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4310401976108551
distance x is tensor(129.7933, device='cuda:0')
benign distance is  tensor(129.7933, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3860611915588379
distance x is tensor(121.5822, device='cuda:0')
benign distance is  tensor(121.5822, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3187568187713623
distance x is tensor(126.4827, device='cuda:0')
benign distance is  tensor(126.4827, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6868112683296204
distance x is tensor(125.3602, device='cuda:0')
benign distance is  tensor(125.3602, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.1119476929306984
distance x is tensor(146.1600, device='cuda:0')
benign distance is  tensor(146.1600, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.9422372579574585
distance x is tensor(120.8859, device='cuda:0')
benign distance is  tensor(120.8859, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.48191747069358826
mal_entropy is 0.06249215826392174
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([499.7144, 549.1057, 549.5145, 513.9600, 475.8368, 560.8737, 509.8651,
        382.8580, 524.6403, 524.6403, 524.6403, 524.6403, 524.6403, 524.6403,
        524.6403, 524.6403, 524.6403, 524.6403, 524.6403, 524.6403, 675.3613,
        713.3705, 708.4152, 683.7481, 718.0952, 678.1201, 684.9641, 561.8549,
        669.4305, 686.5759, 693.5596, 680.6360, 686.0026, 673.8337, 653.5504,
        657.4962], device='cuda:0')
sorted_norm is   tensor([382.8580, 475.8368, 499.7144, 509.8651, 513.9600, 524.6403, 524.6403,
        524.6403, 524.6403, 524.6403, 524.6403, 524.6403, 524.6403, 524.6403,
        524.6403, 524.6403, 524.6403, 549.1057, 549.5145, 560.8737, 561.8549,
        653.5504, 657.4962, 669.4305, 673.8337, 675.3613, 678.1201, 680.6360,
        683.7481, 684.9641, 686.0026, 686.5759, 693.5596, 708.4152, 713.3705,
        718.0952], device='cuda:0')
used idx is  tensor([ 7,  4,  0,  6,  3, 14, 15, 12,  8, 10,  9, 17, 13, 19, 16, 18, 11,  1,
         2,  5, 27, 34, 35, 28, 33, 20, 25, 31], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 89.69% 

Test Accuracy: 88.88% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.951917290687561
distance x is tensor(125.2974, device='cuda:0')
benign distance is  tensor(125.2974, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8935491442680359
distance x is tensor(128.7862, device='cuda:0')
benign distance is  tensor(128.7862, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.429469496011734
distance x is tensor(119.9225, device='cuda:0')
benign distance is  tensor(119.9225, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4131355881690979
distance x is tensor(122.8450, device='cuda:0')
benign distance is  tensor(122.8450, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.502492368221283
distance x is tensor(141.3014, device='cuda:0')
benign distance is  tensor(141.3014, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.325374960899353
distance x is tensor(114.4177, device='cuda:0')
benign distance is  tensor(114.4177, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.17964529991149902
distance x is tensor(126.6590, device='cuda:0')
benign distance is  tensor(126.6590, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4925467371940613
distance x is tensor(86.6240, device='cuda:0')
benign distance is  tensor(86.6240, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.20563355088233948
distance x is tensor(145.2303, device='cuda:0')
benign distance is  tensor(145.2303, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7022637724876404
distance x is tensor(136.8416, device='cuda:0')
benign distance is  tensor(136.8416, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.32685452699661255
distance x is tensor(129.8187, device='cuda:0')
benign distance is  tensor(129.8187, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9271079897880554
distance x is tensor(131.2913, device='cuda:0')
benign distance is  tensor(131.2913, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6806117296218872
distance x is tensor(128.0036, device='cuda:0')
benign distance is  tensor(128.0036, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.570576548576355
distance x is tensor(141.1397, device='cuda:0')
benign distance is  tensor(141.1397, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6300607323646545
distance x is tensor(139.7874, device='cuda:0')
benign distance is  tensor(139.7874, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7290095090866089
distance x is tensor(115.7871, device='cuda:0')
benign distance is  tensor(115.7871, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.22671687602996826
distance x is tensor(152.9196, device='cuda:0')
benign distance is  tensor(152.9196, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.07557331025600433
distance x is tensor(142.4645, device='cuda:0')
benign distance is  tensor(142.4645, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.4772762358188629
distance x is tensor(143.3447, device='cuda:0')
benign distance is  tensor(143.3447, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.04847973585128784
distance x is tensor(137.0834, device='cuda:0')
benign distance is  tensor(137.0834, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.18310056626796722
distance x is tensor(135.5401, device='cuda:0')
benign distance is  tensor(135.5401, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.713959813117981
distance x is tensor(125.4646, device='cuda:0')
benign distance is  tensor(125.4646, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.4123007655143738
distance x is tensor(136.7619, device='cuda:0')
benign distance is  tensor(136.7619, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.47052866220474243
distance x is tensor(119.6509, device='cuda:0')
benign distance is  tensor(119.6509, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.7944034934043884
mal_entropy is 0.06670047342777252
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([549.2357, 566.2516, 528.1981, 544.3725, 601.7561, 509.7445, 549.9397,
        378.2589, 519.9130, 519.9130, 519.9130, 519.9130, 519.9130, 519.9130,
        519.9130, 519.9130, 519.9130, 519.9130, 519.9130, 519.9130],
       device='cuda:0')
sorted_norm is   tensor([378.2589, 509.7445, 519.9130, 519.9130, 519.9130, 519.9130, 519.9130,
        519.9130, 519.9130, 519.9130, 519.9130, 519.9130, 519.9130, 519.9130,
        528.1981, 544.3725, 549.2357, 549.9397, 566.2516, 601.7561],
       device='cuda:0')
used idx is  tensor([ 7,  5, 19, 18, 14, 15, 16, 17, 13, 12,  8,  9, 11, 10,  2,  3],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 88.89% 

Test Accuracy: 88.09% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3536607325077057
distance x is tensor(146.4199, device='cuda:0')
benign distance is  tensor(146.4199, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3246339559555054
distance x is tensor(156.2930, device='cuda:0')
benign distance is  tensor(156.2930, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4174996316432953
distance x is tensor(156.9398, device='cuda:0')
benign distance is  tensor(156.9398, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.33134186267852783
distance x is tensor(142.0637, device='cuda:0')
benign distance is  tensor(142.0637, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5783272385597229
distance x is tensor(151.5194, device='cuda:0')
benign distance is  tensor(151.5194, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.22292160987854
distance x is tensor(139.3019, device='cuda:0')
benign distance is  tensor(139.3019, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5428372621536255
distance x is tensor(119.8806, device='cuda:0')
benign distance is  tensor(119.8806, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.47847646474838257
distance x is tensor(117.6466, device='cuda:0')
benign distance is  tensor(117.6466, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.5244054198265076
mal_entropy is 0.031010527163743973
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([639.2647, 668.3282, 681.0021, 607.9233, 655.2016, 607.7999, 519.6241,
        505.6322, 505.6322, 505.6322, 505.6322, 505.6322, 505.6322, 505.6322,
        505.6322, 505.6322, 505.6322, 505.6322, 505.6322, 505.6322, 764.8073,
        749.6213, 761.4608, 753.7903, 752.6145, 752.1732, 810.2088, 673.8962,
        825.6628, 772.5645, 753.4053, 797.0221, 767.1731, 787.6116, 780.0767,
        667.6351, 740.2705, 762.4399, 727.9615, 704.6152, 715.5267, 726.1746,
        782.7587, 522.5222, 739.6600, 709.1219, 692.0977, 698.1910, 685.0520,
        735.7244, 722.7311, 645.9319], device='cuda:0')
sorted_norm is   tensor([505.6322, 505.6322, 505.6322, 505.6322, 505.6322, 505.6322, 505.6322,
        505.6322, 505.6322, 505.6322, 505.6322, 505.6322, 505.6322, 519.6241,
        522.5222, 607.7999, 607.9233, 639.2647, 645.9319, 655.2016, 667.6351,
        668.3282, 673.8962, 681.0021, 685.0520, 692.0977, 698.1910, 704.6152,
        709.1219, 715.5267, 722.7311, 726.1746, 727.9615, 735.7244, 739.6600,
        740.2705, 749.6213, 752.1732, 752.6145, 753.4053, 753.7903, 761.4608,
        762.4399, 764.8073, 767.1731, 772.5645, 780.0767, 782.7587, 787.6116,
        797.0221, 810.2088, 825.6628], device='cuda:0')
used idx is  tensor([11, 19, 13, 17, 15,  9,  7, 16, 14, 12, 10,  8, 18,  6, 43,  5,  3,  0,
        51,  4, 35,  1, 27,  2, 48, 46, 47, 39, 45, 40, 50, 41, 38, 49, 44, 36,
        21, 25, 24, 30, 23], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 89.79% 

Test Accuracy: 88.95% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7021729946136475
distance x is tensor(111.1679, device='cuda:0')
benign distance is  tensor(111.1679, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8108469843864441
distance x is tensor(113.3831, device='cuda:0')
benign distance is  tensor(113.3831, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1415586918592453
distance x is tensor(126.9171, device='cuda:0')
benign distance is  tensor(126.9171, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6335006952285767
distance x is tensor(117.3429, device='cuda:0')
benign distance is  tensor(117.3429, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5359556674957275
distance x is tensor(121.4355, device='cuda:0')
benign distance is  tensor(121.4355, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.45758938789367676
distance x is tensor(125.6101, device='cuda:0')
benign distance is  tensor(125.6101, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.16390112042427063
distance x is tensor(116.1399, device='cuda:0')
benign distance is  tensor(116.1399, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.37296101450920105
distance x is tensor(66.0913, device='cuda:0')
benign distance is  tensor(66.0913, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.366567462682724
distance x is tensor(140.9449, device='cuda:0')
benign distance is  tensor(140.9449, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.457991361618042
distance x is tensor(137.8893, device='cuda:0')
benign distance is  tensor(137.8893, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.860191822052002
distance x is tensor(122.3130, device='cuda:0')
benign distance is  tensor(122.3130, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.48630887269973755
distance x is tensor(147.6149, device='cuda:0')
benign distance is  tensor(147.6149, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8711442947387695
distance x is tensor(123.9927, device='cuda:0')
benign distance is  tensor(123.9927, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1606135368347168
distance x is tensor(134.7925, device='cuda:0')
benign distance is  tensor(134.7925, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6088418364524841
distance x is tensor(131.0895, device='cuda:0')
benign distance is  tensor(131.0895, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.505959153175354
distance x is tensor(128.3680, device='cuda:0')
benign distance is  tensor(128.3680, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3769957423210144
distance x is tensor(130.8450, device='cuda:0')
benign distance is  tensor(130.8450, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6517446041107178
distance x is tensor(143.4760, device='cuda:0')
benign distance is  tensor(143.4760, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.19524864852428436
distance x is tensor(140.9383, device='cuda:0')
benign distance is  tensor(140.9383, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3049059510231018
distance x is tensor(136.4403, device='cuda:0')
benign distance is  tensor(136.4403, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.392538458108902
distance x is tensor(137.6547, device='cuda:0')
benign distance is  tensor(137.6547, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8446298837661743
distance x is tensor(136.0604, device='cuda:0')
benign distance is  tensor(136.0604, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.20322668552398682
distance x is tensor(145.5184, device='cuda:0')
benign distance is  tensor(145.5184, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5870869755744934
distance x is tensor(119.1302, device='cuda:0')
benign distance is  tensor(119.1302, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.45080485939979553
distance x is tensor(153.5960, device='cuda:0')
benign distance is  tensor(153.5960, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.4678957462310791
distance x is tensor(141.7154, device='cuda:0')
benign distance is  tensor(141.7154, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5437140464782715
distance x is tensor(141.1844, device='cuda:0')
benign distance is  tensor(141.1844, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5301863551139832
distance x is tensor(139.9885, device='cuda:0')
benign distance is  tensor(139.9885, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7196948528289795
distance x is tensor(141.4595, device='cuda:0')
benign distance is  tensor(141.4595, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5722028017044067
distance x is tensor(133.7701, device='cuda:0')
benign distance is  tensor(133.7701, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.34489014744758606
distance x is tensor(140.7332, device='cuda:0')
benign distance is  tensor(140.7332, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.20510585606098175
distance x is tensor(114.8110, device='cuda:0')
benign distance is  tensor(114.8110, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.3270055651664734
distance x is tensor(144.2538, device='cuda:0')
benign distance is  tensor(144.2538, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.3326807916164398
distance x is tensor(136.5736, device='cuda:0')
benign distance is  tensor(136.5736, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.2674028277397156
distance x is tensor(137.5881, device='cuda:0')
benign distance is  tensor(137.5881, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.4599389135837555
distance x is tensor(142.6671, device='cuda:0')
benign distance is  tensor(142.6671, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.37223300337791443
distance x is tensor(128.6038, device='cuda:0')
benign distance is  tensor(128.6038, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6701865792274475
distance x is tensor(143.3826, device='cuda:0')
benign distance is  tensor(143.3826, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.790886640548706
distance x is tensor(138.8223, device='cuda:0')
benign distance is  tensor(138.8223, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.4482322633266449
distance x is tensor(125.6361, device='cuda:0')
benign distance is  tensor(125.6361, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.5203772187232971
mal_entropy is 0.07183833420276642
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([488.6263, 505.9380, 542.0731, 496.2503, 546.4542, 554.2364, 510.3643,
        283.2152, 551.3831, 551.3831, 551.3831, 551.3831, 551.3831, 551.3831,
        551.3831, 551.3831, 551.3831, 551.3831, 551.3831, 551.3831],
       device='cuda:0')
sorted_norm is   tensor([283.2152, 488.6263, 496.2503, 505.9380, 510.3643, 542.0731, 546.4542,
        551.3831, 551.3831, 551.3831, 551.3831, 551.3831, 551.3831, 551.3831,
        551.3831, 551.3831, 551.3831, 551.3831, 551.3831, 554.2364],
       device='cuda:0')
used idx is  tensor([ 7,  0,  3,  1,  6,  2,  4, 19, 15, 18, 16, 17, 13, 12, 14,  9],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 89.33% 

Test Accuracy: 88.61% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.13656149804592133
distance x is tensor(113.5423, device='cuda:0')
benign distance is  tensor(113.5423, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.40711697936058044
distance x is tensor(137.9478, device='cuda:0')
benign distance is  tensor(137.9478, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.20462055504322052
distance x is tensor(133.1254, device='cuda:0')
benign distance is  tensor(133.1254, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6962401270866394
distance x is tensor(126.6285, device='cuda:0')
benign distance is  tensor(126.6285, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0944840908050537
distance x is tensor(105.3159, device='cuda:0')
benign distance is  tensor(105.3159, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8142703771591187
distance x is tensor(135.5104, device='cuda:0')
benign distance is  tensor(135.5104, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.07657184451818466
distance x is tensor(124.2602, device='cuda:0')
benign distance is  tensor(124.2602, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5702377557754517
distance x is tensor(79.9675, device='cuda:0')
benign distance is  tensor(79.9675, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.7791271805763245
mal_entropy is 0.05455411598086357
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([506.3024, 613.3301, 590.0180, 531.1284, 460.2747, 595.1639, 540.2076,
        347.4754, 347.4754, 347.4754, 347.4754, 347.4754, 347.4754, 347.4754,
        347.4754, 347.4754, 347.4754, 347.4754, 347.4754, 347.4754, 687.0212,
        677.2682, 622.4407, 712.2813, 631.5472, 674.7246, 655.5400, 639.8721],
       device='cuda:0')
sorted_norm is   tensor([347.4754, 347.4754, 347.4754, 347.4754, 347.4754, 347.4754, 347.4754,
        347.4754, 347.4754, 347.4754, 347.4754, 347.4754, 347.4754, 460.2747,
        506.3024, 531.1284, 540.2076, 590.0180, 595.1639, 613.3301, 622.4407,
        631.5472, 639.8721, 655.5400, 674.7246, 677.2682, 687.0212, 712.2813],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14,  7, 11, 10,  8,  9, 15,  4,  0,  3,  6,  2,
         5,  1, 22, 24], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 89.48% 

Test Accuracy: 88.57% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8033996820449829
distance x is tensor(147.7175, device='cuda:0')
benign distance is  tensor(147.7175, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1014025211334229
distance x is tensor(138.2967, device='cuda:0')
benign distance is  tensor(138.2967, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3529103100299835
distance x is tensor(148.8030, device='cuda:0')
benign distance is  tensor(148.8030, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5833572745323181
distance x is tensor(133.9395, device='cuda:0')
benign distance is  tensor(133.9395, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5730246305465698
distance x is tensor(123.6059, device='cuda:0')
benign distance is  tensor(123.6059, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.649133324623108
distance x is tensor(141.9625, device='cuda:0')
benign distance is  tensor(141.9625, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.26568201184272766
distance x is tensor(125.3743, device='cuda:0')
benign distance is  tensor(125.3743, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.815204918384552
distance x is tensor(50.3636, device='cuda:0')
benign distance is  tensor(50.3636, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4991670548915863
distance x is tensor(169.4252, device='cuda:0')
benign distance is  tensor(169.4252, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.324293315410614
distance x is tensor(154.0607, device='cuda:0')
benign distance is  tensor(154.0607, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.39448922872543335
distance x is tensor(158.6251, device='cuda:0')
benign distance is  tensor(158.6251, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5179842710494995
distance x is tensor(162.7805, device='cuda:0')
benign distance is  tensor(162.7805, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.533482551574707
distance x is tensor(139.0145, device='cuda:0')
benign distance is  tensor(139.0145, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5544141530990601
distance x is tensor(162.7803, device='cuda:0')
benign distance is  tensor(162.7803, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.18048086762428284
distance x is tensor(141.8820, device='cuda:0')
benign distance is  tensor(141.8820, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.43658608198165894
distance x is tensor(149.3651, device='cuda:0')
benign distance is  tensor(149.3651, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.3492625951766968
mal_entropy is 0.045753952115774155
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([644.9725, 619.2199, 644.7276, 578.1696, 531.4189, 630.6064, 540.0991,
        223.4021, 656.5707, 656.5707, 656.5707, 656.5707, 656.5707, 656.5707,
        656.5707, 656.5707, 656.5707, 656.5707, 656.5707, 656.5707, 789.4567,
        761.2723, 744.0881, 726.4587, 733.3467, 682.8693, 735.7775, 547.5234,
        661.2115, 713.4109, 698.6367, 695.3361, 690.8497, 687.0233, 716.4021,
        621.2250], device='cuda:0')
sorted_norm is   tensor([223.4021, 531.4189, 540.0991, 547.5234, 578.1696, 619.2199, 621.2250,
        630.6064, 644.7276, 644.9725, 656.5707, 656.5707, 656.5707, 656.5707,
        656.5707, 656.5707, 656.5707, 656.5707, 656.5707, 656.5707, 656.5707,
        656.5707, 661.2115, 682.8693, 687.0233, 690.8497, 695.3361, 698.6367,
        713.4109, 716.4021, 726.4587, 733.3467, 735.7775, 744.0881, 761.2723,
        789.4567], device='cuda:0')
used idx is  tensor([ 7,  4,  6, 27,  3,  1, 35,  5,  2,  0, 19, 18, 14, 12, 16, 17, 13, 10,
        11,  9,  8, 15, 28, 25, 33, 32, 31, 30], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 89.61% 

Test Accuracy: 88.71% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6308435797691345
distance x is tensor(119.7379, device='cuda:0')
benign distance is  tensor(119.7379, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0576742887496948
distance x is tensor(126.7036, device='cuda:0')
benign distance is  tensor(126.7036, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.41990742087364197
distance x is tensor(135.3461, device='cuda:0')
benign distance is  tensor(135.3461, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.36593443155288696
distance x is tensor(115.1509, device='cuda:0')
benign distance is  tensor(115.1509, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8645439147949219
distance x is tensor(114.1874, device='cuda:0')
benign distance is  tensor(114.1874, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8303337097167969
distance x is tensor(120.0525, device='cuda:0')
benign distance is  tensor(120.0525, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.15269222855567932
distance x is tensor(130.7667, device='cuda:0')
benign distance is  tensor(130.7667, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9449828863143921
distance x is tensor(65.2410, device='cuda:0')
benign distance is  tensor(65.2410, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3582318425178528
distance x is tensor(143.8363, device='cuda:0')
benign distance is  tensor(143.8363, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.873944103717804
distance x is tensor(154.8473, device='cuda:0')
benign distance is  tensor(154.8473, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.7039328217506409
distance x is tensor(142.0162, device='cuda:0')
benign distance is  tensor(142.0162, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.6490401029586792
distance x is tensor(139.8333, device='cuda:0')
benign distance is  tensor(139.8333, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9439846873283386
distance x is tensor(147.0219, device='cuda:0')
benign distance is  tensor(147.0219, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7201613783836365
distance x is tensor(120.8313, device='cuda:0')
benign distance is  tensor(120.8313, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.08158417046070099
distance x is tensor(144.3502, device='cuda:0')
benign distance is  tensor(144.3502, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.45606550574302673
distance x is tensor(121.8189, device='cuda:0')
benign distance is  tensor(121.8189, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3353501260280609
distance x is tensor(144.5060, device='cuda:0')
benign distance is  tensor(144.5060, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.10164053738117218
distance x is tensor(155.7282, device='cuda:0')
benign distance is  tensor(155.7282, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.22199282050132751
distance x is tensor(143.8213, device='cuda:0')
benign distance is  tensor(143.8213, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.11089013516902924
distance x is tensor(147.1474, device='cuda:0')
benign distance is  tensor(147.1474, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5609589219093323
distance x is tensor(144.7621, device='cuda:0')
benign distance is  tensor(144.7621, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.3927891254425049
distance x is tensor(142.4821, device='cuda:0')
benign distance is  tensor(142.4821, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.41545790433883667
distance x is tensor(142.6683, device='cuda:0')
benign distance is  tensor(142.6683, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.16966310143470764
distance x is tensor(122.2850, device='cuda:0')
benign distance is  tensor(122.2850, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8000000005000001
mal_loss is 0.6067555546760559
mal_entropy is 0.07945483177900314
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([538.5450, 564.4734, 591.3007, 491.0732, 483.7793, 534.6522, 561.4251,
        282.7040, 517.7145, 517.7145, 517.7145, 517.7145, 517.7145, 517.7145,
        517.7145, 517.7145, 517.7145, 517.7145, 517.7145, 517.7145, 756.3241,
        703.0450, 721.8245, 702.8041, 714.7799, 678.2817, 722.3685, 634.1155,
        779.2683, 717.6542, 752.0062, 770.4471, 676.7228, 753.8389, 680.6208,
        390.5096], device='cuda:0')
sorted_norm is   tensor([282.7040, 390.5096, 483.7793, 491.0732, 517.7145, 517.7145, 517.7145,
        517.7145, 517.7145, 517.7145, 517.7145, 517.7145, 517.7145, 517.7145,
        517.7145, 517.7145, 534.6522, 538.5450, 561.4251, 564.4734, 591.3007,
        634.1155, 676.7228, 678.2817, 680.6208, 702.8041, 703.0450, 714.7799,
        717.6542, 721.8245, 722.3685, 752.0062, 753.8389, 756.3241, 770.4471,
        779.2683], device='cuda:0')
used idx is  tensor([ 7, 35,  4,  3, 13, 12, 14, 19,  8, 11, 10,  9, 15, 18, 16, 17,  5,  0,
         6,  1,  2, 27, 32, 25, 34, 23, 21, 24], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 89.81% 

Test Accuracy: 88.70% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4678799510002136
distance x is tensor(112.8816, device='cuda:0')
benign distance is  tensor(112.8816, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9739802479743958
distance x is tensor(123.4096, device='cuda:0')
benign distance is  tensor(123.4096, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1772511899471283
distance x is tensor(142.0574, device='cuda:0')
benign distance is  tensor(142.0574, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5678995847702026
distance x is tensor(123.5869, device='cuda:0')
benign distance is  tensor(123.5869, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.22972707450389862
distance x is tensor(122.0269, device='cuda:0')
benign distance is  tensor(122.0269, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.047799825668335
distance x is tensor(139.3433, device='cuda:0')
benign distance is  tensor(139.3433, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.49642735719680786
distance x is tensor(121.3796, device='cuda:0')
benign distance is  tensor(121.3796, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.37764376401901245
distance x is tensor(84.9936, device='cuda:0')
benign distance is  tensor(84.9936, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.184024840593338
distance x is tensor(154.8442, device='cuda:0')
benign distance is  tensor(154.8442, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.24447126686573029
distance x is tensor(144.5845, device='cuda:0')
benign distance is  tensor(144.5845, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6318928599357605
distance x is tensor(143.8301, device='cuda:0')
benign distance is  tensor(143.8301, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.45049452781677246
distance x is tensor(153.8633, device='cuda:0')
benign distance is  tensor(153.8633, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6307116746902466
distance x is tensor(135.6344, device='cuda:0')
benign distance is  tensor(135.6344, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2526755928993225
distance x is tensor(148.5089, device='cuda:0')
benign distance is  tensor(148.5089, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5087983012199402
distance x is tensor(144.6165, device='cuda:0')
benign distance is  tensor(144.6165, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6900886297225952
distance x is tensor(111.8054, device='cuda:0')
benign distance is  tensor(111.8054, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.020534459501504898
distance x is tensor(147.1066, device='cuda:0')
benign distance is  tensor(147.1066, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.2328271865844727
distance x is tensor(135.1112, device='cuda:0')
benign distance is  tensor(135.1112, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3159831762313843
distance x is tensor(144.2703, device='cuda:0')
benign distance is  tensor(144.2703, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.48054009675979614
distance x is tensor(138.5749, device='cuda:0')
benign distance is  tensor(138.5749, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.90948086977005
distance x is tensor(147.7518, device='cuda:0')
benign distance is  tensor(147.7518, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.3763152062892914
distance x is tensor(151.3696, device='cuda:0')
benign distance is  tensor(151.3696, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4561127722263336
distance x is tensor(150.8721, device='cuda:0')
benign distance is  tensor(150.8721, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.5960565805435181
distance x is tensor(130.3523, device='cuda:0')
benign distance is  tensor(130.3523, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.5275182127952576
mal_entropy is 0.11158354580402374
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([501.7737, 541.4977, 605.4465, 536.4841, 507.0468, 608.0342, 522.8017,
        366.9324, 581.9176, 581.9175, 581.9176, 581.9175, 581.9176, 581.9175,
        581.9176, 581.9175, 581.9176, 581.9175, 581.9176, 581.9175],
       device='cuda:0')
sorted_norm is   tensor([366.9324, 501.7737, 507.0468, 522.8017, 536.4841, 541.4977, 581.9175,
        581.9175, 581.9175, 581.9175, 581.9175, 581.9175, 581.9176, 581.9176,
        581.9176, 581.9176, 581.9176, 581.9176, 605.4465, 608.0342],
       device='cuda:0')
used idx is  tensor([ 7,  0,  4,  6,  3,  1, 19, 17, 13, 15, 11,  9,  8, 10, 16, 18],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 89.20% 

Test Accuracy: 87.49% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5244361758232117
distance x is tensor(140.5124, device='cuda:0')
benign distance is  tensor(140.5124, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.36311525106430054
distance x is tensor(131.8487, device='cuda:0')
benign distance is  tensor(131.8487, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5294457674026489
distance x is tensor(142.2733, device='cuda:0')
benign distance is  tensor(142.2733, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7049335241317749
distance x is tensor(138.0071, device='cuda:0')
benign distance is  tensor(138.0071, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.058676768094301224
distance x is tensor(115.7331, device='cuda:0')
benign distance is  tensor(115.7331, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5234165191650391
distance x is tensor(137.6470, device='cuda:0')
benign distance is  tensor(137.6470, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.747229278087616
distance x is tensor(138.4997, device='cuda:0')
benign distance is  tensor(138.4997, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2320995032787323
distance x is tensor(98.8748, device='cuda:0')
benign distance is  tensor(98.8748, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.36738941073417664
mal_entropy is 0.01397774089127779
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([613.7227, 570.8754, 608.5348, 589.6920, 498.0127, 599.2584, 584.2470,
        425.5830, 425.5830, 425.5830, 425.5830, 425.5830, 425.5830, 425.5830,
        425.5830, 425.5830, 425.5830, 425.5830, 425.5830, 425.5830, 790.7023,
        770.1763, 788.6248, 802.4990, 757.0071, 803.1890, 774.3257, 650.4579,
        760.4971, 800.8192, 762.7425, 747.0988, 763.8890, 689.5760, 777.3274,
        680.9995, 766.2171, 724.6509, 727.1245, 762.9280, 703.5776, 743.4956,
        732.4493, 606.9372], device='cuda:0')
sorted_norm is   tensor([425.5830, 425.5830, 425.5830, 425.5830, 425.5830, 425.5830, 425.5830,
        425.5830, 425.5830, 425.5830, 425.5830, 425.5830, 425.5830, 498.0127,
        570.8754, 584.2470, 589.6920, 599.2584, 606.9372, 608.5348, 613.7227,
        650.4579, 680.9995, 689.5760, 703.5776, 724.6509, 727.1245, 732.4493,
        743.4956, 747.0988, 757.0071, 760.4971, 762.7425, 762.9280, 763.8890,
        766.2171, 770.1763, 774.3257, 777.3274, 788.6248, 790.7023, 800.8192,
        802.4990, 803.1890], device='cuda:0')
used idx is  tensor([11, 10,  8, 19, 13, 18, 16, 17, 15, 12, 14,  9,  7,  4,  1,  6,  3,  5,
        43,  2,  0, 27, 35, 33, 40, 37, 38, 42, 41, 31, 24, 28, 30, 39, 32],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 89.85% 

Test Accuracy: 88.85% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6004835367202759
distance x is tensor(126.2211, device='cuda:0')
benign distance is  tensor(126.2211, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.572675883769989
distance x is tensor(135.6836, device='cuda:0')
benign distance is  tensor(135.6836, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5993978381156921
distance x is tensor(135.3782, device='cuda:0')
benign distance is  tensor(135.3782, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6140178442001343
distance x is tensor(136.2816, device='cuda:0')
benign distance is  tensor(136.2816, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9385830760002136
distance x is tensor(108.4336, device='cuda:0')
benign distance is  tensor(108.4336, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.44191041588783264
distance x is tensor(121.9666, device='cuda:0')
benign distance is  tensor(121.9666, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.42962050437927246
distance x is tensor(133.6214, device='cuda:0')
benign distance is  tensor(133.6214, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.689984142780304
distance x is tensor(51.2396, device='cuda:0')
benign distance is  tensor(51.2396, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.033178992569446564
distance x is tensor(152.0012, device='cuda:0')
benign distance is  tensor(152.0012, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3697842061519623
distance x is tensor(137.2526, device='cuda:0')
benign distance is  tensor(137.2526, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5617529153823853
distance x is tensor(136.3412, device='cuda:0')
benign distance is  tensor(136.3412, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7256046533584595
distance x is tensor(151.1721, device='cuda:0')
benign distance is  tensor(151.1721, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5545499920845032
distance x is tensor(128.9468, device='cuda:0')
benign distance is  tensor(128.9468, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1204398050904274
distance x is tensor(149.8193, device='cuda:0')
benign distance is  tensor(149.8193, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.19111326336860657
distance x is tensor(137.9934, device='cuda:0')
benign distance is  tensor(137.9934, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.17104212939739227
distance x is tensor(103.4327, device='cuda:0')
benign distance is  tensor(103.4327, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.37494686245918274
distance x is tensor(149.0264, device='cuda:0')
benign distance is  tensor(149.0264, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.39884692430496216
distance x is tensor(163.3159, device='cuda:0')
benign distance is  tensor(163.3159, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.1483325958251953
distance x is tensor(131.0306, device='cuda:0')
benign distance is  tensor(131.0306, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.5178610682487488
distance x is tensor(143.8909, device='cuda:0')
benign distance is  tensor(143.8909, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4174608588218689
distance x is tensor(146.1693, device='cuda:0')
benign distance is  tensor(146.1693, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8290934562683105
distance x is tensor(135.5019, device='cuda:0')
benign distance is  tensor(135.5019, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.7480452656745911
distance x is tensor(145.8258, device='cuda:0')
benign distance is  tensor(145.8258, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.13396811485290527
distance x is tensor(130.0049, device='cuda:0')
benign distance is  tensor(130.0049, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.18438611924648285
distance x is tensor(152.1573, device='cuda:0')
benign distance is  tensor(152.1573, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.681824803352356
distance x is tensor(146.4570, device='cuda:0')
benign distance is  tensor(146.4570, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.08245806396007538
distance x is tensor(152.5755, device='cuda:0')
benign distance is  tensor(152.5755, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.32791557908058167
distance x is tensor(150.0158, device='cuda:0')
benign distance is  tensor(150.0158, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.32715290784835815
distance x is tensor(147.8132, device='cuda:0')
benign distance is  tensor(147.8132, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.3485200107097626
distance x is tensor(147.4027, device='cuda:0')
benign distance is  tensor(147.4027, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.05638119578361511
distance x is tensor(149.3903, device='cuda:0')
benign distance is  tensor(149.3903, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.4217000901699066
distance x is tensor(129.2875, device='cuda:0')
benign distance is  tensor(129.2875, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.28153422474861145
mal_entropy is 0.02753298543393612
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([558.9142, 604.3073, 574.7025, 597.0073, 462.3195, 539.6784, 569.1562,
        217.5978, 565.1422, 565.1422, 565.1422, 565.1422, 565.1422, 565.1422,
        565.1422, 565.1422, 565.1422, 565.1422, 565.1422, 565.1422],
       device='cuda:0')
sorted_norm is   tensor([217.5978, 462.3195, 539.6784, 558.9142, 565.1422, 565.1422, 565.1422,
        565.1422, 565.1422, 565.1422, 565.1422, 565.1422, 565.1422, 565.1422,
        565.1422, 565.1422, 569.1562, 574.7025, 597.0073, 604.3073],
       device='cuda:0')
used idx is  tensor([ 7,  4,  5,  0, 18, 16, 12, 14, 10,  8, 17, 19, 15, 13,  9, 11],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 88.77% 

Test Accuracy: 87.61% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8560183644294739
distance x is tensor(148.5131, device='cuda:0')
benign distance is  tensor(148.5131, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6291953325271606
distance x is tensor(149.3801, device='cuda:0')
benign distance is  tensor(149.3801, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.042701683938503265
distance x is tensor(150.4510, device='cuda:0')
benign distance is  tensor(150.4510, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5096316337585449
distance x is tensor(168.2918, device='cuda:0')
benign distance is  tensor(168.2918, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2793087363243103
distance x is tensor(164.9309, device='cuda:0')
benign distance is  tensor(164.9309, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7124610543251038
distance x is tensor(145.4746, device='cuda:0')
benign distance is  tensor(145.4746, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.13419219851493835
distance x is tensor(137.5958, device='cuda:0')
benign distance is  tensor(137.5958, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3907710909843445
distance x is tensor(93.1838, device='cuda:0')
benign distance is  tensor(93.1838, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.8961822390556335
mal_entropy is 0.029096895828843117
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([648.1309, 644.8659, 656.3600, 711.4955, 708.5827, 634.3337, 579.0056,
        401.9332, 401.9332, 401.9332, 401.9332, 401.9332, 401.9332, 401.9332,
        401.9332, 401.9332, 401.9332, 401.9332, 401.9332, 401.9332, 816.5772,
        862.2049, 806.2611, 835.3000, 809.1437, 805.3364, 793.4594, 630.3492,
        798.1461, 766.8681, 788.9231, 782.5260, 807.0413, 816.7637, 817.7452,
        620.3155, 782.3846, 731.7394, 733.2075, 783.4571, 700.2652, 785.0960,
        734.5468, 620.6044], device='cuda:0')
sorted_norm is   tensor([401.9332, 401.9332, 401.9332, 401.9332, 401.9332, 401.9332, 401.9332,
        401.9332, 401.9332, 401.9332, 401.9332, 401.9332, 401.9332, 579.0056,
        620.3155, 620.6044, 630.3492, 634.3337, 644.8659, 648.1309, 656.3600,
        700.2652, 708.5827, 711.4955, 731.7394, 733.2075, 734.5468, 766.8681,
        782.3846, 782.5260, 783.4571, 785.0960, 788.9231, 793.4594, 798.1461,
        805.3364, 806.2611, 807.0413, 809.1437, 816.5772, 816.7637, 817.7452,
        835.3000, 862.2049], device='cuda:0')
used idx is  tensor([11, 10,  8, 19, 13, 18, 16, 17, 15, 12, 14,  9,  7,  6, 35, 43, 27,  5,
         1,  0,  2, 40,  4,  3, 37, 38, 42, 29, 36, 31, 39, 41, 30, 26, 28],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 89.82% 

Test Accuracy: 88.67% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5473092198371887
distance x is tensor(124.8194, device='cuda:0')
benign distance is  tensor(124.8194, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6946302652359009
distance x is tensor(127.5170, device='cuda:0')
benign distance is  tensor(127.5170, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2788592278957367
distance x is tensor(127.0043, device='cuda:0')
benign distance is  tensor(127.0043, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3977962136268616
distance x is tensor(142.4091, device='cuda:0')
benign distance is  tensor(142.4091, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9252765774726868
distance x is tensor(108.3544, device='cuda:0')
benign distance is  tensor(108.3544, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0222175121307373
distance x is tensor(130.0150, device='cuda:0')
benign distance is  tensor(130.0150, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.091130256652832
distance x is tensor(123.5056, device='cuda:0')
benign distance is  tensor(123.5056, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.699876606464386
distance x is tensor(43.1768, device='cuda:0')
benign distance is  tensor(43.1768, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.008719545789062977
distance x is tensor(154.2156, device='cuda:0')
benign distance is  tensor(154.2156, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8848762512207031
distance x is tensor(143.0068, device='cuda:0')
benign distance is  tensor(143.0068, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6980191469192505
distance x is tensor(134.5759, device='cuda:0')
benign distance is  tensor(134.5759, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.38247376680374146
distance x is tensor(135.8604, device='cuda:0')
benign distance is  tensor(135.8604, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.54087895154953
distance x is tensor(140.8564, device='cuda:0')
benign distance is  tensor(140.8564, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.18538221716880798
distance x is tensor(143.4301, device='cuda:0')
benign distance is  tensor(143.4301, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5334209203720093
distance x is tensor(149.7442, device='cuda:0')
benign distance is  tensor(149.7442, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.719630479812622
distance x is tensor(129.8730, device='cuda:0')
benign distance is  tensor(129.8730, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.2467966079711914
distance x is tensor(148.5494, device='cuda:0')
benign distance is  tensor(148.5494, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5872136354446411
distance x is tensor(147.6915, device='cuda:0')
benign distance is  tensor(147.6915, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.045073915272951126
distance x is tensor(145.2975, device='cuda:0')
benign distance is  tensor(145.2975, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.31934699416160583
distance x is tensor(154.1045, device='cuda:0')
benign distance is  tensor(154.1045, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5302667021751404
distance x is tensor(152.7947, device='cuda:0')
benign distance is  tensor(152.7947, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.30510202050209045
distance x is tensor(158.9382, device='cuda:0')
benign distance is  tensor(158.9382, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.2837657034397125
distance x is tensor(148.7870, device='cuda:0')
benign distance is  tensor(148.7870, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7215572595596313
distance x is tensor(127.8135, device='cuda:0')
benign distance is  tensor(127.8135, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.42663246393203735
distance x is tensor(145.1407, device='cuda:0')
benign distance is  tensor(145.1407, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.19934873282909393
distance x is tensor(149.2830, device='cuda:0')
benign distance is  tensor(149.2830, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6070412397384644
distance x is tensor(153.5716, device='cuda:0')
benign distance is  tensor(153.5716, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.18700461089611053
distance x is tensor(144.2763, device='cuda:0')
benign distance is  tensor(144.2763, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.44610339403152466
distance x is tensor(147.7754, device='cuda:0')
benign distance is  tensor(147.7754, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.35024505853652954
distance x is tensor(144.2809, device='cuda:0')
benign distance is  tensor(144.2809, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.32188695669174194
distance x is tensor(136.3752, device='cuda:0')
benign distance is  tensor(136.3752, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.22350850701332092
distance x is tensor(106.2224, device='cuda:0')
benign distance is  tensor(106.2224, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.33599352836608887
mal_entropy is 0.11685089021921158
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([546.2344, 559.7698, 546.1951, 593.2422, 471.7831, 567.9766, 530.7660,
        185.8354, 447.1484, 447.1484, 447.1484, 447.1484, 447.1484, 447.1484,
        447.1484, 447.1484, 447.1484, 447.1484, 447.1484, 447.1484, 697.6785,
        752.9462, 626.0715, 687.3280, 697.0729, 651.3430, 698.7994, 619.1403],
       device='cuda:0')
sorted_norm is   tensor([185.8354, 447.1484, 447.1484, 447.1484, 447.1484, 447.1484, 447.1484,
        447.1484, 447.1484, 447.1484, 447.1484, 447.1484, 447.1484, 471.7831,
        530.7660, 546.1951, 546.2344, 559.7698, 567.9766, 593.2422, 619.1403,
        626.0715, 651.3430, 687.3280, 697.0729, 697.6785, 698.7994, 752.9462],
       device='cuda:0')
used idx is  tensor([ 7, 19, 16, 18, 14, 12, 15, 17, 13, 10,  8,  9, 11,  4,  6,  2,  0,  1,
         5,  3, 27, 22], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 89.48% 

Test Accuracy: 88.75% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5212863683700562
distance x is tensor(132.4538, device='cuda:0')
benign distance is  tensor(132.4538, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.17685192823410034
distance x is tensor(127.2561, device='cuda:0')
benign distance is  tensor(127.2561, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.17930951714515686
distance x is tensor(141.0721, device='cuda:0')
benign distance is  tensor(141.0721, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4756758213043213
distance x is tensor(134.8551, device='cuda:0')
benign distance is  tensor(134.8551, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.20398163795471191
distance x is tensor(121.2426, device='cuda:0')
benign distance is  tensor(121.2426, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9077757000923157
distance x is tensor(134.0875, device='cuda:0')
benign distance is  tensor(134.0875, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6060947179794312
distance x is tensor(138.3244, device='cuda:0')
benign distance is  tensor(138.3244, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3172893524169922
distance x is tensor(87.2621, device='cuda:0')
benign distance is  tensor(87.2621, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3900641202926636
distance x is tensor(162.1768, device='cuda:0')
benign distance is  tensor(162.1768, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.48558521270751953
distance x is tensor(165.1259, device='cuda:0')
benign distance is  tensor(165.1259, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4122543931007385
distance x is tensor(145.3488, device='cuda:0')
benign distance is  tensor(145.3488, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.07052591443061829
distance x is tensor(144.1428, device='cuda:0')
benign distance is  tensor(144.1428, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.31942835450172424
distance x is tensor(151.2896, device='cuda:0')
benign distance is  tensor(151.2896, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5710078477859497
distance x is tensor(143.1418, device='cuda:0')
benign distance is  tensor(143.1418, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.07897090911865234
distance x is tensor(163.6022, device='cuda:0')
benign distance is  tensor(163.6022, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6976845860481262
distance x is tensor(132.7844, device='cuda:0')
benign distance is  tensor(132.7844, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8000000005000001
mal_loss is 0.552810549736023
mal_entropy is 0.129129096865654
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([581.4222, 549.5437, 604.0180, 579.4022, 525.0893, 588.7052, 596.7982,
        376.0340, 573.9115, 573.9115, 573.9115, 573.9115, 573.9115, 573.9115,
        573.9115, 573.9115, 573.9115, 573.9115, 573.9115, 573.9115, 706.0880,
        666.0630, 626.8974, 641.2302, 660.4609, 676.3661, 691.1335, 619.7076],
       device='cuda:0')
sorted_norm is   tensor([376.0340, 525.0893, 549.5437, 573.9115, 573.9115, 573.9115, 573.9115,
        573.9115, 573.9115, 573.9115, 573.9115, 573.9115, 573.9115, 573.9115,
        573.9115, 579.4022, 581.4222, 588.7052, 596.7982, 604.0180, 619.7076,
        626.8974, 641.2302, 660.4609, 666.0630, 676.3661, 691.1335, 706.0880],
       device='cuda:0')
used idx is  tensor([ 7,  4,  1, 19, 15, 18, 16, 17, 13, 12, 14,  9,  8, 11, 10,  3,  0,  5,
         6,  2, 27, 22], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 89.34% 

Test Accuracy: 88.70% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.12750425934791565
distance x is tensor(131.7213, device='cuda:0')
benign distance is  tensor(131.7213, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6670435667037964
distance x is tensor(144.3652, device='cuda:0')
benign distance is  tensor(144.3652, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3655642867088318
distance x is tensor(140.4870, device='cuda:0')
benign distance is  tensor(140.4870, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3733667731285095
distance x is tensor(125.6290, device='cuda:0')
benign distance is  tensor(125.6290, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4311698079109192
distance x is tensor(127.7180, device='cuda:0')
benign distance is  tensor(127.7180, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6025667786598206
distance x is tensor(139.8737, device='cuda:0')
benign distance is  tensor(139.8737, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.823562741279602
distance x is tensor(132.6525, device='cuda:0')
benign distance is  tensor(132.6525, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5433377623558044
distance x is tensor(80.6749, device='cuda:0')
benign distance is  tensor(80.6749, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.013881293125450611
distance x is tensor(162.0009, device='cuda:0')
benign distance is  tensor(162.0009, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.15566018223762512
distance x is tensor(158.9435, device='cuda:0')
benign distance is  tensor(158.9435, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6708351373672485
distance x is tensor(140.5696, device='cuda:0')
benign distance is  tensor(140.5696, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.42569246888160706
distance x is tensor(147.3177, device='cuda:0')
benign distance is  tensor(147.3177, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.29744333028793335
distance x is tensor(149.7033, device='cuda:0')
benign distance is  tensor(149.7033, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.11831946671009064
distance x is tensor(158.2326, device='cuda:0')
benign distance is  tensor(158.2326, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6274853944778442
distance x is tensor(148.2637, device='cuda:0')
benign distance is  tensor(148.2637, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6534715890884399
distance x is tensor(139.2419, device='cuda:0')
benign distance is  tensor(139.2419, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.32654476165771484
mal_entropy is 0.09177681058645248
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([578.2966, 622.7147, 603.6415, 536.8212, 544.5188, 602.4031, 570.1675,
        342.1255, 604.7104, 604.7104, 604.7104, 604.7104, 604.7104, 604.7104,
        604.7104, 604.7104, 604.7104, 604.7104, 604.7104, 604.7104],
       device='cuda:0')
sorted_norm is   tensor([342.1255, 536.8212, 544.5188, 570.1675, 578.2966, 602.4031, 603.6415,
        604.7104, 604.7104, 604.7104, 604.7104, 604.7104, 604.7104, 604.7104,
        604.7104, 604.7104, 604.7104, 604.7104, 604.7104, 622.7147],
       device='cuda:0')
used idx is  tensor([ 7,  3,  4,  6,  0,  5,  2, 19, 15, 18, 16, 17, 13, 12, 14,  9],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 89.20% 

Test Accuracy: 88.39% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7754954695701599
distance x is tensor(133.7571, device='cuda:0')
benign distance is  tensor(133.7571, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.639214813709259
distance x is tensor(157.7404, device='cuda:0')
benign distance is  tensor(157.7404, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.08247446268796921
distance x is tensor(144.4901, device='cuda:0')
benign distance is  tensor(144.4901, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8262958526611328
distance x is tensor(138.6282, device='cuda:0')
benign distance is  tensor(138.6282, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3783227801322937
distance x is tensor(119.2416, device='cuda:0')
benign distance is  tensor(119.2416, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7459235787391663
distance x is tensor(166.8806, device='cuda:0')
benign distance is  tensor(166.8806, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.31271183490753174
distance x is tensor(141.9233, device='cuda:0')
benign distance is  tensor(141.9233, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3369855582714081
distance x is tensor(91.4760, device='cuda:0')
benign distance is  tensor(91.4760, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.8316687345504761
mal_entropy is 0.0700361430644989
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([583.3434, 685.1023, 630.2273, 589.8080, 507.7979, 737.1027, 610.7015,
        393.8521, 393.8521, 393.8521, 393.8521, 393.8521, 393.8521, 393.8521,
        393.8521, 393.8521, 393.8521, 393.8521, 393.8521, 393.8521, 854.5288,
        842.1456, 858.5288, 860.6410, 837.5042, 837.7753, 857.9809, 660.6333,
        815.6652, 793.8776, 793.2043, 828.9492, 835.8553, 855.6328, 828.1002,
        757.6641, 826.6179, 842.4277, 780.4068, 786.7472, 779.2252, 765.5025,
        833.4473, 473.2496, 777.2149, 758.5704, 700.3312, 716.1302, 737.0307,
        759.1213, 733.9526, 276.6481], device='cuda:0')
sorted_norm is   tensor([276.6481, 393.8521, 393.8521, 393.8521, 393.8521, 393.8521, 393.8521,
        393.8521, 393.8521, 393.8521, 393.8521, 393.8521, 393.8521, 393.8521,
        473.2496, 507.7979, 583.3434, 589.8080, 610.7015, 630.2273, 660.6333,
        685.1023, 700.3312, 716.1302, 733.9526, 737.0307, 737.1027, 757.6641,
        758.5704, 759.1213, 765.5025, 777.2149, 779.2252, 780.4068, 786.7472,
        793.2043, 793.8776, 815.6652, 826.6179, 828.1002, 828.9492, 833.4473,
        835.8553, 837.5042, 837.7753, 842.1456, 842.4277, 854.5288, 855.6328,
        857.9809, 858.5288, 860.6410], device='cuda:0')
used idx is  tensor([51, 11, 19, 10, 13, 18, 16, 17, 15, 12,  8,  9, 14,  7, 43,  4,  0,  3,
         6,  2, 27,  1, 46, 47, 50, 48,  5, 35, 45, 49, 41, 44, 40, 38, 39, 30,
        29, 28, 36, 34, 31], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 89.78% 

Test Accuracy: 89.03% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.21903467178344727
distance x is tensor(130.7242, device='cuda:0')
benign distance is  tensor(130.7242, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7195020914077759
distance x is tensor(123.5128, device='cuda:0')
benign distance is  tensor(123.5128, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.03796369582414627
distance x is tensor(122.6448, device='cuda:0')
benign distance is  tensor(122.6448, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4455288052558899
distance x is tensor(110.0501, device='cuda:0')
benign distance is  tensor(110.0501, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5455511808395386
distance x is tensor(116.8939, device='cuda:0')
benign distance is  tensor(116.8939, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9966206550598145
distance x is tensor(136.7537, device='cuda:0')
benign distance is  tensor(136.7537, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.08662180602550507
distance x is tensor(106.2193, device='cuda:0')
benign distance is  tensor(106.2193, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2969278395175934
distance x is tensor(39.4394, device='cuda:0')
benign distance is  tensor(39.4394, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4107171595096588
distance x is tensor(149.7123, device='cuda:0')
benign distance is  tensor(149.7123, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.383566677570343
distance x is tensor(153.5970, device='cuda:0')
benign distance is  tensor(153.5970, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5959986448287964
distance x is tensor(133.8748, device='cuda:0')
benign distance is  tensor(133.8748, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.614291250705719
distance x is tensor(141.1615, device='cuda:0')
benign distance is  tensor(141.1615, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.29480496048927307
distance x is tensor(145.6631, device='cuda:0')
benign distance is  tensor(145.6631, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3259841799736023
distance x is tensor(149.7509, device='cuda:0')
benign distance is  tensor(149.7509, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.21237845718860626
distance x is tensor(151.3186, device='cuda:0')
benign distance is  tensor(151.3186, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5302780866622925
distance x is tensor(122.6018, device='cuda:0')
benign distance is  tensor(122.6018, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.14045760035514832
distance x is tensor(144.6605, device='cuda:0')
benign distance is  tensor(144.6605, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.3331403136253357
distance x is tensor(172.2031, device='cuda:0')
benign distance is  tensor(172.2031, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.27724820375442505
distance x is tensor(136.3160, device='cuda:0')
benign distance is  tensor(136.3160, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2134137600660324
distance x is tensor(146.3030, device='cuda:0')
benign distance is  tensor(146.3030, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4752439558506012
distance x is tensor(144.9559, device='cuda:0')
benign distance is  tensor(144.9559, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.45406848192214966
distance x is tensor(129.8474, device='cuda:0')
benign distance is  tensor(129.8474, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.04741135239601135
distance x is tensor(145.1005, device='cuda:0')
benign distance is  tensor(145.1005, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.18331590294837952
distance x is tensor(98.7953, device='cuda:0')
benign distance is  tensor(98.7953, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.2116883248090744
distance x is tensor(169.7442, device='cuda:0')
benign distance is  tensor(169.7442, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7071799039840698
distance x is tensor(142.8258, device='cuda:0')
benign distance is  tensor(142.8258, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.29967525601387024
distance x is tensor(166.0688, device='cuda:0')
benign distance is  tensor(166.0688, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.24628300964832306
distance x is tensor(150.9286, device='cuda:0')
benign distance is  tensor(150.9286, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6126962304115295
distance x is tensor(161.1929, device='cuda:0')
benign distance is  tensor(161.1929, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7210392951965332
distance x is tensor(146.8327, device='cuda:0')
benign distance is  tensor(146.8327, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4196837544441223
distance x is tensor(142.9377, device='cuda:0')
benign distance is  tensor(142.9377, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.16570082306861877
distance x is tensor(119.1470, device='cuda:0')
benign distance is  tensor(119.1470, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.06527688354253769
distance x is tensor(156.3703, device='cuda:0')
benign distance is  tensor(156.3703, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.35393041372299194
distance x is tensor(138.5626, device='cuda:0')
benign distance is  tensor(138.5626, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.19273601472377777
distance x is tensor(148.5880, device='cuda:0')
benign distance is  tensor(148.5880, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.6027528643608093
distance x is tensor(160.8776, device='cuda:0')
benign distance is  tensor(160.8776, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.19916470348834991
distance x is tensor(145.1304, device='cuda:0')
benign distance is  tensor(145.1304, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.27998387813568115
distance x is tensor(147.5965, device='cuda:0')
benign distance is  tensor(147.5965, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.830886960029602
distance x is tensor(148.5120, device='cuda:0')
benign distance is  tensor(148.5120, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.29239386320114136
distance x is tensor(108.0438, device='cuda:0')
benign distance is  tensor(108.0438, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.2290288507938385
mal_entropy is 0.07054493576288223
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([572.2327, 548.0645, 534.6994, 462.3393, 507.4669, 598.3731, 448.9085,
        166.8091, 459.7248, 459.7248, 459.7248, 459.7248, 459.7248, 459.7248,
        459.7248, 459.7248, 459.7248, 459.7248, 459.7248, 459.7248, 712.6455,
        721.4372, 741.2910, 726.2912, 727.5684, 701.1597, 688.0234, 442.8734],
       device='cuda:0')
sorted_norm is   tensor([166.8091, 442.8734, 448.9085, 459.7248, 459.7248, 459.7248, 459.7248,
        459.7248, 459.7248, 459.7248, 459.7248, 459.7248, 459.7248, 459.7248,
        459.7248, 462.3393, 507.4669, 534.6994, 548.0645, 572.2327, 598.3731,
        688.0234, 701.1597, 712.6455, 721.4372, 726.2912, 727.5684, 741.2910],
       device='cuda:0')
used idx is  tensor([ 7, 27,  6, 18, 19, 15, 16, 17, 13, 12,  8,  9, 14, 10, 11,  3,  4,  2,
         1,  0,  5, 26], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 89.60% 

Test Accuracy: 88.77% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.49281492829322815
distance x is tensor(119.1598, device='cuda:0')
benign distance is  tensor(119.1598, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.599755585193634
distance x is tensor(143.5835, device='cuda:0')
benign distance is  tensor(143.5835, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.12840048968791962
distance x is tensor(142.1558, device='cuda:0')
benign distance is  tensor(142.1558, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.49356406927108765
distance x is tensor(126.0335, device='cuda:0')
benign distance is  tensor(126.0335, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2869277596473694
distance x is tensor(112.0342, device='cuda:0')
benign distance is  tensor(112.0342, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.344683051109314
distance x is tensor(141.5220, device='cuda:0')
benign distance is  tensor(141.5220, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3448803722858429
distance x is tensor(131.6983, device='cuda:0')
benign distance is  tensor(131.6983, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4846554398536682
distance x is tensor(57.5951, device='cuda:0')
benign distance is  tensor(57.5951, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.33560600876808167
distance x is tensor(156.1324, device='cuda:0')
benign distance is  tensor(156.1324, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.3840908706188202
distance x is tensor(145.3143, device='cuda:0')
benign distance is  tensor(145.3143, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.27615901827812195
distance x is tensor(158.4290, device='cuda:0')
benign distance is  tensor(158.4290, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.19023708999156952
distance x is tensor(155.4231, device='cuda:0')
benign distance is  tensor(155.4231, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4989606738090515
distance x is tensor(152.2017, device='cuda:0')
benign distance is  tensor(152.2017, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.2506961226463318
distance x is tensor(149.8979, device='cuda:0')
benign distance is  tensor(149.8979, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.2924966812133789
distance x is tensor(150.0968, device='cuda:0')
benign distance is  tensor(150.0968, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.30338239669799805
distance x is tensor(111.1101, device='cuda:0')
benign distance is  tensor(111.1101, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.3312002122402191
mal_entropy is 0.08589283376932144
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([530.7817, 631.0283, 622.7186, 535.4679, 480.6286, 613.1721, 565.0051,
        239.6719, 470.7024, 470.7024, 470.7024, 470.7024, 470.7024, 470.7024,
        470.7024, 470.7024, 470.7024, 470.7024, 470.7024, 470.7024, 697.3701,
        699.9132, 629.4730, 663.0848, 684.8834, 697.7291, 698.4052, 599.5712],
       device='cuda:0')
sorted_norm is   tensor([239.6719, 470.7024, 470.7024, 470.7024, 470.7024, 470.7024, 470.7024,
        470.7024, 470.7024, 470.7024, 470.7024, 470.7024, 470.7024, 480.6286,
        530.7817, 535.4679, 565.0051, 599.5712, 613.1721, 622.7186, 629.4730,
        631.0283, 663.0848, 684.8834, 697.3701, 697.7291, 698.4052, 699.9132],
       device='cuda:0')
used idx is  tensor([ 7, 19, 16, 18, 14, 12, 15, 17, 13, 10,  8,  9, 11,  4,  0,  3,  6, 27,
         5,  2, 22,  1], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 89.51% 

Test Accuracy: 88.69% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6832765340805054
distance x is tensor(134.6527, device='cuda:0')
benign distance is  tensor(134.6527, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6791170835494995
distance x is tensor(131.9752, device='cuda:0')
benign distance is  tensor(131.9752, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.07362447679042816
distance x is tensor(145.5572, device='cuda:0')
benign distance is  tensor(145.5572, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3001888394355774
distance x is tensor(139.1033, device='cuda:0')
benign distance is  tensor(139.1033, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4234725832939148
distance x is tensor(131.5861, device='cuda:0')
benign distance is  tensor(131.5861, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6953645348548889
distance x is tensor(135.7786, device='cuda:0')
benign distance is  tensor(135.7786, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.13474243879318237
distance x is tensor(141.8012, device='cuda:0')
benign distance is  tensor(141.8012, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.506393551826477
distance x is tensor(88.2259, device='cuda:0')
benign distance is  tensor(88.2259, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5153958201408386
distance x is tensor(166.4029, device='cuda:0')
benign distance is  tensor(166.4029, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.1448729783296585
distance x is tensor(166.6773, device='cuda:0')
benign distance is  tensor(166.6773, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.42325887084007263
distance x is tensor(160.6871, device='cuda:0')
benign distance is  tensor(160.6871, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.2645724415779114
distance x is tensor(181.8143, device='cuda:0')
benign distance is  tensor(181.8143, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.27443188428878784
distance x is tensor(147.7817, device='cuda:0')
benign distance is  tensor(147.7817, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.46141165494918823
distance x is tensor(152.8969, device='cuda:0')
benign distance is  tensor(152.8969, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.20125830173492432
distance x is tensor(152.9787, device='cuda:0')
benign distance is  tensor(152.9787, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.42636051774024963
distance x is tensor(135.0981, device='cuda:0')
benign distance is  tensor(135.0981, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.25716572999954224
mal_entropy is 0.07861264050006866
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([580.8699, 582.5159, 632.9604, 592.4803, 551.6718, 597.2894, 596.7379,
        389.5590, 583.3216, 583.3216, 583.3216, 583.3216, 583.3216, 583.3216,
        583.3216, 583.3216, 583.3216, 583.3216, 583.3216, 583.3216, 698.2237,
        820.3104, 690.6740, 729.6577, 721.1744, 651.0705, 712.2002, 536.7446],
       device='cuda:0')
sorted_norm is   tensor([389.5590, 536.7446, 551.6718, 580.8699, 582.5159, 583.3216, 583.3216,
        583.3216, 583.3216, 583.3216, 583.3216, 583.3216, 583.3216, 583.3216,
        583.3216, 583.3216, 583.3216, 592.4803, 596.7379, 597.2894, 632.9604,
        651.0705, 690.6740, 698.2237, 712.2002, 721.1744, 729.6577, 820.3104],
       device='cuda:0')
used idx is  tensor([ 7, 27,  4,  0,  1, 18, 16, 17, 13, 12, 14, 15, 19, 10,  8,  9, 11,  3,
         6,  5,  2, 25], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 89.19% 

Test Accuracy: 88.04% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9321271777153015
distance x is tensor(130.9238, device='cuda:0')
benign distance is  tensor(130.9238, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.225494384765625
distance x is tensor(136.6220, device='cuda:0')
benign distance is  tensor(136.6220, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.10057917982339859
distance x is tensor(138.0020, device='cuda:0')
benign distance is  tensor(138.0020, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2455020695924759
distance x is tensor(141.4012, device='cuda:0')
benign distance is  tensor(141.4012, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.31576457619667053
distance x is tensor(130.6295, device='cuda:0')
benign distance is  tensor(130.6295, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1422910690307617
distance x is tensor(146.6071, device='cuda:0')
benign distance is  tensor(146.6071, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6785251498222351
distance x is tensor(129.2038, device='cuda:0')
benign distance is  tensor(129.2038, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1295773684978485
distance x is tensor(84.0814, device='cuda:0')
benign distance is  tensor(84.0814, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.25098901987075806
distance x is tensor(156.4357, device='cuda:0')
benign distance is  tensor(156.4357, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5331438183784485
distance x is tensor(165.3588, device='cuda:0')
benign distance is  tensor(165.3588, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.28090184926986694
distance x is tensor(154.0485, device='cuda:0')
benign distance is  tensor(154.0485, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4084179401397705
distance x is tensor(163.7074, device='cuda:0')
benign distance is  tensor(163.7074, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.2354421615600586
distance x is tensor(154.7867, device='cuda:0')
benign distance is  tensor(154.7867, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8771359324455261
distance x is tensor(139.6980, device='cuda:0')
benign distance is  tensor(139.6980, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3260904848575592
distance x is tensor(172.8857, device='cuda:0')
benign distance is  tensor(172.8857, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4057103991508484
distance x is tensor(138.1737, device='cuda:0')
benign distance is  tensor(138.1737, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.8597133755683899
mal_entropy is 0.08135511726140976
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([569.1671, 591.3387, 602.6497, 608.5209, 559.4943, 638.7723, 553.7477,
        354.8492, 589.7480, 589.7480, 589.7480, 589.7480, 589.7480, 589.7480,
        589.7480, 589.7480, 589.7480, 589.7480, 589.7480, 589.7480, 859.7882,
        733.6902, 854.6095, 774.3360, 819.7683, 764.7841, 757.4549, 676.0228,
        780.1989, 773.5380, 760.5104, 838.8611, 715.1877, 724.5161, 722.1035,
        274.8335], device='cuda:0')
sorted_norm is   tensor([274.8335, 354.8492, 553.7477, 559.4943, 569.1671, 589.7480, 589.7480,
        589.7480, 589.7480, 589.7480, 589.7480, 589.7480, 589.7480, 589.7480,
        589.7480, 589.7480, 589.7480, 591.3387, 602.6497, 608.5209, 638.7723,
        676.0228, 715.1877, 722.1035, 724.5161, 733.6902, 757.4549, 760.5104,
        764.7841, 773.5380, 774.3360, 780.1989, 819.7683, 838.8611, 854.6095,
        859.7882], device='cuda:0')
used idx is  tensor([35,  7,  6,  4,  0, 13, 14, 12, 11, 10,  8, 15, 19, 18, 16, 17,  9,  1,
         2,  3,  5, 27, 32, 34, 33, 21, 26, 30], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 89.07% 

Test Accuracy: 88.60% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7537189722061157
distance x is tensor(138.3241, device='cuda:0')
benign distance is  tensor(138.3241, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7582845091819763
distance x is tensor(132.4414, device='cuda:0')
benign distance is  tensor(132.4414, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7460008859634399
distance x is tensor(136.6374, device='cuda:0')
benign distance is  tensor(136.6374, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.11838412284851074
distance x is tensor(119.4375, device='cuda:0')
benign distance is  tensor(119.4375, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4087201952934265
distance x is tensor(119.8910, device='cuda:0')
benign distance is  tensor(119.8910, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.462507426738739
distance x is tensor(140.8960, device='cuda:0')
benign distance is  tensor(140.8960, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2836112380027771
distance x is tensor(125.8875, device='cuda:0')
benign distance is  tensor(125.8875, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.44692760705947876
distance x is tensor(93.3002, device='cuda:0')
benign distance is  tensor(93.3002, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2078426629304886
distance x is tensor(155.5470, device='cuda:0')
benign distance is  tensor(155.5470, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8406168818473816
distance x is tensor(152.4294, device='cuda:0')
benign distance is  tensor(152.4294, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.47264185547828674
distance x is tensor(149.1355, device='cuda:0')
benign distance is  tensor(149.1355, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4679621756076813
distance x is tensor(144.6361, device='cuda:0')
benign distance is  tensor(144.6361, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4017246663570404
distance x is tensor(143.5572, device='cuda:0')
benign distance is  tensor(143.5572, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2839043438434601
distance x is tensor(154.7091, device='cuda:0')
benign distance is  tensor(154.7091, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2652469277381897
distance x is tensor(161.4659, device='cuda:0')
benign distance is  tensor(161.4659, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6270906329154968
distance x is tensor(115.9283, device='cuda:0')
benign distance is  tensor(115.9283, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.21271014213562012
distance x is tensor(170.4631, device='cuda:0')
benign distance is  tensor(170.4631, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.17657002806663513
distance x is tensor(137.7378, device='cuda:0')
benign distance is  tensor(137.7378, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.7513114809989929
distance x is tensor(165.8248, device='cuda:0')
benign distance is  tensor(165.8248, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.8370636105537415
distance x is tensor(160.0537, device='cuda:0')
benign distance is  tensor(160.0537, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.076505422592163
distance x is tensor(141.6268, device='cuda:0')
benign distance is  tensor(141.6268, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.48608464002609253
distance x is tensor(151.9023, device='cuda:0')
benign distance is  tensor(151.9023, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6795328855514526
distance x is tensor(174.5008, device='cuda:0')
benign distance is  tensor(174.5008, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.33659499883651733
distance x is tensor(151.4521, device='cuda:0')
benign distance is  tensor(151.4521, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.32171934843063354
mal_entropy is 0.06765270978212357
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([600.9979, 584.0267, 617.8223, 501.5928, 511.9328, 606.5623, 534.3925,
        389.6597, 673.4921, 673.4921, 673.4921, 673.4921, 673.4921, 673.4921,
        673.4921, 673.4921, 673.4921, 673.4921, 673.4921, 673.4921],
       device='cuda:0')
sorted_norm is   tensor([389.6597, 501.5928, 511.9328, 534.3925, 584.0267, 600.9979, 606.5623,
        617.8223, 673.4921, 673.4921, 673.4921, 673.4921, 673.4921, 673.4921,
        673.4921, 673.4921, 673.4921, 673.4921, 673.4921, 673.4921],
       device='cuda:0')
used idx is  tensor([ 7,  3,  4,  6,  1,  0,  5,  2, 19, 18, 16, 17, 13, 12, 14, 15],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 88.52% 

Test Accuracy: 88.12% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4781208634376526
distance x is tensor(125.4760, device='cuda:0')
benign distance is  tensor(125.4760, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4214712083339691
distance x is tensor(132.9888, device='cuda:0')
benign distance is  tensor(132.9888, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.13974629342556
distance x is tensor(129.1809, device='cuda:0')
benign distance is  tensor(129.1809, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6215255856513977
distance x is tensor(118.8280, device='cuda:0')
benign distance is  tensor(118.8280, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.26920029520988464
distance x is tensor(139.0342, device='cuda:0')
benign distance is  tensor(139.0342, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7346974611282349
distance x is tensor(124.6060, device='cuda:0')
benign distance is  tensor(124.6060, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4406006932258606
distance x is tensor(131.6514, device='cuda:0')
benign distance is  tensor(131.6514, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7147378921508789
distance x is tensor(106.7394, device='cuda:0')
benign distance is  tensor(106.7394, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.7500376105308533
mal_entropy is 0.039132941514253616
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([554.7253, 581.6997, 543.8364, 502.1333, 590.3970, 547.6354, 552.9524,
        464.5078, 464.5078, 464.5078, 464.5078, 464.5078, 464.5078, 464.5078,
        464.5078, 464.5078, 464.5078, 464.5078, 464.5078, 464.5078, 852.4948,
        803.8318, 844.2268, 877.1385, 811.1937, 833.4961, 829.1393, 615.6512,
        837.9349, 818.1992, 865.9309, 841.0001, 837.9341, 812.8328, 836.8850,
        589.1036, 780.3853, 827.8247, 783.5125, 828.1102, 798.1890, 743.5173,
        858.1145, 525.3303, 735.7691, 732.0746, 727.3653, 718.3243, 706.3475,
        759.6923, 790.1435, 600.1467], device='cuda:0')
sorted_norm is   tensor([464.5078, 464.5078, 464.5078, 464.5078, 464.5078, 464.5078, 464.5078,
        464.5078, 464.5078, 464.5078, 464.5078, 464.5078, 464.5078, 502.1333,
        525.3303, 543.8364, 547.6354, 552.9524, 554.7253, 581.6997, 589.1036,
        590.3970, 600.1467, 615.6512, 706.3475, 718.3243, 727.3653, 732.0746,
        735.7691, 743.5173, 759.6923, 780.3853, 783.5125, 790.1435, 798.1890,
        803.8318, 811.1937, 812.8328, 818.1992, 827.8247, 828.1102, 829.1393,
        833.4961, 836.8850, 837.9341, 837.9349, 841.0001, 844.2268, 852.4948,
        858.1145, 865.9309, 877.1385], device='cuda:0')
used idx is  tensor([11, 10,  8, 19, 13, 18, 16, 17, 15, 12, 14,  9,  7,  3, 43,  2,  5,  6,
         0,  1, 35,  4, 51, 27, 48, 47, 46, 45, 44, 41, 49, 36, 38, 50, 40, 21,
        24, 33, 29, 37, 39], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 89.72% 

Test Accuracy: 89.08% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.592802882194519
distance x is tensor(123.7179, device='cuda:0')
benign distance is  tensor(123.7179, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6056624054908752
distance x is tensor(136.7781, device='cuda:0')
benign distance is  tensor(136.7781, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.09804900735616684
distance x is tensor(139.3480, device='cuda:0')
benign distance is  tensor(139.3480, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.26385587453842163
distance x is tensor(132.4446, device='cuda:0')
benign distance is  tensor(132.4446, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6521363854408264
distance x is tensor(101.5529, device='cuda:0')
benign distance is  tensor(101.5529, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7340694665908813
distance x is tensor(130.9713, device='cuda:0')
benign distance is  tensor(130.9713, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5415742993354797
distance x is tensor(125.1002, device='cuda:0')
benign distance is  tensor(125.1002, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.545373260974884
distance x is tensor(50.9503, device='cuda:0')
benign distance is  tensor(50.9503, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.293655663728714
distance x is tensor(147.0763, device='cuda:0')
benign distance is  tensor(147.0763, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3162108361721039
distance x is tensor(147.8159, device='cuda:0')
benign distance is  tensor(147.8159, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.41047295928001404
distance x is tensor(145.1838, device='cuda:0')
benign distance is  tensor(145.1838, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.573739767074585
distance x is tensor(151.7346, device='cuda:0')
benign distance is  tensor(151.7346, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4512346386909485
distance x is tensor(140.5105, device='cuda:0')
benign distance is  tensor(140.5105, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.40561166405677795
distance x is tensor(151.5917, device='cuda:0')
benign distance is  tensor(151.5917, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.37608394026756287
distance x is tensor(142.8447, device='cuda:0')
benign distance is  tensor(142.8447, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.645809531211853
distance x is tensor(117.9040, device='cuda:0')
benign distance is  tensor(117.9040, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.1198677271604538
distance x is tensor(143.1954, device='cuda:0')
benign distance is  tensor(143.1954, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.42184892296791077
distance x is tensor(164.7028, device='cuda:0')
benign distance is  tensor(164.7028, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.49824801087379456
distance x is tensor(141.1674, device='cuda:0')
benign distance is  tensor(141.1674, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2742921710014343
distance x is tensor(145.5217, device='cuda:0')
benign distance is  tensor(145.5217, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5686066150665283
distance x is tensor(146.6984, device='cuda:0')
benign distance is  tensor(146.6984, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6706132292747498
distance x is tensor(136.7263, device='cuda:0')
benign distance is  tensor(136.7263, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.6846295595169067
distance x is tensor(158.4745, device='cuda:0')
benign distance is  tensor(158.4745, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.37145528197288513
distance x is tensor(102.4421, device='cuda:0')
benign distance is  tensor(102.4421, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.73106449842453
distance x is tensor(156.5337, device='cuda:0')
benign distance is  tensor(156.5337, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.07665906846523285
distance x is tensor(154.5466, device='cuda:0')
benign distance is  tensor(154.5466, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.588378369808197
distance x is tensor(172.2616, device='cuda:0')
benign distance is  tensor(172.2616, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.07145576179027557
distance x is tensor(151.1562, device='cuda:0')
benign distance is  tensor(151.1562, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8126246333122253
distance x is tensor(150.9686, device='cuda:0')
benign distance is  tensor(150.9686, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.46346840262413025
distance x is tensor(157.5237, device='cuda:0')
benign distance is  tensor(157.5237, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.1459845006465912
distance x is tensor(131.2894, device='cuda:0')
benign distance is  tensor(131.2894, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.09896267205476761
distance x is tensor(101.2104, device='cuda:0')
benign distance is  tensor(101.2104, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.1523461639881134
distance x is tensor(151.2191, device='cuda:0')
benign distance is  tensor(151.2191, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.19572734832763672
distance x is tensor(148.9120, device='cuda:0')
benign distance is  tensor(148.9120, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.4032221734523773
distance x is tensor(141.5201, device='cuda:0')
benign distance is  tensor(141.5201, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.6048848628997803
distance x is tensor(146.8584, device='cuda:0')
benign distance is  tensor(146.8584, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.27842140197753906
distance x is tensor(152.4596, device='cuda:0')
benign distance is  tensor(152.4596, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5213362574577332
distance x is tensor(167.4735, device='cuda:0')
benign distance is  tensor(167.4735, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.4288373589515686
distance x is tensor(147.3448, device='cuda:0')
benign distance is  tensor(147.3448, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.18709459900856018
distance x is tensor(112.5078, device='cuda:0')
benign distance is  tensor(112.5078, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.0994415208697319
mal_entropy is 0.09832560271024704
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([527.8629, 596.4852, 602.6840, 563.3088, 437.9702, 579.6063, 526.0732,
        213.6023, 484.7431, 484.7431, 484.7431, 484.7431, 484.7431, 484.7431,
        484.7431, 484.7431, 484.7431, 484.7431, 484.7431, 484.7431],
       device='cuda:0')
sorted_norm is   tensor([213.6023, 437.9702, 484.7431, 484.7431, 484.7431, 484.7431, 484.7431,
        484.7431, 484.7431, 484.7431, 484.7431, 484.7431, 484.7431, 484.7431,
        526.0732, 527.8629, 563.3088, 579.6063, 596.4852, 602.6840],
       device='cuda:0')
used idx is  tensor([ 7,  4, 19, 18, 14, 15, 16, 17, 13, 12,  8,  9, 11, 10,  6,  0],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 89.53% 

Test Accuracy: 87.98% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8214374780654907
distance x is tensor(130.4452, device='cuda:0')
benign distance is  tensor(130.4452, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.36510106921195984
distance x is tensor(172.1944, device='cuda:0')
benign distance is  tensor(172.1944, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.25162649154663086
distance x is tensor(155.1105, device='cuda:0')
benign distance is  tensor(155.1105, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5942831039428711
distance x is tensor(150.5597, device='cuda:0')
benign distance is  tensor(150.5597, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4823546409606934
distance x is tensor(117.0506, device='cuda:0')
benign distance is  tensor(117.0506, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5930421352386475
distance x is tensor(146.2022, device='cuda:0')
benign distance is  tensor(146.2022, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3772880434989929
distance x is tensor(149.2957, device='cuda:0')
benign distance is  tensor(149.2957, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5407888293266296
distance x is tensor(103.8107, device='cuda:0')
benign distance is  tensor(103.8107, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.8934572339057922
mal_entropy is 0.08494549989700317
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([559.0726, 743.2226, 666.3030, 648.2045, 497.4949, 632.1387, 627.7258,
        442.3391, 442.3391, 442.3391, 442.3391, 442.3391, 442.3391, 442.3391,
        442.3391, 442.3391, 442.3391, 442.3391, 442.3391, 442.3391, 844.8886,
        723.5081, 833.4391, 803.5195, 736.9051, 773.8845, 865.8227, 677.8647,
        729.9841, 728.0754, 730.6583, 747.3278, 722.5254, 744.6476, 711.0818,
        617.5727], device='cuda:0')
sorted_norm is   tensor([442.3391, 442.3391, 442.3391, 442.3391, 442.3391, 442.3391, 442.3391,
        442.3391, 442.3391, 442.3391, 442.3391, 442.3391, 442.3391, 497.4949,
        559.0726, 617.5727, 627.7258, 632.1387, 648.2045, 666.3030, 677.8647,
        711.0818, 722.5254, 723.5081, 728.0754, 729.9841, 730.6583, 736.9051,
        743.2226, 744.6476, 747.3278, 773.8845, 803.5195, 833.4391, 844.8886,
        865.8227], device='cuda:0')
used idx is  tensor([11, 10,  8, 19, 13, 18, 16, 17, 15, 12, 14,  9,  7,  4,  0, 35,  6,  5,
         3,  2, 27, 34, 32, 21, 29, 28, 30, 24], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 89.58% 

Test Accuracy: 88.78% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8780948519706726
distance x is tensor(131.5729, device='cuda:0')
benign distance is  tensor(131.5729, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5299556255340576
distance x is tensor(134.6249, device='cuda:0')
benign distance is  tensor(134.6249, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.052960105240345
distance x is tensor(140.9137, device='cuda:0')
benign distance is  tensor(140.9137, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5745999813079834
distance x is tensor(127.2739, device='cuda:0')
benign distance is  tensor(127.2739, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.40105462074279785
distance x is tensor(98.2810, device='cuda:0')
benign distance is  tensor(98.2810, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3446933329105377
distance x is tensor(136.7095, device='cuda:0')
benign distance is  tensor(136.7095, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.09892375022172928
distance x is tensor(113.3735, device='cuda:0')
benign distance is  tensor(113.3735, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6555067896842957
distance x is tensor(46.2031, device='cuda:0')
benign distance is  tensor(46.2031, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.32917508482933044
distance x is tensor(169.0234, device='cuda:0')
benign distance is  tensor(169.0234, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.23278740048408508
distance x is tensor(160.1862, device='cuda:0')
benign distance is  tensor(160.1862, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9259893298149109
distance x is tensor(143.2950, device='cuda:0')
benign distance is  tensor(143.2950, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6618636846542358
distance x is tensor(155.3182, device='cuda:0')
benign distance is  tensor(155.3182, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.1108684167265892
distance x is tensor(164.5183, device='cuda:0')
benign distance is  tensor(164.5183, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.20442399382591248
distance x is tensor(167.9452, device='cuda:0')
benign distance is  tensor(167.9452, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.702073872089386
distance x is tensor(152.2613, device='cuda:0')
benign distance is  tensor(152.2613, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.2955225706100464
distance x is tensor(97.0012, device='cuda:0')
benign distance is  tensor(97.0012, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3457784652709961
distance x is tensor(156.7987, device='cuda:0')
benign distance is  tensor(156.7987, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.8018368482589722
distance x is tensor(148.7056, device='cuda:0')
benign distance is  tensor(148.7056, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5743716359138489
distance x is tensor(169.7327, device='cuda:0')
benign distance is  tensor(169.7327, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.8755176663398743
distance x is tensor(164.9636, device='cuda:0')
benign distance is  tensor(164.9636, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8969122767448425
distance x is tensor(169.4425, device='cuda:0')
benign distance is  tensor(169.4425, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.24872545897960663
distance x is tensor(148.8997, device='cuda:0')
benign distance is  tensor(148.8997, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5851038098335266
distance x is tensor(169.4415, device='cuda:0')
benign distance is  tensor(169.4415, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7317870259284973
distance x is tensor(144.9830, device='cuda:0')
benign distance is  tensor(144.9830, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.6961289644241333
mal_entropy is 0.15985305607318878
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([573.9957, 582.8970, 599.8407, 538.9371, 414.3158, 592.8649, 481.3284,
        181.3538, 629.5213, 629.5213, 629.5213, 629.5213, 629.5213, 629.5213,
        629.5213, 629.5213, 629.5213, 629.5213, 629.5213, 629.5213, 681.2081,
        783.8132, 690.1943, 708.5464, 699.5546, 654.9497, 762.5115, 528.6481],
       device='cuda:0')
sorted_norm is   tensor([181.3538, 414.3158, 481.3284, 528.6481, 538.9371, 573.9957, 582.8970,
        592.8649, 599.8407, 629.5213, 629.5213, 629.5213, 629.5213, 629.5213,
        629.5213, 629.5213, 629.5213, 629.5213, 629.5213, 629.5213, 629.5213,
        654.9497, 681.2081, 690.1943, 699.5546, 708.5464, 762.5115, 783.8132],
       device='cuda:0')
used idx is  tensor([ 7,  4,  6, 27,  3,  0,  1,  5,  2, 18, 16, 17, 19, 12, 14, 15, 11, 10,
         8,  9, 13, 25], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 89.26% 

Test Accuracy: 88.16% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.05350608751177788
distance x is tensor(138.1519, device='cuda:0')
benign distance is  tensor(138.1519, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6547285318374634
distance x is tensor(143.1215, device='cuda:0')
benign distance is  tensor(143.1215, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.08586212247610092
distance x is tensor(146.1058, device='cuda:0')
benign distance is  tensor(146.1058, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0080894231796265
distance x is tensor(132.1413, device='cuda:0')
benign distance is  tensor(132.1413, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.46114104986190796
distance x is tensor(125.4395, device='cuda:0')
benign distance is  tensor(125.4395, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.35262003540992737
distance x is tensor(149.9891, device='cuda:0')
benign distance is  tensor(149.9891, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7879536151885986
distance x is tensor(143.4519, device='cuda:0')
benign distance is  tensor(143.4519, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.20454013347625732
distance x is tensor(82.2148, device='cuda:0')
benign distance is  tensor(82.2148, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.1731036901473999
distance x is tensor(152.1068, device='cuda:0')
benign distance is  tensor(152.1068, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8842241168022156
distance x is tensor(164.0571, device='cuda:0')
benign distance is  tensor(164.0571, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.06815505027770996
distance x is tensor(160.6554, device='cuda:0')
benign distance is  tensor(160.6554, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.677000880241394
distance x is tensor(167.7519, device='cuda:0')
benign distance is  tensor(167.7519, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3509993553161621
distance x is tensor(154.3594, device='cuda:0')
benign distance is  tensor(154.3594, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4437686502933502
distance x is tensor(153.3297, device='cuda:0')
benign distance is  tensor(153.3297, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.07940442860126495
distance x is tensor(175.0685, device='cuda:0')
benign distance is  tensor(175.0685, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.43207868933677673
distance x is tensor(133.3111, device='cuda:0')
benign distance is  tensor(133.3111, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.3056705594062805
mal_entropy is 0.2123035043478012
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([589.2888, 619.7863, 624.7774, 561.1453, 524.9556, 642.9188, 606.6103,
        360.1179, 564.4717, 564.4717, 564.4717, 564.4717, 564.4717, 564.4717,
        564.4717, 564.4717, 564.4717, 564.4717, 564.4717, 564.4717, 811.3166,
        776.6661, 710.6004, 751.4145, 801.7513, 796.1272, 747.8118, 543.2010],
       device='cuda:0')
sorted_norm is   tensor([360.1179, 524.9556, 543.2010, 561.1453, 564.4717, 564.4717, 564.4717,
        564.4717, 564.4717, 564.4717, 564.4717, 564.4717, 564.4717, 564.4717,
        564.4717, 564.4717, 589.2888, 606.6103, 619.7863, 624.7774, 642.9188,
        710.6004, 747.8118, 751.4145, 776.6661, 796.1272, 801.7513, 811.3166],
       device='cuda:0')
used idx is  tensor([ 7,  4, 27,  3, 19, 18, 16, 17, 13, 12, 14,  9, 15, 11,  8, 10,  0,  6,
         1,  2,  5, 22], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 89.16% 

Test Accuracy: 88.24% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4134902060031891
distance x is tensor(154.1460, device='cuda:0')
benign distance is  tensor(154.1460, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.46233391761779785
distance x is tensor(154.8529, device='cuda:0')
benign distance is  tensor(154.8529, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.28890305757522583
distance x is tensor(154.2016, device='cuda:0')
benign distance is  tensor(154.2016, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6415471434593201
distance x is tensor(130.8868, device='cuda:0')
benign distance is  tensor(130.8868, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6044642329216003
distance x is tensor(127.6755, device='cuda:0')
benign distance is  tensor(127.6755, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8506786227226257
distance x is tensor(151.2302, device='cuda:0')
benign distance is  tensor(151.2302, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.22224517166614532
distance x is tensor(145.2906, device='cuda:0')
benign distance is  tensor(145.2906, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6038222312927246
distance x is tensor(72.5700, device='cuda:0')
benign distance is  tensor(72.5700, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3561888635158539
distance x is tensor(159.9807, device='cuda:0')
benign distance is  tensor(159.9807, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6929101943969727
distance x is tensor(153.5399, device='cuda:0')
benign distance is  tensor(153.5399, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.2224748134613037
distance x is tensor(149.7419, device='cuda:0')
benign distance is  tensor(149.7419, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5373454689979553
distance x is tensor(171.1851, device='cuda:0')
benign distance is  tensor(171.1851, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.44782590866088867
distance x is tensor(147.5315, device='cuda:0')
benign distance is  tensor(147.5315, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.06954925507307053
distance x is tensor(174.5395, device='cuda:0')
benign distance is  tensor(174.5395, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.33695557713508606
distance x is tensor(155.5398, device='cuda:0')
benign distance is  tensor(155.5398, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.2257935106754303
distance x is tensor(126.1182, device='cuda:0')
benign distance is  tensor(126.1182, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.5180414915084839
mal_entropy is 0.09024490416049957
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([656.8486, 673.7972, 668.8052, 560.7497, 536.5349, 651.0546, 607.8672,
        308.7744, 537.9070, 537.9070, 537.9070, 537.9070, 537.9070, 537.9070,
        537.9070, 537.9070, 537.9070, 537.9070, 537.9070, 537.9070, 845.7668,
        833.0984, 899.5435, 821.6671, 828.7675, 834.2308, 743.7484, 657.0709],
       device='cuda:0')
sorted_norm is   tensor([308.7744, 536.5349, 537.9070, 537.9070, 537.9070, 537.9070, 537.9070,
        537.9070, 537.9070, 537.9070, 537.9070, 537.9070, 537.9070, 537.9070,
        560.7497, 607.8672, 651.0546, 656.8486, 657.0709, 668.8052, 673.7972,
        743.7484, 821.6671, 828.7675, 833.0984, 834.2308, 845.7668, 899.5435],
       device='cuda:0')
used idx is  tensor([ 7,  4, 19, 18, 14, 15, 16, 17, 13, 12,  8,  9, 11, 10,  3,  6,  5,  0,
        27,  2,  1, 26], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 89.37% 

Test Accuracy: 88.70% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.7666823863983154
distance x is tensor(142.0220, device='cuda:0')
benign distance is  tensor(142.0220, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9433532953262329
distance x is tensor(148.7171, device='cuda:0')
benign distance is  tensor(148.7171, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.036530062556266785
distance x is tensor(154.9527, device='cuda:0')
benign distance is  tensor(154.9527, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.317109614610672
distance x is tensor(157.5422, device='cuda:0')
benign distance is  tensor(157.5422, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5968846082687378
distance x is tensor(128.0824, device='cuda:0')
benign distance is  tensor(128.0824, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9952301979064941
distance x is tensor(154.8035, device='cuda:0')
benign distance is  tensor(154.8035, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.547360897064209
distance x is tensor(160.2686, device='cuda:0')
benign distance is  tensor(160.2686, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.31581634283065796
distance x is tensor(85.5914, device='cuda:0')
benign distance is  tensor(85.5914, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.5404422879219055
distance x is tensor(167.4704, device='cuda:0')
benign distance is  tensor(167.4704, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.10828697681427002
distance x is tensor(178.1498, device='cuda:0')
benign distance is  tensor(178.1498, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.18051835894584656
distance x is tensor(180.4612, device='cuda:0')
benign distance is  tensor(180.4612, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.2898102402687073
distance x is tensor(165.7959, device='cuda:0')
benign distance is  tensor(165.7959, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5881770253181458
distance x is tensor(158.6954, device='cuda:0')
benign distance is  tensor(158.6954, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.40189844369888306
distance x is tensor(155.1651, device='cuda:0')
benign distance is  tensor(155.1651, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.39337077736854553
distance x is tensor(164.5209, device='cuda:0')
benign distance is  tensor(164.5209, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.057057417929172516
distance x is tensor(131.1485, device='cuda:0')
benign distance is  tensor(131.1485, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.9690073132514954
mal_entropy is 0.022263308987021446
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([620.4459, 638.6140, 669.5464, 677.1279, 553.9428, 666.5185, 692.9226,
        364.7441, 558.1007, 558.1007, 558.1007, 558.1007, 558.1007, 558.1007,
        558.1007, 558.1007, 558.1007, 558.1007, 558.1007, 558.1007, 823.9908,
        843.0778, 807.5476, 828.2062, 843.1058, 887.8672, 835.9075, 604.9584,
        828.4282, 792.6742, 867.3464, 841.5859, 865.8228, 791.1648, 869.4415,
        571.5350, 768.0568, 807.4743, 792.5129, 824.4691, 775.9672, 774.7777,
        846.2830, 453.3731, 744.1645, 716.2882, 719.0662, 789.7709, 711.3349,
        809.6856, 727.9864, 259.1453], device='cuda:0')
sorted_norm is   tensor([259.1453, 364.7441, 453.3731, 553.9428, 558.1007, 558.1007, 558.1007,
        558.1007, 558.1007, 558.1007, 558.1007, 558.1007, 558.1007, 558.1007,
        558.1007, 558.1007, 571.5350, 604.9584, 620.4459, 638.6140, 666.5185,
        669.5464, 677.1279, 692.9226, 711.3349, 716.2882, 719.0662, 727.9864,
        744.1645, 768.0568, 774.7777, 775.9672, 789.7709, 791.1648, 792.5129,
        792.6742, 807.4743, 807.5476, 809.6856, 823.9908, 824.4691, 828.2062,
        828.4282, 835.9075, 841.5859, 843.0778, 843.1058, 846.2830, 865.8228,
        867.3464, 869.4415, 887.8672], device='cuda:0')
used idx is  tensor([51,  7, 43,  4, 13, 12, 19, 18, 11, 10,  8,  9, 14, 15, 16, 17, 35, 27,
         0,  1,  5,  2,  3,  6, 48, 45, 46, 50, 44, 36, 41, 40, 47, 33, 38, 29,
        37, 22, 49, 20, 39], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 89.66% 

Test Accuracy: 88.59% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.13983309268951416
distance x is tensor(139.2448, device='cuda:0')
benign distance is  tensor(139.2448, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.17017127573490143
distance x is tensor(122.4297, device='cuda:0')
benign distance is  tensor(122.4297, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.05406744405627251
distance x is tensor(127.2954, device='cuda:0')
benign distance is  tensor(127.2954, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6220000386238098
distance x is tensor(108.9523, device='cuda:0')
benign distance is  tensor(108.9523, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4838794767856598
distance x is tensor(106.4219, device='cuda:0')
benign distance is  tensor(106.4219, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9884530305862427
distance x is tensor(126.1874, device='cuda:0')
benign distance is  tensor(126.1874, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3496374487876892
distance x is tensor(120.8611, device='cuda:0')
benign distance is  tensor(120.8611, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.12155823409557343
distance x is tensor(55.3578, device='cuda:0')
benign distance is  tensor(55.3578, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6486078500747681
distance x is tensor(162.0385, device='cuda:0')
benign distance is  tensor(162.0385, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4046897292137146
distance x is tensor(155.0708, device='cuda:0')
benign distance is  tensor(155.0708, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6082743406295776
distance x is tensor(147.6133, device='cuda:0')
benign distance is  tensor(147.6133, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9677022695541382
distance x is tensor(160.0031, device='cuda:0')
benign distance is  tensor(160.0031, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3192843794822693
distance x is tensor(140.4356, device='cuda:0')
benign distance is  tensor(140.4356, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.24228541553020477
distance x is tensor(153.7595, device='cuda:0')
benign distance is  tensor(153.7595, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3337993919849396
distance x is tensor(144.3699, device='cuda:0')
benign distance is  tensor(144.3699, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0257985591888428
distance x is tensor(81.1458, device='cuda:0')
benign distance is  tensor(81.1458, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.313419371843338
distance x is tensor(149.0778, device='cuda:0')
benign distance is  tensor(149.0778, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5852548480033875
distance x is tensor(168.4867, device='cuda:0')
benign distance is  tensor(168.4867, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.19702263176441193
distance x is tensor(144.3192, device='cuda:0')
benign distance is  tensor(144.3192, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.23775258660316467
distance x is tensor(151.8782, device='cuda:0')
benign distance is  tensor(151.8782, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.49119848012924194
distance x is tensor(150.4917, device='cuda:0')
benign distance is  tensor(150.4917, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9413440823554993
distance x is tensor(141.4596, device='cuda:0')
benign distance is  tensor(141.4596, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.49709582328796387
distance x is tensor(151.8384, device='cuda:0')
benign distance is  tensor(151.8384, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5827977657318115
distance x is tensor(101.5426, device='cuda:0')
benign distance is  tensor(101.5426, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.08879397064447403
distance x is tensor(166.4348, device='cuda:0')
benign distance is  tensor(166.4348, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.2239714413881302
distance x is tensor(150.8231, device='cuda:0')
benign distance is  tensor(150.8231, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.22013792395591736
distance x is tensor(147.2932, device='cuda:0')
benign distance is  tensor(147.2932, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3735220730304718
distance x is tensor(145.8029, device='cuda:0')
benign distance is  tensor(145.8029, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.821313738822937
distance x is tensor(148.4014, device='cuda:0')
benign distance is  tensor(148.4014, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.2786981761455536
distance x is tensor(155.6720, device='cuda:0')
benign distance is  tensor(155.6720, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.3310815393924713
distance x is tensor(148.1976, device='cuda:0')
benign distance is  tensor(148.1976, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.1550021916627884
distance x is tensor(122.7572, device='cuda:0')
benign distance is  tensor(122.7572, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.32309651374816895
distance x is tensor(152.2000, device='cuda:0')
benign distance is  tensor(152.2000, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.19010905921459198
distance x is tensor(161.1074, device='cuda:0')
benign distance is  tensor(161.1074, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.09629280120134354
distance x is tensor(153.6551, device='cuda:0')
benign distance is  tensor(153.6551, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.04624556377530098
distance x is tensor(152.9533, device='cuda:0')
benign distance is  tensor(152.9533, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.356334388256073
distance x is tensor(145.8078, device='cuda:0')
benign distance is  tensor(145.8078, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.48812541365623474
distance x is tensor(151.8139, device='cuda:0')
benign distance is  tensor(151.8139, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.5048955678939819
distance x is tensor(155.3577, device='cuda:0')
benign distance is  tensor(155.3577, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.2863883376121521
distance x is tensor(112.6247, device='cuda:0')
benign distance is  tensor(112.6247, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.5232332944869995
mal_entropy is 0.13780491054058075
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([615.1562, 536.6343, 550.3956, 471.1144, 463.7712, 551.9046, 503.3150,
        235.7450, 488.7751, 488.7751, 488.7751, 488.7751, 488.7751, 488.7751,
        488.7751, 488.7751, 488.7751, 488.7751, 488.7751, 488.7751],
       device='cuda:0')
sorted_norm is   tensor([235.7450, 463.7712, 471.1144, 488.7751, 488.7751, 488.7751, 488.7751,
        488.7751, 488.7751, 488.7751, 488.7751, 488.7751, 488.7751, 488.7751,
        488.7751, 503.3150, 536.6343, 550.3956, 551.9046, 615.1562],
       device='cuda:0')
used idx is  tensor([ 7,  4,  3, 19, 15, 18, 16, 17, 13, 12, 14,  9,  8, 11, 10,  6],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 89.28% 

Test Accuracy: 88.31% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5142671465873718
distance x is tensor(127.1912, device='cuda:0')
benign distance is  tensor(127.1912, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3694607615470886
distance x is tensor(177.1182, device='cuda:0')
benign distance is  tensor(177.1182, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.026562536135315895
distance x is tensor(138.2457, device='cuda:0')
benign distance is  tensor(138.2457, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9442729949951172
distance x is tensor(131.5638, device='cuda:0')
benign distance is  tensor(131.5638, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9480686187744141
distance x is tensor(152.0085, device='cuda:0')
benign distance is  tensor(152.0085, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5540226697921753
distance x is tensor(141.1919, device='cuda:0')
benign distance is  tensor(141.1919, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6382481455802917
distance x is tensor(128.9594, device='cuda:0')
benign distance is  tensor(128.9594, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4563349783420563
distance x is tensor(92.7109, device='cuda:0')
benign distance is  tensor(92.7109, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.5768975019454956
mal_entropy is 0.04893825203180313
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([548.6633, 747.3763, 588.2927, 560.9221, 629.4987, 611.6207, 539.8257,
        391.4371, 391.4371, 391.4371, 391.4371, 391.4371, 391.4371, 391.4371,
        391.4371, 391.4371, 391.4371, 391.4371, 391.4371, 391.4371, 783.4307,
        746.2726, 754.8848, 773.7533, 712.9943, 767.1025, 727.9381, 507.5705],
       device='cuda:0')
sorted_norm is   tensor([391.4371, 391.4371, 391.4371, 391.4371, 391.4371, 391.4371, 391.4371,
        391.4371, 391.4371, 391.4371, 391.4371, 391.4371, 391.4371, 507.5705,
        539.8257, 548.6633, 560.9221, 588.2927, 611.6207, 629.4987, 712.9943,
        727.9381, 746.2726, 747.3763, 754.8848, 767.1025, 773.7533, 783.4307],
       device='cuda:0')
used idx is  tensor([19, 18, 16, 17, 13, 12, 14,  7, 11, 10,  8,  9, 15, 27,  6,  0,  3,  2,
         5,  4, 24, 26], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 89.34% 

Test Accuracy: 88.29% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.48285213112831116
distance x is tensor(167.8970, device='cuda:0')
benign distance is  tensor(167.8970, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.17586521804332733
distance x is tensor(163.9670, device='cuda:0')
benign distance is  tensor(163.9670, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.06093117594718933
distance x is tensor(178.8419, device='cuda:0')
benign distance is  tensor(178.8419, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4938092827796936
distance x is tensor(143.4298, device='cuda:0')
benign distance is  tensor(143.4298, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5102042555809021
distance x is tensor(121.0705, device='cuda:0')
benign distance is  tensor(121.0705, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8446283340454102
distance x is tensor(136.2751, device='cuda:0')
benign distance is  tensor(136.2751, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.12772980332374573
distance x is tensor(142.5355, device='cuda:0')
benign distance is  tensor(142.5355, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7172819375991821
distance x is tensor(95.9569, device='cuda:0')
benign distance is  tensor(95.9569, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.126941978931427
distance x is tensor(165.2665, device='cuda:0')
benign distance is  tensor(165.2665, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.2786637246608734
distance x is tensor(167.8092, device='cuda:0')
benign distance is  tensor(167.8092, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9945939779281616
distance x is tensor(164.0408, device='cuda:0')
benign distance is  tensor(164.0408, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.1097958087921143
distance x is tensor(166.8599, device='cuda:0')
benign distance is  tensor(166.8599, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5756946802139282
distance x is tensor(165.1266, device='cuda:0')
benign distance is  tensor(165.1266, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.16277511417865753
distance x is tensor(160.8707, device='cuda:0')
benign distance is  tensor(160.8707, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.861872673034668
distance x is tensor(167.9386, device='cuda:0')
benign distance is  tensor(167.9386, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.1884056031703949
distance x is tensor(121.4267, device='cuda:0')
benign distance is  tensor(121.4267, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 1.0177432298660278
mal_entropy is 0.0847916230559349
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([715.9592, 713.0236, 757.7331, 596.3541, 519.2617, 584.6370, 609.1422,
        421.3537, 508.2621, 508.2621, 508.2621, 508.2621, 508.2621, 508.2621,
        508.2621, 508.2621, 508.2621, 508.2621, 508.2621, 508.2621, 746.1120,
        821.7237, 714.6061, 759.1171, 756.5267, 713.9932, 757.5609, 560.9620],
       device='cuda:0')
sorted_norm is   tensor([421.3537, 508.2621, 508.2621, 508.2621, 508.2621, 508.2621, 508.2621,
        508.2621, 508.2621, 508.2621, 508.2621, 508.2621, 508.2621, 519.2617,
        560.9620, 584.6370, 596.3541, 609.1422, 713.0236, 713.9932, 714.6061,
        715.9592, 746.1120, 756.5267, 757.5609, 757.7331, 759.1171, 821.7237],
       device='cuda:0')
used idx is  tensor([ 7, 19, 16, 18, 14, 12, 15, 17, 13, 10,  8,  9, 11,  4, 27,  5,  3,  6,
         1, 25, 22,  0], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 89.39% 

Test Accuracy: 88.60% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7328002452850342
distance x is tensor(155.3265, device='cuda:0')
benign distance is  tensor(155.3265, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0972998142242432
distance x is tensor(156.3765, device='cuda:0')
benign distance is  tensor(156.3765, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2930685579776764
distance x is tensor(159.0831, device='cuda:0')
benign distance is  tensor(159.0831, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5198084115982056
distance x is tensor(136.0405, device='cuda:0')
benign distance is  tensor(136.0405, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0997732877731323
distance x is tensor(142.4188, device='cuda:0')
benign distance is  tensor(142.4188, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8324677348136902
distance x is tensor(155.9580, device='cuda:0')
benign distance is  tensor(155.9580, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1873427927494049
distance x is tensor(137.9075, device='cuda:0')
benign distance is  tensor(137.9075, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.48856204748153687
distance x is tensor(71.7290, device='cuda:0')
benign distance is  tensor(71.7290, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2587319016456604
distance x is tensor(170.9337, device='cuda:0')
benign distance is  tensor(170.9337, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5487728714942932
distance x is tensor(185.2222, device='cuda:0')
benign distance is  tensor(185.2222, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.6545976400375366
distance x is tensor(165.4823, device='cuda:0')
benign distance is  tensor(165.4823, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.628929853439331
distance x is tensor(172.6590, device='cuda:0')
benign distance is  tensor(172.6590, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.416088342666626
distance x is tensor(160.2746, device='cuda:0')
benign distance is  tensor(160.2746, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4084741473197937
distance x is tensor(167.7674, device='cuda:0')
benign distance is  tensor(167.7674, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.49144965410232544
distance x is tensor(176.8876, device='cuda:0')
benign distance is  tensor(176.8876, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6699622869491577
distance x is tensor(123.0802, device='cuda:0')
benign distance is  tensor(123.0802, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.29267993569374084
mal_entropy is 0.07323234528303146
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([669.4098, 684.7142, 687.7175, 578.7625, 598.9029, 683.8537, 570.8055,
        309.4315, 515.0802, 515.0802, 515.0802, 515.0802, 515.0802, 515.0802,
        515.0802, 515.0802, 515.0802, 515.0802, 515.0802, 515.0802, 850.1827,
        909.2383, 914.4691, 851.1219, 815.4674, 813.3628, 827.2566, 616.3096,
        837.5872, 761.0765, 757.9472, 749.3594, 757.9096, 784.4156, 771.4321,
        680.7717, 765.9099, 753.9905, 756.4164, 753.4019, 781.1862, 732.8557,
        772.2702, 247.8099], device='cuda:0')
sorted_norm is   tensor([247.8099, 309.4315, 515.0802, 515.0802, 515.0802, 515.0802, 515.0802,
        515.0802, 515.0802, 515.0802, 515.0802, 515.0802, 515.0802, 515.0802,
        570.8055, 578.7625, 598.9029, 616.3096, 669.4098, 680.7717, 683.8537,
        684.7142, 687.7175, 732.8557, 749.3594, 753.4019, 753.9905, 756.4164,
        757.9096, 757.9472, 761.0765, 765.9099, 771.4321, 772.2702, 781.1862,
        784.4156, 813.3628, 815.4674, 827.2566, 837.5872, 850.1827, 851.1219,
        909.2383, 914.4691], device='cuda:0')
used idx is  tensor([43,  7, 11, 10, 14, 19, 13, 18, 15, 12,  8,  9, 16, 17,  6,  3,  4, 27,
         0, 35,  5,  1,  2, 41, 31, 39, 37, 38, 32, 30, 29, 36, 34, 42, 40],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 89.48% 

Test Accuracy: 88.90% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6677981615066528
distance x is tensor(117.4964, device='cuda:0')
benign distance is  tensor(117.4964, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.620322585105896
distance x is tensor(133.8425, device='cuda:0')
benign distance is  tensor(133.8425, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4040032923221588
distance x is tensor(137.1703, device='cuda:0')
benign distance is  tensor(137.1703, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.49300122261047363
distance x is tensor(124.4608, device='cuda:0')
benign distance is  tensor(124.4608, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2925202250480652
distance x is tensor(116.5587, device='cuda:0')
benign distance is  tensor(116.5587, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.04666163772344589
distance x is tensor(127.7046, device='cuda:0')
benign distance is  tensor(127.7046, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.45848721265792847
distance x is tensor(123.0419, device='cuda:0')
benign distance is  tensor(123.0419, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.46253570914268494
distance x is tensor(56.3629, device='cuda:0')
benign distance is  tensor(56.3629, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.1334727704524994
distance x is tensor(153.7398, device='cuda:0')
benign distance is  tensor(153.7398, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6955881118774414
distance x is tensor(148.5265, device='cuda:0')
benign distance is  tensor(148.5265, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.1717173159122467
distance x is tensor(141.2697, device='cuda:0')
benign distance is  tensor(141.2697, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3703563213348389
distance x is tensor(158.0220, device='cuda:0')
benign distance is  tensor(158.0220, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.2536394000053406
distance x is tensor(158.8303, device='cuda:0')
benign distance is  tensor(158.8303, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.26046043634414673
distance x is tensor(157.2981, device='cuda:0')
benign distance is  tensor(157.2981, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3510494828224182
distance x is tensor(157.6979, device='cuda:0')
benign distance is  tensor(157.6979, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7133259773254395
distance x is tensor(88.1225, device='cuda:0')
benign distance is  tensor(88.1225, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.1489933431148529
distance x is tensor(155.9431, device='cuda:0')
benign distance is  tensor(155.9431, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6777445077896118
distance x is tensor(152.6356, device='cuda:0')
benign distance is  tensor(152.6356, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3622228801250458
distance x is tensor(176.2527, device='cuda:0')
benign distance is  tensor(176.2527, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.15543892979621887
distance x is tensor(163.9583, device='cuda:0')
benign distance is  tensor(163.9583, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6419755816459656
distance x is tensor(169.9563, device='cuda:0')
benign distance is  tensor(169.9563, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.3633202910423279
distance x is tensor(154.0591, device='cuda:0')
benign distance is  tensor(154.0591, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.09412278234958649
distance x is tensor(163.6992, device='cuda:0')
benign distance is  tensor(163.6992, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.4761330187320709
distance x is tensor(112.9681, device='cuda:0')
benign distance is  tensor(112.9681, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.2077617347240448
distance x is tensor(174.3993, device='cuda:0')
benign distance is  tensor(174.3993, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.03504940867424011
distance x is tensor(170.1999, device='cuda:0')
benign distance is  tensor(170.1999, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.27327290177345276
distance x is tensor(168.9512, device='cuda:0')
benign distance is  tensor(168.9512, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.178217351436615
distance x is tensor(161.0615, device='cuda:0')
benign distance is  tensor(161.0615, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.760569155216217
distance x is tensor(148.0686, device='cuda:0')
benign distance is  tensor(148.0686, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.666450023651123
distance x is tensor(153.0458, device='cuda:0')
benign distance is  tensor(153.0458, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.2970696985721588
distance x is tensor(145.6573, device='cuda:0')
benign distance is  tensor(145.6573, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7423559427261353
distance x is tensor(97.8410, device='cuda:0')
benign distance is  tensor(97.8410, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.4118680953979492
mal_entropy is 0.05661096051335335
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([503.6696, 570.7613, 581.2090, 535.7021, 489.4688, 551.5748, 497.6284,
        232.9695, 405.9698, 405.9698, 405.9698, 405.9698, 405.9698, 405.9698,
        405.9698, 405.9698, 405.9698, 405.9698, 405.9698, 405.9698],
       device='cuda:0')
sorted_norm is   tensor([232.9695, 405.9698, 405.9698, 405.9698, 405.9698, 405.9698, 405.9698,
        405.9698, 405.9698, 405.9698, 405.9698, 405.9698, 405.9698, 489.4688,
        497.6284, 503.6696, 535.7021, 551.5748, 570.7613, 581.2090],
       device='cuda:0')
used idx is  tensor([ 7, 19, 16, 18, 14, 12, 15, 17, 13, 10,  8,  9, 11,  4,  6,  0],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 89.05% 

Test Accuracy: 88.17% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.56952303647995
distance x is tensor(151.4088, device='cuda:0')
benign distance is  tensor(151.4088, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9430063366889954
distance x is tensor(147.1838, device='cuda:0')
benign distance is  tensor(147.1838, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.13569119572639465
distance x is tensor(146.5524, device='cuda:0')
benign distance is  tensor(146.5524, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8833640813827515
distance x is tensor(152.6282, device='cuda:0')
benign distance is  tensor(152.6282, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9079059362411499
distance x is tensor(141.7131, device='cuda:0')
benign distance is  tensor(141.7131, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5209923982620239
distance x is tensor(162.6650, device='cuda:0')
benign distance is  tensor(162.6650, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.22817043960094452
distance x is tensor(154.4791, device='cuda:0')
benign distance is  tensor(154.4791, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1449525356292725
distance x is tensor(88.4355, device='cuda:0')
benign distance is  tensor(88.4355, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.5946118831634521
mal_entropy is 0.09473234415054321
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([671.2765, 654.3982, 616.5107, 629.5164, 594.1055, 699.7905, 637.0552,
        378.7274, 378.7274, 378.7274, 378.7274, 378.7274, 378.7274, 378.7274,
        378.7274, 378.7274, 378.7274, 378.7274, 378.7274, 378.7274, 801.4437,
        820.5680, 802.3345, 801.5916, 765.0554, 783.2382, 799.9638, 523.4278,
        809.4086, 879.9310, 796.7279, 823.8431, 776.8522, 812.7662, 837.5637,
        494.3382, 715.1544, 702.1151, 691.5978, 741.1537, 733.9789, 743.7451,
        730.2907, 492.1318], device='cuda:0')
sorted_norm is   tensor([378.7274, 378.7274, 378.7274, 378.7274, 378.7274, 378.7274, 378.7274,
        378.7274, 378.7274, 378.7274, 378.7274, 378.7274, 378.7274, 492.1318,
        494.3382, 523.4278, 594.1055, 616.5107, 629.5164, 637.0552, 654.3982,
        671.2765, 691.5978, 699.7905, 702.1151, 715.1544, 730.2907, 733.9789,
        741.1537, 743.7451, 765.0554, 776.8522, 783.2382, 796.7279, 799.9638,
        801.4437, 801.5916, 802.3345, 809.4086, 812.7662, 820.5680, 823.8431,
        837.5637, 879.9310], device='cuda:0')
used idx is  tensor([11, 10,  8, 19, 13, 18, 16, 17, 15, 12, 14,  9,  7, 43, 35, 27,  4,  2,
         3,  6,  1,  0, 38,  5, 37, 36, 42, 40, 39, 41, 24, 32, 25, 30, 26],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 89.68% 

Test Accuracy: 88.94% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8149776458740234
distance x is tensor(134.4649, device='cuda:0')
benign distance is  tensor(134.4649, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.678820013999939
distance x is tensor(138.3134, device='cuda:0')
benign distance is  tensor(138.3134, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1919531673192978
distance x is tensor(144.5128, device='cuda:0')
benign distance is  tensor(144.5128, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.631699800491333
distance x is tensor(115.3429, device='cuda:0')
benign distance is  tensor(115.3429, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3485298752784729
distance x is tensor(109.2917, device='cuda:0')
benign distance is  tensor(109.2917, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6877764463424683
distance x is tensor(117.0411, device='cuda:0')
benign distance is  tensor(117.0411, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7070162892341614
distance x is tensor(98.2112, device='cuda:0')
benign distance is  tensor(98.2112, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.27835601568222046
distance x is tensor(71.3508, device='cuda:0')
benign distance is  tensor(71.3508, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2641224265098572
distance x is tensor(156.2448, device='cuda:0')
benign distance is  tensor(156.2448, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5506472587585449
distance x is tensor(151.6456, device='cuda:0')
benign distance is  tensor(151.6456, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6540812253952026
distance x is tensor(146.1275, device='cuda:0')
benign distance is  tensor(146.1275, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.43139544129371643
distance x is tensor(163.5814, device='cuda:0')
benign distance is  tensor(163.5814, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.492708683013916
distance x is tensor(154.0009, device='cuda:0')
benign distance is  tensor(154.0009, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.21866877377033234
distance x is tensor(143.5633, device='cuda:0')
benign distance is  tensor(143.5633, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.31631991267204285
distance x is tensor(151.9706, device='cuda:0')
benign distance is  tensor(151.9706, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.2516648769378662
distance x is tensor(85.8930, device='cuda:0')
benign distance is  tensor(85.8930, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.16975396871566772
distance x is tensor(162.7380, device='cuda:0')
benign distance is  tensor(162.7380, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8931088447570801
distance x is tensor(185.9788, device='cuda:0')
benign distance is  tensor(185.9788, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5826876163482666
distance x is tensor(148.3891, device='cuda:0')
benign distance is  tensor(148.3891, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.19955459237098694
distance x is tensor(158.8054, device='cuda:0')
benign distance is  tensor(158.8054, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3954312205314636
distance x is tensor(143.0654, device='cuda:0')
benign distance is  tensor(143.0654, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7954446077346802
distance x is tensor(153.9346, device='cuda:0')
benign distance is  tensor(153.9346, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.27080127596855164
distance x is tensor(159.9261, device='cuda:0')
benign distance is  tensor(159.9261, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5723857879638672
distance x is tensor(83.1028, device='cuda:0')
benign distance is  tensor(83.1028, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.2947661280632019
distance x is tensor(149.9721, device='cuda:0')
benign distance is  tensor(149.9721, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.22526803612709045
distance x is tensor(162.0091, device='cuda:0')
benign distance is  tensor(162.0091, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.14213867485523224
distance x is tensor(156.4472, device='cuda:0')
benign distance is  tensor(156.4472, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.3819323182106018
distance x is tensor(153.6495, device='cuda:0')
benign distance is  tensor(153.6495, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.31190815567970276
distance x is tensor(157.1899, device='cuda:0')
benign distance is  tensor(157.1899, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5474194884300232
distance x is tensor(167.2824, device='cuda:0')
benign distance is  tensor(167.2824, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8302139043807983
distance x is tensor(155.9500, device='cuda:0')
benign distance is  tensor(155.9500, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6452850103378296
distance x is tensor(88.4318, device='cuda:0')
benign distance is  tensor(88.4318, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.5273858308792114
mal_entropy is 0.08863172680139542
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([588.2266, 616.9801, 632.8321, 495.6295, 457.7104, 504.8582, 416.4450,
        300.8393, 382.6640, 382.6640, 382.6640, 382.6640, 382.6640, 382.6640,
        382.6640, 382.6640, 382.6640, 382.6640, 382.6640, 382.6640],
       device='cuda:0')
sorted_norm is   tensor([300.8393, 382.6640, 382.6640, 382.6640, 382.6640, 382.6640, 382.6640,
        382.6640, 382.6640, 382.6640, 382.6640, 382.6640, 382.6640, 416.4450,
        457.7104, 495.6295, 504.8582, 588.2266, 616.9801, 632.8321],
       device='cuda:0')
used idx is  tensor([ 7, 19, 16, 18, 14, 12, 15, 17, 13, 10,  8,  9, 11,  6,  4,  3],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 89.22% 

Test Accuracy: 88.56% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4334588944911957
distance x is tensor(146.1516, device='cuda:0')
benign distance is  tensor(146.1516, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.45954233407974243
distance x is tensor(178.3965, device='cuda:0')
benign distance is  tensor(178.3965, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.31605714559555054
distance x is tensor(155.5405, device='cuda:0')
benign distance is  tensor(155.5405, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5006088614463806
distance x is tensor(150.1989, device='cuda:0')
benign distance is  tensor(150.1989, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5019909739494324
distance x is tensor(140.2890, device='cuda:0')
benign distance is  tensor(140.2890, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.37025830149650574
distance x is tensor(174.2523, device='cuda:0')
benign distance is  tensor(174.2523, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4671149253845215
distance x is tensor(135.2346, device='cuda:0')
benign distance is  tensor(135.2346, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3970607817173004
distance x is tensor(100.7873, device='cuda:0')
benign distance is  tensor(100.7873, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.8924916386604309
mal_entropy is 0.11012064665555954
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([634.6259, 777.0961, 666.7274, 640.5701, 597.7961, 748.8121, 571.3541,
        423.7339, 423.7339, 423.7339, 423.7339, 423.7339, 423.7339, 423.7339,
        423.7339, 423.7339, 423.7339, 423.7339, 423.7339, 423.7339, 758.9338,
        746.5982, 834.6700, 781.0228, 809.8331, 759.5927, 798.4443, 611.4785,
        738.8097, 711.9446, 677.9721, 761.9945, 717.9437, 681.1052, 728.9794,
        461.6252], device='cuda:0')
sorted_norm is   tensor([423.7339, 423.7339, 423.7339, 423.7339, 423.7339, 423.7339, 423.7339,
        423.7339, 423.7339, 423.7339, 423.7339, 423.7339, 423.7339, 461.6252,
        571.3541, 597.7961, 611.4785, 634.6259, 640.5701, 666.7274, 677.9721,
        681.1052, 711.9446, 717.9437, 728.9794, 738.8097, 746.5982, 748.8121,
        758.9338, 759.5927, 761.9945, 777.0961, 781.0228, 798.4443, 809.8331,
        834.6700], device='cuda:0')
used idx is  tensor([11, 10,  8, 19, 13, 18, 16, 17, 15, 12, 14,  9,  7, 35,  6,  4, 27,  0,
         3,  2, 30, 33, 29, 32, 34, 28, 21,  5], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 89.58% 

Test Accuracy: 88.65% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9230263829231262
distance x is tensor(136.1780, device='cuda:0')
benign distance is  tensor(136.1780, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4743463397026062
distance x is tensor(132.7054, device='cuda:0')
benign distance is  tensor(132.7054, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5933769941329956
distance x is tensor(146.9219, device='cuda:0')
benign distance is  tensor(146.9219, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5528850555419922
distance x is tensor(147.6183, device='cuda:0')
benign distance is  tensor(147.6183, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3938114047050476
distance x is tensor(125.2204, device='cuda:0')
benign distance is  tensor(125.2204, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7781490683555603
distance x is tensor(135.6942, device='cuda:0')
benign distance is  tensor(135.6942, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.691060483455658
distance x is tensor(126.4095, device='cuda:0')
benign distance is  tensor(126.4095, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5043403506278992
distance x is tensor(51.1767, device='cuda:0')
benign distance is  tensor(51.1767, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.04405095428228378
distance x is tensor(169.0271, device='cuda:0')
benign distance is  tensor(169.0271, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.49278050661087036
distance x is tensor(168.3531, device='cuda:0')
benign distance is  tensor(168.3531, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5187525749206543
distance x is tensor(155.8901, device='cuda:0')
benign distance is  tensor(155.8901, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9278860092163086
distance x is tensor(154.4569, device='cuda:0')
benign distance is  tensor(154.4569, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7319871187210083
distance x is tensor(150.0160, device='cuda:0')
benign distance is  tensor(150.0160, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5533744692802429
distance x is tensor(163.4502, device='cuda:0')
benign distance is  tensor(163.4502, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.42365702986717224
distance x is tensor(147.1567, device='cuda:0')
benign distance is  tensor(147.1567, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4163714349269867
distance x is tensor(92.8150, device='cuda:0')
benign distance is  tensor(92.8150, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3214167058467865
distance x is tensor(175.1182, device='cuda:0')
benign distance is  tensor(175.1182, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.28247135877609253
distance x is tensor(164.8327, device='cuda:0')
benign distance is  tensor(164.8327, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.010582754388451576
distance x is tensor(175.8958, device='cuda:0')
benign distance is  tensor(175.8958, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.6193135380744934
distance x is tensor(157.9249, device='cuda:0')
benign distance is  tensor(157.9249, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7059451341629028
distance x is tensor(170.4570, device='cuda:0')
benign distance is  tensor(170.4570, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.40556520223617554
distance x is tensor(160.8560, device='cuda:0')
benign distance is  tensor(160.8560, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.41509294509887695
distance x is tensor(164.2602, device='cuda:0')
benign distance is  tensor(164.2602, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.2632954716682434
distance x is tensor(133.7064, device='cuda:0')
benign distance is  tensor(133.7064, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.24996884167194366
mal_entropy is 0.112296462059021
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([598.4550, 575.2770, 632.5327, 637.3656, 525.6522, 572.9120, 529.6068,
        217.9342, 581.7396, 581.7396, 581.7396, 581.7396, 581.7396, 581.7396,
        581.7396, 581.7396, 581.7396, 581.7396, 581.7396, 581.7396, 817.2174,
        793.6833, 790.8761, 765.1928, 732.5485, 724.0787, 703.4088, 425.5293,
        742.8972, 829.3967, 687.7261, 727.1052, 676.4493, 709.2042, 755.4221,
        441.4193], device='cuda:0')
sorted_norm is   tensor([217.9342, 425.5293, 441.4193, 525.6522, 529.6068, 572.9120, 575.2770,
        581.7396, 581.7396, 581.7396, 581.7396, 581.7396, 581.7396, 581.7396,
        581.7396, 581.7396, 581.7396, 581.7396, 581.7396, 598.4550, 632.5327,
        637.3656, 676.4493, 687.7261, 703.4088, 709.2042, 724.0787, 727.1052,
        732.5485, 742.8972, 755.4221, 765.1928, 790.8761, 793.6833, 817.2174,
        829.3967], device='cuda:0')
used idx is  tensor([ 7, 27, 35,  4,  6,  5,  1, 14,  8, 12, 15, 17, 19, 10, 16, 18, 13, 11,
         9,  0,  2,  3, 32, 30, 26, 33, 25, 31], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 89.31% 

Test Accuracy: 88.67% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.18737444281578064
distance x is tensor(129.7181, device='cuda:0')
benign distance is  tensor(129.7181, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6492538452148438
distance x is tensor(126.0657, device='cuda:0')
benign distance is  tensor(126.0657, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.028873298317193985
distance x is tensor(141.7750, device='cuda:0')
benign distance is  tensor(141.7750, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3072821795940399
distance x is tensor(126.5940, device='cuda:0')
benign distance is  tensor(126.5940, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3465954661369324
distance x is tensor(117.9944, device='cuda:0')
benign distance is  tensor(117.9944, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7515665292739868
distance x is tensor(147.6891, device='cuda:0')
benign distance is  tensor(147.6891, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.29792794585227966
distance x is tensor(107.9111, device='cuda:0')
benign distance is  tensor(107.9111, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9342912435531616
distance x is tensor(54.3341, device='cuda:0')
benign distance is  tensor(54.3341, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.0835413709282875
distance x is tensor(156.6153, device='cuda:0')
benign distance is  tensor(156.6153, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5031815767288208
distance x is tensor(178.7887, device='cuda:0')
benign distance is  tensor(178.7887, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4862731993198395
distance x is tensor(161.4404, device='cuda:0')
benign distance is  tensor(161.4404, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4629600942134857
distance x is tensor(163.5494, device='cuda:0')
benign distance is  tensor(163.5494, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.16026698052883148
distance x is tensor(153.7607, device='cuda:0')
benign distance is  tensor(153.7607, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4208858609199524
distance x is tensor(134.0466, device='cuda:0')
benign distance is  tensor(134.0466, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.502824604511261
distance x is tensor(175.2744, device='cuda:0')
benign distance is  tensor(175.2744, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6170268058776855
distance x is tensor(113.5491, device='cuda:0')
benign distance is  tensor(113.5491, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.35600748658180237
distance x is tensor(161.1095, device='cuda:0')
benign distance is  tensor(161.1095, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.11946140229701996
distance x is tensor(181.1200, device='cuda:0')
benign distance is  tensor(181.1200, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5287086963653564
distance x is tensor(171.4667, device='cuda:0')
benign distance is  tensor(171.4667, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.07149037718772888
distance x is tensor(158.6269, device='cuda:0')
benign distance is  tensor(158.6269, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.41831475496292114
distance x is tensor(165.5960, device='cuda:0')
benign distance is  tensor(165.5960, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.5725124478340149
distance x is tensor(146.5494, device='cuda:0')
benign distance is  tensor(146.5494, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.4048382639884949
distance x is tensor(150.7299, device='cuda:0')
benign distance is  tensor(150.7299, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.05253683775663376
distance x is tensor(94.6898, device='cuda:0')
benign distance is  tensor(94.6898, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.3374757170677185
mal_entropy is 0.05183655768632889
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([554.7533, 545.7002, 606.0535, 533.4724, 492.5350, 643.5658, 456.1169,
        233.7405, 397.2671, 397.2671, 397.2671, 397.2671, 397.2671, 397.2671,
        397.2671, 397.2671, 397.2671, 397.2671, 397.2671, 397.2671, 770.3646,
        761.3262, 716.3624, 715.0994, 708.1506, 738.4253, 687.3574, 476.0823],
       device='cuda:0')
sorted_norm is   tensor([233.7405, 397.2671, 397.2671, 397.2671, 397.2671, 397.2671, 397.2671,
        397.2671, 397.2671, 397.2671, 397.2671, 397.2671, 397.2671, 456.1169,
        476.0823, 492.5350, 533.4724, 545.7002, 554.7533, 606.0535, 643.5658,
        687.3574, 708.1506, 715.0994, 716.3624, 738.4253, 761.3262, 770.3646],
       device='cuda:0')
used idx is  tensor([ 7, 19, 16, 18, 14, 12, 15, 17, 13, 10,  8,  9, 11,  6, 27,  4,  3,  1,
         0,  2,  5, 26], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 89.53% 

Test Accuracy: 88.92% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2981828451156616
distance x is tensor(114.0141, device='cuda:0')
benign distance is  tensor(114.0141, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.44437527656555176
distance x is tensor(155.8560, device='cuda:0')
benign distance is  tensor(155.8560, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3754466772079468
distance x is tensor(163.7641, device='cuda:0')
benign distance is  tensor(163.7641, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9014226794242859
distance x is tensor(136.8402, device='cuda:0')
benign distance is  tensor(136.8402, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3969910740852356
distance x is tensor(106.9980, device='cuda:0')
benign distance is  tensor(106.9980, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9073764681816101
distance x is tensor(135.3802, device='cuda:0')
benign distance is  tensor(135.3802, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3168194591999054
distance x is tensor(131.9675, device='cuda:0')
benign distance is  tensor(131.9675, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.38703984022140503
distance x is tensor(61.3070, device='cuda:0')
benign distance is  tensor(61.3070, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.15453606843948364
distance x is tensor(166.6861, device='cuda:0')
benign distance is  tensor(166.6861, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.01819114200770855
distance x is tensor(173.6610, device='cuda:0')
benign distance is  tensor(173.6610, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3916546404361725
distance x is tensor(160.2663, device='cuda:0')
benign distance is  tensor(160.2663, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3580017685890198
distance x is tensor(178.4059, device='cuda:0')
benign distance is  tensor(178.4059, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.12296712398529053
distance x is tensor(172.0438, device='cuda:0')
benign distance is  tensor(172.0438, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3433874249458313
distance x is tensor(162.6014, device='cuda:0')
benign distance is  tensor(162.6014, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.18096767365932465
distance x is tensor(160.3246, device='cuda:0')
benign distance is  tensor(160.3246, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5796551704406738
distance x is tensor(105.2077, device='cuda:0')
benign distance is  tensor(105.2077, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.847503662109375
mal_entropy is 0.038862865418195724
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([489.4998, 677.4200, 700.2881, 598.9707, 458.2025, 577.1650, 561.5392,
        259.5249, 449.7959, 449.7959, 449.7959, 449.7959, 449.7959, 449.7959,
        449.7959, 449.7959, 449.7959, 449.7959, 449.7959, 449.7959],
       device='cuda:0')
sorted_norm is   tensor([259.5249, 449.7959, 449.7959, 449.7959, 449.7959, 449.7959, 449.7959,
        449.7959, 449.7959, 449.7959, 449.7959, 449.7959, 449.7959, 458.2025,
        489.4998, 561.5392, 577.1650, 598.9707, 677.4200, 700.2881],
       device='cuda:0')
used idx is  tensor([ 7, 19, 16, 18, 14, 12, 15, 17, 13, 10,  8,  9, 11,  4,  0,  6],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 89.04% 

Test Accuracy: 88.25% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.15424521267414093
distance x is tensor(159.8076, device='cuda:0')
benign distance is  tensor(159.8076, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4933083653450012
distance x is tensor(169.6218, device='cuda:0')
benign distance is  tensor(169.6218, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1459738165140152
distance x is tensor(170.1079, device='cuda:0')
benign distance is  tensor(170.1079, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5461998581886292
distance x is tensor(167.0048, device='cuda:0')
benign distance is  tensor(167.0048, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.23358674347400665
distance x is tensor(129.2759, device='cuda:0')
benign distance is  tensor(129.2759, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8426485061645508
distance x is tensor(173.4469, device='cuda:0')
benign distance is  tensor(173.4469, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.23547187447547913
distance x is tensor(142.1850, device='cuda:0')
benign distance is  tensor(142.1850, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3397296369075775
distance x is tensor(115.2716, device='cuda:0')
benign distance is  tensor(115.2716, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.3811083734035492
mal_entropy is 0.06169334053993225
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([677.6631, 739.4108, 732.2808, 717.8298, 557.1323, 748.9097, 597.2098,
        484.0787, 484.0787, 484.0787, 484.0787, 484.0787, 484.0787, 484.0787,
        484.0787, 484.0787, 484.0787, 484.0787, 484.0787, 484.0787, 803.9180,
        851.5416, 832.5704, 821.0581, 832.2530, 876.8647, 822.8091, 550.5324,
        872.2610, 829.3292, 875.2535, 802.7277, 853.2833, 809.6058, 844.9955,
        566.9541, 773.2733, 859.0565, 783.6159, 814.4926, 767.4479, 698.8599,
        868.5490, 604.4578, 788.9381, 807.0378, 762.3624, 806.7415, 812.8525,
        777.2772, 758.9658, 125.3258], device='cuda:0')
sorted_norm is   tensor([125.3258, 484.0787, 484.0787, 484.0787, 484.0787, 484.0787, 484.0787,
        484.0787, 484.0787, 484.0787, 484.0787, 484.0787, 484.0787, 484.0787,
        550.5324, 557.1323, 566.9541, 597.2098, 604.4578, 677.6631, 698.8599,
        717.8298, 732.2808, 739.4108, 748.9097, 758.9658, 762.3624, 767.4479,
        773.2733, 777.2772, 783.6159, 788.9381, 802.7277, 803.9180, 806.7415,
        807.0378, 809.6058, 812.8525, 814.4926, 821.0581, 822.8091, 829.3292,
        832.2530, 832.5704, 844.9955, 851.5416, 853.2833, 859.0565, 868.5490,
        872.2610, 875.2535, 876.8647], device='cuda:0')
used idx is  tensor([51, 19, 13, 17, 11,  9, 15,  7, 14, 12,  8, 18, 10, 16, 27,  4, 35,  6,
        43,  0, 41,  3,  2,  1,  5, 50, 46, 40, 36, 49, 38, 44, 31, 20, 47, 45,
        33, 48, 39, 23, 26], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 89.69% 

Test Accuracy: 88.84% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.39089351892471313
distance x is tensor(114.7109, device='cuda:0')
benign distance is  tensor(114.7109, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.48302164673805237
distance x is tensor(134.3441, device='cuda:0')
benign distance is  tensor(134.3441, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.31542229652404785
distance x is tensor(134.6721, device='cuda:0')
benign distance is  tensor(134.6721, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5666645765304565
distance x is tensor(109.4034, device='cuda:0')
benign distance is  tensor(109.4034, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4814768433570862
distance x is tensor(103.9757, device='cuda:0')
benign distance is  tensor(103.9757, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.205901861190796
distance x is tensor(132.8292, device='cuda:0')
benign distance is  tensor(132.8292, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.04779721051454544
distance x is tensor(117.6680, device='cuda:0')
benign distance is  tensor(117.6680, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.04673100635409355
distance x is tensor(27.8334, device='cuda:0')
benign distance is  tensor(27.8334, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.276025652885437
distance x is tensor(170.4926, device='cuda:0')
benign distance is  tensor(170.4926, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.350760281085968
distance x is tensor(165.4751, device='cuda:0')
benign distance is  tensor(165.4751, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4296662211418152
distance x is tensor(152.9209, device='cuda:0')
benign distance is  tensor(152.9209, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9037988781929016
distance x is tensor(163.8750, device='cuda:0')
benign distance is  tensor(163.8750, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7841264009475708
distance x is tensor(142.9261, device='cuda:0')
benign distance is  tensor(142.9261, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3513398766517639
distance x is tensor(155.2847, device='cuda:0')
benign distance is  tensor(155.2847, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.36231428384780884
distance x is tensor(159.9892, device='cuda:0')
benign distance is  tensor(159.9892, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.1276138722896576
distance x is tensor(62.3249, device='cuda:0')
benign distance is  tensor(62.3249, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.17464108765125275
distance x is tensor(157.2831, device='cuda:0')
benign distance is  tensor(157.2831, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.14449059963226318
distance x is tensor(182.1940, device='cuda:0')
benign distance is  tensor(182.1940, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.05940249562263489
distance x is tensor(146.9449, device='cuda:0')
benign distance is  tensor(146.9449, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2228696346282959
distance x is tensor(156.0604, device='cuda:0')
benign distance is  tensor(156.0604, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.15991000831127167
distance x is tensor(152.3110, device='cuda:0')
benign distance is  tensor(152.3110, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.45449399948120117
distance x is tensor(140.7561, device='cuda:0')
benign distance is  tensor(140.7561, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2566455900669098
distance x is tensor(184.8841, device='cuda:0')
benign distance is  tensor(184.8841, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.12204259634017944
distance x is tensor(92.4545, device='cuda:0')
benign distance is  tensor(92.4545, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.33488279581069946
distance x is tensor(178.3242, device='cuda:0')
benign distance is  tensor(178.3242, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.30083566904067993
distance x is tensor(148.8621, device='cuda:0')
benign distance is  tensor(148.8621, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.42341962456703186
distance x is tensor(165.1722, device='cuda:0')
benign distance is  tensor(165.1722, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.8486714363098145
distance x is tensor(161.1507, device='cuda:0')
benign distance is  tensor(161.1507, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.0705353021621704
distance x is tensor(162.8866, device='cuda:0')
benign distance is  tensor(162.8866, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.2864888608455658
distance x is tensor(156.3198, device='cuda:0')
benign distance is  tensor(156.3198, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.1567663848400116
distance x is tensor(147.9851, device='cuda:0')
benign distance is  tensor(147.9851, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.05955125764012337
distance x is tensor(95.0647, device='cuda:0')
benign distance is  tensor(95.0647, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.42202433943748474
distance x is tensor(162.9624, device='cuda:0')
benign distance is  tensor(162.9624, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.2911630868911743
distance x is tensor(153.7915, device='cuda:0')
benign distance is  tensor(153.7915, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.08650325983762741
distance x is tensor(144.0342, device='cuda:0')
benign distance is  tensor(144.0342, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.2983098030090332
distance x is tensor(173.3530, device='cuda:0')
benign distance is  tensor(173.3530, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.2641281187534332
distance x is tensor(160.9853, device='cuda:0')
benign distance is  tensor(160.9853, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5251609683036804
distance x is tensor(151.0974, device='cuda:0')
benign distance is  tensor(151.0974, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.2147324085235596
distance x is tensor(160.6082, device='cuda:0')
benign distance is  tensor(160.6082, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6315404176712036
distance x is tensor(73.4771, device='cuda:0')
benign distance is  tensor(73.4771, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.40182632207870483
mal_entropy is 0.03197415545582771
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([493.4240, 580.6292, 587.4678, 467.8774, 430.9605, 570.9403, 511.1932,
        116.8217, 322.6920, 322.6920, 322.6920, 322.6920, 322.6920, 322.6920,
        322.6920, 322.6920, 322.6920, 322.6920, 322.6920, 322.6920],
       device='cuda:0')
sorted_norm is   tensor([116.8217, 322.6920, 322.6920, 322.6920, 322.6920, 322.6920, 322.6920,
        322.6920, 322.6920, 322.6920, 322.6920, 322.6920, 322.6920, 430.9605,
        467.8774, 493.4240, 511.1932, 570.9403, 580.6292, 587.4678],
       device='cuda:0')
used idx is  tensor([ 7, 19, 16, 18, 14, 12, 15, 17, 13, 10,  8,  9, 11,  4,  3,  0],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 89.43% 

Test Accuracy: 88.88% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6551594138145447
distance x is tensor(147.9498, device='cuda:0')
benign distance is  tensor(147.9498, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7453493475914001
distance x is tensor(168.9769, device='cuda:0')
benign distance is  tensor(168.9769, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.07164794951677322
distance x is tensor(158.9488, device='cuda:0')
benign distance is  tensor(158.9488, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8265153765678406
distance x is tensor(154.0097, device='cuda:0')
benign distance is  tensor(154.0097, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.961839497089386
distance x is tensor(134.1284, device='cuda:0')
benign distance is  tensor(134.1284, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0318790674209595
distance x is tensor(158.3405, device='cuda:0')
benign distance is  tensor(158.3405, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.24711351096630096
distance x is tensor(142.5486, device='cuda:0')
benign distance is  tensor(142.5486, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1977742612361908
distance x is tensor(57.8774, device='cuda:0')
benign distance is  tensor(57.8774, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of [max] is  12
len of [0] is  12
params_mean torch.Size([215370])
params_stdev torch.Size([215370])
mal_param torch.Size([215370])
mal_acc is 1.0000000005
mal_loss is 0.08723938465118408
mal_entropy is 0.11030083894729614
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([633.8655, 741.9519, 677.7243, 654.5117, 564.2492, 696.0159, 611.1776,
        242.8734, 242.8734, 242.8734, 242.8734, 242.8734, 242.8734, 242.8734,
        242.8734, 242.8734, 242.8734, 242.8734, 242.8734, 242.8734, 763.2896,
        864.8833, 800.6639, 763.7956, 789.5623, 730.0248, 741.1763, 444.2076,
        763.5148, 752.1151, 708.9353, 750.3801, 655.4327, 707.4521, 728.3976,
        358.1547], device='cuda:0')
sorted_norm is   tensor([242.8734, 242.8734, 242.8734, 242.8734, 242.8734, 242.8734, 242.8734,
        242.8734, 242.8734, 242.8734, 242.8734, 242.8734, 242.8734, 358.1547,
        444.2076, 564.2492, 611.1776, 633.8655, 654.5117, 655.4327, 677.7243,
        696.0159, 707.4521, 708.9353, 728.3976, 730.0248, 741.1763, 741.9519,
        750.3801, 752.1151, 763.2896, 763.5148, 763.7956, 789.5623, 800.6639,
        864.8833], device='cuda:0')
used idx is  tensor([11, 10,  8, 19, 13, 18, 16, 17, 15, 12, 14,  9,  7, 35, 27,  4,  6,  0,
         3, 32,  2,  5, 33, 30, 34, 25, 26,  1], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 89.99% 

Test Accuracy: 89.04% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 89.99%
|----0th round Training Accuracy : 89.03%
|----1th round Training Accuracy : 88.42%
|----2th round Training Accuracy : 88.70%
|----3th round Training Accuracy : 89.10%
|----4th round Training Accuracy : 88.82%
|----5th round Training Accuracy : 89.20%
|----6th round Training Accuracy : 89.23%
|----7th round Training Accuracy : 89.36%
|----8th round Training Accuracy : 89.52%
|----9th round Training Accuracy : 89.69%
|----10th round Training Accuracy : 88.89%
|----11th round Training Accuracy : 89.79%
|----12th round Training Accuracy : 89.33%
|----13th round Training Accuracy : 89.48%
|----14th round Training Accuracy : 89.61%
|----15th round Training Accuracy : 89.81%
|----16th round Training Accuracy : 89.20%
|----17th round Training Accuracy : 89.85%
|----18th round Training Accuracy : 88.77%
|----19th round Training Accuracy : 89.82%
|----20th round Training Accuracy : 89.48%
|----21th round Training Accuracy : 89.34%
|----22th round Training Accuracy : 89.20%
|----23th round Training Accuracy : 89.78%
|----24th round Training Accuracy : 89.60%
|----25th round Training Accuracy : 89.51%
|----26th round Training Accuracy : 89.19%
|----27th round Training Accuracy : 89.07%
|----28th round Training Accuracy : 88.52%
|----29th round Training Accuracy : 89.72%
|----30th round Training Accuracy : 89.53%
|----31th round Training Accuracy : 89.58%
|----32th round Training Accuracy : 89.26%
|----33th round Training Accuracy : 89.16%
|----34th round Training Accuracy : 89.37%
|----35th round Training Accuracy : 89.66%
|----36th round Training Accuracy : 89.28%
|----37th round Training Accuracy : 89.34%
|----38th round Training Accuracy : 89.39%
|----39th round Training Accuracy : 89.48%
|----40th round Training Accuracy : 89.05%
|----41th round Training Accuracy : 89.68%
|----42th round Training Accuracy : 89.22%
|----43th round Training Accuracy : 89.58%
|----44th round Training Accuracy : 89.31%
|----45th round Training Accuracy : 89.53%
|----46th round Training Accuracy : 89.04%
|----47th round Training Accuracy : 89.69%
|----48th round Training Accuracy : 89.43%
|----49th round Training Accuracy : 89.99%
|----Final Test Accuracy: 89.04%
|----0th round Final Test Accuracy : 88.46%
|----1th round Final Test Accuracy : 87.70%
|----2th round Final Test Accuracy : 87.74%
|----3th round Final Test Accuracy : 88.58%
|----4th round Final Test Accuracy : 87.80%
|----5th round Final Test Accuracy : 88.72%
|----6th round Final Test Accuracy : 88.55%
|----7th round Final Test Accuracy : 88.36%
|----8th round Final Test Accuracy : 88.38%
|----9th round Final Test Accuracy : 88.88%
|----10th round Final Test Accuracy : 88.09%
|----11th round Final Test Accuracy : 88.95%
|----12th round Final Test Accuracy : 88.61%
|----13th round Final Test Accuracy : 88.57%
|----14th round Final Test Accuracy : 88.71%
|----15th round Final Test Accuracy : 88.70%
|----16th round Final Test Accuracy : 87.49%
|----17th round Final Test Accuracy : 88.85%
|----18th round Final Test Accuracy : 87.61%
|----19th round Final Test Accuracy : 88.67%
|----20th round Final Test Accuracy : 88.75%
|----21th round Final Test Accuracy : 88.70%
|----22th round Final Test Accuracy : 88.39%
|----23th round Final Test Accuracy : 89.03%
|----24th round Final Test Accuracy : 88.77%
|----25th round Final Test Accuracy : 88.69%
|----26th round Final Test Accuracy : 88.04%
|----27th round Final Test Accuracy : 88.60%
|----28th round Final Test Accuracy : 88.12%
|----29th round Final Test Accuracy : 89.08%
|----30th round Final Test Accuracy : 87.98%
|----31th round Final Test Accuracy : 88.78%
|----32th round Final Test Accuracy : 88.16%
|----33th round Final Test Accuracy : 88.24%
|----34th round Final Test Accuracy : 88.70%
|----35th round Final Test Accuracy : 88.59%
|----36th round Final Test Accuracy : 88.31%
|----37th round Final Test Accuracy : 88.29%
|----38th round Final Test Accuracy : 88.60%
|----39th round Final Test Accuracy : 88.90%
|----40th round Final Test Accuracy : 88.17%
|----41th round Final Test Accuracy : 88.94%
|----42th round Final Test Accuracy : 88.56%
|----43th round Final Test Accuracy : 88.65%
|----44th round Final Test Accuracy : 88.67%
|----45th round Final Test Accuracy : 88.92%
|----46th round Final Test Accuracy : 88.25%
|----47th round Final Test Accuracy : 88.84%
|----48th round Final Test Accuracy : 88.88%
|----49th round Final Test Accuracy : 89.04%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 3152.3570
