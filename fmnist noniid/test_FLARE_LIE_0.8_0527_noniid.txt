
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7607385329902172
distance x is tensor(122.3195, device='cuda:0')
benign distance is  tensor(122.3195, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8752363529056311
distance x is tensor(105.3810, device='cuda:0')
benign distance is  tensor(105.3810, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6474791448563337
distance x is tensor(109.8508, device='cuda:0')
benign distance is  tensor(109.8508, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9191537834703922
distance x is tensor(146.9539, device='cuda:0')
benign distance is  tensor(146.9539, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8522382006049156
distance x is tensor(99.3590, device='cuda:0')
benign distance is  tensor(99.3590, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.690344410482794
distance x is tensor(93.4158, device='cuda:0')
benign distance is  tensor(93.4158, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1639627702534199
distance x is tensor(119.0202, device='cuda:0')
benign distance is  tensor(119.0202, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6778815798461437
distance x is tensor(89.7715, device='cuda:0')
benign distance is  tensor(89.7715, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8351453430950642
distance x is tensor(113.6688, device='cuda:0')
benign distance is  tensor(113.6688, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6609218050725758
distance x is tensor(125.5023, device='cuda:0')
benign distance is  tensor(125.5023, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0292813181877136
distance x is tensor(97.0105, device='cuda:0')
benign distance is  tensor(97.0105, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.380191631615162
distance x is tensor(122.3450, device='cuda:0')
benign distance is  tensor(122.3450, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2490528374910355
distance x is tensor(165.9314, device='cuda:0')
benign distance is  tensor(165.9314, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6318534854799509
distance x is tensor(66.9024, device='cuda:0')
benign distance is  tensor(66.9024, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1006745789200068
distance x is tensor(145.8454, device='cuda:0')
benign distance is  tensor(145.8454, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2534727714955807
distance x is tensor(127.6258, device='cuda:0')
benign distance is  tensor(127.6258, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.3094039745628834
distance x is tensor(117.2100, device='cuda:0')
benign distance is  tensor(117.2100, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6475699692964554
distance x is tensor(113.7883, device='cuda:0')
benign distance is  tensor(113.7883, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.0191738121211529
distance x is tensor(119.8758, device='cuda:0')
benign distance is  tensor(119.8758, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7756940945982933
distance x is tensor(123.1022, device='cuda:0')
benign distance is  tensor(123.1022, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0018130652606487
distance x is tensor(85.9289, device='cuda:0')
benign distance is  tensor(85.9289, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6807665582746267
distance x is tensor(210.9039, device='cuda:0')
benign distance is  tensor(210.9039, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0181093327701092
distance x is tensor(158.5716, device='cuda:0')
benign distance is  tensor(158.5716, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6543965246528387
distance x is tensor(112.4749, device='cuda:0')
benign distance is  tensor(112.4749, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.8007790837436914
distance x is tensor(122.6103, device='cuda:0')
benign distance is  tensor(122.6103, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5645520370453596
distance x is tensor(77.7631, device='cuda:0')
benign distance is  tensor(77.7631, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.1254860311746597
distance x is tensor(143.1199, device='cuda:0')
benign distance is  tensor(143.1199, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2068528980016708
distance x is tensor(115.7431, device='cuda:0')
benign distance is  tensor(115.7431, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6598384156823158
distance x is tensor(123.7336, device='cuda:0')
benign distance is  tensor(123.7336, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8958931751549244
distance x is tensor(129.2455, device='cuda:0')
benign distance is  tensor(129.2455, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5120122916996479
distance x is tensor(110.4781, device='cuda:0')
benign distance is  tensor(110.4781, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6909896302968264
distance x is tensor(166.0005, device='cuda:0')
benign distance is  tensor(166.0005, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8493974506855011
distance x is tensor(114.3746, device='cuda:0')
benign distance is  tensor(114.3746, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.7409199457615614
distance x is tensor(106.1623, device='cuda:0')
benign distance is  tensor(106.1623, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5861050086095929
distance x is tensor(145.7862, device='cuda:0')
benign distance is  tensor(145.7862, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.2290546335279942
distance x is tensor(128.3185, device='cuda:0')
benign distance is  tensor(128.3185, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9072059877216816
distance x is tensor(114.1038, device='cuda:0')
benign distance is  tensor(114.1038, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8825149731710553
distance x is tensor(81.2380, device='cuda:0')
benign distance is  tensor(81.2380, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7643794491887093
distance x is tensor(101.3543, device='cuda:0')
benign distance is  tensor(101.3543, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8607244975864887
distance x is tensor(117.7701, device='cuda:0')
benign distance is  tensor(117.7701, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.255957454442978
distance x is tensor(115.0870, device='cuda:0')
benign distance is  tensor(115.0870, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.2239245623350143
distance x is tensor(143.3252, device='cuda:0')
benign distance is  tensor(143.3252, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.1254240851849318
distance x is tensor(138.0489, device='cuda:0')
benign distance is  tensor(138.0489, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.8140377812087536
distance x is tensor(99.0140, device='cuda:0')
benign distance is  tensor(99.0140, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5842249616980553
distance x is tensor(153.2599, device='cuda:0')
benign distance is  tensor(153.2599, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7153590470552444
distance x is tensor(135.2759, device='cuda:0')
benign distance is  tensor(135.2759, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7253030929714441
distance x is tensor(105.1265, device='cuda:0')
benign distance is  tensor(105.1265, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6054580453783274
distance x is tensor(127.4827, device='cuda:0')
benign distance is  tensor(127.4827, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.85000000016
mal_loss is 0.5295448983088136
mal_entropy is 0.2495958423241973
user_PLR len size 20
counter_tensor is  tensor([17., 17., 16., 15., 17., 15., 16., 16., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([0.0041, 0.0041, 0.0015, 0.0006, 0.0041, 0.0006, 0.0015, 0.0015, 0.0818,
        0.0818, 0.0818, 0.0818, 0.0818, 0.0818, 0.0818, 0.0818, 0.0818, 0.0818,
        0.0818, 0.0818])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 95.84% 

Test Accuracy: 85.73% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7169558797031641
distance x is tensor(130.6728, device='cuda:0')
benign distance is  tensor(130.6728, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7091331649571657
distance x is tensor(121.7312, device='cuda:0')
benign distance is  tensor(121.7312, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6993546895682812
distance x is tensor(124.9195, device='cuda:0')
benign distance is  tensor(124.9195, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8863559924066067
distance x is tensor(157.7035, device='cuda:0')
benign distance is  tensor(157.7035, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0011903457343578
distance x is tensor(108.8643, device='cuda:0')
benign distance is  tensor(108.8643, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.782456218264997
distance x is tensor(113.7228, device='cuda:0')
benign distance is  tensor(113.7228, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8681834116578102
distance x is tensor(128.5014, device='cuda:0')
benign distance is  tensor(128.5014, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6093923356384039
distance x is tensor(102.4858, device='cuda:0')
benign distance is  tensor(102.4858, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.60200000016
mal_loss is 2.9346665292978287
mal_entropy is 0.2687932187691331
user_PLR len size 28
counter_tensor is  tensor([12., 18.,  0., 12., 27., 26., 21., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 27., 27., 12., 27., 25., 18., 23.])
count_res tensor([5.5372e-08, 2.2339e-05, 3.4022e-13, 5.5372e-08, 1.8101e-01, 6.6591e-02,
        4.4869e-04, 5.5372e-08, 3.0232e-06, 3.0232e-06, 3.0232e-06, 3.0232e-06,
        3.0232e-06, 3.0232e-06, 3.0232e-06, 3.0232e-06, 3.0232e-06, 3.0232e-06,
        3.0232e-06, 3.0232e-06, 1.8101e-01, 1.8101e-01, 1.8101e-01, 5.5372e-08,
        1.8101e-01, 2.4497e-02, 2.2339e-05, 3.3154e-03])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 91.35% 

Test Accuracy: 87.01% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6899574212729931
distance x is tensor(126.9159, device='cuda:0')
benign distance is  tensor(126.9159, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9511366840451956
distance x is tensor(104.0776, device='cuda:0')
benign distance is  tensor(104.0776, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6641941787675023
distance x is tensor(114.1437, device='cuda:0')
benign distance is  tensor(114.1437, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9147792644798756
distance x is tensor(154.4113, device='cuda:0')
benign distance is  tensor(154.4113, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8921241359785199
distance x is tensor(72.2515, device='cuda:0')
benign distance is  tensor(72.2515, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6952200774103403
distance x is tensor(102.4183, device='cuda:0')
benign distance is  tensor(102.4183, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1886141914874315
distance x is tensor(109.1352, device='cuda:0')
benign distance is  tensor(109.1352, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.623537864536047
distance x is tensor(89.4930, device='cuda:0')
benign distance is  tensor(89.4930, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0403452664613724
distance x is tensor(112.1438, device='cuda:0')
benign distance is  tensor(112.1438, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6379680773243308
distance x is tensor(120.8701, device='cuda:0')
benign distance is  tensor(120.8701, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1132538951933384
distance x is tensor(68.8486, device='cuda:0')
benign distance is  tensor(68.8486, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3987916260957718
distance x is tensor(130.0934, device='cuda:0')
benign distance is  tensor(130.0934, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9573995117098093
distance x is tensor(161.7649, device='cuda:0')
benign distance is  tensor(161.7649, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7161530293524265
distance x is tensor(62.9097, device='cuda:0')
benign distance is  tensor(62.9097, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8684579618275166
distance x is tensor(146.0835, device='cuda:0')
benign distance is  tensor(146.0835, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.8252903148531914
distance x is tensor(130.0919, device='cuda:0')
benign distance is  tensor(130.0919, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.81300000016
mal_loss is 0.6736850086599588
mal_entropy is 0.24615544080734253
user_PLR len size 28
counter_tensor is  tensor([21., 22., 27., 19.,  4., 17., 18., 19., 13., 13., 13., 13., 13., 13.,
        13., 13., 13., 13., 13., 13., 26., 18., 26., 27., 25., 25., 27., 27.])
count_res tensor([4.9411e-04, 1.3431e-03, 1.9934e-01, 6.6870e-05, 2.0456e-11, 9.0499e-06,
        2.4600e-05, 6.6870e-05, 1.6575e-07, 1.6575e-07, 1.6575e-07, 1.6575e-07,
        1.6575e-07, 1.6575e-07, 1.6575e-07, 1.6575e-07, 1.6575e-07, 1.6575e-07,
        1.6575e-07, 1.6575e-07, 7.3332e-02, 2.4600e-05, 7.3332e-02, 1.9934e-01,
        2.6977e-02, 2.6977e-02, 1.9934e-01, 1.9934e-01])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 90.37% 

Test Accuracy: 86.85% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6836293647065759
distance x is tensor(125.1836, device='cuda:0')
benign distance is  tensor(125.1836, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9222157374024391
distance x is tensor(107.9585, device='cuda:0')
benign distance is  tensor(107.9585, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6959503330290318
distance x is tensor(98.4462, device='cuda:0')
benign distance is  tensor(98.4462, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8377309031784534
distance x is tensor(137.6994, device='cuda:0')
benign distance is  tensor(137.6994, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8894408326596022
distance x is tensor(87.7080, device='cuda:0')
benign distance is  tensor(87.7080, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7871808391064405
distance x is tensor(110.9018, device='cuda:0')
benign distance is  tensor(110.9018, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1765748858451843
distance x is tensor(111.4054, device='cuda:0')
benign distance is  tensor(111.4054, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5347557757049799
distance x is tensor(92.1443, device='cuda:0')
benign distance is  tensor(92.1443, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1566739864647388
distance x is tensor(93.1047, device='cuda:0')
benign distance is  tensor(93.1047, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6748733371496201
distance x is tensor(119.9110, device='cuda:0')
benign distance is  tensor(119.9110, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8737841285765171
distance x is tensor(114.5608, device='cuda:0')
benign distance is  tensor(114.5608, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7811744883656502
distance x is tensor(108.9747, device='cuda:0')
benign distance is  tensor(108.9747, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9473177436739206
distance x is tensor(73.7992, device='cuda:0')
benign distance is  tensor(73.7992, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9405425507575274
distance x is tensor(209.3292, device='cuda:0')
benign distance is  tensor(209.3292, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.2627874426543713
distance x is tensor(137.1886, device='cuda:0')
benign distance is  tensor(137.1886, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.9045808538794518
distance x is tensor(105.0658, device='cuda:0')
benign distance is  tensor(105.0658, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.83500000016
mal_loss is 0.5669613927602768
mal_entropy is 0.2200604360550642
user_PLR len size 36
counter_tensor is  tensor([13., 14., 10.,  2., 16., 14., 20.,  2., 23., 23., 23., 23., 23., 23.,
        23., 23., 23., 23., 23., 23., 35., 31., 35., 13.,  0., 14., 26., 34.,
        12., 33., 25., 15., 12., 14., 14., 14.])
count_res tensor([1.1062e-10, 3.0068e-10, 5.5072e-12, 1.8475e-15, 2.2218e-09, 3.0068e-10,
        1.2130e-07, 1.8475e-15, 2.4365e-06, 2.4365e-06, 2.4365e-06, 2.4365e-06,
        2.4365e-06, 2.4365e-06, 2.4365e-06, 2.4365e-06, 2.4365e-06, 2.4365e-06,
        2.4365e-06, 2.4365e-06, 3.9655e-01, 7.2630e-03, 3.9655e-01, 1.1062e-10,
        2.5003e-16, 3.0068e-10, 4.8938e-05, 1.4588e-01, 4.0693e-11, 5.3667e-02,
        1.8003e-05, 8.1734e-10, 4.0693e-11, 3.0068e-10, 3.0068e-10, 3.0068e-10])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 88.92% 

Test Accuracy: 85.23% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5957806594669819
distance x is tensor(116.1771, device='cuda:0')
benign distance is  tensor(116.1771, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6908096298575401
distance x is tensor(111.5775, device='cuda:0')
benign distance is  tensor(111.5775, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7440524715930223
distance x is tensor(119.4140, device='cuda:0')
benign distance is  tensor(119.4140, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.223693560808897
distance x is tensor(148.2943, device='cuda:0')
benign distance is  tensor(148.2943, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8330085221678019
distance x is tensor(104.4070, device='cuda:0')
benign distance is  tensor(104.4070, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7439389433711767
distance x is tensor(104.9596, device='cuda:0')
benign distance is  tensor(104.9596, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0817176597192883
distance x is tensor(95.0833, device='cuda:0')
benign distance is  tensor(95.0833, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6968350214883685
distance x is tensor(88.4553, device='cuda:0')
benign distance is  tensor(88.4553, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0925691407173872
distance x is tensor(113.9849, device='cuda:0')
benign distance is  tensor(113.9849, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6138077082578093
distance x is tensor(115.1489, device='cuda:0')
benign distance is  tensor(115.1489, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0616271682083607
distance x is tensor(80.2066, device='cuda:0')
benign distance is  tensor(80.2066, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.6371608786284924
distance x is tensor(119.5736, device='cuda:0')
benign distance is  tensor(119.5736, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9960293807089329
distance x is tensor(164.8054, device='cuda:0')
benign distance is  tensor(164.8054, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.698550502769649
distance x is tensor(64.1272, device='cuda:0')
benign distance is  tensor(64.1272, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7601999612525105
distance x is tensor(148.1669, device='cuda:0')
benign distance is  tensor(148.1669, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.635585993528366
distance x is tensor(126.2484, device='cuda:0')
benign distance is  tensor(126.2484, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.15235978923738
distance x is tensor(90.8555, device='cuda:0')
benign distance is  tensor(90.8555, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5895752590149641
distance x is tensor(88.6493, device='cuda:0')
benign distance is  tensor(88.6493, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9283085688948631
distance x is tensor(103.5566, device='cuda:0')
benign distance is  tensor(103.5566, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2830216400325298
distance x is tensor(113.6337, device='cuda:0')
benign distance is  tensor(113.6337, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7213096991181374
distance x is tensor(124.1022, device='cuda:0')
benign distance is  tensor(124.1022, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8599493559449911
distance x is tensor(116.2835, device='cuda:0')
benign distance is  tensor(116.2835, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5365368938073516
distance x is tensor(120.0444, device='cuda:0')
benign distance is  tensor(120.0444, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7897693421691656
distance x is tensor(175.2937, device='cuda:0')
benign distance is  tensor(175.2937, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.77200000016
mal_loss is 1.0666627995669842
mal_entropy is 0.24785351660102606
user_PLR len size 28
counter_tensor is  tensor([12., 12., 13., 12., 12.,  0., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 26., 27., 12., 27., 13., 12., 19.])
count_res tensor([1.2916e-07, 1.2916e-07, 3.5109e-07, 1.2916e-07, 1.2916e-07, 7.9358e-13,
        1.2916e-07, 1.2916e-07, 7.0518e-06, 7.0518e-06, 7.0518e-06, 7.0518e-06,
        7.0518e-06, 7.0518e-06, 7.0518e-06, 7.0518e-06, 7.0518e-06, 7.0518e-06,
        7.0518e-06, 7.0518e-06, 1.2916e-07, 1.5533e-01, 4.2222e-01, 1.2916e-07,
        4.2222e-01, 3.5109e-07, 1.2916e-07, 1.4164e-04])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 94.10% 

Test Accuracy: 86.05% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7885676436126232
distance x is tensor(127.2703, device='cuda:0')
benign distance is  tensor(127.2703, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.901441877707839
distance x is tensor(116.6060, device='cuda:0')
benign distance is  tensor(116.6060, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7380260657519102
distance x is tensor(109.1735, device='cuda:0')
benign distance is  tensor(109.1735, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9898457862436771
distance x is tensor(163.0705, device='cuda:0')
benign distance is  tensor(163.0705, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8449019491672516
distance x is tensor(92.4801, device='cuda:0')
benign distance is  tensor(92.4801, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6307375123724341
distance x is tensor(114.7338, device='cuda:0')
benign distance is  tensor(114.7338, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0172539539635181
distance x is tensor(111.8172, device='cuda:0')
benign distance is  tensor(111.8172, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.631919015198946
distance x is tensor(99.7755, device='cuda:0')
benign distance is  tensor(99.7755, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8530681356787682
distance x is tensor(128.8488, device='cuda:0')
benign distance is  tensor(128.8488, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.146584015339613
distance x is tensor(93.2245, device='cuda:0')
benign distance is  tensor(93.2245, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5552824772894382
distance x is tensor(141.0017, device='cuda:0')
benign distance is  tensor(141.0017, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.2186592780053616
distance x is tensor(129.8504, device='cuda:0')
benign distance is  tensor(129.8504, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8038695557042956
distance x is tensor(77.7609, device='cuda:0')
benign distance is  tensor(77.7609, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7643509935587645
distance x is tensor(96.5531, device='cuda:0')
benign distance is  tensor(96.5531, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.788390202447772
distance x is tensor(102.0870, device='cuda:0')
benign distance is  tensor(102.0870, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9545508921146393
distance x is tensor(124.3367, device='cuda:0')
benign distance is  tensor(124.3367, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.78200000016
mal_loss is 0.7651564106345177
mal_entropy is 0.2640532059594989
user_PLR len size 44
counter_tensor is  tensor([13., 13., 17., 30.,  0., 17.,  0.,  0., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 33., 12., 22., 43., 12., 42.,  0.,  0.,
        12., 25., 41., 43., 28., 17., 42., 43., 13., 12., 19., 12., 43., 12.,
         0., 12.])
count_res tensor([1.9210e-14, 1.9210e-14, 1.0488e-12, 4.6401e-07, 4.3420e-20, 1.0488e-12,
        4.3420e-20, 4.3420e-20, 3.4286e-06, 3.4286e-06, 3.4286e-06, 3.4286e-06,
        3.4286e-06, 3.4286e-06, 3.4286e-06, 3.4286e-06, 3.4286e-06, 3.4286e-06,
        3.4286e-06, 3.4286e-06, 9.3198e-06, 7.0668e-15, 1.5566e-10, 2.0528e-01,
        7.0668e-15, 7.5519e-02, 4.3420e-20, 4.3420e-20, 7.0668e-15, 3.1264e-09,
        2.7782e-02, 2.0528e-01, 6.2796e-08, 1.0488e-12, 7.5519e-02, 2.0528e-01,
        1.9210e-14, 7.0668e-15, 7.7497e-12, 7.0668e-15, 2.0528e-01, 7.0668e-15,
        4.3420e-20, 7.0668e-15])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 89.06% 

Test Accuracy: 85.46% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7160593047738075
distance x is tensor(113.0742, device='cuda:0')
benign distance is  tensor(113.0742, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8328348882496357
distance x is tensor(102.8321, device='cuda:0')
benign distance is  tensor(102.8321, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7392780762165785
distance x is tensor(105.3747, device='cuda:0')
benign distance is  tensor(105.3747, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8617556933313608
distance x is tensor(148.9474, device='cuda:0')
benign distance is  tensor(148.9474, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9668341483920813
distance x is tensor(85.2087, device='cuda:0')
benign distance is  tensor(85.2087, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6228610398247838
distance x is tensor(95.7486, device='cuda:0')
benign distance is  tensor(95.7486, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1459689177572727
distance x is tensor(101.4569, device='cuda:0')
benign distance is  tensor(101.4569, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6691481489688158
distance x is tensor(97.4456, device='cuda:0')
benign distance is  tensor(97.4456, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8297492358833551
distance x is tensor(104.4916, device='cuda:0')
benign distance is  tensor(104.4916, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5719073247164488
distance x is tensor(122.7618, device='cuda:0')
benign distance is  tensor(122.7618, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8446416314691305
distance x is tensor(79.5778, device='cuda:0')
benign distance is  tensor(79.5778, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3079117946326733
distance x is tensor(113.7809, device='cuda:0')
benign distance is  tensor(113.7809, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7894183192402124
distance x is tensor(156.4302, device='cuda:0')
benign distance is  tensor(156.4302, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6691770721226931
distance x is tensor(72.0343, device='cuda:0')
benign distance is  tensor(72.0343, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8177889958024025
distance x is tensor(149.3747, device='cuda:0')
benign distance is  tensor(149.3747, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0909044295549393
distance x is tensor(122.0607, device='cuda:0')
benign distance is  tensor(122.0607, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.9911394286900759
distance x is tensor(88.4865, device='cuda:0')
benign distance is  tensor(88.4865, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7359213922172785
distance x is tensor(121.8129, device='cuda:0')
benign distance is  tensor(121.8129, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8148152362555265
distance x is tensor(112.5127, device='cuda:0')
benign distance is  tensor(112.5127, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8097920343279839
distance x is tensor(99.3570, device='cuda:0')
benign distance is  tensor(99.3570, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9140180889517069
distance x is tensor(81.5814, device='cuda:0')
benign distance is  tensor(81.5814, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6954300608485937
distance x is tensor(198.4666, device='cuda:0')
benign distance is  tensor(198.4666, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.129824049770832
distance x is tensor(145.7312, device='cuda:0')
benign distance is  tensor(145.7312, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6710086800158024
distance x is tensor(89.7261, device='cuda:0')
benign distance is  tensor(89.7261, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.2349181771278381
distance x is tensor(108.7933, device='cuda:0')
benign distance is  tensor(108.7933, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.1100880689918995
distance x is tensor(153.7731, device='cuda:0')
benign distance is  tensor(153.7731, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.1771500781178474
distance x is tensor(142.7184, device='cuda:0')
benign distance is  tensor(142.7184, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.1420443132519722
distance x is tensor(76.4065, device='cuda:0')
benign distance is  tensor(76.4065, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6038972269743681
distance x is tensor(151.3667, device='cuda:0')
benign distance is  tensor(151.3667, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7669374383985996
distance x is tensor(123.9962, device='cuda:0')
benign distance is  tensor(123.9962, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7555550578981638
distance x is tensor(99.8111, device='cuda:0')
benign distance is  tensor(99.8111, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5726936338469386
distance x is tensor(119.4044, device='cuda:0')
benign distance is  tensor(119.4044, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.77900000016
mal_loss is 0.8055819440633059
mal_entropy is 0.27745546028018
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 88.35% 

Test Accuracy: 78.28% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6757257021963596
distance x is tensor(135.5809, device='cuda:0')
benign distance is  tensor(135.5809, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7596540907397866
distance x is tensor(121.2846, device='cuda:0')
benign distance is  tensor(121.2846, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.758899861946702
distance x is tensor(115.4793, device='cuda:0')
benign distance is  tensor(115.4793, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8206278327852488
distance x is tensor(157.6509, device='cuda:0')
benign distance is  tensor(157.6509, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9299757648259401
distance x is tensor(114.3918, device='cuda:0')
benign distance is  tensor(114.3918, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7093761842697859
distance x is tensor(117.2328, device='cuda:0')
benign distance is  tensor(117.2328, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3059831820428371
distance x is tensor(121.1954, device='cuda:0')
benign distance is  tensor(121.1954, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7463384661823511
distance x is tensor(110.3039, device='cuda:0')
benign distance is  tensor(110.3039, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.52300000016
mal_loss is 4.45569309592247
mal_entropy is 0.20644752401858568
user_PLR len size 36
counter_tensor is  tensor([ 8., 28., 24.,  0.,  6., 22.,  0., 35., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20., 26., 30., 33., 33., 35., 34., 16., 32.,
         0., 35., 28., 30., 20., 35., 22., 31.])
count_res tensor([3.9803e-13, 1.9311e-04, 3.5369e-06, 1.3352e-16, 5.3867e-14, 4.7867e-07,
        1.3352e-16, 2.1177e-01, 6.4781e-08, 6.4781e-08, 6.4781e-08, 6.4781e-08,
        6.4781e-08, 6.4781e-08, 6.4781e-08, 6.4781e-08, 6.4781e-08, 6.4781e-08,
        6.4781e-08, 6.4781e-08, 2.6135e-05, 1.4269e-03, 2.8660e-02, 2.8660e-02,
        2.1177e-01, 7.7906e-02, 1.1865e-09, 1.0543e-02, 1.3352e-16, 2.1177e-01,
        1.9311e-04, 1.4269e-03, 6.4781e-08, 2.1177e-01, 4.7867e-07, 3.8787e-03])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 88.43% 

Test Accuracy: 86.94% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6688562296330929
distance x is tensor(120.5505, device='cuda:0')
benign distance is  tensor(120.5505, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8988432921469212
distance x is tensor(107.6382, device='cuda:0')
benign distance is  tensor(107.6382, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7842274457216263
distance x is tensor(105.5554, device='cuda:0')
benign distance is  tensor(105.5554, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0562529359012842
distance x is tensor(159.8686, device='cuda:0')
benign distance is  tensor(159.8686, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0929427966475487
distance x is tensor(87.2591, device='cuda:0')
benign distance is  tensor(87.2591, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5960292974486947
distance x is tensor(103.4640, device='cuda:0')
benign distance is  tensor(103.4640, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1978133376687765
distance x is tensor(110.3992, device='cuda:0')
benign distance is  tensor(110.3992, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.627416018396616
distance x is tensor(79.0026, device='cuda:0')
benign distance is  tensor(79.0026, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8908590897917747
distance x is tensor(102.9102, device='cuda:0')
benign distance is  tensor(102.9102, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7701271623373032
distance x is tensor(99.4276, device='cuda:0')
benign distance is  tensor(99.4276, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9475093819200993
distance x is tensor(79.2451, device='cuda:0')
benign distance is  tensor(79.2451, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3465394265949726
distance x is tensor(112.0786, device='cuda:0')
benign distance is  tensor(112.0786, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8057927098125219
distance x is tensor(162.1357, device='cuda:0')
benign distance is  tensor(162.1357, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6929734917357564
distance x is tensor(51.7236, device='cuda:0')
benign distance is  tensor(51.7236, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7910722941160202
distance x is tensor(140.7099, device='cuda:0')
benign distance is  tensor(140.7099, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2786170542240143
distance x is tensor(118.0295, device='cuda:0')
benign distance is  tensor(118.0295, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9689220283180475
distance x is tensor(105.2087, device='cuda:0')
benign distance is  tensor(105.2087, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9094723798334599
distance x is tensor(84.8906, device='cuda:0')
benign distance is  tensor(84.8906, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8685600822791457
distance x is tensor(118.3707, device='cuda:0')
benign distance is  tensor(118.3707, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.3102174177765846
distance x is tensor(127.6998, device='cuda:0')
benign distance is  tensor(127.6998, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8198815658688545
distance x is tensor(115.8212, device='cuda:0')
benign distance is  tensor(115.8212, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.82574946526438
distance x is tensor(103.5973, device='cuda:0')
benign distance is  tensor(103.5973, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5058455504477024
distance x is tensor(110.0148, device='cuda:0')
benign distance is  tensor(110.0148, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.851729542016983
distance x is tensor(169.5775, device='cuda:0')
benign distance is  tensor(169.5775, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8100000001600001
mal_loss is 0.7001798059791327
mal_entropy is 0.27749247662723064
user_PLR len size 28
counter_tensor is  tensor([17., 25.,  3., 19., 18., 13., 13., 13., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 13., 17., 27., 18., 14., 25., 25., 26.])
count_res tensor([2.5581e-05, 7.6255e-02, 2.1271e-11, 1.8902e-04, 6.9536e-05, 4.6853e-07,
        4.6853e-07, 4.6853e-07, 9.4107e-06, 9.4107e-06, 9.4107e-06, 9.4107e-06,
        9.4107e-06, 9.4107e-06, 9.4107e-06, 9.4107e-06, 9.4107e-06, 9.4107e-06,
        9.4107e-06, 9.4107e-06, 4.6853e-07, 2.5581e-05, 5.6346e-01, 6.9536e-05,
        1.2736e-06, 7.6255e-02, 7.6255e-02, 2.0728e-01])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 81.65% 

Test Accuracy: 85.08% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8571639489382505
distance x is tensor(119.9729, device='cuda:0')
benign distance is  tensor(119.9729, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8655290920287371
distance x is tensor(113.9070, device='cuda:0')
benign distance is  tensor(113.9070, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7364062014967203
distance x is tensor(119.0425, device='cuda:0')
benign distance is  tensor(119.0425, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0352254249155521
distance x is tensor(162.8645, device='cuda:0')
benign distance is  tensor(162.8645, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8231292841956019
distance x is tensor(86.2040, device='cuda:0')
benign distance is  tensor(86.2040, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7700686426833272
distance x is tensor(108.2836, device='cuda:0')
benign distance is  tensor(108.2836, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2806800696998835
distance x is tensor(104.2253, device='cuda:0')
benign distance is  tensor(104.2253, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7077697636559606
distance x is tensor(89.2847, device='cuda:0')
benign distance is  tensor(89.2847, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.3534981235861778
distance x is tensor(113.3614, device='cuda:0')
benign distance is  tensor(113.3614, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9313036501407623
distance x is tensor(115.2031, device='cuda:0')
benign distance is  tensor(115.2031, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.167615257203579
distance x is tensor(99.7692, device='cuda:0')
benign distance is  tensor(99.7692, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.1601255126297474
distance x is tensor(108.7045, device='cuda:0')
benign distance is  tensor(108.7045, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.1889268215745687
distance x is tensor(92.9338, device='cuda:0')
benign distance is  tensor(92.9338, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7297462876886129
distance x is tensor(205.1888, device='cuda:0')
benign distance is  tensor(205.1888, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.4339127242565155
distance x is tensor(146.8091, device='cuda:0')
benign distance is  tensor(146.8091, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7786579467356205
distance x is tensor(91.3756, device='cuda:0')
benign distance is  tensor(91.3756, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8000000001600001
mal_loss is 0.9188324632123113
mal_entropy is 0.24051703792065382
user_PLR len size 36
counter_tensor is  tensor([ 0., 32., 32.,  0.,  0., 12., 34., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 13., 12., 23., 33., 16., 13., 12., 12.,
        13.,  0., 15.,  0., 27., 21., 34., 30.])
count_res tensor([6.4473e-16, 5.0910e-02, 5.0910e-02, 6.4473e-16, 6.4473e-16, 1.0493e-10,
        3.7617e-01, 1.0493e-10, 1.7078e-05, 1.7078e-05, 1.7078e-05, 1.7078e-05,
        1.7078e-05, 1.7078e-05, 1.7078e-05, 1.7078e-05, 1.7078e-05, 1.7078e-05,
        1.7078e-05, 1.7078e-05, 2.8524e-10, 1.0493e-10, 6.2828e-06, 1.3839e-01,
        5.7291e-09, 2.8524e-10, 1.0493e-10, 1.0493e-10, 2.8524e-10, 6.4473e-16,
        2.1076e-09, 6.4473e-16, 3.4303e-04, 8.5028e-07, 3.7617e-01, 6.8899e-03])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 80.73% 

Test Accuracy: 83.69% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.731713991612196
distance x is tensor(109.3670, device='cuda:0')
benign distance is  tensor(109.3670, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9665340520441532
distance x is tensor(119.2165, device='cuda:0')
benign distance is  tensor(119.2165, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8485619593411684
distance x is tensor(113.9514, device='cuda:0')
benign distance is  tensor(113.9514, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9692876599729061
distance x is tensor(153.0237, device='cuda:0')
benign distance is  tensor(153.0237, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9216843396425247
distance x is tensor(90.3357, device='cuda:0')
benign distance is  tensor(90.3357, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.716980604454875
distance x is tensor(108.6463, device='cuda:0')
benign distance is  tensor(108.6463, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9879154060035944
distance x is tensor(71.9390, device='cuda:0')
benign distance is  tensor(71.9390, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6656763721257448
distance x is tensor(90.1618, device='cuda:0')
benign distance is  tensor(90.1618, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.142503159120679
distance x is tensor(101.3750, device='cuda:0')
benign distance is  tensor(101.3750, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7847593370825052
distance x is tensor(110.3710, device='cuda:0')
benign distance is  tensor(110.3710, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9952184222638607
distance x is tensor(81.1103, device='cuda:0')
benign distance is  tensor(81.1103, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2582333274185658
distance x is tensor(113.5547, device='cuda:0')
benign distance is  tensor(113.5547, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0545964427292347
distance x is tensor(174.6957, device='cuda:0')
benign distance is  tensor(174.6957, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8985899463295937
distance x is tensor(72.7301, device='cuda:0')
benign distance is  tensor(72.7301, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8251684634014964
distance x is tensor(125.8508, device='cuda:0')
benign distance is  tensor(125.8508, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2902075797319412
distance x is tensor(123.4318, device='cuda:0')
benign distance is  tensor(123.4318, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8383327219635248
distance x is tensor(131.5594, device='cuda:0')
benign distance is  tensor(131.5594, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.7815683744847775
distance x is tensor(102.1466, device='cuda:0')
benign distance is  tensor(102.1466, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6834297105669975
distance x is tensor(145.1528, device='cuda:0')
benign distance is  tensor(145.1528, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.2127227485179901
distance x is tensor(117.1640, device='cuda:0')
benign distance is  tensor(117.1640, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7530040871351957
distance x is tensor(113.1707, device='cuda:0')
benign distance is  tensor(113.1707, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.974213819950819
distance x is tensor(91.3099, device='cuda:0')
benign distance is  tensor(91.3099, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.040765654295683
distance x is tensor(96.0106, device='cuda:0')
benign distance is  tensor(96.0106, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.862441984936595
distance x is tensor(125.4136, device='cuda:0')
benign distance is  tensor(125.4136, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.77200000016
mal_loss is 1.163608305156231
mal_entropy is 0.20775543712079525
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 19., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7119e-05, 2.7119e-05, 2.7119e-05, 2.7119e-05, 2.7119e-05, 2.7119e-05,
        2.7119e-05, 2.9739e-02, 8.0839e-02, 8.0839e-02, 8.0839e-02, 8.0839e-02,
        8.0839e-02, 8.0839e-02, 8.0839e-02, 8.0839e-02, 8.0839e-02, 8.0839e-02,
        8.0839e-02, 8.0839e-02])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 82.18% 

Test Accuracy: 79.29% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6252195108681917
distance x is tensor(127.8319, device='cuda:0')
benign distance is  tensor(127.8319, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0634599663317204
distance x is tensor(132.9814, device='cuda:0')
benign distance is  tensor(132.9814, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.927606962621212
distance x is tensor(130.3135, device='cuda:0')
benign distance is  tensor(130.3135, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9320383053272963
distance x is tensor(164.8728, device='cuda:0')
benign distance is  tensor(164.8728, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1906874161213636
distance x is tensor(103.4922, device='cuda:0')
benign distance is  tensor(103.4922, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8861609222367406
distance x is tensor(125.3241, device='cuda:0')
benign distance is  tensor(125.3241, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3338372744619846
distance x is tensor(93.4528, device='cuda:0')
benign distance is  tensor(93.4528, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6568575603887439
distance x is tensor(95.1900, device='cuda:0')
benign distance is  tensor(95.1900, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.47800000016000005
mal_loss is 6.976704865694046
mal_entropy is 0.13937816955149174
user_PLR len size 52
counter_tensor is  tensor([37., 51., 46., 48.,  4., 30., 49., 46.,  8.,  8.,  8.,  8.,  8.,  8.,
         8.,  8.,  8.,  8.,  8.,  8., 43., 50., 51., 48., 51., 51.,  7.,  5.,
         0., 42.,  2., 25., 50., 50., 41., 51.,  0.,  9., 49., 40., 51., 51.,
         0., 47., 51., 51., 45., 49., 40., 17.,  0.,  1.])
count_res tensor([7.8122e-08, 9.3949e-02, 6.3303e-04, 4.6775e-03, 3.6396e-22, 7.1238e-11,
        1.2715e-02, 6.3303e-04, 1.9872e-20, 1.9872e-20, 1.9872e-20, 1.9872e-20,
        1.9872e-20, 1.9872e-20, 1.9872e-20, 1.9872e-20, 1.9872e-20, 1.9872e-20,
        1.9872e-20, 1.9872e-20, 3.1517e-05, 3.4562e-02, 9.3949e-02, 4.6775e-03,
        9.3949e-02, 9.3949e-02, 7.3103e-21, 9.8935e-22, 6.6662e-24, 1.1594e-05,
        4.9257e-23, 4.8000e-13, 3.4562e-02, 3.4562e-02, 4.2653e-06, 9.3949e-02,
        6.6662e-24, 5.4016e-20, 1.2715e-02, 1.5691e-06, 9.3949e-02, 9.3949e-02,
        6.6662e-24, 1.7207e-03, 9.3949e-02, 9.3949e-02, 2.3288e-04, 1.2715e-02,
        1.5691e-06, 1.6102e-16, 6.6662e-24, 1.8120e-23])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 79.87% 

Test Accuracy: 85.44% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6374610830098391
distance x is tensor(112.9823, device='cuda:0')
benign distance is  tensor(112.9823, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7010604869574308
distance x is tensor(100.4445, device='cuda:0')
benign distance is  tensor(100.4445, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7636578418314457
distance x is tensor(114.1531, device='cuda:0')
benign distance is  tensor(114.1531, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8339658789336681
distance x is tensor(150.3435, device='cuda:0')
benign distance is  tensor(150.3435, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9910247158259153
distance x is tensor(90.8952, device='cuda:0')
benign distance is  tensor(90.8952, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7514218064025044
distance x is tensor(102.3005, device='cuda:0')
benign distance is  tensor(102.3005, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9753386843949556
distance x is tensor(100.6853, device='cuda:0')
benign distance is  tensor(100.6853, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6803732262924314
distance x is tensor(93.6062, device='cuda:0')
benign distance is  tensor(93.6062, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.853031225502491
distance x is tensor(102.0181, device='cuda:0')
benign distance is  tensor(102.0181, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7085861274972558
distance x is tensor(113.7718, device='cuda:0')
benign distance is  tensor(113.7718, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8584710620343685
distance x is tensor(68.4723, device='cuda:0')
benign distance is  tensor(68.4723, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3058461174368858
distance x is tensor(108.6292, device='cuda:0')
benign distance is  tensor(108.6292, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1806980576366186
distance x is tensor(152.3479, device='cuda:0')
benign distance is  tensor(152.3479, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6979170124977827
distance x is tensor(59.3962, device='cuda:0')
benign distance is  tensor(59.3962, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8454694300889969
distance x is tensor(127.3450, device='cuda:0')
benign distance is  tensor(127.3450, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.4373027421534061
distance x is tensor(127.8086, device='cuda:0')
benign distance is  tensor(127.8086, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1605793107300997
distance x is tensor(97.1798, device='cuda:0')
benign distance is  tensor(97.1798, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9449970088899136
distance x is tensor(105.9384, device='cuda:0')
benign distance is  tensor(105.9384, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9317022189497948
distance x is tensor(111.5824, device='cuda:0')
benign distance is  tensor(111.5824, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8849189169704914
distance x is tensor(100.0609, device='cuda:0')
benign distance is  tensor(100.0609, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9695025682449341
distance x is tensor(77.0795, device='cuda:0')
benign distance is  tensor(77.0795, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7022661063820124
distance x is tensor(203.4017, device='cuda:0')
benign distance is  tensor(203.4017, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.2540912628173828
distance x is tensor(144.1144, device='cuda:0')
benign distance is  tensor(144.1144, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7555771414190531
distance x is tensor(92.7506, device='cuda:0')
benign distance is  tensor(92.7506, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.2067859210073948
distance x is tensor(100.0539, device='cuda:0')
benign distance is  tensor(100.0539, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6025255378335714
distance x is tensor(90.6385, device='cuda:0')
benign distance is  tensor(90.6385, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9722722945734859
distance x is tensor(121.8657, device='cuda:0')
benign distance is  tensor(121.8657, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2296353876590729
distance x is tensor(113.3356, device='cuda:0')
benign distance is  tensor(113.3356, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7628675866872072
distance x is tensor(106.2178, device='cuda:0')
benign distance is  tensor(106.2178, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8642258318141103
distance x is tensor(110.5526, device='cuda:0')
benign distance is  tensor(110.5526, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5004309518262744
distance x is tensor(112.3745, device='cuda:0')
benign distance is  tensor(112.3745, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7157601173967123
distance x is tensor(162.6467, device='cuda:0')
benign distance is  tensor(162.6467, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.9899711944162846
distance x is tensor(98.6133, device='cuda:0')
benign distance is  tensor(98.6133, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.326431781053543
distance x is tensor(132.5482, device='cuda:0')
benign distance is  tensor(132.5482, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.0622348096221685
distance x is tensor(126.4626, device='cuda:0')
benign distance is  tensor(126.4626, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.90431984141469
distance x is tensor(86.7714, device='cuda:0')
benign distance is  tensor(86.7714, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6576701197773218
distance x is tensor(143.3014, device='cuda:0')
benign distance is  tensor(143.3014, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.147782813757658
distance x is tensor(125.0305, device='cuda:0')
benign distance is  tensor(125.0305, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9502185937017202
distance x is tensor(97.2508, device='cuda:0')
benign distance is  tensor(97.2508, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5140527598559856
distance x is tensor(120.8511, device='cuda:0')
benign distance is  tensor(120.8511, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.82000000016
mal_loss is 0.6350043900310993
mal_entropy is 0.25244762748479843
user_PLR len size 20
counter_tensor is  tensor([16., 15., 19., 13., 15., 13., 14., 16., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([1.4744e-03, 5.4241e-04, 2.9614e-02, 7.3407e-05, 5.4241e-04, 7.3407e-05,
        1.9954e-04, 1.4744e-03, 8.0500e-02, 8.0500e-02, 8.0500e-02, 8.0500e-02,
        8.0500e-02, 8.0500e-02, 8.0500e-02, 8.0500e-02, 8.0500e-02, 8.0500e-02,
        8.0500e-02, 8.0500e-02])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 78.05% 

Test Accuracy: 82.63% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6641154140233994
distance x is tensor(128.0293, device='cuda:0')
benign distance is  tensor(128.0293, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9893716424703598
distance x is tensor(101.0766, device='cuda:0')
benign distance is  tensor(101.0766, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7255529258400202
distance x is tensor(105.8382, device='cuda:0')
benign distance is  tensor(105.8382, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8516822289675474
distance x is tensor(155.2910, device='cuda:0')
benign distance is  tensor(155.2910, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.055673474445939
distance x is tensor(93.2207, device='cuda:0')
benign distance is  tensor(93.2207, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5988043770194054
distance x is tensor(101.1141, device='cuda:0')
benign distance is  tensor(101.1141, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.00450730137527
distance x is tensor(95.8932, device='cuda:0')
benign distance is  tensor(95.8932, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6349080111831427
distance x is tensor(96.0819, device='cuda:0')
benign distance is  tensor(96.0819, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.58500000016
mal_loss is 2.518932528793812
mal_entropy is 0.31591114588081837
user_PLR len size 28
counter_tensor is  tensor([ 0., 13., 12., 12., 14., 15., 12., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 24., 22., 26., 12., 12., 21., 14., 27.])
count_res tensor([7.7439e-13, 3.4260e-07, 1.2604e-07, 1.2604e-07, 9.3129e-07, 2.5315e-06,
        1.2604e-07, 4.1201e-01, 6.8813e-06, 6.8813e-06, 6.8813e-06, 6.8813e-06,
        6.8813e-06, 6.8813e-06, 6.8813e-06, 6.8813e-06, 6.8813e-06, 6.8813e-06,
        6.8813e-06, 6.8813e-06, 2.0513e-02, 2.7761e-03, 1.5157e-01, 1.2604e-07,
        1.2604e-07, 1.0213e-03, 9.3129e-07, 4.1201e-01])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 81.32% 

Test Accuracy: 84.32% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6244683973491192
distance x is tensor(114.8978, device='cuda:0')
benign distance is  tensor(114.8978, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8988073002547026
distance x is tensor(121.5094, device='cuda:0')
benign distance is  tensor(121.5094, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8086994299665093
distance x is tensor(125.5997, device='cuda:0')
benign distance is  tensor(125.5997, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9222464915364981
distance x is tensor(151.6301, device='cuda:0')
benign distance is  tensor(151.6301, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2267850693315268
distance x is tensor(95.3347, device='cuda:0')
benign distance is  tensor(95.3347, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8278796775266528
distance x is tensor(101.9588, device='cuda:0')
benign distance is  tensor(101.9588, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.041045654565096
distance x is tensor(96.1032, device='cuda:0')
benign distance is  tensor(96.1032, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8052435908466578
distance x is tensor(72.4955, device='cuda:0')
benign distance is  tensor(72.4955, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.993655301630497
distance x is tensor(102.5632, device='cuda:0')
benign distance is  tensor(102.5632, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5457932902500033
distance x is tensor(122.0112, device='cuda:0')
benign distance is  tensor(122.0112, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.052205789834261
distance x is tensor(72.6700, device='cuda:0')
benign distance is  tensor(72.6700, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4020835682749748
distance x is tensor(111.0008, device='cuda:0')
benign distance is  tensor(111.0008, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1550170294940472
distance x is tensor(155.4834, device='cuda:0')
benign distance is  tensor(155.4834, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8635760713368654
distance x is tensor(69.7968, device='cuda:0')
benign distance is  tensor(69.7968, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7785475179553032
distance x is tensor(140.1634, device='cuda:0')
benign distance is  tensor(140.1634, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.242417998611927
distance x is tensor(107.3790, device='cuda:0')
benign distance is  tensor(107.3790, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.78300000016
mal_loss is 1.109444435685873
mal_entropy is 0.15974745666608214
user_PLR len size 36
counter_tensor is  tensor([ 0., 13., 12.,  0., 34., 34., 35.,  2., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 12., 30., 24., 12., 16., 28., 34.,  0.,
        12., 12., 27., 12.,  0., 30., 32., 35.])
count_res tensor([1.9900e-16, 8.8041e-11, 3.2389e-11, 1.9900e-16, 1.1611e-01, 1.1611e-01,
        3.1562e-01, 1.4704e-15, 5.2714e-06, 5.2714e-06, 5.2714e-06, 5.2714e-06,
        5.2714e-06, 5.2714e-06, 5.2714e-06, 5.2714e-06, 5.2714e-06, 5.2714e-06,
        5.2714e-06, 5.2714e-06, 3.2389e-11, 2.1266e-03, 5.2714e-06, 3.2389e-11,
        1.7684e-09, 2.8781e-04, 1.1611e-01, 1.9900e-16, 3.2389e-11, 3.2389e-11,
        1.0588e-04, 3.2389e-11, 1.9900e-16, 2.1266e-03, 1.5714e-02, 3.1562e-01])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 79.22% 

Test Accuracy: 85.11% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7425592206418514
distance x is tensor(127.6589, device='cuda:0')
benign distance is  tensor(127.6589, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8430952299386263
distance x is tensor(97.0678, device='cuda:0')
benign distance is  tensor(97.0678, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7278300868347287
distance x is tensor(105.7549, device='cuda:0')
benign distance is  tensor(105.7549, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.845103494822979
distance x is tensor(155.4492, device='cuda:0')
benign distance is  tensor(155.4492, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.924772665835917
distance x is tensor(98.6249, device='cuda:0')
benign distance is  tensor(98.6249, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6551129324361682
distance x is tensor(91.1621, device='cuda:0')
benign distance is  tensor(91.1621, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2958854902535677
distance x is tensor(89.0768, device='cuda:0')
benign distance is  tensor(89.0768, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.747904846444726
distance x is tensor(84.7053, device='cuda:0')
benign distance is  tensor(84.7053, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.233996108174324
distance x is tensor(99.1288, device='cuda:0')
benign distance is  tensor(99.1288, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7863152083009481
distance x is tensor(119.9913, device='cuda:0')
benign distance is  tensor(119.9913, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.0350747853517532
distance x is tensor(127.3939, device='cuda:0')
benign distance is  tensor(127.3939, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9312022551894188
distance x is tensor(132.1355, device='cuda:0')
benign distance is  tensor(132.1355, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0812291391193867
distance x is tensor(74.8264, device='cuda:0')
benign distance is  tensor(74.8264, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6885907631367445
distance x is tensor(215.2447, device='cuda:0')
benign distance is  tensor(215.2447, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.33036482706666
distance x is tensor(146.7133, device='cuda:0')
benign distance is  tensor(146.7133, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8528516069054604
distance x is tensor(84.8268, device='cuda:0')
benign distance is  tensor(84.8268, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7438539266586304
distance x is tensor(128.7410, device='cuda:0')
benign distance is  tensor(128.7410, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.9393925564363599
distance x is tensor(102.1261, device='cuda:0')
benign distance is  tensor(102.1261, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7597290519624949
distance x is tensor(151.1906, device='cuda:0')
benign distance is  tensor(151.1906, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.2985300868749619
distance x is tensor(128.2200, device='cuda:0')
benign distance is  tensor(128.2200, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6680817175656557
distance x is tensor(114.7290, device='cuda:0')
benign distance is  tensor(114.7290, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.00358622148633
distance x is tensor(89.7566, device='cuda:0')
benign distance is  tensor(89.7566, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.9822491966187954
distance x is tensor(96.2264, device='cuda:0')
benign distance is  tensor(96.2264, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7038629744201899
distance x is tensor(131.1706, device='cuda:0')
benign distance is  tensor(131.1706, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.78500000016
mal_loss is 1.1698373407125473
mal_entropy is 0.1583949588239193
user_PLR len size 36
counter_tensor is  tensor([13.,  3., 16., 13., 12.,  0., 33., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 12., 35.,  1., 28., 24., 23., 34., 12.,
        12., 26., 35., 18.,  0.,  0., 13., 21.])
count_res tensor([1.1138e-10, 5.0566e-15, 2.2371e-09, 1.1138e-10, 4.0974e-11, 2.5175e-16,
        5.4037e-02, 4.0974e-11, 6.6687e-06, 6.6687e-06, 6.6687e-06, 6.6687e-06,
        6.6687e-06, 6.6687e-06, 6.6687e-06, 6.6687e-06, 6.6687e-06, 6.6687e-06,
        6.6687e-06, 6.6687e-06, 4.0974e-11, 3.9929e-01, 6.8434e-16, 3.6410e-04,
        6.6687e-06, 2.4533e-06, 1.4689e-01, 4.0974e-11, 4.0974e-11, 4.9276e-05,
        3.9929e-01, 1.6530e-08, 2.5175e-16, 2.5175e-16, 1.1138e-10, 3.3202e-07])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 87.58% 

Test Accuracy: 86.82% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6120862644165754
distance x is tensor(118.8615, device='cuda:0')
benign distance is  tensor(118.8615, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8730603065341711
distance x is tensor(114.6888, device='cuda:0')
benign distance is  tensor(114.6888, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6064997967332602
distance x is tensor(107.4026, device='cuda:0')
benign distance is  tensor(107.4026, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.033469621092081
distance x is tensor(148.1654, device='cuda:0')
benign distance is  tensor(148.1654, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7505083456635475
distance x is tensor(96.1974, device='cuda:0')
benign distance is  tensor(96.1974, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6537538976408541
distance x is tensor(107.7502, device='cuda:0')
benign distance is  tensor(107.7502, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1737356279045343
distance x is tensor(102.3016, device='cuda:0')
benign distance is  tensor(102.3016, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6671921033412218
distance x is tensor(80.7773, device='cuda:0')
benign distance is  tensor(80.7773, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9458485264331102
distance x is tensor(107.1052, device='cuda:0')
benign distance is  tensor(107.1052, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6964096520096064
distance x is tensor(120.0779, device='cuda:0')
benign distance is  tensor(120.0779, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.328164417296648
distance x is tensor(53.5485, device='cuda:0')
benign distance is  tensor(53.5485, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0680365934967995
distance x is tensor(117.7594, device='cuda:0')
benign distance is  tensor(117.7594, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9613394029438496
distance x is tensor(159.9026, device='cuda:0')
benign distance is  tensor(159.9026, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7056732112541795
distance x is tensor(68.9305, device='cuda:0')
benign distance is  tensor(68.9305, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9039790071547031
distance x is tensor(137.7232, device='cuda:0')
benign distance is  tensor(137.7232, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.214799527078867
distance x is tensor(120.1287, device='cuda:0')
benign distance is  tensor(120.1287, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9293557368218899
distance x is tensor(113.6665, device='cuda:0')
benign distance is  tensor(113.6665, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7712893895804882
distance x is tensor(64.9354, device='cuda:0')
benign distance is  tensor(64.9354, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8242556396871805
distance x is tensor(131.5967, device='cuda:0')
benign distance is  tensor(131.5967, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.0464976597577333
distance x is tensor(111.5187, device='cuda:0')
benign distance is  tensor(111.5187, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7684047520160675
distance x is tensor(119.4896, device='cuda:0')
benign distance is  tensor(119.4896, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7857450032606721
distance x is tensor(113.0376, device='cuda:0')
benign distance is  tensor(113.0376, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5402619242668152
distance x is tensor(112.8027, device='cuda:0')
benign distance is  tensor(112.8027, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7581404009833932
distance x is tensor(165.8858, device='cuda:0')
benign distance is  tensor(165.8858, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.82900000016
mal_loss is 0.7831804435700178
mal_entropy is 0.17604199470952153
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 89.66% 

Test Accuracy: 83.25% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7289169076830149
distance x is tensor(144.3427, device='cuda:0')
benign distance is  tensor(144.3427, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8963540624827147
distance x is tensor(128.9708, device='cuda:0')
benign distance is  tensor(128.9708, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.760901803150773
distance x is tensor(123.7197, device='cuda:0')
benign distance is  tensor(123.7197, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8138209357857704
distance x is tensor(168.4978, device='cuda:0')
benign distance is  tensor(168.4978, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0927961096167564
distance x is tensor(105.7642, device='cuda:0')
benign distance is  tensor(105.7642, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7014079876244068
distance x is tensor(115.3093, device='cuda:0')
benign distance is  tensor(115.3093, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.565500233322382
distance x is tensor(119.1578, device='cuda:0')
benign distance is  tensor(119.1578, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6786198848858476
distance x is tensor(104.9030, device='cuda:0')
benign distance is  tensor(104.9030, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.60000000016
mal_loss is 5.425174713134766
mal_entropy is 0.1568037187680602
user_PLR len size 44
counter_tensor is  tensor([43., 10., 38., 10., 43., 41.,  8., 43.,  8.,  8.,  8.,  8.,  8.,  8.,
         8.,  8.,  8.,  8.,  8.,  8., 43., 41., 32., 43., 43.,  0.,  2., 43.,
        41., 35., 31., 36., 30., 37., 18., 43., 41., 43., 43., 42.,  6., 43.,
         5., 10.])
count_res tensor([8.3895e-02, 3.9086e-16, 5.6528e-04, 3.9086e-16, 8.3895e-02, 1.1354e-02,
        5.2897e-17, 8.3895e-02, 5.2897e-17, 5.2897e-17, 5.2897e-17, 5.2897e-17,
        5.2897e-17, 5.2897e-17, 5.2897e-17, 5.2897e-17, 5.2897e-17, 5.2897e-17,
        5.2897e-17, 5.2897e-17, 8.3895e-02, 1.1354e-02, 1.4012e-06, 8.3895e-02,
        8.3895e-02, 1.7745e-20, 1.3112e-19, 8.3895e-02, 1.1354e-02, 2.8144e-05,
        5.1547e-07, 7.6502e-05, 1.8963e-07, 2.0795e-04, 1.1651e-12, 8.3895e-02,
        1.1354e-02, 8.3895e-02, 8.3895e-02, 3.0863e-02, 7.1588e-18, 8.3895e-02,
        2.6336e-18, 3.9086e-16])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 87.45% 

Test Accuracy: 87.29% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6486580222845078
distance x is tensor(118.7500, device='cuda:0')
benign distance is  tensor(118.7500, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6818634513765574
distance x is tensor(102.4444, device='cuda:0')
benign distance is  tensor(102.4444, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6920739058405161
distance x is tensor(107.7555, device='cuda:0')
benign distance is  tensor(107.7555, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7080206908285618
distance x is tensor(152.0742, device='cuda:0')
benign distance is  tensor(152.0742, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7877776054665446
distance x is tensor(72.6380, device='cuda:0')
benign distance is  tensor(72.6380, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6103249751031399
distance x is tensor(99.4833, device='cuda:0')
benign distance is  tensor(99.4833, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.963973524980247
distance x is tensor(97.7958, device='cuda:0')
benign distance is  tensor(97.7958, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6677116975188255
distance x is tensor(75.9529, device='cuda:0')
benign distance is  tensor(75.9529, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.96920345723629
distance x is tensor(98.5580, device='cuda:0')
benign distance is  tensor(98.5580, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6277856957167387
distance x is tensor(112.8799, device='cuda:0')
benign distance is  tensor(112.8799, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0007737539708614
distance x is tensor(54.9676, device='cuda:0')
benign distance is  tensor(54.9676, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2492412738502026
distance x is tensor(118.6358, device='cuda:0')
benign distance is  tensor(118.6358, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9559483677148819
distance x is tensor(175.4453, device='cuda:0')
benign distance is  tensor(175.4453, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7080382220447063
distance x is tensor(61.9778, device='cuda:0')
benign distance is  tensor(61.9778, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.890529241412878
distance x is tensor(126.5011, device='cuda:0')
benign distance is  tensor(126.5011, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9615118484944105
distance x is tensor(118.7280, device='cuda:0')
benign distance is  tensor(118.7280, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1136947125196457
distance x is tensor(105.9673, device='cuda:0')
benign distance is  tensor(105.9673, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7753716427832842
distance x is tensor(113.3474, device='cuda:0')
benign distance is  tensor(113.3474, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8936606589704752
distance x is tensor(120.9760, device='cuda:0')
benign distance is  tensor(120.9760, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8834268487989902
distance x is tensor(110.6569, device='cuda:0')
benign distance is  tensor(110.6569, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.8978785593062639
distance x is tensor(70.6095, device='cuda:0')
benign distance is  tensor(70.6095, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6978266835212708
distance x is tensor(201.5880, device='cuda:0')
benign distance is  tensor(201.5880, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.037990229204297
distance x is tensor(146.3262, device='cuda:0')
benign distance is  tensor(146.3262, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6715203924104571
distance x is tensor(94.6009, device='cuda:0')
benign distance is  tensor(94.6009, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.0840542688965797
distance x is tensor(100.8493, device='cuda:0')
benign distance is  tensor(100.8493, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.9358225092291832
distance x is tensor(132.2989, device='cuda:0')
benign distance is  tensor(132.2989, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.2034845426678658
distance x is tensor(134.0518, device='cuda:0')
benign distance is  tensor(134.0518, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.9214666001498699
distance x is tensor(84.0012, device='cuda:0')
benign distance is  tensor(84.0012, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6030756235122681
distance x is tensor(148.9067, device='cuda:0')
benign distance is  tensor(148.9067, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8128741178661585
distance x is tensor(132.2057, device='cuda:0')
benign distance is  tensor(132.2057, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7136787567287683
distance x is tensor(100.5818, device='cuda:0')
benign distance is  tensor(100.5818, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6424263212829828
distance x is tensor(116.4500, device='cuda:0')
benign distance is  tensor(116.4500, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.86500000016
mal_loss is 0.514468202367425
mal_entropy is 0.17109509697183967
user_PLR len size 20
counter_tensor is  tensor([13., 13., 12., 13., 12., 12., 12., 13., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([7.5959e-05, 7.5959e-05, 2.7944e-05, 7.5959e-05, 2.7944e-05, 2.7944e-05,
        2.7944e-05, 7.5959e-05, 8.3299e-02, 8.3299e-02, 8.3299e-02, 8.3299e-02,
        8.3299e-02, 8.3299e-02, 8.3299e-02, 8.3299e-02, 8.3299e-02, 8.3299e-02,
        8.3299e-02, 8.3299e-02])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 92.25% 

Test Accuracy: 85.95% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7313938159495592
distance x is tensor(127.7757, device='cuda:0')
benign distance is  tensor(127.7757, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8621831629425287
distance x is tensor(116.9234, device='cuda:0')
benign distance is  tensor(116.9234, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.69157490786165
distance x is tensor(119.1420, device='cuda:0')
benign distance is  tensor(119.1420, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8368618413805962
distance x is tensor(174.0836, device='cuda:0')
benign distance is  tensor(174.0836, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8276563445106149
distance x is tensor(100.1032, device='cuda:0')
benign distance is  tensor(100.1032, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7681226693093777
distance x is tensor(119.4165, device='cuda:0')
benign distance is  tensor(119.4165, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3143283687531948
distance x is tensor(123.3180, device='cuda:0')
benign distance is  tensor(123.3180, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7524412861093879
distance x is tensor(96.2862, device='cuda:0')
benign distance is  tensor(96.2862, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.53000000016
mal_loss is 5.32338584959507
mal_entropy is 0.1711261412128806
user_PLR len size 44
counter_tensor is  tensor([43., 12., 43., 41., 39.,  2.,  0.,  2., 28., 28., 28., 28., 28., 28.,
        28., 28., 28., 28., 28., 28., 36., 30., 43.,  7., 43., 39., 26., 43.,
         2., 20.,  3., 43., 37., 43., 37., 36., 43., 20., 38., 23.,  8., 43.,
         0., 25.])
count_res tensor([1.0887e-01, 3.7477e-15, 1.0887e-01, 1.4734e-02, 1.9940e-03, 1.7015e-19,
        2.3027e-20, 1.7015e-19, 3.3303e-08, 3.3303e-08, 3.3303e-08, 3.3303e-08,
        3.3303e-08, 3.3303e-08, 3.3303e-08, 3.3303e-08, 3.3303e-08, 3.3303e-08,
        3.3303e-08, 3.3303e-08, 9.9274e-05, 2.4608e-07, 1.0887e-01, 2.5252e-17,
        1.0887e-01, 1.9940e-03, 4.5070e-09, 1.0887e-01, 1.7015e-19, 1.1172e-11,
        4.6251e-19, 1.0887e-01, 2.6986e-04, 1.0887e-01, 2.6986e-04, 9.9274e-05,
        1.0887e-01, 1.1172e-11, 7.3354e-04, 2.2439e-10, 6.8642e-17, 1.0887e-01,
        2.3027e-20, 1.6580e-09])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 91.24% 

Test Accuracy: 88.20% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6419139243662357
distance x is tensor(107.0690, device='cuda:0')
benign distance is  tensor(107.0690, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.671661302447319
distance x is tensor(102.3111, device='cuda:0')
benign distance is  tensor(102.3111, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.681201527826488
distance x is tensor(102.1228, device='cuda:0')
benign distance is  tensor(102.1228, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8027641233056784
distance x is tensor(148.2231, device='cuda:0')
benign distance is  tensor(148.2231, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.749896289780736
distance x is tensor(88.3707, device='cuda:0')
benign distance is  tensor(88.3707, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7161034070886672
distance x is tensor(96.2112, device='cuda:0')
benign distance is  tensor(96.2112, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9662954844534397
distance x is tensor(93.0926, device='cuda:0')
benign distance is  tensor(93.0926, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5557253817096353
distance x is tensor(80.8239, device='cuda:0')
benign distance is  tensor(80.8239, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7030310574918985
distance x is tensor(81.3517, device='cuda:0')
benign distance is  tensor(81.3517, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6674883649684489
distance x is tensor(114.5658, device='cuda:0')
benign distance is  tensor(114.5658, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2763021141290665
distance x is tensor(68.6748, device='cuda:0')
benign distance is  tensor(68.6748, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0176745615899563
distance x is tensor(108.8404, device='cuda:0')
benign distance is  tensor(108.8404, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8737169876694679
distance x is tensor(185.5537, device='cuda:0')
benign distance is  tensor(185.5537, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6159769082441926
distance x is tensor(52.7442, device='cuda:0')
benign distance is  tensor(52.7442, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.877884809859097
distance x is tensor(129.8134, device='cuda:0')
benign distance is  tensor(129.8134, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0677545592188835
distance x is tensor(122.0036, device='cuda:0')
benign distance is  tensor(122.0036, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.0172673016786575
distance x is tensor(108.2511, device='cuda:0')
benign distance is  tensor(108.2511, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5190180754289031
distance x is tensor(78.5407, device='cuda:0')
benign distance is  tensor(78.5407, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9036856070160866
distance x is tensor(120.4626, device='cuda:0')
benign distance is  tensor(120.4626, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2270434070378542
distance x is tensor(110.6908, device='cuda:0')
benign distance is  tensor(110.6908, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6868322659283876
distance x is tensor(110.1113, device='cuda:0')
benign distance is  tensor(110.1113, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9494771249592304
distance x is tensor(128.1959, device='cuda:0')
benign distance is  tensor(128.1959, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5186653565615416
distance x is tensor(103.3936, device='cuda:0')
benign distance is  tensor(103.3936, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.684214835986495
distance x is tensor(164.7608, device='cuda:0')
benign distance is  tensor(164.7608, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7743289433419704
distance x is tensor(123.2969, device='cuda:0')
benign distance is  tensor(123.2969, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.6444997321814299
distance x is tensor(95.9759, device='cuda:0')
benign distance is  tensor(95.9759, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6360751949250698
distance x is tensor(139.2775, device='cuda:0')
benign distance is  tensor(139.2775, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.1361933574080467
distance x is tensor(122.4899, device='cuda:0')
benign distance is  tensor(122.4899, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7478755507618189
distance x is tensor(110.6925, device='cuda:0')
benign distance is  tensor(110.6925, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7601089430972934
distance x is tensor(87.8229, device='cuda:0')
benign distance is  tensor(87.8229, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7178889214992523
distance x is tensor(85.4428, device='cuda:0')
benign distance is  tensor(85.4428, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.758291881531477
distance x is tensor(111.4882, device='cuda:0')
benign distance is  tensor(111.4882, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.87000000016
mal_loss is 0.4954464389011264
mal_entropy is 0.21602172777056694
user_PLR len size 28
counter_tensor is  tensor([16., 16., 16., 14., 13., 24., 13., 14., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 16., 16., 26., 14.,  1., 15., 27., 23.])
count_res tensor([1.1628e-05, 1.1628e-05, 1.1628e-05, 1.5737e-06, 5.7895e-07, 3.4664e-02,
        5.7895e-07, 1.5737e-06, 1.1628e-05, 1.1628e-05, 1.1628e-05, 1.1628e-05,
        1.1628e-05, 1.1628e-05, 1.1628e-05, 1.1628e-05, 1.1628e-05, 1.1628e-05,
        1.1628e-05, 1.1628e-05, 1.1628e-05, 1.1628e-05, 2.5613e-01, 1.5737e-06,
        3.5572e-12, 4.2779e-06, 6.9624e-01, 1.2752e-02])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 83.45% 

Test Accuracy: 82.24% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7829970866441727
distance x is tensor(118.4646, device='cuda:0')
benign distance is  tensor(118.4646, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0085583608597517
distance x is tensor(113.4197, device='cuda:0')
benign distance is  tensor(113.4197, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.830900164321065
distance x is tensor(110.1826, device='cuda:0')
benign distance is  tensor(110.1826, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0507302209734917
distance x is tensor(149.0957, device='cuda:0')
benign distance is  tensor(149.0957, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.058697734028101
distance x is tensor(107.2187, device='cuda:0')
benign distance is  tensor(107.2187, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7721161413937807
distance x is tensor(104.3057, device='cuda:0')
benign distance is  tensor(104.3057, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1581190377473831
distance x is tensor(109.1349, device='cuda:0')
benign distance is  tensor(109.1349, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.770093685016036
distance x is tensor(107.0791, device='cuda:0')
benign distance is  tensor(107.0791, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.284048993140459
distance x is tensor(134.5539, device='cuda:0')
benign distance is  tensor(134.5539, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7240451220422983
distance x is tensor(121.9944, device='cuda:0')
benign distance is  tensor(121.9944, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.295188270509243
distance x is tensor(123.2272, device='cuda:0')
benign distance is  tensor(123.2272, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8720376938581467
distance x is tensor(119.5796, device='cuda:0')
benign distance is  tensor(119.5796, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.1063764542341232
distance x is tensor(82.0919, device='cuda:0')
benign distance is  tensor(82.0919, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7811921872198582
distance x is tensor(208.3312, device='cuda:0')
benign distance is  tensor(208.3312, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.2072456926107407
distance x is tensor(117.8912, device='cuda:0')
benign distance is  tensor(117.8912, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.9174098800867796
distance x is tensor(108.1633, device='cuda:0')
benign distance is  tensor(108.1633, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.72200000016
mal_loss is 1.7702250704169273
mal_entropy is 0.15508935041725636
user_PLR len size 28
counter_tensor is  tensor([27.,  0., 27., 12., 26., 25., 21., 19., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 25., 26., 26., 25., 25., 24., 15., 26.])
count_res tensor([2.4596e-01, 4.6229e-13, 2.4596e-01, 7.5240e-08, 9.0484e-02, 3.3287e-02,
        6.0968e-04, 8.2511e-05, 4.1080e-06, 4.1080e-06, 4.1080e-06, 4.1080e-06,
        4.1080e-06, 4.1080e-06, 4.1080e-06, 4.1080e-06, 4.1080e-06, 4.1080e-06,
        4.1080e-06, 4.1080e-06, 3.3287e-02, 9.0484e-02, 9.0484e-02, 3.3287e-02,
        3.3287e-02, 1.2246e-02, 1.5112e-06, 9.0484e-02])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 90.45% 

Test Accuracy: 88.00% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7108973301947117
distance x is tensor(97.8498, device='cuda:0')
benign distance is  tensor(97.8498, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7051115557551384
distance x is tensor(115.6660, device='cuda:0')
benign distance is  tensor(115.6660, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6038310639560223
distance x is tensor(92.1234, device='cuda:0')
benign distance is  tensor(92.1234, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8767947312444448
distance x is tensor(152.9749, device='cuda:0')
benign distance is  tensor(152.9749, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9428011141717434
distance x is tensor(89.2055, device='cuda:0')
benign distance is  tensor(89.2055, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.629366256762296
distance x is tensor(106.9179, device='cuda:0')
benign distance is  tensor(106.9179, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4012879151850939
distance x is tensor(102.8697, device='cuda:0')
benign distance is  tensor(102.8697, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5840446315705776
distance x is tensor(89.4466, device='cuda:0')
benign distance is  tensor(89.4466, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9184073377400637
distance x is tensor(99.0602, device='cuda:0')
benign distance is  tensor(99.0602, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8120874129235744
distance x is tensor(141.4425, device='cuda:0')
benign distance is  tensor(141.4425, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9665482454001904
distance x is tensor(60.1179, device='cuda:0')
benign distance is  tensor(60.1179, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2774317041039467
distance x is tensor(108.8629, device='cuda:0')
benign distance is  tensor(108.8629, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8765165256336331
distance x is tensor(155.2729, device='cuda:0')
benign distance is  tensor(155.2729, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6783246714621782
distance x is tensor(58.3881, device='cuda:0')
benign distance is  tensor(58.3881, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8519455436617136
distance x is tensor(130.5265, device='cuda:0')
benign distance is  tensor(130.5265, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8736674413084984
distance x is tensor(106.3146, device='cuda:0')
benign distance is  tensor(106.3146, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.85600000016
mal_loss is 0.659235411323607
mal_entropy is 0.1529187778942287
user_PLR len size 20
counter_tensor is  tensor([12., 17., 12., 19., 14., 16., 19., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.6193e-05, 3.8874e-03, 2.6193e-05, 2.8724e-02, 1.9354e-04, 1.4301e-03,
        2.8724e-02, 2.6193e-05, 7.8080e-02, 7.8080e-02, 7.8080e-02, 7.8080e-02,
        7.8080e-02, 7.8080e-02, 7.8080e-02, 7.8080e-02, 7.8080e-02, 7.8080e-02,
        7.8080e-02, 7.8080e-02])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 93.51% 

Test Accuracy: 86.87% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7778234705328941
distance x is tensor(108.8091, device='cuda:0')
benign distance is  tensor(108.8091, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7817982826381922
distance x is tensor(111.9388, device='cuda:0')
benign distance is  tensor(111.9388, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6755728237330914
distance x is tensor(108.4770, device='cuda:0')
benign distance is  tensor(108.4770, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0398443602025509
distance x is tensor(154.4242, device='cuda:0')
benign distance is  tensor(154.4242, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.891722060739994
distance x is tensor(93.6031, device='cuda:0')
benign distance is  tensor(93.6031, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6319328560493886
distance x is tensor(111.7018, device='cuda:0')
benign distance is  tensor(111.7018, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.446827132254839
distance x is tensor(101.7496, device='cuda:0')
benign distance is  tensor(101.7496, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6978005701676011
distance x is tensor(100.1538, device='cuda:0')
benign distance is  tensor(100.1538, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.62100000016
mal_loss is 4.458131596446037
mal_entropy is 0.1299629700370133
user_PLR len size 52
counter_tensor is  tensor([51.,  2.,  0., 18., 19., 44., 22., 51., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 49., 51., 42., 51.,  4., 41., 46.,  1.,
        30., 50., 11.,  0.,  2., 51., 29., 51., 50., 51., 48., 51., 50., 51.,
        46.,  0., 42., 51., 15., 10., 45., 36., 35., 47.])
count_res tensor([8.8306e-02, 4.6298e-23, 6.2657e-24, 4.1141e-16, 1.1183e-15, 8.0525e-05,
        2.2462e-14, 8.8306e-02, 5.5678e-17, 5.5678e-17, 5.5678e-17, 5.5678e-17,
        5.5678e-17, 5.5678e-17, 5.5678e-17, 5.5678e-17, 5.5678e-17, 5.5678e-17,
        5.5678e-17, 5.5678e-17, 1.1951e-02, 8.8306e-02, 1.0898e-05, 8.8306e-02,
        3.4210e-22, 4.0091e-06, 5.9500e-04, 1.7032e-23, 6.6959e-11, 3.2486e-02,
        3.7516e-19, 6.2657e-24, 4.6298e-23, 8.8306e-02, 2.4633e-11, 8.8306e-02,
        3.2486e-02, 8.8306e-02, 4.3965e-03, 8.8306e-02, 3.2486e-02, 8.8306e-02,
        5.9500e-04, 6.2657e-24, 1.0898e-05, 8.8306e-02, 2.0483e-17, 1.3801e-19,
        2.1889e-04, 2.7013e-08, 9.9376e-09, 1.6174e-03])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 88.16% 

Test Accuracy: 87.63% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6504054479300976
distance x is tensor(104.4326, device='cuda:0')
benign distance is  tensor(104.4326, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8633471447974443
distance x is tensor(119.3107, device='cuda:0')
benign distance is  tensor(119.3107, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5902997823432088
distance x is tensor(93.9260, device='cuda:0')
benign distance is  tensor(93.9260, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.963278278708458
distance x is tensor(138.9285, device='cuda:0')
benign distance is  tensor(138.9285, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9104921240359545
distance x is tensor(67.9823, device='cuda:0')
benign distance is  tensor(67.9823, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6206660708412528
distance x is tensor(100.1534, device='cuda:0')
benign distance is  tensor(100.1534, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0423776544630527
distance x is tensor(85.2568, device='cuda:0')
benign distance is  tensor(85.2568, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.688028996810317
distance x is tensor(72.1488, device='cuda:0')
benign distance is  tensor(72.1488, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7720087543129921
distance x is tensor(94.7737, device='cuda:0')
benign distance is  tensor(94.7737, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6420477125793695
distance x is tensor(97.9189, device='cuda:0')
benign distance is  tensor(97.9189, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.100589856505394
distance x is tensor(62.3578, device='cuda:0')
benign distance is  tensor(62.3578, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.28245360404253
distance x is tensor(117.6061, device='cuda:0')
benign distance is  tensor(117.6061, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9632482603192329
distance x is tensor(156.6287, device='cuda:0')
benign distance is  tensor(156.6287, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6416060011833906
distance x is tensor(59.8465, device='cuda:0')
benign distance is  tensor(59.8465, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7616633125580847
distance x is tensor(132.6270, device='cuda:0')
benign distance is  tensor(132.6270, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.4509547799825668
distance x is tensor(116.0274, device='cuda:0')
benign distance is  tensor(116.0274, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.0604677479714155
distance x is tensor(91.4566, device='cuda:0')
benign distance is  tensor(91.4566, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.636919854208827
distance x is tensor(113.7584, device='cuda:0')
benign distance is  tensor(113.7584, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9361572731286287
distance x is tensor(105.4156, device='cuda:0')
benign distance is  tensor(105.4156, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9531172290444374
distance x is tensor(114.8810, device='cuda:0')
benign distance is  tensor(114.8810, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.902032608166337
distance x is tensor(66.9756, device='cuda:0')
benign distance is  tensor(66.9756, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7819465743377805
distance x is tensor(199.4202, device='cuda:0')
benign distance is  tensor(199.4202, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.9726833403110504
distance x is tensor(129.6583, device='cuda:0')
benign distance is  tensor(129.6583, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5575602473691106
distance x is tensor(101.0671, device='cuda:0')
benign distance is  tensor(101.0671, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9911158494651318
distance x is tensor(111.3666, device='cuda:0')
benign distance is  tensor(111.3666, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6021195976063609
distance x is tensor(73.8920, device='cuda:0')
benign distance is  tensor(73.8920, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.7718030828982592
distance x is tensor(119.9261, device='cuda:0')
benign distance is  tensor(119.9261, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.1536575239151716
distance x is tensor(110.4921, device='cuda:0')
benign distance is  tensor(110.4921, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.81800651922822
distance x is tensor(106.7292, device='cuda:0')
benign distance is  tensor(106.7292, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7522923089563847
distance x is tensor(87.7460, device='cuda:0')
benign distance is  tensor(87.7460, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5073521621525288
distance x is tensor(108.5727, device='cuda:0')
benign distance is  tensor(108.5727, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7124999072402716
distance x is tensor(160.7257, device='cuda:0')
benign distance is  tensor(160.7257, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.7591826263815165
distance x is tensor(108.6700, device='cuda:0')
benign distance is  tensor(108.6700, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.7169509418308735
distance x is tensor(155.5038, device='cuda:0')
benign distance is  tensor(155.5038, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.1120084412395954
distance x is tensor(135.3934, device='cuda:0')
benign distance is  tensor(135.3934, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.8082612939178944
distance x is tensor(81.7463, device='cuda:0')
benign distance is  tensor(81.7463, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6777393780648708
distance x is tensor(148.4689, device='cuda:0')
benign distance is  tensor(148.4689, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7529864776879549
distance x is tensor(123.1157, device='cuda:0')
benign distance is  tensor(123.1157, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.792797202244401
distance x is tensor(97.2395, device='cuda:0')
benign distance is  tensor(97.2395, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5910532176494598
distance x is tensor(116.6910, device='cuda:0')
benign distance is  tensor(116.6910, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.85300000016
mal_loss is 0.5241275671869516
mal_entropy is 0.2200795728713274
user_PLR len size 28
counter_tensor is  tensor([12., 12., 13., 22., 12.,  0., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 25., 12., 12., 27., 12., 22., 12.])
count_res tensor([2.6623e-07, 2.6623e-07, 7.2369e-07, 5.8641e-03, 2.6623e-07, 1.6358e-12,
        2.6623e-07, 2.6623e-07, 1.4536e-05, 1.4536e-05, 1.4536e-05, 1.4536e-05,
        1.4536e-05, 1.4536e-05, 1.4536e-05, 1.4536e-05, 1.4536e-05, 1.4536e-05,
        1.4536e-05, 1.4536e-05, 2.6623e-07, 1.1778e-01, 2.6623e-07, 2.6623e-07,
        8.7031e-01, 2.6623e-07, 5.8641e-03, 2.6623e-07])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 91.57% 

Test Accuracy: 82.22% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7139931349083781
distance x is tensor(120.8343, device='cuda:0')
benign distance is  tensor(120.8343, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7900421563535929
distance x is tensor(117.2276, device='cuda:0')
benign distance is  tensor(117.2276, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7805199734866619
distance x is tensor(114.7681, device='cuda:0')
benign distance is  tensor(114.7681, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0129941999912262
distance x is tensor(159.5671, device='cuda:0')
benign distance is  tensor(159.5671, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1370085626840591
distance x is tensor(104.0109, device='cuda:0')
benign distance is  tensor(104.0109, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.852800143416971
distance x is tensor(120.5191, device='cuda:0')
benign distance is  tensor(120.5191, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2760904263705015
distance x is tensor(109.5461, device='cuda:0')
benign distance is  tensor(109.5461, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6629939377307892
distance x is tensor(101.7141, device='cuda:0')
benign distance is  tensor(101.7141, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.9395998045802116
distance x is tensor(128.0731, device='cuda:0')
benign distance is  tensor(128.0731, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.9796826709061861
distance x is tensor(111.8001, device='cuda:0')
benign distance is  tensor(111.8001, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6546169519424438
distance x is tensor(162.9989, device='cuda:0')
benign distance is  tensor(162.9989, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.7264448776841164
distance x is tensor(151.2442, device='cuda:0')
benign distance is  tensor(151.2442, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8560462100431323
distance x is tensor(52.6678, device='cuda:0')
benign distance is  tensor(52.6678, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.906654505059123
distance x is tensor(96.6905, device='cuda:0')
benign distance is  tensor(96.6905, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7404092578217387
distance x is tensor(101.5837, device='cuda:0')
benign distance is  tensor(101.5837, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.77677340246737
distance x is tensor(122.6762, device='cuda:0')
benign distance is  tensor(122.6762, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.70400000016
mal_loss is 1.8302240297198296
mal_entropy is 0.1566807245835662
user_PLR len size 28
counter_tensor is  tensor([ 0., 12., 22., 20., 25., 13., 12., 26., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 15., 24., 25., 12., 12., 26., 12., 25.])
count_res tensor([1.5670e-12, 2.5504e-07, 5.6177e-03, 7.6028e-04, 1.1283e-01, 6.9328e-07,
        2.5504e-07, 3.0672e-01, 1.3925e-05, 1.3925e-05, 1.3925e-05, 1.3925e-05,
        1.3925e-05, 1.3925e-05, 1.3925e-05, 1.3925e-05, 1.3925e-05, 1.3925e-05,
        1.3925e-05, 1.3925e-05, 5.1227e-06, 4.1510e-02, 1.1283e-01, 2.5504e-07,
        2.5504e-07, 3.0672e-01, 2.5504e-07, 1.1283e-01])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 87.03% 

Test Accuracy: 86.93% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8052276987582445
distance x is tensor(132.1644, device='cuda:0')
benign distance is  tensor(132.1644, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.72979218326509
distance x is tensor(108.8789, device='cuda:0')
benign distance is  tensor(108.8789, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6452224412932992
distance x is tensor(106.6351, device='cuda:0')
benign distance is  tensor(106.6351, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8118832278996706
distance x is tensor(154.1157, device='cuda:0')
benign distance is  tensor(154.1157, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.970548851415515
distance x is tensor(82.6374, device='cuda:0')
benign distance is  tensor(82.6374, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6565581886097789
distance x is tensor(105.3725, device='cuda:0')
benign distance is  tensor(105.3725, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.272040769457817
distance x is tensor(95.4294, device='cuda:0')
benign distance is  tensor(95.4294, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6788465417921543
distance x is tensor(65.3606, device='cuda:0')
benign distance is  tensor(65.3606, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9155155699700117
distance x is tensor(94.8522, device='cuda:0')
benign distance is  tensor(94.8522, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6886614332906902
distance x is tensor(107.9076, device='cuda:0')
benign distance is  tensor(107.9076, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0227748844772577
distance x is tensor(71.9453, device='cuda:0')
benign distance is  tensor(71.9453, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.142548717558384
distance x is tensor(113.4667, device='cuda:0')
benign distance is  tensor(113.4667, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1059004701673985
distance x is tensor(158.8864, device='cuda:0')
benign distance is  tensor(158.8864, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7000148314982653
distance x is tensor(38.8075, device='cuda:0')
benign distance is  tensor(38.8075, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.828238558024168
distance x is tensor(139.6357, device='cuda:0')
benign distance is  tensor(139.6357, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.114107334986329
distance x is tensor(115.3069, device='cuda:0')
benign distance is  tensor(115.3069, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.82000000016
mal_loss is 0.9935049936175346
mal_entropy is 0.11488554952666163
user_PLR len size 28
counter_tensor is  tensor([13., 13., 12., 21., 25., 20.,  0., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 21., 12., 26., 12., 14., 16., 19.])
count_res tensor([1.6316e-06, 1.6316e-06, 6.0023e-07, 4.8637e-03, 2.6555e-01, 1.7893e-03,
        3.6879e-12, 6.0023e-07, 3.2771e-05, 3.2771e-05, 3.2771e-05, 3.2771e-05,
        3.2771e-05, 3.2771e-05, 3.2771e-05, 3.2771e-05, 3.2771e-05, 3.2771e-05,
        3.2771e-05, 3.2771e-05, 6.0023e-07, 4.8637e-03, 6.0023e-07, 7.2184e-01,
        6.0023e-07, 4.4351e-06, 3.2771e-05, 6.5823e-04])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 83.40% 

Test Accuracy: 80.00% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7344775097444654
distance x is tensor(130.6398, device='cuda:0')
benign distance is  tensor(130.6398, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.819315617904067
distance x is tensor(114.6025, device='cuda:0')
benign distance is  tensor(114.6025, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8249149471521378
distance x is tensor(116.6757, device='cuda:0')
benign distance is  tensor(116.6757, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8206857573240995
distance x is tensor(153.8187, device='cuda:0')
benign distance is  tensor(153.8187, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9218659899197519
distance x is tensor(102.9534, device='cuda:0')
benign distance is  tensor(102.9534, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7261351477354765
distance x is tensor(115.9418, device='cuda:0')
benign distance is  tensor(115.9418, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4660698287189007
distance x is tensor(103.5005, device='cuda:0')
benign distance is  tensor(103.5005, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6930581796914339
distance x is tensor(101.1480, device='cuda:0')
benign distance is  tensor(101.1480, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.4803222119808197
distance x is tensor(123.1080, device='cuda:0')
benign distance is  tensor(123.1080, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7049504742026329
distance x is tensor(123.5252, device='cuda:0')
benign distance is  tensor(123.5252, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9894370250403881
distance x is tensor(110.0019, device='cuda:0')
benign distance is  tensor(110.0019, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8924876265227795
distance x is tensor(85.8976, device='cuda:0')
benign distance is  tensor(85.8976, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0469016153365374
distance x is tensor(78.0865, device='cuda:0')
benign distance is  tensor(78.0865, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7581981979310513
distance x is tensor(205.1213, device='cuda:0')
benign distance is  tensor(205.1213, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.2973378971219063
distance x is tensor(158.3346, device='cuda:0')
benign distance is  tensor(158.3346, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7689397968351841
distance x is tensor(114.6496, device='cuda:0')
benign distance is  tensor(114.6496, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.65600000016
mal_loss is 2.1249673552811146
mal_entropy is 0.16799543425440788
user_PLR len size 36
counter_tensor is  tensor([ 0., 30.,  1., 31., 32., 27., 35., 25., 23., 23., 23., 23., 23., 23.,
        23., 23., 23., 23., 23., 23., 35., 31.,  5., 33., 32., 19., 16., 35.,
        20.,  0., 35., 26., 30., 35., 27.,  0.])
count_res tensor([1.1928e-16, 1.2747e-03, 3.2424e-16, 3.4650e-03, 9.4188e-03, 6.3463e-05,
        1.8918e-01, 8.5888e-06, 1.1624e-06, 1.1624e-06, 1.1624e-06, 1.1624e-06,
        1.1624e-06, 1.1624e-06, 1.1624e-06, 1.1624e-06, 1.1624e-06, 1.1624e-06,
        1.1624e-06, 1.1624e-06, 1.8918e-01, 3.4650e-03, 1.7703e-14, 2.5603e-02,
        9.4188e-03, 2.1290e-08, 1.0599e-09, 1.8918e-01, 5.7871e-08, 1.1928e-16,
        1.8918e-01, 2.3347e-05, 1.2747e-03, 1.8918e-01, 6.3463e-05, 1.1928e-16])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 82.42% 

Test Accuracy: 85.21% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7588825989514589
distance x is tensor(112.4060, device='cuda:0')
benign distance is  tensor(112.4060, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8158142385073006
distance x is tensor(108.0407, device='cuda:0')
benign distance is  tensor(108.0407, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7720842435956001
distance x is tensor(118.4160, device='cuda:0')
benign distance is  tensor(118.4160, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0350031293928623
distance x is tensor(148.6415, device='cuda:0')
benign distance is  tensor(148.6415, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7724079829640687
distance x is tensor(90.3605, device='cuda:0')
benign distance is  tensor(90.3605, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8265509214252234
distance x is tensor(116.7899, device='cuda:0')
benign distance is  tensor(116.7899, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9931116681545973
distance x is tensor(81.7443, device='cuda:0')
benign distance is  tensor(81.7443, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7088316036388278
distance x is tensor(86.4985, device='cuda:0')
benign distance is  tensor(86.4985, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9151592887938023
distance x is tensor(96.0189, device='cuda:0')
benign distance is  tensor(96.0189, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6941032689064741
distance x is tensor(106.8995, device='cuda:0')
benign distance is  tensor(106.8995, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8829971011728048
distance x is tensor(51.9241, device='cuda:0')
benign distance is  tensor(51.9241, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.277388073503971
distance x is tensor(114.7087, device='cuda:0')
benign distance is  tensor(114.7087, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8074059672653675
distance x is tensor(153.8423, device='cuda:0')
benign distance is  tensor(153.8423, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7047245986759663
distance x is tensor(53.0523, device='cuda:0')
benign distance is  tensor(53.0523, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.950622197240591
distance x is tensor(148.9950, device='cuda:0')
benign distance is  tensor(148.9950, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2568955160677433
distance x is tensor(114.9727, device='cuda:0')
benign distance is  tensor(114.9727, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9135654326528311
distance x is tensor(103.6850, device='cuda:0')
benign distance is  tensor(103.6850, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.065646231174469
distance x is tensor(136.0678, device='cuda:0')
benign distance is  tensor(136.0678, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.3168325871229172
distance x is tensor(119.6372, device='cuda:0')
benign distance is  tensor(119.6372, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2969815842807293
distance x is tensor(113.0343, device='cuda:0')
benign distance is  tensor(113.0343, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.767877297475934
distance x is tensor(122.6927, device='cuda:0')
benign distance is  tensor(122.6927, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7579190395772457
distance x is tensor(99.9681, device='cuda:0')
benign distance is  tensor(99.9681, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5030351625755429
distance x is tensor(121.6250, device='cuda:0')
benign distance is  tensor(121.6250, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6567398300394416
distance x is tensor(164.5981, device='cuda:0')
benign distance is  tensor(164.5981, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8050000001600001
mal_loss is 1.2389144599437714
mal_entropy is 0.13408825360238552
user_PLR len size 20
counter_tensor is  tensor([12., 12., 17., 12., 12., 18., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7526e-05, 2.7526e-05, 4.0852e-03, 2.7526e-05, 2.7526e-05, 1.1105e-02,
        2.7526e-05, 2.7526e-05, 8.2054e-02, 8.2054e-02, 8.2054e-02, 8.2054e-02,
        8.2054e-02, 8.2054e-02, 8.2054e-02, 8.2054e-02, 8.2054e-02, 8.2054e-02,
        8.2054e-02, 8.2054e-02])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 85.41% 

Test Accuracy: 80.59% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7378066908568144
distance x is tensor(145.8426, device='cuda:0')
benign distance is  tensor(145.8426, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8933709673583508
distance x is tensor(129.6671, device='cuda:0')
benign distance is  tensor(129.6671, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7681866865605116
distance x is tensor(130.8662, device='cuda:0')
benign distance is  tensor(130.8662, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.805672625079751
distance x is tensor(169.7464, device='cuda:0')
benign distance is  tensor(169.7464, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9558029863983393
distance x is tensor(121.2193, device='cuda:0')
benign distance is  tensor(121.2193, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7221929132938385
distance x is tensor(124.0060, device='cuda:0')
benign distance is  tensor(124.0060, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1208398900926113
distance x is tensor(85.2338, device='cuda:0')
benign distance is  tensor(85.2338, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7444740049540997
distance x is tensor(106.2669, device='cuda:0')
benign distance is  tensor(106.2669, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.53600000016
mal_loss is 10.505811870098114
mal_entropy is 0.10068858065642416
user_PLR len size 52
counter_tensor is  tensor([33., 46., 44., 50., 51., 17., 12., 51., 15., 15., 15., 15., 15., 15.,
        15., 15., 15., 15., 15., 15., 50., 10., 40., 51., 33., 49.,  1., 51.,
        51., 33.,  6., 48., 25., 51., 51.,  0.,  5.,  4., 51., 14., 37., 47.,
         7., 46., 47.,  1., 50., 50., 44., 50.,  0., 46.])
count_res tensor([1.5104e-09, 6.6823e-04, 9.0436e-05, 3.6484e-02, 9.9175e-02, 1.6998e-16,
        1.1453e-18, 9.9175e-02, 2.3004e-17, 2.3004e-17, 2.3004e-17, 2.3004e-17,
        2.3004e-17, 2.3004e-17, 2.3004e-17, 2.3004e-17, 2.3004e-17, 2.3004e-17,
        2.3004e-17, 2.3004e-17, 3.6484e-02, 1.5500e-19, 1.6564e-06, 9.9175e-02,
        1.5104e-09, 1.3422e-02, 1.9128e-23, 9.9175e-02, 9.9175e-02, 1.5104e-09,
        2.8389e-21, 4.9376e-03, 5.0669e-13, 9.9175e-02, 9.9175e-02, 7.0369e-24,
        1.0444e-21, 3.8420e-22, 9.9175e-02, 8.4626e-18, 8.2467e-08, 1.8164e-03,
        7.7169e-21, 6.6823e-04, 1.8164e-03, 1.9128e-23, 3.6484e-02, 3.6484e-02,
        9.0436e-05, 3.6484e-02, 7.0369e-24, 6.6823e-04])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 90.02% 

Test Accuracy: 88.01% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7715105321258307
distance x is tensor(119.2562, device='cuda:0')
benign distance is  tensor(119.2562, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8099529258906841
distance x is tensor(94.2414, device='cuda:0')
benign distance is  tensor(94.2414, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6483860593289137
distance x is tensor(101.5172, device='cuda:0')
benign distance is  tensor(101.5172, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8764811214059591
distance x is tensor(146.4215, device='cuda:0')
benign distance is  tensor(146.4215, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.007225163280964
distance x is tensor(81.0547, device='cuda:0')
benign distance is  tensor(81.0547, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8074999842792749
distance x is tensor(104.5352, device='cuda:0')
benign distance is  tensor(104.5352, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1692977882921696
distance x is tensor(92.3811, device='cuda:0')
benign distance is  tensor(92.3811, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6263404572382569
distance x is tensor(67.9114, device='cuda:0')
benign distance is  tensor(67.9114, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0294770207256079
distance x is tensor(93.0125, device='cuda:0')
benign distance is  tensor(93.0125, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5705139795318246
distance x is tensor(102.7957, device='cuda:0')
benign distance is  tensor(102.7957, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9149086195975542
distance x is tensor(55.8416, device='cuda:0')
benign distance is  tensor(55.8416, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0340249929577112
distance x is tensor(110.6582, device='cuda:0')
benign distance is  tensor(110.6582, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.117508452385664
distance x is tensor(191.8131, device='cuda:0')
benign distance is  tensor(191.8131, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5632019136101007
distance x is tensor(68.4501, device='cuda:0')
benign distance is  tensor(68.4501, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8170700874179602
distance x is tensor(141.4974, device='cuda:0')
benign distance is  tensor(141.4974, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1882485561072826
distance x is tensor(112.4129, device='cuda:0')
benign distance is  tensor(112.4129, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.9381940104067326
distance x is tensor(94.3992, device='cuda:0')
benign distance is  tensor(94.3992, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8569469377398491
distance x is tensor(125.8138, device='cuda:0')
benign distance is  tensor(125.8138, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.0931595731526613
distance x is tensor(125.4314, device='cuda:0')
benign distance is  tensor(125.4314, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.826056707650423
distance x is tensor(103.9403, device='cuda:0')
benign distance is  tensor(103.9403, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.8479050397872925
distance x is tensor(71.8831, device='cuda:0')
benign distance is  tensor(71.8831, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6316583584994078
distance x is tensor(204.2436, device='cuda:0')
benign distance is  tensor(204.2436, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.085253605619073
distance x is tensor(128.6508, device='cuda:0')
benign distance is  tensor(128.6508, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8005467522889376
distance x is tensor(95.2652, device='cuda:0')
benign distance is  tensor(95.2652, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.9094287063926458
distance x is tensor(115.6553, device='cuda:0')
benign distance is  tensor(115.6553, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.8540018312633038
distance x is tensor(95.2860, device='cuda:0')
benign distance is  tensor(95.2860, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6447136700153351
distance x is tensor(155.9716, device='cuda:0')
benign distance is  tensor(155.9716, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.9924199040979147
distance x is tensor(128.5895, device='cuda:0')
benign distance is  tensor(128.5895, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6478454023599625
distance x is tensor(73.5470, device='cuda:0')
benign distance is  tensor(73.5470, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7517766039818525
distance x is tensor(89.1794, device='cuda:0')
benign distance is  tensor(89.1794, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.6344769010320306
distance x is tensor(86.0389, device='cuda:0')
benign distance is  tensor(86.0389, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7105434965342283
distance x is tensor(117.9401, device='cuda:0')
benign distance is  tensor(117.9401, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.0982383470982313
distance x is tensor(99.2961, device='cuda:0')
benign distance is  tensor(99.2961, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.2437968291342258
distance x is tensor(134.5639, device='cuda:0')
benign distance is  tensor(134.5639, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.1973757948726416
distance x is tensor(137.1102, device='cuda:0')
benign distance is  tensor(137.1102, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.8986438196152449
distance x is tensor(75.4222, device='cuda:0')
benign distance is  tensor(75.4222, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.612477770075202
distance x is tensor(152.1897, device='cuda:0')
benign distance is  tensor(152.1897, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8119006920605898
distance x is tensor(130.2275, device='cuda:0')
benign distance is  tensor(130.2275, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.0401682313531637
distance x is tensor(101.2394, device='cuda:0')
benign distance is  tensor(101.2394, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5715945493429899
distance x is tensor(119.2645, device='cuda:0')
benign distance is  tensor(119.2645, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.86500000016
mal_loss is 0.4787479150108993
mal_entropy is 0.1856155451387167
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 93.81% 

Test Accuracy: 86.84% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7003566902130842
distance x is tensor(136.6489, device='cuda:0')
benign distance is  tensor(136.6489, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2994808852672577
distance x is tensor(128.0044, device='cuda:0')
benign distance is  tensor(128.0044, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.695483373478055
distance x is tensor(121.4478, device='cuda:0')
benign distance is  tensor(121.4478, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8206409215927124
distance x is tensor(160.4732, device='cuda:0')
benign distance is  tensor(160.4732, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8653306439518929
distance x is tensor(86.0643, device='cuda:0')
benign distance is  tensor(86.0643, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.548384708352387
distance x is tensor(109.0931, device='cuda:0')
benign distance is  tensor(109.0931, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0913957748562098
distance x is tensor(101.0946, device='cuda:0')
benign distance is  tensor(101.0946, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6646198304370046
distance x is tensor(89.4407, device='cuda:0')
benign distance is  tensor(89.4407, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.56700000016
mal_loss is 5.4134183675050735
mal_entropy is 0.20567393396049738
user_PLR len size 36
counter_tensor is  tensor([ 2.,  2., 34., 28., 32., 34., 35., 33., 10., 10., 10., 10., 10., 10.,
        10., 10., 10., 10., 10., 10., 35., 13., 35., 12., 35., 35., 35., 29.,
         2., 34., 35., 22., 35., 35., 28., 25.])
count_res tensor([4.5262e-16, 4.5262e-16, 3.5740e-02, 8.8591e-05, 4.8369e-03, 3.5740e-02,
        9.7152e-02, 1.3148e-02, 1.3492e-12, 1.3492e-12, 1.3492e-12, 1.3492e-12,
        1.3492e-12, 1.3492e-12, 1.3492e-12, 1.3492e-12, 1.3492e-12, 1.3492e-12,
        1.3492e-12, 1.3492e-12, 9.7152e-02, 2.7100e-11, 9.7152e-02, 9.9697e-12,
        9.7152e-02, 9.7152e-02, 9.7152e-02, 2.4082e-04, 4.5262e-16, 3.5740e-02,
        9.7152e-02, 2.1960e-07, 9.7152e-02, 9.7152e-02, 8.8591e-05, 4.4107e-06])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 89.21% 

Test Accuracy: 87.01% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6288500521332026
distance x is tensor(115.8278, device='cuda:0')
benign distance is  tensor(115.8278, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8615287896245718
distance x is tensor(105.0846, device='cuda:0')
benign distance is  tensor(105.0846, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8045471329241991
distance x is tensor(105.9819, device='cuda:0')
benign distance is  tensor(105.9819, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0199337024241686
distance x is tensor(148.4778, device='cuda:0')
benign distance is  tensor(148.4778, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8632170855998993
distance x is tensor(80.8278, device='cuda:0')
benign distance is  tensor(80.8278, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7664415831677616
distance x is tensor(105.0302, device='cuda:0')
benign distance is  tensor(105.0302, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9560478590428829
distance x is tensor(82.5561, device='cuda:0')
benign distance is  tensor(82.5561, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6089899530634284
distance x is tensor(78.0908, device='cuda:0')
benign distance is  tensor(78.0908, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8598521240055561
distance x is tensor(93.2017, device='cuda:0')
benign distance is  tensor(93.2017, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6457947455346584
distance x is tensor(129.3828, device='cuda:0')
benign distance is  tensor(129.3828, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0857992451637983
distance x is tensor(48.9027, device='cuda:0')
benign distance is  tensor(48.9027, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4632175005972385
distance x is tensor(113.6241, device='cuda:0')
benign distance is  tensor(113.6241, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0321209225803614
distance x is tensor(164.4458, device='cuda:0')
benign distance is  tensor(164.4458, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6742532877251506
distance x is tensor(42.1947, device='cuda:0')
benign distance is  tensor(42.1947, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8990756534039974
distance x is tensor(138.9538, device='cuda:0')
benign distance is  tensor(138.9538, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.459802869707346
distance x is tensor(114.0184, device='cuda:0')
benign distance is  tensor(114.0184, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9645452760159969
distance x is tensor(93.4438, device='cuda:0')
benign distance is  tensor(93.4438, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6111985817551613
distance x is tensor(72.9344, device='cuda:0')
benign distance is  tensor(72.9344, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8458175398409367
distance x is tensor(117.5111, device='cuda:0')
benign distance is  tensor(117.5111, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2480365335941315
distance x is tensor(106.7890, device='cuda:0')
benign distance is  tensor(106.7890, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6821369156241417
distance x is tensor(114.6444, device='cuda:0')
benign distance is  tensor(114.6444, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9239776581525803
distance x is tensor(97.7667, device='cuda:0')
benign distance is  tensor(97.7667, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.48538663797080517
distance x is tensor(105.2993, device='cuda:0')
benign distance is  tensor(105.2993, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6396730020642281
distance x is tensor(161.2200, device='cuda:0')
benign distance is  tensor(161.2200, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.82500000016
mal_loss is 0.907957493327558
mal_entropy is 0.16305420733988285
user_PLR len size 28
counter_tensor is  tensor([12., 13., 26., 12.,  0., 22., 21., 13., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 13., 13., 27., 14., 12., 13., 27., 26.])
count_res tensor([1.1143e-07, 3.0290e-07, 1.3401e-01, 1.1143e-07, 6.8466e-13, 2.4545e-03,
        9.0295e-04, 3.0290e-07, 6.0840e-06, 6.0840e-06, 6.0840e-06, 6.0840e-06,
        6.0840e-06, 6.0840e-06, 6.0840e-06, 6.0840e-06, 6.0840e-06, 6.0840e-06,
        6.0840e-06, 6.0840e-06, 3.0290e-07, 3.0290e-07, 3.6427e-01, 8.2338e-07,
        1.1143e-07, 3.0290e-07, 3.6427e-01, 1.3401e-01])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 84.54% 

Test Accuracy: 85.57% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6486646663397551
distance x is tensor(125.7223, device='cuda:0')
benign distance is  tensor(125.7223, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8994924519211054
distance x is tensor(107.4874, device='cuda:0')
benign distance is  tensor(107.4874, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9332490414381027
distance x is tensor(103.5414, device='cuda:0')
benign distance is  tensor(103.5414, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9781685629859567
distance x is tensor(154.4186, device='cuda:0')
benign distance is  tensor(154.4186, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8737586988136172
distance x is tensor(84.9102, device='cuda:0')
benign distance is  tensor(84.9102, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7442156998440623
distance x is tensor(103.9444, device='cuda:0')
benign distance is  tensor(103.9444, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9711475893855095
distance x is tensor(94.4227, device='cuda:0')
benign distance is  tensor(94.4227, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7492673750966787
distance x is tensor(84.0736, device='cuda:0')
benign distance is  tensor(84.0736, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.0461092069745064
distance x is tensor(108.0808, device='cuda:0')
benign distance is  tensor(108.0808, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8581197820603848
distance x is tensor(118.5265, device='cuda:0')
benign distance is  tensor(118.5265, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8021378293633461
distance x is tensor(95.0334, device='cuda:0')
benign distance is  tensor(95.0334, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8667767811566591
distance x is tensor(122.3737, device='cuda:0')
benign distance is  tensor(122.3737, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.8819239567965269
distance x is tensor(78.1164, device='cuda:0')
benign distance is  tensor(78.1164, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6707118507474661
distance x is tensor(207.7965, device='cuda:0')
benign distance is  tensor(207.7965, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.260882444679737
distance x is tensor(125.8688, device='cuda:0')
benign distance is  tensor(125.8688, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8640450146049261
distance x is tensor(119.9188, device='cuda:0')
benign distance is  tensor(119.9188, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.79100000016
mal_loss is 1.0466200094670057
mal_entropy is 0.16806985577568412
user_PLR len size 28
counter_tensor is  tensor([12., 12., 16., 12., 16., 27., 12.,  0., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 23., 27., 26., 27., 26., 26., 18., 12.])
count_res tensor([7.4206e-08, 7.4206e-08, 4.0515e-06, 7.4206e-08, 4.0515e-06, 2.4258e-01,
        7.4206e-08, 4.5594e-13, 4.0515e-06, 4.0515e-06, 4.0515e-06, 4.0515e-06,
        4.0515e-06, 4.0515e-06, 4.0515e-06, 4.0515e-06, 4.0515e-06, 4.0515e-06,
        4.0515e-06, 4.0515e-06, 4.4430e-03, 2.4258e-01, 8.9241e-02, 2.4258e-01,
        8.9241e-02, 8.9241e-02, 2.9937e-05, 7.4206e-08])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 86.97% 

Test Accuracy: 86.67% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.725308109074831
distance x is tensor(112.9262, device='cuda:0')
benign distance is  tensor(112.9262, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8519187420606613
distance x is tensor(108.6392, device='cuda:0')
benign distance is  tensor(108.6392, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7867574244737625
distance x is tensor(108.0226, device='cuda:0')
benign distance is  tensor(108.0226, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0763146039098501
distance x is tensor(146.2154, device='cuda:0')
benign distance is  tensor(146.2154, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0086154974997044
distance x is tensor(87.8479, device='cuda:0')
benign distance is  tensor(87.8479, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6592283975332975
distance x is tensor(89.5276, device='cuda:0')
benign distance is  tensor(89.5276, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1482944525778294
distance x is tensor(86.3166, device='cuda:0')
benign distance is  tensor(86.3166, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7354116849601269
distance x is tensor(81.8882, device='cuda:0')
benign distance is  tensor(81.8882, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7883129511028528
distance x is tensor(103.2681, device='cuda:0')
benign distance is  tensor(103.2681, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6423093024641275
distance x is tensor(117.2722, device='cuda:0')
benign distance is  tensor(117.2722, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9465293493121862
distance x is tensor(51.9403, device='cuda:0')
benign distance is  tensor(51.9403, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.302474532276392
distance x is tensor(123.5172, device='cuda:0')
benign distance is  tensor(123.5172, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8356666751205921
distance x is tensor(156.8916, device='cuda:0')
benign distance is  tensor(156.8916, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.726475590839982
distance x is tensor(48.1347, device='cuda:0')
benign distance is  tensor(48.1347, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0109050422906876
distance x is tensor(135.4291, device='cuda:0')
benign distance is  tensor(135.4291, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1644625701010227
distance x is tensor(117.6412, device='cuda:0')
benign distance is  tensor(117.6412, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.83800000016
mal_loss is 0.9970490280538797
mal_entropy is 0.10530605493113399
user_PLR len size 28
counter_tensor is  tensor([13.,  0., 12., 12., 12., 23., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 13., 12., 17., 12., 25., 23., 18.])
count_res tensor([4.8249e-06, 1.0906e-11, 1.7750e-06, 1.7750e-06, 1.7750e-06, 1.0628e-01,
        1.7750e-06, 1.7750e-06, 9.6911e-05, 9.6911e-05, 9.6911e-05, 9.6911e-05,
        9.6911e-05, 9.6911e-05, 9.6911e-05, 9.6911e-05, 9.6911e-05, 9.6911e-05,
        9.6911e-05, 9.6911e-05, 1.7750e-06, 4.8249e-06, 1.7750e-06, 2.6343e-04,
        1.7750e-06, 7.8528e-01, 1.0628e-01, 7.1608e-04])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 86.16% 

Test Accuracy: 85.06% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6375255286693573
distance x is tensor(123.9914, device='cuda:0')
benign distance is  tensor(123.9914, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8181578610092402
distance x is tensor(116.7927, device='cuda:0')
benign distance is  tensor(116.7927, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7538474127650261
distance x is tensor(119.4901, device='cuda:0')
benign distance is  tensor(119.4901, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0498044155538082
distance x is tensor(165.4867, device='cuda:0')
benign distance is  tensor(165.4867, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8858135649934411
distance x is tensor(86.0691, device='cuda:0')
benign distance is  tensor(86.0691, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6602448667399585
distance x is tensor(113.4030, device='cuda:0')
benign distance is  tensor(113.4030, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2521079406142235
distance x is tensor(104.5183, device='cuda:0')
benign distance is  tensor(104.5183, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9281533099710941
distance x is tensor(89.4639, device='cuda:0')
benign distance is  tensor(89.4639, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8010958023369312
distance x is tensor(119.7965, device='cuda:0')
benign distance is  tensor(119.7965, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.8656483115628362
distance x is tensor(113.0102, device='cuda:0')
benign distance is  tensor(113.0102, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6852236166596413
distance x is tensor(153.8884, device='cuda:0')
benign distance is  tensor(153.8884, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.1407772488892078
distance x is tensor(129.9018, device='cuda:0')
benign distance is  tensor(129.9018, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8428185787051916
distance x is tensor(100.6263, device='cuda:0')
benign distance is  tensor(100.6263, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8514705197885633
distance x is tensor(41.2074, device='cuda:0')
benign distance is  tensor(41.2074, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.6886699665337801
distance x is tensor(94.8619, device='cuda:0')
benign distance is  tensor(94.8619, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8860541433095932
distance x is tensor(129.0528, device='cuda:0')
benign distance is  tensor(129.0528, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.74900000016
mal_loss is 2.0423310175538063
mal_entropy is 0.11356510501354933
user_PLR len size 52
counter_tensor is  tensor([32., 13., 51., 46.,  2., 41., 45., 44., 15., 15., 15., 15., 15., 15.,
        15., 15., 15., 15., 15., 15., 51., 12., 39., 51.,  0., 22., 51.,  9.,
        43., 51., 46., 51., 50., 51., 49., 10.,  1.,  6., 26., 51., 28., 50.,
         1., 48., 43., 48., 50., 48.,  1., 50.,  2., 32.])
count_res tensor([5.7325e-10, 3.2118e-18, 1.0231e-01, 6.8939e-04, 5.3642e-23, 4.6451e-06,
        2.5361e-04, 9.3299e-05, 2.3732e-17, 2.3732e-17, 2.3732e-17, 2.3732e-17,
        2.3732e-17, 2.3732e-17, 2.3732e-17, 2.3732e-17, 2.3732e-17, 2.3732e-17,
        2.3732e-17, 2.3732e-17, 1.0231e-01, 1.1815e-18, 6.2864e-07, 1.0231e-01,
        7.2597e-24, 2.6025e-14, 1.0231e-01, 5.8826e-20, 3.4323e-05, 1.0231e-01,
        6.8939e-04, 1.0231e-01, 3.7639e-02, 1.0231e-01, 1.3847e-02, 1.5991e-19,
        1.9734e-23, 2.9288e-21, 1.4209e-12, 1.0231e-01, 1.0499e-11, 3.7639e-02,
        1.9734e-23, 5.0939e-03, 3.4323e-05, 5.0939e-03, 3.7639e-02, 5.0939e-03,
        1.9734e-23, 3.7639e-02, 5.3642e-23, 5.7325e-10])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 89.20% 

Test Accuracy: 87.94% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6524443067610264
distance x is tensor(106.2968, device='cuda:0')
benign distance is  tensor(106.2968, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8268574848771095
distance x is tensor(104.0098, device='cuda:0')
benign distance is  tensor(104.0098, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7348323073238134
distance x is tensor(100.8098, device='cuda:0')
benign distance is  tensor(100.8098, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9352440126240253
distance x is tensor(142.5043, device='cuda:0')
benign distance is  tensor(142.5043, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7728583896532655
distance x is tensor(86.9319, device='cuda:0')
benign distance is  tensor(86.9319, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.748671961016953
distance x is tensor(100.4463, device='cuda:0')
benign distance is  tensor(100.4463, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0755415298044682
distance x is tensor(84.9992, device='cuda:0')
benign distance is  tensor(84.9992, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6011584317311645
distance x is tensor(76.9483, device='cuda:0')
benign distance is  tensor(76.9483, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9269761573523283
distance x is tensor(100.1739, device='cuda:0')
benign distance is  tensor(100.1739, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5765850320458412
distance x is tensor(120.3124, device='cuda:0')
benign distance is  tensor(120.3124, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9657214898616076
distance x is tensor(52.5044, device='cuda:0')
benign distance is  tensor(52.5044, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0584775395691395
distance x is tensor(121.9672, device='cuda:0')
benign distance is  tensor(121.9672, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2398628890514374
distance x is tensor(180.4782, device='cuda:0')
benign distance is  tensor(180.4782, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5821967096999288
distance x is tensor(55.8479, device='cuda:0')
benign distance is  tensor(55.8479, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0314592719078064
distance x is tensor(127.1397, device='cuda:0')
benign distance is  tensor(127.1397, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.4063710570335388
distance x is tensor(132.1724, device='cuda:0')
benign distance is  tensor(132.1724, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.9560962356626987
distance x is tensor(104.8474, device='cuda:0')
benign distance is  tensor(104.8474, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7221897710114717
distance x is tensor(103.0926, device='cuda:0')
benign distance is  tensor(103.0926, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8984080040827394
distance x is tensor(105.0060, device='cuda:0')
benign distance is  tensor(105.0060, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8349829185754061
distance x is tensor(100.3129, device='cuda:0')
benign distance is  tensor(100.3129, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9430808089673519
distance x is tensor(72.4964, device='cuda:0')
benign distance is  tensor(72.4964, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8027675170451403
distance x is tensor(207.5622, device='cuda:0')
benign distance is  tensor(207.5622, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0810933448374271
distance x is tensor(135.1498, device='cuda:0')
benign distance is  tensor(135.1498, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7668067328631878
distance x is tensor(98.1825, device='cuda:0')
benign distance is  tensor(98.1825, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.963401235640049
distance x is tensor(98.7690, device='cuda:0')
benign distance is  tensor(98.7690, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6426553959026933
distance x is tensor(62.5548, device='cuda:0')
benign distance is  tensor(62.5548, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9128677016124129
distance x is tensor(120.3671, device='cuda:0')
benign distance is  tensor(120.3671, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2165529243648052
distance x is tensor(111.3170, device='cuda:0')
benign distance is  tensor(111.3170, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6803172184154391
distance x is tensor(105.3383, device='cuda:0')
benign distance is  tensor(105.3383, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7622846588492393
distance x is tensor(96.4815, device='cuda:0')
benign distance is  tensor(96.4815, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.614541556686163
distance x is tensor(114.2719, device='cuda:0')
benign distance is  tensor(114.2719, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6847771182656288
distance x is tensor(161.6460, device='cuda:0')
benign distance is  tensor(161.6460, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.1900340132415295
distance x is tensor(105.7309, device='cuda:0')
benign distance is  tensor(105.7309, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.2698903754353523
distance x is tensor(127.7676, device='cuda:0')
benign distance is  tensor(127.7676, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.0333113726228476
distance x is tensor(138.7361, device='cuda:0')
benign distance is  tensor(138.7361, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.990916645154357
distance x is tensor(75.5246, device='cuda:0')
benign distance is  tensor(75.5246, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7090385053306818
distance x is tensor(157.5643, device='cuda:0')
benign distance is  tensor(157.5643, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7279941523447633
distance x is tensor(123.4111, device='cuda:0')
benign distance is  tensor(123.4111, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7658849135041237
distance x is tensor(82.4111, device='cuda:0')
benign distance is  tensor(82.4111, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5792564135044813
distance x is tensor(126.0479, device='cuda:0')
benign distance is  tensor(126.0479, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.86500000016
mal_loss is 0.5204055816866457
mal_entropy is 0.1681825048290193
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 92.86% 

Test Accuracy: 86.24% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9386164229363203
distance x is tensor(143.5263, device='cuda:0')
benign distance is  tensor(143.5263, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7727749962359667
distance x is tensor(115.2391, device='cuda:0')
benign distance is  tensor(115.2391, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6750177387148142
distance x is tensor(116.2977, device='cuda:0')
benign distance is  tensor(116.2977, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7693060636520386
distance x is tensor(159.4635, device='cuda:0')
benign distance is  tensor(159.4635, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7894273772835732
distance x is tensor(90.6512, device='cuda:0')
benign distance is  tensor(90.6512, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7651047403924167
distance x is tensor(120.0417, device='cuda:0')
benign distance is  tensor(120.0417, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0682955719530582
distance x is tensor(103.6748, device='cuda:0')
benign distance is  tensor(103.6748, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6242489265277982
distance x is tensor(88.9079, device='cuda:0')
benign distance is  tensor(88.9079, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.63900000016
mal_loss is 4.1436920911073685
mal_entropy is 0.15372631745412946
user_PLR len size 28
counter_tensor is  tensor([ 2., 20., 14., 17., 16., 27., 19., 18., 15., 15., 15., 15., 15., 15.,
        15., 15., 15., 15., 15., 15., 18., 19., 27., 27., 18., 27., 27., 17.])
count_res tensor([2.7764e-12, 1.8230e-04, 4.5187e-07, 9.0761e-06, 3.3389e-06, 1.9991e-01,
        6.7064e-05, 2.4671e-05, 1.2283e-06, 1.2283e-06, 1.2283e-06, 1.2283e-06,
        1.2283e-06, 1.2283e-06, 1.2283e-06, 1.2283e-06, 1.2283e-06, 1.2283e-06,
        1.2283e-06, 1.2283e-06, 2.4671e-05, 6.7064e-05, 1.9991e-01, 1.9991e-01,
        2.4671e-05, 1.9991e-01, 1.9991e-01, 9.0761e-06])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 85.11% 

Test Accuracy: 86.30% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6822281405329704
distance x is tensor(126.3333, device='cuda:0')
benign distance is  tensor(126.3333, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8281556181609631
distance x is tensor(117.2330, device='cuda:0')
benign distance is  tensor(117.2330, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7600726764649153
distance x is tensor(102.7810, device='cuda:0')
benign distance is  tensor(102.7810, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9323523603379726
distance x is tensor(158.1946, device='cuda:0')
benign distance is  tensor(158.1946, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0962715279310942
distance x is tensor(89.4126, device='cuda:0')
benign distance is  tensor(89.4126, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7114658053033054
distance x is tensor(104.1589, device='cuda:0')
benign distance is  tensor(104.1589, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9573773145675659
distance x is tensor(102.3743, device='cuda:0')
benign distance is  tensor(102.3743, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7220926065929234
distance x is tensor(80.9461, device='cuda:0')
benign distance is  tensor(80.9461, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.960436537861824
distance x is tensor(95.7266, device='cuda:0')
benign distance is  tensor(95.7266, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6438854448497295
distance x is tensor(116.5700, device='cuda:0')
benign distance is  tensor(116.5700, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9873495455831289
distance x is tensor(64.4519, device='cuda:0')
benign distance is  tensor(64.4519, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.484105445444584
distance x is tensor(102.8099, device='cuda:0')
benign distance is  tensor(102.8099, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9681284464895725
distance x is tensor(171.4333, device='cuda:0')
benign distance is  tensor(171.4333, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7650200836360455
distance x is tensor(44.4073, device='cuda:0')
benign distance is  tensor(44.4073, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8545434316620231
distance x is tensor(118.4108, device='cuda:0')
benign distance is  tensor(118.4108, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0992294671013951
distance x is tensor(116.1631, device='cuda:0')
benign distance is  tensor(116.1631, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.83000000016
mal_loss is 1.1364250238984823
mal_entropy is 0.09970720950514078
user_PLR len size 28
counter_tensor is  tensor([27., 12., 13., 25., 12., 24., 12., 24., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16.,  0., 27., 18., 21., 17., 12., 12., 15.])
count_res tensor([4.4687e-01, 1.3670e-07, 3.7159e-07, 6.0478e-02, 1.3670e-07, 2.2249e-02,
        1.3670e-07, 2.2249e-02, 7.4636e-06, 7.4636e-06, 7.4636e-06, 7.4636e-06,
        7.4636e-06, 7.4636e-06, 7.4636e-06, 7.4636e-06, 7.4636e-06, 7.4636e-06,
        7.4636e-06, 7.4636e-06, 8.3991e-13, 4.4687e-01, 5.5149e-05, 1.1077e-03,
        2.0288e-05, 1.3670e-07, 1.3670e-07, 2.7457e-06])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 91.56% 

Test Accuracy: 87.25% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5732164019718766
distance x is tensor(76.8316, device='cuda:0')
benign distance is  tensor(76.8316, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7690402623265982
distance x is tensor(106.0875, device='cuda:0')
benign distance is  tensor(106.0875, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7702973484992981
distance x is tensor(118.1938, device='cuda:0')
benign distance is  tensor(118.1938, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8753950819373131
distance x is tensor(154.7903, device='cuda:0')
benign distance is  tensor(154.7903, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8690122989937663
distance x is tensor(84.3782, device='cuda:0')
benign distance is  tensor(84.3782, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7180697526782751
distance x is tensor(108.4766, device='cuda:0')
benign distance is  tensor(108.4766, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.125358721241355
distance x is tensor(93.7303, device='cuda:0')
benign distance is  tensor(93.7303, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6255630496889353
distance x is tensor(85.8944, device='cuda:0')
benign distance is  tensor(85.8944, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1834309920668602
distance x is tensor(97.6990, device='cuda:0')
benign distance is  tensor(97.6990, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7616639826446772
distance x is tensor(94.3093, device='cuda:0')
benign distance is  tensor(94.3093, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.061012839898467
distance x is tensor(116.1036, device='cuda:0')
benign distance is  tensor(116.1036, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7286720369011164
distance x is tensor(114.5588, device='cuda:0')
benign distance is  tensor(114.5588, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.8333149868994951
distance x is tensor(75.4434, device='cuda:0')
benign distance is  tensor(75.4434, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5733492337167263
distance x is tensor(215.0013, device='cuda:0')
benign distance is  tensor(215.0013, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1639894898980856
distance x is tensor(133.5227, device='cuda:0')
benign distance is  tensor(133.5227, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7741150856018066
distance x is tensor(101.4077, device='cuda:0')
benign distance is  tensor(101.4077, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.82300000016
mal_loss is 1.2406965587288141
mal_entropy is 0.0981509315315634
user_PLR len size 44
counter_tensor is  tensor([27.,  0., 12., 43., 36.,  0.,  0., 23., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32.,  0., 13., 43., 41., 41., 12., 12.,  0.,
         0., 32., 40., 39., 39.,  0., 33., 39., 43., 41., 31.,  1., 12., 40.,
         0., 43.])
count_res tensor([2.4670e-08, 4.6367e-20, 7.5465e-15, 2.1922e-01, 1.9990e-04, 4.6367e-20,
        4.6367e-20, 4.5184e-10, 3.6613e-06, 3.6613e-06, 3.6613e-06, 3.6613e-06,
        3.6613e-06, 3.6613e-06, 3.6613e-06, 3.6613e-06, 3.6613e-06, 3.6613e-06,
        3.6613e-06, 3.6613e-06, 4.6367e-20, 2.0513e-14, 2.1922e-01, 2.9668e-02,
        2.9668e-02, 7.5465e-15, 7.5465e-15, 4.6367e-20, 4.6367e-20, 3.6613e-06,
        1.0914e-02, 4.0151e-03, 4.0151e-03, 4.6367e-20, 9.9524e-06, 4.0151e-03,
        2.1922e-01, 2.9668e-02, 1.3469e-06, 1.2604e-19, 7.5465e-15, 1.0914e-02,
        4.6367e-20, 2.1922e-01])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 85.65% 

Test Accuracy: 87.02% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8203384596854448
distance x is tensor(115.2408, device='cuda:0')
benign distance is  tensor(115.2408, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.002049995586276
distance x is tensor(109.6637, device='cuda:0')
benign distance is  tensor(109.6637, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8527121962979436
distance x is tensor(108.2202, device='cuda:0')
benign distance is  tensor(108.2202, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9231744036078453
distance x is tensor(151.5035, device='cuda:0')
benign distance is  tensor(151.5035, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8067112155258656
distance x is tensor(87.0844, device='cuda:0')
benign distance is  tensor(87.0844, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8333060275763273
distance x is tensor(111.9437, device='cuda:0')
benign distance is  tensor(111.9437, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0566259268671274
distance x is tensor(87.3186, device='cuda:0')
benign distance is  tensor(87.3186, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6150713860988617
distance x is tensor(78.6307, device='cuda:0')
benign distance is  tensor(78.6307, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9729387182742357
distance x is tensor(87.2602, device='cuda:0')
benign distance is  tensor(87.2602, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6453764420002699
distance x is tensor(123.5742, device='cuda:0')
benign distance is  tensor(123.5742, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.026305228471756
distance x is tensor(57.2382, device='cuda:0')
benign distance is  tensor(57.2382, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.5686926059424877
distance x is tensor(126.8662, device='cuda:0')
benign distance is  tensor(126.8662, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0861676260828972
distance x is tensor(144.6103, device='cuda:0')
benign distance is  tensor(144.6103, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7182181077077985
distance x is tensor(53.6188, device='cuda:0')
benign distance is  tensor(53.6188, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.946138508617878
distance x is tensor(130.3143, device='cuda:0')
benign distance is  tensor(130.3143, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2311765365302563
distance x is tensor(110.3231, device='cuda:0')
benign distance is  tensor(110.3231, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.053190628066659
distance x is tensor(113.4377, device='cuda:0')
benign distance is  tensor(113.4377, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7083396166563034
distance x is tensor(72.1146, device='cuda:0')
benign distance is  tensor(72.1146, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.1002437435090542
distance x is tensor(118.5733, device='cuda:0')
benign distance is  tensor(118.5733, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.4194003865122795
distance x is tensor(104.5086, device='cuda:0')
benign distance is  tensor(104.5086, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6392936408519745
distance x is tensor(112.9630, device='cuda:0')
benign distance is  tensor(112.9630, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8395716780796647
distance x is tensor(98.7553, device='cuda:0')
benign distance is  tensor(98.7553, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.47129103261977434
distance x is tensor(123.2238, device='cuda:0')
benign distance is  tensor(123.2238, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7417666353285313
distance x is tensor(163.4425, device='cuda:0')
benign distance is  tensor(163.4425, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8393417708575726
distance x is tensor(121.4995, device='cuda:0')
benign distance is  tensor(121.4995, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.7828185763210058
distance x is tensor(95.4240, device='cuda:0')
benign distance is  tensor(95.4240, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.652135020121932
distance x is tensor(135.8878, device='cuda:0')
benign distance is  tensor(135.8878, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.139793787151575
distance x is tensor(117.1999, device='cuda:0')
benign distance is  tensor(117.1999, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8376869224011898
distance x is tensor(98.9402, device='cuda:0')
benign distance is  tensor(98.9402, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8592987926676869
distance x is tensor(71.8130, device='cuda:0')
benign distance is  tensor(71.8130, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.6454078033566475
distance x is tensor(81.4963, device='cuda:0')
benign distance is  tensor(81.4963, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7104070167988539
distance x is tensor(115.3610, device='cuda:0')
benign distance is  tensor(115.3610, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.84900000016
mal_loss is 0.6242011869326234
mal_entropy is 0.17740303184837103
user_PLR len size 20
counter_tensor is  tensor([13., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([7.5970e-05, 2.7948e-05, 2.7948e-05, 2.7948e-05, 2.7948e-05, 2.7948e-05,
        2.7948e-05, 2.7948e-05, 8.3311e-02, 8.3311e-02, 8.3311e-02, 8.3311e-02,
        8.3311e-02, 8.3311e-02, 8.3311e-02, 8.3311e-02, 8.3311e-02, 8.3311e-02,
        8.3311e-02, 8.3311e-02])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 89.25% 

Test Accuracy: 85.43% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.809940280392766
distance x is tensor(127.6509, device='cuda:0')
benign distance is  tensor(127.6509, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1248796097934246
distance x is tensor(124.4349, device='cuda:0')
benign distance is  tensor(124.4349, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6860300302505493
distance x is tensor(121.1847, device='cuda:0')
benign distance is  tensor(121.1847, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7792278211563826
distance x is tensor(168.0030, device='cuda:0')
benign distance is  tensor(168.0030, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1993270516395569
distance x is tensor(110.1945, device='cuda:0')
benign distance is  tensor(110.1945, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7054123720154166
distance x is tensor(109.9696, device='cuda:0')
benign distance is  tensor(109.9696, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1893846914172173
distance x is tensor(110.8854, device='cuda:0')
benign distance is  tensor(110.8854, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6710407454520464
distance x is tensor(108.4493, device='cuda:0')
benign distance is  tensor(108.4493, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.57200000016
mal_loss is 5.1163709461688995
mal_entropy is 0.1365168448537588
user_PLR len size 44
counter_tensor is  tensor([ 1., 43., 41., 24., 43., 42.,  0.,  7.,  0.,  0.,  0.,  0.,  0.,  0.,
         0.,  0.,  0.,  0.,  0.,  0., 42., 37., 43., 43., 20.,  2., 43., 41.,
        43., 42., 30., 41.,  5., 41., 43., 43., 43.,  0., 43., 42.,  0., 43.,
        42., 39.])
count_res tensor([4.2902e-20, 7.4618e-02, 1.0098e-02, 4.1807e-10, 7.4618e-02, 2.7451e-02,
        1.5783e-20, 1.7308e-17, 1.5783e-20, 1.5783e-20, 1.5783e-20, 1.5783e-20,
        1.5783e-20, 1.5783e-20, 1.5783e-20, 1.5783e-20, 1.5783e-20, 1.5783e-20,
        1.5783e-20, 1.5783e-20, 2.7451e-02, 1.8496e-04, 7.4618e-02, 7.4618e-02,
        7.6572e-12, 1.1662e-19, 7.4618e-02, 1.0098e-02, 7.4618e-02, 2.7451e-02,
        1.6866e-07, 1.0098e-02, 2.3424e-18, 1.0098e-02, 7.4618e-02, 7.4618e-02,
        7.4618e-02, 1.5783e-20, 7.4618e-02, 2.7451e-02, 1.5783e-20, 7.4618e-02,
        2.7451e-02, 1.3667e-03])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 86.71% 

Test Accuracy: 87.88% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7338137924671173
distance x is tensor(101.5876, device='cuda:0')
benign distance is  tensor(101.5876, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8325594365596771
distance x is tensor(103.1672, device='cuda:0')
benign distance is  tensor(103.1672, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7255847733467817
distance x is tensor(109.6773, device='cuda:0')
benign distance is  tensor(109.6773, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.127415619790554
distance x is tensor(145.5093, device='cuda:0')
benign distance is  tensor(145.5093, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9236053675413132
distance x is tensor(82.1728, device='cuda:0')
benign distance is  tensor(82.1728, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7066815355792642
distance x is tensor(93.4145, device='cuda:0')
benign distance is  tensor(93.4145, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.418207872658968
distance x is tensor(85.4987, device='cuda:0')
benign distance is  tensor(85.4987, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7135857688263059
distance x is tensor(78.5655, device='cuda:0')
benign distance is  tensor(78.5655, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.80057692527771
distance x is tensor(105.0080, device='cuda:0')
benign distance is  tensor(105.0080, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6845130240544677
distance x is tensor(115.8267, device='cuda:0')
benign distance is  tensor(115.8267, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8377456516027451
distance x is tensor(76.7878, device='cuda:0')
benign distance is  tensor(76.7878, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.1643266379833221
distance x is tensor(103.7386, device='cuda:0')
benign distance is  tensor(103.7386, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.44356220215559
distance x is tensor(178.7866, device='cuda:0')
benign distance is  tensor(178.7866, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.668036637827754
distance x is tensor(44.8321, device='cuda:0')
benign distance is  tensor(44.8321, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8790501588955522
distance x is tensor(129.5568, device='cuda:0')
benign distance is  tensor(129.5568, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0221150368452072
distance x is tensor(115.1276, device='cuda:0')
benign distance is  tensor(115.1276, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1075053177773952
distance x is tensor(107.7824, device='cuda:0')
benign distance is  tensor(107.7824, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7311792261898518
distance x is tensor(101.1401, device='cuda:0')
benign distance is  tensor(101.1401, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.7545448197051883
distance x is tensor(115.2856, device='cuda:0')
benign distance is  tensor(115.2856, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8049651756882668
distance x is tensor(111.5828, device='cuda:0')
benign distance is  tensor(111.5828, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.8775001978501678
distance x is tensor(76.8302, device='cuda:0')
benign distance is  tensor(76.8302, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7578826230019331
distance x is tensor(210.0882, device='cuda:0')
benign distance is  tensor(210.0882, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.925400210544467
distance x is tensor(132.9679, device='cuda:0')
benign distance is  tensor(132.9679, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6165342293679714
distance x is tensor(98.5404, device='cuda:0')
benign distance is  tensor(98.5404, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.2922437004745007
distance x is tensor(94.7028, device='cuda:0')
benign distance is  tensor(94.7028, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.3151639625430107
distance x is tensor(150.7377, device='cuda:0')
benign distance is  tensor(150.7377, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.1335467398166656
distance x is tensor(133.3132, device='cuda:0')
benign distance is  tensor(133.3132, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.899064376950264
distance x is tensor(84.3039, device='cuda:0')
benign distance is  tensor(84.3039, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7998860673978925
distance x is tensor(163.3023, device='cuda:0')
benign distance is  tensor(163.3023, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8461879137903452
distance x is tensor(129.2813, device='cuda:0')
benign distance is  tensor(129.2813, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9648431167006493
distance x is tensor(92.0206, device='cuda:0')
benign distance is  tensor(92.0206, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5900750113651156
distance x is tensor(115.3950, device='cuda:0')
benign distance is  tensor(115.3950, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.86400000016
mal_loss is 0.6742310826666653
mal_entropy is 0.12612884887494147
user_PLR len size 20
counter_tensor is  tensor([19., 19., 19., 12., 12., 12., 18., 18., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7504e-02, 2.7504e-02, 2.7504e-02, 2.5081e-05, 2.5081e-05, 2.5081e-05,
        1.0118e-02, 1.0118e-02, 7.4765e-02, 7.4765e-02, 7.4765e-02, 7.4765e-02,
        7.4765e-02, 7.4765e-02, 7.4765e-02, 7.4765e-02, 7.4765e-02, 7.4765e-02,
        7.4765e-02, 7.4765e-02])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 89.17% 

Test Accuracy: 86.72% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7538143955171108
distance x is tensor(134.6091, device='cuda:0')
benign distance is  tensor(134.6091, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8966781869530678
distance x is tensor(118.9595, device='cuda:0')
benign distance is  tensor(118.9595, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8279976528137922
distance x is tensor(116.1742, device='cuda:0')
benign distance is  tensor(116.1742, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.055169764906168
distance x is tensor(166.5717, device='cuda:0')
benign distance is  tensor(166.5717, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9338611788116395
distance x is tensor(91.0100, device='cuda:0')
benign distance is  tensor(91.0100, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7016585445962846
distance x is tensor(120.0138, device='cuda:0')
benign distance is  tensor(120.0138, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3886924106627703
distance x is tensor(115.7178, device='cuda:0')
benign distance is  tensor(115.7178, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6779451938346028
distance x is tensor(98.5684, device='cuda:0')
benign distance is  tensor(98.5684, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.69300000016
mal_loss is 4.160637848079205
mal_entropy is 0.11026561679318547
user_PLR len size 36
counter_tensor is  tensor([35., 25., 19.,  0., 29., 24.,  5., 24., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 33., 34., 12., 14., 35., 35., 34., 28.,
        33., 24., 34., 30., 35., 35.,  7., 28.])
count_res tensor([1.5661e-01, 7.1099e-06, 1.7624e-08, 9.8742e-17, 3.8819e-04, 2.6156e-06,
        1.4655e-14, 2.6156e-06, 8.7743e-10, 8.7743e-10, 8.7743e-10, 8.7743e-10,
        8.7743e-10, 8.7743e-10, 8.7743e-10, 8.7743e-10, 8.7743e-10, 8.7743e-10,
        8.7743e-10, 8.7743e-10, 2.1194e-02, 5.7612e-02, 1.6071e-11, 1.1875e-10,
        1.5661e-01, 1.5661e-01, 5.7612e-02, 1.4281e-04, 2.1194e-02, 2.6156e-06,
        5.7612e-02, 1.0552e-03, 1.5661e-01, 1.5661e-01, 1.0828e-13, 1.4281e-04])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 88.32% 

Test Accuracy: 87.88% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5962522700428963
distance x is tensor(117.8950, device='cuda:0')
benign distance is  tensor(117.8950, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9381077494472265
distance x is tensor(108.3717, device='cuda:0')
benign distance is  tensor(108.3717, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6833645757287741
distance x is tensor(106.1415, device='cuda:0')
benign distance is  tensor(106.1415, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8316643442958593
distance x is tensor(133.2206, device='cuda:0')
benign distance is  tensor(133.2206, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7656311020255089
distance x is tensor(83.6274, device='cuda:0')
benign distance is  tensor(83.6274, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7754056728444993
distance x is tensor(106.2979, device='cuda:0')
benign distance is  tensor(106.2979, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2203013077378273
distance x is tensor(97.4606, device='cuda:0')
benign distance is  tensor(97.4606, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6978095062077045
distance x is tensor(74.5422, device='cuda:0')
benign distance is  tensor(74.5422, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8575729792937636
distance x is tensor(92.0721, device='cuda:0')
benign distance is  tensor(92.0721, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7081268629990518
distance x is tensor(118.9133, device='cuda:0')
benign distance is  tensor(118.9133, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.055706586688757
distance x is tensor(67.0857, device='cuda:0')
benign distance is  tensor(67.0857, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.183166280388832
distance x is tensor(115.5997, device='cuda:0')
benign distance is  tensor(115.5997, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8307885266840458
distance x is tensor(147.9983, device='cuda:0')
benign distance is  tensor(147.9983, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6331406524404883
distance x is tensor(49.0038, device='cuda:0')
benign distance is  tensor(49.0038, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1170803755521774
distance x is tensor(130.7573, device='cuda:0')
benign distance is  tensor(130.7573, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.019299790263176
distance x is tensor(115.7651, device='cuda:0')
benign distance is  tensor(115.7651, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9970456939190626
distance x is tensor(123.6126, device='cuda:0')
benign distance is  tensor(123.6126, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.67104765586555
distance x is tensor(95.3918, device='cuda:0')
benign distance is  tensor(95.3918, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.123696442693472
distance x is tensor(123.8743, device='cuda:0')
benign distance is  tensor(123.8743, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.295586846768856
distance x is tensor(105.2813, device='cuda:0')
benign distance is  tensor(105.2813, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7708500064909458
distance x is tensor(108.3081, device='cuda:0')
benign distance is  tensor(108.3081, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6331053217872977
distance x is tensor(91.1441, device='cuda:0')
benign distance is  tensor(91.1441, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4953304287046194
distance x is tensor(105.6459, device='cuda:0')
benign distance is  tensor(105.6459, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6543050762265921
distance x is tensor(167.8172, device='cuda:0')
benign distance is  tensor(167.8172, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.84800000016
mal_loss is 0.8429081235080957
mal_entropy is 0.12335483217611909
user_PLR len size 36
counter_tensor is  tensor([12.,  0., 35., 12., 12., 14., 13., 15., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 17., 24.,  0., 12., 29., 16., 35., 34.,
         0., 32., 29., 15.,  0., 19.,  0., 21.])
count_res tensor([4.2355e-11, 2.6024e-16, 4.1274e-01, 4.2355e-11, 4.2355e-11, 3.1296e-10,
        1.1513e-10, 8.5072e-10, 6.8934e-06, 6.8934e-06, 6.8934e-06, 6.8934e-06,
        6.8934e-06, 6.8934e-06, 6.8934e-06, 6.8934e-06, 6.8934e-06, 6.8934e-06,
        6.8934e-06, 6.8934e-06, 6.2860e-09, 6.8934e-06, 2.6024e-16, 4.2355e-11,
        1.0231e-03, 2.3125e-09, 4.1274e-01, 1.5184e-01, 2.6024e-16, 2.0549e-02,
        1.0231e-03, 8.5072e-10, 2.6024e-16, 4.6448e-08, 2.6024e-16, 3.4320e-07])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 89.14% 

Test Accuracy: 87.45% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6746137477457523
distance x is tensor(101.2477, device='cuda:0')
benign distance is  tensor(101.2477, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7627107528969646
distance x is tensor(111.9151, device='cuda:0')
benign distance is  tensor(111.9151, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7059734519571066
distance x is tensor(83.7934, device='cuda:0')
benign distance is  tensor(83.7934, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9731391724199057
distance x is tensor(152.9899, device='cuda:0')
benign distance is  tensor(152.9899, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9326161574572325
distance x is tensor(93.7938, device='cuda:0')
benign distance is  tensor(93.7938, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6685033431276679
distance x is tensor(106.5845, device='cuda:0')
benign distance is  tensor(106.5845, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9831213541328907
distance x is tensor(99.3222, device='cuda:0')
benign distance is  tensor(99.3222, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6216627098619938
distance x is tensor(81.0498, device='cuda:0')
benign distance is  tensor(81.0498, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.9864410646259785
distance x is tensor(111.8114, device='cuda:0')
benign distance is  tensor(111.8114, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7544711735099554
distance x is tensor(116.4403, device='cuda:0')
benign distance is  tensor(116.4403, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8751523178070784
distance x is tensor(138.8336, device='cuda:0')
benign distance is  tensor(138.8336, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9072091532871127
distance x is tensor(126.1410, device='cuda:0')
benign distance is  tensor(126.1410, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.023182950913906
distance x is tensor(85.0096, device='cuda:0')
benign distance is  tensor(85.0096, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7565156053751707
distance x is tensor(214.2942, device='cuda:0')
benign distance is  tensor(214.2942, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0296059846878052
distance x is tensor(143.3356, device='cuda:0')
benign distance is  tensor(143.3356, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6799073740839958
distance x is tensor(112.2572, device='cuda:0')
benign distance is  tensor(112.2572, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7243909481912851
distance x is tensor(127.4523, device='cuda:0')
benign distance is  tensor(127.4523, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.8597110286355019
distance x is tensor(107.1868, device='cuda:0')
benign distance is  tensor(107.1868, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7515806779265404
distance x is tensor(148.9182, device='cuda:0')
benign distance is  tensor(148.9182, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.262722235172987
distance x is tensor(130.4050, device='cuda:0')
benign distance is  tensor(130.4050, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7944932263344526
distance x is tensor(100.7433, device='cuda:0')
benign distance is  tensor(100.7433, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7209621625952423
distance x is tensor(77.1848, device='cuda:0')
benign distance is  tensor(77.1848, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.8326265774667263
distance x is tensor(77.7143, device='cuda:0')
benign distance is  tensor(77.7143, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7358229998499155
distance x is tensor(116.9779, device='cuda:0')
benign distance is  tensor(116.9779, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.81800000016
mal_loss is 0.8843167908489704
mal_entropy is 0.14768216060474515
user_PLR len size 28
counter_tensor is  tensor([14., 26., 25., 12., 12.,  2., 12., 19., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 26., 14., 25., 13., 14., 25., 13., 27.])
count_res tensor([1.0551e-06, 1.7172e-01, 6.3173e-02, 1.4279e-07, 1.4279e-07, 6.4827e-12,
        1.4279e-07, 1.5659e-04, 7.7961e-06, 7.7961e-06, 7.7961e-06, 7.7961e-06,
        7.7961e-06, 7.7961e-06, 7.7961e-06, 7.7961e-06, 7.7961e-06, 7.7961e-06,
        7.7961e-06, 7.7961e-06, 1.7172e-01, 1.0551e-06, 6.3173e-02, 3.8815e-07,
        1.0551e-06, 6.3173e-02, 3.8815e-07, 4.6679e-01])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 86.58% 

Test Accuracy: 86.72% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7341623324900866
distance x is tensor(98.3601, device='cuda:0')
benign distance is  tensor(98.3601, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8821101784706116
distance x is tensor(98.3774, device='cuda:0')
benign distance is  tensor(98.3774, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6899404264986515
distance x is tensor(112.8742, device='cuda:0')
benign distance is  tensor(112.8742, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9891934730112553
distance x is tensor(153.3418, device='cuda:0')
benign distance is  tensor(153.3418, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8171229427680373
distance x is tensor(86.0374, device='cuda:0')
benign distance is  tensor(86.0374, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6331158699467778
distance x is tensor(101.4682, device='cuda:0')
benign distance is  tensor(101.4682, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.904748797416687
distance x is tensor(98.2058, device='cuda:0')
benign distance is  tensor(98.2058, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6512074898928404
distance x is tensor(104.0778, device='cuda:0')
benign distance is  tensor(104.0778, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9280361272394657
distance x is tensor(90.0518, device='cuda:0')
benign distance is  tensor(90.0518, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6132949609309435
distance x is tensor(116.6700, device='cuda:0')
benign distance is  tensor(116.6700, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.94672024063766
distance x is tensor(63.6180, device='cuda:0')
benign distance is  tensor(63.6180, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3312177620828152
distance x is tensor(105.8041, device='cuda:0')
benign distance is  tensor(105.8041, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9099127650260925
distance x is tensor(155.1496, device='cuda:0')
benign distance is  tensor(155.1496, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6306306440383196
distance x is tensor(52.7501, device='cuda:0')
benign distance is  tensor(52.7501, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9463734477758408
distance x is tensor(151.1537, device='cuda:0')
benign distance is  tensor(151.1537, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2095679305493832
distance x is tensor(91.7062, device='cuda:0')
benign distance is  tensor(91.7062, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.84400000016
mal_loss is 1.0758049115538597
mal_entropy is 0.10012089880183339
user_PLR len size 20
counter_tensor is  tensor([19., 16., 12., 12., 17., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.9578e-02, 1.4726e-03, 2.6972e-05, 2.6972e-05, 4.0029e-03, 2.6972e-05,
        2.6972e-05, 2.6972e-05, 8.0401e-02, 8.0401e-02, 8.0401e-02, 8.0401e-02,
        8.0401e-02, 8.0401e-02, 8.0401e-02, 8.0401e-02, 8.0401e-02, 8.0401e-02,
        8.0401e-02, 8.0401e-02])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 89.63% 

Test Accuracy: 84.62% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7349730217829347
distance x is tensor(131.6282, device='cuda:0')
benign distance is  tensor(131.6282, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2521851733326912
distance x is tensor(118.5677, device='cuda:0')
benign distance is  tensor(118.5677, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7181820385158062
distance x is tensor(133.3026, device='cuda:0')
benign distance is  tensor(133.3026, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8763290029019117
distance x is tensor(178.4026, device='cuda:0')
benign distance is  tensor(178.4026, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9712678259238601
distance x is tensor(112.9965, device='cuda:0')
benign distance is  tensor(112.9965, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7277752365916967
distance x is tensor(131.7863, device='cuda:0')
benign distance is  tensor(131.7863, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.47148147970438
distance x is tensor(137.7198, device='cuda:0')
benign distance is  tensor(137.7198, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6974104847759008
distance x is tensor(105.6165, device='cuda:0')
benign distance is  tensor(105.6165, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.59400000016
mal_loss is 7.564501076936722
mal_entropy is 0.10932334512472153
user_PLR len size 52
counter_tensor is  tensor([29., 18., 14., 14.,  4.,  3., 11., 31., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19., 51., 51., 25., 51., 44., 44., 45., 49.,
        37., 49., 51., 29., 33., 48., 51., 44., 50., 40., 50., 51.,  0., 39.,
        27., 51., 50.,  2., 49.,  2.,  0., 49., 12., 47.])
count_res tensor([3.1995e-11, 5.3438e-16, 9.7875e-18, 9.7875e-18, 4.4435e-22, 1.6347e-22,
        4.8729e-19, 2.3642e-10, 1.4526e-15, 1.4526e-15, 1.4526e-15, 1.4526e-15,
        1.4526e-15, 1.4526e-15, 1.4526e-15, 1.4526e-15, 1.4526e-15, 1.4526e-15,
        1.4526e-15, 1.4526e-15, 1.1470e-01, 1.1470e-01, 5.8602e-13, 1.1470e-01,
        1.0459e-04, 1.0459e-04, 2.8432e-04, 1.5523e-02, 9.5377e-08, 1.5523e-02,
        1.1470e-01, 3.1995e-11, 1.7469e-09, 5.7106e-03, 1.1470e-01, 1.0459e-04,
        4.2196e-02, 1.9157e-06, 4.2196e-02, 1.1470e-01, 8.1386e-24, 7.0475e-07,
        4.3301e-12, 1.1470e-01, 4.2196e-02, 6.0136e-23, 1.5523e-02, 6.0136e-23,
        8.1386e-24, 1.5523e-02, 1.3246e-18, 2.1008e-03])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 89.58% 

Test Accuracy: 88.32% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.640897249802947
distance x is tensor(100.5536, device='cuda:0')
benign distance is  tensor(100.5536, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7708714511245489
distance x is tensor(105.7062, device='cuda:0')
benign distance is  tensor(105.7062, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6046164557337761
distance x is tensor(106.3819, device='cuda:0')
benign distance is  tensor(106.3819, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9055516701191664
distance x is tensor(157.5574, device='cuda:0')
benign distance is  tensor(157.5574, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0309277968481183
distance x is tensor(79.4479, device='cuda:0')
benign distance is  tensor(79.4479, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6058408208191395
distance x is tensor(99.9554, device='cuda:0')
benign distance is  tensor(99.9554, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.000363390892744
distance x is tensor(89.0943, device='cuda:0')
benign distance is  tensor(89.0943, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5645602280274034
distance x is tensor(79.6462, device='cuda:0')
benign distance is  tensor(79.6462, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.837231233716011
distance x is tensor(86.7843, device='cuda:0')
benign distance is  tensor(86.7843, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.64153110422194
distance x is tensor(121.3595, device='cuda:0')
benign distance is  tensor(121.3595, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0994789451360703
distance x is tensor(52.0783, device='cuda:0')
benign distance is  tensor(52.0783, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.1259031668305397
distance x is tensor(105.0625, device='cuda:0')
benign distance is  tensor(105.0625, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0219402760267258
distance x is tensor(163.4066, device='cuda:0')
benign distance is  tensor(163.4066, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5472086714580655
distance x is tensor(45.5056, device='cuda:0')
benign distance is  tensor(45.5056, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8570936219766736
distance x is tensor(123.4041, device='cuda:0')
benign distance is  tensor(123.4041, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1891715079545975
distance x is tensor(110.3601, device='cuda:0')
benign distance is  tensor(110.3601, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.968966256827116
distance x is tensor(86.7864, device='cuda:0')
benign distance is  tensor(86.7864, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5845621037296951
distance x is tensor(105.5583, device='cuda:0')
benign distance is  tensor(105.5583, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8792328462004662
distance x is tensor(114.8922, device='cuda:0')
benign distance is  tensor(114.8922, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7854698244482279
distance x is tensor(103.7129, device='cuda:0')
benign distance is  tensor(103.7129, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9324049651622772
distance x is tensor(73.0633, device='cuda:0')
benign distance is  tensor(73.0633, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7259272523224354
distance x is tensor(206.8089, device='cuda:0')
benign distance is  tensor(206.8089, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0917926244437695
distance x is tensor(131.2368, device='cuda:0')
benign distance is  tensor(131.2368, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6002498678863049
distance x is tensor(109.9440, device='cuda:0')
benign distance is  tensor(109.9440, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9172690417617559
distance x is tensor(111.9853, device='cuda:0')
benign distance is  tensor(111.9853, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5797868808731437
distance x is tensor(73.9529, device='cuda:0')
benign distance is  tensor(73.9529, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.0979476161301136
distance x is tensor(109.0436, device='cuda:0')
benign distance is  tensor(109.0436, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.3228172026574612
distance x is tensor(118.7046, device='cuda:0')
benign distance is  tensor(118.7046, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6133069228380919
distance x is tensor(113.2963, device='cuda:0')
benign distance is  tensor(113.2963, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.77108552493155
distance x is tensor(88.5224, device='cuda:0')
benign distance is  tensor(88.5224, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5494795595295727
distance x is tensor(113.4113, device='cuda:0')
benign distance is  tensor(113.4113, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6775681674480438
distance x is tensor(167.2596, device='cuda:0')
benign distance is  tensor(167.2596, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.1010731384158134
distance x is tensor(86.5027, device='cuda:0')
benign distance is  tensor(86.5027, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.183842658996582
distance x is tensor(124.2906, device='cuda:0')
benign distance is  tensor(124.2906, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.1213301829993725
distance x is tensor(139.7630, device='cuda:0')
benign distance is  tensor(139.7630, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.0282036997377872
distance x is tensor(79.0943, device='cuda:0')
benign distance is  tensor(79.0943, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6166396420449018
distance x is tensor(156.8226, device='cuda:0')
benign distance is  tensor(156.8226, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8888002280145884
distance x is tensor(137.6533, device='cuda:0')
benign distance is  tensor(137.6533, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7698689587414265
distance x is tensor(97.0055, device='cuda:0')
benign distance is  tensor(97.0055, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6324621774256229
distance x is tensor(121.5554, device='cuda:0')
benign distance is  tensor(121.5554, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.88200000016
mal_loss is 0.5122073348611593
mal_entropy is 0.1509378175251186
user_PLR len size 20
counter_tensor is  tensor([13., 13., 17., 13., 13., 12., 13., 13., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([7.5640e-05, 7.5640e-05, 4.1298e-03, 7.5640e-05, 7.5640e-05, 2.7826e-05,
        7.5640e-05, 7.5640e-05, 8.2949e-02, 8.2949e-02, 8.2949e-02, 8.2949e-02,
        8.2949e-02, 8.2949e-02, 8.2949e-02, 8.2949e-02, 8.2949e-02, 8.2949e-02,
        8.2949e-02, 8.2949e-02])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 92.78% 

Test Accuracy: 87.01% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7710937950760126
distance x is tensor(146.7360, device='cuda:0')
benign distance is  tensor(146.7360, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8084144340828061
distance x is tensor(125.1346, device='cuda:0')
benign distance is  tensor(125.1346, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7710181567817926
distance x is tensor(120.5872, device='cuda:0')
benign distance is  tensor(120.5872, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2371949777007103
distance x is tensor(160.6767, device='cuda:0')
benign distance is  tensor(160.6767, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4223246239125729
distance x is tensor(119.2942, device='cuda:0')
benign distance is  tensor(119.2942, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7320766625925899
distance x is tensor(127.5600, device='cuda:0')
benign distance is  tensor(127.5600, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9413070995360613
distance x is tensor(112.2782, device='cuda:0')
benign distance is  tensor(112.2782, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7728264406323433
distance x is tensor(110.8790, device='cuda:0')
benign distance is  tensor(110.8790, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.63200000016
mal_loss is 4.713153548538685
mal_entropy is 0.16593513218685985
user_PLR len size 36
counter_tensor is  tensor([35., 35., 35.,  1., 34., 35., 33.,  0., 17., 17., 17., 17., 17., 17.,
        17., 17., 17., 17., 17., 17.,  5., 35., 35., 34., 35., 31., 21., 32.,
        34., 35., 25., 28.,  0., 35.,  4., 35.])
count_res tensor([8.8433e-02, 8.8433e-02, 8.8433e-02, 1.5157e-16, 3.2533e-02, 8.8433e-02,
        1.1968e-02, 5.5758e-17, 1.3468e-09, 1.3468e-09, 1.3468e-09, 1.3468e-09,
        1.3468e-09, 1.3468e-09, 1.3468e-09, 1.3468e-09, 1.3468e-09, 1.3468e-09,
        1.3468e-09, 1.3468e-09, 8.2752e-15, 8.8433e-02, 8.8433e-02, 3.2533e-02,
        8.8433e-02, 1.6197e-03, 7.3534e-08, 4.4028e-03, 3.2533e-02, 8.8433e-02,
        4.0148e-06, 8.0640e-05, 5.5758e-17, 8.8433e-02, 3.0443e-15, 8.8433e-02])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 92.01% 

Test Accuracy: 88.69% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 92.01%
|----0th round Training Accuracy : 95.84%
|----1th round Training Accuracy : 91.35%
|----2th round Training Accuracy : 90.37%
|----3th round Training Accuracy : 88.92%
|----4th round Training Accuracy : 94.10%
|----5th round Training Accuracy : 89.06%
|----6th round Training Accuracy : 88.35%
|----7th round Training Accuracy : 88.43%
|----8th round Training Accuracy : 81.65%
|----9th round Training Accuracy : 80.73%
|----10th round Training Accuracy : 82.18%
|----11th round Training Accuracy : 79.87%
|----12th round Training Accuracy : 78.05%
|----13th round Training Accuracy : 81.32%
|----14th round Training Accuracy : 79.22%
|----15th round Training Accuracy : 87.58%
|----16th round Training Accuracy : 89.66%
|----17th round Training Accuracy : 87.45%
|----18th round Training Accuracy : 92.25%
|----19th round Training Accuracy : 91.24%
|----20th round Training Accuracy : 83.45%
|----21th round Training Accuracy : 90.45%
|----22th round Training Accuracy : 93.51%
|----23th round Training Accuracy : 88.16%
|----24th round Training Accuracy : 91.57%
|----25th round Training Accuracy : 87.03%
|----26th round Training Accuracy : 83.40%
|----27th round Training Accuracy : 82.42%
|----28th round Training Accuracy : 85.41%
|----29th round Training Accuracy : 90.02%
|----30th round Training Accuracy : 93.81%
|----31th round Training Accuracy : 89.21%
|----32th round Training Accuracy : 84.54%
|----33th round Training Accuracy : 86.97%
|----34th round Training Accuracy : 86.16%
|----35th round Training Accuracy : 89.20%
|----36th round Training Accuracy : 92.86%
|----37th round Training Accuracy : 85.11%
|----38th round Training Accuracy : 91.56%
|----39th round Training Accuracy : 85.65%
|----40th round Training Accuracy : 89.25%
|----41th round Training Accuracy : 86.71%
|----42th round Training Accuracy : 89.17%
|----43th round Training Accuracy : 88.32%
|----44th round Training Accuracy : 89.14%
|----45th round Training Accuracy : 86.58%
|----46th round Training Accuracy : 89.63%
|----47th round Training Accuracy : 89.58%
|----48th round Training Accuracy : 92.78%
|----49th round Training Accuracy : 92.01%
|----Final Test Accuracy: 88.69%
|----0th round Final Test Accuracy : 85.73%
|----1th round Final Test Accuracy : 87.01%
|----2th round Final Test Accuracy : 86.85%
|----3th round Final Test Accuracy : 85.23%
|----4th round Final Test Accuracy : 86.05%
|----5th round Final Test Accuracy : 85.46%
|----6th round Final Test Accuracy : 78.28%
|----7th round Final Test Accuracy : 86.94%
|----8th round Final Test Accuracy : 85.08%
|----9th round Final Test Accuracy : 83.69%
|----10th round Final Test Accuracy : 79.29%
|----11th round Final Test Accuracy : 85.44%
|----12th round Final Test Accuracy : 82.63%
|----13th round Final Test Accuracy : 84.32%
|----14th round Final Test Accuracy : 85.11%
|----15th round Final Test Accuracy : 86.82%
|----16th round Final Test Accuracy : 83.25%
|----17th round Final Test Accuracy : 87.29%
|----18th round Final Test Accuracy : 85.95%
|----19th round Final Test Accuracy : 88.20%
|----20th round Final Test Accuracy : 82.24%
|----21th round Final Test Accuracy : 88.00%
|----22th round Final Test Accuracy : 86.87%
|----23th round Final Test Accuracy : 87.63%
|----24th round Final Test Accuracy : 82.22%
|----25th round Final Test Accuracy : 86.93%
|----26th round Final Test Accuracy : 80.00%
|----27th round Final Test Accuracy : 85.21%
|----28th round Final Test Accuracy : 80.59%
|----29th round Final Test Accuracy : 88.01%
|----30th round Final Test Accuracy : 86.84%
|----31th round Final Test Accuracy : 87.01%
|----32th round Final Test Accuracy : 85.57%
|----33th round Final Test Accuracy : 86.67%
|----34th round Final Test Accuracy : 85.06%
|----35th round Final Test Accuracy : 87.94%
|----36th round Final Test Accuracy : 86.24%
|----37th round Final Test Accuracy : 86.30%
|----38th round Final Test Accuracy : 87.25%
|----39th round Final Test Accuracy : 87.02%
|----40th round Final Test Accuracy : 85.43%
|----41th round Final Test Accuracy : 87.88%
|----42th round Final Test Accuracy : 86.72%
|----43th round Final Test Accuracy : 87.88%
|----44th round Final Test Accuracy : 87.45%
|----45th round Final Test Accuracy : 86.72%
|----46th round Final Test Accuracy : 84.62%
|----47th round Final Test Accuracy : 88.32%
|----48th round Final Test Accuracy : 87.01%
|----49th round Final Test Accuracy : 88.69%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 3432.4815
