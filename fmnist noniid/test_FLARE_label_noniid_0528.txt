
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Data poison attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8163653686642647
distance x is tensor(114.5325, device='cuda:0')
benign distance is  tensor(114.5325, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7398825827986002
distance x is tensor(111.5508, device='cuda:0')
benign distance is  tensor(111.5508, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5867822226136923
distance x is tensor(109.5790, device='cuda:0')
benign distance is  tensor(109.5790, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2050658501684666
distance x is tensor(153.4159, device='cuda:0')
benign distance is  tensor(153.4159, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7596996426582336
distance x is tensor(101.6342, device='cuda:0')
benign distance is  tensor(101.6342, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.652639102190733
distance x is tensor(97.5133, device='cuda:0')
benign distance is  tensor(97.5133, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2415788117796183
distance x is tensor(107.5396, device='cuda:0')
benign distance is  tensor(107.5396, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6752231828868389
distance x is tensor(82.0066, device='cuda:0')
benign distance is  tensor(82.0066, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8791298791766167
distance x is tensor(113.2902, device='cuda:0')
benign distance is  tensor(113.2902, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6364693688228726
distance x is tensor(131.7672, device='cuda:0')
benign distance is  tensor(131.7672, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0363182500004768
distance x is tensor(96.9460, device='cuda:0')
benign distance is  tensor(96.9460, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2085406817495823
distance x is tensor(123.7208, device='cuda:0')
benign distance is  tensor(123.7208, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9661673828959465
distance x is tensor(164.5129, device='cuda:0')
benign distance is  tensor(164.5129, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6155573949217796
distance x is tensor(67.1035, device='cuda:0')
benign distance is  tensor(67.1035, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.03111582249403
distance x is tensor(145.3748, device='cuda:0')
benign distance is  tensor(145.3748, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1962082087993622
distance x is tensor(136.4533, device='cuda:0')
benign distance is  tensor(136.4533, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.2626806981861591
distance x is tensor(117.4230, device='cuda:0')
benign distance is  tensor(117.4230, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6322985170409083
distance x is tensor(115.2610, device='cuda:0')
benign distance is  tensor(115.2610, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8636598698794842
distance x is tensor(119.6715, device='cuda:0')
benign distance is  tensor(119.6715, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.6715857610106468
distance x is tensor(119.2831, device='cuda:0')
benign distance is  tensor(119.2831, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9913889970630407
distance x is tensor(85.1667, device='cuda:0')
benign distance is  tensor(85.1667, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7061591688543558
distance x is tensor(209.3085, device='cuda:0')
benign distance is  tensor(209.3085, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0042338706552982
distance x is tensor(157.5098, device='cuda:0')
benign distance is  tensor(157.5098, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6286797598004341
distance x is tensor(111.5707, device='cuda:0')
benign distance is  tensor(111.5707, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.8728633765131235
distance x is tensor(119.7803, device='cuda:0')
benign distance is  tensor(119.7803, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5795358559116721
distance x is tensor(78.2018, device='cuda:0')
benign distance is  tensor(78.2018, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.1299676336348057
distance x is tensor(151.6655, device='cuda:0')
benign distance is  tensor(151.6655, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2194687314331532
distance x is tensor(113.8126, device='cuda:0')
benign distance is  tensor(113.8126, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7031089905649424
distance x is tensor(119.7864, device='cuda:0')
benign distance is  tensor(119.7864, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8771369159221649
distance x is tensor(124.1023, device='cuda:0')
benign distance is  tensor(124.1023, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4829822117462754
distance x is tensor(105.6699, device='cuda:0')
benign distance is  tensor(105.6699, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.8229137286543846
distance x is tensor(173.6009, device='cuda:0')
benign distance is  tensor(173.6009, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8209383636713028
distance x is tensor(114.2523, device='cuda:0')
benign distance is  tensor(114.2523, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.7430740930140018
distance x is tensor(102.9149, device='cuda:0')
benign distance is  tensor(102.9149, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5981821268796921
distance x is tensor(144.5460, device='cuda:0')
benign distance is  tensor(144.5460, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.3698256015777588
distance x is tensor(125.4229, device='cuda:0')
benign distance is  tensor(125.4229, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8489345405250788
distance x is tensor(112.1279, device='cuda:0')
benign distance is  tensor(112.1279, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8409799570217729
distance x is tensor(81.1088, device='cuda:0')
benign distance is  tensor(81.1088, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7984530255198479
distance x is tensor(99.9496, device='cuda:0')
benign distance is  tensor(99.9496, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7478532642126083
distance x is tensor(117.5408, device='cuda:0')
benign distance is  tensor(117.5408, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.477533683180809
distance x is tensor(116.5995, device='cuda:0')
benign distance is  tensor(116.5995, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.127764392644167
distance x is tensor(141.3732, device='cuda:0')
benign distance is  tensor(141.3732, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.2691014744341373
distance x is tensor(145.6778, device='cuda:0')
benign distance is  tensor(145.6778, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.0261649005115032
distance x is tensor(104.0500, device='cuda:0')
benign distance is  tensor(104.0500, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.569067906588316
distance x is tensor(156.5786, device='cuda:0')
benign distance is  tensor(156.5786, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7239143177866936
distance x is tensor(135.9031, device='cuda:0')
benign distance is  tensor(135.9031, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8544678874313831
distance x is tensor(101.6663, device='cuda:0')
benign distance is  tensor(101.6663, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5367070743814111
distance x is tensor(133.8031, device='cuda:0')
benign distance is  tensor(133.8031, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  5.85053163766861
distance x is tensor(259.9901, device='cuda:0')
benign distance is  tensor(259.9901, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  6.792135804891586
distance x is tensor(240.1413, device='cuda:0')
benign distance is  tensor(240.1413, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.295750558376312
distance x is tensor(253.6583, device='cuda:0')
benign distance is  tensor(253.6583, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  8.294149488210678
distance x is tensor(233.6058, device='cuda:0')
benign distance is  tensor(233.6058, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  6.505508661270142
distance x is tensor(187.7420, device='cuda:0')
benign distance is  tensor(187.7420, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  4.724764287471771
distance x is tensor(200.3091, device='cuda:0')
benign distance is  tensor(200.3091, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.818913668394089
distance x is tensor(237.1565, device='cuda:0')
benign distance is  tensor(237.1565, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  10.495973527431488
distance x is tensor(246.1150, device='cuda:0')
benign distance is  tensor(246.1150, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.452977776527405
distance x is tensor(215.3348, device='cuda:0')
benign distance is  tensor(215.3348, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.922184079885483
distance x is tensor(225.8151, device='cuda:0')
benign distance is  tensor(225.8151, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.882874578237534
distance x is tensor(234.9050, device='cuda:0')
benign distance is  tensor(234.9050, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  8.166325479745865
distance x is tensor(238.5047, device='cuda:0')
benign distance is  tensor(238.5047, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([540.5297, 514.7610, 508.9235, 714.3865, 473.7684, 435.5817, 497.0976,
        377.0184, 989.3231, 939.1640, 987.7843, 926.8890, 797.4632, 820.3243,
        919.0490, 986.3315, 854.9058, 921.0580, 921.8267, 952.8041],
       device='cuda:0')
sorted_norm is   tensor([377.0184, 435.5817, 473.7684, 497.0976, 508.9235, 514.7610, 540.5297,
        714.3865, 797.4632, 820.3243, 854.9058, 919.0490, 921.0580, 921.8267,
        926.8890, 939.1640, 952.8041, 986.3315, 987.7843, 989.3231],
       device='cuda:0')
used idx is  tensor([ 7,  5,  4,  6,  2,  1,  0,  3, 12, 13, 16, 14, 17, 18, 11,  9],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 83.78% 

Test Accuracy: 56.40% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7682568468153477
distance x is tensor(140.9067, device='cuda:0')
benign distance is  tensor(140.9067, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7133634686470032
distance x is tensor(129.7857, device='cuda:0')
benign distance is  tensor(129.7857, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7527778800576925
distance x is tensor(120.0480, device='cuda:0')
benign distance is  tensor(120.0480, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9097559694200754
distance x is tensor(164.0573, device='cuda:0')
benign distance is  tensor(164.0573, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8650041809305549
distance x is tensor(117.1052, device='cuda:0')
benign distance is  tensor(117.1052, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6755417645908892
distance x is tensor(129.1297, device='cuda:0')
benign distance is  tensor(129.1297, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.208043308928609
distance x is tensor(132.9239, device='cuda:0')
benign distance is  tensor(132.9239, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6346088396385312
distance x is tensor(113.7940, device='cuda:0')
benign distance is  tensor(113.7940, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  7.897200882434845
distance x is tensor(110.4392, device='cuda:0')
benign distance is  tensor(110.4392, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  6.596970915794373
distance x is tensor(149.4824, device='cuda:0')
benign distance is  tensor(149.4824, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  7.040766149759293
distance x is tensor(115.4435, device='cuda:0')
benign distance is  tensor(115.4435, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  8.731914341449738
distance x is tensor(127.4250, device='cuda:0')
benign distance is  tensor(127.4250, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.228979855775833
distance x is tensor(102.9816, device='cuda:0')
benign distance is  tensor(102.9816, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  5.395639806985855
distance x is tensor(119.8051, device='cuda:0')
benign distance is  tensor(119.8051, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.83525475859642
distance x is tensor(141.2431, device='cuda:0')
benign distance is  tensor(141.2431, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.245058655738831
distance x is tensor(110.3553, device='cuda:0')
benign distance is  tensor(110.3553, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.07114639878273
distance x is tensor(129.4494, device='cuda:0')
benign distance is  tensor(129.4494, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  11.010851979255676
distance x is tensor(119.7516, device='cuda:0')
benign distance is  tensor(119.7516, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.848431408405304
distance x is tensor(128.7012, device='cuda:0')
benign distance is  tensor(128.7012, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.123409181833267
distance x is tensor(158.7419, device='cuda:0')
benign distance is  tensor(158.7419, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([615.9078, 560.8065, 524.2484, 713.0044, 501.4365, 547.0366, 567.8155,
        487.6104, 535.6229, 723.8144, 561.7052, 604.4660, 521.7488, 579.2007,
        664.6105, 549.7678, 632.4872, 571.8090, 594.5340, 743.5872, 587.9498,
        664.4945, 519.2012, 623.4079, 797.8608, 419.0239, 694.1711, 679.4045],
       device='cuda:0')
sorted_norm is   tensor([419.0239, 487.6104, 501.4365, 519.2012, 521.7488, 524.2484, 535.6229,
        547.0366, 549.7678, 560.8065, 561.7052, 567.8155, 571.8090, 579.2007,
        587.9498, 594.5340, 604.4660, 615.9078, 623.4079, 632.4872, 664.4945,
        664.6105, 679.4045, 694.1711, 713.0044, 723.8144, 743.5872, 797.8608],
       device='cuda:0')
used idx is  tensor([25,  7,  4, 22, 12,  2,  8,  5, 15,  1, 10,  6, 17, 13, 20, 18, 11,  0,
        23, 16, 21, 14], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 91.67% 

Test Accuracy: 82.69% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6785124484449625
distance x is tensor(127.8254, device='cuda:0')
benign distance is  tensor(127.8254, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0113220401108265
distance x is tensor(103.1420, device='cuda:0')
benign distance is  tensor(103.1420, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7754893768578768
distance x is tensor(113.2532, device='cuda:0')
benign distance is  tensor(113.2532, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8816025722771883
distance x is tensor(147.5164, device='cuda:0')
benign distance is  tensor(147.5164, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9038573168218136
distance x is tensor(95.0111, device='cuda:0')
benign distance is  tensor(95.0111, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6898278305307031
distance x is tensor(125.1030, device='cuda:0')
benign distance is  tensor(125.1030, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.159916739910841
distance x is tensor(92.5352, device='cuda:0')
benign distance is  tensor(92.5352, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5793869104236364
distance x is tensor(91.9057, device='cuda:0')
benign distance is  tensor(91.9057, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8162137279286981
distance x is tensor(117.0428, device='cuda:0')
benign distance is  tensor(117.0428, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6294174147769809
distance x is tensor(126.6013, device='cuda:0')
benign distance is  tensor(126.6013, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0461936444044113
distance x is tensor(88.0334, device='cuda:0')
benign distance is  tensor(88.0334, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4373131804168224
distance x is tensor(116.1917, device='cuda:0')
benign distance is  tensor(116.1917, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0260949432849884
distance x is tensor(168.6809, device='cuda:0')
benign distance is  tensor(168.6809, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6639658249914646
distance x is tensor(70.3492, device='cuda:0')
benign distance is  tensor(70.3492, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9699071794748306
distance x is tensor(142.3729, device='cuda:0')
benign distance is  tensor(142.3729, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3028912991285324
distance x is tensor(121.5143, device='cuda:0')
benign distance is  tensor(121.5143, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.111545622348785
distance x is tensor(145.3225, device='cuda:0')
benign distance is  tensor(145.3225, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  6.469167739152908
distance x is tensor(153.2762, device='cuda:0')
benign distance is  tensor(153.2762, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.298655956983566
distance x is tensor(121.9697, device='cuda:0')
benign distance is  tensor(121.9697, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  11.204402208328247
distance x is tensor(124.8447, device='cuda:0')
benign distance is  tensor(124.8447, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.5604372918605804
distance x is tensor(106.9243, device='cuda:0')
benign distance is  tensor(106.9243, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  5.8939690589904785
distance x is tensor(129.4168, device='cuda:0')
benign distance is  tensor(129.4168, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.543238520622253
distance x is tensor(149.3704, device='cuda:0')
benign distance is  tensor(149.3704, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.641978323459625
distance x is tensor(130.6221, device='cuda:0')
benign distance is  tensor(130.6221, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  11.421517014503479
distance x is tensor(139.2582, device='cuda:0')
benign distance is  tensor(139.2582, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.881222307682037
distance x is tensor(130.2071, device='cuda:0')
benign distance is  tensor(130.2071, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.525317013263702
distance x is tensor(141.4088, device='cuda:0')
benign distance is  tensor(141.4088, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.007764458656311
distance x is tensor(169.1458, device='cuda:0')
benign distance is  tensor(169.1458, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([569.7587, 477.2896, 508.7352, 672.2770, 425.3616, 548.8207, 410.5925,
        408.1228, 630.2513, 725.5770, 548.1127, 567.8578, 511.0032, 614.9135,
        664.6357, 568.3348, 638.5244, 591.9171, 611.4085, 765.9500, 590.3506,
        578.2347, 594.6360, 608.8267, 458.1757, 975.3836, 746.7157, 575.1611],
       device='cuda:0')
sorted_norm is   tensor([408.1228, 410.5925, 425.3616, 458.1757, 477.2896, 508.7352, 511.0032,
        548.1127, 548.8207, 567.8578, 568.3348, 569.7587, 575.1611, 578.2347,
        590.3506, 591.9171, 594.6360, 608.8267, 611.4085, 614.9135, 630.2513,
        638.5244, 664.6357, 672.2770, 725.5770, 746.7157, 765.9500, 975.3836],
       device='cuda:0')
used idx is  tensor([ 7,  6,  4, 24,  1,  2, 12, 10,  5, 11, 15,  0, 27, 21, 20, 17, 22, 23,
        18, 13,  8, 16], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 90.82% 

Test Accuracy: 76.02% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7354864962399006
distance x is tensor(114.6368, device='cuda:0')
benign distance is  tensor(114.6368, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7421060111373663
distance x is tensor(103.6745, device='cuda:0')
benign distance is  tensor(103.6745, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7142785396426916
distance x is tensor(113.4682, device='cuda:0')
benign distance is  tensor(113.4682, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7339245155453682
distance x is tensor(149.4001, device='cuda:0')
benign distance is  tensor(149.4001, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8901955736801028
distance x is tensor(105.2125, device='cuda:0')
benign distance is  tensor(105.2125, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7319437880069017
distance x is tensor(112.9695, device='cuda:0')
benign distance is  tensor(112.9695, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1098565384745598
distance x is tensor(111.3842, device='cuda:0')
benign distance is  tensor(111.3842, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6415869891643524
distance x is tensor(97.6619, device='cuda:0')
benign distance is  tensor(97.6619, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.0548048615455627
distance x is tensor(104.1894, device='cuda:0')
benign distance is  tensor(104.1894, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8056865558028221
distance x is tensor(118.2734, device='cuda:0')
benign distance is  tensor(118.2734, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.1112084984779358
distance x is tensor(122.3809, device='cuda:0')
benign distance is  tensor(122.3809, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8455115463584661
distance x is tensor(128.7959, device='cuda:0')
benign distance is  tensor(128.7959, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9805854838341475
distance x is tensor(90.8164, device='cuda:0')
benign distance is  tensor(90.8164, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6867923699319363
distance x is tensor(210.5236, device='cuda:0')
benign distance is  tensor(210.5236, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.3400965221226215
distance x is tensor(169.5934, device='cuda:0')
benign distance is  tensor(169.5934, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6452337708324194
distance x is tensor(112.1690, device='cuda:0')
benign distance is  tensor(112.1690, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.579625844955444
distance x is tensor(127.6015, device='cuda:0')
benign distance is  tensor(127.6015, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.543184041976929
distance x is tensor(151.2220, device='cuda:0')
benign distance is  tensor(151.2220, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.985764503479004
distance x is tensor(127.1355, device='cuda:0')
benign distance is  tensor(127.1355, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.70985534787178
distance x is tensor(120.4794, device='cuda:0')
benign distance is  tensor(120.4794, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.909074753522873
distance x is tensor(119.4963, device='cuda:0')
benign distance is  tensor(119.4963, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  5.729872316122055
distance x is tensor(124.2637, device='cuda:0')
benign distance is  tensor(124.2637, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.102275133132935
distance x is tensor(146.7428, device='cuda:0')
benign distance is  tensor(146.7428, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  9.967625200748444
distance x is tensor(115.5958, device='cuda:0')
benign distance is  tensor(115.5958, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.012611657381058
distance x is tensor(138.2550, device='cuda:0')
benign distance is  tensor(138.2550, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  12.08908611536026
distance x is tensor(121.5830, device='cuda:0')
benign distance is  tensor(121.5830, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.010277599096298
distance x is tensor(142.5817, device='cuda:0')
benign distance is  tensor(142.5817, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.822239518165588
distance x is tensor(161.9792, device='cuda:0')
benign distance is  tensor(161.9792, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([511.5092, 476.3908, 506.4588, 684.1360, 472.7288, 494.0153, 511.6485,
        439.8348, 568.2386, 706.6027, 580.4124, 563.5097, 554.7979, 585.2578,
        651.0351, 533.0711, 647.1295, 561.0091, 625.4986, 734.6138, 614.6417,
        454.1968, 730.9705, 603.2184, 602.2457, 617.4954, 552.3170, 843.5256,
        536.3668, 586.5237, 400.2212, 530.2075, 779.2531, 329.7451, 646.7870,
        563.4017], device='cuda:0')
sorted_norm is   tensor([329.7451, 400.2212, 439.8348, 454.1968, 472.7288, 476.3908, 494.0153,
        506.4588, 511.5092, 511.6485, 530.2075, 533.0711, 536.3668, 552.3170,
        554.7979, 561.0091, 563.4017, 563.5097, 568.2386, 580.4124, 585.2578,
        586.5237, 602.2457, 603.2184, 614.6417, 617.4954, 625.4986, 646.7870,
        647.1295, 651.0351, 684.1360, 706.6027, 730.9705, 734.6138, 779.2531,
        843.5256], device='cuda:0')
used idx is  tensor([33, 30,  7, 21,  4,  1,  5,  2,  0,  6, 31, 15, 28, 26, 12, 17, 35, 11,
         8, 10, 13, 29, 24, 23, 20, 25, 18, 34], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 91.73% 

Test Accuracy: 87.15% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6511985100805759
distance x is tensor(101.7178, device='cuda:0')
benign distance is  tensor(101.7178, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9407952520996332
distance x is tensor(103.5070, device='cuda:0')
benign distance is  tensor(103.5070, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6998382676392794
distance x is tensor(106.2678, device='cuda:0')
benign distance is  tensor(106.2678, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0697353668510914
distance x is tensor(150.2087, device='cuda:0')
benign distance is  tensor(150.2087, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7720189113169909
distance x is tensor(83.7699, device='cuda:0')
benign distance is  tensor(83.7699, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.567772529553622
distance x is tensor(99.0657, device='cuda:0')
benign distance is  tensor(99.0657, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2518539987504482
distance x is tensor(95.8719, device='cuda:0')
benign distance is  tensor(95.8719, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7112822849303484
distance x is tensor(81.5993, device='cuda:0')
benign distance is  tensor(81.5993, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0095241833478212
distance x is tensor(104.1755, device='cuda:0')
benign distance is  tensor(104.1755, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6251012831926346
distance x is tensor(118.3167, device='cuda:0')
benign distance is  tensor(118.3167, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.931993842124939
distance x is tensor(79.9732, device='cuda:0')
benign distance is  tensor(79.9732, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2901289239525795
distance x is tensor(108.4670, device='cuda:0')
benign distance is  tensor(108.4670, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.045752227306366
distance x is tensor(161.4002, device='cuda:0')
benign distance is  tensor(161.4002, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6722474005073309
distance x is tensor(65.4572, device='cuda:0')
benign distance is  tensor(65.4572, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0585644207894802
distance x is tensor(136.7990, device='cuda:0')
benign distance is  tensor(136.7990, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.312083438038826
distance x is tensor(120.5044, device='cuda:0')
benign distance is  tensor(120.5044, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9879459552466869
distance x is tensor(114.1097, device='cuda:0')
benign distance is  tensor(114.1097, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6929647754877806
distance x is tensor(106.5215, device='cuda:0')
benign distance is  tensor(106.5215, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9616763535887003
distance x is tensor(128.2043, device='cuda:0')
benign distance is  tensor(128.2043, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.0739906020462513
distance x is tensor(115.0949, device='cuda:0')
benign distance is  tensor(115.0949, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6643833164125681
distance x is tensor(117.1976, device='cuda:0')
benign distance is  tensor(117.1976, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9052513036876917
distance x is tensor(100.4970, device='cuda:0')
benign distance is  tensor(100.4970, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5139622073620558
distance x is tensor(109.6886, device='cuda:0')
benign distance is  tensor(109.6886, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7271144762635231
distance x is tensor(173.8306, device='cuda:0')
benign distance is  tensor(173.8306, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  10.575602889060974
distance x is tensor(194.0800, device='cuda:0')
benign distance is  tensor(194.0800, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  9.478487253189087
distance x is tensor(180.6659, device='cuda:0')
benign distance is  tensor(180.6659, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  10.828273296356201
distance x is tensor(161.2909, device='cuda:0')
benign distance is  tensor(161.2909, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.477602422237396
distance x is tensor(159.1202, device='cuda:0')
benign distance is  tensor(159.1202, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  6.986876547336578
distance x is tensor(137.8185, device='cuda:0')
benign distance is  tensor(137.8185, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.350968509912491
distance x is tensor(145.7975, device='cuda:0')
benign distance is  tensor(145.7975, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.32395988702774
distance x is tensor(172.2597, device='cuda:0')
benign distance is  tensor(172.2597, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  10.640039056539536
distance x is tensor(163.8133, device='cuda:0')
benign distance is  tensor(163.8133, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.699651062488556
distance x is tensor(167.4153, device='cuda:0')
benign distance is  tensor(167.4153, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.739576488733292
distance x is tensor(167.7904, device='cuda:0')
benign distance is  tensor(167.7904, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.573934853076935
distance x is tensor(164.8945, device='cuda:0')
benign distance is  tensor(164.8945, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.289937436580658
distance x is tensor(185.3273, device='cuda:0')
benign distance is  tensor(185.3273, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([469.5238, 480.7616, 490.9547, 689.2613, 374.6637, 437.7296, 429.2816,
        369.6510, 768.5686, 775.7411, 656.3069, 680.9049, 600.4585, 661.9376,
        719.6192, 677.5179, 713.6245, 696.4677, 671.5193, 797.5848, 595.6334,
        532.6952, 708.0684, 623.3402, 549.5349, 454.6380, 518.3575, 594.4847],
       device='cuda:0')
sorted_norm is   tensor([369.6510, 374.6637, 429.2816, 437.7296, 454.6380, 469.5238, 480.7616,
        490.9547, 518.3575, 532.6952, 549.5349, 594.4847, 595.6334, 600.4585,
        623.3402, 656.3069, 661.9376, 671.5193, 677.5179, 680.9049, 689.2613,
        696.4677, 708.0684, 713.6245, 719.6192, 768.5686, 775.7411, 797.5848],
       device='cuda:0')
used idx is  tensor([ 7,  4,  6,  5, 25,  0,  1,  2, 26, 21, 24, 27, 20, 12, 23, 10, 13, 18,
        15, 11,  3, 17], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 91.54% 

Test Accuracy: 75.81% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.722390104085207
distance x is tensor(109.1804, device='cuda:0')
benign distance is  tensor(109.1804, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6233841311186552
distance x is tensor(107.0530, device='cuda:0')
benign distance is  tensor(107.0530, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6744187008589506
distance x is tensor(115.3645, device='cuda:0')
benign distance is  tensor(115.3645, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9648452568799257
distance x is tensor(154.1534, device='cuda:0')
benign distance is  tensor(154.1534, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.849633714184165
distance x is tensor(109.0038, device='cuda:0')
benign distance is  tensor(109.0038, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6477712858468294
distance x is tensor(104.3328, device='cuda:0')
benign distance is  tensor(104.3328, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9955035652965307
distance x is tensor(100.6457, device='cuda:0')
benign distance is  tensor(100.6457, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6110363844782114
distance x is tensor(91.3579, device='cuda:0')
benign distance is  tensor(91.3579, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7876755278557539
distance x is tensor(125.3198, device='cuda:0')
benign distance is  tensor(125.3198, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.9068281184881926
distance x is tensor(104.6388, device='cuda:0')
benign distance is  tensor(104.6388, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6576681919395924
distance x is tensor(152.2180, device='cuda:0')
benign distance is  tensor(152.2180, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.4166275635361671
distance x is tensor(122.9554, device='cuda:0')
benign distance is  tensor(122.9554, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6508305119350553
distance x is tensor(121.2431, device='cuda:0')
benign distance is  tensor(121.2431, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7985300598666072
distance x is tensor(107.8337, device='cuda:0')
benign distance is  tensor(107.8337, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7652085311710835
distance x is tensor(98.8911, device='cuda:0')
benign distance is  tensor(98.8911, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8984569441527128
distance x is tensor(122.6286, device='cuda:0')
benign distance is  tensor(122.6286, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.412630498409271
distance x is tensor(146.4845, device='cuda:0')
benign distance is  tensor(146.4845, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.545344114303589
distance x is tensor(155.2895, device='cuda:0')
benign distance is  tensor(155.2895, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.320469409227371
distance x is tensor(128.2406, device='cuda:0')
benign distance is  tensor(128.2406, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  11.041723251342773
distance x is tensor(139.6555, device='cuda:0')
benign distance is  tensor(139.6555, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.75500813126564
distance x is tensor(122.7949, device='cuda:0')
benign distance is  tensor(122.7949, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.354487836360931
distance x is tensor(126.5979, device='cuda:0')
benign distance is  tensor(126.5979, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.092222839593887
distance x is tensor(140.8567, device='cuda:0')
benign distance is  tensor(140.8567, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.10057207942009
distance x is tensor(110.9916, device='cuda:0')
benign distance is  tensor(110.9916, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.190205484628677
distance x is tensor(143.9559, device='cuda:0')
benign distance is  tensor(143.9559, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  12.602924048900604
distance x is tensor(114.4267, device='cuda:0')
benign distance is  tensor(114.4267, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.086822867393494
distance x is tensor(138.9078, device='cuda:0')
benign distance is  tensor(138.9078, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.201509177684784
distance x is tensor(157.7000, device='cuda:0')
benign distance is  tensor(157.7000, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([497.9483, 497.6996, 520.4997, 704.1298, 496.7640, 466.8419, 453.4026,
        411.7365, 651.4121, 732.1825, 591.5740, 643.3571, 566.1907, 609.5107,
        642.5775, 523.8165, 655.5475, 539.7194, 614.4546, 725.5196, 602.9030,
        693.7429, 706.9930, 517.1290, 772.6924, 663.2018, 536.6447, 635.6056,
        487.5466, 569.9822, 550.0020, 603.1901, 409.7870, 945.5765, 756.9273,
        532.0851, 490.0455, 556.8545, 379.0650, 516.0292, 738.5280, 311.8340,
        626.3273, 567.4630], device='cuda:0')
sorted_norm is   tensor([311.8340, 379.0650, 409.7870, 411.7365, 453.4026, 466.8419, 487.5466,
        490.0455, 496.7640, 497.6996, 497.9483, 516.0292, 517.1290, 520.4997,
        523.8165, 532.0851, 536.6447, 539.7194, 550.0020, 556.8545, 566.1907,
        567.4630, 569.9822, 591.5740, 602.9030, 603.1901, 609.5107, 614.4546,
        626.3273, 635.6056, 642.5775, 643.3571, 651.4121, 655.5475, 663.2018,
        693.7429, 704.1298, 706.9930, 725.5196, 732.1825, 738.5280, 756.9273,
        772.6924, 945.5765], device='cuda:0')
used idx is  tensor([41, 38, 32,  7,  6,  5, 28, 36,  4,  1,  0, 39, 23,  2, 15, 35, 26, 17,
        30, 37, 12, 43, 29, 10, 20, 31, 13, 18, 42, 27, 14, 11,  8, 16, 25],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 91.54% 

Test Accuracy: 86.71% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6509931888431311
distance x is tensor(110.8208, device='cuda:0')
benign distance is  tensor(110.8208, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7702908404171467
distance x is tensor(97.6991, device='cuda:0')
benign distance is  tensor(97.6991, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7049737200140953
distance x is tensor(105.9322, device='cuda:0')
benign distance is  tensor(105.9322, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9518965426832438
distance x is tensor(147.1083, device='cuda:0')
benign distance is  tensor(147.1083, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3185144402086735
distance x is tensor(88.9803, device='cuda:0')
benign distance is  tensor(88.9803, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6188554866239429
distance x is tensor(104.8180, device='cuda:0')
benign distance is  tensor(104.8180, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3575366623699665
distance x is tensor(87.7877, device='cuda:0')
benign distance is  tensor(87.7877, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5845166780054569
distance x is tensor(84.8467, device='cuda:0')
benign distance is  tensor(84.8467, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9211541097611189
distance x is tensor(104.2215, device='cuda:0')
benign distance is  tensor(104.2215, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5741490260697901
distance x is tensor(111.4594, device='cuda:0')
benign distance is  tensor(111.4594, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8623782210052013
distance x is tensor(77.6301, device='cuda:0')
benign distance is  tensor(77.6301, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2345366664230824
distance x is tensor(121.4806, device='cuda:0')
benign distance is  tensor(121.4806, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9476537741720676
distance x is tensor(160.3645, device='cuda:0')
benign distance is  tensor(160.3645, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6691554486751556
distance x is tensor(67.7310, device='cuda:0')
benign distance is  tensor(67.7310, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7920677866786718
distance x is tensor(137.4362, device='cuda:0')
benign distance is  tensor(137.4362, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3024943061172962
distance x is tensor(118.2653, device='cuda:0')
benign distance is  tensor(118.2653, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1031636372208595
distance x is tensor(101.1965, device='cuda:0')
benign distance is  tensor(101.1965, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.700168807990849
distance x is tensor(103.8490, device='cuda:0')
benign distance is  tensor(103.8490, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9337742058560252
distance x is tensor(120.7837, device='cuda:0')
benign distance is  tensor(120.7837, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8072458133101463
distance x is tensor(114.4619, device='cuda:0')
benign distance is  tensor(114.4619, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9044195767492056
distance x is tensor(74.8714, device='cuda:0')
benign distance is  tensor(74.8714, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6400856804102659
distance x is tensor(212.6353, device='cuda:0')
benign distance is  tensor(212.6353, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1024764589965343
distance x is tensor(156.7058, device='cuda:0')
benign distance is  tensor(156.7058, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5649180877953768
distance x is tensor(111.5660, device='cuda:0')
benign distance is  tensor(111.5660, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.2442086599767208
distance x is tensor(107.7583, device='cuda:0')
benign distance is  tensor(107.7583, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.0780277960002422
distance x is tensor(138.0689, device='cuda:0')
benign distance is  tensor(138.0689, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.0110975950956345
distance x is tensor(147.1200, device='cuda:0')
benign distance is  tensor(147.1200, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.9884387068450451
distance x is tensor(89.2407, device='cuda:0')
benign distance is  tensor(89.2407, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6322074849158525
distance x is tensor(158.9905, device='cuda:0')
benign distance is  tensor(158.9905, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7456253115087748
distance x is tensor(132.6084, device='cuda:0')
benign distance is  tensor(132.6084, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7900685872882605
distance x is tensor(101.4889, device='cuda:0')
benign distance is  tensor(101.4889, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5654157558456063
distance x is tensor(124.8983, device='cuda:0')
benign distance is  tensor(124.8983, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.529263019561768
distance x is tensor(165.6045, device='cuda:0')
benign distance is  tensor(165.6045, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.9909133315086365
distance x is tensor(167.6787, device='cuda:0')
benign distance is  tensor(167.6787, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.704305410385132
distance x is tensor(160.0921, device='cuda:0')
benign distance is  tensor(160.0921, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  11.377310454845428
distance x is tensor(149.5735, device='cuda:0')
benign distance is  tensor(149.5735, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.71826857328415
distance x is tensor(130.5965, device='cuda:0')
benign distance is  tensor(130.5965, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.935200780630112
distance x is tensor(139.3895, device='cuda:0')
benign distance is  tensor(139.3895, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.830622792243958
distance x is tensor(173.2378, device='cuda:0')
benign distance is  tensor(173.2378, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.770706832408905
distance x is tensor(162.7212, device='cuda:0')
benign distance is  tensor(162.7212, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  11.778245508670807
distance x is tensor(162.3910, device='cuda:0')
benign distance is  tensor(162.3910, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  11.321901738643646
distance x is tensor(163.4217, device='cuda:0')
benign distance is  tensor(163.4217, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.649433672428131
distance x is tensor(170.7319, device='cuda:0')
benign distance is  tensor(170.7319, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.155264556407928
distance x is tensor(182.0625, device='cuda:0')
benign distance is  tensor(182.0625, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([509.6141, 464.9420, 495.7594, 675.9387, 395.7415, 469.3823, 396.9596,
        394.7931, 680.1279, 737.2298, 661.1888, 634.1191, 582.0981, 627.0942,
        721.2764, 681.6827, 687.3363, 690.9230, 703.5410, 772.8885],
       device='cuda:0')
sorted_norm is   tensor([394.7931, 395.7415, 396.9596, 464.9420, 469.3823, 495.7594, 509.6141,
        582.0981, 627.0942, 634.1191, 661.1888, 675.9387, 680.1279, 681.6827,
        687.3363, 690.9230, 703.5410, 721.2764, 737.2298, 772.8885],
       device='cuda:0')
used idx is  tensor([ 7,  4,  6,  1,  5,  2,  0, 12, 13, 11, 10,  3,  8, 15, 16, 17],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 66.51% 

Test Accuracy: 25.34% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6895878743380308
distance x is tensor(134.2461, device='cuda:0')
benign distance is  tensor(134.2461, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7968655955046415
distance x is tensor(126.7244, device='cuda:0')
benign distance is  tensor(126.7244, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7569823693484068
distance x is tensor(127.7180, device='cuda:0')
benign distance is  tensor(127.7180, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9216545484960079
distance x is tensor(171.6890, device='cuda:0')
benign distance is  tensor(171.6890, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9310669107362628
distance x is tensor(129.9061, device='cuda:0')
benign distance is  tensor(129.9061, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7774442043155432
distance x is tensor(130.9619, device='cuda:0')
benign distance is  tensor(130.9619, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4406704138964415
distance x is tensor(128.5016, device='cuda:0')
benign distance is  tensor(128.5016, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8275707066059113
distance x is tensor(125.7496, device='cuda:0')
benign distance is  tensor(125.7496, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  7.692466586828232
distance x is tensor(97.1498, device='cuda:0')
benign distance is  tensor(97.1498, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.322461575269699
distance x is tensor(134.9779, device='cuda:0')
benign distance is  tensor(134.9779, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.960737824440002
distance x is tensor(102.1218, device='cuda:0')
benign distance is  tensor(102.1218, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.389446347951889
distance x is tensor(104.5411, device='cuda:0')
benign distance is  tensor(104.5411, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.16913190484047
distance x is tensor(92.5600, device='cuda:0')
benign distance is  tensor(92.5600, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.6160478591918945
distance x is tensor(109.6250, device='cuda:0')
benign distance is  tensor(109.6250, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.827521592378616
distance x is tensor(125.3333, device='cuda:0')
benign distance is  tensor(125.3333, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  9.82916310429573
distance x is tensor(90.7615, device='cuda:0')
benign distance is  tensor(90.7615, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.904728293418884
distance x is tensor(119.9585, device='cuda:0')
benign distance is  tensor(119.9585, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.773283183574677
distance x is tensor(101.7244, device='cuda:0')
benign distance is  tensor(101.7244, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.977354824543
distance x is tensor(115.6326, device='cuda:0')
benign distance is  tensor(115.6326, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.248262822628021
distance x is tensor(149.0143, device='cuda:0')
benign distance is  tensor(149.0143, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([578.2822, 555.8975, 565.3968, 750.4164, 557.8844, 546.7451, 546.4797,
        530.1669, 462.0861, 655.6888, 487.3630, 503.6979, 456.2450, 545.7520,
        586.5051, 428.4335, 582.6930, 490.6059, 527.5286, 689.6841, 571.6981,
        541.2911, 631.6225, 587.1297, 588.8480, 524.4907, 547.8007, 813.4495,
        514.6324, 553.7256, 414.5364, 606.1252, 759.7573, 363.1025, 649.0861,
        584.6214], device='cuda:0')
sorted_norm is   tensor([363.1025, 414.5364, 428.4335, 456.2450, 462.0861, 487.3630, 490.6059,
        503.6979, 514.6324, 524.4907, 527.5286, 530.1669, 541.2911, 545.7520,
        546.4797, 546.7451, 547.8007, 553.7256, 555.8975, 557.8844, 565.3968,
        571.6981, 578.2822, 582.6930, 584.6214, 586.5051, 587.1297, 588.8480,
        606.1252, 631.6225, 649.0861, 655.6888, 689.6841, 750.4164, 759.7573,
        813.4495], device='cuda:0')
used idx is  tensor([33, 30, 15, 12,  8, 10, 17, 11, 28, 25, 18,  7, 21, 13,  6,  5, 26, 29,
         1,  4,  2, 20,  0, 16, 35, 14, 23, 24], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 91.02% 

Test Accuracy: 86.99% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7728506308048964
distance x is tensor(123.7294, device='cuda:0')
benign distance is  tensor(123.7294, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7765977401286364
distance x is tensor(100.8458, device='cuda:0')
benign distance is  tensor(100.8458, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.709969062358141
distance x is tensor(104.4628, device='cuda:0')
benign distance is  tensor(104.4628, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0097874775528908
distance x is tensor(145.2558, device='cuda:0')
benign distance is  tensor(145.2558, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7754036597907543
distance x is tensor(98.4922, device='cuda:0')
benign distance is  tensor(98.4922, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7092919424176216
distance x is tensor(105.3526, device='cuda:0')
benign distance is  tensor(105.3526, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9350241050124168
distance x is tensor(88.2976, device='cuda:0')
benign distance is  tensor(88.2976, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6571827018633485
distance x is tensor(83.3733, device='cuda:0')
benign distance is  tensor(83.3733, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7610951606184244
distance x is tensor(94.2096, device='cuda:0')
benign distance is  tensor(94.2096, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6253158822655678
distance x is tensor(129.9328, device='cuda:0')
benign distance is  tensor(129.9328, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1377920508384705
distance x is tensor(79.0124, device='cuda:0')
benign distance is  tensor(79.0124, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9463326893746853
distance x is tensor(112.0314, device='cuda:0')
benign distance is  tensor(112.0314, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.850964704528451
distance x is tensor(172.7165, device='cuda:0')
benign distance is  tensor(172.7165, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6902049351483583
distance x is tensor(59.4612, device='cuda:0')
benign distance is  tensor(59.4612, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0077073108404875
distance x is tensor(153.9548, device='cuda:0')
benign distance is  tensor(153.9548, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.489153627306223
distance x is tensor(124.7192, device='cuda:0')
benign distance is  tensor(124.7192, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.345132503658533
distance x is tensor(111.6793, device='cuda:0')
benign distance is  tensor(111.6793, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6274448558688164
distance x is tensor(87.9863, device='cuda:0')
benign distance is  tensor(87.9863, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.009399976581335
distance x is tensor(131.9556, device='cuda:0')
benign distance is  tensor(131.9556, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2328006364405155
distance x is tensor(105.8677, device='cuda:0')
benign distance is  tensor(105.8677, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7893909085541964
distance x is tensor(124.0221, device='cuda:0')
benign distance is  tensor(124.0221, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7977240867912769
distance x is tensor(146.0775, device='cuda:0')
benign distance is  tensor(146.0775, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5781547194346786
distance x is tensor(112.5565, device='cuda:0')
benign distance is  tensor(112.5565, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.8999851606786251
distance x is tensor(167.7068, device='cuda:0')
benign distance is  tensor(167.7068, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.802136600017548
distance x is tensor(172.1088, device='cuda:0')
benign distance is  tensor(172.1088, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  9.09269204735756
distance x is tensor(165.1473, device='cuda:0')
benign distance is  tensor(165.1473, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  10.511133074760437
distance x is tensor(145.2883, device='cuda:0')
benign distance is  tensor(145.2883, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  11.96944284439087
distance x is tensor(154.5855, device='cuda:0')
benign distance is  tensor(154.5855, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.199776619672775
distance x is tensor(130.8963, device='cuda:0')
benign distance is  tensor(130.8963, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.6622553169727325
distance x is tensor(144.0126, device='cuda:0')
benign distance is  tensor(144.0126, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.725322306156158
distance x is tensor(165.0261, device='cuda:0')
benign distance is  tensor(165.0261, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  10.599543571472168
distance x is tensor(138.8781, device='cuda:0')
benign distance is  tensor(138.8781, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  11.210717141628265
distance x is tensor(166.2142, device='cuda:0')
benign distance is  tensor(166.2142, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  12.583839416503906
distance x is tensor(146.0927, device='cuda:0')
benign distance is  tensor(146.0927, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.060764372348785
distance x is tensor(163.3009, device='cuda:0')
benign distance is  tensor(163.3009, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.391645550727844
distance x is tensor(176.0242, device='cuda:0')
benign distance is  tensor(176.0242, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([554.3017, 471.4799, 484.5983, 668.6971, 450.8104, 461.9990, 405.9574,
        377.9895, 685.1920, 718.9412, 601.3909, 642.7656, 562.3593, 629.3961,
        688.8516, 595.7170, 694.3659, 633.3911, 676.5590, 760.1240, 473.4530,
        500.4874, 541.4225, 549.1207, 355.2658, 963.7087, 706.5809, 520.2875],
       device='cuda:0')
sorted_norm is   tensor([355.2658, 377.9895, 405.9574, 450.8104, 461.9990, 471.4799, 473.4530,
        484.5983, 500.4874, 520.2875, 541.4225, 549.1207, 554.3017, 562.3593,
        595.7170, 601.3909, 629.3961, 633.3911, 642.7656, 668.6971, 676.5590,
        685.1920, 688.8516, 694.3659, 706.5809, 718.9412, 760.1240, 963.7087],
       device='cuda:0')
used idx is  tensor([24,  7,  6,  4,  5,  1, 20,  2, 21, 27, 22, 23,  0, 12, 15, 10, 13, 17,
        11,  3, 18,  8], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 79.72% 

Test Accuracy: 43.36% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6928420327603817
distance x is tensor(128.7310, device='cuda:0')
benign distance is  tensor(128.7310, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8855909556150436
distance x is tensor(112.4390, device='cuda:0')
benign distance is  tensor(112.4390, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6425678860396147
distance x is tensor(121.7932, device='cuda:0')
benign distance is  tensor(121.7932, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9861245192587376
distance x is tensor(161.5902, device='cuda:0')
benign distance is  tensor(161.5902, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2962273713201284
distance x is tensor(113.2626, device='cuda:0')
benign distance is  tensor(113.2626, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7394863562658429
distance x is tensor(118.8817, device='cuda:0')
benign distance is  tensor(118.8817, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4486666936427355
distance x is tensor(105.7587, device='cuda:0')
benign distance is  tensor(105.7587, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5861453264951706
distance x is tensor(103.6291, device='cuda:0')
benign distance is  tensor(103.6291, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.0457764230668545
distance x is tensor(129.8215, device='cuda:0')
benign distance is  tensor(129.8215, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7366280080750585
distance x is tensor(129.7436, device='cuda:0')
benign distance is  tensor(129.7436, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9520264379680157
distance x is tensor(136.8272, device='cuda:0')
benign distance is  tensor(136.8272, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9355121720582247
distance x is tensor(141.9510, device='cuda:0')
benign distance is  tensor(141.9510, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9734717169776559
distance x is tensor(109.5455, device='cuda:0')
benign distance is  tensor(109.5455, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6916384659707546
distance x is tensor(218.5430, device='cuda:0')
benign distance is  tensor(218.5430, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0699272323399782
distance x is tensor(166.1230, device='cuda:0')
benign distance is  tensor(166.1230, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7932710945606232
distance x is tensor(133.1258, device='cuda:0')
benign distance is  tensor(133.1258, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.097553730010986
distance x is tensor(114.6337, device='cuda:0')
benign distance is  tensor(114.6337, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.169010132551193
distance x is tensor(143.6710, device='cuda:0')
benign distance is  tensor(143.6710, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.552448123693466
distance x is tensor(104.5389, device='cuda:0')
benign distance is  tensor(104.5389, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  12.497937381267548
distance x is tensor(114.4757, device='cuda:0')
benign distance is  tensor(114.4757, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.887162268161774
distance x is tensor(94.7853, device='cuda:0')
benign distance is  tensor(94.7853, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.214333534240723
distance x is tensor(114.9565, device='cuda:0')
benign distance is  tensor(114.9565, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.156134009361267
distance x is tensor(128.2052, device='cuda:0')
benign distance is  tensor(128.2052, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.742489248514175
distance x is tensor(101.6330, device='cuda:0')
benign distance is  tensor(101.6330, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.531767904758453
distance x is tensor(125.5757, device='cuda:0')
benign distance is  tensor(125.5757, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.315002202987671
distance x is tensor(108.5756, device='cuda:0')
benign distance is  tensor(108.5756, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.452439725399017
distance x is tensor(122.7781, device='cuda:0')
benign distance is  tensor(122.7781, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.516773879528046
distance x is tensor(153.1737, device='cuda:0')
benign distance is  tensor(153.1737, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([579.6411, 516.6151, 552.7487, 720.7759, 489.9779, 519.7316, 461.6539,
        462.6172, 529.4888, 693.0948, 483.1361, 554.3929, 446.2218, 569.2674,
        594.4323, 492.7133, 589.2883, 502.6490, 564.0069, 702.5140, 623.1708,
        513.1180, 718.3610, 601.9618, 577.1844, 539.0128, 496.8687, 603.4855,
        457.8036, 602.8427, 369.9878, 530.2750, 800.6219, 307.5380, 709.5933,
        576.0350], device='cuda:0')
sorted_norm is   tensor([307.5380, 369.9878, 446.2218, 457.8036, 461.6539, 462.6172, 483.1361,
        489.9779, 492.7133, 496.8687, 502.6490, 513.1180, 516.6151, 519.7316,
        529.4888, 530.2750, 539.0128, 552.7487, 554.3929, 564.0069, 569.2674,
        576.0350, 577.1844, 579.6411, 589.2883, 594.4323, 601.9618, 602.8427,
        603.4855, 623.1708, 693.0948, 702.5140, 709.5933, 718.3610, 720.7759,
        800.6219], device='cuda:0')
used idx is  tensor([33, 30, 12, 28,  6,  7, 10,  4, 15, 26, 17, 21,  1,  5,  8, 31, 25,  2,
        11, 18, 13, 35, 24,  0, 16, 14, 23, 29], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 91.02% 

Test Accuracy: 87.14% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6806423217058182
distance x is tensor(108.0739, device='cuda:0')
benign distance is  tensor(108.0739, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8573652319610119
distance x is tensor(101.2991, device='cuda:0')
benign distance is  tensor(101.2991, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7469266448169947
distance x is tensor(105.8578, device='cuda:0')
benign distance is  tensor(105.8578, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9696911498904228
distance x is tensor(150.0919, device='cuda:0')
benign distance is  tensor(150.0919, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7390202302485704
distance x is tensor(79.7645, device='cuda:0')
benign distance is  tensor(79.7645, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6832303418777883
distance x is tensor(100.5623, device='cuda:0')
benign distance is  tensor(100.5623, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1727062109857798
distance x is tensor(100.0208, device='cuda:0')
benign distance is  tensor(100.0208, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6924648974090815
distance x is tensor(83.3519, device='cuda:0')
benign distance is  tensor(83.3519, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8915310157462955
distance x is tensor(98.1713, device='cuda:0')
benign distance is  tensor(98.1713, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.643136193510145
distance x is tensor(112.5663, device='cuda:0')
benign distance is  tensor(112.5663, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9955729134380817
distance x is tensor(72.6173, device='cuda:0')
benign distance is  tensor(72.6173, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3809495866298676
distance x is tensor(113.0545, device='cuda:0')
benign distance is  tensor(113.0545, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.023226598277688
distance x is tensor(175.4805, device='cuda:0')
benign distance is  tensor(175.4805, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7090680589899421
distance x is tensor(68.3806, device='cuda:0')
benign distance is  tensor(68.3806, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.2274782210588455
distance x is tensor(139.9598, device='cuda:0')
benign distance is  tensor(139.9598, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3814345244318247
distance x is tensor(123.8829, device='cuda:0')
benign distance is  tensor(123.8829, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.9057964067906141
distance x is tensor(122.6552, device='cuda:0')
benign distance is  tensor(122.6552, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.8600658755749464
distance x is tensor(112.1447, device='cuda:0')
benign distance is  tensor(112.1447, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7990711238235235
distance x is tensor(156.3061, device='cuda:0')
benign distance is  tensor(156.3061, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.4079348631203175
distance x is tensor(123.3966, device='cuda:0')
benign distance is  tensor(123.3966, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7946161180734634
distance x is tensor(104.2297, device='cuda:0')
benign distance is  tensor(104.2297, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7258855979889631
distance x is tensor(92.2766, device='cuda:0')
benign distance is  tensor(92.2766, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.8259257506579161
distance x is tensor(88.2449, device='cuda:0')
benign distance is  tensor(88.2449, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7385239843279123
distance x is tensor(123.2256, device='cuda:0')
benign distance is  tensor(123.2256, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  10.121015697717667
distance x is tensor(152.1643, device='cuda:0')
benign distance is  tensor(152.1643, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  10.316991567611694
distance x is tensor(165.1469, device='cuda:0')
benign distance is  tensor(165.1469, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.656731277704239
distance x is tensor(168.0386, device='cuda:0')
benign distance is  tensor(168.0386, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  11.12919545173645
distance x is tensor(152.8514, device='cuda:0')
benign distance is  tensor(152.8514, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  6.177574962377548
distance x is tensor(121.2425, device='cuda:0')
benign distance is  tensor(121.2425, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.537472307682037
distance x is tensor(145.9764, device='cuda:0')
benign distance is  tensor(145.9764, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.03418219089508
distance x is tensor(157.6435, device='cuda:0')
benign distance is  tensor(157.6435, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  9.857355445623398
distance x is tensor(160.9338, device='cuda:0')
benign distance is  tensor(160.9338, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.395251542329788
distance x is tensor(154.7297, device='cuda:0')
benign distance is  tensor(154.7297, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  12.539680421352386
distance x is tensor(163.2775, device='cuda:0')
benign distance is  tensor(163.2775, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  10.282371878623962
distance x is tensor(164.0199, device='cuda:0')
benign distance is  tensor(164.0199, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  11.243023931980133
distance x is tensor(177.0786, device='cuda:0')
benign distance is  tensor(177.0786, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([499.1692, 473.4170, 485.8333, 700.9156, 361.9514, 456.2754, 462.0840,
        382.7766, 630.2640, 725.0618, 688.1320, 646.2552, 522.3890, 652.1744,
        665.8691, 664.8958, 671.5527, 672.9305, 673.8150, 763.6916],
       device='cuda:0')
sorted_norm is   tensor([361.9514, 382.7766, 456.2754, 462.0840, 473.4170, 485.8333, 499.1692,
        522.3890, 630.2640, 646.2552, 652.1744, 664.8958, 665.8691, 671.5527,
        672.9305, 673.8150, 688.1320, 700.9156, 725.0618, 763.6916],
       device='cuda:0')
used idx is  tensor([ 4,  7,  5,  6,  1,  2,  0, 12,  8, 11, 13, 15, 14, 16, 17, 18],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 59.11% 

Test Accuracy: 17.85% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7132594585418701
distance x is tensor(142.9550, device='cuda:0')
benign distance is  tensor(142.9550, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.160667471587658
distance x is tensor(136.7069, device='cuda:0')
benign distance is  tensor(136.7069, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.070529317483306
distance x is tensor(146.8520, device='cuda:0')
benign distance is  tensor(146.8520, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9439869560301304
distance x is tensor(182.6831, device='cuda:0')
benign distance is  tensor(182.6831, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4107683189213276
distance x is tensor(149.5406, device='cuda:0')
benign distance is  tensor(149.5406, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8425615783780813
distance x is tensor(149.4471, device='cuda:0')
benign distance is  tensor(149.4471, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3889265805482864
distance x is tensor(136.1178, device='cuda:0')
benign distance is  tensor(136.1178, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8864828515797853
distance x is tensor(129.9957, device='cuda:0')
benign distance is  tensor(129.9957, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.195439964532852
distance x is tensor(91.2982, device='cuda:0')
benign distance is  tensor(91.2982, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.883336395025253
distance x is tensor(139.3991, device='cuda:0')
benign distance is  tensor(139.3991, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.439290821552277
distance x is tensor(100.5585, device='cuda:0')
benign distance is  tensor(100.5585, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.681194067001343
distance x is tensor(101.4355, device='cuda:0')
benign distance is  tensor(101.4355, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.397334158420563
distance x is tensor(84.4133, device='cuda:0')
benign distance is  tensor(84.4133, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  8.093942821025848
distance x is tensor(106.1643, device='cuda:0')
benign distance is  tensor(106.1643, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.871175587177277
distance x is tensor(122.1107, device='cuda:0')
benign distance is  tensor(122.1107, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.976512432098389
distance x is tensor(87.0875, device='cuda:0')
benign distance is  tensor(87.0875, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.368133187294006
distance x is tensor(114.6978, device='cuda:0')
benign distance is  tensor(114.6978, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  12.274937450885773
distance x is tensor(93.7253, device='cuda:0')
benign distance is  tensor(93.7253, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  10.314158737659454
distance x is tensor(106.4498, device='cuda:0')
benign distance is  tensor(106.4498, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  6.963458061218262
distance x is tensor(149.9421, device='cuda:0')
benign distance is  tensor(149.9421, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([618.4080, 597.7728, 638.7020, 779.0832, 653.2010, 635.6088, 588.3146,
        563.3434, 440.4330, 657.7246, 486.5493, 488.0250, 409.0306, 515.8937,
        565.1647, 419.5824, 542.4869, 440.4731, 481.2000, 689.9493, 597.7297,
        718.6727, 728.7630, 514.0916, 785.6611, 675.1422, 553.3337, 634.7431,
        571.7423, 500.9427, 654.7551, 562.9811, 622.9852, 728.1943, 572.4228,
        798.5124, 612.6855, 636.4539, 644.8860, 685.6862, 535.6061, 992.6803,
        770.3147, 639.8180, 488.0663, 552.4929, 394.7705, 563.2701, 818.5494,
        373.6905, 670.3071, 615.0385], device='cuda:0')
sorted_norm is   tensor([373.6905, 394.7705, 409.0306, 419.5824, 440.4330, 440.4731, 481.2000,
        486.5493, 488.0250, 488.0663, 500.9427, 514.0916, 515.8937, 535.6061,
        542.4869, 552.4929, 553.3337, 562.9811, 563.2701, 563.3434, 565.1647,
        571.7423, 572.4228, 588.3146, 597.7297, 597.7728, 612.6855, 615.0385,
        618.4080, 622.9852, 634.7431, 635.6088, 636.4539, 638.7020, 639.8180,
        644.8860, 653.2010, 654.7551, 657.7246, 670.3071, 675.1422, 685.6862,
        689.9493, 718.6727, 728.1943, 728.7630, 770.3147, 779.0832, 785.6611,
        798.5124, 818.5494, 992.6803], device='cuda:0')
used idx is  tensor([49, 46, 12, 15,  8, 17, 18, 10, 11, 44, 29, 23, 13, 40, 16, 45, 26, 31,
        47,  7, 14, 28, 34,  6, 20,  1, 36, 51,  0, 32, 27,  5, 37,  2, 43, 38,
         4, 30,  9, 50, 25], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 90.09% 

Test Accuracy: 87.35% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9427768811583519
distance x is tensor(95.7884, device='cuda:0')
benign distance is  tensor(95.7884, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6963935252279043
distance x is tensor(97.0797, device='cuda:0')
benign distance is  tensor(97.0797, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6528356559574604
distance x is tensor(101.4427, device='cuda:0')
benign distance is  tensor(101.4427, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8159902226179838
distance x is tensor(147.6867, device='cuda:0')
benign distance is  tensor(147.6867, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9161729775369167
distance x is tensor(76.5501, device='cuda:0')
benign distance is  tensor(76.5501, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7014569872990251
distance x is tensor(93.2502, device='cuda:0')
benign distance is  tensor(93.2502, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1141451299190521
distance x is tensor(82.9359, device='cuda:0')
benign distance is  tensor(82.9359, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6616531927138567
distance x is tensor(85.0031, device='cuda:0')
benign distance is  tensor(85.0031, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0439330376684666
distance x is tensor(103.2031, device='cuda:0')
benign distance is  tensor(103.2031, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6768934084102511
distance x is tensor(122.3749, device='cuda:0')
benign distance is  tensor(122.3749, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.090536905452609
distance x is tensor(65.8409, device='cuda:0')
benign distance is  tensor(65.8409, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4633697159588337
distance x is tensor(108.3866, device='cuda:0')
benign distance is  tensor(108.3866, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8513827668502927
distance x is tensor(166.3704, device='cuda:0')
benign distance is  tensor(166.3704, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7621702449396253
distance x is tensor(61.2624, device='cuda:0')
benign distance is  tensor(61.2624, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9668191764503717
distance x is tensor(143.6116, device='cuda:0')
benign distance is  tensor(143.6116, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2417178638279438
distance x is tensor(125.9097, device='cuda:0')
benign distance is  tensor(125.9097, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.155601553618908
distance x is tensor(83.7420, device='cuda:0')
benign distance is  tensor(83.7420, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7557023046538234
distance x is tensor(105.1558, device='cuda:0')
benign distance is  tensor(105.1558, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9377033282071352
distance x is tensor(117.1771, device='cuda:0')
benign distance is  tensor(117.1771, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.0112051106989384
distance x is tensor(118.2239, device='cuda:0')
benign distance is  tensor(118.2239, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9695935714989901
distance x is tensor(74.3818, device='cuda:0')
benign distance is  tensor(74.3818, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7545915096998215
distance x is tensor(213.4998, device='cuda:0')
benign distance is  tensor(213.4998, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.073042418807745
distance x is tensor(153.4842, device='cuda:0')
benign distance is  tensor(153.4842, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6501538930460811
distance x is tensor(101.1366, device='cuda:0')
benign distance is  tensor(101.1366, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.1676764134317636
distance x is tensor(117.3552, device='cuda:0')
benign distance is  tensor(117.3552, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6881783045828342
distance x is tensor(83.4293, device='cuda:0')
benign distance is  tensor(83.4293, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9447888825088739
distance x is tensor(139.3023, device='cuda:0')
benign distance is  tensor(139.3023, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.3075932990759611
distance x is tensor(114.3693, device='cuda:0')
benign distance is  tensor(114.3693, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.724650451913476
distance x is tensor(113.1504, device='cuda:0')
benign distance is  tensor(113.1504, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.815480007790029
distance x is tensor(101.2833, device='cuda:0')
benign distance is  tensor(101.2833, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.514090234413743
distance x is tensor(112.5372, device='cuda:0')
benign distance is  tensor(112.5372, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.858571657910943
distance x is tensor(184.2173, device='cuda:0')
benign distance is  tensor(184.2173, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.1512870993465185
distance x is tensor(108.1375, device='cuda:0')
benign distance is  tensor(108.1375, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.4139684103429317
distance x is tensor(139.3631, device='cuda:0')
benign distance is  tensor(139.3631, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.0844986103475094
distance x is tensor(150.6140, device='cuda:0')
benign distance is  tensor(150.6140, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.8859840389341116
distance x is tensor(92.7911, device='cuda:0')
benign distance is  tensor(92.7911, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.608948826789856
distance x is tensor(157.5785, device='cuda:0')
benign distance is  tensor(157.5785, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8745221383869648
distance x is tensor(139.0128, device='cuda:0')
benign distance is  tensor(139.0128, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7326789554208517
distance x is tensor(96.1346, device='cuda:0')
benign distance is  tensor(96.1346, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5689462618902326
distance x is tensor(122.7599, device='cuda:0')
benign distance is  tensor(122.7599, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.555926650762558
distance x is tensor(171.8584, device='cuda:0')
benign distance is  tensor(171.8584, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.9428990483284
distance x is tensor(176.0173, device='cuda:0')
benign distance is  tensor(176.0173, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.525912761688232
distance x is tensor(165.7678, device='cuda:0')
benign distance is  tensor(165.7678, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.91478943824768
distance x is tensor(160.0308, device='cuda:0')
benign distance is  tensor(160.0308, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.276679694652557
distance x is tensor(138.4488, device='cuda:0')
benign distance is  tensor(138.4488, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.154860287904739
distance x is tensor(142.3630, device='cuda:0')
benign distance is  tensor(142.3630, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.791740536689758
distance x is tensor(160.5744, device='cuda:0')
benign distance is  tensor(160.5744, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  9.02978339791298
distance x is tensor(165.1723, device='cuda:0')
benign distance is  tensor(165.1723, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  10.425693452358246
distance x is tensor(178.5812, device='cuda:0')
benign distance is  tensor(178.5812, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  11.963359773159027
distance x is tensor(156.9464, device='cuda:0')
benign distance is  tensor(156.9464, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.800169199705124
distance x is tensor(167.9969, device='cuda:0')
benign distance is  tensor(167.9969, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  8.876967042684555
distance x is tensor(181.1552, device='cuda:0')
benign distance is  tensor(181.1552, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([437.2335, 466.1494, 462.8500, 681.0822, 343.7435, 422.3853, 391.4098,
        388.3390, 679.9797, 751.8417, 676.3533, 682.3262, 590.3494, 617.9724,
        681.4943, 685.4849, 745.3540, 654.0322, 694.9760, 763.1064],
       device='cuda:0')
sorted_norm is   tensor([343.7435, 388.3390, 391.4098, 422.3853, 437.2335, 462.8500, 466.1494,
        590.3494, 617.9724, 654.0322, 676.3533, 679.9797, 681.0822, 681.4943,
        682.3262, 685.4849, 694.9760, 745.3540, 751.8417, 763.1064],
       device='cuda:0')
used idx is  tensor([ 4,  7,  6,  5,  0,  2,  1, 12, 13, 17, 10,  8,  3, 14, 11, 15],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 67.73% 

Test Accuracy: 22.92% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8071331884711981
distance x is tensor(145.4979, device='cuda:0')
benign distance is  tensor(145.4979, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8478139527142048
distance x is tensor(133.7459, device='cuda:0')
benign distance is  tensor(133.7459, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7584486920386553
distance x is tensor(135.0286, device='cuda:0')
benign distance is  tensor(135.0286, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9422353971749544
distance x is tensor(186.0237, device='cuda:0')
benign distance is  tensor(186.0237, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.2973691150546074
distance x is tensor(137.4620, device='cuda:0')
benign distance is  tensor(137.4620, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6892961775884032
distance x is tensor(141.3356, device='cuda:0')
benign distance is  tensor(141.3356, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2576644271612167
distance x is tensor(128.9178, device='cuda:0')
benign distance is  tensor(128.9178, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8253184594213963
distance x is tensor(122.9026, device='cuda:0')
benign distance is  tensor(122.9026, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.334859699010849
distance x is tensor(99.6309, device='cuda:0')
benign distance is  tensor(99.6309, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.130654066801071
distance x is tensor(140.9354, device='cuda:0')
benign distance is  tensor(140.9354, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.155713707208633
distance x is tensor(94.9470, device='cuda:0')
benign distance is  tensor(94.9470, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.491149604320526
distance x is tensor(95.1160, device='cuda:0')
benign distance is  tensor(95.1160, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.537686109542847
distance x is tensor(84.8248, device='cuda:0')
benign distance is  tensor(84.8248, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.350763231515884
distance x is tensor(112.1992, device='cuda:0')
benign distance is  tensor(112.1992, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.951060771942139
distance x is tensor(124.9957, device='cuda:0')
benign distance is  tensor(124.9957, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  9.250099033117294
distance x is tensor(90.3943, device='cuda:0')
benign distance is  tensor(90.3943, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.983442306518555
distance x is tensor(115.2574, device='cuda:0')
benign distance is  tensor(115.2574, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.23573762178421
distance x is tensor(96.3795, device='cuda:0')
benign distance is  tensor(96.3795, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.872090458869934
distance x is tensor(111.4912, device='cuda:0')
benign distance is  tensor(111.4912, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  8.940426647663116
distance x is tensor(150.5143, device='cuda:0')
benign distance is  tensor(150.5143, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([648.1104, 592.0161, 602.8778, 825.8980, 579.5955, 609.1426, 569.9061,
        523.5677, 459.0943, 669.7322, 447.6254, 446.1046, 411.1433, 543.8588,
        572.8889, 435.1585, 541.0131, 447.2387, 504.9933, 695.5686, 508.5094,
        599.2181, 369.0421, 551.0046, 788.2645, 349.7250, 668.7974, 612.1304],
       device='cuda:0')
sorted_norm is   tensor([349.7250, 369.0421, 411.1433, 435.1585, 446.1046, 447.2387, 447.6254,
        459.0943, 504.9933, 508.5094, 523.5677, 541.0131, 543.8588, 551.0046,
        569.9061, 572.8889, 579.5955, 592.0161, 599.2181, 602.8778, 609.1426,
        612.1304, 648.1104, 668.7974, 669.7322, 695.5686, 788.2645, 825.8980],
       device='cuda:0')
used idx is  tensor([25, 22, 12, 15, 11, 17, 10,  8, 18, 20,  7, 16, 13, 23,  6, 14,  4,  1,
        21,  2,  5, 27], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 89.77% 

Test Accuracy: 84.53% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.803095294162631
distance x is tensor(112.5322, device='cuda:0')
benign distance is  tensor(112.5322, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.858596071600914
distance x is tensor(104.0613, device='cuda:0')
benign distance is  tensor(104.0613, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8094210606068373
distance x is tensor(107.8115, device='cuda:0')
benign distance is  tensor(107.8115, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8284254353493452
distance x is tensor(147.1329, device='cuda:0')
benign distance is  tensor(147.1329, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.990563539788127
distance x is tensor(93.2253, device='cuda:0')
benign distance is  tensor(93.2253, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7210583472624421
distance x is tensor(108.9312, device='cuda:0')
benign distance is  tensor(108.9312, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.27950107306242
distance x is tensor(98.6811, device='cuda:0')
benign distance is  tensor(98.6811, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7571020722389221
distance x is tensor(80.4436, device='cuda:0')
benign distance is  tensor(80.4436, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9587911162525415
distance x is tensor(115.6284, device='cuda:0')
benign distance is  tensor(115.6284, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7317448984831572
distance x is tensor(124.6045, device='cuda:0')
benign distance is  tensor(124.6045, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0013423077762127
distance x is tensor(77.4020, device='cuda:0')
benign distance is  tensor(77.4020, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4183525554835796
distance x is tensor(109.0839, device='cuda:0')
benign distance is  tensor(109.0839, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0451439153403044
distance x is tensor(160.1600, device='cuda:0')
benign distance is  tensor(160.1600, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7726690955460072
distance x is tensor(68.8943, device='cuda:0')
benign distance is  tensor(68.8943, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0503549221903086
distance x is tensor(156.5426, device='cuda:0')
benign distance is  tensor(156.5426, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2631115652620792
distance x is tensor(127.5357, device='cuda:0')
benign distance is  tensor(127.5357, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.666540265083313
distance x is tensor(132.3874, device='cuda:0')
benign distance is  tensor(132.3874, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.691082835197449
distance x is tensor(162.0587, device='cuda:0')
benign distance is  tensor(162.0587, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  10.001057803630829
distance x is tensor(132.2631, device='cuda:0')
benign distance is  tensor(132.2631, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.9697205722332
distance x is tensor(118.8233, device='cuda:0')
benign distance is  tensor(118.8233, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.731951415538788
distance x is tensor(105.1307, device='cuda:0')
benign distance is  tensor(105.1307, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.4949400424957275
distance x is tensor(125.1797, device='cuda:0')
benign distance is  tensor(125.1797, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  10.18998897075653
distance x is tensor(149.9602, device='cuda:0')
benign distance is  tensor(149.9602, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  9.843539386987686
distance x is tensor(121.5016, device='cuda:0')
benign distance is  tensor(121.5016, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  10.214216709136963
distance x is tensor(154.1868, device='cuda:0')
benign distance is  tensor(154.1868, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  11.059214115142822
distance x is tensor(126.3010, device='cuda:0')
benign distance is  tensor(126.3010, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.243499636650085
distance x is tensor(139.7225, device='cuda:0')
benign distance is  tensor(139.7225, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.376604110002518
distance x is tensor(173.8056, device='cuda:0')
benign distance is  tensor(173.8056, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([520.3211, 481.1826, 494.6864, 686.2598, 423.1301, 484.1116, 448.3889,
        363.6790, 571.7337, 718.8726, 551.7913, 528.3110, 480.0566, 575.7382,
        661.7902, 537.7495, 664.0957, 554.7659, 590.0849, 774.0334, 592.5340,
        539.7129, 727.7229, 602.8183, 499.2000, 470.3576, 443.5190, 601.5272,
        413.8995, 507.5128, 542.5135, 558.0920, 355.1618, 954.7319, 711.5200,
        492.1039], device='cuda:0')
sorted_norm is   tensor([355.1618, 363.6790, 413.8995, 423.1301, 443.5190, 448.3889, 470.3576,
        480.0566, 481.1826, 484.1116, 492.1039, 494.6864, 499.2000, 507.5128,
        520.3211, 528.3110, 537.7495, 539.7129, 542.5135, 551.7913, 554.7659,
        558.0920, 571.7337, 575.7382, 590.0849, 592.5340, 601.5272, 602.8183,
        661.7902, 664.0957, 686.2598, 711.5200, 718.8726, 727.7229, 774.0334,
        954.7319], device='cuda:0')
used idx is  tensor([32,  7, 28,  4, 26,  6, 25, 12,  1,  5, 35,  2, 24, 29,  0, 11, 15, 21,
        30, 10, 17, 31,  8, 13, 18, 20, 27, 23], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 90.67% 

Test Accuracy: 85.58% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7464040294289589
distance x is tensor(119.9060, device='cuda:0')
benign distance is  tensor(119.9060, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9012114126235247
distance x is tensor(109.2948, device='cuda:0')
benign distance is  tensor(109.2948, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7077530492097139
distance x is tensor(109.9895, device='cuda:0')
benign distance is  tensor(109.9895, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7323213759809732
distance x is tensor(155.5975, device='cuda:0')
benign distance is  tensor(155.5975, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8356865020468831
distance x is tensor(86.9605, device='cuda:0')
benign distance is  tensor(86.9605, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7743924185633659
distance x is tensor(100.7656, device='cuda:0')
benign distance is  tensor(100.7656, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2375118266791105
distance x is tensor(103.0168, device='cuda:0')
benign distance is  tensor(103.0168, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7012550141662359
distance x is tensor(93.1476, device='cuda:0')
benign distance is  tensor(93.1476, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.208527959883213
distance x is tensor(92.3747, device='cuda:0')
benign distance is  tensor(92.3747, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8850425612181425
distance x is tensor(106.6576, device='cuda:0')
benign distance is  tensor(106.6576, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.0249311588704586
distance x is tensor(127.2245, device='cuda:0')
benign distance is  tensor(127.2245, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8990253247320652
distance x is tensor(120.9146, device='cuda:0')
benign distance is  tensor(120.9146, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0265811458230019
distance x is tensor(85.9387, device='cuda:0')
benign distance is  tensor(85.9387, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7950771860778332
distance x is tensor(213.4544, device='cuda:0')
benign distance is  tensor(213.4544, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.296668380498886
distance x is tensor(170.8237, device='cuda:0')
benign distance is  tensor(170.8237, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6960918102413416
distance x is tensor(114.0729, device='cuda:0')
benign distance is  tensor(114.0729, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7025973983108997
distance x is tensor(129.3888, device='cuda:0')
benign distance is  tensor(129.3888, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.9780641365796328
distance x is tensor(113.1324, device='cuda:0')
benign distance is  tensor(113.1324, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6843671128153801
distance x is tensor(152.9307, device='cuda:0')
benign distance is  tensor(152.9307, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.0298571027815342
distance x is tensor(134.2677, device='cuda:0')
benign distance is  tensor(134.2677, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7462729960680008
distance x is tensor(113.6975, device='cuda:0')
benign distance is  tensor(113.6975, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8652152121067047
distance x is tensor(97.7480, device='cuda:0')
benign distance is  tensor(97.7480, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.9446275494992733
distance x is tensor(97.0506, device='cuda:0')
benign distance is  tensor(97.0506, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.6354936584830284
distance x is tensor(131.2589, device='cuda:0')
benign distance is  tensor(131.2589, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  10.10171228647232
distance x is tensor(142.8109, device='cuda:0')
benign distance is  tensor(142.8109, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.687408983707428
distance x is tensor(155.5332, device='cuda:0')
benign distance is  tensor(155.5332, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  10.501376211643219
distance x is tensor(125.4279, device='cuda:0')
benign distance is  tensor(125.4279, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  11.502476811408997
distance x is tensor(129.3282, device='cuda:0')
benign distance is  tensor(129.3282, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.17674407362938
distance x is tensor(118.4030, device='cuda:0')
benign distance is  tensor(118.4030, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  6.939101696014404
distance x is tensor(139.1908, device='cuda:0')
benign distance is  tensor(139.1908, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  10.033676445484161
distance x is tensor(143.4943, device='cuda:0')
benign distance is  tensor(143.4943, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  10.627532184123993
distance x is tensor(131.8097, device='cuda:0')
benign distance is  tensor(131.8097, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.608704507350922
distance x is tensor(141.6971, device='cuda:0')
benign distance is  tensor(141.6971, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  12.505052268505096
distance x is tensor(131.5378, device='cuda:0')
benign distance is  tensor(131.5378, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  10.192519545555115
distance x is tensor(132.4869, device='cuda:0')
benign distance is  tensor(132.4869, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.971640944480896
distance x is tensor(170.9990, device='cuda:0')
benign distance is  tensor(170.9990, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([542.1019, 500.3269, 509.2621, 719.5681, 399.1233, 455.4509, 466.6057,
        414.1108, 599.5697, 717.6830, 540.0518, 569.4520, 517.3351, 614.8917,
        625.7567, 584.3149, 610.7709, 564.7325, 575.6236, 755.8821, 540.7933,
        402.8235, 642.6408, 549.2370, 530.4006, 488.9977, 528.6694, 844.3031,
        530.7097, 580.9424, 355.9793, 506.3835, 731.5203, 318.7892, 703.8143,
        599.8193], device='cuda:0')
sorted_norm is   tensor([318.7892, 355.9793, 399.1233, 402.8235, 414.1108, 455.4509, 466.6057,
        488.9977, 500.3269, 506.3835, 509.2621, 517.3351, 528.6694, 530.4006,
        530.7097, 540.0518, 540.7933, 542.1019, 549.2370, 564.7325, 569.4520,
        575.6236, 580.9424, 584.3149, 599.5697, 599.8193, 610.7709, 614.8917,
        625.7567, 642.6408, 703.8143, 717.6830, 719.5681, 731.5203, 755.8821,
        844.3031], device='cuda:0')
used idx is  tensor([33, 30,  4, 21,  7,  5,  6, 25,  1, 31,  2, 12, 26, 24, 28, 10, 20,  0,
        23, 17, 11, 18, 29, 15,  8, 35, 16, 13], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 89.16% 

Test Accuracy: 73.31% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.777631614357233
distance x is tensor(120.4448, device='cuda:0')
benign distance is  tensor(120.4448, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7738963756710291
distance x is tensor(107.0235, device='cuda:0')
benign distance is  tensor(107.0235, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7078929618000984
distance x is tensor(107.9104, device='cuda:0')
benign distance is  tensor(107.9104, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1142114773392677
distance x is tensor(158.8674, device='cuda:0')
benign distance is  tensor(158.8674, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.806306061334908
distance x is tensor(89.3651, device='cuda:0')
benign distance is  tensor(89.3651, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7481021257117391
distance x is tensor(105.4918, device='cuda:0')
benign distance is  tensor(105.4918, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9821656011044979
distance x is tensor(95.7533, device='cuda:0')
benign distance is  tensor(95.7533, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6567973922938108
distance x is tensor(85.4924, device='cuda:0')
benign distance is  tensor(85.4924, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1748897060751915
distance x is tensor(113.9656, device='cuda:0')
benign distance is  tensor(113.9656, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5858406168408692
distance x is tensor(122.7913, device='cuda:0')
benign distance is  tensor(122.7913, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3723671026527882
distance x is tensor(91.2271, device='cuda:0')
benign distance is  tensor(91.2271, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.5066097788512707
distance x is tensor(119.0700, device='cuda:0')
benign distance is  tensor(119.0700, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1981319449841976
distance x is tensor(170.3544, device='cuda:0')
benign distance is  tensor(170.3544, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7378896344453096
distance x is tensor(65.2216, device='cuda:0')
benign distance is  tensor(65.2216, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0042225811630487
distance x is tensor(153.3089, device='cuda:0')
benign distance is  tensor(153.3089, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.4431885071098804
distance x is tensor(125.0552, device='cuda:0')
benign distance is  tensor(125.0552, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.020561933517456
distance x is tensor(117.7740, device='cuda:0')
benign distance is  tensor(117.7740, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.1878446824848652
distance x is tensor(130.9075, device='cuda:0')
benign distance is  tensor(130.9075, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8340101782232523
distance x is tensor(127.6969, device='cuda:0')
benign distance is  tensor(127.6969, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.1980263479053974
distance x is tensor(122.5912, device='cuda:0')
benign distance is  tensor(122.5912, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9848172850906849
distance x is tensor(125.9585, device='cuda:0')
benign distance is  tensor(125.9585, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8341764621436596
distance x is tensor(119.0357, device='cuda:0')
benign distance is  tensor(119.0357, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5335779841989279
distance x is tensor(127.0682, device='cuda:0')
benign distance is  tensor(127.0682, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.9322335794568062
distance x is tensor(182.1288, device='cuda:0')
benign distance is  tensor(182.1288, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.984410464763641
distance x is tensor(135.9081, device='cuda:0')
benign distance is  tensor(135.9081, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.164548993110657
distance x is tensor(151.6084, device='cuda:0')
benign distance is  tensor(151.6084, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  10.81772005558014
distance x is tensor(123.4922, device='cuda:0')
benign distance is  tensor(123.4922, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  11.22994077205658
distance x is tensor(114.2897, device='cuda:0')
benign distance is  tensor(114.2897, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.613280564546585
distance x is tensor(103.4917, device='cuda:0')
benign distance is  tensor(103.4917, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.468491196632385
distance x is tensor(122.2857, device='cuda:0')
benign distance is  tensor(122.2857, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.704006671905518
distance x is tensor(137.5201, device='cuda:0')
benign distance is  tensor(137.5201, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.386021912097931
distance x is tensor(107.4510, device='cuda:0')
benign distance is  tensor(107.4510, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.287867039442062
distance x is tensor(131.0928, device='cuda:0')
benign distance is  tensor(131.0928, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.965372323989868
distance x is tensor(118.4481, device='cuda:0')
benign distance is  tensor(118.4481, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  10.700011610984802
distance x is tensor(133.9478, device='cuda:0')
benign distance is  tensor(133.9478, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  8.571710050106049
distance x is tensor(156.4676, device='cuda:0')
benign distance is  tensor(156.4676, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([550.5129, 495.5064, 489.4070, 720.1508, 405.9233, 468.9064, 430.1407,
        377.0147, 577.9416, 696.1696, 553.8083, 507.3618, 472.7710, 563.5020,
        608.5991, 487.0507, 585.5446, 526.9409, 579.8351, 698.0197],
       device='cuda:0')
sorted_norm is   tensor([377.0147, 405.9233, 430.1407, 468.9064, 472.7710, 487.0507, 489.4070,
        495.5064, 507.3618, 526.9409, 550.5129, 553.8083, 563.5020, 577.9416,
        579.8351, 585.5446, 608.5991, 696.1696, 698.0197, 720.1508],
       device='cuda:0')
used idx is  tensor([ 7,  4,  6,  5, 12, 15,  2,  1, 11, 17,  0, 10, 13,  8, 18, 16],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 68.89% 

Test Accuracy: 22.92% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8728825394064188
distance x is tensor(131.3456, device='cuda:0')
benign distance is  tensor(131.3456, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9164315853267908
distance x is tensor(123.1153, device='cuda:0')
benign distance is  tensor(123.1153, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9144277609884739
distance x is tensor(135.9974, device='cuda:0')
benign distance is  tensor(135.9974, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9850155562162399
distance x is tensor(176.9247, device='cuda:0')
benign distance is  tensor(176.9247, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8759573651477695
distance x is tensor(121.6823, device='cuda:0')
benign distance is  tensor(121.6823, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8871939750388265
distance x is tensor(138.7092, device='cuda:0')
benign distance is  tensor(138.7092, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2508340403437614
distance x is tensor(126.6389, device='cuda:0')
benign distance is  tensor(126.6389, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7206789972260594
distance x is tensor(112.4847, device='cuda:0')
benign distance is  tensor(112.4847, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  10.395746767520905
distance x is tensor(96.8727, device='cuda:0')
benign distance is  tensor(96.8727, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  9.396280288696289
distance x is tensor(143.3411, device='cuda:0')
benign distance is  tensor(143.3411, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  11.705640256404877
distance x is tensor(99.3692, device='cuda:0')
benign distance is  tensor(99.3692, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  12.24030476808548
distance x is tensor(110.6357, device='cuda:0')
benign distance is  tensor(110.6357, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.262285262346268
distance x is tensor(91.9072, device='cuda:0')
benign distance is  tensor(91.9072, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.5797103345394135
distance x is tensor(112.7650, device='cuda:0')
benign distance is  tensor(112.7650, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.34474629163742
distance x is tensor(130.4925, device='cuda:0')
benign distance is  tensor(130.4925, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.42927211523056
distance x is tensor(93.0343, device='cuda:0')
benign distance is  tensor(93.0343, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.283493459224701
distance x is tensor(119.6737, device='cuda:0')
benign distance is  tensor(119.6737, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  12.196739256381989
distance x is tensor(101.6299, device='cuda:0')
benign distance is  tensor(101.6299, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.4933540225029
distance x is tensor(107.9059, device='cuda:0')
benign distance is  tensor(107.9059, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.653467893600464
distance x is tensor(157.2537, device='cuda:0')
benign distance is  tensor(157.2537, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([584.1026, 555.1910, 604.6564, 789.1201, 540.6305, 597.8913, 561.8466,
        496.3432, 453.8102, 681.7468, 462.2571, 528.1600, 427.4837, 531.4379,
        593.3928, 439.0427, 560.8884, 465.9802, 497.0812, 718.8080, 556.5524,
        689.3558, 728.4260, 495.3133, 783.5335, 670.2877, 505.7255, 603.9199,
        457.5531, 527.5331, 604.5554, 585.3279, 423.8375, 966.8006, 784.7449,
        557.3881, 549.9835, 592.8610, 437.0765, 557.2064, 776.5490, 329.8176,
        701.9137, 591.5450], device='cuda:0')
sorted_norm is   tensor([329.8176, 423.8375, 427.4837, 437.0765, 439.0427, 453.8102, 457.5531,
        462.2571, 465.9802, 495.3133, 496.3432, 497.0812, 505.7255, 527.5331,
        528.1600, 531.4379, 540.6305, 549.9835, 555.1910, 556.5524, 557.2064,
        557.3881, 560.8884, 561.8466, 584.1026, 585.3279, 591.5450, 592.8610,
        593.3928, 597.8913, 603.9199, 604.5554, 604.6564, 670.2877, 681.7468,
        689.3558, 701.9137, 718.8080, 728.4260, 776.5490, 783.5335, 784.7449,
        789.1201, 966.8006], device='cuda:0')
used idx is  tensor([41, 32, 12, 38, 15,  8, 28, 10, 17, 23,  7, 18, 26, 29, 11, 13,  4, 36,
         1, 20, 39, 35, 16,  6,  0, 31, 43, 37, 14,  5, 27, 30,  2, 25,  9],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 90.47% 

Test Accuracy: 87.75% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7132682520896196
distance x is tensor(121.2968, device='cuda:0')
benign distance is  tensor(121.2968, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8016450051218271
distance x is tensor(102.6573, device='cuda:0')
benign distance is  tensor(102.6573, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8368916045874357
distance x is tensor(108.2653, device='cuda:0')
benign distance is  tensor(108.2653, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.903738358989358
distance x is tensor(160.7675, device='cuda:0')
benign distance is  tensor(160.7675, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8922367598861456
distance x is tensor(79.1053, device='cuda:0')
benign distance is  tensor(79.1053, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6920263199135661
distance x is tensor(99.5520, device='cuda:0')
benign distance is  tensor(99.5520, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4244697466492653
distance x is tensor(97.3548, device='cuda:0')
benign distance is  tensor(97.3548, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6112920120358467
distance x is tensor(89.0512, device='cuda:0')
benign distance is  tensor(89.0512, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0687836930155754
distance x is tensor(109.1100, device='cuda:0')
benign distance is  tensor(109.1100, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6961000091396272
distance x is tensor(126.2894, device='cuda:0')
benign distance is  tensor(126.2894, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1886644139885902
distance x is tensor(72.4592, device='cuda:0')
benign distance is  tensor(72.4592, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3664675690233707
distance x is tensor(113.2827, device='cuda:0')
benign distance is  tensor(113.2827, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.3594497181475163
distance x is tensor(217.0054, device='cuda:0')
benign distance is  tensor(217.0054, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8026407137513161
distance x is tensor(66.2275, device='cuda:0')
benign distance is  tensor(66.2275, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8128803092986345
distance x is tensor(140.0752, device='cuda:0')
benign distance is  tensor(140.0752, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2708730138838291
distance x is tensor(120.4436, device='cuda:0')
benign distance is  tensor(120.4436, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1108153965324163
distance x is tensor(96.8526, device='cuda:0')
benign distance is  tensor(96.8526, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7317446321249008
distance x is tensor(112.6857, device='cuda:0')
benign distance is  tensor(112.6857, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.284969251602888
distance x is tensor(124.1350, device='cuda:0')
benign distance is  tensor(124.1350, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9469416234642267
distance x is tensor(128.6500, device='cuda:0')
benign distance is  tensor(128.6500, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.8535571228712797
distance x is tensor(85.1830, device='cuda:0')
benign distance is  tensor(85.1830, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7042993046343327
distance x is tensor(214.0427, device='cuda:0')
benign distance is  tensor(214.0427, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1061015501618385
distance x is tensor(158.7608, device='cuda:0')
benign distance is  tensor(158.7608, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8385192975401878
distance x is tensor(118.0038, device='cuda:0')
benign distance is  tensor(118.0038, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.1919858530163765
distance x is tensor(110.1826, device='cuda:0')
benign distance is  tensor(110.1826, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.0550205130130053
distance x is tensor(131.4068, device='cuda:0')
benign distance is  tensor(131.4068, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.402147226035595
distance x is tensor(146.8093, device='cuda:0')
benign distance is  tensor(146.8093, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.016739770770073
distance x is tensor(104.1295, device='cuda:0')
benign distance is  tensor(104.1295, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5861107092350721
distance x is tensor(162.6266, device='cuda:0')
benign distance is  tensor(162.6266, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7271815650165081
distance x is tensor(144.5932, device='cuda:0')
benign distance is  tensor(144.5932, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8691580891609192
distance x is tensor(105.1033, device='cuda:0')
benign distance is  tensor(105.1033, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6333669549785554
distance x is tensor(131.5442, device='cuda:0')
benign distance is  tensor(131.5442, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  10.667933702468872
distance x is tensor(173.0366, device='cuda:0')
benign distance is  tensor(173.0366, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.99435767531395
distance x is tensor(180.5954, device='cuda:0')
benign distance is  tensor(180.5954, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  10.024516105651855
distance x is tensor(159.9048, device='cuda:0')
benign distance is  tensor(159.9048, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  12.3599311709404
distance x is tensor(145.5250, device='cuda:0')
benign distance is  tensor(145.5250, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.513633877038956
distance x is tensor(135.1426, device='cuda:0')
benign distance is  tensor(135.1426, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.547142148017883
distance x is tensor(143.4142, device='cuda:0')
benign distance is  tensor(143.4142, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.255901038646698
distance x is tensor(171.0753, device='cuda:0')
benign distance is  tensor(171.0753, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.043652892112732
distance x is tensor(141.9254, device='cuda:0')
benign distance is  tensor(141.9254, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  11.44490373134613
distance x is tensor(157.8065, device='cuda:0')
benign distance is  tensor(157.8065, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  11.271858155727386
distance x is tensor(154.7749, device='cuda:0')
benign distance is  tensor(154.7749, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  10.15825867652893
distance x is tensor(171.0047, device='cuda:0')
benign distance is  tensor(171.0047, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.368228793144226
distance x is tensor(186.0231, device='cuda:0')
benign distance is  tensor(186.0231, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([566.5227, 477.0023, 487.7119, 749.0997, 357.4957, 453.9627, 450.8075,
        406.1068, 687.2854, 774.9302, 653.0867, 618.4808, 577.9271, 631.8323,
        709.0476, 588.5702, 660.6584, 645.0641, 692.1735, 799.2162],
       device='cuda:0')
sorted_norm is   tensor([357.4957, 406.1068, 450.8075, 453.9627, 477.0023, 487.7119, 566.5227,
        577.9271, 588.5702, 618.4808, 631.8323, 645.0641, 653.0867, 660.6584,
        687.2854, 692.1735, 709.0476, 749.0997, 774.9302, 799.2162],
       device='cuda:0')
used idx is  tensor([ 4,  7,  6,  5,  1,  2,  0, 12, 15, 11, 13, 17, 10, 16,  8, 18],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 59.18% 

Test Accuracy: 16.99% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7383979726582766
distance x is tensor(148.5098, device='cuda:0')
benign distance is  tensor(148.5098, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0088019203394651
distance x is tensor(151.0932, device='cuda:0')
benign distance is  tensor(151.0932, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.194265715777874
distance x is tensor(144.7751, device='cuda:0')
benign distance is  tensor(144.7751, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1369101293385029
distance x is tensor(193.3026, device='cuda:0')
benign distance is  tensor(193.3026, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9493471663445234
distance x is tensor(134.4622, device='cuda:0')
benign distance is  tensor(134.4622, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7525223651900887
distance x is tensor(153.8882, device='cuda:0')
benign distance is  tensor(153.8882, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3511536940932274
distance x is tensor(144.4289, device='cuda:0')
benign distance is  tensor(144.4289, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9961928185075521
distance x is tensor(126.5092, device='cuda:0')
benign distance is  tensor(126.5092, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.959780782461166
distance x is tensor(84.3655, device='cuda:0')
benign distance is  tensor(84.3655, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.709241360425949
distance x is tensor(143.2046, device='cuda:0')
benign distance is  tensor(143.2046, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.822001993656158
distance x is tensor(86.3607, device='cuda:0')
benign distance is  tensor(86.3607, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.619372248649597
distance x is tensor(110.1953, device='cuda:0')
benign distance is  tensor(110.1953, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.134598672389984
distance x is tensor(87.4840, device='cuda:0')
benign distance is  tensor(87.4840, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  8.146661192178726
distance x is tensor(103.2516, device='cuda:0')
benign distance is  tensor(103.2516, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.588840186595917
distance x is tensor(121.0634, device='cuda:0')
benign distance is  tensor(121.0634, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  9.214442491531372
distance x is tensor(88.1848, device='cuda:0')
benign distance is  tensor(88.1848, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  10.042864561080933
distance x is tensor(111.4879, device='cuda:0')
benign distance is  tensor(111.4879, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.908186733722687
distance x is tensor(96.2285, device='cuda:0')
benign distance is  tensor(96.2285, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.891644299030304
distance x is tensor(101.5222, device='cuda:0')
benign distance is  tensor(101.5222, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.584656953811646
distance x is tensor(155.9072, device='cuda:0')
benign distance is  tensor(155.9072, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([639.8887, 666.0756, 631.6177, 842.3666, 570.6202, 653.2335, 612.5098,
        555.0321, 403.7529, 662.8069, 404.9961, 506.9700, 410.3123, 502.1580,
        557.3559, 409.0402, 518.3796, 444.8924, 460.2289, 704.1755, 663.9949,
        581.7487, 735.9464, 673.3485, 568.2557, 522.7290, 525.3254, 658.1207,
        595.1863, 702.6479, 630.5113, 627.7249, 626.4745, 610.3581, 629.0085,
        854.5312, 536.8014, 622.0494, 404.4958, 560.8909, 995.7543, 378.4722,
        669.2829, 602.7958], device='cuda:0')
sorted_norm is   tensor([378.4722, 403.7529, 404.4958, 404.9961, 409.0402, 410.3123, 444.8924,
        460.2289, 502.1580, 506.9700, 518.3796, 522.7290, 525.3254, 536.8014,
        555.0321, 557.3559, 560.8909, 568.2557, 570.6202, 581.7487, 595.1863,
        602.7958, 610.3581, 612.5098, 622.0494, 626.4745, 627.7249, 629.0085,
        630.5113, 631.6177, 639.8887, 653.2335, 658.1207, 662.8069, 663.9949,
        666.0756, 669.2829, 673.3485, 702.6479, 704.1755, 735.9464, 842.3666,
        854.5312, 995.7543], device='cuda:0')
used idx is  tensor([41,  8, 38, 10, 15, 12, 17, 18, 13, 11, 16, 25, 26, 36,  7, 14, 39, 24,
         4, 21, 28, 43, 33,  6, 37, 32, 31, 34, 30,  2,  0,  5, 27,  9, 20],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 91.10% 

Test Accuracy: 87.29% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8213874995708466
distance x is tensor(107.3691, device='cuda:0')
benign distance is  tensor(107.3691, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6995679549872875
distance x is tensor(110.1065, device='cuda:0')
benign distance is  tensor(110.1065, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7404409572482109
distance x is tensor(100.0813, device='cuda:0')
benign distance is  tensor(100.0813, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9179680701345205
distance x is tensor(149.6715, device='cuda:0')
benign distance is  tensor(149.6715, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8538032015785575
distance x is tensor(83.0744, device='cuda:0')
benign distance is  tensor(83.0744, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6964075965806842
distance x is tensor(100.2899, device='cuda:0')
benign distance is  tensor(100.2899, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0813076309859753
distance x is tensor(81.7446, device='cuda:0')
benign distance is  tensor(81.7446, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.621953459456563
distance x is tensor(76.2918, device='cuda:0')
benign distance is  tensor(76.2918, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9780149720609188
distance x is tensor(96.0066, device='cuda:0')
benign distance is  tensor(96.0066, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6849300805479288
distance x is tensor(118.7254, device='cuda:0')
benign distance is  tensor(118.7254, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1066901870071888
distance x is tensor(62.9370, device='cuda:0')
benign distance is  tensor(62.9370, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3048072792589664
distance x is tensor(117.5078, device='cuda:0')
benign distance is  tensor(117.5078, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.199058674275875
distance x is tensor(160.3806, device='cuda:0')
benign distance is  tensor(160.3806, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6254801144823432
distance x is tensor(62.5739, device='cuda:0')
benign distance is  tensor(62.5739, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8744997438043356
distance x is tensor(163.1633, device='cuda:0')
benign distance is  tensor(163.1633, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.303035480901599
distance x is tensor(110.6156, device='cuda:0')
benign distance is  tensor(110.6156, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.0751977059990168
distance x is tensor(119.8228, device='cuda:0')
benign distance is  tensor(119.8228, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7364903632551432
distance x is tensor(101.0813, device='cuda:0')
benign distance is  tensor(101.0813, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8649179115891457
distance x is tensor(130.7544, device='cuda:0')
benign distance is  tensor(130.7544, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.1530540017411113
distance x is tensor(108.5000, device='cuda:0')
benign distance is  tensor(108.5000, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7786432430148125
distance x is tensor(117.6998, device='cuda:0')
benign distance is  tensor(117.6998, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7811881098896265
distance x is tensor(110.9804, device='cuda:0')
benign distance is  tensor(110.9804, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5195871219038963
distance x is tensor(116.2038, device='cuda:0')
benign distance is  tensor(116.2038, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6565539166331291
distance x is tensor(171.7351, device='cuda:0')
benign distance is  tensor(171.7351, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7985719200223684
distance x is tensor(128.5195, device='cuda:0')
benign distance is  tensor(128.5195, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.7334219412878156
distance x is tensor(97.0255, device='cuda:0')
benign distance is  tensor(97.0255, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6457390729337931
distance x is tensor(153.5670, device='cuda:0')
benign distance is  tensor(153.5670, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.6289405599236488
distance x is tensor(128.6185, device='cuda:0')
benign distance is  tensor(128.6185, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.751988373696804
distance x is tensor(107.6478, device='cuda:0')
benign distance is  tensor(107.6478, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8456035070121288
distance x is tensor(90.2631, device='cuda:0')
benign distance is  tensor(90.2631, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.8798137102276087
distance x is tensor(98.4239, device='cuda:0')
benign distance is  tensor(98.4239, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8263434320688248
distance x is tensor(126.1414, device='cuda:0')
benign distance is  tensor(126.1414, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  11.144949555397034
distance x is tensor(160.6700, device='cuda:0')
benign distance is  tensor(160.6700, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.655316472053528
distance x is tensor(166.2757, device='cuda:0')
benign distance is  tensor(166.2757, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  10.200495600700378
distance x is tensor(147.9776, device='cuda:0')
benign distance is  tensor(147.9776, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.376521468162537
distance x is tensor(151.5277, device='cuda:0')
benign distance is  tensor(151.5277, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.704697996377945
distance x is tensor(129.0404, device='cuda:0')
benign distance is  tensor(129.0404, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.596333593130112
distance x is tensor(139.1022, device='cuda:0')
benign distance is  tensor(139.1022, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.620269179344177
distance x is tensor(167.2638, device='cuda:0')
benign distance is  tensor(167.2638, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  10.910108864307404
distance x is tensor(136.4921, device='cuda:0')
benign distance is  tensor(136.4921, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  10.035003006458282
distance x is tensor(150.6256, device='cuda:0')
benign distance is  tensor(150.6256, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  12.738721370697021
distance x is tensor(137.3152, device='cuda:0')
benign distance is  tensor(137.3152, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.224194169044495
distance x is tensor(156.2892, device='cuda:0')
benign distance is  tensor(156.2892, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  8.91914165019989
distance x is tensor(177.1080, device='cuda:0')
benign distance is  tensor(177.1080, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([491.3466, 518.0782, 453.6388, 700.3412, 374.8010, 441.7954, 372.6207,
        348.8223, 667.9108, 729.2712, 594.4612, 642.6879, 555.4403, 623.9873,
        702.4360, 580.0569, 640.4891, 594.7110, 640.9036, 763.9298, 455.3167,
        520.6083, 557.8494, 590.3388, 378.2411, 971.1177, 721.1822, 549.9628],
       device='cuda:0')
sorted_norm is   tensor([348.8223, 372.6207, 374.8010, 378.2411, 441.7954, 453.6388, 455.3167,
        491.3466, 518.0782, 520.6083, 549.9628, 555.4403, 557.8494, 580.0569,
        590.3388, 594.4612, 594.7110, 623.9873, 640.4891, 640.9036, 642.6879,
        667.9108, 700.3412, 702.4360, 721.1822, 729.2712, 763.9298, 971.1177],
       device='cuda:0')
used idx is  tensor([ 7,  6,  4, 24,  5,  2, 20,  0,  1, 21, 27, 12, 22, 15, 23, 10, 17, 13,
        16, 18, 11,  8], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 74.68% 

Test Accuracy: 30.79% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6937186866998672
distance x is tensor(133.6782, device='cuda:0')
benign distance is  tensor(133.6782, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8443380165845156
distance x is tensor(126.7983, device='cuda:0')
benign distance is  tensor(126.7983, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.764324008487165
distance x is tensor(132.9700, device='cuda:0')
benign distance is  tensor(132.9700, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1216274835169315
distance x is tensor(166.9686, device='cuda:0')
benign distance is  tensor(166.9686, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9387159203179181
distance x is tensor(115.6180, device='cuda:0')
benign distance is  tensor(115.6180, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8715457320213318
distance x is tensor(122.1698, device='cuda:0')
benign distance is  tensor(122.1698, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1932272017002106
distance x is tensor(125.4013, device='cuda:0')
benign distance is  tensor(125.4013, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7809161320328712
distance x is tensor(104.8912, device='cuda:0')
benign distance is  tensor(104.8912, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.071213748306036
distance x is tensor(123.8037, device='cuda:0')
benign distance is  tensor(123.8037, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7633080203086138
distance x is tensor(128.6169, device='cuda:0')
benign distance is  tensor(128.6169, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.192296452820301
distance x is tensor(137.8083, device='cuda:0')
benign distance is  tensor(137.8083, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.0635906364768744
distance x is tensor(148.9582, device='cuda:0')
benign distance is  tensor(148.9582, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0029295403510332
distance x is tensor(124.7895, device='cuda:0')
benign distance is  tensor(124.7895, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8034740574657917
distance x is tensor(222.4191, device='cuda:0')
benign distance is  tensor(222.4191, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.9968691729009151
distance x is tensor(168.5786, device='cuda:0')
benign distance is  tensor(168.5786, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7461379067972302
distance x is tensor(132.6286, device='cuda:0')
benign distance is  tensor(132.6286, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.80054795742035
distance x is tensor(101.9609, device='cuda:0')
benign distance is  tensor(101.9609, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.048613339662552
distance x is tensor(142.0976, device='cuda:0')
benign distance is  tensor(142.0976, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.089039266109467
distance x is tensor(103.2625, device='cuda:0')
benign distance is  tensor(103.2625, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  11.668527960777283
distance x is tensor(100.7283, device='cuda:0')
benign distance is  tensor(100.7283, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.376254051923752
distance x is tensor(89.2961, device='cuda:0')
benign distance is  tensor(89.2961, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  8.818099439144135
distance x is tensor(109.5849, device='cuda:0')
benign distance is  tensor(109.5849, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  10.321656048297882
distance x is tensor(124.9236, device='cuda:0')
benign distance is  tensor(124.9236, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.264113038778305
distance x is tensor(95.0890, device='cuda:0')
benign distance is  tensor(95.0890, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.136242270469666
distance x is tensor(116.0798, device='cuda:0')
benign distance is  tensor(116.0798, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.608834326267242
distance x is tensor(100.9447, device='cuda:0')
benign distance is  tensor(100.9447, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.604739785194397
distance x is tensor(116.4819, device='cuda:0')
benign distance is  tensor(116.4819, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.301740288734436
distance x is tensor(150.2972, device='cuda:0')
benign distance is  tensor(150.2972, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([595.6057, 574.3265, 589.6229, 751.9738, 515.4490, 531.9339, 566.5948,
        451.1883, 470.6196, 678.0308, 473.9622, 455.3407, 422.1767, 520.0874,
        578.6887, 440.9862, 542.5882, 474.7993, 523.9824, 687.9479, 460.6404,
        556.9789, 333.8879, 564.4982, 745.9223, 315.8266, 730.3130, 524.6511],
       device='cuda:0')
sorted_norm is   tensor([315.8266, 333.8879, 422.1767, 440.9862, 451.1883, 455.3407, 460.6404,
        470.6196, 473.9622, 474.7993, 515.4490, 520.0874, 523.9824, 524.6511,
        531.9339, 542.5882, 556.9789, 564.4982, 566.5948, 574.3265, 578.6887,
        589.6229, 595.6057, 678.0308, 687.9479, 730.3130, 745.9223, 751.9738],
       device='cuda:0')
used idx is  tensor([25, 22, 12, 15,  7, 11, 20,  8, 10, 17,  4, 13, 18, 27,  5, 16, 21, 23,
         6,  1, 14,  2], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 89.18% 

Test Accuracy: 83.10% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5922555923461914
distance x is tensor(115.9425, device='cuda:0')
benign distance is  tensor(115.9425, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9394242148846388
distance x is tensor(100.5590, device='cuda:0')
benign distance is  tensor(100.5590, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.879534400999546
distance x is tensor(121.6511, device='cuda:0')
benign distance is  tensor(121.6511, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.918145352974534
distance x is tensor(156.8598, device='cuda:0')
benign distance is  tensor(156.8598, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7778321802616119
distance x is tensor(102.8620, device='cuda:0')
benign distance is  tensor(102.8620, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5496790334582329
distance x is tensor(106.5807, device='cuda:0')
benign distance is  tensor(106.5807, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1582238636910915
distance x is tensor(88.8368, device='cuda:0')
benign distance is  tensor(88.8368, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6993171982467175
distance x is tensor(96.4207, device='cuda:0')
benign distance is  tensor(96.4207, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0750309620052576
distance x is tensor(103.5493, device='cuda:0')
benign distance is  tensor(103.5493, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5954728722572327
distance x is tensor(125.3170, device='cuda:0')
benign distance is  tensor(125.3170, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1743524186313152
distance x is tensor(74.9508, device='cuda:0')
benign distance is  tensor(74.9508, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4645043648779392
distance x is tensor(117.1780, device='cuda:0')
benign distance is  tensor(117.1780, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.854087645187974
distance x is tensor(163.9639, device='cuda:0')
benign distance is  tensor(163.9639, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6639175079762936
distance x is tensor(70.0540, device='cuda:0')
benign distance is  tensor(70.0540, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9392233565449715
distance x is tensor(145.1806, device='cuda:0')
benign distance is  tensor(145.1806, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.7167762741446495
distance x is tensor(127.8793, device='cuda:0')
benign distance is  tensor(127.8793, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  11.493525087833405
distance x is tensor(136.4691, device='cuda:0')
benign distance is  tensor(136.4691, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.31225249171257
distance x is tensor(162.1936, device='cuda:0')
benign distance is  tensor(162.1936, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  13.530344545841217
distance x is tensor(120.1991, device='cuda:0')
benign distance is  tensor(120.1991, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.383977472782135
distance x is tensor(124.3140, device='cuda:0')
benign distance is  tensor(124.3140, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.489984422922134
distance x is tensor(113.2808, device='cuda:0')
benign distance is  tensor(113.2808, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.694247126579285
distance x is tensor(137.4967, device='cuda:0')
benign distance is  tensor(137.4967, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.895531445741653
distance x is tensor(144.0388, device='cuda:0')
benign distance is  tensor(144.0388, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  11.613409578800201
distance x is tensor(113.3189, device='cuda:0')
benign distance is  tensor(113.3189, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.459982573986053
distance x is tensor(144.6430, device='cuda:0')
benign distance is  tensor(144.6430, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  11.880949974060059
distance x is tensor(125.2386, device='cuda:0')
benign distance is  tensor(125.2386, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  10.773782670497894
distance x is tensor(141.2738, device='cuda:0')
benign distance is  tensor(141.2738, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.797857940196991
distance x is tensor(166.6535, device='cuda:0')
benign distance is  tensor(166.6535, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([519.3149, 470.9978, 545.0335, 720.9022, 457.0791, 470.9871, 404.0346,
        437.1936, 593.2051, 714.6131, 517.4894, 536.8658, 509.8591, 620.4202,
        629.3045, 524.1153, 636.3906, 553.9838, 591.7263, 735.4045],
       device='cuda:0')
sorted_norm is   tensor([404.0346, 437.1936, 457.0791, 470.9871, 470.9978, 509.8591, 517.4894,
        519.3149, 524.1153, 536.8658, 545.0335, 553.9838, 591.7263, 593.2051,
        620.4202, 629.3045, 636.3906, 714.6131, 720.9022, 735.4045],
       device='cuda:0')
used idx is  tensor([ 6,  7,  4,  5,  1, 12, 10,  0, 15, 11,  2, 17, 18,  8, 13, 14],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 63.53% 

Test Accuracy: 20.30% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6502806153148413
distance x is tensor(152.2446, device='cuda:0')
benign distance is  tensor(152.2446, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9244127944111824
distance x is tensor(126.7343, device='cuda:0')
benign distance is  tensor(126.7343, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8285356089472771
distance x is tensor(132.4692, device='cuda:0')
benign distance is  tensor(132.4692, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1087677776813507
distance x is tensor(179.8583, device='cuda:0')
benign distance is  tensor(179.8583, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9271301217377186
distance x is tensor(118.9756, device='cuda:0')
benign distance is  tensor(118.9756, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8217874243855476
distance x is tensor(130.2527, device='cuda:0')
benign distance is  tensor(130.2527, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1740488559007645
distance x is tensor(124.4612, device='cuda:0')
benign distance is  tensor(124.4612, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8246234953403473
distance x is tensor(127.5141, device='cuda:0')
benign distance is  tensor(127.5141, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  10.411387741565704
distance x is tensor(102.3103, device='cuda:0')
benign distance is  tensor(102.3103, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  9.629818260669708
distance x is tensor(147.7733, device='cuda:0')
benign distance is  tensor(147.7733, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  10.195329070091248
distance x is tensor(84.6743, device='cuda:0')
benign distance is  tensor(84.6743, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.244431555271149
distance x is tensor(86.3606, device='cuda:0')
benign distance is  tensor(86.3606, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  11.799840211868286
distance x is tensor(85.9278, device='cuda:0')
benign distance is  tensor(85.9278, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.069387376308441
distance x is tensor(118.5219, device='cuda:0')
benign distance is  tensor(118.5219, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.727036476135254
distance x is tensor(135.5743, device='cuda:0')
benign distance is  tensor(135.5743, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  9.046567618846893
distance x is tensor(92.0802, device='cuda:0')
benign distance is  tensor(92.0802, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.141073614358902
distance x is tensor(119.5551, device='cuda:0')
benign distance is  tensor(119.5551, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.983506917953491
distance x is tensor(105.7215, device='cuda:0')
benign distance is  tensor(105.7215, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.008170515298843
distance x is tensor(103.3038, device='cuda:0')
benign distance is  tensor(103.3038, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.693296790122986
distance x is tensor(155.7547, device='cuda:0')
benign distance is  tensor(155.7547, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([687.3631, 580.5262, 599.9957, 786.6960, 537.2830, 568.5570, 549.9455,
        569.5459, 474.7292, 687.7014, 378.3239, 409.2119, 407.9053, 552.2047,
        618.1992, 426.1655, 550.6964, 483.7682, 463.4721, 713.9697, 561.8547,
        648.8849, 711.9125, 543.7373, 788.2304, 706.6673, 533.2820, 638.4567,
        590.6360, 520.3071, 645.8533, 562.6713, 578.1559, 557.8742, 572.9430,
        818.2289, 568.9339, 607.3770, 630.8669, 688.5573, 590.1023, 996.4096,
        763.3534, 642.1581, 502.3575, 600.2654, 384.1932, 568.7236, 778.4786,
        351.6964, 682.0138, 617.8757], device='cuda:0')
sorted_norm is   tensor([351.6964, 378.3239, 384.1932, 407.9053, 409.2119, 426.1655, 463.4721,
        474.7292, 483.7682, 502.3575, 520.3071, 533.2820, 537.2830, 543.7373,
        549.9455, 550.6964, 552.2047, 557.8742, 561.8547, 562.6713, 568.5570,
        568.7236, 568.9339, 569.5459, 572.9430, 578.1559, 580.5262, 590.1023,
        590.6360, 599.9957, 600.2654, 607.3770, 617.8757, 618.1992, 630.8669,
        638.4567, 642.1581, 645.8533, 648.8849, 682.0138, 687.3631, 687.7014,
        688.5573, 706.6673, 711.9125, 713.9697, 763.3534, 778.4786, 786.6960,
        788.2304, 818.2289, 996.4096], device='cuda:0')
used idx is  tensor([49, 10, 46, 12, 11, 15, 18,  8, 17, 44, 29, 26,  4, 23,  6, 16, 13, 33,
        20, 31,  5, 47, 36,  7, 34, 32,  1, 40, 28,  2, 45, 37, 51, 14, 38, 27,
        43, 30, 21, 50,  0], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 89.71% 

Test Accuracy: 87.62% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8113236427307129
distance x is tensor(115.5294, device='cuda:0')
benign distance is  tensor(115.5294, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7621827404946089
distance x is tensor(93.8807, device='cuda:0')
benign distance is  tensor(93.8807, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7252913974225521
distance x is tensor(104.0150, device='cuda:0')
benign distance is  tensor(104.0150, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9203450344502926
distance x is tensor(153.9458, device='cuda:0')
benign distance is  tensor(153.9458, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8322716588154435
distance x is tensor(78.6583, device='cuda:0')
benign distance is  tensor(78.6583, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9587715035304427
distance x is tensor(103.4802, device='cuda:0')
benign distance is  tensor(103.4802, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2219803147017956
distance x is tensor(85.5344, device='cuda:0')
benign distance is  tensor(85.5344, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6701226728037
distance x is tensor(73.9020, device='cuda:0')
benign distance is  tensor(73.9020, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.966700965538621
distance x is tensor(95.1412, device='cuda:0')
benign distance is  tensor(95.1412, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6844502815511078
distance x is tensor(126.0131, device='cuda:0')
benign distance is  tensor(126.0131, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0130259972065687
distance x is tensor(75.0593, device='cuda:0')
benign distance is  tensor(75.0593, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.184539470821619
distance x is tensor(108.2210, device='cuda:0')
benign distance is  tensor(108.2210, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1518286187201738
distance x is tensor(173.4316, device='cuda:0')
benign distance is  tensor(173.4316, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6973995808511972
distance x is tensor(59.8692, device='cuda:0')
benign distance is  tensor(59.8692, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0140339210629463
distance x is tensor(137.6930, device='cuda:0')
benign distance is  tensor(137.6930, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2539490759372711
distance x is tensor(119.9992, device='cuda:0')
benign distance is  tensor(119.9992, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.0481450892984867
distance x is tensor(89.9664, device='cuda:0')
benign distance is  tensor(89.9664, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7115089222788811
distance x is tensor(111.8854, device='cuda:0')
benign distance is  tensor(111.8854, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9476179499179125
distance x is tensor(128.4373, device='cuda:0')
benign distance is  tensor(128.4373, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7398267835378647
distance x is tensor(119.7174, device='cuda:0')
benign distance is  tensor(119.7174, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.012942174449563
distance x is tensor(67.7382, device='cuda:0')
benign distance is  tensor(67.7382, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7293493151664734
distance x is tensor(222.1541, device='cuda:0')
benign distance is  tensor(222.1541, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1002552844583988
distance x is tensor(145.6750, device='cuda:0')
benign distance is  tensor(145.6750, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8286659233272076
distance x is tensor(99.9645, device='cuda:0')
benign distance is  tensor(99.9645, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9683019518852234
distance x is tensor(115.7483, device='cuda:0')
benign distance is  tensor(115.7483, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5895137060433626
distance x is tensor(81.0684, device='cuda:0')
benign distance is  tensor(81.0684, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9954853188246489
distance x is tensor(125.0780, device='cuda:0')
benign distance is  tensor(125.0780, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2461978010833263
distance x is tensor(107.3955, device='cuda:0')
benign distance is  tensor(107.3955, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7608941458165646
distance x is tensor(111.9265, device='cuda:0')
benign distance is  tensor(111.9265, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7449044864624739
distance x is tensor(108.5335, device='cuda:0')
benign distance is  tensor(108.5335, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5828756643459201
distance x is tensor(106.9433, device='cuda:0')
benign distance is  tensor(106.9433, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7477889526635408
distance x is tensor(178.0454, device='cuda:0')
benign distance is  tensor(178.0454, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.1248320695012808
distance x is tensor(108.1192, device='cuda:0')
benign distance is  tensor(108.1192, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.0864318162202835
distance x is tensor(139.3237, device='cuda:0')
benign distance is  tensor(139.3237, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.335043739527464
distance x is tensor(142.8834, device='cuda:0')
benign distance is  tensor(142.8834, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.9259787444025278
distance x is tensor(102.2068, device='cuda:0')
benign distance is  tensor(102.2068, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5549494754523039
distance x is tensor(163.4256, device='cuda:0')
benign distance is  tensor(163.4256, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8783959969878197
distance x is tensor(143.0346, device='cuda:0')
benign distance is  tensor(143.0346, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8394116181880236
distance x is tensor(111.7539, device='cuda:0')
benign distance is  tensor(111.7539, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.577209529466927
distance x is tensor(130.3337, device='cuda:0')
benign distance is  tensor(130.3337, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.982284545898438
distance x is tensor(169.7722, device='cuda:0')
benign distance is  tensor(169.7722, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.151941448450089
distance x is tensor(182.4170, device='cuda:0')
benign distance is  tensor(182.4170, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  10.827681541442871
distance x is tensor(162.3221, device='cuda:0')
benign distance is  tensor(162.3221, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.802918791770935
distance x is tensor(153.5755, device='cuda:0')
benign distance is  tensor(153.5755, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.592202752828598
distance x is tensor(143.1591, device='cuda:0')
benign distance is  tensor(143.1591, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  8.019853442907333
distance x is tensor(160.5159, device='cuda:0')
benign distance is  tensor(160.5159, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.748415350914001
distance x is tensor(176.7331, device='cuda:0')
benign distance is  tensor(176.7331, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  9.884140431880951
distance x is tensor(146.6824, device='cuda:0')
benign distance is  tensor(146.6824, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  11.188183784484863
distance x is tensor(166.4323, device='cuda:0')
benign distance is  tensor(166.4323, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  11.306571364402771
distance x is tensor(157.5362, device='cuda:0')
benign distance is  tensor(157.5362, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  10.344947457313538
distance x is tensor(167.8002, device='cuda:0')
benign distance is  tensor(167.8002, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.719985842704773
distance x is tensor(198.8308, device='cuda:0')
benign distance is  tensor(198.8308, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([528.8301, 429.9048, 476.1713, 710.5552, 349.3304, 439.7926, 392.0461,
        335.5571, 681.2334, 777.9948, 655.4092, 618.9252, 603.6443, 676.7941,
        726.2086, 618.6106, 686.0732, 671.9423, 689.2305, 837.0883, 608.3536,
        447.3156, 698.6081, 592.4748, 478.3084, 427.0623, 458.7597, 591.2693],
       device='cuda:0')
sorted_norm is   tensor([335.5571, 349.3304, 392.0461, 427.0623, 429.9048, 439.7926, 447.3156,
        458.7597, 476.1713, 478.3084, 528.8301, 591.2693, 592.4748, 603.6443,
        608.3536, 618.6106, 618.9252, 655.4092, 671.9423, 676.7941, 681.2334,
        686.0732, 689.2305, 698.6081, 710.5552, 726.2086, 777.9948, 837.0883],
       device='cuda:0')
used idx is  tensor([ 7,  4,  6, 25,  1,  5, 21, 26,  2, 24,  0, 27, 23, 12, 20, 15, 11, 10,
        17, 13,  8, 16], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 81.68% 

Test Accuracy: 40.77% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8130576070398092
distance x is tensor(132.5688, device='cuda:0')
benign distance is  tensor(132.5688, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.832103943452239
distance x is tensor(116.8413, device='cuda:0')
benign distance is  tensor(116.8413, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7273924630135298
distance x is tensor(122.9597, device='cuda:0')
benign distance is  tensor(122.9597, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.853041049093008
distance x is tensor(165.5426, device='cuda:0')
benign distance is  tensor(165.5426, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9402092844247818
distance x is tensor(94.3307, device='cuda:0')
benign distance is  tensor(94.3307, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6547653721645474
distance x is tensor(125.9666, device='cuda:0')
benign distance is  tensor(125.9666, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1442099176347256
distance x is tensor(105.7665, device='cuda:0')
benign distance is  tensor(105.7665, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.746576389297843
distance x is tensor(107.7194, device='cuda:0')
benign distance is  tensor(107.7194, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7589311897754669
distance x is tensor(136.8640, device='cuda:0')
benign distance is  tensor(136.8640, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.8797564636915922
distance x is tensor(121.2802, device='cuda:0')
benign distance is  tensor(121.2802, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7023882381618023
distance x is tensor(161.6971, device='cuda:0')
benign distance is  tensor(161.6971, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.676138311624527
distance x is tensor(145.4288, device='cuda:0')
benign distance is  tensor(145.4288, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7262651827186346
distance x is tensor(125.0197, device='cuda:0')
benign distance is  tensor(125.0197, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7191402185708284
distance x is tensor(128.6164, device='cuda:0')
benign distance is  tensor(128.6164, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7594107631593943
distance x is tensor(113.3631, device='cuda:0')
benign distance is  tensor(113.3631, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.956131724640727
distance x is tensor(141.5999, device='cuda:0')
benign distance is  tensor(141.5999, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.717927902936935
distance x is tensor(95.8049, device='cuda:0')
benign distance is  tensor(95.8049, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.181218713521957
distance x is tensor(141.0755, device='cuda:0')
benign distance is  tensor(141.0755, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.91602647304535
distance x is tensor(113.8314, device='cuda:0')
benign distance is  tensor(113.8314, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  11.279629409313202
distance x is tensor(97.3124, device='cuda:0')
benign distance is  tensor(97.3124, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  7.615011930465698
distance x is tensor(96.5997, device='cuda:0')
benign distance is  tensor(96.5997, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.145719289779663
distance x is tensor(112.3022, device='cuda:0')
benign distance is  tensor(112.3022, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.97330790758133
distance x is tensor(129.3577, device='cuda:0')
benign distance is  tensor(129.3577, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.807177096605301
distance x is tensor(91.8357, device='cuda:0')
benign distance is  tensor(91.8357, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.157222867012024
distance x is tensor(111.0162, device='cuda:0')
benign distance is  tensor(111.0162, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.266093134880066
distance x is tensor(96.9222, device='cuda:0')
benign distance is  tensor(96.9222, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.899455606937408
distance x is tensor(114.2203, device='cuda:0')
benign distance is  tensor(114.2203, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.886653661727905
distance x is tensor(156.5418, device='cuda:0')
benign distance is  tensor(156.5418, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([590.5974, 536.8643, 566.6898, 752.4742, 419.7674, 554.4168, 465.6099,
        462.1953, 447.1548, 664.0799, 530.1527, 457.8940, 445.9987, 531.1556,
        589.9141, 434.6476, 512.0776, 446.2003, 521.4357, 726.7411, 465.1481,
        602.7905, 379.9738, 522.8033, 793.0514, 317.8677, 639.4920, 573.9339],
       device='cuda:0')
sorted_norm is   tensor([317.8677, 379.9738, 419.7674, 434.6476, 445.9987, 446.2003, 447.1548,
        457.8940, 462.1953, 465.1481, 465.6099, 512.0776, 521.4357, 522.8033,
        530.1527, 531.1556, 536.8643, 554.4168, 566.6898, 573.9339, 589.9141,
        590.5974, 602.7905, 639.4920, 664.0799, 726.7411, 752.4742, 793.0514],
       device='cuda:0')
used idx is  tensor([25, 22,  4, 15, 12, 17,  8, 11,  7, 20,  6, 16, 18, 23, 10, 13,  1,  5,
         2, 27, 14,  0], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 89.79% 

Test Accuracy: 82.04% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8063118197023869
distance x is tensor(119.8834, device='cuda:0')
benign distance is  tensor(119.8834, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.932386539876461
distance x is tensor(109.1033, device='cuda:0')
benign distance is  tensor(109.1033, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6654346715658903
distance x is tensor(109.2395, device='cuda:0')
benign distance is  tensor(109.2395, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9986337199807167
distance x is tensor(168.1441, device='cuda:0')
benign distance is  tensor(168.1441, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8002390339970589
distance x is tensor(87.3668, device='cuda:0')
benign distance is  tensor(87.3668, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7435054024681449
distance x is tensor(95.9741, device='cuda:0')
benign distance is  tensor(95.9741, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1538479179143906
distance x is tensor(95.6601, device='cuda:0')
benign distance is  tensor(95.6601, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.680313915014267
distance x is tensor(88.6337, device='cuda:0')
benign distance is  tensor(88.6337, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9479227997362614
distance x is tensor(102.1385, device='cuda:0')
benign distance is  tensor(102.1385, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6107798246666789
distance x is tensor(118.4076, device='cuda:0')
benign distance is  tensor(118.4076, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9897057581692934
distance x is tensor(86.5468, device='cuda:0')
benign distance is  tensor(86.5468, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.20534048974514
distance x is tensor(125.4030, device='cuda:0')
benign distance is  tensor(125.4030, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0418185666203499
distance x is tensor(200.1277, device='cuda:0')
benign distance is  tensor(200.1277, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6852458138018847
distance x is tensor(79.4917, device='cuda:0')
benign distance is  tensor(79.4917, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1126774922013283
distance x is tensor(144.8695, device='cuda:0')
benign distance is  tensor(144.8695, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.232757080346346
distance x is tensor(124.6780, device='cuda:0')
benign distance is  tensor(124.6780, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  10.524707615375519
distance x is tensor(134.6458, device='cuda:0')
benign distance is  tensor(134.6458, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  9.268574088811874
distance x is tensor(162.9159, device='cuda:0')
benign distance is  tensor(162.9159, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  11.542085409164429
distance x is tensor(126.3816, device='cuda:0')
benign distance is  tensor(126.3816, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.248304724693298
distance x is tensor(128.1831, device='cuda:0')
benign distance is  tensor(128.1831, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  10.721460998058319
distance x is tensor(109.7576, device='cuda:0')
benign distance is  tensor(109.7576, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.537896394729614
distance x is tensor(122.6275, device='cuda:0')
benign distance is  tensor(122.6275, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.676582038402557
distance x is tensor(138.8358, device='cuda:0')
benign distance is  tensor(138.8358, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  10.39952439069748
distance x is tensor(116.5303, device='cuda:0')
benign distance is  tensor(116.5303, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.97032767534256
distance x is tensor(140.8852, device='cuda:0')
benign distance is  tensor(140.8852, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  11.963998973369598
distance x is tensor(122.8435, device='cuda:0')
benign distance is  tensor(122.8435, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.046298056840897
distance x is tensor(154.0867, device='cuda:0')
benign distance is  tensor(154.0867, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.41764783859253
distance x is tensor(167.7900, device='cuda:0')
benign distance is  tensor(167.7900, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 542.4746,  510.8823,  502.3038,  763.3069,  392.8943,  430.6658,
         431.8307,  403.1359,  573.3936,  735.6149,  541.4726,  561.6134,
         493.0123,  564.6449,  608.6672,  516.7449,  620.2689,  539.7896,
         639.2347,  740.3060,  430.5408,  521.4023,  587.9688,  560.1184,
         328.9413, 1011.8580,  670.3172,  475.1114], device='cuda:0')
sorted_norm is   tensor([ 328.9413,  392.8943,  403.1359,  430.5408,  430.6658,  431.8307,
         475.1114,  493.0123,  502.3038,  510.8823,  516.7449,  521.4023,
         539.7896,  541.4726,  542.4746,  560.1184,  561.6134,  564.6449,
         573.3936,  587.9688,  608.6672,  620.2689,  639.2347,  670.3172,
         735.6149,  740.3060,  763.3069, 1011.8580], device='cuda:0')
used idx is  tensor([24,  4,  7, 20,  5,  6, 27, 12,  2,  1, 15, 21, 17, 10,  0, 23, 11, 13,
         8, 22, 14, 16], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 83.42% 

Test Accuracy: 50.15% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7256279494613409
distance x is tensor(131.5747, device='cuda:0')
benign distance is  tensor(131.5747, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8843779228627682
distance x is tensor(125.1326, device='cuda:0')
benign distance is  tensor(125.1326, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.883584525436163
distance x is tensor(136.0432, device='cuda:0')
benign distance is  tensor(136.0432, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.007536768913269
distance x is tensor(168.8995, device='cuda:0')
benign distance is  tensor(168.8995, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8817743910476565
distance x is tensor(104.8316, device='cuda:0')
benign distance is  tensor(104.8316, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6634455183520913
distance x is tensor(99.0318, device='cuda:0')
benign distance is  tensor(99.0318, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3660514242947102
distance x is tensor(111.9030, device='cuda:0')
benign distance is  tensor(111.9030, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7994524613022804
distance x is tensor(94.4024, device='cuda:0')
benign distance is  tensor(94.4024, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.9597949590533972
distance x is tensor(115.6275, device='cuda:0')
benign distance is  tensor(115.6275, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9143280684947968
distance x is tensor(121.5998, device='cuda:0')
benign distance is  tensor(121.5998, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.198921900242567
distance x is tensor(152.4783, device='cuda:0')
benign distance is  tensor(152.4783, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.0642804931849241
distance x is tensor(138.1611, device='cuda:0')
benign distance is  tensor(138.1611, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0297157224267721
distance x is tensor(110.1609, device='cuda:0')
benign distance is  tensor(110.1609, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7134191915392876
distance x is tensor(219.1423, device='cuda:0')
benign distance is  tensor(219.1423, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1325853541493416
distance x is tensor(164.6928, device='cuda:0')
benign distance is  tensor(164.6928, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.832353051751852
distance x is tensor(134.1832, device='cuda:0')
benign distance is  tensor(134.1832, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  10.087812781333923
distance x is tensor(107.8110, device='cuda:0')
benign distance is  tensor(107.8110, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.814765572547913
distance x is tensor(152.7274, device='cuda:0')
benign distance is  tensor(152.7274, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.930867165327072
distance x is tensor(111.2510, device='cuda:0')
benign distance is  tensor(111.2510, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  11.869309484958649
distance x is tensor(102.1194, device='cuda:0')
benign distance is  tensor(102.1194, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.996848165988922
distance x is tensor(96.9826, device='cuda:0')
benign distance is  tensor(96.9826, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.196479797363281
distance x is tensor(123.8222, device='cuda:0')
benign distance is  tensor(123.8222, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.661039352416992
distance x is tensor(128.1904, device='cuda:0')
benign distance is  tensor(128.1904, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  9.428609311580658
distance x is tensor(99.6563, device='cuda:0')
benign distance is  tensor(99.6563, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.504153311252594
distance x is tensor(124.2008, device='cuda:0')
benign distance is  tensor(124.2008, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  11.010408341884613
distance x is tensor(104.4957, device='cuda:0')
benign distance is  tensor(104.4957, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.805394053459167
distance x is tensor(110.5298, device='cuda:0')
benign distance is  tensor(110.5298, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.326622903347015
distance x is tensor(160.8230, device='cuda:0')
benign distance is  tensor(160.8230, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([579.6459, 576.4087, 604.9005, 769.4337, 463.6980, 437.7616, 510.2535,
        420.6710, 485.4817, 705.9326, 503.1303, 472.9574, 441.4740, 575.2194,
        581.2807, 451.2187, 571.8725, 489.7335, 486.3766, 733.4817, 549.4658,
        409.0093, 591.6668, 540.0654, 553.0750, 528.7538, 511.0616, 813.7792,
        481.7743, 547.5239, 407.7404, 593.3620, 908.7094, 376.2596, 658.1779,
        571.6920], device='cuda:0')
sorted_norm is   tensor([376.2596, 407.7404, 409.0093, 420.6710, 437.7616, 441.4740, 451.2187,
        463.6980, 472.9574, 481.7743, 485.4817, 486.3766, 489.7335, 503.1303,
        510.2535, 511.0616, 528.7538, 540.0654, 547.5239, 549.4658, 553.0750,
        571.6920, 571.8725, 575.2194, 576.4087, 579.6459, 581.2807, 591.6668,
        593.3620, 604.9005, 658.1779, 705.9326, 733.4817, 769.4337, 813.7792,
        908.7094], device='cuda:0')
used idx is  tensor([33, 30, 21,  7,  5, 12, 15,  4, 11, 28,  8, 18, 17, 10,  6, 26, 25, 23,
        29, 20, 24, 35, 16, 13,  1,  0, 14, 22], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 90.50% 

Test Accuracy: 86.29% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0603107027709484
distance x is tensor(119.7045, device='cuda:0')
benign distance is  tensor(119.7045, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8375482354313135
distance x is tensor(111.1789, device='cuda:0')
benign distance is  tensor(111.1789, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7570277694612741
distance x is tensor(110.6459, device='cuda:0')
benign distance is  tensor(110.6459, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8254765868186951
distance x is tensor(157.9829, device='cuda:0')
benign distance is  tensor(157.9829, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9532041335478425
distance x is tensor(91.8835, device='cuda:0')
benign distance is  tensor(91.8835, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6116025038063526
distance x is tensor(97.1390, device='cuda:0')
benign distance is  tensor(97.1390, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.214314728975296
distance x is tensor(79.8381, device='cuda:0')
benign distance is  tensor(79.8381, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7407869827002287
distance x is tensor(84.4868, device='cuda:0')
benign distance is  tensor(84.4868, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8931959141045809
distance x is tensor(94.0842, device='cuda:0')
benign distance is  tensor(94.0842, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7596982400864363
distance x is tensor(131.0245, device='cuda:0')
benign distance is  tensor(131.0245, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0441386085003614
distance x is tensor(71.8669, device='cuda:0')
benign distance is  tensor(71.8669, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3749365769326687
distance x is tensor(120.0239, device='cuda:0')
benign distance is  tensor(120.0239, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0705954991281033
distance x is tensor(175.7443, device='cuda:0')
benign distance is  tensor(175.7443, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.625043349340558
distance x is tensor(66.0301, device='cuda:0')
benign distance is  tensor(66.0301, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0006342343986034
distance x is tensor(154.1558, device='cuda:0')
benign distance is  tensor(154.1558, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.4093312323093414
distance x is tensor(135.0343, device='cuda:0')
benign distance is  tensor(135.0343, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.8552412707358599
distance x is tensor(127.0215, device='cuda:0')
benign distance is  tensor(127.0215, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6844174843281507
distance x is tensor(91.0980, device='cuda:0')
benign distance is  tensor(91.0980, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.021492637693882
distance x is tensor(130.6353, device='cuda:0')
benign distance is  tensor(130.6353, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2200455963611603
distance x is tensor(107.1880, device='cuda:0')
benign distance is  tensor(107.1880, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7930552130565047
distance x is tensor(117.2319, device='cuda:0')
benign distance is  tensor(117.2319, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8883373737335205
distance x is tensor(112.3910, device='cuda:0')
benign distance is  tensor(112.3910, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5215346170589328
distance x is tensor(112.2555, device='cuda:0')
benign distance is  tensor(112.2555, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.749185798689723
distance x is tensor(177.2260, device='cuda:0')
benign distance is  tensor(177.2260, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  8.49714732170105
distance x is tensor(137.8311, device='cuda:0')
benign distance is  tensor(137.8311, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  9.915879935026169
distance x is tensor(164.1568, device='cuda:0')
benign distance is  tensor(164.1568, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  11.325373768806458
distance x is tensor(122.2967, device='cuda:0')
benign distance is  tensor(122.2967, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.949935674667358
distance x is tensor(130.5827, device='cuda:0')
benign distance is  tensor(130.5827, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.325044304132462
distance x is tensor(126.3065, device='cuda:0')
benign distance is  tensor(126.3065, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  8.63524916768074
distance x is tensor(131.7760, device='cuda:0')
benign distance is  tensor(131.7760, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  10.215959310531616
distance x is tensor(155.8176, device='cuda:0')
benign distance is  tensor(155.8176, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  10.669714510440826
distance x is tensor(123.9534, device='cuda:0')
benign distance is  tensor(123.9534, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.845510244369507
distance x is tensor(147.6421, device='cuda:0')
benign distance is  tensor(147.6421, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  11.974466264247894
distance x is tensor(131.6555, device='cuda:0')
benign distance is  tensor(131.6555, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.460094571113586
distance x is tensor(157.4817, device='cuda:0')
benign distance is  tensor(157.4817, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  7.816565752029419
distance x is tensor(174.9431, device='cuda:0')
benign distance is  tensor(174.9431, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([528.6210, 509.3699, 498.8806, 720.1121, 413.3839, 436.9565, 361.3633,
        383.5306, 570.7453, 746.6883, 523.9911, 556.3355, 563.6129, 571.8983,
        684.2078, 551.3180, 633.0031, 561.1235, 666.0809, 747.4216],
       device='cuda:0')
sorted_norm is   tensor([361.3633, 383.5306, 413.3839, 436.9565, 498.8806, 509.3699, 523.9911,
        528.6210, 551.3180, 556.3355, 561.1235, 563.6129, 570.7453, 571.8983,
        633.0031, 666.0809, 684.2078, 720.1121, 746.6883, 747.4216],
       device='cuda:0')
used idx is  tensor([ 6,  7,  4,  5,  2,  1, 10,  0, 15, 11, 17, 12,  8, 13, 16, 18],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 60.90% 

Test Accuracy: 17.84% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9810268394649029
distance x is tensor(141.6187, device='cuda:0')
benign distance is  tensor(141.6187, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8889039307832718
distance x is tensor(135.9011, device='cuda:0')
benign distance is  tensor(135.9011, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7827920746058226
distance x is tensor(141.8081, device='cuda:0')
benign distance is  tensor(141.8081, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8685194700956345
distance x is tensor(186.5564, device='cuda:0')
benign distance is  tensor(186.5564, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1847524009644985
distance x is tensor(155.8128, device='cuda:0')
benign distance is  tensor(155.8128, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7561730854213238
distance x is tensor(133.9698, device='cuda:0')
benign distance is  tensor(133.9698, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2544329166412354
distance x is tensor(147.1630, device='cuda:0')
benign distance is  tensor(147.1630, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8814015090465546
distance x is tensor(123.0197, device='cuda:0')
benign distance is  tensor(123.0197, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  10.040670096874237
distance x is tensor(84.4189, device='cuda:0')
benign distance is  tensor(84.4189, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.475074082612991
distance x is tensor(146.4382, device='cuda:0')
benign distance is  tensor(146.4382, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  10.491859018802643
distance x is tensor(94.7912, device='cuda:0')
benign distance is  tensor(94.7912, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  12.166777789592743
distance x is tensor(90.4780, device='cuda:0')
benign distance is  tensor(90.4780, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.750174313783646
distance x is tensor(82.1707, device='cuda:0')
benign distance is  tensor(82.1707, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.742348462343216
distance x is tensor(109.4512, device='cuda:0')
benign distance is  tensor(109.4512, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.533897638320923
distance x is tensor(124.9136, device='cuda:0')
benign distance is  tensor(124.9136, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.706641525030136
distance x is tensor(87.4775, device='cuda:0')
benign distance is  tensor(87.4775, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.103221327066422
distance x is tensor(121.2711, device='cuda:0')
benign distance is  tensor(121.2711, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  11.297563433647156
distance x is tensor(97.0914, device='cuda:0')
benign distance is  tensor(97.0914, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.863828092813492
distance x is tensor(96.9314, device='cuda:0')
benign distance is  tensor(96.9314, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.932263612747192
distance x is tensor(167.6063, device='cuda:0')
benign distance is  tensor(167.6063, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([618.3695, 599.3978, 643.1041, 820.8148, 681.8484, 581.2869, 640.4667,
        531.3146, 390.5416, 685.2225, 429.4832, 413.6074, 383.5503, 517.9434,
        569.6411, 408.7684, 565.9203, 447.8260, 439.1198, 755.1996, 563.5222,
        678.3771, 690.6367, 520.2802, 805.9692, 691.5767, 568.2322, 629.8518,
        664.2187, 573.5170, 775.5915, 688.9356, 592.5748, 621.2038, 548.5486,
        676.7619, 575.7307, 578.1874, 688.4219, 664.4996, 530.2363, 996.6860,
        766.0445, 652.0280, 458.6328, 615.8666, 375.6847, 591.8030, 812.5774,
        342.6857, 727.3354, 634.9962], device='cuda:0')
sorted_norm is   tensor([342.6857, 375.6847, 383.5503, 390.5416, 408.7684, 413.6074, 429.4832,
        439.1198, 447.8260, 458.6328, 517.9434, 520.2802, 530.2363, 531.3146,
        548.5486, 563.5222, 565.9203, 568.2322, 569.6411, 573.5170, 575.7307,
        578.1874, 581.2869, 591.8030, 592.5748, 599.3978, 615.8666, 618.3695,
        621.2038, 629.8518, 634.9962, 640.4667, 643.1041, 652.0280, 664.2187,
        664.4996, 676.7619, 678.3771, 681.8484, 685.2225, 688.4219, 688.9356,
        690.6367, 691.5767, 727.3354, 755.1996, 766.0445, 775.5915, 805.9692,
        812.5774, 820.8148, 996.6860], device='cuda:0')
used idx is  tensor([49, 46, 12,  8, 15, 11, 10, 18, 17, 44, 13, 23, 40,  7, 34, 20, 16, 26,
        14, 29, 36, 37,  5, 47, 32,  1, 45,  0, 33, 27, 51,  6,  2, 43, 28, 39,
        35, 21,  4,  9, 38], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 90.27% 

Test Accuracy: 88.04% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8607956096529961
distance x is tensor(100.8078, device='cuda:0')
benign distance is  tensor(100.8078, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7939083185046911
distance x is tensor(98.6267, device='cuda:0')
benign distance is  tensor(98.6267, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7785617541521788
distance x is tensor(105.2091, device='cuda:0')
benign distance is  tensor(105.2091, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9909004606306553
distance x is tensor(159.5598, device='cuda:0')
benign distance is  tensor(159.5598, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8829461298882961
distance x is tensor(82.2885, device='cuda:0')
benign distance is  tensor(82.2885, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7398488018661737
distance x is tensor(82.8857, device='cuda:0')
benign distance is  tensor(82.8857, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.236215952783823
distance x is tensor(78.2393, device='cuda:0')
benign distance is  tensor(78.2393, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7744066789746284
distance x is tensor(71.6581, device='cuda:0')
benign distance is  tensor(71.6581, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.2459199838340282
distance x is tensor(91.7394, device='cuda:0')
benign distance is  tensor(91.7394, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7113406844437122
distance x is tensor(119.6517, device='cuda:0')
benign distance is  tensor(119.6517, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9959986060857773
distance x is tensor(76.0928, device='cuda:0')
benign distance is  tensor(76.0928, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.254170909523964
distance x is tensor(111.1618, device='cuda:0')
benign distance is  tensor(111.1618, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8467774838209152
distance x is tensor(175.1350, device='cuda:0')
benign distance is  tensor(175.1350, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5770789422094822
distance x is tensor(61.4875, device='cuda:0')
benign distance is  tensor(61.4875, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9621685836464167
distance x is tensor(149.2420, device='cuda:0')
benign distance is  tensor(149.2420, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3648831136524677
distance x is tensor(121.4099, device='cuda:0')
benign distance is  tensor(121.4099, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.038801971822977
distance x is tensor(88.2682, device='cuda:0')
benign distance is  tensor(88.2682, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6823057681322098
distance x is tensor(115.3562, device='cuda:0')
benign distance is  tensor(115.3562, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9183380994945765
distance x is tensor(125.1234, device='cuda:0')
benign distance is  tensor(125.1234, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.0272293947637081
distance x is tensor(119.6941, device='cuda:0')
benign distance is  tensor(119.6941, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.941512156277895
distance x is tensor(68.5982, device='cuda:0')
benign distance is  tensor(68.5982, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7588290572166443
distance x is tensor(221.1338, device='cuda:0')
benign distance is  tensor(221.1338, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.9976244829595089
distance x is tensor(158.6304, device='cuda:0')
benign distance is  tensor(158.6304, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7593613341450691
distance x is tensor(106.6730, device='cuda:0')
benign distance is  tensor(106.6730, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.9287318978458643
distance x is tensor(127.8561, device='cuda:0')
benign distance is  tensor(127.8561, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.8584017436951399
distance x is tensor(99.6348, device='cuda:0')
benign distance is  tensor(99.6348, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.726941985078156
distance x is tensor(143.7094, device='cuda:0')
benign distance is  tensor(143.7094, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.3887300454080105
distance x is tensor(130.6885, device='cuda:0')
benign distance is  tensor(130.6885, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6965244235470891
distance x is tensor(118.1658, device='cuda:0')
benign distance is  tensor(118.1658, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8360461127012968
distance x is tensor(90.9582, device='cuda:0')
benign distance is  tensor(90.9582, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.6970675643533468
distance x is tensor(92.7125, device='cuda:0')
benign distance is  tensor(92.7125, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8017493542283773
distance x is tensor(133.9827, device='cuda:0')
benign distance is  tensor(133.9827, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.2215951699763536
distance x is tensor(104.5256, device='cuda:0')
benign distance is  tensor(104.5256, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.3267985433340073
distance x is tensor(137.5228, device='cuda:0')
benign distance is  tensor(137.5228, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.4736845567822456
distance x is tensor(156.0273, device='cuda:0')
benign distance is  tensor(156.0273, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.9336707815527916
distance x is tensor(97.4343, device='cuda:0')
benign distance is  tensor(97.4343, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5770557876676321
distance x is tensor(157.2606, device='cuda:0')
benign distance is  tensor(157.2606, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7434016168117523
distance x is tensor(132.4325, device='cuda:0')
benign distance is  tensor(132.4325, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9283489203080535
distance x is tensor(102.9868, device='cuda:0')
benign distance is  tensor(102.9868, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6245533879846334
distance x is tensor(122.8367, device='cuda:0')
benign distance is  tensor(122.8367, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  10.606246650218964
distance x is tensor(161.1915, device='cuda:0')
benign distance is  tensor(161.1915, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.921242594718933
distance x is tensor(187.5706, device='cuda:0')
benign distance is  tensor(187.5706, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  10.784526467323303
distance x is tensor(157.0632, device='cuda:0')
benign distance is  tensor(157.0632, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  12.925263166427612
distance x is tensor(153.7826, device='cuda:0')
benign distance is  tensor(153.7826, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.21163684129715
distance x is tensor(146.1113, device='cuda:0')
benign distance is  tensor(146.1113, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.568563729524612
distance x is tensor(157.7734, device='cuda:0')
benign distance is  tensor(157.7734, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  10.31043004989624
distance x is tensor(171.1481, device='cuda:0')
benign distance is  tensor(171.1481, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  11.154491245746613
distance x is tensor(154.8910, device='cuda:0')
benign distance is  tensor(154.8910, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.62843656539917
distance x is tensor(161.1825, device='cuda:0')
benign distance is  tensor(161.1825, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.180552363395691
distance x is tensor(144.7288, device='cuda:0')
benign distance is  tensor(144.7288, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  11.543247520923615
distance x is tensor(168.1276, device='cuda:0')
benign distance is  tensor(168.1276, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.353375911712646
distance x is tensor(184.4058, device='cuda:0')
benign distance is  tensor(184.4058, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([464.6827, 460.6893, 476.9389, 729.5183, 378.1359, 372.8218, 360.5620,
        323.5524, 677.1008, 810.5519, 633.6755, 634.3278, 623.3974, 668.0895,
        718.3870, 676.9374, 672.5153, 611.3331, 696.2691, 778.2151],
       device='cuda:0')
sorted_norm is   tensor([323.5524, 360.5620, 372.8218, 378.1359, 460.6893, 464.6827, 476.9389,
        611.3331, 623.3974, 633.6755, 634.3278, 668.0895, 672.5153, 676.9374,
        677.1008, 696.2691, 718.3870, 729.5183, 778.2151, 810.5519],
       device='cuda:0')
used idx is  tensor([ 7,  6,  5,  4,  1,  0,  2, 17, 12, 10, 11, 13, 16, 15,  8, 18],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 57.13% 

Test Accuracy: 16.56% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8027033749967813
distance x is tensor(148.1764, device='cuda:0')
benign distance is  tensor(148.1764, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9020683970302343
distance x is tensor(136.2525, device='cuda:0')
benign distance is  tensor(136.2525, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7862171921879053
distance x is tensor(141.6137, device='cuda:0')
benign distance is  tensor(141.6137, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.19007215090096
distance x is tensor(194.9204, device='cuda:0')
benign distance is  tensor(194.9204, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6644957726821303
distance x is tensor(132.8265, device='cuda:0')
benign distance is  tensor(132.8265, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8449568394571543
distance x is tensor(140.3801, device='cuda:0')
benign distance is  tensor(140.3801, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.183327293023467
distance x is tensor(130.0551, device='cuda:0')
benign distance is  tensor(130.0551, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6721291784197092
distance x is tensor(134.0125, device='cuda:0')
benign distance is  tensor(134.0125, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.959209561347961
distance x is tensor(93.0427, device='cuda:0')
benign distance is  tensor(93.0427, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.675217092037201
distance x is tensor(144.2666, device='cuda:0')
benign distance is  tensor(144.2666, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.726374745368958
distance x is tensor(83.8083, device='cuda:0')
benign distance is  tensor(83.8083, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  11.493624746799469
distance x is tensor(98.4444, device='cuda:0')
benign distance is  tensor(98.4444, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.371262192726135
distance x is tensor(82.4307, device='cuda:0')
benign distance is  tensor(82.4307, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.842690825462341
distance x is tensor(100.6618, device='cuda:0')
benign distance is  tensor(100.6618, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.502655982971191
distance x is tensor(123.6905, device='cuda:0')
benign distance is  tensor(123.6905, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  9.322985529899597
distance x is tensor(86.1662, device='cuda:0')
benign distance is  tensor(86.1662, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.336320042610168
distance x is tensor(122.5154, device='cuda:0')
benign distance is  tensor(122.5154, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.480245649814606
distance x is tensor(100.3908, device='cuda:0')
benign distance is  tensor(100.3908, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.323085457086563
distance x is tensor(106.0698, device='cuda:0')
benign distance is  tensor(106.0698, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.242653846740723
distance x is tensor(149.7474, device='cuda:0')
benign distance is  tensor(149.7474, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([646.6475, 591.7206, 629.8316, 857.1911, 576.1594, 598.0340, 567.6208,
        573.1746, 429.4629, 676.1167, 388.5444, 454.4198, 387.4662, 471.9120,
        554.0212, 398.7463, 583.7304, 461.8736, 474.7560, 682.1899, 610.6654,
        489.1524, 648.3500, 569.6035, 580.5621, 563.8478, 558.5562, 828.3149,
        481.5293, 613.2416, 412.7501, 565.5666, 848.3959, 356.1389, 713.1155,
        602.9123], device='cuda:0')
sorted_norm is   tensor([356.1389, 387.4662, 388.5444, 398.7463, 412.7501, 429.4629, 454.4198,
        461.8736, 471.9120, 474.7560, 481.5293, 489.1524, 554.0212, 558.5562,
        563.8478, 565.5666, 567.6208, 569.6035, 573.1746, 576.1594, 580.5621,
        583.7304, 591.7206, 598.0340, 602.9123, 610.6654, 613.2416, 629.8316,
        646.6475, 648.3500, 676.1167, 682.1899, 713.1155, 828.3149, 848.3959,
        857.1911], device='cuda:0')
used idx is  tensor([33, 12, 10, 15, 30,  8, 11, 17, 13, 18, 28, 21, 14, 26, 25, 31,  6, 23,
         7,  4, 24, 16,  1,  5, 35, 20, 29,  2], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 90.63% 

Test Accuracy: 86.35% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7656566817313433
distance x is tensor(96.3646, device='cuda:0')
benign distance is  tensor(96.3646, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7210197150707245
distance x is tensor(96.6405, device='cuda:0')
benign distance is  tensor(96.6405, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7054707501083612
distance x is tensor(109.1838, device='cuda:0')
benign distance is  tensor(109.1838, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9765934217721224
distance x is tensor(152.8799, device='cuda:0')
benign distance is  tensor(152.8799, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8697252813726664
distance x is tensor(82.0444, device='cuda:0')
benign distance is  tensor(82.0444, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8622620571404696
distance x is tensor(109.8088, device='cuda:0')
benign distance is  tensor(109.8088, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3097749184817076
distance x is tensor(88.5662, device='cuda:0')
benign distance is  tensor(88.5662, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6523294541984797
distance x is tensor(77.4925, device='cuda:0')
benign distance is  tensor(77.4925, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0172140263020992
distance x is tensor(100.7488, device='cuda:0')
benign distance is  tensor(100.7488, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6919138818047941
distance x is tensor(124.6650, device='cuda:0')
benign distance is  tensor(124.6650, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0019945856183767
distance x is tensor(64.9768, device='cuda:0')
benign distance is  tensor(64.9768, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.653608798980713
distance x is tensor(121.5913, device='cuda:0')
benign distance is  tensor(121.5913, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2489571198821068
distance x is tensor(176.5583, device='cuda:0')
benign distance is  tensor(176.5583, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6344223860651255
distance x is tensor(64.0586, device='cuda:0')
benign distance is  tensor(64.0586, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9652807228267193
distance x is tensor(150.9083, device='cuda:0')
benign distance is  tensor(150.9083, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3535630218684673
distance x is tensor(130.8425, device='cuda:0')
benign distance is  tensor(130.8425, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.0097794104367495
distance x is tensor(117.9535, device='cuda:0')
benign distance is  tensor(117.9535, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6103179883211851
distance x is tensor(90.5541, device='cuda:0')
benign distance is  tensor(90.5541, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8846312388777733
distance x is tensor(134.4867, device='cuda:0')
benign distance is  tensor(134.4867, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.3260484673082829
distance x is tensor(114.5894, device='cuda:0')
benign distance is  tensor(114.5894, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9352575149387121
distance x is tensor(119.6286, device='cuda:0')
benign distance is  tensor(119.6286, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9392886850982904
distance x is tensor(121.5263, device='cuda:0')
benign distance is  tensor(121.5263, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5419298931956291
distance x is tensor(120.9666, device='cuda:0')
benign distance is  tensor(120.9666, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.8034523073583841
distance x is tensor(183.1289, device='cuda:0')
benign distance is  tensor(183.1289, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.476538866758347
distance x is tensor(137.5841, device='cuda:0')
benign distance is  tensor(137.5841, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.799815595149994
distance x is tensor(163.0547, device='cuda:0')
benign distance is  tensor(163.0547, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.856232196092606
distance x is tensor(130.7188, device='cuda:0')
benign distance is  tensor(130.7188, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.082023859024048
distance x is tensor(126.9119, device='cuda:0')
benign distance is  tensor(126.9119, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.608509540557861
distance x is tensor(121.0044, device='cuda:0')
benign distance is  tensor(121.0044, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.884297549724579
distance x is tensor(129.1885, device='cuda:0')
benign distance is  tensor(129.1885, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.830251812934875
distance x is tensor(147.3707, device='cuda:0')
benign distance is  tensor(147.3707, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  10.516707420349121
distance x is tensor(114.7925, device='cuda:0')
benign distance is  tensor(114.7925, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.538893699645996
distance x is tensor(146.9274, device='cuda:0')
benign distance is  tensor(146.9274, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.963934183120728
distance x is tensor(130.1110, device='cuda:0')
benign distance is  tensor(130.1110, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  10.276784896850586
distance x is tensor(128.8129, device='cuda:0')
benign distance is  tensor(128.8129, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.20458722114563
distance x is tensor(179.0340, device='cuda:0')
benign distance is  tensor(179.0340, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 427.3706,  452.6071,  498.8416,  702.9474,  368.9547,  483.9651,
         400.1212,  345.9615,  560.5371,  741.4698,  542.4174,  553.3956,
         533.6333,  583.3897,  643.0405,  523.0945,  641.8333,  568.2035,
         562.7800,  781.6047,  417.1505,  535.5668,  563.4795,  571.1513,
         326.1122, 1003.0723,  720.9686,  507.9060], device='cuda:0')
sorted_norm is   tensor([ 326.1122,  345.9615,  368.9547,  400.1212,  417.1505,  427.3706,
         452.6071,  483.9651,  498.8416,  507.9060,  523.0945,  533.6333,
         535.5668,  542.4174,  553.3956,  560.5371,  562.7800,  563.4795,
         568.2035,  571.1513,  583.3897,  641.8333,  643.0405,  702.9474,
         720.9686,  741.4698,  781.6047, 1003.0723], device='cuda:0')
used idx is  tensor([24,  7,  4,  6, 20,  0,  1,  5,  2, 27, 15, 12, 21, 10, 11,  8, 18, 22,
        17, 23, 13, 16], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 79.99% 

Test Accuracy: 44.01% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9042210374027491
distance x is tensor(132.6263, device='cuda:0')
benign distance is  tensor(132.6263, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8789463303983212
distance x is tensor(129.0757, device='cuda:0')
benign distance is  tensor(129.0757, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8586040064692497
distance x is tensor(121.9131, device='cuda:0')
benign distance is  tensor(121.9131, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0515718385577202
distance x is tensor(170.7930, device='cuda:0')
benign distance is  tensor(170.7930, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9570047967135906
distance x is tensor(108.8464, device='cuda:0')
benign distance is  tensor(108.8464, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7018592380918562
distance x is tensor(109.5402, device='cuda:0')
benign distance is  tensor(109.5402, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0682898946106434
distance x is tensor(106.1620, device='cuda:0')
benign distance is  tensor(106.1620, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8043371941894293
distance x is tensor(99.9639, device='cuda:0')
benign distance is  tensor(99.9639, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1239952072501183
distance x is tensor(106.1974, device='cuda:0')
benign distance is  tensor(106.1974, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.874737897887826
distance x is tensor(137.3708, device='cuda:0')
benign distance is  tensor(137.3708, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.1951847076416016
distance x is tensor(142.9195, device='cuda:0')
benign distance is  tensor(142.9195, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9554407261312008
distance x is tensor(132.1481, device='cuda:0')
benign distance is  tensor(132.1481, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.1126381531357765
distance x is tensor(98.3536, device='cuda:0')
benign distance is  tensor(98.3536, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7684232667088509
distance x is tensor(222.7543, device='cuda:0')
benign distance is  tensor(222.7543, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.3150389455258846
distance x is tensor(178.3937, device='cuda:0')
benign distance is  tensor(178.3937, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7913571987301111
distance x is tensor(119.4756, device='cuda:0')
benign distance is  tensor(119.4756, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  11.496529757976532
distance x is tensor(100.2015, device='cuda:0')
benign distance is  tensor(100.2015, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.370189726352692
distance x is tensor(145.4060, device='cuda:0')
benign distance is  tensor(145.4060, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.954219907522202
distance x is tensor(106.4098, device='cuda:0')
benign distance is  tensor(106.4098, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.37155294418335
distance x is tensor(104.1819, device='cuda:0')
benign distance is  tensor(104.1819, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  10.324887931346893
distance x is tensor(98.9127, device='cuda:0')
benign distance is  tensor(98.9127, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  8.377793729305267
distance x is tensor(112.5520, device='cuda:0')
benign distance is  tensor(112.5520, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  10.002254664897919
distance x is tensor(131.7467, device='cuda:0')
benign distance is  tensor(131.7467, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  9.868652403354645
distance x is tensor(97.7076, device='cuda:0')
benign distance is  tensor(97.7076, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.69375592470169
distance x is tensor(121.5115, device='cuda:0')
benign distance is  tensor(121.5115, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  9.456765860319138
distance x is tensor(96.9541, device='cuda:0')
benign distance is  tensor(96.9541, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.773338943719864
distance x is tensor(119.2324, device='cuda:0')
benign distance is  tensor(119.2324, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.567357540130615
distance x is tensor(177.0515, device='cuda:0')
benign distance is  tensor(177.0515, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([610.0062, 604.5682, 559.0983, 774.6673, 485.4425, 478.8140, 488.8656,
        436.6086, 444.0896, 683.9586, 482.7868, 480.9424, 449.6626, 527.0372,
        595.0610, 457.8363, 554.8971, 439.9670, 523.3240, 777.7562, 486.7431,
        563.8359, 325.6903, 570.8266, 806.0063, 313.7271, 691.1799, 616.4839],
       device='cuda:0')
sorted_norm is   tensor([313.7271, 325.6903, 436.6086, 439.9670, 444.0896, 449.6626, 457.8363,
        478.8140, 480.9424, 482.7868, 485.4425, 486.7431, 488.8656, 523.3240,
        527.0372, 554.8971, 559.0983, 563.8359, 570.8266, 595.0610, 604.5682,
        610.0062, 616.4839, 683.9586, 691.1799, 774.6673, 777.7562, 806.0063],
       device='cuda:0')
used idx is  tensor([25, 22,  7, 17,  8, 12, 15,  5, 11, 10,  4, 20,  6, 18, 13, 16,  2, 21,
        23, 14,  1,  0], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 89.37% 

Test Accuracy: 71.53% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7526924833655357
distance x is tensor(109.0866, device='cuda:0')
benign distance is  tensor(109.0866, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.904932726174593
distance x is tensor(97.4203, device='cuda:0')
benign distance is  tensor(97.4203, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6656268425285816
distance x is tensor(108.9315, device='cuda:0')
benign distance is  tensor(108.9315, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0235919151455164
distance x is tensor(167.1230, device='cuda:0')
benign distance is  tensor(167.1230, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9122314658015966
distance x is tensor(92.8855, device='cuda:0')
benign distance is  tensor(92.8855, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.688344088383019
distance x is tensor(97.5823, device='cuda:0')
benign distance is  tensor(97.5823, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.588562611490488
distance x is tensor(92.5577, device='cuda:0')
benign distance is  tensor(92.5577, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7325485870242119
distance x is tensor(88.4375, device='cuda:0')
benign distance is  tensor(88.4375, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9835547562688589
distance x is tensor(111.5533, device='cuda:0')
benign distance is  tensor(111.5533, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8149720318615437
distance x is tensor(133.0682, device='cuda:0')
benign distance is  tensor(133.0682, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1689987555146217
distance x is tensor(86.4969, device='cuda:0')
benign distance is  tensor(86.4969, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.319959182292223
distance x is tensor(119.7579, device='cuda:0')
benign distance is  tensor(119.7579, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.4740779846906662
distance x is tensor(182.0433, device='cuda:0')
benign distance is  tensor(182.0433, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7470135157927871
distance x is tensor(73.2280, device='cuda:0')
benign distance is  tensor(73.2280, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9820792116224766
distance x is tensor(157.8301, device='cuda:0')
benign distance is  tensor(157.8301, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3655426390469074
distance x is tensor(141.5135, device='cuda:0')
benign distance is  tensor(141.5135, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.432039499282837
distance x is tensor(118.9638, device='cuda:0')
benign distance is  tensor(118.9638, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.179768830537796
distance x is tensor(155.8216, device='cuda:0')
benign distance is  tensor(155.8216, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.53502345085144
distance x is tensor(112.2529, device='cuda:0')
benign distance is  tensor(112.2529, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  12.19163179397583
distance x is tensor(121.7020, device='cuda:0')
benign distance is  tensor(121.7020, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.530258029699326
distance x is tensor(111.7671, device='cuda:0')
benign distance is  tensor(111.7671, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.768006265163422
distance x is tensor(139.6086, device='cuda:0')
benign distance is  tensor(139.6086, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  11.15357095003128
distance x is tensor(141.3417, device='cuda:0')
benign distance is  tensor(141.3417, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  9.390533149242401
distance x is tensor(109.1345, device='cuda:0')
benign distance is  tensor(109.1345, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.646845877170563
distance x is tensor(131.6114, device='cuda:0')
benign distance is  tensor(131.6114, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  12.022757947444916
distance x is tensor(115.6756, device='cuda:0')
benign distance is  tensor(115.6756, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  10.081511080265045
distance x is tensor(137.4591, device='cuda:0')
benign distance is  tensor(137.4591, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  7.727516770362854
distance x is tensor(170.6195, device='cuda:0')
benign distance is  tensor(170.6195, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([505.6917, 453.5255, 500.1689, 767.4342, 408.6425, 432.9670, 415.3197,
        390.8548, 520.4052, 709.1424, 488.3236, 534.5764, 496.5964, 623.0404,
        632.7015, 489.7684, 585.7451, 507.7976, 568.0550, 747.6039, 609.3807,
        489.1006, 692.3174, 627.6481, 553.0311, 466.8175, 465.5228, 647.4103],
       device='cuda:0')
sorted_norm is   tensor([390.8548, 408.6425, 415.3197, 432.9670, 453.5255, 465.5228, 466.8175,
        488.3236, 489.1006, 489.7684, 496.5964, 500.1689, 505.6917, 507.7976,
        520.4052, 534.5764, 553.0311, 568.0550, 585.7451, 609.3807, 623.0404,
        627.6481, 632.7015, 647.4103, 692.3174, 709.1424, 747.6039, 767.4342],
       device='cuda:0')
used idx is  tensor([ 7,  4,  6,  5,  1, 26, 25, 10, 21, 15, 12,  2,  0, 17,  8, 11, 24, 18,
        16, 20, 13, 23], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 87.33% 

Test Accuracy: 64.59% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9920566007494926
distance x is tensor(135.4646, device='cuda:0')
benign distance is  tensor(135.4646, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9680019542574883
distance x is tensor(121.4880, device='cuda:0')
benign distance is  tensor(121.4880, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8147654160857201
distance x is tensor(119.6614, device='cuda:0')
benign distance is  tensor(119.6614, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.421693205833435
distance x is tensor(161.7301, device='cuda:0')
benign distance is  tensor(161.7301, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9935878161340952
distance x is tensor(82.7593, device='cuda:0')
benign distance is  tensor(82.7593, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8114981539547443
distance x is tensor(101.5454, device='cuda:0')
benign distance is  tensor(101.5454, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2681257147341967
distance x is tensor(110.0126, device='cuda:0')
benign distance is  tensor(110.0126, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6751944553107023
distance x is tensor(89.1188, device='cuda:0')
benign distance is  tensor(89.1188, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8110025636851788
distance x is tensor(134.0080, device='cuda:0')
benign distance is  tensor(134.0080, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.8527873307466507
distance x is tensor(114.9695, device='cuda:0')
benign distance is  tensor(114.9695, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7203091196715832
distance x is tensor(163.3765, device='cuda:0')
benign distance is  tensor(163.3765, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.0475905872881413
distance x is tensor(143.8351, device='cuda:0')
benign distance is  tensor(143.8351, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8927574418485165
distance x is tensor(133.9975, device='cuda:0')
benign distance is  tensor(133.9975, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.9051697421818972
distance x is tensor(116.7905, device='cuda:0')
benign distance is  tensor(116.7905, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.9611023887991905
distance x is tensor(114.5604, device='cuda:0')
benign distance is  tensor(114.5604, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7606321405619383
distance x is tensor(134.3447, device='cuda:0')
benign distance is  tensor(134.3447, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  11.38131296634674
distance x is tensor(105.9314, device='cuda:0')
benign distance is  tensor(105.9314, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.901697158813477
distance x is tensor(157.8997, device='cuda:0')
benign distance is  tensor(157.8997, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.216954231262207
distance x is tensor(102.7629, device='cuda:0')
benign distance is  tensor(102.7629, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.73810064792633
distance x is tensor(114.5291, device='cuda:0')
benign distance is  tensor(114.5291, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.060091763734818
distance x is tensor(108.0082, device='cuda:0')
benign distance is  tensor(108.0082, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  8.556455820798874
distance x is tensor(121.3122, device='cuda:0')
benign distance is  tensor(121.3122, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.919467389583588
distance x is tensor(137.2804, device='cuda:0')
benign distance is  tensor(137.2804, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  10.05668592453003
distance x is tensor(99.0920, device='cuda:0')
benign distance is  tensor(99.0920, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  11.057312190532684
distance x is tensor(135.2227, device='cuda:0')
benign distance is  tensor(135.2227, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  11.202587604522705
distance x is tensor(99.9540, device='cuda:0')
benign distance is  tensor(99.9540, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.871544271707535
distance x is tensor(112.6110, device='cuda:0')
benign distance is  tensor(112.6110, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.753471314907074
distance x is tensor(166.6700, device='cuda:0')
benign distance is  tensor(166.6700, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([589.8057, 561.3989, 544.6846, 733.0836, 371.6946, 430.1757, 504.1999,
        399.9555, 482.6750, 708.8823, 446.1562, 509.1506, 484.6108, 549.6525,
        629.9772, 459.7523, 610.7899, 457.3969, 490.0074, 732.2014, 516.1508,
        657.8987, 729.7073, 478.7372, 750.2027, 630.8246, 502.5478, 571.8994,
        548.3267, 453.8699, 635.3943, 562.9426, 570.9394, 585.9659, 564.0966,
        842.4617, 487.2772, 623.3985, 654.0554, 620.2277, 449.0468, 994.8226,
        795.1664, 541.6107, 516.2769, 614.3838, 399.7359, 558.6372, 824.2465,
        343.2090, 721.3670, 642.1756], device='cuda:0')
sorted_norm is   tensor([343.2090, 371.6946, 399.7359, 399.9555, 430.1757, 446.1562, 449.0468,
        453.8699, 457.3969, 459.7523, 478.7372, 482.6750, 484.6108, 487.2772,
        490.0074, 502.5478, 504.1999, 509.1506, 516.1508, 516.2769, 541.6107,
        544.6846, 548.3267, 549.6525, 558.6372, 561.3989, 562.9426, 564.0966,
        570.9394, 571.8994, 585.9659, 589.8057, 610.7899, 614.3838, 620.2277,
        623.3985, 629.9772, 630.8246, 635.3943, 642.1756, 654.0554, 657.8987,
        708.8823, 721.3670, 729.7073, 732.2014, 733.0836, 750.2027, 795.1664,
        824.2465, 842.4617, 994.8226], device='cuda:0')
used idx is  tensor([49,  4, 46,  7,  5, 10, 40, 29, 17, 15, 23,  8, 12, 36, 18, 26,  6, 11,
        20, 44, 43,  2, 28, 13, 47,  1, 31, 34, 32, 27, 33,  0, 16, 45, 39, 37,
        14, 25, 30, 51, 38], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 89.73% 

Test Accuracy: 88.00% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7002571281045675
distance x is tensor(113.6234, device='cuda:0')
benign distance is  tensor(113.6234, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7122873943299055
distance x is tensor(93.4751, device='cuda:0')
benign distance is  tensor(93.4751, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7710846867412329
distance x is tensor(98.2455, device='cuda:0')
benign distance is  tensor(98.2455, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0904498249292374
distance x is tensor(158.1009, device='cuda:0')
benign distance is  tensor(158.1009, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9541415432468057
distance x is tensor(77.1419, device='cuda:0')
benign distance is  tensor(77.1419, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7952627958729863
distance x is tensor(86.5341, device='cuda:0')
benign distance is  tensor(86.5341, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.216954331845045
distance x is tensor(80.8704, device='cuda:0')
benign distance is  tensor(80.8704, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7525701029226184
distance x is tensor(75.8288, device='cuda:0')
benign distance is  tensor(75.8288, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.130198236554861
distance x is tensor(105.9214, device='cuda:0')
benign distance is  tensor(105.9214, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6777912867255509
distance x is tensor(115.4765, device='cuda:0')
benign distance is  tensor(115.4765, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.049238447099924
distance x is tensor(61.3173, device='cuda:0')
benign distance is  tensor(61.3173, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.33536995947361
distance x is tensor(111.2331, device='cuda:0')
benign distance is  tensor(111.2331, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0548925679177046
distance x is tensor(170.0005, device='cuda:0')
benign distance is  tensor(170.0005, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6594035318121314
distance x is tensor(62.0348, device='cuda:0')
benign distance is  tensor(62.0348, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9550255686044693
distance x is tensor(150.8521, device='cuda:0')
benign distance is  tensor(150.8521, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3556463494896889
distance x is tensor(118.5816, device='cuda:0')
benign distance is  tensor(118.5816, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1121124010533094
distance x is tensor(96.1880, device='cuda:0')
benign distance is  tensor(96.1880, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6915069092065096
distance x is tensor(112.5251, device='cuda:0')
benign distance is  tensor(112.5251, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8012069836258888
distance x is tensor(122.0527, device='cuda:0')
benign distance is  tensor(122.0527, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.859831215813756
distance x is tensor(121.6564, device='cuda:0')
benign distance is  tensor(121.6564, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.1179264169186354
distance x is tensor(72.9863, device='cuda:0')
benign distance is  tensor(72.9863, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8399298321455717
distance x is tensor(225.4897, device='cuda:0')
benign distance is  tensor(225.4897, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.9550522547215223
distance x is tensor(170.0581, device='cuda:0')
benign distance is  tensor(170.0581, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6886114589869976
distance x is tensor(110.3517, device='cuda:0')
benign distance is  tensor(110.3517, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.028480278328061
distance x is tensor(120.3208, device='cuda:0')
benign distance is  tensor(120.3208, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.807906499132514
distance x is tensor(85.0951, device='cuda:0')
benign distance is  tensor(85.0951, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9794303067028522
distance x is tensor(136.5789, device='cuda:0')
benign distance is  tensor(136.5789, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.3295395150780678
distance x is tensor(121.8833, device='cuda:0')
benign distance is  tensor(121.8833, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6260045524686575
distance x is tensor(118.6134, device='cuda:0')
benign distance is  tensor(118.6134, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7389617692679167
distance x is tensor(108.5366, device='cuda:0')
benign distance is  tensor(108.5366, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5373121462762356
distance x is tensor(114.5011, device='cuda:0')
benign distance is  tensor(114.5011, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6569933705031872
distance x is tensor(182.5290, device='cuda:0')
benign distance is  tensor(182.5290, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.9833480045199394
distance x is tensor(108.2434, device='cuda:0')
benign distance is  tensor(108.2434, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.333051260560751
distance x is tensor(148.6549, device='cuda:0')
benign distance is  tensor(148.6549, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.2748635299503803
distance x is tensor(155.3087, device='cuda:0')
benign distance is  tensor(155.3087, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.8446514885872602
distance x is tensor(90.9977, device='cuda:0')
benign distance is  tensor(90.9977, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.776589922606945
distance x is tensor(169.3854, device='cuda:0')
benign distance is  tensor(169.3854, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8752255160361528
distance x is tensor(145.2910, device='cuda:0')
benign distance is  tensor(145.2910, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8222380541265011
distance x is tensor(102.9882, device='cuda:0')
benign distance is  tensor(102.9882, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5218911059200764
distance x is tensor(128.3313, device='cuda:0')
benign distance is  tensor(128.3313, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  11.040735125541687
distance x is tensor(149.6332, device='cuda:0')
benign distance is  tensor(149.6332, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.465485870838165
distance x is tensor(177.3754, device='cuda:0')
benign distance is  tensor(177.3754, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.953571438789368
distance x is tensor(151.9857, device='cuda:0')
benign distance is  tensor(151.9857, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  12.595613837242126
distance x is tensor(151.2449, device='cuda:0')
benign distance is  tensor(151.2449, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.217917799949646
distance x is tensor(138.6171, device='cuda:0')
benign distance is  tensor(138.6171, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  8.22696653008461
distance x is tensor(156.3800, device='cuda:0')
benign distance is  tensor(156.3800, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.874372780323029
distance x is tensor(170.2400, device='cuda:0')
benign distance is  tensor(170.2400, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  10.5802863240242
distance x is tensor(150.9548, device='cuda:0')
benign distance is  tensor(150.9548, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  10.347197234630585
distance x is tensor(159.3658, device='cuda:0')
benign distance is  tensor(159.3658, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  12.331413567066193
distance x is tensor(142.9563, device='cuda:0')
benign distance is  tensor(142.9563, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.929721236228943
distance x is tensor(165.5284, device='cuda:0')
benign distance is  tensor(165.5284, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  8.594421118497849
distance x is tensor(189.4350, device='cuda:0')
benign distance is  tensor(189.4350, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([499.7384, 432.2642, 456.4128, 721.6201, 343.4244, 381.3365, 369.7475,
        331.0840, 627.7733, 773.1255, 622.0384, 626.2353, 593.6155, 676.4253,
        712.1431, 631.1554, 686.8679, 609.6845, 683.4698, 809.2565],
       device='cuda:0')
sorted_norm is   tensor([331.0840, 343.4244, 369.7475, 381.3365, 432.2642, 456.4128, 499.7384,
        593.6155, 609.6845, 622.0384, 626.2353, 627.7733, 631.1554, 676.4253,
        683.4698, 686.8679, 712.1431, 721.6201, 773.1255, 809.2565],
       device='cuda:0')
used idx is  tensor([ 7,  4,  6,  5,  1,  2,  0, 12, 17, 10, 11,  8, 15, 13, 18, 16],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 58.37% 

Test Accuracy: 16.78% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7363941911607981
distance x is tensor(145.9406, device='cuda:0')
benign distance is  tensor(145.9406, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9304734878242016
distance x is tensor(154.7337, device='cuda:0')
benign distance is  tensor(154.7337, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9235179536044598
distance x is tensor(152.3218, device='cuda:0')
benign distance is  tensor(152.3218, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0579398665577173
distance x is tensor(199.5488, device='cuda:0')
benign distance is  tensor(199.5488, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0153540596365929
distance x is tensor(141.4265, device='cuda:0')
benign distance is  tensor(141.4265, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.798071475699544
distance x is tensor(145.4570, device='cuda:0')
benign distance is  tensor(145.4570, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.230557419359684
distance x is tensor(138.1997, device='cuda:0')
benign distance is  tensor(138.1997, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9036138541996479
distance x is tensor(137.7452, device='cuda:0')
benign distance is  tensor(137.7452, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  10.622854888439178
distance x is tensor(79.4920, device='cuda:0')
benign distance is  tensor(79.4920, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.799078285694122
distance x is tensor(146.0142, device='cuda:0')
benign distance is  tensor(146.0142, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.676338136196136
distance x is tensor(83.8173, device='cuda:0')
benign distance is  tensor(83.8173, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  11.163091838359833
distance x is tensor(81.3326, device='cuda:0')
benign distance is  tensor(81.3326, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.496132880449295
distance x is tensor(82.6642, device='cuda:0')
benign distance is  tensor(82.6642, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  9.770136773586273
distance x is tensor(109.5007, device='cuda:0')
benign distance is  tensor(109.5007, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  10.206452071666718
distance x is tensor(120.7459, device='cuda:0')
benign distance is  tensor(120.7459, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  7.910966604948044
distance x is tensor(79.6205, device='cuda:0')
benign distance is  tensor(79.6205, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.559353411197662
distance x is tensor(113.9118, device='cuda:0')
benign distance is  tensor(113.9118, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.05010312795639
distance x is tensor(81.4885, device='cuda:0')
benign distance is  tensor(81.4885, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.956568539142609
distance x is tensor(103.3798, device='cuda:0')
benign distance is  tensor(103.3798, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.359925031661987
distance x is tensor(156.5063, device='cuda:0')
benign distance is  tensor(156.5063, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([630.5000, 692.1615, 667.0839, 868.4595, 612.2227, 614.7516, 599.6590,
        596.6387, 374.4043, 685.8922, 383.6834, 385.0670, 379.6743, 505.5862,
        553.3237, 375.4481, 518.0544, 374.6379, 459.6871, 703.5810, 537.6974,
        578.0146, 362.8425, 566.0262, 795.8006, 353.7639, 722.3073, 583.2141],
       device='cuda:0')
sorted_norm is   tensor([353.7639, 362.8425, 374.4043, 374.6379, 375.4481, 379.6743, 383.6834,
        385.0670, 459.6871, 505.5862, 518.0544, 537.6974, 553.3237, 566.0262,
        578.0146, 583.2141, 596.6387, 599.6590, 612.2227, 614.7516, 630.5000,
        667.0839, 685.8922, 692.1615, 703.5810, 722.3073, 795.8006, 868.4595],
       device='cuda:0')
used idx is  tensor([25, 22,  8, 17, 15, 12, 10, 11, 18, 13, 16, 20, 14, 23, 21, 27,  7,  6,
         4,  5,  0,  2], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 90.02% 

Test Accuracy: 84.24% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7891722973436117
distance x is tensor(111.3847, device='cuda:0')
benign distance is  tensor(111.3847, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7444500122219324
distance x is tensor(103.6460, device='cuda:0')
benign distance is  tensor(103.6460, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1203067600727081
distance x is tensor(117.5457, device='cuda:0')
benign distance is  tensor(117.5457, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9023466426879168
distance x is tensor(168.4935, device='cuda:0')
benign distance is  tensor(168.4935, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.047440430149436
distance x is tensor(80.8111, device='cuda:0')
benign distance is  tensor(80.8111, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7941430993378162
distance x is tensor(98.7704, device='cuda:0')
benign distance is  tensor(98.7704, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3582943379878998
distance x is tensor(70.3143, device='cuda:0')
benign distance is  tensor(70.3143, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7202248834073544
distance x is tensor(93.4922, device='cuda:0')
benign distance is  tensor(93.4922, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1042241472750902
distance x is tensor(114.2092, device='cuda:0')
benign distance is  tensor(114.2092, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7200473165139556
distance x is tensor(120.8786, device='cuda:0')
benign distance is  tensor(120.8786, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0614806078374386
distance x is tensor(73.7915, device='cuda:0')
benign distance is  tensor(73.7915, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2832216117531061
distance x is tensor(124.6244, device='cuda:0')
benign distance is  tensor(124.6244, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2216459177434444
distance x is tensor(188.1491, device='cuda:0')
benign distance is  tensor(188.1491, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7227843049913645
distance x is tensor(66.3180, device='cuda:0')
benign distance is  tensor(66.3180, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0045560449361801
distance x is tensor(156.6398, device='cuda:0')
benign distance is  tensor(156.6398, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.326593030244112
distance x is tensor(124.6591, device='cuda:0')
benign distance is  tensor(124.6591, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  11.425390422344208
distance x is tensor(134.2089, device='cuda:0')
benign distance is  tensor(134.2089, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.7125997841358185
distance x is tensor(160.6712, device='cuda:0')
benign distance is  tensor(160.6712, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  11.11639016866684
distance x is tensor(126.2247, device='cuda:0')
benign distance is  tensor(126.2247, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  12.025854468345642
distance x is tensor(131.8246, device='cuda:0')
benign distance is  tensor(131.8246, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  10.063235461711884
distance x is tensor(110.6331, device='cuda:0')
benign distance is  tensor(110.6331, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  8.108915537595749
distance x is tensor(137.2536, device='cuda:0')
benign distance is  tensor(137.2536, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.01684445142746
distance x is tensor(145.9785, device='cuda:0')
benign distance is  tensor(145.9785, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  9.761307775974274
distance x is tensor(116.1692, device='cuda:0')
benign distance is  tensor(116.1692, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.51421058177948
distance x is tensor(127.3208, device='cuda:0')
benign distance is  tensor(127.3208, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  11.997718513011932
distance x is tensor(127.9485, device='cuda:0')
benign distance is  tensor(127.9485, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.653801202774048
distance x is tensor(145.6237, device='cuda:0')
benign distance is  tensor(145.6237, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.028704702854156
distance x is tensor(169.8436, device='cuda:0')
benign distance is  tensor(169.8436, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 504.8479,  488.1002,  526.6520,  774.1391,  361.1774,  445.1813,
         313.7434,  413.3902,  577.6942,  720.4798,  538.2272,  584.2189,
         485.8299,  613.4957,  650.6179,  517.7466,  553.0942,  558.3353,
         611.4301,  764.6284,  456.4823,  519.8188,  552.6448,  582.9678,
         353.3513, 1036.0339,  791.1078,  520.6208], device='cuda:0')
sorted_norm is   tensor([ 313.7434,  353.3513,  361.1774,  413.3902,  445.1813,  456.4823,
         485.8299,  488.1002,  504.8479,  517.7466,  519.8188,  520.6208,
         526.6520,  538.2272,  552.6448,  553.0942,  558.3353,  577.6942,
         582.9678,  584.2189,  611.4301,  613.4957,  650.6179,  720.4798,
         764.6284,  774.1391,  791.1078, 1036.0339], device='cuda:0')
used idx is  tensor([ 6, 24,  4,  7,  5, 20, 12,  1,  0, 15, 21, 27,  2, 10, 22, 16, 17,  8,
        23, 11, 18, 13], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 84.73% 

Test Accuracy: 47.31% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6805703584104776
distance x is tensor(107.4018, device='cuda:0')
benign distance is  tensor(107.4018, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8282794579863548
distance x is tensor(104.4379, device='cuda:0')
benign distance is  tensor(104.4379, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8498532939702272
distance x is tensor(120.9930, device='cuda:0')
benign distance is  tensor(120.9930, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.25122444704175
distance x is tensor(168.5159, device='cuda:0')
benign distance is  tensor(168.5159, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9432137683033943
distance x is tensor(93.1273, device='cuda:0')
benign distance is  tensor(93.1273, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7353964159265161
distance x is tensor(112.9814, device='cuda:0')
benign distance is  tensor(112.9814, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2640750370919704
distance x is tensor(110.1484, device='cuda:0')
benign distance is  tensor(110.1484, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7167309019714594
distance x is tensor(94.5216, device='cuda:0')
benign distance is  tensor(94.5216, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1558577790856361
distance x is tensor(107.8524, device='cuda:0')
benign distance is  tensor(107.8524, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9245921969413757
distance x is tensor(127.1015, device='cuda:0')
benign distance is  tensor(127.1015, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9985449630767107
distance x is tensor(145.8295, device='cuda:0')
benign distance is  tensor(145.8295, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8264013174921274
distance x is tensor(139.6228, device='cuda:0')
benign distance is  tensor(139.6228, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0628877114504576
distance x is tensor(108.7713, device='cuda:0')
benign distance is  tensor(108.7713, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7671206146478653
distance x is tensor(227.8633, device='cuda:0')
benign distance is  tensor(227.8633, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.328357968479395
distance x is tensor(182.3323, device='cuda:0')
benign distance is  tensor(182.3323, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7779818521812558
distance x is tensor(131.9868, device='cuda:0')
benign distance is  tensor(131.9868, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  11.115544438362122
distance x is tensor(97.1828, device='cuda:0')
benign distance is  tensor(97.1828, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  9.013159900903702
distance x is tensor(152.9753, device='cuda:0')
benign distance is  tensor(152.9753, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.080048680305481
distance x is tensor(104.9217, device='cuda:0')
benign distance is  tensor(104.9217, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.688506603240967
distance x is tensor(104.9342, device='cuda:0')
benign distance is  tensor(104.9342, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.65302911400795
distance x is tensor(97.2249, device='cuda:0')
benign distance is  tensor(97.2249, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  8.617522716522217
distance x is tensor(109.8865, device='cuda:0')
benign distance is  tensor(109.8865, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.982134580612183
distance x is tensor(132.9427, device='cuda:0')
benign distance is  tensor(132.9427, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  10.50715583562851
distance x is tensor(100.5825, device='cuda:0')
benign distance is  tensor(100.5825, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.3053660094738
distance x is tensor(129.2861, device='cuda:0')
benign distance is  tensor(129.2861, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  11.777670919895172
distance x is tensor(105.1354, device='cuda:0')
benign distance is  tensor(105.1354, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.520510911941528
distance x is tensor(117.1694, device='cuda:0')
benign distance is  tensor(117.1694, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.016872584819794
distance x is tensor(170.5511, device='cuda:0')
benign distance is  tensor(170.5511, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([483.7747, 480.0598, 550.0773, 774.2965, 431.7290, 496.9566, 502.8882,
        425.0414, 439.6794, 695.9160, 473.0623, 468.1695, 441.5416, 509.9155,
        611.0297, 454.4519, 579.6872, 473.8327, 515.7518, 779.2160, 643.6279,
        544.4015, 757.1188, 669.5621, 628.9323, 567.1225, 533.7521, 632.8157,
        575.3290, 430.8858, 650.1187, 584.0623, 566.7593, 539.8218, 546.7181,
        832.1479, 524.2330, 569.7703, 360.1449, 591.2721, 862.4349, 318.5715,
        727.7168, 590.7506], device='cuda:0')
sorted_norm is   tensor([318.5715, 360.1449, 425.0414, 430.8858, 431.7290, 439.6794, 441.5416,
        454.4519, 468.1695, 473.0623, 473.8327, 480.0598, 483.7747, 496.9566,
        502.8882, 509.9155, 515.7518, 524.2330, 533.7521, 539.8218, 544.4015,
        546.7181, 550.0773, 566.7593, 567.1225, 569.7703, 575.3290, 579.6872,
        584.0623, 590.7506, 591.2721, 611.0297, 628.9323, 632.8157, 643.6279,
        650.1187, 669.5621, 695.9160, 727.7168, 757.1188, 774.2965, 779.2160,
        832.1479, 862.4349], device='cuda:0')
used idx is  tensor([41, 38,  7, 29,  4,  8, 12, 15, 11, 10, 17,  1,  0,  5,  6, 13, 18, 36,
        26, 33, 21, 34,  2, 32, 25, 37, 28, 16, 31, 43, 39, 14, 24, 27, 20],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 91.02% 

Test Accuracy: 87.98% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8416095562279224
distance x is tensor(104.1089, device='cuda:0')
benign distance is  tensor(104.1089, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8333254139870405
distance x is tensor(93.8525, device='cuda:0')
benign distance is  tensor(93.8525, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6277919299900532
distance x is tensor(101.7964, device='cuda:0')
benign distance is  tensor(101.7964, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.815734876319766
distance x is tensor(159.6739, device='cuda:0')
benign distance is  tensor(159.6739, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8261631084606051
distance x is tensor(89.4959, device='cuda:0')
benign distance is  tensor(89.4959, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.875660615041852
distance x is tensor(82.7029, device='cuda:0')
benign distance is  tensor(82.7029, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9966604560613632
distance x is tensor(89.3309, device='cuda:0')
benign distance is  tensor(89.3309, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.926566943526268
distance x is tensor(77.7616, device='cuda:0')
benign distance is  tensor(77.7616, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9644136633723974
distance x is tensor(109.4291, device='cuda:0')
benign distance is  tensor(109.4291, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7172898156568408
distance x is tensor(123.9887, device='cuda:0')
benign distance is  tensor(123.9887, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9872811250388622
distance x is tensor(64.5020, device='cuda:0')
benign distance is  tensor(64.5020, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0249321796000004
distance x is tensor(119.1980, device='cuda:0')
benign distance is  tensor(119.1980, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.862276703119278
distance x is tensor(191.4745, device='cuda:0')
benign distance is  tensor(191.4745, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7256439980119467
distance x is tensor(54.8131, device='cuda:0')
benign distance is  tensor(54.8131, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9177429489791393
distance x is tensor(148.9178, device='cuda:0')
benign distance is  tensor(148.9178, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2147036381065845
distance x is tensor(126.5013, device='cuda:0')
benign distance is  tensor(126.5013, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.0648417361080647
distance x is tensor(126.3645, device='cuda:0')
benign distance is  tensor(126.3645, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6377738695591688
distance x is tensor(84.5567, device='cuda:0')
benign distance is  tensor(84.5567, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.7867211420089006
distance x is tensor(135.8112, device='cuda:0')
benign distance is  tensor(135.8112, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.3374769855290651
distance x is tensor(124.8916, device='cuda:0')
benign distance is  tensor(124.8916, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7314172070473433
distance x is tensor(124.1433, device='cuda:0')
benign distance is  tensor(124.1433, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.909229002892971
distance x is tensor(107.4004, device='cuda:0')
benign distance is  tensor(107.4004, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5656364541500807
distance x is tensor(120.0840, device='cuda:0')
benign distance is  tensor(120.0840, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7762110028415918
distance x is tensor(189.1389, device='cuda:0')
benign distance is  tensor(189.1389, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7447106316685677
distance x is tensor(128.4612, device='cuda:0')
benign distance is  tensor(128.4612, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.9441567910835147
distance x is tensor(108.5924, device='cuda:0')
benign distance is  tensor(108.5924, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.8273267243057489
distance x is tensor(159.1692, device='cuda:0')
benign distance is  tensor(159.1692, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.7070249170064926
distance x is tensor(140.1978, device='cuda:0')
benign distance is  tensor(140.1978, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8891372121870518
distance x is tensor(117.7741, device='cuda:0')
benign distance is  tensor(117.7741, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.9287445675581694
distance x is tensor(102.4931, device='cuda:0')
benign distance is  tensor(102.4931, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7462240839377046
distance x is tensor(92.1873, device='cuda:0')
benign distance is  tensor(92.1873, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7603531908243895
distance x is tensor(132.0428, device='cuda:0')
benign distance is  tensor(132.0428, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.240115344524384
distance x is tensor(153.1305, device='cuda:0')
benign distance is  tensor(153.1305, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  9.693129479885101
distance x is tensor(179.4057, device='cuda:0')
benign distance is  tensor(179.4057, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  11.398025155067444
distance x is tensor(145.3785, device='cuda:0')
benign distance is  tensor(145.3785, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  12.486093580722809
distance x is tensor(154.6904, device='cuda:0')
benign distance is  tensor(154.6904, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.981259942054749
distance x is tensor(127.5400, device='cuda:0')
benign distance is  tensor(127.5400, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  5.913657993078232
distance x is tensor(154.6272, device='cuda:0')
benign distance is  tensor(154.6272, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  10.028975307941437
distance x is tensor(164.9933, device='cuda:0')
benign distance is  tensor(164.9933, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.98098549246788
distance x is tensor(137.4449, device='cuda:0')
benign distance is  tensor(137.4449, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  10.787474036216736
distance x is tensor(148.8121, device='cuda:0')
benign distance is  tensor(148.8121, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  12.79221510887146
distance x is tensor(146.2860, device='cuda:0')
benign distance is  tensor(146.2860, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  10.76115882396698
distance x is tensor(162.5842, device='cuda:0')
benign distance is  tensor(162.5842, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.250771284103394
distance x is tensor(190.6915, device='cuda:0')
benign distance is  tensor(190.6915, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([475.1374, 450.9105, 466.4942, 731.0560, 401.9565, 364.9330, 412.8601,
        349.8076, 624.2949, 777.3881, 620.9285, 649.9085, 564.5430, 658.6934,
        699.4681, 583.9217, 629.1669, 601.8159, 688.6981, 810.2476],
       device='cuda:0')
sorted_norm is   tensor([349.8076, 364.9330, 401.9565, 412.8601, 450.9105, 466.4942, 475.1374,
        564.5430, 583.9217, 601.8159, 620.9285, 624.2949, 629.1669, 649.9085,
        658.6934, 688.6981, 699.4681, 731.0560, 777.3881, 810.2476],
       device='cuda:0')
used idx is  tensor([ 7,  5,  4,  6,  1,  2,  0, 12, 15, 17, 10,  8, 16, 11, 13, 18],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 60.38% 

Test Accuracy: 17.16% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7981223706156015
distance x is tensor(145.3690, device='cuda:0')
benign distance is  tensor(145.3690, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9215407092124224
distance x is tensor(138.4323, device='cuda:0')
benign distance is  tensor(138.4323, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7303033247590065
distance x is tensor(144.5956, device='cuda:0')
benign distance is  tensor(144.5956, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.032550748437643
distance x is tensor(190.2770, device='cuda:0')
benign distance is  tensor(190.2770, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1231488343328238
distance x is tensor(139.4444, device='cuda:0')
benign distance is  tensor(139.4444, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8122724452987313
distance x is tensor(140.8812, device='cuda:0')
benign distance is  tensor(140.8812, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.494443278759718
distance x is tensor(141.5999, device='cuda:0')
benign distance is  tensor(141.5999, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8304378986358643
distance x is tensor(131.7809, device='cuda:0')
benign distance is  tensor(131.7809, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  12.14868050813675
distance x is tensor(82.4084, device='cuda:0')
benign distance is  tensor(82.4084, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  7.25131019949913
distance x is tensor(140.7716, device='cuda:0')
benign distance is  tensor(140.7716, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.992015033960342
distance x is tensor(99.3322, device='cuda:0')
benign distance is  tensor(99.3322, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  9.16888764500618
distance x is tensor(87.4274, device='cuda:0')
benign distance is  tensor(87.4274, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  10.022350430488586
distance x is tensor(94.2864, device='cuda:0')
benign distance is  tensor(94.2864, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.870058506727219
distance x is tensor(106.8730, device='cuda:0')
benign distance is  tensor(106.8730, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.764004468917847
distance x is tensor(124.9801, device='cuda:0')
benign distance is  tensor(124.9801, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.72473692893982
distance x is tensor(86.6806, device='cuda:0')
benign distance is  tensor(86.6806, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  10.132161974906921
distance x is tensor(105.9661, device='cuda:0')
benign distance is  tensor(105.9661, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  11.006707429885864
distance x is tensor(93.6881, device='cuda:0')
benign distance is  tensor(93.6881, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  8.878473430871964
distance x is tensor(110.9073, device='cuda:0')
benign distance is  tensor(110.9073, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.475014865398407
distance x is tensor(150.2168, device='cuda:0')
benign distance is  tensor(150.2168, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 634.9692,  617.1858,  648.3384,  817.2738,  595.6617,  596.7512,
         600.4789,  564.0030,  389.3098,  656.5297,  461.0312,  407.2484,
         444.0014,  500.5201,  573.6791,  408.2450,  488.5031,  429.5799,
         483.1723,  678.5262,  558.6589,  746.0643,  750.3467,  492.1428,
         829.5742,  711.8424,  523.2141,  642.8464,  546.8495,  621.7411,
         668.5492,  684.3816,  542.1722, 1038.4164,  849.2816,  641.6859,
         528.5558,  595.2769,  373.2050,  587.2755,  915.4235,  324.6399,
         705.2747,  620.3935], device='cuda:0')
sorted_norm is   tensor([ 324.6399,  373.2050,  389.3098,  407.2484,  408.2450,  429.5799,
         444.0014,  461.0312,  483.1723,  488.5031,  492.1428,  500.5201,
         523.2141,  528.5558,  542.1722,  546.8495,  558.6589,  564.0030,
         573.6791,  587.2755,  595.2769,  595.6617,  596.7512,  600.4789,
         617.1858,  620.3935,  621.7411,  634.9692,  641.6859,  642.8464,
         648.3384,  656.5297,  668.5492,  678.5262,  684.3816,  705.2747,
         711.8424,  746.0643,  750.3467,  817.2738,  829.5742,  849.2816,
         915.4235, 1038.4164], device='cuda:0')
used idx is  tensor([41, 38,  8, 11, 15, 17, 12, 10, 18, 16, 23, 13, 26, 36, 32, 28, 20,  7,
        14, 39, 37,  4,  5,  6,  1, 43, 29,  0, 35, 27,  2,  9, 30, 19, 31],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 90.39% 

Test Accuracy: 87.59% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8391570579260588
distance x is tensor(101.2372, device='cuda:0')
benign distance is  tensor(101.2372, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8161225225776434
distance x is tensor(98.9501, device='cuda:0')
benign distance is  tensor(98.9501, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7316736560314894
distance x is tensor(105.4960, device='cuda:0')
benign distance is  tensor(105.4960, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0620993580669165
distance x is tensor(161.4690, device='cuda:0')
benign distance is  tensor(161.4690, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9236947959288955
distance x is tensor(80.9734, device='cuda:0')
benign distance is  tensor(80.9734, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.716308762319386
distance x is tensor(88.2344, device='cuda:0')
benign distance is  tensor(88.2344, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1900791432708502
distance x is tensor(84.1989, device='cuda:0')
benign distance is  tensor(84.1989, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.740017032250762
distance x is tensor(72.5743, device='cuda:0')
benign distance is  tensor(72.5743, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0667084082961082
distance x is tensor(102.9742, device='cuda:0')
benign distance is  tensor(102.9742, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7590060913935304
distance x is tensor(134.1523, device='cuda:0')
benign distance is  tensor(134.1523, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1106531023979187
distance x is tensor(68.7178, device='cuda:0')
benign distance is  tensor(68.7178, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4353813976049423
distance x is tensor(104.1468, device='cuda:0')
benign distance is  tensor(104.1468, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.4032418094575405
distance x is tensor(176.2693, device='cuda:0')
benign distance is  tensor(176.2693, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.689022739417851
distance x is tensor(58.0648, device='cuda:0')
benign distance is  tensor(58.0648, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0075306855142117
distance x is tensor(143.6921, device='cuda:0')
benign distance is  tensor(143.6921, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2598810233175755
distance x is tensor(120.6268, device='cuda:0')
benign distance is  tensor(120.6268, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.0916713066399097
distance x is tensor(98.0857, device='cuda:0')
benign distance is  tensor(98.0857, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8843323048204184
distance x is tensor(109.9635, device='cuda:0')
benign distance is  tensor(109.9635, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.973776251077652
distance x is tensor(139.5093, device='cuda:0')
benign distance is  tensor(139.5093, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7887732926756144
distance x is tensor(121.6304, device='cuda:0')
benign distance is  tensor(121.6304, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.1223375629633665
distance x is tensor(94.8884, device='cuda:0')
benign distance is  tensor(94.8884, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.638186601921916
distance x is tensor(229.2162, device='cuda:0')
benign distance is  tensor(229.2162, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.2367142662405968
distance x is tensor(162.6584, device='cuda:0')
benign distance is  tensor(162.6584, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5988532220944762
distance x is tensor(106.8686, device='cuda:0')
benign distance is  tensor(106.8686, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.2997257262468338
distance x is tensor(120.2129, device='cuda:0')
benign distance is  tensor(120.2129, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.249538030475378
distance x is tensor(145.9068, device='cuda:0')
benign distance is  tensor(145.9068, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.4917778708040714
distance x is tensor(167.7877, device='cuda:0')
benign distance is  tensor(167.7877, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.1769109666347504
distance x is tensor(96.2574, device='cuda:0')
benign distance is  tensor(96.2574, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.8669925089925528
distance x is tensor(175.6068, device='cuda:0')
benign distance is  tensor(175.6068, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.9138907492160797
distance x is tensor(144.5454, device='cuda:0')
benign distance is  tensor(144.5454, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8601398654282093
distance x is tensor(99.5442, device='cuda:0')
benign distance is  tensor(99.5442, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6322991861961782
distance x is tensor(118.7761, device='cuda:0')
benign distance is  tensor(118.7761, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  10.783529281616211
distance x is tensor(141.1722, device='cuda:0')
benign distance is  tensor(141.1722, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  9.030526608228683
distance x is tensor(163.0654, device='cuda:0')
benign distance is  tensor(163.0654, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  13.789544105529785
distance x is tensor(138.7639, device='cuda:0')
benign distance is  tensor(138.7639, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  12.947119951248169
distance x is tensor(157.7669, device='cuda:0')
benign distance is  tensor(157.7669, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  10.760823428630829
distance x is tensor(128.6681, device='cuda:0')
benign distance is  tensor(128.6681, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  9.408576726913452
distance x is tensor(146.0647, device='cuda:0')
benign distance is  tensor(146.0647, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.349391549825668
distance x is tensor(155.8433, device='cuda:0')
benign distance is  tensor(155.8433, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  11.592360973358154
distance x is tensor(131.7497, device='cuda:0')
benign distance is  tensor(131.7497, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.855585277080536
distance x is tensor(146.6451, device='cuda:0')
benign distance is  tensor(146.6451, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  11.915625214576721
distance x is tensor(133.2048, device='cuda:0')
benign distance is  tensor(133.2048, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.55122709274292
distance x is tensor(144.6299, device='cuda:0')
benign distance is  tensor(144.6299, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.411035180091858
distance x is tensor(194.3646, device='cuda:0')
benign distance is  tensor(194.3646, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([458.2161, 464.4007, 483.0822, 735.1902, 369.2078, 385.4730, 389.0750,
        316.2674, 596.9314, 725.7816, 603.3738, 675.2133, 569.0972, 642.2377,
        673.3963, 595.4778, 627.0444, 572.5291, 603.7497, 841.2783],
       device='cuda:0')
sorted_norm is   tensor([316.2674, 369.2078, 385.4730, 389.0750, 458.2161, 464.4007, 483.0822,
        569.0972, 572.5291, 595.4778, 596.9314, 603.3738, 603.7497, 627.0444,
        642.2377, 673.3963, 675.2133, 725.7816, 735.1902, 841.2783],
       device='cuda:0')
used idx is  tensor([ 7,  4,  5,  6,  0,  1,  2, 12, 17, 15,  8, 10, 18, 16, 13, 14],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 61.80% 

Test Accuracy: 17.98% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9510001372545958
distance x is tensor(132.9329, device='cuda:0')
benign distance is  tensor(132.9329, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7155411969870329
distance x is tensor(132.3193, device='cuda:0')
benign distance is  tensor(132.3193, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8056015372276306
distance x is tensor(125.8888, device='cuda:0')
benign distance is  tensor(125.8888, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9924801308661699
distance x is tensor(186.7640, device='cuda:0')
benign distance is  tensor(186.7640, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0711916824802756
distance x is tensor(132.7606, device='cuda:0')
benign distance is  tensor(132.7606, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6967427525669336
distance x is tensor(132.0855, device='cuda:0')
benign distance is  tensor(132.0855, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.454792644828558
distance x is tensor(130.3480, device='cuda:0')
benign distance is  tensor(130.3480, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.72318977676332
distance x is tensor(133.4086, device='cuda:0')
benign distance is  tensor(133.4086, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  9.460765182971954
distance x is tensor(80.6412, device='cuda:0')
benign distance is  tensor(80.6412, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.175842970609665
distance x is tensor(141.3102, device='cuda:0')
benign distance is  tensor(141.3102, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.444980382919312
distance x is tensor(88.2491, device='cuda:0')
benign distance is  tensor(88.2491, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  12.381769120693207
distance x is tensor(90.6939, device='cuda:0')
benign distance is  tensor(90.6939, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.835557758808136
distance x is tensor(83.4474, device='cuda:0')
benign distance is  tensor(83.4474, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.625150740146637
distance x is tensor(110.5903, device='cuda:0')
benign distance is  tensor(110.5903, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  10.47365552186966
distance x is tensor(124.8875, device='cuda:0')
benign distance is  tensor(124.8875, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  9.44715005159378
distance x is tensor(85.7167, device='cuda:0')
benign distance is  tensor(85.7167, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  10.19324404001236
distance x is tensor(95.1287, device='cuda:0')
benign distance is  tensor(95.1287, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.359989285469055
distance x is tensor(89.7054, device='cuda:0')
benign distance is  tensor(89.7054, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.742440283298492
distance x is tensor(109.6454, device='cuda:0')
benign distance is  tensor(109.6454, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  9.393106520175934
distance x is tensor(168.4978, device='cuda:0')
benign distance is  tensor(168.4978, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([573.2764, 580.7957, 569.2874, 819.1570, 590.1249, 572.7501, 578.6232,
        588.1855, 377.1068, 651.4281, 399.1458, 423.3305, 385.5480, 515.3491,
        565.7991, 392.6749, 450.4621, 408.1292, 480.6185, 758.1507, 613.2891,
        455.6512, 669.3727, 611.2120, 617.9785, 551.5671, 586.2289, 874.7609,
        513.3779, 642.7666, 376.4225, 525.9377, 830.1761, 325.4532, 679.3293,
        587.1566], device='cuda:0')
sorted_norm is   tensor([325.4532, 376.4225, 377.1068, 385.5480, 392.6749, 399.1458, 408.1292,
        423.3305, 450.4621, 455.6512, 480.6185, 513.3779, 515.3491, 525.9377,
        551.5671, 565.7991, 569.2874, 572.7501, 573.2764, 578.6232, 580.7957,
        586.2289, 587.1566, 588.1855, 590.1249, 611.2120, 613.2891, 617.9785,
        642.7666, 651.4281, 669.3727, 679.3293, 758.1507, 819.1570, 830.1761,
        874.7609], device='cuda:0')
used idx is  tensor([33, 30,  8, 12, 15, 10, 17, 11, 16, 21, 18, 28, 13, 31, 25, 14,  2,  5,
         0,  6,  1, 26, 35,  7,  4, 23, 20, 24], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 90.17% 

Test Accuracy: 87.52% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6843660566955805
distance x is tensor(109.8304, device='cuda:0')
benign distance is  tensor(109.8304, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8516126163303852
distance x is tensor(85.6683, device='cuda:0')
benign distance is  tensor(85.6683, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7606029212474823
distance x is tensor(108.0032, device='cuda:0')
benign distance is  tensor(108.0032, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1457750983536243
distance x is tensor(166.9837, device='cuda:0')
benign distance is  tensor(166.9837, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9674458038061857
distance x is tensor(72.3463, device='cuda:0')
benign distance is  tensor(72.3463, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7296539638191462
distance x is tensor(89.6106, device='cuda:0')
benign distance is  tensor(89.6106, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1535195223987103
distance x is tensor(77.5273, device='cuda:0')
benign distance is  tensor(77.5273, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6872851410880685
distance x is tensor(78.9974, device='cuda:0')
benign distance is  tensor(78.9974, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.249874098226428
distance x is tensor(115.2606, device='cuda:0')
benign distance is  tensor(115.2606, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.703132779803127
distance x is tensor(126.9402, device='cuda:0')
benign distance is  tensor(126.9402, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2554970942437649
distance x is tensor(82.0559, device='cuda:0')
benign distance is  tensor(82.0559, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.188245166093111
distance x is tensor(121.1248, device='cuda:0')
benign distance is  tensor(121.1248, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.02503053098917
distance x is tensor(186.6174, device='cuda:0')
benign distance is  tensor(186.6174, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6724296901375055
distance x is tensor(57.9307, device='cuda:0')
benign distance is  tensor(57.9307, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0714396573603153
distance x is tensor(151.1234, device='cuda:0')
benign distance is  tensor(151.1234, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.5452198758721352
distance x is tensor(132.6710, device='cuda:0')
benign distance is  tensor(132.6710, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.4218114521354437
distance x is tensor(123.3708, device='cuda:0')
benign distance is  tensor(123.3708, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7205258095636964
distance x is tensor(85.5490, device='cuda:0')
benign distance is  tensor(85.5490, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9670582823455334
distance x is tensor(140.4853, device='cuda:0')
benign distance is  tensor(140.4853, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.3586823418736458
distance x is tensor(112.0686, device='cuda:0')
benign distance is  tensor(112.0686, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.918481620028615
distance x is tensor(121.2661, device='cuda:0')
benign distance is  tensor(121.2661, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.0561171919107437
distance x is tensor(107.8057, device='cuda:0')
benign distance is  tensor(107.8057, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.540344319306314
distance x is tensor(129.2526, device='cuda:0')
benign distance is  tensor(129.2526, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.8781913965940475
distance x is tensor(185.9294, device='cuda:0')
benign distance is  tensor(185.9294, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  10.960505783557892
distance x is tensor(131.2163, device='cuda:0')
benign distance is  tensor(131.2163, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.259613037109375
distance x is tensor(171.9925, device='cuda:0')
benign distance is  tensor(171.9925, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.91784018278122
distance x is tensor(142.2245, device='cuda:0')
benign distance is  tensor(142.2245, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.60374367237091
distance x is tensor(147.3846, device='cuda:0')
benign distance is  tensor(147.3846, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.668618559837341
distance x is tensor(129.3782, device='cuda:0')
benign distance is  tensor(129.3782, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  8.126016706228256
distance x is tensor(140.7687, device='cuda:0')
benign distance is  tensor(140.7687, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  12.490982055664062
distance x is tensor(160.5722, device='cuda:0')
benign distance is  tensor(160.5722, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  11.444324254989624
distance x is tensor(121.4675, device='cuda:0')
benign distance is  tensor(121.4675, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.764902412891388
distance x is tensor(152.9521, device='cuda:0')
benign distance is  tensor(152.9521, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  11.777724742889404
distance x is tensor(129.7242, device='cuda:0')
benign distance is  tensor(129.7242, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  10.226278007030487
distance x is tensor(138.8463, device='cuda:0')
benign distance is  tensor(138.8463, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.196659088134766
distance x is tensor(184.8995, device='cuda:0')
benign distance is  tensor(184.8995, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 490.2521,  405.0323,  499.0473,  760.9297,  322.7761,  399.9315,
         356.2295,  351.8265,  558.3110,  749.4547,  598.7430,  617.1321,
         558.9650,  623.6998,  693.3111,  529.2327,  644.6964,  552.6502,
         586.6782,  794.3370,  600.1879,  524.2502,  740.1746,  658.5490,
         550.7554,  497.4569,  447.4216,  622.0301,  486.5882,  513.1107,
         627.6963,  580.4576,  419.9888, 1029.9807,  745.2701,  505.2209],
       device='cuda:0')
sorted_norm is   tensor([ 322.7761,  351.8265,  356.2295,  399.9315,  405.0323,  419.9888,
         447.4216,  486.5882,  490.2521,  497.4569,  499.0473,  505.2209,
         513.1107,  524.2502,  529.2327,  550.7554,  552.6502,  558.3110,
         558.9650,  580.4576,  586.6782,  598.7430,  600.1879,  617.1321,
         622.0301,  623.6998,  627.6963,  644.6964,  658.5490,  693.3111,
         740.1746,  745.2701,  749.4547,  760.9297,  794.3370, 1029.9807],
       device='cuda:0')
used idx is  tensor([ 4,  7,  6,  5,  1, 32, 26, 28,  0, 25,  2, 35, 29, 21, 15, 24, 17,  8,
        12, 31, 18, 10, 20, 11, 27, 13, 30, 16], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 89.40% 

Test Accuracy: 64.56% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7619754504412413
distance x is tensor(116.9147, device='cuda:0')
benign distance is  tensor(116.9147, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8923276104032993
distance x is tensor(112.5816, device='cuda:0')
benign distance is  tensor(112.5816, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8036224544048309
distance x is tensor(119.5291, device='cuda:0')
benign distance is  tensor(119.5291, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1399910598993301
distance x is tensor(171.1275, device='cuda:0')
benign distance is  tensor(171.1275, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0023030582815409
distance x is tensor(83.0188, device='cuda:0')
benign distance is  tensor(83.0188, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6847473448142409
distance x is tensor(101.0280, device='cuda:0')
benign distance is  tensor(101.0280, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4587925001978874
distance x is tensor(96.3631, device='cuda:0')
benign distance is  tensor(96.3631, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7069974541664124
distance x is tensor(102.0878, device='cuda:0')
benign distance is  tensor(102.0878, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1080708727240562
distance x is tensor(103.5119, device='cuda:0')
benign distance is  tensor(103.5119, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7429043930023909
distance x is tensor(123.7005, device='cuda:0')
benign distance is  tensor(123.7005, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.0389331635087729
distance x is tensor(129.8020, device='cuda:0')
benign distance is  tensor(129.8020, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8905045576393604
distance x is tensor(133.3459, device='cuda:0')
benign distance is  tensor(133.3459, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0280373580753803
distance x is tensor(94.3389, device='cuda:0')
benign distance is  tensor(94.3389, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7642828822135925
distance x is tensor(238.7816, device='cuda:0')
benign distance is  tensor(238.7816, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0031421221792698
distance x is tensor(155.7014, device='cuda:0')
benign distance is  tensor(155.7014, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8781428206712008
distance x is tensor(124.4800, device='cuda:0')
benign distance is  tensor(124.4800, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7387800700962543
distance x is tensor(134.3781, device='cuda:0')
benign distance is  tensor(134.3781, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.1498502865433693
distance x is tensor(127.6092, device='cuda:0')
benign distance is  tensor(127.6092, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6780974809080362
distance x is tensor(174.7489, device='cuda:0')
benign distance is  tensor(174.7489, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.303626425564289
distance x is tensor(147.1547, device='cuda:0')
benign distance is  tensor(147.1547, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7354963682591915
distance x is tensor(142.7044, device='cuda:0')
benign distance is  tensor(142.7044, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.887280935421586
distance x is tensor(101.2935, device='cuda:0')
benign distance is  tensor(101.2935, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7228429820388556
distance x is tensor(112.6865, device='cuda:0')
benign distance is  tensor(112.6865, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8187385872006416
distance x is tensor(131.6383, device='cuda:0')
benign distance is  tensor(131.6383, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  10.856754183769226
distance x is tensor(111.1725, device='cuda:0')
benign distance is  tensor(111.1725, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  9.476812362670898
distance x is tensor(154.8139, device='cuda:0')
benign distance is  tensor(154.8139, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  10.68108856678009
distance x is tensor(98.0469, device='cuda:0')
benign distance is  tensor(98.0469, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.16344028711319
distance x is tensor(100.1725, device='cuda:0')
benign distance is  tensor(100.1725, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.271284818649292
distance x is tensor(104.0264, device='cuda:0')
benign distance is  tensor(104.0264, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.001748502254486
distance x is tensor(125.6610, device='cuda:0')
benign distance is  tensor(125.6610, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  8.827562183141708
distance x is tensor(135.5580, device='cuda:0')
benign distance is  tensor(135.5580, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  10.363441109657288
distance x is tensor(98.2076, device='cuda:0')
benign distance is  tensor(98.2076, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.0550597012043
distance x is tensor(125.0875, device='cuda:0')
benign distance is  tensor(125.0875, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  12.801832258701324
distance x is tensor(107.7151, device='cuda:0')
benign distance is  tensor(107.7151, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.56607300043106
distance x is tensor(109.7368, device='cuda:0')
benign distance is  tensor(109.7368, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.602124512195587
distance x is tensor(170.9330, device='cuda:0')
benign distance is  tensor(170.9330, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([530.3926, 519.4847, 536.2095, 771.0265, 373.4245, 439.8747, 436.0290,
        459.9441, 486.8120, 704.3098, 436.6770, 457.8405, 463.5976, 565.1232,
        606.4691, 440.1890, 554.4404, 475.9861, 485.2460, 760.8451, 531.5659,
        587.6239, 395.3844, 574.3646, 841.9161, 284.2904, 702.2036, 618.9750],
       device='cuda:0')
sorted_norm is   tensor([284.2904, 373.4245, 395.3844, 436.0290, 436.6770, 439.8747, 440.1890,
        457.8405, 459.9441, 463.5976, 475.9861, 485.2460, 486.8120, 519.4847,
        530.3926, 531.5659, 536.2095, 554.4404, 565.1232, 574.3646, 587.6239,
        606.4691, 618.9750, 702.2036, 704.3098, 760.8451, 771.0265, 841.9161],
       device='cuda:0')
used idx is  tensor([25,  4, 22,  6, 10,  5, 15, 11,  7, 12, 17, 18,  8,  1,  0, 20,  2, 16,
        13, 23, 21, 14], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 84.61% 

Test Accuracy: 54.37% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.824190529063344
distance x is tensor(135.7149, device='cuda:0')
benign distance is  tensor(135.7149, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.842091653496027
distance x is tensor(113.3340, device='cuda:0')
benign distance is  tensor(113.3340, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.804097518324852
distance x is tensor(116.5654, device='cuda:0')
benign distance is  tensor(116.5654, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0427843183279037
distance x is tensor(186.6930, device='cuda:0')
benign distance is  tensor(186.6930, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9113636473193765
distance x is tensor(128.0390, device='cuda:0')
benign distance is  tensor(128.0390, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7536419937387109
distance x is tensor(111.0817, device='cuda:0')
benign distance is  tensor(111.0817, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4415844809263945
distance x is tensor(99.8682, device='cuda:0')
benign distance is  tensor(99.8682, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8247514609247446
distance x is tensor(92.3135, device='cuda:0')
benign distance is  tensor(92.3135, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9925741963088512
distance x is tensor(116.2322, device='cuda:0')
benign distance is  tensor(116.2322, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7274929452687502
distance x is tensor(131.6792, device='cuda:0')
benign distance is  tensor(131.6792, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1312024518847466
distance x is tensor(95.3769, device='cuda:0')
benign distance is  tensor(95.3769, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.7271045818924904
distance x is tensor(135.2838, device='cuda:0')
benign distance is  tensor(135.2838, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1140459850430489
distance x is tensor(239.0413, device='cuda:0')
benign distance is  tensor(239.0413, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7092008646577597
distance x is tensor(87.0609, device='cuda:0')
benign distance is  tensor(87.0609, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9698888063430786
distance x is tensor(163.3827, device='cuda:0')
benign distance is  tensor(163.3827, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3893896974623203
distance x is tensor(146.3806, device='cuda:0')
benign distance is  tensor(146.3806, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  10.110324144363403
distance x is tensor(106.2093, device='cuda:0')
benign distance is  tensor(106.2093, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  9.897524178028107
distance x is tensor(157.9485, device='cuda:0')
benign distance is  tensor(157.9485, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  12.219746470451355
distance x is tensor(104.9861, device='cuda:0')
benign distance is  tensor(104.9861, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  12.166646718978882
distance x is tensor(99.6964, device='cuda:0')
benign distance is  tensor(99.6964, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.505090445280075
distance x is tensor(109.5219, device='cuda:0')
benign distance is  tensor(109.5219, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  7.364033639431
distance x is tensor(129.4594, device='cuda:0')
benign distance is  tensor(129.4594, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  10.092994451522827
distance x is tensor(130.2036, device='cuda:0')
benign distance is  tensor(130.2036, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  9.050751686096191
distance x is tensor(103.1600, device='cuda:0')
benign distance is  tensor(103.1600, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  10.024037063121796
distance x is tensor(111.3290, device='cuda:0')
benign distance is  tensor(111.3290, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  11.504134058952332
distance x is tensor(102.7944, device='cuda:0')
benign distance is  tensor(102.7944, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.516004920005798
distance x is tensor(116.9524, device='cuda:0')
benign distance is  tensor(116.9524, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  8.684281885623932
distance x is tensor(177.8437, device='cuda:0')
benign distance is  tensor(177.8437, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([612.9009, 519.7014, 531.6892, 839.9994, 570.5955, 495.8651, 436.9597,
        406.5738, 474.0039, 723.9619, 455.0516, 451.6490, 511.8220, 599.4945,
        588.3997, 461.8592, 496.6460, 466.1973, 514.1224, 780.6143],
       device='cuda:0')
sorted_norm is   tensor([406.5738, 436.9597, 451.6490, 455.0516, 461.8592, 466.1973, 474.0039,
        495.8651, 496.6460, 511.8220, 514.1224, 519.7014, 531.6892, 570.5955,
        588.3997, 599.4945, 612.9009, 723.9619, 780.6143, 839.9994],
       device='cuda:0')
used idx is  tensor([ 7,  6, 11, 10, 15, 17,  8,  5, 16, 12, 18,  1,  2,  4, 14, 13],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 69.18% 

Test Accuracy: 23.93% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.967608667910099
distance x is tensor(157.8162, device='cuda:0')
benign distance is  tensor(157.8162, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9174303077161312
distance x is tensor(127.2656, device='cuda:0')
benign distance is  tensor(127.2656, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8682068902999163
distance x is tensor(136.1785, device='cuda:0')
benign distance is  tensor(136.1785, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0222492553293705
distance x is tensor(187.1639, device='cuda:0')
benign distance is  tensor(187.1639, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.334942027926445
distance x is tensor(139.6285, device='cuda:0')
benign distance is  tensor(139.6285, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9197550844401121
distance x is tensor(117.0902, device='cuda:0')
benign distance is  tensor(117.0902, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3443089704960585
distance x is tensor(119.6241, device='cuda:0')
benign distance is  tensor(119.6241, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0858745947480202
distance x is tensor(113.5766, device='cuda:0')
benign distance is  tensor(113.5766, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  10.051409035921097
distance x is tensor(88.5193, device='cuda:0')
benign distance is  tensor(88.5193, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.65859568119049
distance x is tensor(166.2676, device='cuda:0')
benign distance is  tensor(166.2676, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  9.179180085659027
distance x is tensor(88.9611, device='cuda:0')
benign distance is  tensor(88.9611, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  11.652612209320068
distance x is tensor(87.4014, device='cuda:0')
benign distance is  tensor(87.4014, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  10.112717926502228
distance x is tensor(88.9053, device='cuda:0')
benign distance is  tensor(88.9053, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  9.34816700220108
distance x is tensor(102.7271, device='cuda:0')
benign distance is  tensor(102.7271, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.867764413356781
distance x is tensor(119.3373, device='cuda:0')
benign distance is  tensor(119.3373, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  9.506352365016937
distance x is tensor(91.5359, device='cuda:0')
benign distance is  tensor(91.5359, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.938745617866516
distance x is tensor(123.1015, device='cuda:0')
benign distance is  tensor(123.1015, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.732072293758392
distance x is tensor(100.9214, device='cuda:0')
benign distance is  tensor(100.9214, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  11.083562791347504
distance x is tensor(104.3030, device='cuda:0')
benign distance is  tensor(104.3030, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.736621618270874
distance x is tensor(171.5651, device='cuda:0')
benign distance is  tensor(171.5651, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 706.6363,  572.9075,  610.7219,  841.8557,  625.9077,  516.8561,
         537.0823,  506.6877,  403.5850,  763.2676,  395.8235,  401.4094,
         402.5639,  468.8945,  542.7914,  421.7762,  568.1581,  471.8792,
         465.4130,  776.3887,  597.6301,  707.1673,  777.2053,  491.4486,
         840.0342,  696.7567,  502.6472,  576.0707,  590.0574,  440.4129,
         664.0101,  563.2465,  589.6979,  548.3870,  615.5396,  857.9971,
         504.4834,  598.0721,  606.2759,  631.3963,  454.7556, 1086.4840,
         738.4007,  604.1906,  532.4097,  614.9169,  454.9308,  637.4156,
        1072.1240,  412.2301,  747.5677,  659.4513], device='cuda:0')
sorted_norm is   tensor([ 395.8235,  401.4094,  402.5639,  403.5850,  412.2301,  421.7762,
         440.4129,  454.7556,  454.9308,  465.4130,  468.8945,  471.8792,
         491.4486,  502.6472,  504.4834,  506.6877,  516.8561,  532.4097,
         537.0823,  542.7914,  548.3870,  563.2465,  568.1581,  572.9075,
         576.0707,  589.6979,  590.0574,  597.6301,  598.0721,  604.1906,
         606.2759,  610.7219,  614.9169,  615.5396,  625.9077,  631.3963,
         637.4156,  659.4513,  664.0101,  696.7567,  706.6363,  707.1673,
         738.4007,  747.5677,  763.2676,  776.3887,  777.2053,  840.0342,
         841.8557,  857.9971, 1072.1240, 1086.4840], device='cuda:0')
used idx is  tensor([10, 11, 12,  8, 49, 15, 29, 40, 46, 18, 13, 17, 23, 26, 36,  7,  5, 44,
         6, 14, 33, 31, 16,  1, 27, 32, 28, 20, 37, 43, 38,  2, 45, 34,  4, 39,
        47, 51, 30, 25,  0], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 88.88% 

Test Accuracy: 87.88% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8215115685015917
distance x is tensor(96.3598, device='cuda:0')
benign distance is  tensor(96.3598, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8462786935269833
distance x is tensor(85.1782, device='cuda:0')
benign distance is  tensor(85.1782, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6738312598317862
distance x is tensor(110.7261, device='cuda:0')
benign distance is  tensor(110.7261, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0939608737826347
distance x is tensor(171.2365, device='cuda:0')
benign distance is  tensor(171.2365, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.818117830902338
distance x is tensor(64.9125, device='cuda:0')
benign distance is  tensor(64.9125, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6835520509630442
distance x is tensor(95.9421, device='cuda:0')
benign distance is  tensor(95.9421, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2054940331727266
distance x is tensor(77.6465, device='cuda:0')
benign distance is  tensor(77.6465, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7607632745057344
distance x is tensor(86.7007, device='cuda:0')
benign distance is  tensor(86.7007, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0068707093596458
distance x is tensor(98.3789, device='cuda:0')
benign distance is  tensor(98.3789, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.711299718124792
distance x is tensor(130.3893, device='cuda:0')
benign distance is  tensor(130.3893, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.125491589307785
distance x is tensor(75.7814, device='cuda:0')
benign distance is  tensor(75.7814, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.233460444957018
distance x is tensor(104.0718, device='cuda:0')
benign distance is  tensor(104.0718, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9056902742013335
distance x is tensor(183.2727, device='cuda:0')
benign distance is  tensor(183.2727, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7336298758164048
distance x is tensor(51.3337, device='cuda:0')
benign distance is  tensor(51.3337, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.2633365895599127
distance x is tensor(153.9318, device='cuda:0')
benign distance is  tensor(153.9318, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.9530697092413902
distance x is tensor(124.9436, device='cuda:0')
benign distance is  tensor(124.9436, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1251697018742561
distance x is tensor(94.3846, device='cuda:0')
benign distance is  tensor(94.3846, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6773535208776593
distance x is tensor(116.3882, device='cuda:0')
benign distance is  tensor(116.3882, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.0477911569178104
distance x is tensor(127.5456, device='cuda:0')
benign distance is  tensor(127.5456, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.870079267770052
distance x is tensor(124.7876, device='cuda:0')
benign distance is  tensor(124.7876, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0334173366427422
distance x is tensor(73.3211, device='cuda:0')
benign distance is  tensor(73.3211, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6173784704878926
distance x is tensor(218.0150, device='cuda:0')
benign distance is  tensor(218.0150, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.9847555495798588
distance x is tensor(172.8588, device='cuda:0')
benign distance is  tensor(172.8588, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7377889500930905
distance x is tensor(109.8268, device='cuda:0')
benign distance is  tensor(109.8268, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.1571521926671267
distance x is tensor(128.6995, device='cuda:0')
benign distance is  tensor(128.6995, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6823446992784739
distance x is tensor(128.5785, device='cuda:0')
benign distance is  tensor(128.5785, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9086784943938255
distance x is tensor(142.8540, device='cuda:0')
benign distance is  tensor(142.8540, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.1600420102477074
distance x is tensor(114.7348, device='cuda:0')
benign distance is  tensor(114.7348, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.0243503917008638
distance x is tensor(127.0726, device='cuda:0')
benign distance is  tensor(127.0726, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7745726201683283
distance x is tensor(138.3592, device='cuda:0')
benign distance is  tensor(138.3592, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5653616720810533
distance x is tensor(119.2969, device='cuda:0')
benign distance is  tensor(119.2969, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.9268370568752289
distance x is tensor(200.2825, device='cuda:0')
benign distance is  tensor(200.2825, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.3065526075661182
distance x is tensor(113.0937, device='cuda:0')
benign distance is  tensor(113.0937, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.3751403130590916
distance x is tensor(145.3468, device='cuda:0')
benign distance is  tensor(145.3468, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.2147958409041166
distance x is tensor(162.5809, device='cuda:0')
benign distance is  tensor(162.5809, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.099061880260706
distance x is tensor(102.0470, device='cuda:0')
benign distance is  tensor(102.0470, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6817334536463022
distance x is tensor(171.8359, device='cuda:0')
benign distance is  tensor(171.8359, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.9964338093996048
distance x is tensor(157.0110, device='cuda:0')
benign distance is  tensor(157.0110, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8654651772230864
distance x is tensor(105.4707, device='cuda:0')
benign distance is  tensor(105.4707, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5749582313001156
distance x is tensor(143.0932, device='cuda:0')
benign distance is  tensor(143.0932, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  11.356676697731018
distance x is tensor(161.4180, device='cuda:0')
benign distance is  tensor(161.4180, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.639845699071884
distance x is tensor(191.7099, device='cuda:0')
benign distance is  tensor(191.7099, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  11.127461969852448
distance x is tensor(159.4053, device='cuda:0')
benign distance is  tensor(159.4053, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  10.04112160205841
distance x is tensor(156.5859, device='cuda:0')
benign distance is  tensor(156.5859, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  9.78356745839119
distance x is tensor(148.2814, device='cuda:0')
benign distance is  tensor(148.2814, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  9.494061321020126
distance x is tensor(175.5561, device='cuda:0')
benign distance is  tensor(175.5561, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  9.70099151134491
distance x is tensor(179.7899, device='cuda:0')
benign distance is  tensor(179.7899, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  12.050476372241974
distance x is tensor(150.6899, device='cuda:0')
benign distance is  tensor(150.6899, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  9.470700144767761
distance x is tensor(154.7420, device='cuda:0')
benign distance is  tensor(154.7420, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  11.369549930095673
distance x is tensor(154.3582, device='cuda:0')
benign distance is  tensor(154.3582, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.671678304672241
distance x is tensor(158.2446, device='cuda:0')
benign distance is  tensor(158.2446, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  11.482658743858337
distance x is tensor(206.1306, device='cuda:0')
benign distance is  tensor(206.1306, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([441.7025, 404.2924, 500.0686, 779.3546, 290.7609, 416.0750, 354.2538,
        379.8563, 666.6610, 813.5400, 651.9302, 633.8936, 627.7294, 754.9650,
        750.4561, 646.3755, 656.8168, 656.2591, 659.2350, 850.5248],
       device='cuda:0')
sorted_norm is   tensor([290.7609, 354.2538, 379.8563, 404.2924, 416.0750, 441.7025, 500.0686,
        627.7294, 633.8936, 646.3755, 651.9302, 656.2591, 656.8168, 659.2350,
        666.6610, 750.4561, 754.9650, 779.3546, 813.5400, 850.5248],
       device='cuda:0')
used idx is  tensor([ 4,  6,  7,  1,  5,  0,  2, 12, 11, 15, 10, 17, 16, 18,  8, 14],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 54.81% 

Test Accuracy: 15.85% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.769010353833437
distance x is tensor(151.8964, device='cuda:0')
benign distance is  tensor(151.8964, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9708171747624874
distance x is tensor(136.0361, device='cuda:0')
benign distance is  tensor(136.0361, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8681496661156416
distance x is tensor(141.9822, device='cuda:0')
benign distance is  tensor(141.9822, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2092576026916504
distance x is tensor(191.5324, device='cuda:0')
benign distance is  tensor(191.5324, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9370057433843613
distance x is tensor(142.8956, device='cuda:0')
benign distance is  tensor(142.8956, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8072658805176616
distance x is tensor(140.2020, device='cuda:0')
benign distance is  tensor(140.2020, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.306353248655796
distance x is tensor(132.5199, device='cuda:0')
benign distance is  tensor(132.5199, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8378332369029522
distance x is tensor(138.3905, device='cuda:0')
benign distance is  tensor(138.3905, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  10.239010512828827
distance x is tensor(74.3317, device='cuda:0')
benign distance is  tensor(74.3317, device='cuda:0')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  8.134978473186493
distance x is tensor(145.9472, device='cuda:0')
benign distance is  tensor(145.9472, device='cuda:0')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  8.932946860790253
distance x is tensor(86.1555, device='cuda:0')
benign distance is  tensor(86.1555, device='cuda:0')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  12.061047911643982
distance x is tensor(84.0450, device='cuda:0')
benign distance is  tensor(84.0450, device='cuda:0')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  8.984661370515823
distance x is tensor(91.0844, device='cuda:0')
benign distance is  tensor(91.0844, device='cuda:0')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  8.269505023956299
distance x is tensor(109.2666, device='cuda:0')
benign distance is  tensor(109.2666, device='cuda:0')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  10.74190503358841
distance x is tensor(119.2585, device='cuda:0')
benign distance is  tensor(119.2585, device='cuda:0')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  8.431797206401825
distance x is tensor(86.4319, device='cuda:0')
benign distance is  tensor(86.4319, device='cuda:0')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  8.356173783540726
distance x is tensor(100.4202, device='cuda:0')
benign distance is  tensor(100.4202, device='cuda:0')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  10.378767728805542
distance x is tensor(77.6186, device='cuda:0')
benign distance is  tensor(77.6186, device='cuda:0')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  9.994475185871124
distance x is tensor(91.4707, device='cuda:0')
benign distance is  tensor(91.4707, device='cuda:0')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  10.103218019008636
distance x is tensor(158.7421, device='cuda:0')
benign distance is  tensor(158.7421, device='cuda:0')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([677.5758, 601.8981, 629.5229, 854.4512, 626.4687, 600.6573, 575.2648,
        594.7350, 357.6887, 689.3346, 389.5504, 393.0957, 424.3563, 504.7917,
        540.5237, 402.6859, 470.9294, 355.6924, 412.5137, 722.1275, 673.3329,
        633.6745, 829.6679, 708.0490, 687.6547, 525.0261, 573.0556, 662.3851,
        514.3467, 635.6796, 419.5523, 546.6851, 868.3843, 327.9347, 741.9368,
        616.8695], device='cuda:0')
sorted_norm is   tensor([327.9347, 355.6924, 357.6887, 389.5504, 393.0957, 402.6859, 412.5137,
        419.5523, 424.3563, 470.9294, 504.7917, 514.3467, 525.0261, 540.5237,
        546.6851, 573.0556, 575.2648, 594.7350, 600.6573, 601.8981, 616.8695,
        626.4687, 629.5229, 633.6745, 635.6796, 662.3851, 673.3329, 677.5758,
        687.6547, 689.3346, 708.0490, 722.1275, 741.9368, 829.6679, 854.4512,
        868.3843], device='cuda:0')
used idx is  tensor([33, 17,  8, 10, 11, 15, 18, 30, 12, 16, 13, 28, 25, 14, 31, 26,  6,  7,
         5,  1, 35,  4,  2, 21, 29, 27, 20,  0], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 89.95% 

Test Accuracy: 87.16% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 89.95%
|----0th round Training Accuracy : 83.78%
|----1th round Training Accuracy : 91.67%
|----2th round Training Accuracy : 90.82%
|----3th round Training Accuracy : 91.73%
|----4th round Training Accuracy : 91.54%
|----5th round Training Accuracy : 91.54%
|----6th round Training Accuracy : 66.51%
|----7th round Training Accuracy : 91.02%
|----8th round Training Accuracy : 79.72%
|----9th round Training Accuracy : 91.02%
|----10th round Training Accuracy : 59.11%
|----11th round Training Accuracy : 90.09%
|----12th round Training Accuracy : 67.73%
|----13th round Training Accuracy : 89.77%
|----14th round Training Accuracy : 90.67%
|----15th round Training Accuracy : 89.16%
|----16th round Training Accuracy : 68.89%
|----17th round Training Accuracy : 90.47%
|----18th round Training Accuracy : 59.18%
|----19th round Training Accuracy : 91.10%
|----20th round Training Accuracy : 74.68%
|----21th round Training Accuracy : 89.18%
|----22th round Training Accuracy : 63.53%
|----23th round Training Accuracy : 89.71%
|----24th round Training Accuracy : 81.68%
|----25th round Training Accuracy : 89.79%
|----26th round Training Accuracy : 83.42%
|----27th round Training Accuracy : 90.50%
|----28th round Training Accuracy : 60.90%
|----29th round Training Accuracy : 90.27%
|----30th round Training Accuracy : 57.13%
|----31th round Training Accuracy : 90.63%
|----32th round Training Accuracy : 79.99%
|----33th round Training Accuracy : 89.37%
|----34th round Training Accuracy : 87.33%
|----35th round Training Accuracy : 89.73%
|----36th round Training Accuracy : 58.37%
|----37th round Training Accuracy : 90.02%
|----38th round Training Accuracy : 84.73%
|----39th round Training Accuracy : 91.02%
|----40th round Training Accuracy : 60.38%
|----41th round Training Accuracy : 90.39%
|----42th round Training Accuracy : 61.80%
|----43th round Training Accuracy : 90.17%
|----44th round Training Accuracy : 89.40%
|----45th round Training Accuracy : 84.61%
|----46th round Training Accuracy : 69.18%
|----47th round Training Accuracy : 88.88%
|----48th round Training Accuracy : 54.81%
|----49th round Training Accuracy : 89.95%
|----Final Test Accuracy: 87.16%
|----0th round Final Test Accuracy : 56.40%
|----1th round Final Test Accuracy : 82.69%
|----2th round Final Test Accuracy : 76.02%
|----3th round Final Test Accuracy : 87.15%
|----4th round Final Test Accuracy : 75.81%
|----5th round Final Test Accuracy : 86.71%
|----6th round Final Test Accuracy : 25.34%
|----7th round Final Test Accuracy : 86.99%
|----8th round Final Test Accuracy : 43.36%
|----9th round Final Test Accuracy : 87.14%
|----10th round Final Test Accuracy : 17.85%
|----11th round Final Test Accuracy : 87.35%
|----12th round Final Test Accuracy : 22.92%
|----13th round Final Test Accuracy : 84.53%
|----14th round Final Test Accuracy : 85.58%
|----15th round Final Test Accuracy : 73.31%
|----16th round Final Test Accuracy : 22.92%
|----17th round Final Test Accuracy : 87.75%
|----18th round Final Test Accuracy : 16.99%
|----19th round Final Test Accuracy : 87.29%
|----20th round Final Test Accuracy : 30.79%
|----21th round Final Test Accuracy : 83.10%
|----22th round Final Test Accuracy : 20.30%
|----23th round Final Test Accuracy : 87.62%
|----24th round Final Test Accuracy : 40.77%
|----25th round Final Test Accuracy : 82.04%
|----26th round Final Test Accuracy : 50.15%
|----27th round Final Test Accuracy : 86.29%
|----28th round Final Test Accuracy : 17.84%
|----29th round Final Test Accuracy : 88.04%
|----30th round Final Test Accuracy : 16.56%
|----31th round Final Test Accuracy : 86.35%
|----32th round Final Test Accuracy : 44.01%
|----33th round Final Test Accuracy : 71.53%
|----34th round Final Test Accuracy : 64.59%
|----35th round Final Test Accuracy : 88.00%
|----36th round Final Test Accuracy : 16.78%
|----37th round Final Test Accuracy : 84.24%
|----38th round Final Test Accuracy : 47.31%
|----39th round Final Test Accuracy : 87.98%
|----40th round Final Test Accuracy : 17.16%
|----41th round Final Test Accuracy : 87.59%
|----42th round Final Test Accuracy : 17.98%
|----43th round Final Test Accuracy : 87.52%
|----44th round Final Test Accuracy : 64.56%
|----45th round Final Test Accuracy : 54.37%
|----46th round Final Test Accuracy : 23.93%
|----47th round Final Test Accuracy : 87.88%
|----48th round Final Test Accuracy : 15.85%
|----49th round Final Test Accuracy : 87.16%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Data poison attack is done!

 Total Run Time: 3360.3173
