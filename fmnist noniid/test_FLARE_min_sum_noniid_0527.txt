
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8141136560589075
distance x is tensor(122.1851, device='cuda:1')
benign distance is  tensor(122.1851, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8678475823253393
distance x is tensor(110.1606, device='cuda:1')
benign distance is  tensor(110.1606, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6480896212160587
distance x is tensor(109.4909, device='cuda:1')
benign distance is  tensor(109.4909, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9979274123907089
distance x is tensor(148.9355, device='cuda:1')
benign distance is  tensor(148.9355, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8613009583204985
distance x is tensor(99.6296, device='cuda:1')
benign distance is  tensor(99.6296, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6790843587368727
distance x is tensor(102.4247, device='cuda:1')
benign distance is  tensor(102.4247, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1925729680806398
distance x is tensor(113.8171, device='cuda:1')
benign distance is  tensor(113.8171, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6637049093842506
distance x is tensor(84.5350, device='cuda:1')
benign distance is  tensor(84.5350, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8300200290977955
distance x is tensor(113.7220, device='cuda:1')
benign distance is  tensor(113.7220, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7597587155178189
distance x is tensor(130.4169, device='cuda:1')
benign distance is  tensor(130.4169, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0324648264795542
distance x is tensor(96.7507, device='cuda:1')
benign distance is  tensor(96.7507, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.209454271942377
distance x is tensor(124.7048, device='cuda:1')
benign distance is  tensor(124.7048, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0621835999190807
distance x is tensor(168.3970, device='cuda:1')
benign distance is  tensor(168.3970, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6131272278726101
distance x is tensor(67.0361, device='cuda:1')
benign distance is  tensor(67.0361, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8931821687147021
distance x is tensor(149.7839, device='cuda:1')
benign distance is  tensor(149.7839, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3793294318020344
distance x is tensor(129.7659, device='cuda:1')
benign distance is  tensor(129.7659, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.3120402172207832
distance x is tensor(127.1912, device='cuda:1')
benign distance is  tensor(127.1912, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5657698661088943
distance x is tensor(114.7597, device='cuda:1')
benign distance is  tensor(114.7597, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8476671371608973
distance x is tensor(121.6292, device='cuda:1')
benign distance is  tensor(121.6292, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.731246542185545
distance x is tensor(121.0091, device='cuda:1')
benign distance is  tensor(121.0091, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9857759419828653
distance x is tensor(85.6753, device='cuda:1')
benign distance is  tensor(85.6753, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7924926932901144
distance x is tensor(212.2195, device='cuda:1')
benign distance is  tensor(212.2195, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0826761685311794
distance x is tensor(148.6742, device='cuda:1')
benign distance is  tensor(148.6742, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.656486913561821
distance x is tensor(115.8303, device='cuda:1')
benign distance is  tensor(115.8303, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.8788187773898244
distance x is tensor(115.6150, device='cuda:1')
benign distance is  tensor(115.6150, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6017037210986018
distance x is tensor(81.1887, device='cuda:1')
benign distance is  tensor(81.1887, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.0057205893099308
distance x is tensor(138.2530, device='cuda:1')
benign distance is  tensor(138.2530, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.0979334227740765
distance x is tensor(115.3049, device='cuda:1')
benign distance is  tensor(115.3049, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7584410384297371
distance x is tensor(125.0879, device='cuda:1')
benign distance is  tensor(125.0879, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.847205625846982
distance x is tensor(119.7275, device='cuda:1')
benign distance is  tensor(119.7275, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4850533353164792
distance x is tensor(109.9796, device='cuda:1')
benign distance is  tensor(109.9796, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7178364172577858
distance x is tensor(172.9953, device='cuda:1')
benign distance is  tensor(172.9953, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8129178341478109
distance x is tensor(114.7626, device='cuda:1')
benign distance is  tensor(114.7626, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.7419277969747782
distance x is tensor(104.7332, device='cuda:1')
benign distance is  tensor(104.7332, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5598080232739449
distance x is tensor(150.8933, device='cuda:1')
benign distance is  tensor(150.8933, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.411465134471655
distance x is tensor(125.2020, device='cuda:1')
benign distance is  tensor(125.2020, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8694686889648438
distance x is tensor(113.1336, device='cuda:1')
benign distance is  tensor(113.1336, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8910370916128159
distance x is tensor(85.4492, device='cuda:1')
benign distance is  tensor(85.4492, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7180276531726122
distance x is tensor(99.7398, device='cuda:1')
benign distance is  tensor(99.7398, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.85125732421875
distance x is tensor(116.3770, device='cuda:1')
benign distance is  tensor(116.3770, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.2726966738700867
distance x is tensor(114.3519, device='cuda:1')
benign distance is  tensor(114.3519, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.2360372431576252
distance x is tensor(136.9360, device='cuda:1')
benign distance is  tensor(136.9360, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.1880781408399343
distance x is tensor(146.1731, device='cuda:1')
benign distance is  tensor(146.1731, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.118979997932911
distance x is tensor(100.8228, device='cuda:1')
benign distance is  tensor(100.8228, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5251189842820168
distance x is tensor(157.0126, device='cuda:1')
benign distance is  tensor(157.0126, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7441766560077667
distance x is tensor(142.5850, device='cuda:1')
benign distance is  tensor(142.5850, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8198357783257961
distance x is tensor(102.5100, device='cuda:1')
benign distance is  tensor(102.5100, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5567070171236992
distance x is tensor(138.1433, device='cuda:1')
benign distance is  tensor(138.1433, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.85500000016
mal_loss is 0.5425532422959805
mal_entropy is 0.2455849125981331
user_PLR len size 20
counter_tensor is  tensor([15., 17., 15., 16., 16., 16., 15., 15., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([0.0006, 0.0041, 0.0006, 0.0015, 0.0015, 0.0015, 0.0006, 0.0006, 0.0824,
        0.0824, 0.0824, 0.0824, 0.0824, 0.0824, 0.0824, 0.0824, 0.0824, 0.0824,
        0.0824, 0.0824])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 95.86% 

Test Accuracy: 85.73% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7501057144254446
distance x is tensor(137.9507, device='cuda:1')
benign distance is  tensor(137.9507, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6558983437716961
distance x is tensor(117.7374, device='cuda:1')
benign distance is  tensor(117.7374, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6372249964624643
distance x is tensor(125.2105, device='cuda:1')
benign distance is  tensor(125.2105, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9545613750815392
distance x is tensor(165.3593, device='cuda:1')
benign distance is  tensor(165.3593, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7375795282423496
distance x is tensor(116.4170, device='cuda:1')
benign distance is  tensor(116.4170, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7775138253346086
distance x is tensor(113.4914, device='cuda:1')
benign distance is  tensor(113.4914, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9268256928771734
distance x is tensor(135.7100, device='cuda:1')
benign distance is  tensor(135.7100, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7134549487382174
distance x is tensor(113.2178, device='cuda:1')
benign distance is  tensor(113.2178, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.59400000016
mal_loss is 3.2111623734235764
mal_entropy is 0.2633828101679683
user_PLR len size 28
counter_tensor is  tensor([27., 22., 21., 27., 25., 16., 24., 20., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 26.,  0., 27., 27., 21., 26., 24., 27.])
count_res tensor([1.6713e-01, 1.1261e-03, 4.1427e-04, 1.6713e-01, 2.2618e-02, 2.7913e-06,
        8.3207e-03, 1.5240e-04, 2.7913e-06, 2.7913e-06, 2.7913e-06, 2.7913e-06,
        2.7913e-06, 2.7913e-06, 2.7913e-06, 2.7913e-06, 2.7913e-06, 2.7913e-06,
        2.7913e-06, 2.7913e-06, 6.1482e-02, 3.1412e-13, 1.6713e-01, 1.6713e-01,
        4.1427e-04, 6.1482e-02, 8.3207e-03, 1.6713e-01])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 90.76% 

Test Accuracy: 86.92% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7019389178603888
distance x is tensor(99.5433, device='cuda:1')
benign distance is  tensor(99.5433, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9691753312945366
distance x is tensor(105.6404, device='cuda:1')
benign distance is  tensor(105.6404, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7009745221585035
distance x is tensor(108.7232, device='cuda:1')
benign distance is  tensor(108.7232, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9487186092883348
distance x is tensor(139.6549, device='cuda:1')
benign distance is  tensor(139.6549, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.888616188429296
distance x is tensor(90.3875, device='cuda:1')
benign distance is  tensor(90.3875, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6774027375504375
distance x is tensor(106.3242, device='cuda:1')
benign distance is  tensor(106.3242, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.048576321452856
distance x is tensor(96.1984, device='cuda:1')
benign distance is  tensor(96.1984, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6404027473181486
distance x is tensor(90.3594, device='cuda:1')
benign distance is  tensor(90.3594, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9004430416971445
distance x is tensor(102.9840, device='cuda:1')
benign distance is  tensor(102.9840, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5301922531798482
distance x is tensor(134.6530, device='cuda:1')
benign distance is  tensor(134.6530, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0855780877172947
distance x is tensor(61.2502, device='cuda:1')
benign distance is  tensor(61.2502, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.6065694764256477
distance x is tensor(107.2538, device='cuda:1')
benign distance is  tensor(107.2538, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0360541976988316
distance x is tensor(158.4437, device='cuda:1')
benign distance is  tensor(158.4437, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7411844432353973
distance x is tensor(62.1320, device='cuda:1')
benign distance is  tensor(62.1320, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9572640843689442
distance x is tensor(132.1715, device='cuda:1')
benign distance is  tensor(132.1715, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1581924557685852
distance x is tensor(121.3932, device='cuda:1')
benign distance is  tensor(121.3932, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.83300000016
mal_loss is 0.8744318597018719
mal_entropy is 0.16395314317196608
user_PLR len size 28
counter_tensor is  tensor([14., 12., 19., 12., 12., 14.,  0., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 18., 12., 26., 13., 15., 27., 13., 12.])
count_res tensor([1.6516e-06, 2.2352e-07, 2.4512e-04, 2.2352e-07, 2.2352e-07, 1.6516e-06,
        1.3734e-12, 2.2352e-07, 1.2204e-05, 1.2204e-05, 1.2204e-05, 1.2204e-05,
        1.2204e-05, 1.2204e-05, 1.2204e-05, 1.2204e-05, 1.2204e-05, 1.2204e-05,
        1.2204e-05, 1.2204e-05, 9.0175e-05, 2.2352e-07, 2.6881e-01, 6.0760e-07,
        4.4896e-06, 7.3070e-01, 6.0760e-07, 2.2352e-07])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 81.27% 

Test Accuracy: 82.76% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.736859024502337
distance x is tensor(140.0600, device='cuda:1')
benign distance is  tensor(140.0600, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9935890417546034
distance x is tensor(114.3198, device='cuda:1')
benign distance is  tensor(114.3198, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8250211738049984
distance x is tensor(115.1218, device='cuda:1')
benign distance is  tensor(115.1218, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0061319507658482
distance x is tensor(155.3525, device='cuda:1')
benign distance is  tensor(155.3525, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0207766462117434
distance x is tensor(95.6208, device='cuda:1')
benign distance is  tensor(95.6208, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.766377542167902
distance x is tensor(115.0205, device='cuda:1')
benign distance is  tensor(115.0205, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.485621940344572
distance x is tensor(128.8273, device='cuda:1')
benign distance is  tensor(128.8273, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7736791018396616
distance x is tensor(98.3514, device='cuda:1')
benign distance is  tensor(98.3514, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.6403082013130188
distance x is tensor(114.4160, device='cuda:1')
benign distance is  tensor(114.4160, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8321207109838724
distance x is tensor(127.9337, device='cuda:1')
benign distance is  tensor(127.9337, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.1308022756129503
distance x is tensor(120.2050, device='cuda:1')
benign distance is  tensor(120.2050, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.0352168679237366
distance x is tensor(124.2529, device='cuda:1')
benign distance is  tensor(124.2529, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.2167821787297726
distance x is tensor(87.0131, device='cuda:1')
benign distance is  tensor(87.0131, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8484629839658737
distance x is tensor(194.2012, device='cuda:1')
benign distance is  tensor(194.2012, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1946968734264374
distance x is tensor(156.1406, device='cuda:1')
benign distance is  tensor(156.1406, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7912097200751305
distance x is tensor(117.9623, device='cuda:1')
benign distance is  tensor(117.9623, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.69300000016
mal_loss is 1.4259395822882652
mal_entropy is 0.28072440065443516
user_PLR len size 36
counter_tensor is  tensor([ 0., 27., 35., 13., 13.,  0., 20., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 34., 12., 12.,  0., 24., 14., 33., 35.,
        27., 12., 34., 13.,  0.,  0., 13., 13.])
count_res tensor([2.1954e-16, 1.1681e-04, 3.4819e-01, 9.7127e-11, 9.7127e-11, 2.1954e-16,
        1.0651e-07, 3.5731e-11, 5.8154e-06, 5.8154e-06, 5.8154e-06, 5.8154e-06,
        5.8154e-06, 5.8154e-06, 5.8154e-06, 5.8154e-06, 5.8154e-06, 5.8154e-06,
        5.8154e-06, 5.8154e-06, 1.2809e-01, 3.5731e-11, 3.5731e-11, 2.1954e-16,
        5.8154e-06, 2.6402e-10, 4.7123e-02, 3.4819e-01, 1.1681e-04, 3.5731e-11,
        1.2809e-01, 9.7127e-11, 2.1954e-16, 2.1954e-16, 9.7127e-11, 9.7127e-11])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 91.88% 

Test Accuracy: 86.73% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6241586934775114
distance x is tensor(118.8754, device='cuda:1')
benign distance is  tensor(118.8754, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6526955384761095
distance x is tensor(113.0984, device='cuda:1')
benign distance is  tensor(113.0984, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7805334404110909
distance x is tensor(96.0403, device='cuda:1')
benign distance is  tensor(96.0403, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0359540320932865
distance x is tensor(146.0541, device='cuda:1')
benign distance is  tensor(146.0541, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8803127035498619
distance x is tensor(95.3344, device='cuda:1')
benign distance is  tensor(95.3344, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7348554963245988
distance x is tensor(109.1434, device='cuda:1')
benign distance is  tensor(109.1434, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1362975798547268
distance x is tensor(105.6346, device='cuda:1')
benign distance is  tensor(105.6346, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6528317788615823
distance x is tensor(89.4816, device='cuda:1')
benign distance is  tensor(89.4816, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0185494367033243
distance x is tensor(100.9109, device='cuda:1')
benign distance is  tensor(100.9109, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6865244619548321
distance x is tensor(122.7561, device='cuda:1')
benign distance is  tensor(122.7561, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1848462782800198
distance x is tensor(63.6544, device='cuda:1')
benign distance is  tensor(63.6544, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3191806934773922
distance x is tensor(120.4608, device='cuda:1')
benign distance is  tensor(120.4608, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9920557141304016
distance x is tensor(157.3859, device='cuda:1')
benign distance is  tensor(157.3859, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7301086243242025
distance x is tensor(69.4506, device='cuda:1')
benign distance is  tensor(69.4506, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7328224331140518
distance x is tensor(140.6286, device='cuda:1')
benign distance is  tensor(140.6286, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.4276675656437874
distance x is tensor(129.3732, device='cuda:1')
benign distance is  tensor(129.3732, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9677658546715975
distance x is tensor(107.4844, device='cuda:1')
benign distance is  tensor(107.4844, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.599308155477047
distance x is tensor(81.9237, device='cuda:1')
benign distance is  tensor(81.9237, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.0525254793465137
distance x is tensor(131.3882, device='cuda:1')
benign distance is  tensor(131.3882, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.4398773461580276
distance x is tensor(107.2089, device='cuda:1')
benign distance is  tensor(107.2089, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6868466660380363
distance x is tensor(115.9459, device='cuda:1')
benign distance is  tensor(115.9459, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8878357838839293
distance x is tensor(179.3907, device='cuda:1')
benign distance is  tensor(179.3907, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.682898236438632
distance x is tensor(113.2547, device='cuda:1')
benign distance is  tensor(113.2547, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7347780093550682
distance x is tensor(156.4901, device='cuda:1')
benign distance is  tensor(156.4901, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8010000001600001
mal_loss is 0.6624738685786724
mal_entropy is 0.3566450411453843
user_PLR len size 28
counter_tensor is  tensor([12., 25.,  5., 12., 12., 12., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 27., 27., 12., 12., 12., 12., 12.])
count_res tensor([1.4324e-07, 6.3373e-02, 1.3062e-10, 1.4324e-07, 1.4324e-07, 1.4324e-07,
        1.4324e-07, 1.4324e-07, 7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06,
        7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06,
        7.8208e-06, 7.8208e-06, 1.4324e-07, 4.6827e-01, 4.6827e-01, 1.4324e-07,
        1.4324e-07, 1.4324e-07, 1.4324e-07, 1.4324e-07])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 89.69% 

Test Accuracy: 86.08% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7163485009223223
distance x is tensor(117.2687, device='cuda:1')
benign distance is  tensor(117.2687, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.943926302716136
distance x is tensor(111.1185, device='cuda:1')
benign distance is  tensor(111.1185, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7924112305045128
distance x is tensor(118.2336, device='cuda:1')
benign distance is  tensor(118.2336, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9938123244792223
distance x is tensor(162.2001, device='cuda:1')
benign distance is  tensor(162.2001, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8146445415914059
distance x is tensor(98.6265, device='cuda:1')
benign distance is  tensor(98.6265, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5934842396527529
distance x is tensor(112.4768, device='cuda:1')
benign distance is  tensor(112.4768, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9172515887767076
distance x is tensor(118.0347, device='cuda:1')
benign distance is  tensor(118.0347, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6250343769788742
distance x is tensor(94.8940, device='cuda:1')
benign distance is  tensor(94.8940, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7298590671271086
distance x is tensor(119.4913, device='cuda:1')
benign distance is  tensor(119.4913, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.7764351693913341
distance x is tensor(83.1747, device='cuda:1')
benign distance is  tensor(83.1747, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7595923542976379
distance x is tensor(135.8056, device='cuda:1')
benign distance is  tensor(135.8056, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.2414917759597301
distance x is tensor(128.0948, device='cuda:1')
benign distance is  tensor(128.0948, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6868128255009651
distance x is tensor(103.9622, device='cuda:1')
benign distance is  tensor(103.9622, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.705906642600894
distance x is tensor(94.1740, device='cuda:1')
benign distance is  tensor(94.1740, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.831502228975296
distance x is tensor(98.5463, device='cuda:1')
benign distance is  tensor(98.5463, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8507125284522772
distance x is tensor(115.9328, device='cuda:1')
benign distance is  tensor(115.9328, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.79300000016
mal_loss is 0.5857053669169545
mal_entropy is 0.3440283592790365
user_PLR len size 44
counter_tensor is  tensor([12., 12., 29.,  0.,  3., 38., 17.,  0., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 20.,  0., 12., 43., 37., 12.,  0., 39.,
        12., 40., 13., 12., 15., 43.,  0., 12., 12., 43., 43., 31.,  0., 23.,
        42., 13.])
count_res tensor([7.7439e-15, 7.7439e-15, 1.8705e-07, 4.7580e-20, 9.5567e-19, 1.5157e-03,
        1.1493e-12, 4.7580e-20, 3.7571e-06, 3.7571e-06, 3.7571e-06, 3.7571e-06,
        3.7571e-06, 3.7571e-06, 3.7571e-06, 3.7571e-06, 3.7571e-06, 3.7571e-06,
        3.7571e-06, 3.7571e-06, 2.3084e-11, 4.7580e-20, 7.7439e-15, 2.2495e-01,
        5.5760e-04, 7.7439e-15, 4.7580e-20, 4.1201e-03, 7.7439e-15, 1.1200e-02,
        2.1050e-14, 7.7439e-15, 1.5554e-13, 2.2495e-01, 4.7580e-20, 7.7439e-15,
        7.7439e-15, 2.2495e-01, 2.2495e-01, 1.3821e-06, 4.7580e-20, 4.6366e-10,
        8.2755e-02, 2.1050e-14])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 89.72% 

Test Accuracy: 86.32% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7798937782645226
distance x is tensor(125.2454, device='cuda:1')
benign distance is  tensor(125.2454, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8887025564908981
distance x is tensor(111.8283, device='cuda:1')
benign distance is  tensor(111.8283, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7663847776129842
distance x is tensor(98.2236, device='cuda:1')
benign distance is  tensor(98.2236, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9950212184339762
distance x is tensor(147.8671, device='cuda:1')
benign distance is  tensor(147.8671, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9951423620805144
distance x is tensor(94.4469, device='cuda:1')
benign distance is  tensor(94.4469, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5782983833923936
distance x is tensor(100.4168, device='cuda:1')
benign distance is  tensor(100.4168, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.018987812101841
distance x is tensor(107.2071, device='cuda:1')
benign distance is  tensor(107.2071, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7011211905628443
distance x is tensor(91.6009, device='cuda:1')
benign distance is  tensor(91.6009, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8591556679457426
distance x is tensor(101.8473, device='cuda:1')
benign distance is  tensor(101.8473, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5657205823808908
distance x is tensor(117.4155, device='cuda:1')
benign distance is  tensor(117.4155, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9926724061369896
distance x is tensor(62.7013, device='cuda:1')
benign distance is  tensor(62.7013, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4011324495077133
distance x is tensor(116.2097, device='cuda:1')
benign distance is  tensor(116.2097, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0942670740187168
distance x is tensor(172.5836, device='cuda:1')
benign distance is  tensor(172.5836, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6431661397218704
distance x is tensor(67.0117, device='cuda:1')
benign distance is  tensor(67.0117, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9792060237377882
distance x is tensor(126.3801, device='cuda:1')
benign distance is  tensor(126.3801, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2612413726747036
distance x is tensor(121.9651, device='cuda:1')
benign distance is  tensor(121.9651, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.0783334877341986
distance x is tensor(95.8036, device='cuda:1')
benign distance is  tensor(95.8036, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7378516877070069
distance x is tensor(115.0968, device='cuda:1')
benign distance is  tensor(115.0968, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9068319890648127
distance x is tensor(116.2941, device='cuda:1')
benign distance is  tensor(116.2941, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7867754753679037
distance x is tensor(117.3668, device='cuda:1')
benign distance is  tensor(117.3668, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9884857274591923
distance x is tensor(80.0718, device='cuda:1')
benign distance is  tensor(80.0718, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7795269247144461
distance x is tensor(204.8307, device='cuda:1')
benign distance is  tensor(204.8307, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.9803847298026085
distance x is tensor(150.8269, device='cuda:1')
benign distance is  tensor(150.8269, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.661652559414506
distance x is tensor(106.9652, device='cuda:1')
benign distance is  tensor(106.9652, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.2425166815519333
distance x is tensor(112.8504, device='cuda:1')
benign distance is  tensor(112.8504, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.2353280372917652
distance x is tensor(145.2467, device='cuda:1')
benign distance is  tensor(145.2467, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.9056430496275425
distance x is tensor(139.4427, device='cuda:1')
benign distance is  tensor(139.4427, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.0775910317897797
distance x is tensor(78.4437, device='cuda:1')
benign distance is  tensor(78.4437, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6862806845456362
distance x is tensor(159.4542, device='cuda:1')
benign distance is  tensor(159.4542, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8274424020200968
distance x is tensor(127.0172, device='cuda:1')
benign distance is  tensor(127.0172, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7222882900387049
distance x is tensor(95.4948, device='cuda:1')
benign distance is  tensor(95.4948, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6807052176445723
distance x is tensor(118.8401, device='cuda:1')
benign distance is  tensor(118.8401, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.77000000016
mal_loss is 0.7094291057437658
mal_entropy is 0.35432532988488674
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 92.53% 

Test Accuracy: 79.60% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.757741404697299
distance x is tensor(140.4118, device='cuda:1')
benign distance is  tensor(140.4118, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7481410168111324
distance x is tensor(119.4139, device='cuda:1')
benign distance is  tensor(119.4139, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8794717937707901
distance x is tensor(118.5441, device='cuda:1')
benign distance is  tensor(118.5441, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.949858520179987
distance x is tensor(160.5333, device='cuda:1')
benign distance is  tensor(160.5333, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0970271453261375
distance x is tensor(126.5218, device='cuda:1')
benign distance is  tensor(126.5218, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7769354898482561
distance x is tensor(115.7763, device='cuda:1')
benign distance is  tensor(115.7763, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4649686329066753
distance x is tensor(113.6672, device='cuda:1')
benign distance is  tensor(113.6672, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6249285824596882
distance x is tensor(103.7481, device='cuda:1')
benign distance is  tensor(103.7481, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.47300000016000004
mal_loss is 4.180215045809746
mal_entropy is 0.3514925166964531
user_PLR len size 36
counter_tensor is  tensor([ 0.,  0.,  0., 12., 12., 30.,  0., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 12., 14., 35., 12., 14., 35., 12., 34.,
        35.,  0., 35., 12., 12., 19., 35., 14.])
count_res tensor([1.1731e-16, 1.1731e-16, 1.1731e-16, 1.9093e-11, 1.9093e-11, 1.2536e-03,
        1.1731e-16, 1.9093e-11, 3.1074e-06, 3.1074e-06, 3.1074e-06, 3.1074e-06,
        3.1074e-06, 3.1074e-06, 3.1074e-06, 3.1074e-06, 3.1074e-06, 3.1074e-06,
        3.1074e-06, 3.1074e-06, 1.9093e-11, 1.4108e-10, 1.8605e-01, 1.9093e-11,
        1.4108e-10, 1.8605e-01, 1.9093e-11, 6.8445e-02, 1.8605e-01, 1.1731e-16,
        1.8605e-01, 1.9093e-11, 1.9093e-11, 2.0937e-08, 1.8605e-01, 1.4108e-10])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 84.33% 

Test Accuracy: 85.60% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.731816915795207
distance x is tensor(121.6150, device='cuda:1')
benign distance is  tensor(121.6150, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7758874595165253
distance x is tensor(104.2204, device='cuda:1')
benign distance is  tensor(104.2204, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7136257793754339
distance x is tensor(98.7174, device='cuda:1')
benign distance is  tensor(98.7174, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.824938016012311
distance x is tensor(150.6285, device='cuda:1')
benign distance is  tensor(150.6285, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9488015593960881
distance x is tensor(81.7025, device='cuda:1')
benign distance is  tensor(81.7025, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6492998949252069
distance x is tensor(104.1438, device='cuda:1')
benign distance is  tensor(104.1438, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0262806229293346
distance x is tensor(105.7150, device='cuda:1')
benign distance is  tensor(105.7150, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6952337045222521
distance x is tensor(84.7042, device='cuda:1')
benign distance is  tensor(84.7042, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8783198557794094
distance x is tensor(97.3867, device='cuda:1')
benign distance is  tensor(97.3867, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8222361728549004
distance x is tensor(112.7617, device='cuda:1')
benign distance is  tensor(112.7617, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2124764882028103
distance x is tensor(62.0165, device='cuda:1')
benign distance is  tensor(62.0165, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4389077462255955
distance x is tensor(122.3131, device='cuda:1')
benign distance is  tensor(122.3131, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9208610020577908
distance x is tensor(156.8034, device='cuda:1')
benign distance is  tensor(156.8034, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6151396287605166
distance x is tensor(65.8901, device='cuda:1')
benign distance is  tensor(65.8901, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9767348058521748
distance x is tensor(140.5824, device='cuda:1')
benign distance is  tensor(140.5824, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.6511663794517517
distance x is tensor(125.0347, device='cuda:1')
benign distance is  tensor(125.0347, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.103068070486188
distance x is tensor(110.0741, device='cuda:1')
benign distance is  tensor(110.0741, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9195874072611332
distance x is tensor(84.2844, device='cuda:1')
benign distance is  tensor(84.2844, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8971946071833372
distance x is tensor(128.1788, device='cuda:1')
benign distance is  tensor(128.1788, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.3379938416182995
distance x is tensor(118.9480, device='cuda:1')
benign distance is  tensor(118.9480, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7779646813869476
distance x is tensor(121.0936, device='cuda:1')
benign distance is  tensor(121.0936, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8606260959059
distance x is tensor(89.8074, device='cuda:1')
benign distance is  tensor(89.8074, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5203015003353357
distance x is tensor(113.1762, device='cuda:1')
benign distance is  tensor(113.1762, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7699611242860556
distance x is tensor(162.8424, device='cuda:1')
benign distance is  tensor(162.8424, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8070000001600001
mal_loss is 0.7390954485163093
mal_entropy is 0.21697428170591593
user_PLR len size 28
counter_tensor is  tensor([13., 12.,  0., 13., 12., 12., 15., 13., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 23., 25., 12., 12., 27., 13., 17.])
count_res tensor([7.2062e-07, 2.6510e-07, 1.6288e-12, 7.2062e-07, 2.6510e-07, 2.6510e-07,
        5.3247e-06, 7.2062e-07, 1.4474e-05, 1.4474e-05, 1.4474e-05, 1.4474e-05,
        1.4474e-05, 1.4474e-05, 1.4474e-05, 1.4474e-05, 1.4474e-05, 1.4474e-05,
        1.4474e-05, 1.4474e-05, 2.6510e-07, 1.5873e-02, 1.1728e-01, 2.6510e-07,
        2.6510e-07, 8.6662e-01, 7.2062e-07, 3.9344e-05])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 77.87% 

Test Accuracy: 79.23% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9349860046058893
distance x is tensor(147.8296, device='cuda:1')
benign distance is  tensor(147.8296, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.192846430465579
distance x is tensor(135.3494, device='cuda:1')
benign distance is  tensor(135.3494, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9055330865085125
distance x is tensor(129.4417, device='cuda:1')
benign distance is  tensor(129.4417, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2606268879026175
distance x is tensor(179.1013, device='cuda:1')
benign distance is  tensor(179.1013, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.184411734342575
distance x is tensor(136.1576, device='cuda:1')
benign distance is  tensor(136.1576, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8791801184415817
distance x is tensor(130.8490, device='cuda:1')
benign distance is  tensor(130.8490, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.364345971494913
distance x is tensor(134.5595, device='cuda:1')
benign distance is  tensor(134.5595, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8436925746500492
distance x is tensor(111.5768, device='cuda:1')
benign distance is  tensor(111.5768, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.479796838015318
distance x is tensor(152.0860, device='cuda:1')
benign distance is  tensor(152.0860, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8775560725480318
distance x is tensor(134.0973, device='cuda:1')
benign distance is  tensor(134.0973, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.409760620445013
distance x is tensor(151.0097, device='cuda:1')
benign distance is  tensor(151.0097, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.1121786087751389
distance x is tensor(151.4198, device='cuda:1')
benign distance is  tensor(151.4198, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.115848295390606
distance x is tensor(115.6442, device='cuda:1')
benign distance is  tensor(115.6442, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0035699494183064
distance x is tensor(215.9647, device='cuda:1')
benign distance is  tensor(215.9647, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.2462536543607712
distance x is tensor(162.3128, device='cuda:1')
benign distance is  tensor(162.3128, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.0286682602018118
distance x is tensor(136.2288, device='cuda:1')
benign distance is  tensor(136.2288, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.5530000001600001
mal_loss is 2.260658383369446
mal_entropy is 0.3670447915792465
user_PLR len size 36
counter_tensor is  tensor([ 0.,  0., 31., 27., 12., 12.,  0.,  0., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 32., 12., 12., 32., 12., 12., 26., 12.,
        15., 13., 12., 34., 34., 33.,  0., 23.])
count_res tensor([6.3711e-16, 6.3711e-16, 1.8507e-02, 3.3897e-04, 1.0369e-10, 1.0369e-10,
        6.3711e-16, 6.3711e-16, 1.6876e-05, 1.6876e-05, 1.6876e-05, 1.6876e-05,
        1.6876e-05, 1.6876e-05, 1.6876e-05, 1.6876e-05, 1.6876e-05, 1.6876e-05,
        1.6876e-05, 1.6876e-05, 5.0308e-02, 1.0369e-10, 1.0369e-10, 5.0308e-02,
        1.0369e-10, 1.0369e-10, 1.2470e-04, 1.0369e-10, 2.0827e-09, 2.8186e-10,
        1.0369e-10, 3.7173e-01, 3.7173e-01, 1.3675e-01, 6.3711e-16, 6.2085e-06])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 83.05% 

Test Accuracy: 85.58% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6987483715638518
distance x is tensor(123.1177, device='cuda:1')
benign distance is  tensor(123.1177, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.835581885650754
distance x is tensor(106.2079, device='cuda:1')
benign distance is  tensor(106.2079, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7723912801593542
distance x is tensor(104.4347, device='cuda:1')
benign distance is  tensor(104.4347, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0489476583898067
distance x is tensor(143.1006, device='cuda:1')
benign distance is  tensor(143.1006, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.848727261647582
distance x is tensor(89.8964, device='cuda:1')
benign distance is  tensor(89.8964, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8101056236773729
distance x is tensor(103.2390, device='cuda:1')
benign distance is  tensor(103.2390, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9460569694638252
distance x is tensor(98.4320, device='cuda:1')
benign distance is  tensor(98.4320, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.620095232501626
distance x is tensor(85.7103, device='cuda:1')
benign distance is  tensor(85.7103, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9637342374771833
distance x is tensor(94.7596, device='cuda:1')
benign distance is  tensor(94.7596, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7748414725065231
distance x is tensor(109.6186, device='cuda:1')
benign distance is  tensor(109.6186, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9546373151242733
distance x is tensor(69.3071, device='cuda:1')
benign distance is  tensor(69.3071, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2941939160227776
distance x is tensor(94.9584, device='cuda:1')
benign distance is  tensor(94.9584, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0689653940498829
distance x is tensor(149.2695, device='cuda:1')
benign distance is  tensor(149.2695, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7471980191767216
distance x is tensor(52.4399, device='cuda:1')
benign distance is  tensor(52.4399, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8098830636590719
distance x is tensor(132.1604, device='cuda:1')
benign distance is  tensor(132.1604, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3114682585000992
distance x is tensor(115.6801, device='cuda:1')
benign distance is  tensor(115.6801, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.5856414753943682
distance x is tensor(111.3193, device='cuda:1')
benign distance is  tensor(111.3193, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.9178284779191017
distance x is tensor(92.7829, device='cuda:1')
benign distance is  tensor(92.7829, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7475421708077192
distance x is tensor(135.8448, device='cuda:1')
benign distance is  tensor(135.8448, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.4321669675409794
distance x is tensor(122.8464, device='cuda:1')
benign distance is  tensor(122.8464, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5998754017055035
distance x is tensor(108.0046, device='cuda:1')
benign distance is  tensor(108.0046, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8175533749163151
distance x is tensor(92.1641, device='cuda:1')
benign distance is  tensor(92.1641, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.9216733537614346
distance x is tensor(88.0575, device='cuda:1')
benign distance is  tensor(88.0575, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9701002594083548
distance x is tensor(121.2076, device='cuda:1')
benign distance is  tensor(121.2076, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.82300000016
mal_loss is 0.6773301437497139
mal_entropy is 0.22782901860773563
user_PLR len size 20
counter_tensor is  tensor([13., 12., 12., 12., 12., 13., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([7.5966e-05, 2.7946e-05, 2.7946e-05, 2.7946e-05, 2.7946e-05, 7.5966e-05,
        2.7946e-05, 2.7946e-05, 8.3307e-02, 8.3307e-02, 8.3307e-02, 8.3307e-02,
        8.3307e-02, 8.3307e-02, 8.3307e-02, 8.3307e-02, 8.3307e-02, 8.3307e-02,
        8.3307e-02, 8.3307e-02])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 85.46% 

Test Accuracy: 83.30% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7506934721022844
distance x is tensor(123.7254, device='cuda:1')
benign distance is  tensor(123.7254, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0495079159736633
distance x is tensor(113.0597, device='cuda:1')
benign distance is  tensor(113.0597, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7876355871558189
distance x is tensor(109.5704, device='cuda:1')
benign distance is  tensor(109.5704, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8689339011907578
distance x is tensor(151.1155, device='cuda:1')
benign distance is  tensor(151.1155, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9848193982616067
distance x is tensor(95.0075, device='cuda:1')
benign distance is  tensor(95.0075, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6778325773775578
distance x is tensor(111.0457, device='cuda:1')
benign distance is  tensor(111.0457, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1747173964977264
distance x is tensor(110.9293, device='cuda:1')
benign distance is  tensor(110.9293, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6708770710974932
distance x is tensor(98.8074, device='cuda:1')
benign distance is  tensor(98.8074, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.62300000016
mal_loss is 2.870619736611843
mal_entropy is 0.22630402073264122
user_PLR len size 52
counter_tensor is  tensor([ 0., 12., 51., 50., 20., 16., 13., 35., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 51., 51., 51., 51., 16.,  0.,  0.,  0.,
        15., 12., 12.,  0., 47., 49.,  0.,  0.,  0., 43., 13., 50., 51.,  0.,
         0.,  0., 12.,  0., 49., 12., 45., 50.,  0., 47.])
count_res tensor([9.5704e-24, 1.5576e-18, 1.3488e-01, 4.9620e-02, 4.6432e-15, 8.5044e-17,
        4.2341e-18, 1.5179e-08, 2.2527e-06, 2.2527e-06, 2.2527e-06, 2.2527e-06,
        2.2527e-06, 2.2527e-06, 2.2527e-06, 2.2527e-06, 2.2527e-06, 2.2527e-06,
        2.2527e-06, 2.2527e-06, 1.3488e-01, 1.3488e-01, 1.3488e-01, 1.3488e-01,
        8.5044e-17, 9.5704e-24, 9.5704e-24, 9.5704e-24, 3.1286e-17, 1.5576e-18,
        1.5576e-18, 9.5704e-24, 2.4704e-03, 1.8254e-02, 9.5704e-24, 9.5704e-24,
        9.5704e-24, 4.5247e-05, 4.2341e-18, 4.9620e-02, 1.3488e-01, 9.5704e-24,
        9.5704e-24, 9.5704e-24, 1.5576e-18, 9.5704e-24, 1.8254e-02, 1.5576e-18,
        3.3434e-04, 4.9620e-02, 9.5704e-24, 2.4704e-03])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 85.83% 

Test Accuracy: 86.12% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7052860092371702
distance x is tensor(120.6741, device='cuda:1')
benign distance is  tensor(120.6741, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7072934247553349
distance x is tensor(105.0411, device='cuda:1')
benign distance is  tensor(105.0411, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.719979802146554
distance x is tensor(96.7007, device='cuda:1')
benign distance is  tensor(96.7007, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7807297427207232
distance x is tensor(141.2926, device='cuda:1')
benign distance is  tensor(141.2926, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.934918774291873
distance x is tensor(81.3868, device='cuda:1')
benign distance is  tensor(81.3868, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7217265982180834
distance x is tensor(99.8199, device='cuda:1')
benign distance is  tensor(99.8199, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0208098962903023
distance x is tensor(97.6148, device='cuda:1')
benign distance is  tensor(97.6148, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7601454332470894
distance x is tensor(93.8829, device='cuda:1')
benign distance is  tensor(93.8829, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8837962653487921
distance x is tensor(106.6919, device='cuda:1')
benign distance is  tensor(106.6919, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7630005879327655
distance x is tensor(107.5630, device='cuda:1')
benign distance is  tensor(107.5630, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9123018309473991
distance x is tensor(58.5886, device='cuda:1')
benign distance is  tensor(58.5886, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3137304931879044
distance x is tensor(113.9195, device='cuda:1')
benign distance is  tensor(113.9195, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.3173923939466476
distance x is tensor(154.9467, device='cuda:1')
benign distance is  tensor(154.9467, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7002542167901993
distance x is tensor(61.5506, device='cuda:1')
benign distance is  tensor(61.5506, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8705364353954792
distance x is tensor(123.6844, device='cuda:1')
benign distance is  tensor(123.6844, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.5785120464861393
distance x is tensor(123.9265, device='cuda:1')
benign distance is  tensor(123.9265, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.996180722489953
distance x is tensor(84.3185, device='cuda:1')
benign distance is  tensor(84.3185, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7045637313276529
distance x is tensor(109.3861, device='cuda:1')
benign distance is  tensor(109.3861, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.048510255292058
distance x is tensor(118.0921, device='cuda:1')
benign distance is  tensor(118.0921, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8304499052464962
distance x is tensor(107.9436, device='cuda:1')
benign distance is  tensor(107.9436, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.958673182874918
distance x is tensor(75.1327, device='cuda:1')
benign distance is  tensor(75.1327, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.656859777867794
distance x is tensor(195.3681, device='cuda:1')
benign distance is  tensor(195.3681, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.208203513175249
distance x is tensor(141.4221, device='cuda:1')
benign distance is  tensor(141.4221, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5949734095484018
distance x is tensor(99.5638, device='cuda:1')
benign distance is  tensor(99.5638, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.2123272884637117
distance x is tensor(104.2270, device='cuda:1')
benign distance is  tensor(104.2270, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.583497503772378
distance x is tensor(79.9953, device='cuda:1')
benign distance is  tensor(79.9953, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8561327233910561
distance x is tensor(122.1082, device='cuda:1')
benign distance is  tensor(122.1082, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.1006021946668625
distance x is tensor(103.2511, device='cuda:1')
benign distance is  tensor(103.2511, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.716153547167778
distance x is tensor(105.7462, device='cuda:1')
benign distance is  tensor(105.7462, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9171602874994278
distance x is tensor(192.2324, device='cuda:1')
benign distance is  tensor(192.2324, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.48651713877916336
distance x is tensor(107.3881, device='cuda:1')
benign distance is  tensor(107.3881, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6566670816391706
distance x is tensor(159.5266, device='cuda:1')
benign distance is  tensor(159.5266, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.1088695656508207
distance x is tensor(93.4861, device='cuda:1')
benign distance is  tensor(93.4861, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.3734942115843296
distance x is tensor(135.5311, device='cuda:1')
benign distance is  tensor(135.5311, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.2706085070967674
distance x is tensor(126.6203, device='cuda:1')
benign distance is  tensor(126.6203, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.9526619389653206
distance x is tensor(79.2515, device='cuda:1')
benign distance is  tensor(79.2515, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6257299557328224
distance x is tensor(146.9124, device='cuda:1')
benign distance is  tensor(146.9124, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.771784532815218
distance x is tensor(126.3412, device='cuda:1')
benign distance is  tensor(126.3412, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8442918434739113
distance x is tensor(96.1301, device='cuda:1')
benign distance is  tensor(96.1301, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5743398973718286
distance x is tensor(115.6640, device='cuda:1')
benign distance is  tensor(115.6640, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.84200000016
mal_loss is 0.5701075997203588
mal_entropy is 0.22926870919764042
user_PLR len size 20
counter_tensor is  tensor([14., 14., 12., 13., 13., 13., 14., 14., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.0634e-04, 2.0634e-04, 2.7925e-05, 7.5908e-05, 7.5908e-05, 7.5908e-05,
        2.0634e-04, 2.0634e-04, 8.3243e-02, 8.3243e-02, 8.3243e-02, 8.3243e-02,
        8.3243e-02, 8.3243e-02, 8.3243e-02, 8.3243e-02, 8.3243e-02, 8.3243e-02,
        8.3243e-02, 8.3243e-02])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 90.03% 

Test Accuracy: 84.08% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.629921792075038
distance x is tensor(127.1369, device='cuda:1')
benign distance is  tensor(127.1369, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6165481535717845
distance x is tensor(115.0666, device='cuda:1')
benign distance is  tensor(115.0666, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7347616255283356
distance x is tensor(100.7021, device='cuda:1')
benign distance is  tensor(100.7021, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9021669942885637
distance x is tensor(161.8404, device='cuda:1')
benign distance is  tensor(161.8404, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.015618545934558
distance x is tensor(99.6174, device='cuda:1')
benign distance is  tensor(99.6174, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6271986812353134
distance x is tensor(101.7689, device='cuda:1')
benign distance is  tensor(101.7689, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2026642393320799
distance x is tensor(105.4903, device='cuda:1')
benign distance is  tensor(105.4903, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6563456058502197
distance x is tensor(99.1255, device='cuda:1')
benign distance is  tensor(99.1255, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.61300000016
mal_loss is 2.5133823081851006
mal_entropy is 0.2659749882295728
user_PLR len size 28
counter_tensor is  tensor([13., 24., 13.,  0., 13., 13., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 17., 12., 26., 23., 12., 13., 12., 14.])
count_res tensor([1.9061e-06, 1.1413e-01, 1.9061e-06, 4.3085e-12, 1.9061e-06, 1.9061e-06,
        7.0123e-07, 7.0123e-07, 3.8286e-05, 3.8286e-05, 3.8286e-05, 3.8286e-05,
        3.8286e-05, 3.8286e-05, 3.8286e-05, 3.8286e-05, 3.8286e-05, 3.8286e-05,
        3.8286e-05, 3.8286e-05, 1.0407e-04, 7.0123e-07, 8.4330e-01, 4.1986e-02,
        7.0123e-07, 1.9061e-06, 7.0123e-07, 5.1814e-06])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 76.71% 

Test Accuracy: 82.44% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7346983905881643
distance x is tensor(143.9525, device='cuda:1')
benign distance is  tensor(143.9525, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8370303176343441
distance x is tensor(113.2604, device='cuda:1')
benign distance is  tensor(113.2604, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7868374120444059
distance x is tensor(113.2866, device='cuda:1')
benign distance is  tensor(113.2866, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0019412729889154
distance x is tensor(162.3823, device='cuda:1')
benign distance is  tensor(162.3823, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0565494131296873
distance x is tensor(112.9024, device='cuda:1')
benign distance is  tensor(112.9024, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7535811048001051
distance x is tensor(105.8513, device='cuda:1')
benign distance is  tensor(105.8513, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.35947697609663
distance x is tensor(117.3554, device='cuda:1')
benign distance is  tensor(117.3554, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.713969275355339
distance x is tensor(107.7671, device='cuda:1')
benign distance is  tensor(107.7671, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0172532983124256
distance x is tensor(112.8957, device='cuda:1')
benign distance is  tensor(112.8957, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6725737862288952
distance x is tensor(123.3400, device='cuda:1')
benign distance is  tensor(123.3400, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.4179035499691963
distance x is tensor(44.9216, device='cuda:1')
benign distance is  tensor(44.9216, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.662326019257307
distance x is tensor(119.3080, device='cuda:1')
benign distance is  tensor(119.3080, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.4208062961697578
distance x is tensor(168.5742, device='cuda:1')
benign distance is  tensor(168.5742, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7566966135054827
distance x is tensor(80.5082, device='cuda:1')
benign distance is  tensor(80.5082, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.917737590149045
distance x is tensor(144.2397, device='cuda:1')
benign distance is  tensor(144.2397, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2427574880421162
distance x is tensor(131.7545, device='cuda:1')
benign distance is  tensor(131.7545, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.71700000016
mal_loss is 2.032960407435894
mal_entropy is 0.1389465336687863
user_PLR len size 36
counter_tensor is  tensor([ 3., 28., 12.,  0., 13., 15., 10., 18., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 35., 13., 12., 17., 26., 19.,  2.,  1.,
        12., 23., 25., 16., 14., 28., 35., 33.])
count_res tensor([5.9247e-15, 4.2660e-04, 4.8008e-11, 2.9497e-16, 1.3050e-10, 9.6427e-10,
        6.4972e-12, 1.9368e-08, 7.8135e-06, 7.8135e-06, 7.8135e-06, 7.8135e-06,
        7.8135e-06, 7.8135e-06, 7.8135e-06, 7.8135e-06, 7.8135e-06, 7.8135e-06,
        7.8135e-06, 7.8135e-06, 4.6783e-01, 1.3050e-10, 4.8008e-11, 7.1250e-09,
        5.7735e-05, 5.2647e-08, 2.1796e-15, 8.0182e-16, 4.8008e-11, 2.8744e-06,
        2.1239e-05, 2.6211e-09, 3.5473e-10, 4.2660e-04, 4.6783e-01, 6.3314e-02])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 93.90% 

Test Accuracy: 86.86% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8279300052672625
distance x is tensor(130.7915, device='cuda:1')
benign distance is  tensor(130.7915, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7225800976157188
distance x is tensor(102.5993, device='cuda:1')
benign distance is  tensor(102.5993, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6514524184167385
distance x is tensor(103.7947, device='cuda:1')
benign distance is  tensor(103.7947, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8301423545926809
distance x is tensor(144.5676, device='cuda:1')
benign distance is  tensor(144.5676, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7971504582092166
distance x is tensor(91.8858, device='cuda:1')
benign distance is  tensor(91.8858, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6398741584271193
distance x is tensor(105.5871, device='cuda:1')
benign distance is  tensor(105.5871, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0457306280732155
distance x is tensor(102.7617, device='cuda:1')
benign distance is  tensor(102.7617, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5962606314569712
distance x is tensor(95.3708, device='cuda:1')
benign distance is  tensor(95.3708, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.0732834376394749
distance x is tensor(97.0189, device='cuda:1')
benign distance is  tensor(97.0189, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.642852857708931
distance x is tensor(113.3675, device='cuda:1')
benign distance is  tensor(113.3675, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8646586015820503
distance x is tensor(130.7010, device='cuda:1')
benign distance is  tensor(130.7010, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9188579209148884
distance x is tensor(119.7530, device='cuda:1')
benign distance is  tensor(119.7530, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.942357724532485
distance x is tensor(77.7463, device='cuda:1')
benign distance is  tensor(77.7463, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.777738930657506
distance x is tensor(202.9302, device='cuda:1')
benign distance is  tensor(202.9302, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.459470035508275
distance x is tensor(113.8379, device='cuda:1')
benign distance is  tensor(113.8379, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7354834731668234
distance x is tensor(109.3827, device='cuda:1')
benign distance is  tensor(109.3827, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8043194506317377
distance x is tensor(105.4485, device='cuda:1')
benign distance is  tensor(105.4485, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.8368237242102623
distance x is tensor(104.6600, device='cuda:1')
benign distance is  tensor(104.6600, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6506612058728933
distance x is tensor(146.2878, device='cuda:1')
benign distance is  tensor(146.2878, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.3736204877495766
distance x is tensor(125.2547, device='cuda:1')
benign distance is  tensor(125.2547, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6999637074768543
distance x is tensor(108.5737, device='cuda:1')
benign distance is  tensor(108.5737, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7051919437944889
distance x is tensor(88.7966, device='cuda:1')
benign distance is  tensor(88.7966, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.6828580778092146
distance x is tensor(96.4424, device='cuda:1')
benign distance is  tensor(96.4424, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7286434955894947
distance x is tensor(113.4648, device='cuda:1')
benign distance is  tensor(113.4648, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.79400000016
mal_loss is 0.8920074198395014
mal_entropy is 0.20358035154640675
user_PLR len size 36
counter_tensor is  tensor([ 0., 12., 27., 14., 18., 35., 29., 34., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24.,  1., 12., 13., 14., 28., 13., 12., 20.,
        17., 12., 33.,  0.,  0., 28.,  0., 24.])
count_res tensor([4.1809e-16, 6.8046e-11, 2.2244e-04, 5.0280e-10, 2.7452e-08, 6.6310e-01,
        1.6437e-03, 2.4394e-01, 1.1075e-05, 1.1075e-05, 1.1075e-05, 1.1075e-05,
        1.1075e-05, 1.1075e-05, 1.1075e-05, 1.1075e-05, 1.1075e-05, 1.1075e-05,
        1.1075e-05, 1.1075e-05, 1.1365e-15, 6.8046e-11, 1.8497e-10, 5.0280e-10,
        6.0467e-04, 1.8497e-10, 6.8046e-11, 2.0284e-07, 1.0099e-08, 6.8046e-11,
        8.9741e-02, 4.1809e-16, 4.1809e-16, 6.0467e-04, 4.1809e-16, 1.1075e-05])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 90.12% 

Test Accuracy: 87.42% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6144691742956638
distance x is tensor(120.7811, device='cuda:1')
benign distance is  tensor(120.7811, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9297888465225697
distance x is tensor(116.1932, device='cuda:1')
benign distance is  tensor(116.1932, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7189368642866611
distance x is tensor(110.7352, device='cuda:1')
benign distance is  tensor(110.7352, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8270751144737005
distance x is tensor(152.6389, device='cuda:1')
benign distance is  tensor(152.6389, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8581934310495853
distance x is tensor(110.2898, device='cuda:1')
benign distance is  tensor(110.2898, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7064719321206212
distance x is tensor(76.6364, device='cuda:1')
benign distance is  tensor(76.6364, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.062978371977806
distance x is tensor(112.1062, device='cuda:1')
benign distance is  tensor(112.1062, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7513617742806673
distance x is tensor(94.0153, device='cuda:1')
benign distance is  tensor(94.0153, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.01913190074265
distance x is tensor(115.5079, device='cuda:1')
benign distance is  tensor(115.5079, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7277864953503013
distance x is tensor(130.5016, device='cuda:1')
benign distance is  tensor(130.5016, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1966040097177029
distance x is tensor(70.7773, device='cuda:1')
benign distance is  tensor(70.7773, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.1732835099101067
distance x is tensor(120.2866, device='cuda:1')
benign distance is  tensor(120.2866, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0579859465360641
distance x is tensor(164.9184, device='cuda:1')
benign distance is  tensor(164.9184, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7359091881662607
distance x is tensor(64.7687, device='cuda:1')
benign distance is  tensor(64.7687, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.992591742426157
distance x is tensor(154.5046, device='cuda:1')
benign distance is  tensor(154.5046, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.4182298369705677
distance x is tensor(138.3356, device='cuda:1')
benign distance is  tensor(138.3356, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.1624735314399004
distance x is tensor(116.4528, device='cuda:1')
benign distance is  tensor(116.4528, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7841579187661409
distance x is tensor(80.9786, device='cuda:1')
benign distance is  tensor(80.9786, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.937587620690465
distance x is tensor(137.5879, device='cuda:1')
benign distance is  tensor(137.5879, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.3827830776572227
distance x is tensor(118.2165, device='cuda:1')
benign distance is  tensor(118.2165, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8203179240226746
distance x is tensor(138.7127, device='cuda:1')
benign distance is  tensor(138.7127, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8232067581266165
distance x is tensor(115.5697, device='cuda:1')
benign distance is  tensor(115.5697, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5491794431582093
distance x is tensor(127.8448, device='cuda:1')
benign distance is  tensor(127.8448, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6932404907420278
distance x is tensor(173.8769, device='cuda:1')
benign distance is  tensor(173.8769, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.83900000016
mal_loss is 0.8394984896294773
mal_entropy is 0.12252947431989014
user_PLR len size 20
counter_tensor is  tensor([18., 13., 12., 16., 13., 17., 16., 13., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([1.1071e-02, 7.4593e-05, 2.7441e-05, 1.4982e-03, 7.4593e-05, 4.0726e-03,
        1.4982e-03, 7.4593e-05, 8.1801e-02, 8.1801e-02, 8.1801e-02, 8.1801e-02,
        8.1801e-02, 8.1801e-02, 8.1801e-02, 8.1801e-02, 8.1801e-02, 8.1801e-02,
        8.1801e-02, 8.1801e-02])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 92.71% 

Test Accuracy: 85.41% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7893700059503317
distance x is tensor(156.2775, device='cuda:1')
benign distance is  tensor(156.2775, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8301518727093935
distance x is tensor(134.0113, device='cuda:1')
benign distance is  tensor(134.0113, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8105556927621365
distance x is tensor(134.5789, device='cuda:1')
benign distance is  tensor(134.5789, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8408422898501158
distance x is tensor(170.4664, device='cuda:1')
benign distance is  tensor(170.4664, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9769623000174761
distance x is tensor(123.2363, device='cuda:1')
benign distance is  tensor(123.2363, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.951179803814739
distance x is tensor(84.0568, device='cuda:1')
benign distance is  tensor(84.0568, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.387427218258381
distance x is tensor(131.1795, device='cuda:1')
benign distance is  tensor(131.1795, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6698621371760964
distance x is tensor(116.1552, device='cuda:1')
benign distance is  tensor(116.1552, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.62800000016
mal_loss is 5.1048921048641205
mal_entropy is 0.10981215070933104
user_PLR len size 44
counter_tensor is  tensor([43., 38., 42., 32., 43.,  2.,  1.,  2., 12., 12., 12., 12., 12., 12.,
        12., 12., 12., 12., 12., 12., 40., 41., 42., 43., 43., 43.,  6., 34.,
        41., 40., 31., 43.,  0., 43., 39., 31., 39., 43., 28., 43.,  5.,  4.,
        32., 11.])
count_res tensor([9.8527e-02, 6.6387e-04, 3.6246e-02, 1.6456e-06, 9.8527e-02, 1.5399e-19,
        5.6648e-20, 1.5399e-19, 3.3918e-15, 3.3918e-15, 3.3918e-15, 3.3918e-15,
        3.3918e-15, 3.3918e-15, 3.3918e-15, 3.3918e-15, 3.3918e-15, 3.3918e-15,
        3.3918e-15, 3.3918e-15, 4.9054e-03, 1.3334e-02, 3.6246e-02, 9.8527e-02,
        9.8527e-02, 9.8527e-02, 8.4073e-18, 1.2159e-05, 1.3334e-02, 4.9054e-03,
        6.0537e-07, 9.8527e-02, 2.0840e-20, 9.8527e-02, 1.8046e-03, 6.0537e-07,
        1.8046e-03, 9.8527e-02, 3.0140e-08, 9.8527e-02, 3.0929e-18, 1.1378e-18,
        1.6456e-06, 1.2478e-15])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 88.66% 

Test Accuracy: 87.23% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7066184375435114
distance x is tensor(119.3664, device='cuda:1')
benign distance is  tensor(119.3664, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7718724701553583
distance x is tensor(105.1181, device='cuda:1')
benign distance is  tensor(105.1181, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6608976256102324
distance x is tensor(91.4813, device='cuda:1')
benign distance is  tensor(91.4813, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7701077796518803
distance x is tensor(145.4918, device='cuda:1')
benign distance is  tensor(145.4918, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9280125806108117
distance x is tensor(87.8563, device='cuda:1')
benign distance is  tensor(87.8563, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5867244275286794
distance x is tensor(89.1422, device='cuda:1')
benign distance is  tensor(89.1422, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9660291140899062
distance x is tensor(97.6699, device='cuda:1')
benign distance is  tensor(97.6699, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6313752718269825
distance x is tensor(83.5664, device='cuda:1')
benign distance is  tensor(83.5664, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1047502905130386
distance x is tensor(97.7365, device='cuda:1')
benign distance is  tensor(97.7365, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5955745978280902
distance x is tensor(108.0488, device='cuda:1')
benign distance is  tensor(108.0488, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0978784710168839
distance x is tensor(60.7333, device='cuda:1')
benign distance is  tensor(60.7333, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.5071248039603233
distance x is tensor(113.0608, device='cuda:1')
benign distance is  tensor(113.0608, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.946056941524148
distance x is tensor(159.7447, device='cuda:1')
benign distance is  tensor(159.7447, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8964151348918676
distance x is tensor(59.0973, device='cuda:1')
benign distance is  tensor(59.0973, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8059244807809591
distance x is tensor(125.4513, device='cuda:1')
benign distance is  tensor(125.4513, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0451619885861874
distance x is tensor(115.2800, device='cuda:1')
benign distance is  tensor(115.2800, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.0481858253479004
distance x is tensor(94.2214, device='cuda:1')
benign distance is  tensor(94.2214, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.719596728682518
distance x is tensor(108.1920, device='cuda:1')
benign distance is  tensor(108.1920, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9503585901111364
distance x is tensor(120.1079, device='cuda:1')
benign distance is  tensor(120.1079, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8074481803923845
distance x is tensor(105.1682, device='cuda:1')
benign distance is  tensor(105.1682, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9709568619728088
distance x is tensor(72.8934, device='cuda:1')
benign distance is  tensor(72.8934, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7793873026967049
distance x is tensor(201.6310, device='cuda:1')
benign distance is  tensor(201.6310, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0650072079151869
distance x is tensor(135.5330, device='cuda:1')
benign distance is  tensor(135.5330, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7140753399580717
distance x is tensor(105.2353, device='cuda:1')
benign distance is  tensor(105.2353, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.0140533093363047
distance x is tensor(93.7973, device='cuda:1')
benign distance is  tensor(93.7973, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.0317223891615868
distance x is tensor(131.1650, device='cuda:1')
benign distance is  tensor(131.1650, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.367748636752367
distance x is tensor(139.4308, device='cuda:1')
benign distance is  tensor(139.4308, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.9463349338620901
distance x is tensor(77.8302, device='cuda:1')
benign distance is  tensor(77.8302, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5960563533008099
distance x is tensor(146.3294, device='cuda:1')
benign distance is  tensor(146.3294, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7774801719933748
distance x is tensor(130.3751, device='cuda:1')
benign distance is  tensor(130.3751, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.784362306818366
distance x is tensor(88.9126, device='cuda:1')
benign distance is  tensor(88.9126, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5694662733003497
distance x is tensor(126.5637, device='cuda:1')
benign distance is  tensor(126.5637, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.85300000016
mal_loss is 0.4704739795997739
mal_entropy is 0.2216734206303954
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 92.50% 

Test Accuracy: 85.78% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7442597802728415
distance x is tensor(122.6191, device='cuda:1')
benign distance is  tensor(122.6191, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.821819644421339
distance x is tensor(115.5670, device='cuda:1')
benign distance is  tensor(115.5670, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.601155168376863
distance x is tensor(106.9510, device='cuda:1')
benign distance is  tensor(106.9510, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8313166238367558
distance x is tensor(158.7406, device='cuda:1')
benign distance is  tensor(158.7406, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.972105847671628
distance x is tensor(87.5305, device='cuda:1')
benign distance is  tensor(87.5305, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7305431831628084
distance x is tensor(101.6140, device='cuda:1')
benign distance is  tensor(101.6140, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3408802598714828
distance x is tensor(104.1456, device='cuda:1')
benign distance is  tensor(104.1456, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7510746661573648
distance x is tensor(98.5655, device='cuda:1')
benign distance is  tensor(98.5655, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.64100000016
mal_loss is 2.4354443103075027
mal_entropy is 0.27987602818757296
user_PLR len size 44
counter_tensor is  tensor([ 0.,  0., 38., 34., 20., 39., 42., 42., 28., 28., 28., 28., 28., 28.,
        28., 28., 28., 28., 28., 28., 29., 42., 40., 42., 43., 32., 32.,  0.,
        41., 19., 35.,  0., 32.,  0., 13., 32., 11., 39., 33., 43.,  0., 40.,
         0., 33.])
count_res tensor([5.6397e-20, 5.6397e-20, 1.7966e-03, 3.2906e-05, 2.7362e-11, 4.8836e-03,
        9.8090e-02, 9.8090e-02, 8.1565e-08, 8.1565e-08, 8.1565e-08, 8.1565e-08,
        8.1565e-08, 8.1565e-08, 8.1565e-08, 8.1565e-08, 8.1565e-08, 8.1565e-08,
        8.1565e-08, 8.1565e-08, 2.2172e-07, 9.8090e-02, 1.3275e-02, 9.8090e-02,
        2.6664e-01, 4.4533e-06, 4.4533e-06, 5.6397e-20, 3.6085e-02, 1.0066e-11,
        8.9447e-05, 5.6397e-20, 4.4533e-06, 5.6397e-20, 2.4951e-14, 4.4533e-06,
        3.3767e-15, 4.8836e-03, 1.2105e-05, 2.6664e-01, 5.6397e-20, 1.3275e-02,
        5.6397e-20, 1.2105e-05])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 88.91% 

Test Accuracy: 86.19% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7609185110777617
distance x is tensor(121.7148, device='cuda:1')
benign distance is  tensor(121.7148, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6956727411597967
distance x is tensor(105.1705, device='cuda:1')
benign distance is  tensor(105.1705, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6292015668004751
distance x is tensor(102.8541, device='cuda:1')
benign distance is  tensor(102.8541, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9104070141911507
distance x is tensor(149.6756, device='cuda:1')
benign distance is  tensor(149.6756, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9284388432279229
distance x is tensor(92.9781, device='cuda:1')
benign distance is  tensor(92.9781, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6739351190626621
distance x is tensor(98.0731, device='cuda:1')
benign distance is  tensor(98.0731, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8907150141894817
distance x is tensor(98.1014, device='cuda:1')
benign distance is  tensor(98.1014, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6499438770115376
distance x is tensor(89.4468, device='cuda:1')
benign distance is  tensor(89.4468, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8971185199916363
distance x is tensor(105.9641, device='cuda:1')
benign distance is  tensor(105.9641, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.618350719101727
distance x is tensor(121.4417, device='cuda:1')
benign distance is  tensor(121.4417, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.001175595447421
distance x is tensor(69.3996, device='cuda:1')
benign distance is  tensor(69.3996, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0442831069231033
distance x is tensor(95.1721, device='cuda:1')
benign distance is  tensor(95.1721, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9022814221680164
distance x is tensor(177.5511, device='cuda:1')
benign distance is  tensor(177.5511, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6902268407866359
distance x is tensor(66.4314, device='cuda:1')
benign distance is  tensor(66.4314, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8933113599196076
distance x is tensor(133.3148, device='cuda:1')
benign distance is  tensor(133.3148, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.5507165230810642
distance x is tensor(131.4029, device='cuda:1')
benign distance is  tensor(131.4029, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.7699042558670044
distance x is tensor(112.5490, device='cuda:1')
benign distance is  tensor(112.5490, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5007255552336574
distance x is tensor(85.3265, device='cuda:1')
benign distance is  tensor(85.3265, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9291261918842793
distance x is tensor(120.6680, device='cuda:1')
benign distance is  tensor(120.6680, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.0478620436042547
distance x is tensor(106.3309, device='cuda:1')
benign distance is  tensor(106.3309, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6560708545148373
distance x is tensor(111.0559, device='cuda:1')
benign distance is  tensor(111.0559, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7710980959236622
distance x is tensor(104.7481, device='cuda:1')
benign distance is  tensor(104.7481, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.49128011986613274
distance x is tensor(109.1641, device='cuda:1')
benign distance is  tensor(109.1641, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7254768759012222
distance x is tensor(157.7511, device='cuda:1')
benign distance is  tensor(157.7511, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8471402525901794
distance x is tensor(115.9832, device='cuda:1')
benign distance is  tensor(115.9832, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.7123504690825939
distance x is tensor(89.1536, device='cuda:1')
benign distance is  tensor(89.1536, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6156430970877409
distance x is tensor(141.5743, device='cuda:1')
benign distance is  tensor(141.5743, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.2913143895566463
distance x is tensor(121.2019, device='cuda:1')
benign distance is  tensor(121.2019, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9061652347445488
distance x is tensor(97.6563, device='cuda:1')
benign distance is  tensor(97.6563, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8317863764241338
distance x is tensor(92.1143, device='cuda:1')
benign distance is  tensor(92.1143, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.669917419552803
distance x is tensor(90.7820, device='cuda:1')
benign distance is  tensor(90.7820, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.6570673733949661
distance x is tensor(113.0886, device='cuda:1')
benign distance is  tensor(113.0886, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.81400000016
mal_loss is 0.8941867034882307
mal_entropy is 0.16081910068169236
user_PLR len size 28
counter_tensor is  tensor([17., 27., 16., 15., 14., 27.,  6., 14., 15., 15., 15., 15., 15., 15.,
        15., 15., 15., 15., 15., 15., 18., 16., 26., 15., 16., 26., 25., 27.])
count_res tensor([1.1727e-05, 2.5830e-01, 4.3141e-06, 1.5871e-06, 5.8385e-07, 2.5830e-01,
        1.9586e-10, 5.8385e-07, 1.5871e-06, 1.5871e-06, 1.5871e-06, 1.5871e-06,
        1.5871e-06, 1.5871e-06, 1.5871e-06, 1.5871e-06, 1.5871e-06, 1.5871e-06,
        1.5871e-06, 1.5871e-06, 3.1877e-05, 4.3141e-06, 9.5025e-02, 1.5871e-06,
        4.3141e-06, 9.5025e-02, 3.4958e-02, 2.5830e-01])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 86.39% 

Test Accuracy: 86.97% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7355123665183783
distance x is tensor(120.5213, device='cuda:1')
benign distance is  tensor(120.5213, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9051040802150965
distance x is tensor(99.4600, device='cuda:1')
benign distance is  tensor(99.4600, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.777507621794939
distance x is tensor(102.8637, device='cuda:1')
benign distance is  tensor(102.8637, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9152435436844826
distance x is tensor(144.0147, device='cuda:1')
benign distance is  tensor(144.0147, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.858234066516161
distance x is tensor(90.3683, device='cuda:1')
benign distance is  tensor(90.3683, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.79013064596802
distance x is tensor(99.3497, device='cuda:1')
benign distance is  tensor(99.3497, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1685504615306854
distance x is tensor(105.1450, device='cuda:1')
benign distance is  tensor(105.1450, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7232121042907238
distance x is tensor(98.1540, device='cuda:1')
benign distance is  tensor(98.1540, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.2765205316245556
distance x is tensor(109.6154, device='cuda:1')
benign distance is  tensor(109.6154, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7784397732466459
distance x is tensor(117.1364, device='cuda:1')
benign distance is  tensor(117.1364, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9709515180438757
distance x is tensor(132.1384, device='cuda:1')
benign distance is  tensor(132.1384, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8415260426700115
distance x is tensor(109.2051, device='cuda:1')
benign distance is  tensor(109.2051, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9982223715633154
distance x is tensor(87.5346, device='cuda:1')
benign distance is  tensor(87.5346, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9374884087592363
distance x is tensor(213.7504, device='cuda:1')
benign distance is  tensor(213.7504, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0629598554223776
distance x is tensor(139.5092, device='cuda:1')
benign distance is  tensor(139.5092, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7784111723303795
distance x is tensor(109.4255, device='cuda:1')
benign distance is  tensor(109.4255, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.82700000016
mal_loss is 0.77231967728585
mal_entropy is 0.16016532946377993
user_PLR len size 28
counter_tensor is  tensor([13., 12., 23., 12., 14., 27., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 13., 12., 13., 12., 14.,  0., 12.])
count_res tensor([4.1195e-07, 1.5155e-07, 9.0738e-03, 1.5155e-07, 1.1198e-06, 4.9541e-01,
        1.5155e-07, 1.5155e-07, 8.2742e-06, 8.2742e-06, 8.2742e-06, 8.2742e-06,
        8.2742e-06, 8.2742e-06, 8.2742e-06, 8.2742e-06, 8.2742e-06, 8.2742e-06,
        8.2742e-06, 8.2742e-06, 4.9541e-01, 4.1195e-07, 1.5155e-07, 4.1195e-07,
        1.5155e-07, 1.1198e-06, 9.3114e-13, 1.5155e-07])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 82.16% 

Test Accuracy: 85.22% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9113767929375172
distance x is tensor(127.6212, device='cuda:1')
benign distance is  tensor(127.6212, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.841556079685688
distance x is tensor(115.7984, device='cuda:1')
benign distance is  tensor(115.7984, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6607236098498106
distance x is tensor(110.4022, device='cuda:1')
benign distance is  tensor(110.4022, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8878720309585333
distance x is tensor(153.9037, device='cuda:1')
benign distance is  tensor(153.9037, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.007961094379425
distance x is tensor(97.4164, device='cuda:1')
benign distance is  tensor(97.4164, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7990015419200063
distance x is tensor(90.7839, device='cuda:1')
benign distance is  tensor(90.7839, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2260575536638498
distance x is tensor(107.2026, device='cuda:1')
benign distance is  tensor(107.2026, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7343455674126744
distance x is tensor(100.2356, device='cuda:1')
benign distance is  tensor(100.2356, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9483619779348373
distance x is tensor(104.3718, device='cuda:1')
benign distance is  tensor(104.3718, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8384182658046484
distance x is tensor(133.3523, device='cuda:1')
benign distance is  tensor(133.3523, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0282312240451574
distance x is tensor(87.5244, device='cuda:1')
benign distance is  tensor(87.5244, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4354014918208122
distance x is tensor(107.1160, device='cuda:1')
benign distance is  tensor(107.1160, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.4485082179307938
distance x is tensor(167.7763, device='cuda:1')
benign distance is  tensor(167.7763, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7925489246845245
distance x is tensor(74.3597, device='cuda:1')
benign distance is  tensor(74.3597, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0450004991143942
distance x is tensor(142.2102, device='cuda:1')
benign distance is  tensor(142.2102, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9840222708880901
distance x is tensor(137.5536, device='cuda:1')
benign distance is  tensor(137.5536, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8030000001600001
mal_loss is 1.1715340968221426
mal_entropy is 0.1399488770402968
user_PLR len size 20
counter_tensor is  tensor([19., 19., 19., 19., 12., 15., 17., 14., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7188e-02, 2.7188e-02, 2.7188e-02, 2.7188e-02, 2.4792e-05, 4.9797e-04,
        3.6795e-03, 1.8319e-04, 7.3905e-02, 7.3905e-02, 7.3905e-02, 7.3905e-02,
        7.3905e-02, 7.3905e-02, 7.3905e-02, 7.3905e-02, 7.3905e-02, 7.3905e-02,
        7.3905e-02, 7.3905e-02])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 83.65% 

Test Accuracy: 81.67% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8047332800924778
distance x is tensor(157.4230, device='cuda:1')
benign distance is  tensor(157.4230, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8600791469216347
distance x is tensor(126.5660, device='cuda:1')
benign distance is  tensor(126.5660, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.778098501265049
distance x is tensor(134.4410, device='cuda:1')
benign distance is  tensor(134.4410, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8701752219349146
distance x is tensor(170.8398, device='cuda:1')
benign distance is  tensor(170.8398, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2966835796833038
distance x is tensor(127.1168, device='cuda:1')
benign distance is  tensor(127.1168, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9751190324313939
distance x is tensor(101.6094, device='cuda:1')
benign distance is  tensor(101.6094, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4437334388494492
distance x is tensor(127.5793, device='cuda:1')
benign distance is  tensor(127.5793, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7756221350282431
distance x is tensor(125.6018, device='cuda:1')
benign distance is  tensor(125.6018, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.5530000001600001
mal_loss is 7.272600620985031
mal_entropy is 0.1191216385923326
user_PLR len size 52
counter_tensor is  tensor([29., 45., 49., 51., 13., 44., 23., 33., 18., 18., 18., 18., 18., 18.,
        18., 18., 18., 18., 18., 18., 46., 51., 14., 48., 45.,  3., 20.,  1.,
        48., 38., 49., 38., 47., 51., 49., 46., 49., 42., 51., 42.,  2., 50.,
         0.,  2., 27., 34.,  6., 45., 39.,  6.,  9., 40.])
count_res tensor([5.5246e-11, 4.9092e-04, 2.6803e-02, 1.9805e-01, 6.2171e-18, 1.8060e-04,
        1.3694e-13, 3.0163e-09, 9.2270e-16, 9.2270e-16, 9.2270e-16, 9.2270e-16,
        9.2270e-16, 9.2270e-16, 9.2270e-16, 9.2270e-16, 9.2270e-16, 9.2270e-16,
        9.2270e-16, 9.2270e-16, 1.3345e-03, 1.9805e-01, 1.6900e-17, 9.8604e-03,
        4.9092e-04, 2.8225e-22, 6.8179e-15, 3.8199e-23, 9.8604e-03, 4.4766e-07,
        2.6803e-02, 4.4766e-07, 3.6274e-03, 1.9805e-01, 2.6803e-02, 1.3345e-03,
        2.6803e-02, 2.4441e-05, 1.9805e-01, 2.4441e-05, 1.0384e-22, 7.2859e-02,
        1.4053e-23, 1.0384e-22, 7.4767e-12, 8.1992e-09, 5.6692e-21, 4.9092e-04,
        1.2169e-06, 5.6692e-21, 1.1387e-19, 3.3078e-06])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 83.67% 

Test Accuracy: 85.78% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7064473889768124
distance x is tensor(124.4741, device='cuda:1')
benign distance is  tensor(124.4741, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9070449881255627
distance x is tensor(108.5337, device='cuda:1')
benign distance is  tensor(108.5337, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7317824512720108
distance x is tensor(92.2388, device='cuda:1')
benign distance is  tensor(92.2388, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.071190718561411
distance x is tensor(136.3393, device='cuda:1')
benign distance is  tensor(136.3393, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9754286799579859
distance x is tensor(76.4958, device='cuda:1')
benign distance is  tensor(76.4958, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6606809450313449
distance x is tensor(89.2055, device='cuda:1')
benign distance is  tensor(89.2055, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0771761992946267
distance x is tensor(89.8287, device='cuda:1')
benign distance is  tensor(89.8287, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.723621217533946
distance x is tensor(89.7553, device='cuda:1')
benign distance is  tensor(89.7553, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8000511508435011
distance x is tensor(98.9137, device='cuda:1')
benign distance is  tensor(98.9137, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8317884458228946
distance x is tensor(117.9148, device='cuda:1')
benign distance is  tensor(117.9148, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0384635888040066
distance x is tensor(69.6680, device='cuda:1')
benign distance is  tensor(69.6680, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0988681521266699
distance x is tensor(95.4188, device='cuda:1')
benign distance is  tensor(95.4188, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9210211560130119
distance x is tensor(164.9783, device='cuda:1')
benign distance is  tensor(164.9783, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6826387168839574
distance x is tensor(62.3282, device='cuda:1')
benign distance is  tensor(62.3282, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8897729199379683
distance x is tensor(134.1708, device='cuda:1')
benign distance is  tensor(134.1708, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.5507532618939877
distance x is tensor(118.8563, device='cuda:1')
benign distance is  tensor(118.8563, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.0929203666746616
distance x is tensor(94.1694, device='cuda:1')
benign distance is  tensor(94.1694, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7194371111690998
distance x is tensor(110.3785, device='cuda:1')
benign distance is  tensor(110.3785, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8842763584107161
distance x is tensor(112.9150, device='cuda:1')
benign distance is  tensor(112.9150, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7924148179590702
distance x is tensor(120.1618, device='cuda:1')
benign distance is  tensor(120.1618, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9103308878839016
distance x is tensor(68.0256, device='cuda:1')
benign distance is  tensor(68.0256, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8364771325141191
distance x is tensor(197.8705, device='cuda:1')
benign distance is  tensor(197.8705, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.2565734721720219
distance x is tensor(131.1791, device='cuda:1')
benign distance is  tensor(131.1791, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6605896633118391
distance x is tensor(116.3984, device='cuda:1')
benign distance is  tensor(116.3984, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.0575903039425611
distance x is tensor(112.6697, device='cuda:1')
benign distance is  tensor(112.6697, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.733235415071249
distance x is tensor(82.9781, device='cuda:1')
benign distance is  tensor(82.9781, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9701105542480946
distance x is tensor(128.1979, device='cuda:1')
benign distance is  tensor(128.1979, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.1877890657633543
distance x is tensor(109.4806, device='cuda:1')
benign distance is  tensor(109.4806, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7928157038986683
distance x is tensor(109.1187, device='cuda:1')
benign distance is  tensor(109.1187, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7517997864633799
distance x is tensor(89.7647, device='cuda:1')
benign distance is  tensor(89.7647, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5166401695460081
distance x is tensor(117.8219, device='cuda:1')
benign distance is  tensor(117.8219, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7335856687277555
distance x is tensor(159.3311, device='cuda:1')
benign distance is  tensor(159.3311, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.3538677506148815
distance x is tensor(116.9023, device='cuda:1')
benign distance is  tensor(116.9023, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.2158469781279564
distance x is tensor(183.5735, device='cuda:1')
benign distance is  tensor(183.5735, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.9973622672259808
distance x is tensor(133.5997, device='cuda:1')
benign distance is  tensor(133.5997, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.9050178788602352
distance x is tensor(85.3248, device='cuda:1')
benign distance is  tensor(85.3248, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6565046263858676
distance x is tensor(151.4780, device='cuda:1')
benign distance is  tensor(151.4780, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.9844245687127113
distance x is tensor(123.3031, device='cuda:1')
benign distance is  tensor(123.3031, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.816616477444768
distance x is tensor(95.0639, device='cuda:1')
benign distance is  tensor(95.0639, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5474010426551104
distance x is tensor(132.5181, device='cuda:1')
benign distance is  tensor(132.5181, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.82700000016
mal_loss is 0.7195776496082544
mal_entropy is 0.20218335092067719
user_PLR len size 28
counter_tensor is  tensor([18., 19., 26., 18., 15., 14., 19., 14., 14., 14., 14., 14., 14., 14.,
        14., 14., 14., 14., 14., 14., 14., 17., 17., 19., 27., 16., 27., 17.])
count_res tensor([5.2086e-05, 1.4159e-04, 1.5527e-01, 5.2086e-05, 2.5932e-06, 9.5400e-07,
        1.4159e-04, 9.5400e-07, 9.5400e-07, 9.5400e-07, 9.5400e-07, 9.5400e-07,
        9.5400e-07, 9.5400e-07, 9.5400e-07, 9.5400e-07, 9.5400e-07, 9.5400e-07,
        9.5400e-07, 9.5400e-07, 9.5400e-07, 1.9162e-05, 1.9162e-05, 1.4159e-04,
        4.2206e-01, 7.0491e-06, 4.2206e-01, 1.9162e-05])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 88.71% 

Test Accuracy: 86.08% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7153551429510117
distance x is tensor(120.9767, device='cuda:1')
benign distance is  tensor(120.9767, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8663363829255104
distance x is tensor(117.2616, device='cuda:1')
benign distance is  tensor(117.2616, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8033596780151129
distance x is tensor(102.6565, device='cuda:1')
benign distance is  tensor(102.6565, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9052643403410912
distance x is tensor(159.2132, device='cuda:1')
benign distance is  tensor(159.2132, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.148140149191022
distance x is tensor(89.9924, device='cuda:1')
benign distance is  tensor(89.9924, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6353868972510099
distance x is tensor(106.4987, device='cuda:1')
benign distance is  tensor(106.4987, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3827457390725613
distance x is tensor(96.5914, device='cuda:1')
benign distance is  tensor(96.5914, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.668018126860261
distance x is tensor(89.7220, device='cuda:1')
benign distance is  tensor(89.7220, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8303602803498507
distance x is tensor(114.5841, device='cuda:1')
benign distance is  tensor(114.5841, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.9248676132410765
distance x is tensor(100.4752, device='cuda:1')
benign distance is  tensor(100.4752, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6062752120196819
distance x is tensor(152.7283, device='cuda:1')
benign distance is  tensor(152.7283, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.2942001856863499
distance x is tensor(128.8546, device='cuda:1')
benign distance is  tensor(128.8546, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6923135416582227
distance x is tensor(96.2121, device='cuda:1')
benign distance is  tensor(96.2121, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8553818445652723
distance x is tensor(92.0398, device='cuda:1')
benign distance is  tensor(92.0398, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.8256007889285684
distance x is tensor(80.8340, device='cuda:1')
benign distance is  tensor(80.8340, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7736654784530401
distance x is tensor(122.2411, device='cuda:1')
benign distance is  tensor(122.2411, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.81600000016
mal_loss is 0.8543947255238891
mal_entropy is 0.15596950286999345
user_PLR len size 28
counter_tensor is  tensor([12., 24., 14., 12., 12.,  0., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 15., 16., 24., 12., 12., 27., 12., 12.])
count_res tensor([2.7814e-07, 4.5269e-02, 2.0552e-06, 2.7814e-07, 2.7814e-07, 1.7090e-12,
        2.7814e-07, 2.7814e-07, 1.5186e-05, 1.5186e-05, 1.5186e-05, 1.5186e-05,
        1.5186e-05, 1.5186e-05, 1.5186e-05, 1.5186e-05, 1.5186e-05, 1.5186e-05,
        1.5186e-05, 1.5186e-05, 5.5867e-06, 1.5186e-05, 4.5269e-02, 2.7814e-07,
        2.7814e-07, 9.0925e-01, 2.7814e-07, 2.7814e-07])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 83.23% 

Test Accuracy: 84.67% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6783093381673098
distance x is tensor(129.9283, device='cuda:1')
benign distance is  tensor(129.9283, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8002014895901084
distance x is tensor(102.4379, device='cuda:1')
benign distance is  tensor(102.4379, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7070695133879781
distance x is tensor(124.6069, device='cuda:1')
benign distance is  tensor(124.6069, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8763432968407869
distance x is tensor(151.2499, device='cuda:1')
benign distance is  tensor(151.2499, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0597904175519943
distance x is tensor(101.1101, device='cuda:1')
benign distance is  tensor(101.1101, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8758149249479175
distance x is tensor(99.5070, device='cuda:1')
benign distance is  tensor(99.5070, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1501133423298597
distance x is tensor(109.5884, device='cuda:1')
benign distance is  tensor(109.5884, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6704658754169941
distance x is tensor(91.0217, device='cuda:1')
benign distance is  tensor(91.0217, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.013005031272769
distance x is tensor(104.1703, device='cuda:1')
benign distance is  tensor(104.1703, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7596393143758178
distance x is tensor(120.6550, device='cuda:1')
benign distance is  tensor(120.6550, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0557663813233376
distance x is tensor(68.1279, device='cuda:1')
benign distance is  tensor(68.1279, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4764269813895226
distance x is tensor(101.3811, device='cuda:1')
benign distance is  tensor(101.3811, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.154048878699541
distance x is tensor(186.6083, device='cuda:1')
benign distance is  tensor(186.6083, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8229074850678444
distance x is tensor(31.1328, device='cuda:1')
benign distance is  tensor(31.1328, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8901480790227652
distance x is tensor(145.8168, device='cuda:1')
benign distance is  tensor(145.8168, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.5065847039222717
distance x is tensor(137.9207, device='cuda:1')
benign distance is  tensor(137.9207, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.78000000016
mal_loss is 1.4911789447069168
mal_entropy is 0.11569379502907395
user_PLR len size 28
counter_tensor is  tensor([13., 12., 27., 14., 21., 24.,  0., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 13., 12., 16., 18., 13., 12., 12., 12.])
count_res tensor([7.8997e-07, 2.9061e-07, 9.5002e-01, 2.1474e-06, 2.3549e-03, 4.7299e-02,
        1.7856e-12, 2.9061e-07, 1.5867e-05, 1.5867e-05, 1.5867e-05, 1.5867e-05,
        1.5867e-05, 1.5867e-05, 1.5867e-05, 1.5867e-05, 1.5867e-05, 1.5867e-05,
        1.5867e-05, 1.5867e-05, 7.8997e-07, 2.9061e-07, 1.5867e-05, 1.1724e-04,
        7.8997e-07, 2.9061e-07, 2.9061e-07, 2.9061e-07])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 85.24% 

Test Accuracy: 83.49% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5755820516496897
distance x is tensor(131.8542, device='cuda:1')
benign distance is  tensor(131.8542, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9593487977981567
distance x is tensor(113.4568, device='cuda:1')
benign distance is  tensor(113.4568, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7935695089399815
distance x is tensor(67.6683, device='cuda:1')
benign distance is  tensor(67.6683, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0668895840644836
distance x is tensor(160.0239, device='cuda:1')
benign distance is  tensor(160.0239, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0334270875900984
distance x is tensor(105.3489, device='cuda:1')
benign distance is  tensor(105.3489, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8658693549223244
distance x is tensor(115.0854, device='cuda:1')
benign distance is  tensor(115.0854, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4286545645445585
distance x is tensor(111.2020, device='cuda:1')
benign distance is  tensor(111.2020, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.893958268687129
distance x is tensor(105.8235, device='cuda:1')
benign distance is  tensor(105.8235, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.4017606303095818
distance x is tensor(141.9643, device='cuda:1')
benign distance is  tensor(141.9643, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8432725314050913
distance x is tensor(129.3437, device='cuda:1')
benign distance is  tensor(129.3437, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.0153081864118576
distance x is tensor(124.0792, device='cuda:1')
benign distance is  tensor(124.0792, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.028119582682848
distance x is tensor(127.1905, device='cuda:1')
benign distance is  tensor(127.1905, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9672954063862562
distance x is tensor(85.6586, device='cuda:1')
benign distance is  tensor(85.6586, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.736360059119761
distance x is tensor(214.7650, device='cuda:1')
benign distance is  tensor(214.7650, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.3347870148718357
distance x is tensor(156.5407, device='cuda:1')
benign distance is  tensor(156.5407, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7070262497290969
distance x is tensor(117.8438, device='cuda:1')
benign distance is  tensor(117.8438, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.70700000016
mal_loss is 1.470419704914093
mal_entropy is 0.20408980455249548
user_PLR len size 36
counter_tensor is  tensor([13., 17., 14., 13.,  2.,  0., 14., 31., 22., 22., 22., 22., 22., 22.,
        22., 22., 22., 22., 22., 22., 14., 33., 24., 16., 35., 21., 15.,  1.,
        14., 35., 33., 15.,  1., 34., 14., 17.])
count_res tensor([1.0499e-10, 5.7322e-09, 2.8539e-10, 1.0499e-10, 1.7535e-15, 2.3731e-16,
        2.8539e-10, 6.8936e-03, 8.5074e-07, 8.5074e-07, 8.5074e-07, 8.5074e-07,
        8.5074e-07, 8.5074e-07, 8.5074e-07, 8.5074e-07, 8.5074e-07, 8.5074e-07,
        8.5074e-07, 8.5074e-07, 2.8539e-10, 5.0937e-02, 6.2861e-06, 2.1088e-09,
        3.7638e-01, 3.1297e-07, 7.7577e-10, 6.4508e-16, 2.8539e-10, 3.7638e-01,
        5.0937e-02, 7.7577e-10, 6.4508e-16, 1.3846e-01, 2.8539e-10, 5.7322e-09])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 82.40% 

Test Accuracy: 85.07% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6597830690443516
distance x is tensor(118.6335, device='cuda:1')
benign distance is  tensor(118.6335, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8979604877531528
distance x is tensor(112.0201, device='cuda:1')
benign distance is  tensor(112.0201, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7421619221568108
distance x is tensor(116.6722, device='cuda:1')
benign distance is  tensor(116.6722, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.995283205062151
distance x is tensor(158.9645, device='cuda:1')
benign distance is  tensor(158.9645, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9951004423201084
distance x is tensor(90.2810, device='cuda:1')
benign distance is  tensor(90.2810, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7475650762207806
distance x is tensor(98.1643, device='cuda:1')
benign distance is  tensor(98.1643, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1471216902136803
distance x is tensor(101.6051, device='cuda:1')
benign distance is  tensor(101.6051, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8320651212707162
distance x is tensor(99.2483, device='cuda:1')
benign distance is  tensor(99.2483, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8593420563265681
distance x is tensor(115.8248, device='cuda:1')
benign distance is  tensor(115.8248, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7724829213693738
distance x is tensor(86.6238, device='cuda:1')
benign distance is  tensor(86.6238, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9889630638062954
distance x is tensor(65.2217, device='cuda:1')
benign distance is  tensor(65.2217, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2685355357825756
distance x is tensor(118.6871, device='cuda:1')
benign distance is  tensor(118.6871, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.191993709653616
distance x is tensor(168.4944, device='cuda:1')
benign distance is  tensor(168.4944, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6564915720373392
distance x is tensor(52.1992, device='cuda:1')
benign distance is  tensor(52.1992, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1235581450164318
distance x is tensor(149.1013, device='cuda:1')
benign distance is  tensor(149.1013, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.524658601731062
distance x is tensor(145.2095, device='cuda:1')
benign distance is  tensor(145.2095, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.098044654354453
distance x is tensor(105.8554, device='cuda:1')
benign distance is  tensor(105.8554, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7652132604271173
distance x is tensor(88.4242, device='cuda:1')
benign distance is  tensor(88.4242, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.1313914693892002
distance x is tensor(127.9997, device='cuda:1')
benign distance is  tensor(127.9997, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2325350865721703
distance x is tensor(112.4732, device='cuda:1')
benign distance is  tensor(112.4732, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9067101608961821
distance x is tensor(101.8757, device='cuda:1')
benign distance is  tensor(101.8757, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9678471684455872
distance x is tensor(93.9191, device='cuda:1')
benign distance is  tensor(93.9191, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.535851962864399
distance x is tensor(118.5935, device='cuda:1')
benign distance is  tensor(118.5935, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7009682804346085
distance x is tensor(168.0453, device='cuda:1')
benign distance is  tensor(168.0453, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.76500000016
mal_loss is 1.2124786581844091
mal_entropy is 0.19705050718039274
user_PLR len size 20
counter_tensor is  tensor([19., 19., 14., 14., 12., 13., 14., 13., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.8864e-02, 2.8864e-02, 1.9448e-04, 1.9448e-04, 2.6320e-05, 7.1546e-05,
        1.9448e-04, 7.1546e-05, 7.8460e-02, 7.8460e-02, 7.8460e-02, 7.8460e-02,
        7.8460e-02, 7.8460e-02, 7.8460e-02, 7.8460e-02, 7.8460e-02, 7.8460e-02,
        7.8460e-02, 7.8460e-02])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 85.20% 

Test Accuracy: 80.22% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7854744028300047
distance x is tensor(164.5262, device='cuda:1')
benign distance is  tensor(164.5262, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1237988509237766
distance x is tensor(140.8710, device='cuda:1')
benign distance is  tensor(140.8710, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.846623869612813
distance x is tensor(132.7464, device='cuda:1')
benign distance is  tensor(132.7464, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.089834662154317
distance x is tensor(165.1501, device='cuda:1')
benign distance is  tensor(165.1501, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.082704758271575
distance x is tensor(127.4383, device='cuda:1')
benign distance is  tensor(127.4383, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8860462494194508
distance x is tensor(117.7606, device='cuda:1')
benign distance is  tensor(117.7606, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2604830544441938
distance x is tensor(133.6478, device='cuda:1')
benign distance is  tensor(133.6478, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7964292895048857
distance x is tensor(118.9531, device='cuda:1')
benign distance is  tensor(118.9531, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.4060000001600001
mal_loss is 11.102176010608673
mal_entropy is 0.11274001328274608
user_PLR len size 52
counter_tensor is  tensor([14., 47., 30., 15., 47., 45., 32., 48.,  8.,  8.,  8.,  8.,  8.,  8.,
         8.,  8.,  8.,  8.,  8.,  8., 51., 27., 50., 51., 27., 43.,  2., 51.,
        43., 51., 50.,  4., 46., 50., 49.,  0., 11., 48., 35., 48.,  9.,  5.,
         1., 46., 51.,  0., 44., 51., 43., 51.,  1., 51.])
count_res tensor([9.0365e-18, 1.9396e-03, 8.0300e-11, 2.4564e-17, 1.9396e-03, 2.6250e-04,
        5.9334e-10, 5.2725e-03, 2.2399e-20, 2.2399e-20, 2.2399e-20, 2.2399e-20,
        2.2399e-20, 2.2399e-20, 2.2399e-20, 2.2399e-20, 2.2399e-20, 2.2399e-20,
        2.2399e-20, 2.2399e-20, 1.0590e-01, 3.9979e-12, 3.8959e-02, 1.0590e-01,
        3.9979e-12, 3.5526e-05, 5.5522e-23, 1.0590e-01, 3.5526e-05, 1.0590e-01,
        3.8959e-02, 4.1026e-22, 7.1355e-04, 3.8959e-02, 1.4332e-02, 7.5141e-24,
        4.4990e-19, 5.2725e-03, 1.1918e-08, 5.2725e-03, 6.0888e-20, 1.1152e-21,
        2.0426e-23, 7.1355e-04, 1.0590e-01, 7.5141e-24, 9.6569e-05, 1.0590e-01,
        3.5526e-05, 1.0590e-01, 2.0426e-23, 1.0590e-01])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 85.62% 

Test Accuracy: 87.33% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7307754084467888
distance x is tensor(124.9739, device='cuda:1')
benign distance is  tensor(124.9739, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9046678058803082
distance x is tensor(99.2860, device='cuda:1')
benign distance is  tensor(99.2860, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7157889157533646
distance x is tensor(101.8451, device='cuda:1')
benign distance is  tensor(101.8451, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9150043949484825
distance x is tensor(145.4069, device='cuda:1')
benign distance is  tensor(145.4069, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9798524100333452
distance x is tensor(84.7747, device='cuda:1')
benign distance is  tensor(84.7747, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7856886861845851
distance x is tensor(90.9513, device='cuda:1')
benign distance is  tensor(90.9513, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.140386164188385
distance x is tensor(106.5126, device='cuda:1')
benign distance is  tensor(106.5126, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6619394207373261
distance x is tensor(85.8137, device='cuda:1')
benign distance is  tensor(85.8137, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.2342836372554302
distance x is tensor(97.0669, device='cuda:1')
benign distance is  tensor(97.0669, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6438348749652505
distance x is tensor(102.1145, device='cuda:1')
benign distance is  tensor(102.1145, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0891286954283714
distance x is tensor(69.1143, device='cuda:1')
benign distance is  tensor(69.1143, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0651341564953327
distance x is tensor(86.3620, device='cuda:1')
benign distance is  tensor(86.3620, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.977414608001709
distance x is tensor(155.2216, device='cuda:1')
benign distance is  tensor(155.2216, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6685008630156517
distance x is tensor(61.8870, device='cuda:1')
benign distance is  tensor(61.8870, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9868052918463945
distance x is tensor(131.2838, device='cuda:1')
benign distance is  tensor(131.2838, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.28694424405694
distance x is tensor(110.0003, device='cuda:1')
benign distance is  tensor(110.0003, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.0846389345824718
distance x is tensor(95.8152, device='cuda:1')
benign distance is  tensor(95.8152, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8728266190737486
distance x is tensor(122.3080, device='cuda:1')
benign distance is  tensor(122.3080, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8535625096410513
distance x is tensor(114.8540, device='cuda:1')
benign distance is  tensor(114.8540, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.819559570401907
distance x is tensor(112.4954, device='cuda:1')
benign distance is  tensor(112.4954, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.8869968969374895
distance x is tensor(71.9640, device='cuda:1')
benign distance is  tensor(71.9640, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6779733300209045
distance x is tensor(196.0345, device='cuda:1')
benign distance is  tensor(196.0345, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1930476650595665
distance x is tensor(125.5258, device='cuda:1')
benign distance is  tensor(125.5258, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7260533664375544
distance x is tensor(103.6927, device='cuda:1')
benign distance is  tensor(103.6927, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.6830790899693966
distance x is tensor(116.8235, device='cuda:1')
benign distance is  tensor(116.8235, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.8303276617079973
distance x is tensor(80.2827, device='cuda:1')
benign distance is  tensor(80.2827, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.557233770377934
distance x is tensor(141.2145, device='cuda:1')
benign distance is  tensor(141.2145, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.1986395306885242
distance x is tensor(125.6596, device='cuda:1')
benign distance is  tensor(125.6596, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6893327049911022
distance x is tensor(100.7061, device='cuda:1')
benign distance is  tensor(100.7061, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7541057849302888
distance x is tensor(93.3004, device='cuda:1')
benign distance is  tensor(93.3004, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7335862964391708
distance x is tensor(86.6063, device='cuda:1')
benign distance is  tensor(86.6063, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.5723506510257721
distance x is tensor(123.5643, device='cuda:1')
benign distance is  tensor(123.5643, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.1875632368028164
distance x is tensor(96.7766, device='cuda:1')
benign distance is  tensor(96.7766, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.1858726367354393
distance x is tensor(126.4954, device='cuda:1')
benign distance is  tensor(126.4954, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.0524042639881372
distance x is tensor(141.9621, device='cuda:1')
benign distance is  tensor(141.9621, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.8543761819601059
distance x is tensor(74.9081, device='cuda:1')
benign distance is  tensor(74.9081, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6524911653250456
distance x is tensor(149.2291, device='cuda:1')
benign distance is  tensor(149.2291, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.849349157884717
distance x is tensor(126.7472, device='cuda:1')
benign distance is  tensor(126.7472, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8240889776498079
distance x is tensor(99.9652, device='cuda:1')
benign distance is  tensor(99.9652, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6143217496573925
distance x is tensor(119.4401, device='cuda:1')
benign distance is  tensor(119.4401, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.85700000016
mal_loss is 0.5182605683803558
mal_entropy is 0.16996952146291733
user_PLR len size 20
counter_tensor is  tensor([19., 14., 14., 13., 12., 12., 14., 13., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.9721e-02, 2.0026e-04, 2.0026e-04, 7.3671e-05, 2.7102e-05, 2.7102e-05,
        2.0026e-04, 7.3671e-05, 8.0790e-02, 8.0790e-02, 8.0790e-02, 8.0790e-02,
        8.0790e-02, 8.0790e-02, 8.0790e-02, 8.0790e-02, 8.0790e-02, 8.0790e-02,
        8.0790e-02, 8.0790e-02])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 88.35% 

Test Accuracy: 86.20% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7261209702119231
distance x is tensor(146.2734, device='cuda:1')
benign distance is  tensor(146.2734, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9662973210215569
distance x is tensor(113.1967, device='cuda:1')
benign distance is  tensor(113.1967, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8665000181645155
distance x is tensor(123.7978, device='cuda:1')
benign distance is  tensor(123.7978, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.843161329627037
distance x is tensor(152.3630, device='cuda:1')
benign distance is  tensor(152.3630, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1502413153648376
distance x is tensor(104.7792, device='cuda:1')
benign distance is  tensor(104.7792, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8675801008939743
distance x is tensor(100.2253, device='cuda:1')
benign distance is  tensor(100.2253, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.423570103943348
distance x is tensor(101.5666, device='cuda:1')
benign distance is  tensor(101.5666, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7352158278226852
distance x is tensor(101.9406, device='cuda:1')
benign distance is  tensor(101.9406, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.71200000016
mal_loss is 2.2954614646732807
mal_entropy is 0.16518847784027457
user_PLR len size 36
counter_tensor is  tensor([19., 34., 30., 20., 27., 23.,  0.,  1., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 12., 16., 32., 31., 24., 35., 30., 35.,
        29., 28., 35., 29.,  0., 13.,  0.,  0.])
count_res tensor([3.2563e-08, 1.0645e-01, 1.9497e-03, 8.8516e-08, 9.7070e-05, 1.7779e-06,
        1.8245e-16, 4.9594e-16, 4.8328e-06, 4.8328e-06, 4.8328e-06, 4.8328e-06,
        4.8328e-06, 4.8328e-06, 4.8328e-06, 4.8328e-06, 4.8328e-06, 4.8328e-06,
        4.8328e-06, 4.8328e-06, 2.9694e-11, 1.6212e-09, 1.4406e-02, 5.2998e-03,
        4.8328e-06, 2.8936e-01, 1.9497e-03, 2.8936e-01, 7.1726e-04, 2.6386e-04,
        2.8936e-01, 7.1726e-04, 1.8245e-16, 8.0716e-11, 1.8245e-16, 1.8245e-16])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 83.15% 

Test Accuracy: 85.46% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6194036826491356
distance x is tensor(133.2470, device='cuda:1')
benign distance is  tensor(133.2470, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9032776113599539
distance x is tensor(99.7537, device='cuda:1')
benign distance is  tensor(99.7537, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8867180235683918
distance x is tensor(108.8126, device='cuda:1')
benign distance is  tensor(108.8126, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.036788895726204
distance x is tensor(155.3635, device='cuda:1')
benign distance is  tensor(155.3635, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7886831481009722
distance x is tensor(91.9015, device='cuda:1')
benign distance is  tensor(91.9015, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.733884684741497
distance x is tensor(94.3316, device='cuda:1')
benign distance is  tensor(94.3316, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1491557098925114
distance x is tensor(95.7937, device='cuda:1')
benign distance is  tensor(95.7937, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7439479837194085
distance x is tensor(92.8379, device='cuda:1')
benign distance is  tensor(92.8379, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9487424921244383
distance x is tensor(104.4716, device='cuda:1')
benign distance is  tensor(104.4716, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7750986339524388
distance x is tensor(113.0100, device='cuda:1')
benign distance is  tensor(113.0100, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1001002565026283
distance x is tensor(63.0310, device='cuda:1')
benign distance is  tensor(63.0310, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.1683100052177906
distance x is tensor(121.5472, device='cuda:1')
benign distance is  tensor(121.5472, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.984186016023159
distance x is tensor(178.5240, device='cuda:1')
benign distance is  tensor(178.5240, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6887245383113623
distance x is tensor(61.2369, device='cuda:1')
benign distance is  tensor(61.2369, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0830488093197346
distance x is tensor(146.1093, device='cuda:1')
benign distance is  tensor(146.1093, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.6098262891173363
distance x is tensor(130.6072, device='cuda:1')
benign distance is  tensor(130.6072, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.1300266180187464
distance x is tensor(110.2152, device='cuda:1')
benign distance is  tensor(110.2152, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7892136089503765
distance x is tensor(134.1126, device='cuda:1')
benign distance is  tensor(134.1126, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9273333661258221
distance x is tensor(124.5298, device='cuda:1')
benign distance is  tensor(124.5298, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2207738608121872
distance x is tensor(131.7590, device='cuda:1')
benign distance is  tensor(131.7590, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7224300093948841
distance x is tensor(112.4908, device='cuda:1')
benign distance is  tensor(112.4908, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.0345304738730192
distance x is tensor(85.3452, device='cuda:1')
benign distance is  tensor(85.3452, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5292753931134939
distance x is tensor(123.4429, device='cuda:1')
benign distance is  tensor(123.4429, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.723062252625823
distance x is tensor(164.3094, device='cuda:1')
benign distance is  tensor(164.3094, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.77600000016
mal_loss is 1.126867514103651
mal_entropy is 0.15713067911565304
user_PLR len size 28
counter_tensor is  tensor([13., 20., 12., 12., 13., 27.,  0., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 26., 20., 12., 13., 12., 12., 12.])
count_res tensor([6.0700e-07, 6.6565e-04, 2.2330e-07, 2.2330e-07, 6.0700e-07, 7.2998e-01,
        1.3720e-12, 2.2330e-07, 1.2192e-05, 1.2192e-05, 1.2192e-05, 1.2192e-05,
        1.2192e-05, 1.2192e-05, 1.2192e-05, 1.2192e-05, 1.2192e-05, 1.2192e-05,
        1.2192e-05, 1.2192e-05, 2.2330e-07, 2.6854e-01, 6.6565e-04, 2.2330e-07,
        6.0700e-07, 2.2330e-07, 2.2330e-07, 2.2330e-07])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 83.31% 

Test Accuracy: 85.79% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6997466422617435
distance x is tensor(142.2399, device='cuda:1')
benign distance is  tensor(142.2399, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8277348428964615
distance x is tensor(114.3727, device='cuda:1')
benign distance is  tensor(114.3727, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8164936527609825
distance x is tensor(119.0590, device='cuda:1')
benign distance is  tensor(119.0590, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8879335317760706
distance x is tensor(156.8570, device='cuda:1')
benign distance is  tensor(156.8570, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8384706326760352
distance x is tensor(103.2686, device='cuda:1')
benign distance is  tensor(103.2686, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8347805310040712
distance x is tensor(66.3537, device='cuda:1')
benign distance is  tensor(66.3537, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3727979101240635
distance x is tensor(108.5053, device='cuda:1')
benign distance is  tensor(108.5053, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8302040845155716
distance x is tensor(99.4802, device='cuda:1')
benign distance is  tensor(99.4802, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.3199433460831642
distance x is tensor(127.6786, device='cuda:1')
benign distance is  tensor(127.6786, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7775641083717346
distance x is tensor(113.6076, device='cuda:1')
benign distance is  tensor(113.6076, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.0445928238332272
distance x is tensor(126.4625, device='cuda:1')
benign distance is  tensor(126.4625, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8722880277782679
distance x is tensor(142.7188, device='cuda:1')
benign distance is  tensor(142.7188, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0383050926029682
distance x is tensor(79.4344, device='cuda:1')
benign distance is  tensor(79.4344, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7029059082269669
distance x is tensor(208.6846, device='cuda:1')
benign distance is  tensor(208.6846, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.2531306967139244
distance x is tensor(149.1118, device='cuda:1')
benign distance is  tensor(149.1118, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.9766767881810665
distance x is tensor(118.0859, device='cuda:1')
benign distance is  tensor(118.0859, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.82000000016
mal_loss is 1.213014599867165
mal_entropy is 0.11129428166896105
user_PLR len size 28
counter_tensor is  tensor([27.,  0., 26., 24., 27., 23., 20., 16., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 21., 25., 27., 23., 24., 22., 18., 13.])
count_res tensor([2.7398e-01, 5.1495e-13, 1.0079e-01, 1.3641e-02, 2.7398e-01, 5.0181e-03,
        2.4984e-04, 4.5759e-06, 4.5759e-06, 4.5759e-06, 4.5759e-06, 4.5759e-06,
        4.5759e-06, 4.5759e-06, 4.5759e-06, 4.5759e-06, 4.5759e-06, 4.5759e-06,
        4.5759e-06, 4.5759e-06, 6.7913e-04, 3.7079e-02, 2.7398e-01, 5.0181e-03,
        1.3641e-02, 1.8461e-03, 3.3812e-05, 2.2782e-07])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 89.28% 

Test Accuracy: 87.72% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7798591144382954
distance x is tensor(120.4909, device='cuda:1')
benign distance is  tensor(120.4909, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7513172850012779
distance x is tensor(100.5351, device='cuda:1')
benign distance is  tensor(100.5351, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7682331074029207
distance x is tensor(100.1649, device='cuda:1')
benign distance is  tensor(100.1649, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9457902200520039
distance x is tensor(148.9014, device='cuda:1')
benign distance is  tensor(148.9014, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0973213370889425
distance x is tensor(76.2986, device='cuda:1')
benign distance is  tensor(76.2986, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7181177046149969
distance x is tensor(98.6081, device='cuda:1')
benign distance is  tensor(98.6081, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.042634168639779
distance x is tensor(103.8202, device='cuda:1')
benign distance is  tensor(103.8202, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6701537752524018
distance x is tensor(103.0921, device='cuda:1')
benign distance is  tensor(103.0921, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0191953498870134
distance x is tensor(101.6003, device='cuda:1')
benign distance is  tensor(101.6003, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5996392467059195
distance x is tensor(104.2237, device='cuda:1')
benign distance is  tensor(104.2237, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.058494046330452
distance x is tensor(61.9441, device='cuda:1')
benign distance is  tensor(61.9441, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0855473820120096
distance x is tensor(109.7642, device='cuda:1')
benign distance is  tensor(109.7642, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9856757428497076
distance x is tensor(161.2316, device='cuda:1')
benign distance is  tensor(161.2316, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9786052871495485
distance x is tensor(68.2195, device='cuda:1')
benign distance is  tensor(68.2195, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.103184862062335
distance x is tensor(150.2679, device='cuda:1')
benign distance is  tensor(150.2679, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3545527756214142
distance x is tensor(130.0927, device='cuda:1')
benign distance is  tensor(130.0927, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.84800000016
mal_loss is 0.8502654619514942
mal_entropy is 0.1291065402328968
user_PLR len size 28
counter_tensor is  tensor([14., 14., 13., 12., 12.,  0., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 13., 19., 12., 12., 21., 22., 27., 25.])
count_res tensor([1.9739e-06, 1.9739e-06, 7.2617e-07, 2.6714e-07, 2.6714e-07, 1.6414e-12,
        2.6714e-07, 2.6714e-07, 1.4585e-05, 1.4585e-05, 1.4585e-05, 1.4585e-05,
        1.4585e-05, 1.4585e-05, 1.4585e-05, 1.4585e-05, 1.4585e-05, 1.4585e-05,
        1.4585e-05, 1.4585e-05, 7.2617e-07, 2.9296e-04, 2.6714e-07, 2.6714e-07,
        2.1647e-03, 5.8842e-03, 8.7329e-01, 1.1819e-01])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 84.94% 

Test Accuracy: 86.10% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7465560175478458
distance x is tensor(131.1448, device='cuda:1')
benign distance is  tensor(131.1448, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.962919607758522
distance x is tensor(123.8131, device='cuda:1')
benign distance is  tensor(123.8131, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7055826615542173
distance x is tensor(108.5183, device='cuda:1')
benign distance is  tensor(108.5183, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9625887349247932
distance x is tensor(154.5941, device='cuda:1')
benign distance is  tensor(154.5941, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8686367552727461
distance x is tensor(101.2494, device='cuda:1')
benign distance is  tensor(101.2494, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6777510829269886
distance x is tensor(108.6015, device='cuda:1')
benign distance is  tensor(108.6015, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8940377980470657
distance x is tensor(102.1733, device='cuda:1')
benign distance is  tensor(102.1733, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8149227108806372
distance x is tensor(105.7768, device='cuda:1')
benign distance is  tensor(105.7768, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.807782081887126
distance x is tensor(124.2961, device='cuda:1')
benign distance is  tensor(124.2961, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.882332069799304
distance x is tensor(115.1912, device='cuda:1')
benign distance is  tensor(115.1912, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.721308121457696
distance x is tensor(155.5697, device='cuda:1')
benign distance is  tensor(155.5697, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.1535985618829727
distance x is tensor(134.7726, device='cuda:1')
benign distance is  tensor(134.7726, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8318437337875366
distance x is tensor(112.7560, device='cuda:1')
benign distance is  tensor(112.7560, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7936988566070795
distance x is tensor(109.1369, device='cuda:1')
benign distance is  tensor(109.1369, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7772629773244262
distance x is tensor(45.3551, device='cuda:1')
benign distance is  tensor(45.3551, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7885320708155632
distance x is tensor(142.2679, device='cuda:1')
benign distance is  tensor(142.2679, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.77900000016
mal_loss is 1.1516346260905266
mal_entropy is 0.17039159080013633
user_PLR len size 52
counter_tensor is  tensor([ 0., 51., 12.,  0., 12., 13.,  0.,  0., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 36., 50., 40., 48., 21., 50., 31., 42.,
         3., 51., 14., 27., 36., 50., 51.,  0.,  0.,  0., 51., 51., 40., 20.,
         0., 26.,  0.,  0.,  1., 14., 51.,  2., 13., 17.])
count_res tensor([9.9185e-24, 1.3979e-01, 1.6143e-18, 9.9185e-24, 1.6143e-18, 4.3881e-18,
        9.9185e-24, 9.9185e-24, 2.3347e-06, 2.3347e-06, 2.3347e-06, 2.3347e-06,
        2.3347e-06, 2.3347e-06, 2.3347e-06, 2.3347e-06, 2.3347e-06, 2.3347e-06,
        2.3347e-06, 2.3347e-06, 4.2761e-08, 5.1424e-02, 2.3347e-06, 6.9595e-03,
        1.3081e-14, 5.1424e-02, 2.8812e-10, 1.7251e-05, 1.9922e-22, 1.3979e-01,
        1.1928e-17, 5.2771e-12, 4.2761e-08, 5.1424e-02, 1.3979e-01, 9.9185e-24,
        9.9185e-24, 9.9185e-24, 1.3979e-01, 1.3979e-01, 2.3347e-06, 4.8121e-15,
        9.9185e-24, 1.9413e-12, 9.9185e-24, 9.9185e-24, 2.6961e-23, 1.1928e-17,
        1.3979e-01, 7.3288e-23, 4.3881e-18, 2.3958e-16])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 84.61% 

Test Accuracy: 86.35% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7259266227483749
distance x is tensor(122.7249, device='cuda:1')
benign distance is  tensor(122.7249, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8087108917534351
distance x is tensor(101.4472, device='cuda:1')
benign distance is  tensor(101.4472, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7775982674211264
distance x is tensor(102.7813, device='cuda:1')
benign distance is  tensor(102.7813, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9532029442489147
distance x is tensor(142.6986, device='cuda:1')
benign distance is  tensor(142.6986, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8886024737730622
distance x is tensor(79.1241, device='cuda:1')
benign distance is  tensor(79.1241, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8332446496933699
distance x is tensor(80.1723, device='cuda:1')
benign distance is  tensor(80.1723, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1438286807388067
distance x is tensor(89.5032, device='cuda:1')
benign distance is  tensor(89.5032, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.673138378188014
distance x is tensor(85.2436, device='cuda:1')
benign distance is  tensor(85.2436, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1552583146840334
distance x is tensor(88.4592, device='cuda:1')
benign distance is  tensor(88.4592, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.580790564417839
distance x is tensor(119.3725, device='cuda:1')
benign distance is  tensor(119.3725, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0280975513160229
distance x is tensor(56.9328, device='cuda:1')
benign distance is  tensor(56.9328, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0973658319562674
distance x is tensor(96.1621, device='cuda:1')
benign distance is  tensor(96.1621, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.136091334745288
distance x is tensor(152.7048, device='cuda:1')
benign distance is  tensor(152.7048, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7515910677611828
distance x is tensor(47.2455, device='cuda:1')
benign distance is  tensor(47.2455, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1083755865693092
distance x is tensor(131.8653, device='cuda:1')
benign distance is  tensor(131.8653, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1789782866835594
distance x is tensor(120.8593, device='cuda:1')
benign distance is  tensor(120.8593, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1141501814126968
distance x is tensor(109.9029, device='cuda:1')
benign distance is  tensor(109.9029, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7441886570304632
distance x is tensor(105.9950, device='cuda:1')
benign distance is  tensor(105.9950, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9983823783695698
distance x is tensor(115.1492, device='cuda:1')
benign distance is  tensor(115.1492, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8383968789130449
distance x is tensor(105.0759, device='cuda:1')
benign distance is  tensor(105.0759, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.818771243095398
distance x is tensor(66.3979, device='cuda:1')
benign distance is  tensor(66.3979, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7660586517304182
distance x is tensor(197.1189, device='cuda:1')
benign distance is  tensor(197.1189, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1252720095217228
distance x is tensor(137.5181, device='cuda:1')
benign distance is  tensor(137.5181, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.868171589449048
distance x is tensor(100.9370, device='cuda:1')
benign distance is  tensor(100.9370, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9284532051533461
distance x is tensor(105.7663, device='cuda:1')
benign distance is  tensor(105.7663, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6491021262481809
distance x is tensor(65.5864, device='cuda:1')
benign distance is  tensor(65.5864, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.0765315964818
distance x is tensor(127.4362, device='cuda:1')
benign distance is  tensor(127.4362, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2131980694830418
distance x is tensor(115.9878, device='cuda:1')
benign distance is  tensor(115.9878, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6527258548885584
distance x is tensor(107.1964, device='cuda:1')
benign distance is  tensor(107.1964, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7217896208167076
distance x is tensor(79.3815, device='cuda:1')
benign distance is  tensor(79.3815, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4951760219410062
distance x is tensor(114.0922, device='cuda:1')
benign distance is  tensor(114.0922, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7192542515695095
distance x is tensor(162.8470, device='cuda:1')
benign distance is  tensor(162.8470, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.9622986856848001
distance x is tensor(98.2074, device='cuda:1')
benign distance is  tensor(98.2074, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.3600705415010452
distance x is tensor(127.1889, device='cuda:1')
benign distance is  tensor(127.1889, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.1048310287296772
distance x is tensor(137.3549, device='cuda:1')
benign distance is  tensor(137.3549, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.2151850257068872
distance x is tensor(85.6450, device='cuda:1')
benign distance is  tensor(85.6450, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6751491082832217
distance x is tensor(154.7158, device='cuda:1')
benign distance is  tensor(154.7158, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.9513931404799223
distance x is tensor(123.8841, device='cuda:1')
benign distance is  tensor(123.8841, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7622122848406434
distance x is tensor(88.6257, device='cuda:1')
benign distance is  tensor(88.6257, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6517458483576775
distance x is tensor(122.6936, device='cuda:1')
benign distance is  tensor(122.6936, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.83400000016
mal_loss is 0.5552855050191283
mal_entropy is 0.2620117608457804
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 87.92% 

Test Accuracy: 83.59% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7989797759801149
distance x is tensor(130.4124, device='cuda:1')
benign distance is  tensor(130.4124, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8678364101797342
distance x is tensor(102.0725, device='cuda:1')
benign distance is  tensor(102.0725, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6333726234734058
distance x is tensor(107.6458, device='cuda:1')
benign distance is  tensor(107.6458, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0654550455510616
distance x is tensor(170.4931, device='cuda:1')
benign distance is  tensor(170.4931, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8355493750423193
distance x is tensor(105.6964, device='cuda:1')
benign distance is  tensor(105.6964, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8536107474938035
distance x is tensor(97.1698, device='cuda:1')
benign distance is  tensor(97.1698, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.138834435492754
distance x is tensor(105.7420, device='cuda:1')
benign distance is  tensor(105.7420, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6713089123368263
distance x is tensor(97.0931, device='cuda:1')
benign distance is  tensor(97.0931, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.63100000016
mal_loss is 2.2508778981864452
mal_entropy is 0.28631248511373997
user_PLR len size 28
counter_tensor is  tensor([25., 14., 27., 12., 12., 12., 27., 25., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 24., 25., 12.,  0., 24., 22., 21.])
count_res tensor([3.8502e-02, 6.4305e-07, 2.8449e-01, 8.7028e-08, 8.7028e-08, 8.7028e-08,
        2.8449e-01, 3.8502e-02, 4.7515e-06, 4.7515e-06, 4.7515e-06, 4.7515e-06,
        4.7515e-06, 4.7515e-06, 4.7515e-06, 4.7515e-06, 4.7515e-06, 4.7515e-06,
        4.7515e-06, 4.7515e-06, 2.8449e-01, 1.4164e-02, 3.8502e-02, 8.7028e-08,
        5.3472e-13, 1.4164e-02, 1.9169e-03, 7.0519e-04])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 85.07% 

Test Accuracy: 86.32% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7974942270666361
distance x is tensor(129.6349, device='cuda:1')
benign distance is  tensor(129.6349, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0194533597677946
distance x is tensor(100.1269, device='cuda:1')
benign distance is  tensor(100.1269, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9338100273162127
distance x is tensor(104.1874, device='cuda:1')
benign distance is  tensor(104.1874, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8131518345326185
distance x is tensor(155.9153, device='cuda:1')
benign distance is  tensor(155.9153, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8448512768372893
distance x is tensor(92.9357, device='cuda:1')
benign distance is  tensor(92.9357, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.715493000112474
distance x is tensor(81.5979, device='cuda:1')
benign distance is  tensor(81.5979, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0832127872854471
distance x is tensor(88.0481, device='cuda:1')
benign distance is  tensor(88.0481, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6917056953534484
distance x is tensor(100.9710, device='cuda:1')
benign distance is  tensor(100.9710, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9843956064432859
distance x is tensor(74.5526, device='cuda:1')
benign distance is  tensor(74.5526, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.62781788315624
distance x is tensor(123.6718, device='cuda:1')
benign distance is  tensor(123.6718, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1922881752252579
distance x is tensor(61.7114, device='cuda:1')
benign distance is  tensor(61.7114, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.31745395809412
distance x is tensor(122.6062, device='cuda:1')
benign distance is  tensor(122.6062, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8756804317235947
distance x is tensor(164.0655, device='cuda:1')
benign distance is  tensor(164.0655, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7568662697449327
distance x is tensor(58.3001, device='cuda:1')
benign distance is  tensor(58.3001, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9485999178141356
distance x is tensor(139.6733, device='cuda:1')
benign distance is  tensor(139.6733, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.194735100492835
distance x is tensor(125.8452, device='cuda:1')
benign distance is  tensor(125.8452, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.82000000016
mal_loss is 1.0548876952379942
mal_entropy is 0.1478023179806769
user_PLR len size 28
counter_tensor is  tensor([19., 27.,  0., 26., 23., 24., 20., 17., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 25., 17., 15., 27., 12., 19., 27., 22.])
count_res tensor([9.3706e-05, 2.7933e-01, 5.2502e-13, 1.0276e-01, 5.1162e-03, 1.3907e-02,
        2.5472e-04, 1.2682e-05, 4.6654e-06, 4.6654e-06, 4.6654e-06, 4.6654e-06,
        4.6654e-06, 4.6654e-06, 4.6654e-06, 4.6654e-06, 4.6654e-06, 4.6654e-06,
        4.6654e-06, 4.6654e-06, 3.7804e-02, 1.2682e-05, 1.7163e-06, 2.7933e-01,
        8.5449e-08, 9.3706e-05, 2.7933e-01, 1.8821e-03])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 81.49% 

Test Accuracy: 84.29% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6069338172674179
distance x is tensor(124.6097, device='cuda:1')
benign distance is  tensor(124.6097, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8354858988896012
distance x is tensor(80.0952, device='cuda:1')
benign distance is  tensor(80.0952, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8065994409844279
distance x is tensor(105.0609, device='cuda:1')
benign distance is  tensor(105.0609, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9510470442473888
distance x is tensor(138.6293, device='cuda:1')
benign distance is  tensor(138.6293, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0379066076129675
distance x is tensor(101.3408, device='cuda:1')
benign distance is  tensor(101.3408, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7751339413225651
distance x is tensor(87.8683, device='cuda:1')
benign distance is  tensor(87.8683, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3267229720950127
distance x is tensor(90.0800, device='cuda:1')
benign distance is  tensor(90.0800, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7367642540484667
distance x is tensor(98.4755, device='cuda:1')
benign distance is  tensor(98.4755, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.2257837504148483
distance x is tensor(108.2168, device='cuda:1')
benign distance is  tensor(108.2168, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8606034647673368
distance x is tensor(115.9782, device='cuda:1')
benign distance is  tensor(115.9782, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8444257453083992
distance x is tensor(113.3164, device='cuda:1')
benign distance is  tensor(113.3164, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8348254282027483
distance x is tensor(97.6167, device='cuda:1')
benign distance is  tensor(97.6167, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0914854351431131
distance x is tensor(85.5656, device='cuda:1')
benign distance is  tensor(85.5656, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7186508597806096
distance x is tensor(202.0154, device='cuda:1')
benign distance is  tensor(202.0154, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.2950035743415356
distance x is tensor(119.2669, device='cuda:1')
benign distance is  tensor(119.2669, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8260427061468363
distance x is tensor(101.4637, device='cuda:1')
benign distance is  tensor(101.4637, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.79000000016
mal_loss is 1.0890459530055523
mal_entropy is 0.15009368862956762
user_PLR len size 44
counter_tensor is  tensor([ 0., 43., 40., 40., 11., 18., 18., 25., 31., 31., 31., 31., 31., 31.,
        31., 31., 31., 31., 31., 31.,  1., 42., 43., 17., 17., 21.,  1., 13.,
        15., 20.,  2., 40., 37., 13., 42., 20.,  1., 43., 15., 18., 20., 19.,
         0.,  1.])
count_res tensor([5.4406e-20, 2.5722e-01, 1.2806e-02, 1.2806e-02, 3.2575e-15, 3.5723e-12,
        3.5723e-12, 3.9175e-09, 1.5804e-06, 1.5804e-06, 1.5804e-06, 1.5804e-06,
        1.5804e-06, 1.5804e-06, 1.5804e-06, 1.5804e-06, 1.5804e-06, 1.5804e-06,
        1.5804e-06, 1.5804e-06, 1.4789e-19, 9.4627e-02, 2.5722e-01, 1.3142e-12,
        1.3142e-12, 7.1752e-11, 1.4789e-19, 2.4070e-14, 1.7785e-13, 2.6396e-11,
        4.0201e-19, 1.2806e-02, 6.3759e-04, 2.4070e-14, 9.4627e-02, 2.6396e-11,
        1.4789e-19, 2.5722e-01, 1.7785e-13, 3.5723e-12, 2.6396e-11, 9.7105e-12,
        5.4406e-20, 1.4789e-19])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 88.39% 

Test Accuracy: 87.17% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6409749574959278
distance x is tensor(135.0636, device='cuda:1')
benign distance is  tensor(135.0636, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8705379292368889
distance x is tensor(90.9004, device='cuda:1')
benign distance is  tensor(90.9004, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7202942688018084
distance x is tensor(123.2810, device='cuda:1')
benign distance is  tensor(123.2810, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8796385768800974
distance x is tensor(154.8275, device='cuda:1')
benign distance is  tensor(154.8275, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.85965830180794
distance x is tensor(89.2306, device='cuda:1')
benign distance is  tensor(89.2306, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9002357171848416
distance x is tensor(99.0352, device='cuda:1')
benign distance is  tensor(99.0352, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0703987199813128
distance x is tensor(98.5107, device='cuda:1')
benign distance is  tensor(98.5107, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7819020431488752
distance x is tensor(92.5819, device='cuda:1')
benign distance is  tensor(92.5819, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.058699306100607
distance x is tensor(98.1766, device='cuda:1')
benign distance is  tensor(98.1766, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.75248215906322
distance x is tensor(81.9977, device='cuda:1')
benign distance is  tensor(81.9977, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0866020452231169
distance x is tensor(69.9121, device='cuda:1')
benign distance is  tensor(69.9121, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2183288000524044
distance x is tensor(108.3468, device='cuda:1')
benign distance is  tensor(108.3468, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8744389321655035
distance x is tensor(152.8261, device='cuda:1')
benign distance is  tensor(152.8261, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6594512136653066
distance x is tensor(56.2578, device='cuda:1')
benign distance is  tensor(56.2578, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9443343821913004
distance x is tensor(135.5246, device='cuda:1')
benign distance is  tensor(135.5246, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.5541320852935314
distance x is tensor(140.5115, device='cuda:1')
benign distance is  tensor(140.5115, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.8511410355567932
distance x is tensor(114.3744, device='cuda:1')
benign distance is  tensor(114.3744, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.665139289572835
distance x is tensor(72.0224, device='cuda:1')
benign distance is  tensor(72.0224, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9804865512996912
distance x is tensor(128.1826, device='cuda:1')
benign distance is  tensor(128.1826, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.1307831294834614
distance x is tensor(117.7750, device='cuda:1')
benign distance is  tensor(117.7750, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7077163830399513
distance x is tensor(111.9812, device='cuda:1')
benign distance is  tensor(111.9812, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7920115496963263
distance x is tensor(99.2897, device='cuda:1')
benign distance is  tensor(99.2897, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6233884412795305
distance x is tensor(108.3916, device='cuda:1')
benign distance is  tensor(108.3916, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7045465279370546
distance x is tensor(176.5045, device='cuda:1')
benign distance is  tensor(176.5045, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7344237705692649
distance x is tensor(119.2303, device='cuda:1')
benign distance is  tensor(119.2303, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.8052630219608545
distance x is tensor(93.7128, device='cuda:1')
benign distance is  tensor(93.7128, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6611587684601545
distance x is tensor(140.6511, device='cuda:1')
benign distance is  tensor(140.6511, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.9696363918483257
distance x is tensor(123.7084, device='cuda:1')
benign distance is  tensor(123.7084, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.780293857678771
distance x is tensor(110.3260, device='cuda:1')
benign distance is  tensor(110.3260, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.6981712682172656
distance x is tensor(83.0186, device='cuda:1')
benign distance is  tensor(83.0186, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.6281374981626868
distance x is tensor(76.0875, device='cuda:1')
benign distance is  tensor(76.0875, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7443740479648113
distance x is tensor(117.6078, device='cuda:1')
benign distance is  tensor(117.6078, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.85200000016
mal_loss is 0.5696139512583613
mal_entropy is 0.17174967844039202
user_PLR len size 20
counter_tensor is  tensor([19., 13., 12., 12., 12., 12., 12., 13., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.9736e-02, 7.3709e-05, 2.7116e-05, 2.7116e-05, 2.7116e-05, 2.7116e-05,
        2.7116e-05, 7.3709e-05, 8.0832e-02, 8.0832e-02, 8.0832e-02, 8.0832e-02,
        8.0832e-02, 8.0832e-02, 8.0832e-02, 8.0832e-02, 8.0832e-02, 8.0832e-02,
        8.0832e-02, 8.0832e-02])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 93.03% 

Test Accuracy: 85.64% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7963461168110371
distance x is tensor(140.9252, device='cuda:1')
benign distance is  tensor(140.9252, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9991214331239462
distance x is tensor(112.0926, device='cuda:1')
benign distance is  tensor(112.0926, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.784934688359499
distance x is tensor(124.5126, device='cuda:1')
benign distance is  tensor(124.5126, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8824241310358047
distance x is tensor(160.1295, device='cuda:1')
benign distance is  tensor(160.1295, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1380835641175508
distance x is tensor(109.6038, device='cuda:1')
benign distance is  tensor(109.6038, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7823922988027334
distance x is tensor(107.1685, device='cuda:1')
benign distance is  tensor(107.1685, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0484825056046247
distance x is tensor(111.4775, device='cuda:1')
benign distance is  tensor(111.4775, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6599181266501546
distance x is tensor(107.3304, device='cuda:1')
benign distance is  tensor(107.3304, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.66800000016
mal_loss is 2.3649401366710663
mal_entropy is 0.1786774625070393
user_PLR len size 44
counter_tensor is  tensor([42., 22., 31.,  5., 33., 30., 18., 15., 21., 21., 21., 21., 21., 21.,
        21., 21., 21., 21., 21., 21., 32., 40., 42., 43.,  6.,  4., 35., 23.,
        23., 15., 35., 26., 25., 43., 35., 34., 31.,  0., 41., 42.,  6., 24.,
        39., 43.])
count_res tensor([8.5389e-02, 1.7600e-10, 1.4261e-06, 7.2863e-18, 1.0538e-05, 5.2465e-07,
        3.2235e-12, 1.6049e-13, 6.4747e-11, 6.4747e-11, 6.4747e-11, 6.4747e-11,
        6.4747e-11, 6.4747e-11, 6.4747e-11, 6.4747e-11, 6.4747e-11, 6.4747e-11,
        6.4747e-11, 6.4747e-11, 3.8766e-06, 1.1556e-02, 8.5389e-02, 2.3211e-01,
        1.9806e-17, 2.6805e-18, 7.7865e-05, 4.7842e-10, 4.7842e-10, 1.6049e-13,
        7.7865e-05, 9.6093e-09, 3.5350e-09, 2.3211e-01, 7.7865e-05, 2.8645e-05,
        1.4261e-06, 4.9095e-20, 3.1413e-02, 8.5389e-02, 1.9806e-17, 1.3005e-09,
        4.2513e-03, 2.3211e-01])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 83.20% 

Test Accuracy: 86.12% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7886197939515114
distance x is tensor(120.9379, device='cuda:1')
benign distance is  tensor(120.9379, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8625315651297569
distance x is tensor(94.4993, device='cuda:1')
benign distance is  tensor(94.4993, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6755466312170029
distance x is tensor(106.3329, device='cuda:1')
benign distance is  tensor(106.3329, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.067438781261444
distance x is tensor(148.6704, device='cuda:1')
benign distance is  tensor(148.6704, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9480233695358038
distance x is tensor(83.4732, device='cuda:1')
benign distance is  tensor(83.4732, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7561314180493355
distance x is tensor(90.2986, device='cuda:1')
benign distance is  tensor(90.2986, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2912601325660944
distance x is tensor(100.5749, device='cuda:1')
benign distance is  tensor(100.5749, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7395264124497771
distance x is tensor(88.9616, device='cuda:1')
benign distance is  tensor(88.9616, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8721173331141472
distance x is tensor(93.3240, device='cuda:1')
benign distance is  tensor(93.3240, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6972814220935106
distance x is tensor(102.5554, device='cuda:1')
benign distance is  tensor(102.5554, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.827844450250268
distance x is tensor(65.9513, device='cuda:1')
benign distance is  tensor(65.9513, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0412492584437132
distance x is tensor(99.3513, device='cuda:1')
benign distance is  tensor(99.3513, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.5983119122684002
distance x is tensor(164.6721, device='cuda:1')
benign distance is  tensor(164.6721, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7115467507392168
distance x is tensor(59.2092, device='cuda:1')
benign distance is  tensor(59.2092, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9693618696182966
distance x is tensor(131.1848, device='cuda:1')
benign distance is  tensor(131.1848, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3134069219231606
distance x is tensor(115.3834, device='cuda:1')
benign distance is  tensor(115.3834, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1379696503281593
distance x is tensor(117.5269, device='cuda:1')
benign distance is  tensor(117.5269, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8238459751009941
distance x is tensor(106.5186, device='cuda:1')
benign distance is  tensor(106.5186, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8679431267082691
distance x is tensor(121.1221, device='cuda:1')
benign distance is  tensor(121.1221, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8850880526006222
distance x is tensor(118.7196, device='cuda:1')
benign distance is  tensor(118.7196, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9230723045766354
distance x is tensor(81.0924, device='cuda:1')
benign distance is  tensor(81.0924, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.016108088195324
distance x is tensor(213.7936, device='cuda:1')
benign distance is  tensor(213.7936, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0693046599626541
distance x is tensor(137.4741, device='cuda:1')
benign distance is  tensor(137.4741, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7733466224744916
distance x is tensor(95.0483, device='cuda:1')
benign distance is  tensor(95.0483, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.2658195681869984
distance x is tensor(99.4248, device='cuda:1')
benign distance is  tensor(99.4248, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.4175667203962803
distance x is tensor(118.2196, device='cuda:1')
benign distance is  tensor(118.2196, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.0098260827362537
distance x is tensor(141.1091, device='cuda:1')
benign distance is  tensor(141.1091, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.8919819816946983
distance x is tensor(78.4877, device='cuda:1')
benign distance is  tensor(78.4877, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6485133320093155
distance x is tensor(159.7229, device='cuda:1')
benign distance is  tensor(159.7229, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.12405351921916
distance x is tensor(131.8027, device='cuda:1')
benign distance is  tensor(131.8027, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.09575355052948
distance x is tensor(104.9082, device='cuda:1')
benign distance is  tensor(104.9082, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5967182004824281
distance x is tensor(124.8883, device='cuda:1')
benign distance is  tensor(124.8883, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.83400000016
mal_loss is 0.7200169013813138
mal_entropy is 0.1782930437475443
user_PLR len size 20
counter_tensor is  tensor([14., 15., 13., 14., 14., 12., 14., 14., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.0621e-04, 5.6054e-04, 7.5861e-05, 2.0621e-04, 2.0621e-04, 2.7908e-05,
        2.0621e-04, 2.0621e-04, 8.3192e-02, 8.3192e-02, 8.3192e-02, 8.3192e-02,
        8.3192e-02, 8.3192e-02, 8.3192e-02, 8.3192e-02, 8.3192e-02, 8.3192e-02,
        8.3192e-02, 8.3192e-02])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 86.03% 

Test Accuracy: 84.36% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8446286097168922
distance x is tensor(142.8320, device='cuda:1')
benign distance is  tensor(142.8320, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9416356589645147
distance x is tensor(111.2360, device='cuda:1')
benign distance is  tensor(111.2360, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.925056891515851
distance x is tensor(127.7842, device='cuda:1')
benign distance is  tensor(127.7842, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9840278960764408
distance x is tensor(156.5770, device='cuda:1')
benign distance is  tensor(156.5770, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.296179886907339
distance x is tensor(104.3900, device='cuda:1')
benign distance is  tensor(104.3900, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8008675207383931
distance x is tensor(107.6896, device='cuda:1')
benign distance is  tensor(107.6896, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1759783290326595
distance x is tensor(108.6993, device='cuda:1')
benign distance is  tensor(108.6993, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.74625981785357
distance x is tensor(100.4977, device='cuda:1')
benign distance is  tensor(100.4977, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.68900000016
mal_loss is 2.8563151583075523
mal_entropy is 0.1720417132601142
user_PLR len size 36
counter_tensor is  tensor([27., 35.,  1., 11., 22.,  1.,  0., 25., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 15., 29., 26., 17., 35., 22., 19., 35.,
        33., 26., 17., 35., 28., 15., 30.,  2.])
count_res tensor([8.0907e-05, 2.4118e-01, 4.1336e-16, 9.1048e-12, 5.4514e-07, 4.1336e-16,
        1.5207e-16, 1.0950e-05, 4.0281e-06, 4.0281e-06, 4.0281e-06, 4.0281e-06,
        4.0281e-06, 4.0281e-06, 4.0281e-06, 4.0281e-06, 4.0281e-06, 4.0281e-06,
        4.0281e-06, 4.0281e-06, 4.9711e-10, 5.9782e-04, 2.9764e-05, 3.6732e-09,
        2.4118e-01, 5.4514e-07, 2.7141e-08, 2.4118e-01, 3.2640e-02, 2.9764e-05,
        3.6732e-09, 2.4118e-01, 2.1993e-04, 4.9711e-10, 1.6251e-03, 1.1236e-15])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 85.07% 

Test Accuracy: 87.15% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6737101096659899
distance x is tensor(117.2393, device='cuda:1')
benign distance is  tensor(117.2393, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9599470729008317
distance x is tensor(78.8634, device='cuda:1')
benign distance is  tensor(78.8634, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7869919836521149
distance x is tensor(111.5715, device='cuda:1')
benign distance is  tensor(111.5715, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9143946748226881
distance x is tensor(150.9265, device='cuda:1')
benign distance is  tensor(150.9265, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9089864566922188
distance x is tensor(90.5919, device='cuda:1')
benign distance is  tensor(90.5919, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9736742712557316
distance x is tensor(95.5292, device='cuda:1')
benign distance is  tensor(95.5292, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2640277408063412
distance x is tensor(97.9461, device='cuda:1')
benign distance is  tensor(97.9461, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7369573526084423
distance x is tensor(94.3278, device='cuda:1')
benign distance is  tensor(94.3278, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8839452285319567
distance x is tensor(114.0508, device='cuda:1')
benign distance is  tensor(114.0508, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7449056063778698
distance x is tensor(111.8640, device='cuda:1')
benign distance is  tensor(111.8640, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0241517834365368
distance x is tensor(57.9585, device='cuda:1')
benign distance is  tensor(57.9585, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.7078175283968449
distance x is tensor(97.1488, device='cuda:1')
benign distance is  tensor(97.1488, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8290754556655884
distance x is tensor(151.4894, device='cuda:1')
benign distance is  tensor(151.4894, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6097564967349172
distance x is tensor(62.9051, device='cuda:1')
benign distance is  tensor(62.9051, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1604620534926653
distance x is tensor(144.9780, device='cuda:1')
benign distance is  tensor(144.9780, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.190811488777399
distance x is tensor(120.5208, device='cuda:1')
benign distance is  tensor(120.5208, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.0037955529987812
distance x is tensor(119.2796, device='cuda:1')
benign distance is  tensor(119.2796, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7821304276585579
distance x is tensor(102.3148, device='cuda:1')
benign distance is  tensor(102.3148, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9894014727324247
distance x is tensor(131.3922, device='cuda:1')
benign distance is  tensor(131.3922, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.1600770484656096
distance x is tensor(110.1315, device='cuda:1')
benign distance is  tensor(110.1315, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7966553717851639
distance x is tensor(104.3331, device='cuda:1')
benign distance is  tensor(104.3331, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7560177501291037
distance x is tensor(92.2637, device='cuda:1')
benign distance is  tensor(92.2637, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5276738023385406
distance x is tensor(127.4314, device='cuda:1')
benign distance is  tensor(127.4314, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7395041547715664
distance x is tensor(160.7248, device='cuda:1')
benign distance is  tensor(160.7248, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.85700000016
mal_loss is 0.6244592387229204
mal_entropy is 0.15630481974221766
user_PLR len size 36
counter_tensor is  tensor([17., 17., 22.,  0.,  1., 30., 15., 21., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 15.,  2., 13., 12., 34., 32., 20., 12.,
        12., 30.,  4., 15., 12., 13., 35., 12.])
count_res tensor([1.0640e-08, 1.0640e-08, 1.5792e-06, 4.4050e-16, 1.1974e-15, 4.7074e-03,
        1.4400e-09, 5.8094e-07, 1.1669e-05, 1.1669e-05, 1.1669e-05, 1.1669e-05,
        1.1669e-05, 1.1669e-05, 1.1669e-05, 1.1669e-05, 1.1669e-05, 1.1669e-05,
        1.1669e-05, 1.1669e-05, 1.4400e-09, 3.2549e-15, 1.9488e-10, 7.1694e-11,
        2.5702e-01, 3.4783e-02, 2.1372e-07, 7.1694e-11, 7.1694e-11, 4.7074e-03,
        2.4051e-14, 1.4400e-09, 7.1694e-11, 1.9488e-10, 6.9864e-01, 7.1694e-11])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 86.57% 

Test Accuracy: 83.76% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8506017494946718
distance x is tensor(130.0534, device='cuda:1')
benign distance is  tensor(130.0534, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9653303995728493
distance x is tensor(103.0427, device='cuda:1')
benign distance is  tensor(103.0427, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6364343278110027
distance x is tensor(117.4127, device='cuda:1')
benign distance is  tensor(117.4127, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9391481429338455
distance x is tensor(148.8712, device='cuda:1')
benign distance is  tensor(148.8712, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0415970049798489
distance x is tensor(96.7773, device='cuda:1')
benign distance is  tensor(96.7773, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.740148076787591
distance x is tensor(101.8229, device='cuda:1')
benign distance is  tensor(101.8229, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3420764449983835
distance x is tensor(99.5726, device='cuda:1')
benign distance is  tensor(99.5726, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6482510855421424
distance x is tensor(99.2416, device='cuda:1')
benign distance is  tensor(99.2416, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.9960726983845234
distance x is tensor(112.3471, device='cuda:1')
benign distance is  tensor(112.3471, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8285728022456169
distance x is tensor(116.5339, device='cuda:1')
benign distance is  tensor(116.5339, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.1000363714993
distance x is tensor(126.9251, device='cuda:1')
benign distance is  tensor(126.9251, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9731782786548138
distance x is tensor(111.7521, device='cuda:1')
benign distance is  tensor(111.7521, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.012151774019003
distance x is tensor(79.2691, device='cuda:1')
benign distance is  tensor(79.2691, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.838352594524622
distance x is tensor(212.3048, device='cuda:1')
benign distance is  tensor(212.3048, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1533250585198402
distance x is tensor(85.1473, device='cuda:1')
benign distance is  tensor(85.1473, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.697257136926055
distance x is tensor(117.8525, device='cuda:1')
benign distance is  tensor(117.8525, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.6274036318063736
distance x is tensor(123.5459, device='cuda:1')
benign distance is  tensor(123.5459, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.0651394799351692
distance x is tensor(111.2240, device='cuda:1')
benign distance is  tensor(111.2240, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6573816575109959
distance x is tensor(156.6605, device='cuda:1')
benign distance is  tensor(156.6605, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.011128019541502
distance x is tensor(122.4244, device='cuda:1')
benign distance is  tensor(122.4244, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6373617332428694
distance x is tensor(113.7701, device='cuda:1')
benign distance is  tensor(113.7701, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7670034300535917
distance x is tensor(94.3121, device='cuda:1')
benign distance is  tensor(94.3121, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.9678725693374872
distance x is tensor(94.4285, device='cuda:1')
benign distance is  tensor(94.4285, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7757921814918518
distance x is tensor(122.8573, device='cuda:1')
benign distance is  tensor(122.8573, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.76600000016
mal_loss is 1.4287127703428268
mal_entropy is 0.1561302631162107
user_PLR len size 28
counter_tensor is  tensor([12., 21., 20., 12., 12., 23.,  0., 18., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 23., 13., 12., 12., 24., 12., 27.])
count_res tensor([1.4636e-07, 1.1859e-03, 4.3628e-04, 1.4636e-07, 1.4636e-07, 8.7629e-03,
        8.9924e-13, 5.9044e-05, 7.9907e-06, 7.9907e-06, 7.9907e-06, 7.9907e-06,
        7.9907e-06, 7.9907e-06, 7.9907e-06, 7.9907e-06, 7.9907e-06, 7.9907e-06,
        7.9907e-06, 7.9907e-06, 4.7844e-01, 8.7629e-03, 3.9783e-07, 1.4636e-07,
        1.4636e-07, 2.3820e-02, 1.4636e-07, 4.7844e-01])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 82.49% 

Test Accuracy: 85.19% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7352143935859203
distance x is tensor(122.7795, device='cuda:1')
benign distance is  tensor(122.7795, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7747269105166197
distance x is tensor(97.8466, device='cuda:1')
benign distance is  tensor(97.8466, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7616896405816078
distance x is tensor(121.1788, device='cuda:1')
benign distance is  tensor(121.1788, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.295636273920536
distance x is tensor(156.3234, device='cuda:1')
benign distance is  tensor(156.3234, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0847418922930956
distance x is tensor(110.7141, device='cuda:1')
benign distance is  tensor(110.7141, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6377726690843701
distance x is tensor(97.4272, device='cuda:1')
benign distance is  tensor(97.4272, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1587344445288181
distance x is tensor(112.1422, device='cuda:1')
benign distance is  tensor(112.1422, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.838290261104703
distance x is tensor(118.1880, device='cuda:1')
benign distance is  tensor(118.1880, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9406378772109747
distance x is tensor(77.9646, device='cuda:1')
benign distance is  tensor(77.9646, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5681947665289044
distance x is tensor(104.9345, device='cuda:1')
benign distance is  tensor(104.9345, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0914363246411085
distance x is tensor(77.9118, device='cuda:1')
benign distance is  tensor(77.9118, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3825448155403137
distance x is tensor(96.2242, device='cuda:1')
benign distance is  tensor(96.2242, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2266745083034039
distance x is tensor(164.5316, device='cuda:1')
benign distance is  tensor(164.5316, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7856397749856114
distance x is tensor(62.6518, device='cuda:1')
benign distance is  tensor(62.6518, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0624957643449306
distance x is tensor(143.7375, device='cuda:1')
benign distance is  tensor(143.7375, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2918848469853401
distance x is tensor(98.7606, device='cuda:1')
benign distance is  tensor(98.7606, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8080000001600001
mal_loss is 1.0194917730987072
mal_entropy is 0.15403544204309583
user_PLR len size 20
counter_tensor is  tensor([12., 13., 12., 12., 17., 13., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7832e-05, 7.5654e-05, 2.7832e-05, 2.7832e-05, 4.1306e-03, 7.5654e-05,
        2.7832e-05, 2.7832e-05, 8.2965e-02, 8.2965e-02, 8.2965e-02, 8.2965e-02,
        8.2965e-02, 8.2965e-02, 8.2965e-02, 8.2965e-02, 8.2965e-02, 8.2965e-02,
        8.2965e-02, 8.2965e-02])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 86.45% 

Test Accuracy: 82.10% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9328969903290272
distance x is tensor(144.7643, device='cuda:1')
benign distance is  tensor(144.7643, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9041402945294976
distance x is tensor(127.3774, device='cuda:1')
benign distance is  tensor(127.3774, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7659197859466076
distance x is tensor(143.8373, device='cuda:1')
benign distance is  tensor(143.8373, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9135049115866423
distance x is tensor(174.9572, device='cuda:1')
benign distance is  tensor(174.9572, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0006661815568805
distance x is tensor(133.1817, device='cuda:1')
benign distance is  tensor(133.1817, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8051852053031325
distance x is tensor(115.3284, device='cuda:1')
benign distance is  tensor(115.3284, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5349034778773785
distance x is tensor(132.5012, device='cuda:1')
benign distance is  tensor(132.5012, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.74963353946805
distance x is tensor(117.4312, device='cuda:1')
benign distance is  tensor(117.4312, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.57800000016
mal_loss is 6.015939280390739
mal_entropy is 0.11911243200302124
user_PLR len size 52
counter_tensor is  tensor([48., 49., 50., 10., 47., 46.,  5.,  3., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 51., 22., 51., 49., 47., 10.,  2., 51.,
         2., 50., 49., 43.,  0., 46., 32., 18.,  9., 26., 41., 33., 37., 48.,
        42., 44., 18., 51., 51., 42.,  1., 42., 18., 51.])
count_res tensor([6.8266e-03, 1.8557e-02, 5.0442e-02, 2.1430e-19, 2.5114e-03, 9.2388e-04,
        1.4439e-21, 1.9541e-22, 8.6453e-17, 8.6453e-17, 8.6453e-17, 8.6453e-17,
        8.6453e-17, 8.6453e-17, 8.6453e-17, 8.6453e-17, 8.6453e-17, 8.6453e-17,
        8.6453e-17, 8.6453e-17, 1.3712e-01, 3.4878e-14, 1.3712e-01, 1.8557e-02,
        2.5114e-03, 2.1430e-19, 7.1888e-23, 1.3712e-01, 7.1888e-23, 5.0442e-02,
        1.8557e-02, 4.5997e-05, 9.7290e-24, 9.2388e-04, 7.6823e-10, 6.3881e-16,
        7.8835e-20, 1.9043e-12, 6.2250e-06, 2.0883e-09, 1.1402e-07, 6.8266e-03,
        1.6921e-05, 1.2503e-04, 6.3881e-16, 1.3712e-01, 1.3712e-01, 1.6921e-05,
        2.6446e-23, 1.6921e-05, 6.3881e-16, 1.3712e-01])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 86.57% 

Test Accuracy: 87.16% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7316654901951551
distance x is tensor(123.3150, device='cuda:1')
benign distance is  tensor(123.3150, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.784171424806118
distance x is tensor(82.4616, device='cuda:1')
benign distance is  tensor(82.4616, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6741062365472317
distance x is tensor(116.4491, device='cuda:1')
benign distance is  tensor(116.4491, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9294216968119144
distance x is tensor(146.1462, device='cuda:1')
benign distance is  tensor(146.1462, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8869068827480078
distance x is tensor(95.8118, device='cuda:1')
benign distance is  tensor(95.8118, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.654741920530796
distance x is tensor(93.0001, device='cuda:1')
benign distance is  tensor(93.0001, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0291333105415106
distance x is tensor(100.0496, device='cuda:1')
benign distance is  tensor(100.0496, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6206847941502929
distance x is tensor(92.1916, device='cuda:1')
benign distance is  tensor(92.1916, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8528651800006628
distance x is tensor(94.9064, device='cuda:1')
benign distance is  tensor(94.9064, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6405054517090321
distance x is tensor(89.2594, device='cuda:1')
benign distance is  tensor(89.2594, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0166165102273226
distance x is tensor(59.0098, device='cuda:1')
benign distance is  tensor(59.0098, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.1655160188674927
distance x is tensor(97.9031, device='cuda:1')
benign distance is  tensor(97.9031, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.3020083606243134
distance x is tensor(187.3245, device='cuda:1')
benign distance is  tensor(187.3245, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6084697754122317
distance x is tensor(55.9625, device='cuda:1')
benign distance is  tensor(55.9625, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8795237187296152
distance x is tensor(140.1873, device='cuda:1')
benign distance is  tensor(140.1873, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.110977066680789
distance x is tensor(94.8988, device='cuda:1')
benign distance is  tensor(94.8988, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1986788995563984
distance x is tensor(91.8330, device='cuda:1')
benign distance is  tensor(91.8330, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.627569735981524
distance x is tensor(115.6580, device='cuda:1')
benign distance is  tensor(115.6580, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.0839448980987072
distance x is tensor(114.8143, device='cuda:1')
benign distance is  tensor(114.8143, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8873463980853558
distance x is tensor(120.8884, device='cuda:1')
benign distance is  tensor(120.8884, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9285040311515331
distance x is tensor(76.9956, device='cuda:1')
benign distance is  tensor(76.9956, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.870805773884058
distance x is tensor(197.8477, device='cuda:1')
benign distance is  tensor(197.8477, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.8706217631697655
distance x is tensor(144.2731, device='cuda:1')
benign distance is  tensor(144.2731, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6600169744342566
distance x is tensor(118.2611, device='cuda:1')
benign distance is  tensor(118.2611, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.0387362204492092
distance x is tensor(115.2622, device='cuda:1')
benign distance is  tensor(115.2622, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.714639600366354
distance x is tensor(91.4354, device='cuda:1')
benign distance is  tensor(91.4354, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.0564780179411173
distance x is tensor(128.6857, device='cuda:1')
benign distance is  tensor(128.6857, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2850549221038818
distance x is tensor(123.1682, device='cuda:1')
benign distance is  tensor(123.1682, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9901749789714813
distance x is tensor(120.6194, device='cuda:1')
benign distance is  tensor(120.6194, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.746426829136908
distance x is tensor(97.7413, device='cuda:1')
benign distance is  tensor(97.7413, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6378765571862459
distance x is tensor(119.8589, device='cuda:1')
benign distance is  tensor(119.8589, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7821272145956755
distance x is tensor(168.3524, device='cuda:1')
benign distance is  tensor(168.3524, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.1013153903186321
distance x is tensor(90.8071, device='cuda:1')
benign distance is  tensor(90.8071, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.3683426603674889
distance x is tensor(131.1679, device='cuda:1')
benign distance is  tensor(131.1679, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.9105977825820446
distance x is tensor(137.4164, device='cuda:1')
benign distance is  tensor(137.4164, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.0300331935286522
distance x is tensor(85.3979, device='cuda:1')
benign distance is  tensor(85.3979, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6126397456973791
distance x is tensor(153.0195, device='cuda:1')
benign distance is  tensor(153.0195, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.9027176070958376
distance x is tensor(144.8979, device='cuda:1')
benign distance is  tensor(144.8979, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.773417491465807
distance x is tensor(101.2518, device='cuda:1')
benign distance is  tensor(101.2518, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6542164534330368
distance x is tensor(132.8501, device='cuda:1')
benign distance is  tensor(132.8501, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.85000000016
mal_loss is 0.7279382199048996
mal_entropy is 0.1482525507453829
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 89.34% 

Test Accuracy: 85.30% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7793299127370119
distance x is tensor(142.8088, device='cuda:1')
benign distance is  tensor(142.8088, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9441643189638853
distance x is tensor(132.0762, device='cuda:1')
benign distance is  tensor(132.0762, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6819808762520552
distance x is tensor(127.4070, device='cuda:1')
benign distance is  tensor(127.4070, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.050480131059885
distance x is tensor(171.6344, device='cuda:1')
benign distance is  tensor(171.6344, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0976577494293451
distance x is tensor(109.0091, device='cuda:1')
benign distance is  tensor(109.0091, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8092914950102568
distance x is tensor(121.3760, device='cuda:1')
benign distance is  tensor(121.3760, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.117722162976861
distance x is tensor(128.5808, device='cuda:1')
benign distance is  tensor(128.5808, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7223434373736382
distance x is tensor(111.2246, device='cuda:1')
benign distance is  tensor(111.2246, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.63600000016
mal_loss is 4.560785815119743
mal_entropy is 0.15172255551442504
user_PLR len size 36
counter_tensor is  tensor([35.,  9., 12., 21., 35., 33., 35., 27., 23., 23., 23., 23., 23., 23.,
        23., 23., 23., 23., 23., 23., 32., 26., 26.,  7., 33., 21., 33., 23.,
         6., 20., 21.,  3., 10., 30., 33., 28.])
count_res tensor([2.7782e-01, 1.4194e-12, 2.8510e-11, 2.3102e-07, 2.7782e-01, 3.7599e-02,
        2.7782e-01, 9.3198e-05, 1.7070e-06, 1.7070e-06, 1.7070e-06, 1.7070e-06,
        1.7070e-06, 1.7070e-06, 1.7070e-06, 1.7070e-06, 1.7070e-06, 1.7070e-06,
        1.7070e-06, 1.7070e-06, 1.3832e-02, 3.4286e-05, 3.4286e-05, 1.9210e-13,
        3.7599e-02, 2.3102e-07, 3.7599e-02, 1.7070e-06, 7.0668e-14, 8.4986e-08,
        2.3102e-07, 3.5184e-15, 3.8584e-12, 1.8719e-03, 3.7599e-02, 2.5334e-04])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 90.75% 

Test Accuracy: 87.59% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 90.75%
|----0th round Training Accuracy : 95.86%
|----1th round Training Accuracy : 90.76%
|----2th round Training Accuracy : 81.27%
|----3th round Training Accuracy : 91.88%
|----4th round Training Accuracy : 89.69%
|----5th round Training Accuracy : 89.72%
|----6th round Training Accuracy : 92.53%
|----7th round Training Accuracy : 84.33%
|----8th round Training Accuracy : 77.87%
|----9th round Training Accuracy : 83.05%
|----10th round Training Accuracy : 85.46%
|----11th round Training Accuracy : 85.83%
|----12th round Training Accuracy : 90.03%
|----13th round Training Accuracy : 76.71%
|----14th round Training Accuracy : 93.90%
|----15th round Training Accuracy : 90.12%
|----16th round Training Accuracy : 92.71%
|----17th round Training Accuracy : 88.66%
|----18th round Training Accuracy : 92.50%
|----19th round Training Accuracy : 88.91%
|----20th round Training Accuracy : 86.39%
|----21th round Training Accuracy : 82.16%
|----22th round Training Accuracy : 83.65%
|----23th round Training Accuracy : 83.67%
|----24th round Training Accuracy : 88.71%
|----25th round Training Accuracy : 83.23%
|----26th round Training Accuracy : 85.24%
|----27th round Training Accuracy : 82.40%
|----28th round Training Accuracy : 85.20%
|----29th round Training Accuracy : 85.62%
|----30th round Training Accuracy : 88.35%
|----31th round Training Accuracy : 83.15%
|----32th round Training Accuracy : 83.31%
|----33th round Training Accuracy : 89.28%
|----34th round Training Accuracy : 84.94%
|----35th round Training Accuracy : 84.61%
|----36th round Training Accuracy : 87.92%
|----37th round Training Accuracy : 85.07%
|----38th round Training Accuracy : 81.49%
|----39th round Training Accuracy : 88.39%
|----40th round Training Accuracy : 93.03%
|----41th round Training Accuracy : 83.20%
|----42th round Training Accuracy : 86.03%
|----43th round Training Accuracy : 85.07%
|----44th round Training Accuracy : 86.57%
|----45th round Training Accuracy : 82.49%
|----46th round Training Accuracy : 86.45%
|----47th round Training Accuracy : 86.57%
|----48th round Training Accuracy : 89.34%
|----49th round Training Accuracy : 90.75%
|----Final Test Accuracy: 87.59%
|----0th round Final Test Accuracy : 85.73%
|----1th round Final Test Accuracy : 86.92%
|----2th round Final Test Accuracy : 82.76%
|----3th round Final Test Accuracy : 86.73%
|----4th round Final Test Accuracy : 86.08%
|----5th round Final Test Accuracy : 86.32%
|----6th round Final Test Accuracy : 79.60%
|----7th round Final Test Accuracy : 85.60%
|----8th round Final Test Accuracy : 79.23%
|----9th round Final Test Accuracy : 85.58%
|----10th round Final Test Accuracy : 83.30%
|----11th round Final Test Accuracy : 86.12%
|----12th round Final Test Accuracy : 84.08%
|----13th round Final Test Accuracy : 82.44%
|----14th round Final Test Accuracy : 86.86%
|----15th round Final Test Accuracy : 87.42%
|----16th round Final Test Accuracy : 85.41%
|----17th round Final Test Accuracy : 87.23%
|----18th round Final Test Accuracy : 85.78%
|----19th round Final Test Accuracy : 86.19%
|----20th round Final Test Accuracy : 86.97%
|----21th round Final Test Accuracy : 85.22%
|----22th round Final Test Accuracy : 81.67%
|----23th round Final Test Accuracy : 85.78%
|----24th round Final Test Accuracy : 86.08%
|----25th round Final Test Accuracy : 84.67%
|----26th round Final Test Accuracy : 83.49%
|----27th round Final Test Accuracy : 85.07%
|----28th round Final Test Accuracy : 80.22%
|----29th round Final Test Accuracy : 87.33%
|----30th round Final Test Accuracy : 86.20%
|----31th round Final Test Accuracy : 85.46%
|----32th round Final Test Accuracy : 85.79%
|----33th round Final Test Accuracy : 87.72%
|----34th round Final Test Accuracy : 86.10%
|----35th round Final Test Accuracy : 86.35%
|----36th round Final Test Accuracy : 83.59%
|----37th round Final Test Accuracy : 86.32%
|----38th round Final Test Accuracy : 84.29%
|----39th round Final Test Accuracy : 87.17%
|----40th round Final Test Accuracy : 85.64%
|----41th round Final Test Accuracy : 86.12%
|----42th round Final Test Accuracy : 84.36%
|----43th round Final Test Accuracy : 87.15%
|----44th round Final Test Accuracy : 83.76%
|----45th round Final Test Accuracy : 85.19%
|----46th round Final Test Accuracy : 82.10%
|----47th round Final Test Accuracy : 87.16%
|----48th round Final Test Accuracy : 85.30%
|----49th round Final Test Accuracy : 87.59%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 4295.7651
