
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6317389607429504
distance x is tensor(108.0811, device='cuda:0')
benign distance is  tensor(108.0811, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5468820333480835
distance x is tensor(116.5722, device='cuda:0')
benign distance is  tensor(116.5722, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.41697144508361816
distance x is tensor(122.6066, device='cuda:0')
benign distance is  tensor(122.6066, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6926997303962708
distance x is tensor(113.4516, device='cuda:0')
benign distance is  tensor(113.4516, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5808409452438354
distance x is tensor(106.7190, device='cuda:0')
benign distance is  tensor(106.7190, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5444180965423584
distance x is tensor(115.0756, device='cuda:0')
benign distance is  tensor(115.0756, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6266804933547974
distance x is tensor(110.4317, device='cuda:0')
benign distance is  tensor(110.4317, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.33147162199020386
distance x is tensor(134.5384, device='cuda:0')
benign distance is  tensor(134.5384, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.44114047288894653
distance x is tensor(136.5986, device='cuda:0')
benign distance is  tensor(136.5986, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4674607813358307
distance x is tensor(138.7020, device='cuda:0')
benign distance is  tensor(138.7020, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5003332495689392
distance x is tensor(133.2081, device='cuda:0')
benign distance is  tensor(133.2081, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.10279247909784317
distance x is tensor(127.5852, device='cuda:0')
benign distance is  tensor(127.5852, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5082347393035889
distance x is tensor(129.3613, device='cuda:0')
benign distance is  tensor(129.3613, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3699326515197754
distance x is tensor(142.3354, device='cuda:0')
benign distance is  tensor(142.3354, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.957433819770813
distance x is tensor(136.2448, device='cuda:0')
benign distance is  tensor(136.2448, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.36910444498062134
distance x is tensor(138.6353, device='cuda:0')
benign distance is  tensor(138.6353, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.296194463968277
distance x is tensor(125.5432, device='cuda:0')
benign distance is  tensor(125.5432, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7542265057563782
distance x is tensor(148.2885, device='cuda:0')
benign distance is  tensor(148.2885, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4830937385559082
distance x is tensor(127.1939, device='cuda:0')
benign distance is  tensor(127.1939, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.541790783405304
distance x is tensor(126.6962, device='cuda:0')
benign distance is  tensor(126.6962, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.11974801868200302
distance x is tensor(128.3358, device='cuda:0')
benign distance is  tensor(128.3358, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.3279534876346588
distance x is tensor(128.3058, device='cuda:0')
benign distance is  tensor(128.3058, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.11956598609685898
distance x is tensor(143.3591, device='cuda:0')
benign distance is  tensor(143.3591, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.9521692991256714
distance x is tensor(131.7903, device='cuda:0')
benign distance is  tensor(131.7903, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.6039416790008545
distance x is tensor(142.4296, device='cuda:0')
benign distance is  tensor(142.4296, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6184865236282349
distance x is tensor(120.2996, device='cuda:0')
benign distance is  tensor(120.2996, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.6165168285369873
distance x is tensor(138.4376, device='cuda:0')
benign distance is  tensor(138.4376, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.28445982933044434
distance x is tensor(138.9273, device='cuda:0')
benign distance is  tensor(138.9273, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7930451035499573
distance x is tensor(120.4460, device='cuda:0')
benign distance is  tensor(120.4460, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9276207089424133
distance x is tensor(139.1733, device='cuda:0')
benign distance is  tensor(139.1733, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.42358821630477905
distance x is tensor(129.1448, device='cuda:0')
benign distance is  tensor(129.1448, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.9090867042541504
distance x is tensor(141.5592, device='cuda:0')
benign distance is  tensor(141.5592, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.39281323552131653
distance x is tensor(134.3114, device='cuda:0')
benign distance is  tensor(134.3114, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.27809473872184753
distance x is tensor(124.0416, device='cuda:0')
benign distance is  tensor(124.0416, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6139391660690308
distance x is tensor(137.4853, device='cuda:0')
benign distance is  tensor(137.4853, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.03748206049203873
distance x is tensor(122.4952, device='cuda:0')
benign distance is  tensor(122.4952, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.3728678822517395
distance x is tensor(129.6330, device='cuda:0')
benign distance is  tensor(129.6330, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.31203657388687134
distance x is tensor(121.9810, device='cuda:0')
benign distance is  tensor(121.9810, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.30640316009521484
distance x is tensor(128.6694, device='cuda:0')
benign distance is  tensor(128.6694, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.18487438559532166
distance x is tensor(131.9419, device='cuda:0')
benign distance is  tensor(131.9419, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.13781945407390594
distance x is tensor(129.2164, device='cuda:0')
benign distance is  tensor(129.2164, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.18933308124542236
distance x is tensor(121.5421, device='cuda:0')
benign distance is  tensor(121.5421, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.12968425452709198
distance x is tensor(137.6080, device='cuda:0')
benign distance is  tensor(137.6080, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.3698187470436096
distance x is tensor(133.9254, device='cuda:0')
benign distance is  tensor(133.9254, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.1895950883626938
distance x is tensor(136.6324, device='cuda:0')
benign distance is  tensor(136.6324, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6446059346199036
distance x is tensor(130.1653, device='cuda:0')
benign distance is  tensor(130.1653, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7602760791778564
distance x is tensor(134.1785, device='cuda:0')
benign distance is  tensor(134.1785, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.17993786931037903
distance x is tensor(136.5596, device='cuda:0')
benign distance is  tensor(136.5596, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.343068391084671
mal_entropy is 0.1730051338672638
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 88.32% 

Test Accuracy: 87.37% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7605704069137573
distance x is tensor(110.2876, device='cuda:0')
benign distance is  tensor(110.2876, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9079330563545227
distance x is tensor(120.6380, device='cuda:0')
benign distance is  tensor(120.6380, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.34272024035453796
distance x is tensor(122.8651, device='cuda:0')
benign distance is  tensor(122.8651, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4791185259819031
distance x is tensor(118.4633, device='cuda:0')
benign distance is  tensor(118.4633, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7562909722328186
distance x is tensor(100.0658, device='cuda:0')
benign distance is  tensor(100.0658, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7822333574295044
distance x is tensor(129.7619, device='cuda:0')
benign distance is  tensor(129.7619, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6555880308151245
distance x is tensor(120.5957, device='cuda:0')
benign distance is  tensor(120.5957, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.24778084456920624
distance x is tensor(128.8706, device='cuda:0')
benign distance is  tensor(128.8706, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.6961032748222351
mal_entropy is 0.39407309889793396
user_PLR len size 28
counter_tensor is  tensor([12., 15., 12., 12., 13., 13., 26.,  0., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 13., 12., 12., 13., 26., 12., 27.])
count_res tensor([1.7621e-07, 3.5394e-06, 1.7621e-07, 1.7621e-07, 4.7900e-07, 4.7900e-07,
        2.1192e-01, 1.0827e-12, 9.6210e-06, 9.6210e-06, 9.6210e-06, 9.6210e-06,
        9.6210e-06, 9.6210e-06, 9.6210e-06, 9.6210e-06, 9.6210e-06, 9.6210e-06,
        9.6210e-06, 9.6210e-06, 1.7621e-07, 4.7900e-07, 1.7621e-07, 1.7621e-07,
        4.7900e-07, 2.1192e-01, 1.7621e-07, 5.7605e-01])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 88.81% 

Test Accuracy: 87.34% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3957310914993286
distance x is tensor(126.5834, device='cuda:0')
benign distance is  tensor(126.5834, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.43781715631484985
distance x is tensor(117.9636, device='cuda:0')
benign distance is  tensor(117.9636, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7850579023361206
distance x is tensor(129.1025, device='cuda:0')
benign distance is  tensor(129.1025, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4633762836456299
distance x is tensor(113.6362, device='cuda:0')
benign distance is  tensor(113.6362, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5613380670547485
distance x is tensor(119.2148, device='cuda:0')
benign distance is  tensor(119.2148, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2115685939788818
distance x is tensor(125.2938, device='cuda:0')
benign distance is  tensor(125.2938, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.34997352957725525
distance x is tensor(125.1344, device='cuda:0')
benign distance is  tensor(125.1344, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.21737833321094513
distance x is tensor(125.6346, device='cuda:0')
benign distance is  tensor(125.6346, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.1524435132741928
distance x is tensor(145.6633, device='cuda:0')
benign distance is  tensor(145.6633, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5486115217208862
distance x is tensor(141.8436, device='cuda:0')
benign distance is  tensor(141.8436, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.589360237121582
distance x is tensor(141.2613, device='cuda:0')
benign distance is  tensor(141.2613, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7387956380844116
distance x is tensor(131.9833, device='cuda:0')
benign distance is  tensor(131.9833, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5211180448532104
distance x is tensor(138.6769, device='cuda:0')
benign distance is  tensor(138.6769, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4601562023162842
distance x is tensor(133.2663, device='cuda:0')
benign distance is  tensor(133.2663, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.37373894453048706
distance x is tensor(136.5598, device='cuda:0')
benign distance is  tensor(136.5598, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.38516736030578613
distance x is tensor(98.2801, device='cuda:0')
benign distance is  tensor(98.2801, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.8384275436401367
mal_entropy is 0.04851188883185387
user_PLR len size 28
counter_tensor is  tensor([16., 19., 17., 25., 24., 21., 23.,  7., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 25., 24., 19., 26., 23., 24., 27., 27.])
count_res tensor([5.9059e-06, 1.1862e-04, 1.6054e-05, 4.7856e-02, 1.7605e-02, 8.7652e-04,
        6.4766e-03, 7.2885e-10, 5.9059e-06, 5.9059e-06, 5.9059e-06, 5.9059e-06,
        5.9059e-06, 5.9059e-06, 5.9059e-06, 5.9059e-06, 5.9059e-06, 5.9059e-06,
        5.9059e-06, 5.9059e-06, 4.7856e-02, 1.7605e-02, 1.1862e-04, 1.3009e-01,
        6.4766e-03, 1.7605e-02, 3.5361e-01, 3.5361e-01])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 89.02% 

Test Accuracy: 88.67% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6167359352111816
distance x is tensor(120.3957, device='cuda:0')
benign distance is  tensor(120.3957, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.736427903175354
distance x is tensor(111.7663, device='cuda:0')
benign distance is  tensor(111.7663, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2592815160751343
distance x is tensor(125.1058, device='cuda:0')
benign distance is  tensor(125.1058, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5423195958137512
distance x is tensor(112.6957, device='cuda:0')
benign distance is  tensor(112.6957, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.20398037135601044
distance x is tensor(108.9310, device='cuda:0')
benign distance is  tensor(108.9310, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.33218395709991455
distance x is tensor(123.1003, device='cuda:0')
benign distance is  tensor(123.1003, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.15083099901676178
distance x is tensor(122.3846, device='cuda:0')
benign distance is  tensor(122.3846, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7169390320777893
distance x is tensor(135.1404, device='cuda:0')
benign distance is  tensor(135.1404, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.7681945562362671
distance x is tensor(131.7685, device='cuda:0')
benign distance is  tensor(131.7685, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.2089563608169556
distance x is tensor(140.1083, device='cuda:0')
benign distance is  tensor(140.1083, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.32489919662475586
distance x is tensor(126.7681, device='cuda:0')
benign distance is  tensor(126.7681, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.1405543088912964
distance x is tensor(130.1929, device='cuda:0')
benign distance is  tensor(130.1929, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.12944602966308594
distance x is tensor(136.8666, device='cuda:0')
benign distance is  tensor(136.8666, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.372464120388031
distance x is tensor(132.4104, device='cuda:0')
benign distance is  tensor(132.4104, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4917382299900055
distance x is tensor(119.5535, device='cuda:0')
benign distance is  tensor(119.5535, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.14918987452983856
distance x is tensor(105.8138, device='cuda:0')
benign distance is  tensor(105.8138, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.19250379502773285
mal_entropy is 0.2268880158662796
user_PLR len size 36
counter_tensor is  tensor([16., 15.,  4., 14., 22., 13., 18.,  3., 21., 21., 21., 21., 21., 21.,
        21., 21., 21., 21., 21., 21., 14.,  2., 18., 17., 35.,  1., 30., 35.,
        19., 14., 18., 33., 33., 19., 33., 15.])
count_res tensor([2.3222e-09, 8.5427e-10, 1.4268e-14, 3.1427e-10, 9.3682e-07, 1.1561e-10,
        1.7159e-08, 5.2488e-15, 3.4464e-07, 3.4464e-07, 3.4464e-07, 3.4464e-07,
        3.4464e-07, 3.4464e-07, 3.4464e-07, 3.4464e-07, 3.4464e-07, 3.4464e-07,
        3.4464e-07, 3.4464e-07, 3.1427e-10, 1.9309e-15, 1.7159e-08, 6.3123e-09,
        4.1446e-01, 7.1035e-16, 2.7926e-03, 4.1446e-01, 4.6642e-08, 3.1427e-10,
        1.7159e-08, 5.6092e-02, 5.6092e-02, 4.6642e-08, 5.6092e-02, 8.5427e-10])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 89.12% 

Test Accuracy: 88.42% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4349397122859955
distance x is tensor(119.4298, device='cuda:0')
benign distance is  tensor(119.4298, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8529931306838989
distance x is tensor(123.5561, device='cuda:0')
benign distance is  tensor(123.5561, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.037118397653102875
distance x is tensor(124.1557, device='cuda:0')
benign distance is  tensor(124.1557, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2831268906593323
distance x is tensor(111.2268, device='cuda:0')
benign distance is  tensor(111.2268, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7394332885742188
distance x is tensor(113.0946, device='cuda:0')
benign distance is  tensor(113.0946, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.022498369216919
distance x is tensor(118.7713, device='cuda:0')
benign distance is  tensor(118.7713, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.10080405324697495
distance x is tensor(112.1245, device='cuda:0')
benign distance is  tensor(112.1245, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6710460782051086
distance x is tensor(125.3959, device='cuda:0')
benign distance is  tensor(125.3959, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8159961700439453
distance x is tensor(142.4877, device='cuda:0')
benign distance is  tensor(142.4877, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4573829174041748
distance x is tensor(142.5002, device='cuda:0')
benign distance is  tensor(142.5002, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0016591548919678
distance x is tensor(128.0937, device='cuda:0')
benign distance is  tensor(128.0937, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.020578145980835
distance x is tensor(134.9318, device='cuda:0')
benign distance is  tensor(134.9318, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5671877861022949
distance x is tensor(128.2735, device='cuda:0')
benign distance is  tensor(128.2735, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.17898063361644745
distance x is tensor(138.3586, device='cuda:0')
benign distance is  tensor(138.3586, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.49691256880760193
distance x is tensor(130.1259, device='cuda:0')
benign distance is  tensor(130.1259, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9324191212654114
distance x is tensor(137.1714, device='cuda:0')
benign distance is  tensor(137.1714, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9876014590263367
distance x is tensor(137.3257, device='cuda:0')
benign distance is  tensor(137.3257, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.0533154010772705
distance x is tensor(139.4814, device='cuda:0')
benign distance is  tensor(139.4814, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3598805367946625
distance x is tensor(137.4379, device='cuda:0')
benign distance is  tensor(137.4379, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.9114173650741577
distance x is tensor(144.8175, device='cuda:0')
benign distance is  tensor(144.8175, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.6255964040756226
distance x is tensor(106.9254, device='cuda:0')
benign distance is  tensor(106.9254, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5876898169517517
distance x is tensor(131.3411, device='cuda:0')
benign distance is  tensor(131.3411, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.18011580407619476
distance x is tensor(136.8273, device='cuda:0')
benign distance is  tensor(136.8273, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.22517362236976624
distance x is tensor(116.3602, device='cuda:0')
benign distance is  tensor(116.3602, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.36276882886886597
mal_entropy is 0.1399499922990799
user_PLR len size 28
counter_tensor is  tensor([13., 13., 13., 17., 16., 20., 13., 15., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16.,  0., 12., 22., 12., 13., 24., 12., 24.])
count_res tensor([7.7353e-06, 7.7353e-06, 7.7353e-06, 4.2233e-04, 1.5537e-04, 8.4828e-03,
        7.7353e-06, 5.7157e-05, 1.5537e-04, 1.5537e-04, 1.5537e-04, 1.5537e-04,
        1.5537e-04, 1.5537e-04, 1.5537e-04, 1.5537e-04, 1.5537e-04, 1.5537e-04,
        1.5537e-04, 1.5537e-04, 1.7484e-11, 2.8457e-06, 6.2680e-02, 2.8457e-06,
        7.7353e-06, 4.6315e-01, 2.8457e-06, 4.6315e-01])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 88.73% 

Test Accuracy: 87.96% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7020529508590698
distance x is tensor(105.9919, device='cuda:0')
benign distance is  tensor(105.9919, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5232702493667603
distance x is tensor(118.7190, device='cuda:0')
benign distance is  tensor(118.7190, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.26129835844039917
distance x is tensor(132.1090, device='cuda:0')
benign distance is  tensor(132.1090, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9816116094589233
distance x is tensor(130.7785, device='cuda:0')
benign distance is  tensor(130.7785, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.33340489864349365
distance x is tensor(119.7401, device='cuda:0')
benign distance is  tensor(119.7401, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6855158805847168
distance x is tensor(133.7216, device='cuda:0')
benign distance is  tensor(133.7216, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2242847979068756
distance x is tensor(117.6417, device='cuda:0')
benign distance is  tensor(117.6417, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.06796570867300034
distance x is tensor(135.5357, device='cuda:0')
benign distance is  tensor(135.5357, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.4993497431278229
distance x is tensor(131.0771, device='cuda:0')
benign distance is  tensor(131.0771, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.1945030689239502
distance x is tensor(134.9531, device='cuda:0')
benign distance is  tensor(134.9531, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.38725751638412476
distance x is tensor(140.5643, device='cuda:0')
benign distance is  tensor(140.5643, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.2171127051115036
distance x is tensor(138.4566, device='cuda:0')
benign distance is  tensor(138.4566, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4226926863193512
distance x is tensor(136.2025, device='cuda:0')
benign distance is  tensor(136.2025, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.3133188784122467
distance x is tensor(129.1965, device='cuda:0')
benign distance is  tensor(129.1965, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.5931861996650696
distance x is tensor(129.8688, device='cuda:0')
benign distance is  tensor(129.8688, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.5468393564224243
distance x is tensor(112.2197, device='cuda:0')
benign distance is  tensor(112.2197, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.22688019275665283
mal_entropy is 0.11880272626876831
user_PLR len size 44
counter_tensor is  tensor([ 0.,  0.,  0.,  0., 15., 35.,  0., 12., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 12., 14., 42., 12., 12., 37., 12., 42.,
        28., 30., 26., 25., 12., 32., 40., 41., 12.,  0.,  1., 43., 21., 43.,
        41.,  0.])
count_res tensor([6.9139e-20, 6.9139e-20, 6.9139e-20, 6.9139e-20, 2.2602e-13, 1.0966e-04,
        6.9139e-20, 1.1253e-14, 5.4594e-06, 5.4594e-06, 5.4594e-06, 5.4594e-06,
        5.4594e-06, 5.4594e-06, 5.4594e-06, 5.4594e-06, 5.4594e-06, 5.4594e-06,
        5.4594e-06, 5.4594e-06, 1.1253e-14, 8.3147e-14, 1.2025e-01, 1.1253e-14,
        1.1253e-14, 8.1025e-04, 1.1253e-14, 1.2025e-01, 9.9993e-08, 7.3885e-07,
        1.3533e-08, 4.9783e-09, 1.1253e-14, 5.4594e-06, 1.6274e-02, 4.4238e-02,
        1.1253e-14, 6.9139e-20, 1.8794e-19, 3.2688e-01, 9.1181e-11, 3.2688e-01,
        4.4238e-02, 6.9139e-20])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 89.12% 

Test Accuracy: 88.45% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2325899600982666
distance x is tensor(111.9857, device='cuda:0')
benign distance is  tensor(111.9857, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6591457724571228
distance x is tensor(114.5434, device='cuda:0')
benign distance is  tensor(114.5434, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.06357978284358978
distance x is tensor(125.0857, device='cuda:0')
benign distance is  tensor(125.0857, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6621890664100647
distance x is tensor(105.3998, device='cuda:0')
benign distance is  tensor(105.3998, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2223408222198486
distance x is tensor(118.7107, device='cuda:0')
benign distance is  tensor(118.7107, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4919745922088623
distance x is tensor(129.9640, device='cuda:0')
benign distance is  tensor(129.9640, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2600591778755188
distance x is tensor(117.4887, device='cuda:0')
benign distance is  tensor(117.4887, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.35444578528404236
distance x is tensor(123.3365, device='cuda:0')
benign distance is  tensor(123.3365, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2562662363052368
distance x is tensor(129.9830, device='cuda:0')
benign distance is  tensor(129.9830, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5333706140518188
distance x is tensor(128.4696, device='cuda:0')
benign distance is  tensor(128.4696, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.2749128043651581
distance x is tensor(129.3710, device='cuda:0')
benign distance is  tensor(129.3710, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.494223028421402
distance x is tensor(117.5237, device='cuda:0')
benign distance is  tensor(117.5237, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4379623532295227
distance x is tensor(121.6795, device='cuda:0')
benign distance is  tensor(121.6795, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.20494167506694794
distance x is tensor(110.4371, device='cuda:0')
benign distance is  tensor(110.4371, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6156184077262878
distance x is tensor(127.1606, device='cuda:0')
benign distance is  tensor(127.1606, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8769086599349976
distance x is tensor(140.9265, device='cuda:0')
benign distance is  tensor(140.9265, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.40179187059402466
distance x is tensor(125.4762, device='cuda:0')
benign distance is  tensor(125.4762, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5607844591140747
distance x is tensor(148.7910, device='cuda:0')
benign distance is  tensor(148.7910, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.478689581155777
distance x is tensor(121.3440, device='cuda:0')
benign distance is  tensor(121.3440, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4531264305114746
distance x is tensor(132.4173, device='cuda:0')
benign distance is  tensor(132.4173, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5972352623939514
distance x is tensor(127.3955, device='cuda:0')
benign distance is  tensor(127.3955, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5948770642280579
distance x is tensor(113.6986, device='cuda:0')
benign distance is  tensor(113.6986, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.23630158603191376
distance x is tensor(125.1125, device='cuda:0')
benign distance is  tensor(125.1125, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.562513530254364
distance x is tensor(129.9551, device='cuda:0')
benign distance is  tensor(129.9551, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.10416970402002335
distance x is tensor(122.5988, device='cuda:0')
benign distance is  tensor(122.5988, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.4523777365684509
distance x is tensor(125.5919, device='cuda:0')
benign distance is  tensor(125.5919, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.20938587188720703
distance x is tensor(126.0415, device='cuda:0')
benign distance is  tensor(126.0415, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.3562341630458832
distance x is tensor(131.2563, device='cuda:0')
benign distance is  tensor(131.2563, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.3200347125530243
distance x is tensor(128.2839, device='cuda:0')
benign distance is  tensor(128.2839, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7122846841812134
distance x is tensor(133.5975, device='cuda:0')
benign distance is  tensor(133.5975, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.37932074069976807
distance x is tensor(135.5666, device='cuda:0')
benign distance is  tensor(135.5666, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.8384404182434082
distance x is tensor(117.4267, device='cuda:0')
benign distance is  tensor(117.4267, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.9752704501152039
mal_entropy is 0.08076222985982895
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 13., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7948e-05, 2.7948e-05, 2.7948e-05, 2.7948e-05, 2.7948e-05, 7.5970e-05,
        2.7948e-05, 2.7948e-05, 8.3311e-02, 8.3311e-02, 8.3311e-02, 8.3311e-02,
        8.3311e-02, 8.3311e-02, 8.3311e-02, 8.3311e-02, 8.3311e-02, 8.3311e-02,
        8.3311e-02, 8.3311e-02])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 86.78% 

Test Accuracy: 85.91% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5319578647613525
distance x is tensor(127.9476, device='cuda:0')
benign distance is  tensor(127.9476, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.472298264503479
distance x is tensor(124.4000, device='cuda:0')
benign distance is  tensor(124.4000, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.23894640803337097
distance x is tensor(126.1582, device='cuda:0')
benign distance is  tensor(126.1582, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6830354928970337
distance x is tensor(118.0041, device='cuda:0')
benign distance is  tensor(118.0041, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0713775157928467
distance x is tensor(108.0809, device='cuda:0')
benign distance is  tensor(108.0809, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.4526158571243286
distance x is tensor(135.3369, device='cuda:0')
benign distance is  tensor(135.3369, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.11019867658615112
distance x is tensor(125.7922, device='cuda:0')
benign distance is  tensor(125.7922, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.26066452264785767
distance x is tensor(129.7260, device='cuda:0')
benign distance is  tensor(129.7260, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8000000005000001
mal_loss is 1.7141650915145874
mal_entropy is 0.20578716695308685
user_PLR len size 36
counter_tensor is  tensor([35., 34.,  0., 30., 33.,  0., 31., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 34., 29., 35.,  0., 12.,  0., 34., 34.,
        33., 34., 33., 26., 34., 35.,  0., 35.])
count_res tensor([1.5058e-01, 5.5394e-02, 9.4940e-17, 1.0146e-03, 2.0378e-02, 9.4940e-17,
        2.7579e-03, 1.5452e-11, 2.5149e-06, 2.5149e-06, 2.5149e-06, 2.5149e-06,
        2.5149e-06, 2.5149e-06, 2.5149e-06, 2.5149e-06, 2.5149e-06, 2.5149e-06,
        2.5149e-06, 2.5149e-06, 5.5394e-02, 3.7324e-04, 1.5058e-01, 9.4940e-17,
        1.5452e-11, 9.4940e-17, 5.5394e-02, 5.5394e-02, 2.0378e-02, 5.5394e-02,
        2.0378e-02, 1.8583e-05, 5.5394e-02, 1.5058e-01, 9.4940e-17, 1.5058e-01])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 89.58% 

Test Accuracy: 88.62% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9976112246513367
distance x is tensor(96.2952, device='cuda:0')
benign distance is  tensor(96.2952, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.45383644104003906
distance x is tensor(121.4059, device='cuda:0')
benign distance is  tensor(121.4059, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.0746096819639206
distance x is tensor(134.1685, device='cuda:0')
benign distance is  tensor(134.1685, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9271272420883179
distance x is tensor(106.9689, device='cuda:0')
benign distance is  tensor(106.9689, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4582591950893402
distance x is tensor(105.5247, device='cuda:0')
benign distance is  tensor(105.5247, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4518459439277649
distance x is tensor(125.8029, device='cuda:0')
benign distance is  tensor(125.8029, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6370027661323547
distance x is tensor(118.2182, device='cuda:0')
benign distance is  tensor(118.2182, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8545032739639282
distance x is tensor(121.9449, device='cuda:0')
benign distance is  tensor(121.9449, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5090811848640442
distance x is tensor(132.6898, device='cuda:0')
benign distance is  tensor(132.6898, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3437720537185669
distance x is tensor(125.3318, device='cuda:0')
benign distance is  tensor(125.3318, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6630348563194275
distance x is tensor(121.4074, device='cuda:0')
benign distance is  tensor(121.4074, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7302181124687195
distance x is tensor(117.8806, device='cuda:0')
benign distance is  tensor(117.8806, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.38979631662368774
distance x is tensor(113.8643, device='cuda:0')
benign distance is  tensor(113.8643, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2667106091976166
distance x is tensor(112.7022, device='cuda:0')
benign distance is  tensor(112.7022, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3746783137321472
distance x is tensor(119.8889, device='cuda:0')
benign distance is  tensor(119.8889, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.1274087280035019
distance x is tensor(125.7877, device='cuda:0')
benign distance is  tensor(125.7877, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.49251070618629456
distance x is tensor(133.4581, device='cuda:0')
benign distance is  tensor(133.4581, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.8044471740722656
distance x is tensor(125.1784, device='cuda:0')
benign distance is  tensor(125.1784, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.2505466938018799
distance x is tensor(122.2296, device='cuda:0')
benign distance is  tensor(122.2296, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.34376341104507446
distance x is tensor(133.8388, device='cuda:0')
benign distance is  tensor(133.8388, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6850069761276245
distance x is tensor(116.1316, device='cuda:0')
benign distance is  tensor(116.1316, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8042329549789429
distance x is tensor(122.7898, device='cuda:0')
benign distance is  tensor(122.7898, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5789030194282532
distance x is tensor(125.2877, device='cuda:0')
benign distance is  tensor(125.2877, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.28733259439468384
distance x is tensor(103.7111, device='cuda:0')
benign distance is  tensor(103.7111, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.4296821653842926
mal_entropy is 0.1019444614648819
user_PLR len size 28
counter_tensor is  tensor([12., 12., 12., 12.,  0., 27., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 16., 12., 12., 26., 27., 12., 12., 12.])
count_res tensor([1.2918e-07, 1.2918e-07, 1.2918e-07, 1.2918e-07, 7.9369e-13, 4.2228e-01,
        1.2918e-07, 1.2918e-07, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06,
        7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06,
        7.0528e-06, 7.0528e-06, 7.0528e-06, 1.2918e-07, 1.2918e-07, 1.5535e-01,
        4.2228e-01, 1.2918e-07, 1.2918e-07, 1.2918e-07])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 89.19% 

Test Accuracy: 88.55% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0208443403244019
distance x is tensor(105.9997, device='cuda:0')
benign distance is  tensor(105.9997, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6121489405632019
distance x is tensor(131.7153, device='cuda:0')
benign distance is  tensor(131.7153, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4841349124908447
distance x is tensor(132.8044, device='cuda:0')
benign distance is  tensor(132.8044, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5755886435508728
distance x is tensor(117.1622, device='cuda:0')
benign distance is  tensor(117.1622, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7376421093940735
distance x is tensor(112.9396, device='cuda:0')
benign distance is  tensor(112.9396, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5340299010276794
distance x is tensor(97.7969, device='cuda:0')
benign distance is  tensor(97.7969, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.840710461139679
distance x is tensor(125.8518, device='cuda:0')
benign distance is  tensor(125.8518, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8750240206718445
distance x is tensor(113.5481, device='cuda:0')
benign distance is  tensor(113.5481, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3624325394630432
distance x is tensor(131.3793, device='cuda:0')
benign distance is  tensor(131.3793, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.0240139961242676
distance x is tensor(148.4220, device='cuda:0')
benign distance is  tensor(148.4220, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5116040706634521
distance x is tensor(131.5626, device='cuda:0')
benign distance is  tensor(131.5626, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3881280720233917
distance x is tensor(135.6748, device='cuda:0')
benign distance is  tensor(135.6748, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.42884770035743713
distance x is tensor(116.6166, device='cuda:0')
benign distance is  tensor(116.6166, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8705042600631714
distance x is tensor(127.0208, device='cuda:0')
benign distance is  tensor(127.0208, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.0975419282913208
distance x is tensor(134.0152, device='cuda:0')
benign distance is  tensor(134.0152, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8500167727470398
distance x is tensor(130.4126, device='cuda:0')
benign distance is  tensor(130.4126, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.379891574382782
mal_entropy is 0.14443345367908478
user_PLR len size 36
counter_tensor is  tensor([13., 33.,  0., 33., 12.,  1., 13.,  0., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24.,  0., 29., 23., 12., 12., 33., 12., 32.,
        12., 19.,  0., 35., 23., 25., 13., 12.])
count_res tensor([1.9125e-10, 9.2789e-02, 4.3229e-16, 9.2789e-02, 7.0358e-11, 1.1751e-15,
        1.9125e-10, 4.3229e-16, 1.1451e-05, 1.1451e-05, 1.1451e-05, 1.1451e-05,
        1.1451e-05, 1.1451e-05, 1.1451e-05, 1.1451e-05, 1.1451e-05, 1.1451e-05,
        1.1451e-05, 1.1451e-05, 4.3229e-16, 1.6995e-03, 4.2126e-06, 7.0358e-11,
        7.0358e-11, 9.2789e-02, 7.0358e-11, 3.4135e-02, 7.0358e-11, 7.7157e-08,
        4.3229e-16, 6.8562e-01, 4.2126e-06, 3.1127e-05, 1.9125e-10, 7.0358e-11])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 88.34% 

Test Accuracy: 87.72% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9246320724487305
distance x is tensor(109.8145, device='cuda:0')
benign distance is  tensor(109.8145, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.649029016494751
distance x is tensor(129.5163, device='cuda:0')
benign distance is  tensor(129.5163, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.22668442130088806
distance x is tensor(138.5520, device='cuda:0')
benign distance is  tensor(138.5520, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.43057194352149963
distance x is tensor(124.6398, device='cuda:0')
benign distance is  tensor(124.6398, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6837795972824097
distance x is tensor(110.5429, device='cuda:0')
benign distance is  tensor(110.5429, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8525271415710449
distance x is tensor(138.4319, device='cuda:0')
benign distance is  tensor(138.4319, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.16963496804237366
distance x is tensor(128.9750, device='cuda:0')
benign distance is  tensor(128.9750, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.35033103823661804
distance x is tensor(130.7170, device='cuda:0')
benign distance is  tensor(130.7170, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.67386794090271
distance x is tensor(151.8045, device='cuda:0')
benign distance is  tensor(151.8045, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6061927676200867
distance x is tensor(139.7016, device='cuda:0')
benign distance is  tensor(139.7016, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2274366617202759
distance x is tensor(132.7143, device='cuda:0')
benign distance is  tensor(132.7143, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7000976800918579
distance x is tensor(94.9806, device='cuda:0')
benign distance is  tensor(94.9806, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6576637625694275
distance x is tensor(131.0060, device='cuda:0')
benign distance is  tensor(131.0060, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5631545782089233
distance x is tensor(125.7876, device='cuda:0')
benign distance is  tensor(125.7876, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4442499577999115
distance x is tensor(132.9593, device='cuda:0')
benign distance is  tensor(132.9593, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0363585948944092
distance x is tensor(138.3826, device='cuda:0')
benign distance is  tensor(138.3826, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.28787556290626526
distance x is tensor(145.5124, device='cuda:0')
benign distance is  tensor(145.5124, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.21999183297157288
distance x is tensor(146.5865, device='cuda:0')
benign distance is  tensor(146.5865, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.33604851365089417
distance x is tensor(137.3688, device='cuda:0')
benign distance is  tensor(137.3688, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.14706793427467346
distance x is tensor(132.1132, device='cuda:0')
benign distance is  tensor(132.1132, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7582229971885681
distance x is tensor(139.6068, device='cuda:0')
benign distance is  tensor(139.6068, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.3888201117515564
distance x is tensor(143.2419, device='cuda:0')
benign distance is  tensor(143.2419, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.5318199396133423
distance x is tensor(138.0463, device='cuda:0')
benign distance is  tensor(138.0463, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.13169758021831512
distance x is tensor(134.2429, device='cuda:0')
benign distance is  tensor(134.2429, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 1.7963101863861084
mal_entropy is 0.07501492649316788
user_PLR len size 20
counter_tensor is  tensor([12., 12., 18., 12., 16., 12., 12., 15., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7583e-05, 2.7583e-05, 1.1128e-02, 2.7583e-05, 1.5060e-03, 2.7583e-05,
        2.7583e-05, 5.5401e-04, 8.2223e-02, 8.2223e-02, 8.2223e-02, 8.2223e-02,
        8.2223e-02, 8.2223e-02, 8.2223e-02, 8.2223e-02, 8.2223e-02, 8.2223e-02,
        8.2223e-02, 8.2223e-02])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 85.37% 

Test Accuracy: 84.53% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4553585946559906
distance x is tensor(133.6145, device='cuda:0')
benign distance is  tensor(133.6145, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.016278862953186
distance x is tensor(137.8237, device='cuda:0')
benign distance is  tensor(137.8237, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3745475113391876
distance x is tensor(154.5758, device='cuda:0')
benign distance is  tensor(154.5758, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5003988146781921
distance x is tensor(138.2657, device='cuda:0')
benign distance is  tensor(138.2657, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5072896480560303
distance x is tensor(130.7454, device='cuda:0')
benign distance is  tensor(130.7454, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1786789894104004
distance x is tensor(152.5455, device='cuda:0')
benign distance is  tensor(152.5455, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1748974621295929
distance x is tensor(142.3491, device='cuda:0')
benign distance is  tensor(142.3491, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4204738736152649
distance x is tensor(141.2980, device='cuda:0')
benign distance is  tensor(141.2980, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.6000000005
mal_loss is 3.0176148414611816
mal_entropy is 0.2099815160036087
user_PLR len size 52
counter_tensor is  tensor([14., 10.,  7., 51., 46., 49., 51., 45., 14., 14., 14., 14., 14., 14.,
        14., 14., 14., 14., 14., 14., 50., 46., 50., 44.,  7., 12., 46., 49.,
        50.,  0., 49., 47., 39., 50., 51., 31., 51., 49., 16., 51., 51., 49.,
         9., 12., 38.,  7., 48., 44., 11.,  3., 37., 38.])
count_res tensor([1.0355e-17, 1.8965e-19, 9.4422e-21, 1.2135e-01, 8.1763e-04, 1.6423e-02,
        1.2135e-01, 3.0079e-04, 1.0355e-17, 1.0355e-17, 1.0355e-17, 1.0355e-17,
        1.0355e-17, 1.0355e-17, 1.0355e-17, 1.0355e-17, 1.0355e-17, 1.0355e-17,
        1.0355e-17, 1.0355e-17, 4.4641e-02, 8.1763e-04, 4.4641e-02, 1.1065e-04,
        9.4422e-21, 1.4013e-18, 8.1763e-04, 1.6423e-02, 4.4641e-02, 8.6102e-24,
        1.6423e-02, 2.2225e-03, 7.4558e-07, 4.4641e-02, 1.2135e-01, 2.5011e-10,
        1.2135e-01, 1.6423e-02, 7.6511e-17, 1.2135e-01, 1.2135e-01, 1.6423e-02,
        6.9769e-20, 1.4013e-18, 2.7428e-07, 9.4422e-21, 6.0415e-03, 1.1065e-04,
        5.1553e-19, 1.7294e-22, 1.0090e-07, 2.7428e-07])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 89.36% 

Test Accuracy: 88.58% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.21038620173931122
distance x is tensor(108.3388, device='cuda:0')
benign distance is  tensor(108.3388, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9957249760627747
distance x is tensor(111.1808, device='cuda:0')
benign distance is  tensor(111.1808, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.18522849678993225
distance x is tensor(113.3184, device='cuda:0')
benign distance is  tensor(113.3184, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9066821336746216
distance x is tensor(102.9841, device='cuda:0')
benign distance is  tensor(102.9841, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5894399881362915
distance x is tensor(106.6547, device='cuda:0')
benign distance is  tensor(106.6547, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.75067538022995
distance x is tensor(112.4196, device='cuda:0')
benign distance is  tensor(112.4196, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.17526941001415253
distance x is tensor(114.9598, device='cuda:0')
benign distance is  tensor(114.9598, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3140934407711029
distance x is tensor(119.7873, device='cuda:0')
benign distance is  tensor(119.7873, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.1186026930809021
distance x is tensor(136.8564, device='cuda:0')
benign distance is  tensor(136.8564, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.15500105917453766
distance x is tensor(127.8100, device='cuda:0')
benign distance is  tensor(127.8100, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7598461508750916
distance x is tensor(127.0603, device='cuda:0')
benign distance is  tensor(127.0603, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5162023305892944
distance x is tensor(110.3220, device='cuda:0')
benign distance is  tensor(110.3220, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.013724684715271
distance x is tensor(120.5204, device='cuda:0')
benign distance is  tensor(120.5204, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.22214965522289276
distance x is tensor(117.0619, device='cuda:0')
benign distance is  tensor(117.0619, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.505311131477356
distance x is tensor(134.8525, device='cuda:0')
benign distance is  tensor(134.8525, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2734627723693848
distance x is tensor(120.0129, device='cuda:0')
benign distance is  tensor(120.0129, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.6807428598403931
distance x is tensor(116.8934, device='cuda:0')
benign distance is  tensor(116.8934, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6242555379867554
distance x is tensor(138.7993, device='cuda:0')
benign distance is  tensor(138.7993, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5492993593215942
distance x is tensor(123.3682, device='cuda:0')
benign distance is  tensor(123.3682, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.41086626052856445
distance x is tensor(113.7840, device='cuda:0')
benign distance is  tensor(113.7840, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.44847410917282104
distance x is tensor(115.7412, device='cuda:0')
benign distance is  tensor(115.7412, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8056000471115112
distance x is tensor(122.1893, device='cuda:0')
benign distance is  tensor(122.1893, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.30257755517959595
distance x is tensor(130.9962, device='cuda:0')
benign distance is  tensor(130.9962, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4638768136501312
distance x is tensor(130.9200, device='cuda:0')
benign distance is  tensor(130.9200, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.2740975022315979
distance x is tensor(130.8270, device='cuda:0')
benign distance is  tensor(130.8270, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7323528528213501
distance x is tensor(121.6379, device='cuda:0')
benign distance is  tensor(121.6379, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3437964916229248
distance x is tensor(138.7687, device='cuda:0')
benign distance is  tensor(138.7687, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.7959392666816711
distance x is tensor(124.9355, device='cuda:0')
benign distance is  tensor(124.9355, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7300890684127808
distance x is tensor(126.9361, device='cuda:0')
benign distance is  tensor(126.9361, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.43509459495544434
distance x is tensor(123.5207, device='cuda:0')
benign distance is  tensor(123.5207, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4676031172275543
distance x is tensor(118.3122, device='cuda:0')
benign distance is  tensor(118.3122, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.42256125807762146
distance x is tensor(118.4890, device='cuda:0')
benign distance is  tensor(118.4890, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.13399872183799744
distance x is tensor(128.0119, device='cuda:0')
benign distance is  tensor(128.0119, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.48977145552635193
distance x is tensor(129.6345, device='cuda:0')
benign distance is  tensor(129.6345, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.15654036402702332
distance x is tensor(123.1872, device='cuda:0')
benign distance is  tensor(123.1872, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.292855441570282
distance x is tensor(127.4523, device='cuda:0')
benign distance is  tensor(127.4523, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.3170296549797058
distance x is tensor(131.4073, device='cuda:0')
benign distance is  tensor(131.4073, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5430535674095154
distance x is tensor(132.7317, device='cuda:0')
benign distance is  tensor(132.7317, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.007083773612976
distance x is tensor(136.3826, device='cuda:0')
benign distance is  tensor(136.3826, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.2109570950269699
distance x is tensor(124.9758, device='cuda:0')
benign distance is  tensor(124.9758, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.4435358941555023
mal_entropy is 0.08846700191497803
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 88.08% 

Test Accuracy: 87.50% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9570009112358093
distance x is tensor(124.1963, device='cuda:0')
benign distance is  tensor(124.1963, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4684258997440338
distance x is tensor(107.8797, device='cuda:0')
benign distance is  tensor(107.8797, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.32559338212013245
distance x is tensor(130.0656, device='cuda:0')
benign distance is  tensor(130.0656, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3865686357021332
distance x is tensor(121.4589, device='cuda:0')
benign distance is  tensor(121.4589, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.594376266002655
distance x is tensor(117.8175, device='cuda:0')
benign distance is  tensor(117.8175, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.680607795715332
distance x is tensor(118.4802, device='cuda:0')
benign distance is  tensor(118.4802, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.09329478442668915
distance x is tensor(117.5354, device='cuda:0')
benign distance is  tensor(117.5354, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6310747265815735
distance x is tensor(123.4792, device='cuda:0')
benign distance is  tensor(123.4792, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.8118616938591003
mal_entropy is 0.08626370877027512
user_PLR len size 28
counter_tensor is  tensor([12., 12., 26., 12., 27., 12., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 12., 12., 16., 27.,  0., 12.])
count_res tensor([1.2918e-07, 1.2918e-07, 1.5535e-01, 1.2918e-07, 4.2228e-01, 1.2918e-07,
        1.2918e-07, 1.2918e-07, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06,
        7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06,
        7.0528e-06, 7.0528e-06, 1.2918e-07, 1.2918e-07, 1.2918e-07, 1.2918e-07,
        7.0528e-06, 4.2228e-01, 7.9369e-13, 1.2918e-07])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 89.34% 

Test Accuracy: 88.44% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5309513807296753
distance x is tensor(131.6505, device='cuda:0')
benign distance is  tensor(131.6505, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4880101680755615
distance x is tensor(128.5933, device='cuda:0')
benign distance is  tensor(128.5933, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1902952492237091
distance x is tensor(124.0396, device='cuda:0')
benign distance is  tensor(124.0396, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7210555076599121
distance x is tensor(116.0349, device='cuda:0')
benign distance is  tensor(116.0349, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.348522812128067
distance x is tensor(115.2791, device='cuda:0')
benign distance is  tensor(115.2791, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5775450468063354
distance x is tensor(129.3368, device='cuda:0')
benign distance is  tensor(129.3368, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.35901713371276855
distance x is tensor(133.8330, device='cuda:0')
benign distance is  tensor(133.8330, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.37733855843544006
distance x is tensor(124.7021, device='cuda:0')
benign distance is  tensor(124.7021, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.39606934785842896
distance x is tensor(147.9319, device='cuda:0')
benign distance is  tensor(147.9319, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8879558444023132
distance x is tensor(136.9374, device='cuda:0')
benign distance is  tensor(136.9374, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9361669421195984
distance x is tensor(137.5106, device='cuda:0')
benign distance is  tensor(137.5106, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8179027438163757
distance x is tensor(120.9234, device='cuda:0')
benign distance is  tensor(120.9234, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.48764070868492126
distance x is tensor(141.5873, device='cuda:0')
benign distance is  tensor(141.5873, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.32021790742874146
distance x is tensor(113.3805, device='cuda:0')
benign distance is  tensor(113.3805, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6391103863716125
distance x is tensor(130.1002, device='cuda:0')
benign distance is  tensor(130.1002, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2370922565460205
distance x is tensor(133.6917, device='cuda:0')
benign distance is  tensor(133.6917, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.2664582133293152
mal_entropy is 0.05849076062440872
user_PLR len size 36
counter_tensor is  tensor([16.,  0.,  0., 12., 15., 34., 12., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24.,  0.,  0., 31., 12., 13., 35., 13.,  1.,
        29., 12., 14., 33., 33., 26., 32., 12.])
count_res tensor([3.2775e-09, 3.6884e-16, 3.6884e-16, 6.0030e-11, 1.2057e-09, 2.1520e-01,
        6.0030e-11, 6.0030e-11, 9.7702e-06, 9.7702e-06, 9.7702e-06, 9.7702e-06,
        9.7702e-06, 9.7702e-06, 9.7702e-06, 9.7702e-06, 9.7702e-06, 9.7702e-06,
        9.7702e-06, 9.7702e-06, 3.6884e-16, 3.6884e-16, 1.0714e-02, 6.0030e-11,
        1.6318e-10, 5.8498e-01, 1.6318e-10, 1.0026e-15, 1.4500e-03, 6.0030e-11,
        4.4357e-10, 7.9169e-02, 7.9169e-02, 7.2192e-05, 2.9125e-02, 6.0030e-11])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 89.03% 

Test Accuracy: 88.00% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5078985095024109
distance x is tensor(125.0125, device='cuda:0')
benign distance is  tensor(125.0125, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7353466749191284
distance x is tensor(123.3698, device='cuda:0')
benign distance is  tensor(123.3698, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.24702021479606628
distance x is tensor(139.1795, device='cuda:0')
benign distance is  tensor(139.1795, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5189900398254395
distance x is tensor(118.1054, device='cuda:0')
benign distance is  tensor(118.1054, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5970914959907532
distance x is tensor(118.0845, device='cuda:0')
benign distance is  tensor(118.0845, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6874614953994751
distance x is tensor(112.7865, device='cuda:0')
benign distance is  tensor(112.7865, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1416390836238861
distance x is tensor(128.4988, device='cuda:0')
benign distance is  tensor(128.4988, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7669602036476135
distance x is tensor(125.9237, device='cuda:0')
benign distance is  tensor(125.9237, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.20930632948875427
distance x is tensor(132.3972, device='cuda:0')
benign distance is  tensor(132.3972, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4856855273246765
distance x is tensor(156.5171, device='cuda:0')
benign distance is  tensor(156.5171, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2603406310081482
distance x is tensor(137.0973, device='cuda:0')
benign distance is  tensor(137.0973, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.18514367938041687
distance x is tensor(128.0477, device='cuda:0')
benign distance is  tensor(128.0477, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5278693437576294
distance x is tensor(129.9251, device='cuda:0')
benign distance is  tensor(129.9251, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6662512421607971
distance x is tensor(142.1398, device='cuda:0')
benign distance is  tensor(142.1398, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.06163162738084793
distance x is tensor(141.4346, device='cuda:0')
benign distance is  tensor(141.4346, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5953882336616516
distance x is tensor(131.0670, device='cuda:0')
benign distance is  tensor(131.0670, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3851597309112549
distance x is tensor(135.3375, device='cuda:0')
benign distance is  tensor(135.3375, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.1133812889456749
distance x is tensor(136.5685, device='cuda:0')
benign distance is  tensor(136.5685, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.2154022753238678
distance x is tensor(144.4160, device='cuda:0')
benign distance is  tensor(144.4160, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.2847967743873596
distance x is tensor(135.5620, device='cuda:0')
benign distance is  tensor(135.5620, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.39360493421554565
distance x is tensor(137.3370, device='cuda:0')
benign distance is  tensor(137.3370, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.973065972328186
distance x is tensor(95.0376, device='cuda:0')
benign distance is  tensor(95.0376, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7198363542556763
distance x is tensor(136.0978, device='cuda:0')
benign distance is  tensor(136.0978, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9013338088989258
distance x is tensor(143.7501, device='cuda:0')
benign distance is  tensor(143.7501, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.6790981888771057
mal_entropy is 0.041991665959358215
user_PLR len size 36
counter_tensor is  tensor([16., 14.,  0., 15., 12., 33., 35., 31., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 35., 14., 14., 15.,  0., 33., 34., 34.,
         0., 34., 35., 34., 35., 13.,  0.,  0.])
count_res tensor([9.7259e-10, 1.3163e-10, 1.0945e-16, 3.5780e-10, 1.7814e-11, 2.3493e-02,
        1.7359e-01, 3.1794e-03, 2.8992e-06, 2.8992e-06, 2.8992e-06, 2.8992e-06,
        2.8992e-06, 2.8992e-06, 2.8992e-06, 2.8992e-06, 2.8992e-06, 2.8992e-06,
        2.8992e-06, 2.8992e-06, 1.7359e-01, 1.3163e-10, 1.3163e-10, 3.5780e-10,
        1.0945e-16, 2.3493e-02, 6.3860e-02, 6.3860e-02, 1.0945e-16, 6.3860e-02,
        1.7359e-01, 6.3860e-02, 1.7359e-01, 4.8422e-11, 1.0945e-16, 1.0945e-16])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 89.64% 

Test Accuracy: 88.72% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8631170392036438
distance x is tensor(106.5066, device='cuda:0')
benign distance is  tensor(106.5066, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6152889132499695
distance x is tensor(125.6079, device='cuda:0')
benign distance is  tensor(125.6079, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.06278391182422638
distance x is tensor(124.0490, device='cuda:0')
benign distance is  tensor(124.0490, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.10072822868824005
distance x is tensor(126.2782, device='cuda:0')
benign distance is  tensor(126.2782, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5701960325241089
distance x is tensor(102.4891, device='cuda:0')
benign distance is  tensor(102.4891, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0238479375839233
distance x is tensor(116.3024, device='cuda:0')
benign distance is  tensor(116.3024, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5600685477256775
distance x is tensor(96.5624, device='cuda:0')
benign distance is  tensor(96.5624, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1863374412059784
distance x is tensor(113.9084, device='cuda:0')
benign distance is  tensor(113.9084, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7715641260147095
distance x is tensor(137.5686, device='cuda:0')
benign distance is  tensor(137.5686, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.41778573393821716
distance x is tensor(126.0710, device='cuda:0')
benign distance is  tensor(126.0710, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6393556594848633
distance x is tensor(130.7985, device='cuda:0')
benign distance is  tensor(130.7985, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5462454557418823
distance x is tensor(124.4472, device='cuda:0')
benign distance is  tensor(124.4472, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4974675178527832
distance x is tensor(123.7138, device='cuda:0')
benign distance is  tensor(123.7138, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.44130054116249084
distance x is tensor(109.1257, device='cuda:0')
benign distance is  tensor(109.1257, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8393901586532593
distance x is tensor(138.2740, device='cuda:0')
benign distance is  tensor(138.2740, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.536173939704895
distance x is tensor(131.5089, device='cuda:0')
benign distance is  tensor(131.5089, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.08126663416624069
distance x is tensor(128.0827, device='cuda:0')
benign distance is  tensor(128.0827, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.553880512714386
distance x is tensor(123.1963, device='cuda:0')
benign distance is  tensor(123.1963, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.4554019868373871
distance x is tensor(123.2356, device='cuda:0')
benign distance is  tensor(123.2356, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.643591582775116
distance x is tensor(132.8867, device='cuda:0')
benign distance is  tensor(132.8867, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9293383359909058
distance x is tensor(117.3417, device='cuda:0')
benign distance is  tensor(117.3417, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.3607594668865204
distance x is tensor(126.6997, device='cuda:0')
benign distance is  tensor(126.6997, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.15466482937335968
distance x is tensor(126.2581, device='cuda:0')
benign distance is  tensor(126.2581, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.3049635589122772
distance x is tensor(123.9821, device='cuda:0')
benign distance is  tensor(123.9821, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.42436546087265015
mal_entropy is 0.06470689177513123
user_PLR len size 20
counter_tensor is  tensor([13., 13., 13., 12., 13., 13., 13., 13., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([7.5948e-05, 7.5948e-05, 7.5948e-05, 2.7940e-05, 7.5948e-05, 7.5948e-05,
        7.5948e-05, 7.5948e-05, 8.3287e-02, 8.3287e-02, 8.3287e-02, 8.3287e-02,
        8.3287e-02, 8.3287e-02, 8.3287e-02, 8.3287e-02, 8.3287e-02, 8.3287e-02,
        8.3287e-02, 8.3287e-02])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 88.33% 

Test Accuracy: 87.36% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.41606569290161133
distance x is tensor(136.5451, device='cuda:0')
benign distance is  tensor(136.5451, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.25284308195114136
distance x is tensor(129.6253, device='cuda:0')
benign distance is  tensor(129.6253, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.06657755374908447
distance x is tensor(137.1279, device='cuda:0')
benign distance is  tensor(137.1279, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.14406946301460266
distance x is tensor(124.2899, device='cuda:0')
benign distance is  tensor(124.2899, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3718193769454956
distance x is tensor(114.4267, device='cuda:0')
benign distance is  tensor(114.4267, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5633741617202759
distance x is tensor(134.5877, device='cuda:0')
benign distance is  tensor(134.5877, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6882303953170776
distance x is tensor(119.3590, device='cuda:0')
benign distance is  tensor(119.3590, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3261006474494934
distance x is tensor(132.8193, device='cuda:0')
benign distance is  tensor(132.8193, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 1.120362401008606
mal_entropy is 0.04246535524725914
user_PLR len size 44
counter_tensor is  tensor([ 4., 36., 37., 27., 35.,  1., 42., 36., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19., 43., 37., 42., 40., 43., 38., 43., 43.,
        18.,  7., 43., 32., 38., 36.,  4., 38.,  2.,  3., 34., 39., 35., 41.,
        14., 43.])
count_res tensor([1.6573e-18, 1.3087e-04, 3.5574e-04, 1.6150e-08, 4.8144e-05, 8.2514e-20,
        5.2796e-02, 1.3087e-04, 5.4179e-12, 5.4179e-12, 5.4179e-12, 5.4179e-12,
        5.4179e-12, 5.4179e-12, 5.4179e-12, 5.4179e-12, 5.4179e-12, 5.4179e-12,
        5.4179e-12, 5.4179e-12, 1.4351e-01, 3.5574e-04, 5.2796e-02, 7.1452e-03,
        1.4351e-01, 9.6700e-04, 1.4351e-01, 1.4351e-01, 1.9931e-12, 3.3289e-17,
        1.4351e-01, 2.3969e-06, 9.6700e-04, 1.3087e-04, 1.6573e-18, 9.6700e-04,
        2.2430e-19, 6.0970e-19, 1.7711e-05, 2.6286e-03, 4.8144e-05, 1.9423e-02,
        3.6505e-14, 1.4351e-01])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 89.58% 

Test Accuracy: 88.54% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6178549528121948
distance x is tensor(97.3285, device='cuda:0')
benign distance is  tensor(97.3285, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5897420644760132
distance x is tensor(110.9806, device='cuda:0')
benign distance is  tensor(110.9806, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.291490375995636
distance x is tensor(125.2147, device='cuda:0')
benign distance is  tensor(125.2147, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.44620800018310547
distance x is tensor(115.0144, device='cuda:0')
benign distance is  tensor(115.0144, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6822987794876099
distance x is tensor(111.4066, device='cuda:0')
benign distance is  tensor(111.4066, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7658519744873047
distance x is tensor(115.7148, device='cuda:0')
benign distance is  tensor(115.7148, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.27010390162467957
distance x is tensor(101.9536, device='cuda:0')
benign distance is  tensor(101.9536, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.48146048188209534
distance x is tensor(125.8682, device='cuda:0')
benign distance is  tensor(125.8682, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.1793375462293625
distance x is tensor(129.7547, device='cuda:0')
benign distance is  tensor(129.7547, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.21256490051746368
distance x is tensor(135.4422, device='cuda:0')
benign distance is  tensor(135.4422, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4417491853237152
distance x is tensor(121.2304, device='cuda:0')
benign distance is  tensor(121.2304, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8105154037475586
distance x is tensor(114.5867, device='cuda:0')
benign distance is  tensor(114.5867, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.1512221395969391
distance x is tensor(132.1036, device='cuda:0')
benign distance is  tensor(132.1036, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4984779953956604
distance x is tensor(115.7717, device='cuda:0')
benign distance is  tensor(115.7717, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5392022728919983
distance x is tensor(129.5787, device='cuda:0')
benign distance is  tensor(129.5787, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.27697885036468506
distance x is tensor(135.7136, device='cuda:0')
benign distance is  tensor(135.7136, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.20778267085552216
distance x is tensor(122.5293, device='cuda:0')
benign distance is  tensor(122.5293, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4476850926876068
distance x is tensor(127.1211, device='cuda:0')
benign distance is  tensor(127.1211, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.29341137409210205
distance x is tensor(108.0734, device='cuda:0')
benign distance is  tensor(108.0734, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.6397668123245239
distance x is tensor(133.6517, device='cuda:0')
benign distance is  tensor(133.6517, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4095485806465149
distance x is tensor(114.4377, device='cuda:0')
benign distance is  tensor(114.4377, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0255836248397827
distance x is tensor(118.6809, device='cuda:0')
benign distance is  tensor(118.6809, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.311807781457901
distance x is tensor(131.9020, device='cuda:0')
benign distance is  tensor(131.9020, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.34600335359573364
distance x is tensor(118.9455, device='cuda:0')
benign distance is  tensor(118.9455, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.1895827054977417
distance x is tensor(119.1186, device='cuda:0')
benign distance is  tensor(119.1186, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.4178452491760254
distance x is tensor(127.3331, device='cuda:0')
benign distance is  tensor(127.3331, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.08240854740142822
distance x is tensor(119.3437, device='cuda:0')
benign distance is  tensor(119.3437, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.6524409055709839
distance x is tensor(132.2878, device='cuda:0')
benign distance is  tensor(132.2878, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.1495319902896881
distance x is tensor(118.3805, device='cuda:0')
benign distance is  tensor(118.3805, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5330775380134583
distance x is tensor(139.4297, device='cuda:0')
benign distance is  tensor(139.4297, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.21725806593894958
distance x is tensor(129.6433, device='cuda:0')
benign distance is  tensor(129.6433, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.3394060730934143
distance x is tensor(110.0543, device='cuda:0')
benign distance is  tensor(110.0543, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.438718318939209
mal_entropy is 0.06601282209157944
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 88.24% 

Test Accuracy: 87.03% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8018985986709595
distance x is tensor(109.8457, device='cuda:0')
benign distance is  tensor(109.8457, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6553288698196411
distance x is tensor(120.8741, device='cuda:0')
benign distance is  tensor(120.8741, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.09781376272439957
distance x is tensor(125.3296, device='cuda:0')
benign distance is  tensor(125.3296, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2833835482597351
distance x is tensor(123.2218, device='cuda:0')
benign distance is  tensor(123.2218, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8510082364082336
distance x is tensor(109.4909, device='cuda:0')
benign distance is  tensor(109.4909, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4816587567329407
distance x is tensor(136.8882, device='cuda:0')
benign distance is  tensor(136.8882, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5192917585372925
distance x is tensor(118.4431, device='cuda:0')
benign distance is  tensor(118.4431, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.18182377517223358
distance x is tensor(127.9925, device='cuda:0')
benign distance is  tensor(127.9925, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.5581363439559937
mal_entropy is 0.19546502828598022
user_PLR len size 44
counter_tensor is  tensor([12., 42.,  0., 20., 25., 12.,  0., 12., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 15.,  0., 43., 24., 15., 13., 12., 42.,
        43.,  0., 33., 41., 12., 43., 38., 42., 12., 12., 39., 12., 12., 39.,
         0., 12.])
count_res tensor([8.0383e-15, 8.5901e-02, 4.9389e-20, 2.3962e-11, 3.5563e-09, 8.0383e-15,
        4.9389e-20, 8.0383e-15, 3.8999e-06, 3.8999e-06, 3.8999e-06, 3.8999e-06,
        3.8999e-06, 3.8999e-06, 3.8999e-06, 3.8999e-06, 3.8999e-06, 3.8999e-06,
        3.8999e-06, 3.8999e-06, 1.6145e-13, 4.9389e-20, 2.3350e-01, 1.3083e-09,
        1.6145e-13, 2.1850e-14, 8.0383e-15, 8.5901e-02, 2.3350e-01, 4.9389e-20,
        1.0601e-05, 3.1601e-02, 8.0383e-15, 2.3350e-01, 1.5733e-03, 8.5901e-02,
        8.0383e-15, 8.0383e-15, 4.2768e-03, 8.0383e-15, 8.0383e-15, 4.2768e-03,
        4.9389e-20, 8.0383e-15])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 89.70% 

Test Accuracy: 88.82% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7790080308914185
distance x is tensor(113.5567, device='cuda:0')
benign distance is  tensor(113.5567, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5358600616455078
distance x is tensor(118.9685, device='cuda:0')
benign distance is  tensor(118.9685, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.14101731777191162
distance x is tensor(125.4455, device='cuda:0')
benign distance is  tensor(125.4455, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6462893486022949
distance x is tensor(114.2745, device='cuda:0')
benign distance is  tensor(114.2745, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5237263441085815
distance x is tensor(107.8736, device='cuda:0')
benign distance is  tensor(107.8736, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0266584157943726
distance x is tensor(117.9752, device='cuda:0')
benign distance is  tensor(117.9752, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.16813281178474426
distance x is tensor(111.0654, device='cuda:0')
benign distance is  tensor(111.0654, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5291634798049927
distance x is tensor(131.4518, device='cuda:0')
benign distance is  tensor(131.4518, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.15105970203876495
distance x is tensor(136.1555, device='cuda:0')
benign distance is  tensor(136.1555, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6934030055999756
distance x is tensor(143.3925, device='cuda:0')
benign distance is  tensor(143.3925, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5150820016860962
distance x is tensor(130.6945, device='cuda:0')
benign distance is  tensor(130.6945, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6056171655654907
distance x is tensor(114.7309, device='cuda:0')
benign distance is  tensor(114.7309, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6929128766059875
distance x is tensor(125.0860, device='cuda:0')
benign distance is  tensor(125.0860, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.18096964061260223
distance x is tensor(113.8984, device='cuda:0')
benign distance is  tensor(113.8984, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6081405878067017
distance x is tensor(126.2825, device='cuda:0')
benign distance is  tensor(126.2825, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.6706680059432983
distance x is tensor(138.8280, device='cuda:0')
benign distance is  tensor(138.8280, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.4190238118171692
distance x is tensor(116.9242, device='cuda:0')
benign distance is  tensor(116.9242, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.3209722638130188
distance x is tensor(117.4869, device='cuda:0')
benign distance is  tensor(117.4869, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3630725145339966
distance x is tensor(140.5107, device='cuda:0')
benign distance is  tensor(140.5107, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3143593668937683
distance x is tensor(138.3584, device='cuda:0')
benign distance is  tensor(138.3584, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.4424298405647278
distance x is tensor(121.5973, device='cuda:0')
benign distance is  tensor(121.5973, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.32384929060935974
distance x is tensor(119.8290, device='cuda:0')
benign distance is  tensor(119.8290, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.1994188129901886
distance x is tensor(125.2410, device='cuda:0')
benign distance is  tensor(125.2410, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.3443487286567688
distance x is tensor(134.7685, device='cuda:0')
benign distance is  tensor(134.7685, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.44759321212768555
distance x is tensor(135.6339, device='cuda:0')
benign distance is  tensor(135.6339, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.18516497313976288
distance x is tensor(143.2851, device='cuda:0')
benign distance is  tensor(143.2851, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.8591214418411255
distance x is tensor(117.0001, device='cuda:0')
benign distance is  tensor(117.0001, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.29992666840553284
distance x is tensor(130.4935, device='cuda:0')
benign distance is  tensor(130.4935, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.13411696255207062
distance x is tensor(125.6156, device='cuda:0')
benign distance is  tensor(125.6156, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8088529706001282
distance x is tensor(122.2884, device='cuda:0')
benign distance is  tensor(122.2884, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.5718370676040649
distance x is tensor(117.4027, device='cuda:0')
benign distance is  tensor(117.4027, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.3390903174877167
distance x is tensor(121.8748, device='cuda:0')
benign distance is  tensor(121.8748, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.08952426165342331
mal_entropy is 0.07445307075977325
user_PLR len size 28
counter_tensor is  tensor([12., 12., 25.,  0., 25., 12., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 13., 12., 12., 23., 12., 25., 12.])
count_res tensor([2.1474e-07, 2.1474e-07, 9.5004e-02, 1.3194e-12, 9.5004e-02, 2.1474e-07,
        2.1474e-07, 2.1474e-07, 1.1724e-05, 1.1724e-05, 1.1724e-05, 1.1724e-05,
        1.1724e-05, 1.1724e-05, 1.1724e-05, 1.1724e-05, 1.1724e-05, 1.1724e-05,
        1.1724e-05, 1.1724e-05, 7.0199e-01, 5.8372e-07, 2.1474e-07, 2.1474e-07,
        1.2857e-02, 2.1474e-07, 9.5004e-02, 2.1474e-07])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 89.02% 

Test Accuracy: 87.84% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4765499234199524
distance x is tensor(128.4325, device='cuda:0')
benign distance is  tensor(128.4325, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2500523030757904
distance x is tensor(131.8530, device='cuda:0')
benign distance is  tensor(131.8530, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2453707903623581
distance x is tensor(128.9896, device='cuda:0')
benign distance is  tensor(128.9896, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4592481553554535
distance x is tensor(122.6306, device='cuda:0')
benign distance is  tensor(122.6306, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.31803882122039795
distance x is tensor(117.3194, device='cuda:0')
benign distance is  tensor(117.3194, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9837643504142761
distance x is tensor(134.1073, device='cuda:0')
benign distance is  tensor(134.1073, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.42140787839889526
distance x is tensor(120.3097, device='cuda:0')
benign distance is  tensor(120.3097, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4291263520717621
distance x is tensor(137.4558, device='cuda:0')
benign distance is  tensor(137.4558, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4629201292991638
distance x is tensor(90.0302, device='cuda:0')
benign distance is  tensor(90.0302, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.1578772068023682
distance x is tensor(154.3888, device='cuda:0')
benign distance is  tensor(154.3888, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.19966182112693787
distance x is tensor(137.9530, device='cuda:0')
benign distance is  tensor(137.9530, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.04642317444086075
distance x is tensor(127.4202, device='cuda:0')
benign distance is  tensor(127.4202, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.31330516934394836
distance x is tensor(128.4886, device='cuda:0')
benign distance is  tensor(128.4886, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6079862713813782
distance x is tensor(131.5367, device='cuda:0')
benign distance is  tensor(131.5367, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2240181416273117
distance x is tensor(142.2125, device='cuda:0')
benign distance is  tensor(142.2125, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5626641511917114
distance x is tensor(139.6505, device='cuda:0')
benign distance is  tensor(139.6505, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.5149732232093811
mal_entropy is 0.1268489807844162
user_PLR len size 28
counter_tensor is  tensor([12., 12., 15., 12., 27., 12.,  0., 25., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 12., 14., 27., 12., 12., 12.])
count_res tensor([1.4324e-07, 1.4324e-07, 2.8771e-06, 1.4324e-07, 4.6826e-01, 1.4324e-07,
        8.8012e-13, 6.3373e-02, 7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06,
        7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06,
        7.8208e-06, 7.8208e-06, 1.4324e-07, 1.4324e-07, 1.4324e-07, 1.0584e-06,
        4.6826e-01, 1.4324e-07, 1.4324e-07, 1.4324e-07])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 89.30% 

Test Accuracy: 88.29% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2511863112449646
distance x is tensor(125.6990, device='cuda:0')
benign distance is  tensor(125.6990, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2820974588394165
distance x is tensor(128.8339, device='cuda:0')
benign distance is  tensor(128.8339, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.17301881313323975
distance x is tensor(133.6233, device='cuda:0')
benign distance is  tensor(133.6233, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5944601893424988
distance x is tensor(115.6883, device='cuda:0')
benign distance is  tensor(115.6883, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7280508279800415
distance x is tensor(67.0436, device='cuda:0')
benign distance is  tensor(67.0436, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7841671705245972
distance x is tensor(128.8113, device='cuda:0')
benign distance is  tensor(128.8113, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3077877163887024
distance x is tensor(124.7176, device='cuda:0')
benign distance is  tensor(124.7176, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4489597678184509
distance x is tensor(137.9135, device='cuda:0')
benign distance is  tensor(137.9135, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3118002712726593
distance x is tensor(146.9744, device='cuda:0')
benign distance is  tensor(146.9744, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6024046540260315
distance x is tensor(142.0878, device='cuda:0')
benign distance is  tensor(142.0878, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7429022789001465
distance x is tensor(144.2999, device='cuda:0')
benign distance is  tensor(144.2999, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.44569331407546997
distance x is tensor(121.4441, device='cuda:0')
benign distance is  tensor(121.4441, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5166558027267456
distance x is tensor(99.8117, device='cuda:0')
benign distance is  tensor(99.8117, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.41994062066078186
distance x is tensor(122.1665, device='cuda:0')
benign distance is  tensor(122.1665, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6895278096199036
distance x is tensor(129.8730, device='cuda:0')
benign distance is  tensor(129.8730, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5189393758773804
distance x is tensor(133.2851, device='cuda:0')
benign distance is  tensor(133.2851, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.6589875221252441
mal_entropy is 0.01828153431415558
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 87.23% 

Test Accuracy: 86.48% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.29980596899986267
distance x is tensor(141.6376, device='cuda:0')
benign distance is  tensor(141.6376, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6778094172477722
distance x is tensor(138.8989, device='cuda:0')
benign distance is  tensor(138.8989, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1615695357322693
distance x is tensor(146.0314, device='cuda:0')
benign distance is  tensor(146.0314, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7768481969833374
distance x is tensor(140.3406, device='cuda:0')
benign distance is  tensor(140.3406, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4246828556060791
distance x is tensor(121.2558, device='cuda:0')
benign distance is  tensor(121.2558, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8910282254219055
distance x is tensor(151.2133, device='cuda:0')
benign distance is  tensor(151.2133, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.21578411757946014
distance x is tensor(154.9608, device='cuda:0')
benign distance is  tensor(154.9608, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6426504850387573
distance x is tensor(139.6669, device='cuda:0')
benign distance is  tensor(139.6669, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.7500000005
mal_loss is 2.441518545150757
mal_entropy is 0.07516266405582428
user_PLR len size 52
counter_tensor is  tensor([51., 51., 49., 25., 51., 46., 51., 51., 21., 21., 21., 21., 21., 21.,
        21., 21., 21., 21., 21., 21., 48., 45., 27., 15.,  4., 51.,  3.,  3.,
        51., 48., 10., 49., 46., 16., 41., 50.,  5., 13.,  9., 51., 48., 25.,
        48., 39., 44., 41., 50., 51.,  4., 51.,  2., 51.])
count_res tensor([8.1816e-02, 8.1816e-02, 1.1073e-02, 4.1801e-13, 8.1816e-02, 5.5127e-04,
        8.1816e-02, 8.1816e-02, 7.6560e-15, 7.6560e-15, 7.6560e-15, 7.6560e-15,
        7.6560e-15, 7.6560e-15, 7.6560e-15, 7.6560e-15, 7.6560e-15, 7.6560e-15,
        7.6560e-15, 7.6560e-15, 4.0734e-03, 2.0280e-04, 3.0887e-12, 1.8977e-17,
        3.1696e-22, 8.1816e-02, 1.1660e-22, 1.1660e-22, 8.1816e-02, 4.0734e-03,
        1.2787e-19, 1.1073e-02, 5.5127e-04, 5.1586e-17, 3.7144e-06, 3.0098e-02,
        8.6157e-22, 2.5683e-18, 4.7040e-20, 8.1816e-02, 4.0734e-03, 4.1801e-13,
        4.0734e-03, 5.0270e-07, 7.4607e-05, 3.7144e-06, 3.0098e-02, 8.1816e-02,
        3.1696e-22, 8.1816e-02, 4.2895e-23, 8.1816e-02])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 89.79% 

Test Accuracy: 88.87% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5080271363258362
distance x is tensor(115.4022, device='cuda:0')
benign distance is  tensor(115.4022, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6752409934997559
distance x is tensor(113.5899, device='cuda:0')
benign distance is  tensor(113.5899, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1454121619462967
distance x is tensor(115.3198, device='cuda:0')
benign distance is  tensor(115.3198, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5635815262794495
distance x is tensor(123.3447, device='cuda:0')
benign distance is  tensor(123.3447, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9049937129020691
distance x is tensor(81.5342, device='cuda:0')
benign distance is  tensor(81.5342, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2389614582061768
distance x is tensor(123.0803, device='cuda:0')
benign distance is  tensor(123.0803, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2869022488594055
distance x is tensor(98.8997, device='cuda:0')
benign distance is  tensor(98.8997, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6964299082756042
distance x is tensor(116.8314, device='cuda:0')
benign distance is  tensor(116.8314, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6002436876296997
distance x is tensor(144.7720, device='cuda:0')
benign distance is  tensor(144.7720, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4474441409111023
distance x is tensor(137.4400, device='cuda:0')
benign distance is  tensor(137.4400, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.304564893245697
distance x is tensor(128.7530, device='cuda:0')
benign distance is  tensor(128.7530, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.578705906867981
distance x is tensor(119.9990, device='cuda:0')
benign distance is  tensor(119.9990, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4222140312194824
distance x is tensor(107.2057, device='cuda:0')
benign distance is  tensor(107.2057, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.10193737596273422
distance x is tensor(122.3399, device='cuda:0')
benign distance is  tensor(122.3399, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4615539014339447
distance x is tensor(132.4548, device='cuda:0')
benign distance is  tensor(132.4548, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.43695029616355896
distance x is tensor(131.4367, device='cuda:0')
benign distance is  tensor(131.4367, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4419911503791809
distance x is tensor(128.0232, device='cuda:0')
benign distance is  tensor(128.0232, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5044654607772827
distance x is tensor(140.8139, device='cuda:0')
benign distance is  tensor(140.8139, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.30146148800849915
distance x is tensor(120.6449, device='cuda:0')
benign distance is  tensor(120.6449, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7474396824836731
distance x is tensor(115.4527, device='cuda:0')
benign distance is  tensor(115.4527, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.20394912362098694
distance x is tensor(131.8964, device='cuda:0')
benign distance is  tensor(131.8964, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.846361517906189
distance x is tensor(122.0040, device='cuda:0')
benign distance is  tensor(122.0040, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.07137405872344971
distance x is tensor(130.9747, device='cuda:0')
benign distance is  tensor(130.9747, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6165667772293091
distance x is tensor(142.1813, device='cuda:0')
benign distance is  tensor(142.1813, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.5472880601882935
distance x is tensor(119.7485, device='cuda:0')
benign distance is  tensor(119.7485, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5026518106460571
distance x is tensor(124.5812, device='cuda:0')
benign distance is  tensor(124.5812, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.4124542772769928
distance x is tensor(131.8965, device='cuda:0')
benign distance is  tensor(131.8965, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.2205767184495926
distance x is tensor(135.8545, device='cuda:0')
benign distance is  tensor(135.8545, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8027247190475464
distance x is tensor(127.9667, device='cuda:0')
benign distance is  tensor(127.9667, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.0091842412948608
distance x is tensor(134.2292, device='cuda:0')
benign distance is  tensor(134.2292, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.8975184559822083
distance x is tensor(127.0032, device='cuda:0')
benign distance is  tensor(127.0032, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.14544153213500977
distance x is tensor(116.6744, device='cuda:0')
benign distance is  tensor(116.6744, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.18019935488700867
distance x is tensor(129.3078, device='cuda:0')
benign distance is  tensor(129.3078, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.18513071537017822
distance x is tensor(128.7970, device='cuda:0')
benign distance is  tensor(128.7970, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.19767871499061584
distance x is tensor(118.0598, device='cuda:0')
benign distance is  tensor(118.0598, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.7881960868835449
distance x is tensor(125.0533, device='cuda:0')
benign distance is  tensor(125.0533, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7630892992019653
distance x is tensor(129.9241, device='cuda:0')
benign distance is  tensor(129.9241, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.9325413703918457
distance x is tensor(124.3375, device='cuda:0')
benign distance is  tensor(124.3375, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.223357915878296
distance x is tensor(149.0402, device='cuda:0')
benign distance is  tensor(149.0402, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5229053497314453
distance x is tensor(125.3766, device='cuda:0')
benign distance is  tensor(125.3766, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.7025112509727478
mal_entropy is 0.06266524642705917
user_PLR len size 28
counter_tensor is  tensor([12., 22., 12., 12., 12., 12., 27.,  2., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 13., 12., 12., 15., 27., 15., 12., 12.])
count_res tensor([1.5242e-07, 3.3573e-03, 1.5242e-07, 1.5242e-07, 1.5242e-07, 1.5242e-07,
        4.9827e-01, 6.9199e-12, 8.3219e-06, 8.3219e-06, 8.3219e-06, 8.3219e-06,
        8.3219e-06, 8.3219e-06, 8.3219e-06, 8.3219e-06, 8.3219e-06, 8.3219e-06,
        8.3219e-06, 8.3219e-06, 4.1432e-07, 1.5242e-07, 1.5242e-07, 3.0615e-06,
        4.9827e-01, 3.0615e-06, 1.5242e-07, 1.5242e-07])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 88.98% 

Test Accuracy: 88.34% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.37885984778404236
distance x is tensor(123.4528, device='cuda:0')
benign distance is  tensor(123.4528, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.47745823860168457
distance x is tensor(130.2602, device='cuda:0')
benign distance is  tensor(130.2602, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.16656529903411865
distance x is tensor(141.2681, device='cuda:0')
benign distance is  tensor(141.2681, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.30056363344192505
distance x is tensor(124.4295, device='cuda:0')
benign distance is  tensor(124.4295, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.28809672594070435
distance x is tensor(114.8199, device='cuda:0')
benign distance is  tensor(114.8199, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7412228584289551
distance x is tensor(127.3709, device='cuda:0')
benign distance is  tensor(127.3709, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.14940226078033447
distance x is tensor(94.6560, device='cuda:0')
benign distance is  tensor(94.6560, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2843591868877411
distance x is tensor(136.4160, device='cuda:0')
benign distance is  tensor(136.4160, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3005450963973999
distance x is tensor(144.0947, device='cuda:0')
benign distance is  tensor(144.0947, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.24060945212841034
distance x is tensor(144.6261, device='cuda:0')
benign distance is  tensor(144.6261, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.3617324233055115
distance x is tensor(139.6689, device='cuda:0')
benign distance is  tensor(139.6689, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.26237952709198
distance x is tensor(139.3543, device='cuda:0')
benign distance is  tensor(139.3543, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7548619508743286
distance x is tensor(111.0420, device='cuda:0')
benign distance is  tensor(111.0420, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.6358014345169067
distance x is tensor(121.4950, device='cuda:0')
benign distance is  tensor(121.4950, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.2986134886741638
distance x is tensor(131.1457, device='cuda:0')
benign distance is  tensor(131.1457, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.31069129705429077
distance x is tensor(144.0212, device='cuda:0')
benign distance is  tensor(144.0212, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.23023530840873718
mal_entropy is 0.1373366266489029
user_PLR len size 28
counter_tensor is  tensor([12., 26., 16., 12., 12., 12.,  0., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 13., 27., 12., 12., 26., 12., 12.])
count_res tensor([1.7621e-07, 2.1191e-01, 9.6209e-06, 1.7621e-07, 1.7621e-07, 1.7621e-07,
        1.0827e-12, 1.7621e-07, 9.6209e-06, 9.6209e-06, 9.6209e-06, 9.6209e-06,
        9.6209e-06, 9.6209e-06, 9.6209e-06, 9.6209e-06, 9.6209e-06, 9.6209e-06,
        9.6209e-06, 9.6209e-06, 1.7621e-07, 4.7900e-07, 5.7604e-01, 1.7621e-07,
        1.7621e-07, 2.1191e-01, 1.7621e-07, 1.7621e-07])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 88.98% 

Test Accuracy: 88.40% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9248199462890625
distance x is tensor(124.6748, device='cuda:0')
benign distance is  tensor(124.6748, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.13492807745933533
distance x is tensor(110.4826, device='cuda:0')
benign distance is  tensor(110.4826, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.12516018748283386
distance x is tensor(127.9819, device='cuda:0')
benign distance is  tensor(127.9819, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.45737266540527344
distance x is tensor(122.8250, device='cuda:0')
benign distance is  tensor(122.8250, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8311210870742798
distance x is tensor(98.0522, device='cuda:0')
benign distance is  tensor(98.0522, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0980116128921509
distance x is tensor(123.4751, device='cuda:0')
benign distance is  tensor(123.4751, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.39761415123939514
distance x is tensor(109.9135, device='cuda:0')
benign distance is  tensor(109.9135, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3894844651222229
distance x is tensor(126.8640, device='cuda:0')
benign distance is  tensor(126.8640, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5870110988616943
distance x is tensor(147.2555, device='cuda:0')
benign distance is  tensor(147.2555, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.29766184091567993
distance x is tensor(146.1408, device='cuda:0')
benign distance is  tensor(146.1408, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.2339591234922409
distance x is tensor(88.2833, device='cuda:0')
benign distance is  tensor(88.2833, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.39116954803466797
distance x is tensor(114.3549, device='cuda:0')
benign distance is  tensor(114.3549, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.47959667444229126
distance x is tensor(118.5001, device='cuda:0')
benign distance is  tensor(118.5001, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3014480471611023
distance x is tensor(108.5760, device='cuda:0')
benign distance is  tensor(108.5760, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4738779067993164
distance x is tensor(137.4598, device='cuda:0')
benign distance is  tensor(137.4598, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6517974138259888
distance x is tensor(134.6444, device='cuda:0')
benign distance is  tensor(134.6444, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.6401597261428833
mal_entropy is 0.09017238020896912
user_PLR len size 28
counter_tensor is  tensor([12., 12., 24., 12., 26., 27., 25., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 22., 26., 12., 27., 12., 27., 12., 21.])
count_res tensor([7.7832e-08, 7.7832e-08, 1.2667e-02, 7.7832e-08, 9.3601e-02, 2.5443e-01,
        3.4434e-02, 7.7832e-08, 4.2495e-06, 4.2495e-06, 4.2495e-06, 4.2495e-06,
        4.2495e-06, 4.2495e-06, 4.2495e-06, 4.2495e-06, 4.2495e-06, 4.2495e-06,
        4.2495e-06, 4.2495e-06, 1.7144e-03, 9.3601e-02, 7.7832e-08, 2.5443e-01,
        7.7832e-08, 2.5443e-01, 7.7832e-08, 6.3068e-04])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 89.75% 

Test Accuracy: 88.90% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6706008911132812
distance x is tensor(110.1370, device='cuda:0')
benign distance is  tensor(110.1370, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4762708246707916
distance x is tensor(116.5452, device='cuda:0')
benign distance is  tensor(116.5452, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3762996196746826
distance x is tensor(130.6570, device='cuda:0')
benign distance is  tensor(130.6570, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3419134318828583
distance x is tensor(114.8939, device='cuda:0')
benign distance is  tensor(114.8939, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8842390775680542
distance x is tensor(81.7707, device='cuda:0')
benign distance is  tensor(81.7707, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.926256000995636
distance x is tensor(111.7201, device='cuda:0')
benign distance is  tensor(111.7201, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5726131200790405
distance x is tensor(114.5290, device='cuda:0')
benign distance is  tensor(114.5290, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5614429712295532
distance x is tensor(119.8226, device='cuda:0')
benign distance is  tensor(119.8226, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.078677698969841
distance x is tensor(125.2559, device='cuda:0')
benign distance is  tensor(125.2559, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8374020457267761
distance x is tensor(138.8038, device='cuda:0')
benign distance is  tensor(138.8038, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5744628310203552
distance x is tensor(129.3386, device='cuda:0')
benign distance is  tensor(129.3386, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.11839139461517334
distance x is tensor(111.3350, device='cuda:0')
benign distance is  tensor(111.3350, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.612932026386261
distance x is tensor(125.7691, device='cuda:0')
benign distance is  tensor(125.7691, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5419473648071289
distance x is tensor(124.9870, device='cuda:0')
benign distance is  tensor(124.9870, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.07577941566705704
distance x is tensor(146.7112, device='cuda:0')
benign distance is  tensor(146.7112, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3274029791355133
distance x is tensor(135.4094, device='cuda:0')
benign distance is  tensor(135.4094, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.8834789395332336
mal_entropy is 0.05511760339140892
user_PLR len size 36
counter_tensor is  tensor([13.,  0.,  0., 13.,  0., 12., 34., 30., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 33., 24., 22.,  8.,  0., 13., 12., 35.,
        15., 18., 33., 12., 13., 16., 29., 12.])
count_res tensor([1.6927e-10, 3.8260e-16, 3.8260e-16, 1.6927e-10, 3.8260e-16, 6.2269e-11,
        2.2323e-01, 4.0886e-03, 1.0135e-05, 1.0135e-05, 1.0135e-05, 1.0135e-05,
        1.0135e-05, 1.0135e-05, 1.0135e-05, 1.0135e-05, 1.0135e-05, 1.0135e-05,
        1.0135e-05, 1.0135e-05, 8.2122e-02, 1.0135e-05, 1.3716e-06, 1.1405e-12,
        3.8260e-16, 1.6927e-10, 6.2269e-11, 6.0680e-01, 1.2507e-09, 2.5121e-08,
        8.2122e-02, 6.2269e-11, 1.6927e-10, 3.3998e-09, 1.5041e-03, 6.2269e-11])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 89.43% 

Test Accuracy: 88.27% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5784676671028137
distance x is tensor(130.0411, device='cuda:0')
benign distance is  tensor(130.0411, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.35220351815223694
distance x is tensor(127.4989, device='cuda:0')
benign distance is  tensor(127.4989, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.16349589824676514
distance x is tensor(139.1010, device='cuda:0')
benign distance is  tensor(139.1010, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3454801142215729
distance x is tensor(120.6424, device='cuda:0')
benign distance is  tensor(120.6424, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8599784970283508
distance x is tensor(119.1026, device='cuda:0')
benign distance is  tensor(119.1026, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.484199196100235
distance x is tensor(136.3987, device='cuda:0')
benign distance is  tensor(136.3987, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7014358639717102
distance x is tensor(105.8190, device='cuda:0')
benign distance is  tensor(105.8190, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5071489810943604
distance x is tensor(141.9434, device='cuda:0')
benign distance is  tensor(141.9434, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5983768701553345
distance x is tensor(155.1891, device='cuda:0')
benign distance is  tensor(155.1891, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.774152398109436
distance x is tensor(148.9987, device='cuda:0')
benign distance is  tensor(148.9987, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9418967962265015
distance x is tensor(139.6893, device='cuda:0')
benign distance is  tensor(139.6893, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7857833504676819
distance x is tensor(124.5658, device='cuda:0')
benign distance is  tensor(124.5658, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8415862321853638
distance x is tensor(113.8005, device='cuda:0')
benign distance is  tensor(113.8005, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2724289298057556
distance x is tensor(137.5956, device='cuda:0')
benign distance is  tensor(137.5956, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5950630903244019
distance x is tensor(135.1831, device='cuda:0')
benign distance is  tensor(135.1831, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.4723976850509644
distance x is tensor(138.7478, device='cuda:0')
benign distance is  tensor(138.7478, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3829960823059082
distance x is tensor(137.0402, device='cuda:0')
benign distance is  tensor(137.0402, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6454932689666748
distance x is tensor(144.4114, device='cuda:0')
benign distance is  tensor(144.4114, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.19695420563220978
distance x is tensor(140.2097, device='cuda:0')
benign distance is  tensor(140.2097, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.1849490851163864
distance x is tensor(144.1053, device='cuda:0')
benign distance is  tensor(144.1053, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.1918153762817383
distance x is tensor(141.5329, device='cuda:0')
benign distance is  tensor(141.5329, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.28457537293434143
distance x is tensor(150.2389, device='cuda:0')
benign distance is  tensor(150.2389, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6782813668251038
distance x is tensor(146.8289, device='cuda:0')
benign distance is  tensor(146.8289, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.2717594504356384
distance x is tensor(90.8731, device='cuda:0')
benign distance is  tensor(90.8731, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.2700640559196472
mal_entropy is 0.0938163623213768
user_PLR len size 20
counter_tensor is  tensor([12., 13., 16., 16., 15., 13., 16., 13., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7805e-05, 7.5582e-05, 1.5181e-03, 1.5181e-03, 5.5848e-04, 7.5582e-05,
        1.5181e-03, 7.5582e-05, 8.2886e-02, 8.2886e-02, 8.2886e-02, 8.2886e-02,
        8.2886e-02, 8.2886e-02, 8.2886e-02, 8.2886e-02, 8.2886e-02, 8.2886e-02,
        8.2886e-02, 8.2886e-02])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 87.10% 

Test Accuracy: 86.05% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.31243038177490234
distance x is tensor(169.3732, device='cuda:0')
benign distance is  tensor(169.3732, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.23557162284851074
distance x is tensor(157.1211, device='cuda:0')
benign distance is  tensor(157.1211, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.12409547716379166
distance x is tensor(157.0679, device='cuda:0')
benign distance is  tensor(157.0679, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5183686017990112
distance x is tensor(160.1660, device='cuda:0')
benign distance is  tensor(160.1660, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5582045316696167
distance x is tensor(148.3935, device='cuda:0')
benign distance is  tensor(148.3935, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6784893274307251
distance x is tensor(170.3294, device='cuda:0')
benign distance is  tensor(170.3294, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.46273818612098694
distance x is tensor(143.9518, device='cuda:0')
benign distance is  tensor(143.9518, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.25869235396385193
distance x is tensor(162.7543, device='cuda:0')
benign distance is  tensor(162.7543, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8000000005000001
mal_loss is 3.0400495529174805
mal_entropy is 0.004499692004173994
user_PLR len size 52
counter_tensor is  tensor([28., 51., 15., 51., 10., 32., 22., 14., 37., 37., 37., 37., 37., 37.,
        37., 37., 37., 37., 37., 37., 24.,  6., 51., 51., 43., 50., 50., 51.,
        51., 40., 51., 39., 32., 49., 27., 49., 51., 50.,  5., 50., 17., 49.,
         8., 47., 50., 43., 47., 11., 50., 42., 30., 24.])
count_res tensor([9.6349e-12, 9.3890e-02, 2.1778e-17, 9.3890e-02, 1.4674e-19, 5.2605e-10,
        2.3883e-14, 8.0117e-18, 7.8072e-08, 7.8072e-08, 7.8072e-08, 7.8072e-08,
        7.8072e-08, 7.8072e-08, 7.8072e-08, 7.8072e-08, 7.8072e-08, 7.8072e-08,
        7.8072e-08, 7.8072e-08, 1.7647e-13, 2.6876e-21, 9.3890e-02, 9.3890e-02,
        3.1497e-05, 3.4540e-02, 3.4540e-02, 9.3890e-02, 9.3890e-02, 1.5681e-06,
        9.3890e-02, 5.7688e-07, 5.2605e-10, 1.2707e-02, 3.5445e-12, 1.2707e-02,
        9.3890e-02, 3.4540e-02, 9.8872e-22, 3.4540e-02, 1.6092e-16, 1.2707e-02,
        1.9859e-20, 1.7197e-03, 3.4540e-02, 3.1497e-05, 1.7197e-03, 3.9888e-19,
        3.4540e-02, 1.1587e-05, 7.1193e-11, 1.7647e-13])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 89.96% 

Test Accuracy: 89.11% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.563529372215271
distance x is tensor(114.7049, device='cuda:0')
benign distance is  tensor(114.7049, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8981601595878601
distance x is tensor(111.4432, device='cuda:0')
benign distance is  tensor(111.4432, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.15136030316352844
distance x is tensor(126.0917, device='cuda:0')
benign distance is  tensor(126.0917, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7428687810897827
distance x is tensor(102.9470, device='cuda:0')
benign distance is  tensor(102.9470, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8597100973129272
distance x is tensor(85.6569, device='cuda:0')
benign distance is  tensor(85.6569, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.612338125705719
distance x is tensor(123.9727, device='cuda:0')
benign distance is  tensor(123.9727, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5327712297439575
distance x is tensor(94.6842, device='cuda:0')
benign distance is  tensor(94.6842, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5501947402954102
distance x is tensor(117.7533, device='cuda:0')
benign distance is  tensor(117.7533, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4941774308681488
distance x is tensor(128.4825, device='cuda:0')
benign distance is  tensor(128.4825, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.2460668981075287
distance x is tensor(128.0784, device='cuda:0')
benign distance is  tensor(128.0784, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4438563287258148
distance x is tensor(130.5059, device='cuda:0')
benign distance is  tensor(130.5059, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9169853925704956
distance x is tensor(111.6258, device='cuda:0')
benign distance is  tensor(111.6258, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.57613205909729
distance x is tensor(97.5160, device='cuda:0')
benign distance is  tensor(97.5160, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.583406925201416
distance x is tensor(114.4238, device='cuda:0')
benign distance is  tensor(114.4238, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.24318508803844452
distance x is tensor(126.7521, device='cuda:0')
benign distance is  tensor(126.7521, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.23468565940856934
distance x is tensor(127.9271, device='cuda:0')
benign distance is  tensor(127.9271, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.6004079580307007
distance x is tensor(113.8536, device='cuda:0')
benign distance is  tensor(113.8536, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.774837851524353
distance x is tensor(143.7229, device='cuda:0')
benign distance is  tensor(143.7229, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.1276073157787323
distance x is tensor(129.8975, device='cuda:0')
benign distance is  tensor(129.8975, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.09305031597614288
distance x is tensor(123.8543, device='cuda:0')
benign distance is  tensor(123.8543, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5709754228591919
distance x is tensor(137.6601, device='cuda:0')
benign distance is  tensor(137.6601, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9095751643180847
distance x is tensor(119.1601, device='cuda:0')
benign distance is  tensor(119.1601, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.46669167280197144
distance x is tensor(134.9178, device='cuda:0')
benign distance is  tensor(134.9178, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6279619932174683
distance x is tensor(130.7594, device='cuda:0')
benign distance is  tensor(130.7594, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.6997905969619751
distance x is tensor(128.3557, device='cuda:0')
benign distance is  tensor(128.3557, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.5322321653366089
distance x is tensor(124.9213, device='cuda:0')
benign distance is  tensor(124.9213, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6706980466842651
distance x is tensor(127.6137, device='cuda:0')
benign distance is  tensor(127.6137, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.21674028038978577
distance x is tensor(132.7792, device='cuda:0')
benign distance is  tensor(132.7792, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6540039777755737
distance x is tensor(122.3745, device='cuda:0')
benign distance is  tensor(122.3745, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.3902265429496765
distance x is tensor(120.1626, device='cuda:0')
benign distance is  tensor(120.1626, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.4507332444190979
distance x is tensor(133.8315, device='cuda:0')
benign distance is  tensor(133.8315, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.33276647329330444
distance x is tensor(120.2708, device='cuda:0')
benign distance is  tensor(120.2708, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.0788542777299881
distance x is tensor(129.7388, device='cuda:0')
benign distance is  tensor(129.7388, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.3624124825000763
distance x is tensor(128.0247, device='cuda:0')
benign distance is  tensor(128.0247, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.09713935106992722
distance x is tensor(115.0590, device='cuda:0')
benign distance is  tensor(115.0590, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.5436006784439087
distance x is tensor(126.3324, device='cuda:0')
benign distance is  tensor(126.3324, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.2773473858833313
distance x is tensor(125.0453, device='cuda:0')
benign distance is  tensor(125.0453, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8282977342605591
distance x is tensor(130.6790, device='cuda:0')
benign distance is  tensor(130.6790, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9586740732192993
distance x is tensor(122.6211, device='cuda:0')
benign distance is  tensor(122.6211, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5302145481109619
distance x is tensor(127.9244, device='cuda:0')
benign distance is  tensor(127.9244, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.33805546164512634
mal_entropy is 0.045568641275167465
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 88.83% 

Test Accuracy: 87.96% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.33749133348464966
distance x is tensor(138.6245, device='cuda:0')
benign distance is  tensor(138.6245, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.17669829726219177
distance x is tensor(103.3435, device='cuda:0')
benign distance is  tensor(103.3435, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.10218833386898041
distance x is tensor(154.2034, device='cuda:0')
benign distance is  tensor(154.2034, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9045674204826355
distance x is tensor(131.2877, device='cuda:0')
benign distance is  tensor(131.2877, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6287909150123596
distance x is tensor(90.2611, device='cuda:0')
benign distance is  tensor(90.2611, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2298040390014648
distance x is tensor(130.9457, device='cuda:0')
benign distance is  tensor(130.9457, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3975149691104889
distance x is tensor(107.1719, device='cuda:0')
benign distance is  tensor(107.1719, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4727204740047455
distance x is tensor(152.9681, device='cuda:0')
benign distance is  tensor(152.9681, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.07406573742628098
mal_entropy is 0.07904691994190216
user_PLR len size 36
counter_tensor is  tensor([15., 34., 16., 35., 35., 28., 35., 16., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 27., 32., 27., 35., 35., 18., 26., 23.,
        19., 23., 30., 12., 33., 35., 15., 35.])
count_res tensor([2.7258e-10, 4.8651e-02, 7.4095e-10, 1.3225e-01, 1.3225e-01, 1.2059e-04,
        1.3225e-01, 7.4095e-10, 2.2087e-06, 2.2087e-06, 2.2087e-06, 2.2087e-06,
        2.2087e-06, 2.2087e-06, 2.2087e-06, 2.2087e-06, 2.2087e-06, 2.2087e-06,
        2.2087e-06, 2.2087e-06, 4.4364e-05, 6.5841e-03, 4.4364e-05, 1.3225e-01,
        1.3225e-01, 5.4749e-09, 1.6320e-05, 8.1255e-07, 1.4882e-08, 8.1255e-07,
        8.9107e-04, 1.3571e-11, 1.7898e-02, 1.3225e-01, 2.7258e-10, 1.3225e-01])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 89.78% 

Test Accuracy: 88.81% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.24233171343803406
distance x is tensor(131.2789, device='cuda:0')
benign distance is  tensor(131.2789, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7123200297355652
distance x is tensor(109.2896, device='cuda:0')
benign distance is  tensor(109.2896, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.25594058632850647
distance x is tensor(146.7241, device='cuda:0')
benign distance is  tensor(146.7241, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9876914024353027
distance x is tensor(106.2163, device='cuda:0')
benign distance is  tensor(106.2163, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.31487390398979187
distance x is tensor(108.9348, device='cuda:0')
benign distance is  tensor(108.9348, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7621921300888062
distance x is tensor(124.9224, device='cuda:0')
benign distance is  tensor(124.9224, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2677311599254608
distance x is tensor(94.3470, device='cuda:0')
benign distance is  tensor(94.3470, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5866739749908447
distance x is tensor(133.4059, device='cuda:0')
benign distance is  tensor(133.4059, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.010972261428833
distance x is tensor(159.9906, device='cuda:0')
benign distance is  tensor(159.9906, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.39369016885757446
distance x is tensor(138.6982, device='cuda:0')
benign distance is  tensor(138.6982, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8108687400817871
distance x is tensor(132.0511, device='cuda:0')
benign distance is  tensor(132.0511, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7473312616348267
distance x is tensor(106.4457, device='cuda:0')
benign distance is  tensor(106.4457, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.17559058964252472
distance x is tensor(119.7124, device='cuda:0')
benign distance is  tensor(119.7124, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4946349263191223
distance x is tensor(113.2477, device='cuda:0')
benign distance is  tensor(113.2477, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6023244261741638
distance x is tensor(131.2283, device='cuda:0')
benign distance is  tensor(131.2283, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9116138219833374
distance x is tensor(127.7261, device='cuda:0')
benign distance is  tensor(127.7261, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.39118316769599915
distance x is tensor(142.9647, device='cuda:0')
benign distance is  tensor(142.9647, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5222843885421753
distance x is tensor(140.8332, device='cuda:0')
benign distance is  tensor(140.8332, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3411365747451782
distance x is tensor(144.0559, device='cuda:0')
benign distance is  tensor(144.0559, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.7432863116264343
distance x is tensor(132.8606, device='cuda:0')
benign distance is  tensor(132.8606, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9851198196411133
distance x is tensor(129.3071, device='cuda:0')
benign distance is  tensor(129.3071, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.18484120070934296
distance x is tensor(139.0020, device='cuda:0')
benign distance is  tensor(139.0020, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.557181179523468
distance x is tensor(129.9514, device='cuda:0')
benign distance is  tensor(129.9514, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.23784342408180237
distance x is tensor(111.3545, device='cuda:0')
benign distance is  tensor(111.3545, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.3305748403072357
mal_entropy is 0.08241994678974152
user_PLR len size 28
counter_tensor is  tensor([12., 24., 12., 23., 27., 22., 27., 26., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 25., 12., 12., 24., 19., 12., 23., 12.])
count_res tensor([1.1558e-07, 1.8811e-02, 1.1558e-07, 6.9202e-03, 3.7783e-01, 2.5458e-03,
        3.7783e-01, 1.3900e-01, 6.3104e-06, 6.3104e-06, 6.3104e-06, 6.3104e-06,
        6.3104e-06, 6.3104e-06, 6.3104e-06, 6.3104e-06, 6.3104e-06, 6.3104e-06,
        6.3104e-06, 6.3104e-06, 5.1134e-02, 1.1558e-07, 1.1558e-07, 1.8811e-02,
        1.2675e-04, 1.1558e-07, 6.9202e-03, 1.1558e-07])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 89.54% 

Test Accuracy: 88.20% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.548267662525177
distance x is tensor(131.9296, device='cuda:0')
benign distance is  tensor(131.9296, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6402016282081604
distance x is tensor(118.8407, device='cuda:0')
benign distance is  tensor(118.8407, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.030256668105721474
distance x is tensor(148.5900, device='cuda:0')
benign distance is  tensor(148.5900, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.48969244956970215
distance x is tensor(113.6965, device='cuda:0')
benign distance is  tensor(113.6965, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6992805004119873
distance x is tensor(87.5293, device='cuda:0')
benign distance is  tensor(87.5293, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.15538938343524933
distance x is tensor(136.0488, device='cuda:0')
benign distance is  tensor(136.0488, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7364965081214905
distance x is tensor(101.0597, device='cuda:0')
benign distance is  tensor(101.0597, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5869104862213135
distance x is tensor(133.5403, device='cuda:0')
benign distance is  tensor(133.5403, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3865724802017212
distance x is tensor(129.1707, device='cuda:0')
benign distance is  tensor(129.1707, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9534100294113159
distance x is tensor(163.4920, device='cuda:0')
benign distance is  tensor(163.4920, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.018755124881863594
distance x is tensor(150.6176, device='cuda:0')
benign distance is  tensor(150.6176, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.6716462969779968
distance x is tensor(135.7108, device='cuda:0')
benign distance is  tensor(135.7108, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.08574484288692474
distance x is tensor(139.1864, device='cuda:0')
benign distance is  tensor(139.1864, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6248175501823425
distance x is tensor(147.9427, device='cuda:0')
benign distance is  tensor(147.9427, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.16656433045864105
distance x is tensor(158.0721, device='cuda:0')
benign distance is  tensor(158.0721, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.40445780754089355
distance x is tensor(152.4696, device='cuda:0')
benign distance is  tensor(152.4696, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.9878019094467163
mal_entropy is 0.0053365412168204784
user_PLR len size 28
counter_tensor is  tensor([27., 25., 25., 27., 13., 27., 26., 14., 14., 14., 14., 14., 14., 14.,
        14., 14., 14., 14., 14., 14., 25., 14., 27., 27., 18., 23., 26., 14.])
count_res tensor([1.6233e-01, 2.1969e-02, 2.1969e-02, 1.6233e-01, 1.3498e-07, 1.6233e-01,
        5.9718e-02, 3.6692e-07, 3.6692e-07, 3.6692e-07, 3.6692e-07, 3.6692e-07,
        3.6692e-07, 3.6692e-07, 3.6692e-07, 3.6692e-07, 3.6692e-07, 3.6692e-07,
        3.6692e-07, 3.6692e-07, 2.1969e-02, 3.6692e-07, 1.6233e-01, 1.6233e-01,
        2.0033e-05, 2.9732e-03, 5.9718e-02, 3.6692e-07])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 89.72% 

Test Accuracy: 88.93% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2282915562391281
distance x is tensor(103.1032, device='cuda:0')
benign distance is  tensor(103.1032, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6471151113510132
distance x is tensor(132.2170, device='cuda:0')
benign distance is  tensor(132.2170, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.15119469165802002
distance x is tensor(143.4152, device='cuda:0')
benign distance is  tensor(143.4152, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5235897302627563
distance x is tensor(105.1625, device='cuda:0')
benign distance is  tensor(105.1625, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6137465238571167
distance x is tensor(80.7885, device='cuda:0')
benign distance is  tensor(80.7885, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6101362109184265
distance x is tensor(122.1718, device='cuda:0')
benign distance is  tensor(122.1718, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.25043413043022156
distance x is tensor(102.2869, device='cuda:0')
benign distance is  tensor(102.2869, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2719760537147522
distance x is tensor(127.1972, device='cuda:0')
benign distance is  tensor(127.1972, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.05016772821545601
distance x is tensor(141.8441, device='cuda:0')
benign distance is  tensor(141.8441, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4580923914909363
distance x is tensor(138.0916, device='cuda:0')
benign distance is  tensor(138.0916, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.06591339409351349
distance x is tensor(119.9322, device='cuda:0')
benign distance is  tensor(119.9322, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9130910634994507
distance x is tensor(107.4271, device='cuda:0')
benign distance is  tensor(107.4271, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7623273730278015
distance x is tensor(118.7916, device='cuda:0')
benign distance is  tensor(118.7916, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3446797728538513
distance x is tensor(124.3992, device='cuda:0')
benign distance is  tensor(124.3992, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6104249358177185
distance x is tensor(140.3769, device='cuda:0')
benign distance is  tensor(140.3769, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3360350728034973
distance x is tensor(136.6190, device='cuda:0')
benign distance is  tensor(136.6190, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.755389392375946
mal_entropy is 0.033155106008052826
user_PLR len size 28
counter_tensor is  tensor([14., 20., 15., 13., 26., 27., 15.,  2., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 16., 14., 27., 27., 13., 26., 26., 13.])
count_res tensor([5.5066e-07, 2.2215e-04, 1.4968e-06, 2.0258e-07, 8.9622e-02, 2.4362e-01,
        1.4968e-06, 3.3834e-12, 4.0688e-06, 4.0688e-06, 4.0688e-06, 4.0688e-06,
        4.0688e-06, 4.0688e-06, 4.0688e-06, 4.0688e-06, 4.0688e-06, 4.0688e-06,
        4.0688e-06, 4.0688e-06, 4.0688e-06, 5.5066e-07, 2.4362e-01, 2.4362e-01,
        2.0258e-07, 8.9622e-02, 8.9622e-02, 2.0258e-07])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 89.68% 

Test Accuracy: 88.81% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.32401013374328613
distance x is tensor(104.8274, device='cuda:0')
benign distance is  tensor(104.8274, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7806212902069092
distance x is tensor(118.9292, device='cuda:0')
benign distance is  tensor(118.9292, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1360524445772171
distance x is tensor(133.5783, device='cuda:0')
benign distance is  tensor(133.5783, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.453131765127182
distance x is tensor(111.7939, device='cuda:0')
benign distance is  tensor(111.7939, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.24689838290214539
distance x is tensor(81.2976, device='cuda:0')
benign distance is  tensor(81.2976, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6629065275192261
distance x is tensor(116.3492, device='cuda:0')
benign distance is  tensor(116.3492, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5008696913719177
distance x is tensor(111.5409, device='cuda:0')
benign distance is  tensor(111.5409, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.29900071024894714
distance x is tensor(124.5982, device='cuda:0')
benign distance is  tensor(124.5982, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.13281483948230743
distance x is tensor(143.9128, device='cuda:0')
benign distance is  tensor(143.9128, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.07373233139514923
distance x is tensor(143.8089, device='cuda:0')
benign distance is  tensor(143.8089, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6520072221755981
distance x is tensor(121.8350, device='cuda:0')
benign distance is  tensor(121.8350, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.720464825630188
distance x is tensor(127.8805, device='cuda:0')
benign distance is  tensor(127.8805, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5612453818321228
distance x is tensor(133.0854, device='cuda:0')
benign distance is  tensor(133.0854, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.43746218085289
distance x is tensor(126.0290, device='cuda:0')
benign distance is  tensor(126.0290, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.6560441255569458
distance x is tensor(133.9649, device='cuda:0')
benign distance is  tensor(133.9649, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.10952584445476532
distance x is tensor(130.2801, device='cuda:0')
benign distance is  tensor(130.2801, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.3080410361289978
mal_entropy is 0.07517934590578079
user_PLR len size 52
counter_tensor is  tensor([16., 12., 15., 12., 48., 12.,  0.,  0., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 50., 21., 50.,  0., 38., 51., 12., 44.,
        50.,  0., 51.,  0., 12., 51., 49., 12., 14., 12.,  0., 16., 51., 51.,
         0., 12.,  0., 51., 48., 12., 47., 40.,  0.,  0.])
count_res tensor([8.5691e-17, 1.5695e-18, 3.1524e-17, 1.5695e-18, 6.7664e-03, 1.5695e-18,
        9.6432e-24, 9.6432e-24, 2.2699e-06, 2.2699e-06, 2.2699e-06, 2.2699e-06,
        2.2699e-06, 2.2699e-06, 2.2699e-06, 2.2699e-06, 2.2699e-06, 2.2699e-06,
        2.2699e-06, 2.2699e-06, 4.9997e-02, 1.2718e-14, 4.9997e-02, 9.6432e-24,
        3.0719e-07, 1.3591e-01, 1.5695e-18, 1.2393e-04, 4.9997e-02, 9.6432e-24,
        1.3591e-01, 9.6432e-24, 1.5695e-18, 1.3591e-01, 1.8393e-02, 1.5695e-18,
        1.1597e-17, 1.5695e-18, 9.6432e-24, 8.5691e-17, 1.3591e-01, 1.3591e-01,
        9.6432e-24, 1.5695e-18, 9.6432e-24, 1.3591e-01, 6.7664e-03, 1.5695e-18,
        2.4892e-03, 2.2699e-06, 9.6432e-24, 9.6432e-24])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 89.93% 

Test Accuracy: 88.82% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5450491905212402
distance x is tensor(109.6957, device='cuda:0')
benign distance is  tensor(109.6957, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2596829831600189
distance x is tensor(111.9268, device='cuda:0')
benign distance is  tensor(111.9268, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.12405934184789658
distance x is tensor(127.8649, device='cuda:0')
benign distance is  tensor(127.8649, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8830560445785522
distance x is tensor(105.0980, device='cuda:0')
benign distance is  tensor(105.0980, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5309961438179016
distance x is tensor(78.8926, device='cuda:0')
benign distance is  tensor(78.8926, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7736250162124634
distance x is tensor(123.6757, device='cuda:0')
benign distance is  tensor(123.6757, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.620908260345459
distance x is tensor(100.8335, device='cuda:0')
benign distance is  tensor(100.8335, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.31307047605514526
distance x is tensor(118.8293, device='cuda:0')
benign distance is  tensor(118.8293, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4435538351535797
distance x is tensor(134.5414, device='cuda:0')
benign distance is  tensor(134.5414, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.42828458547592163
distance x is tensor(134.7573, device='cuda:0')
benign distance is  tensor(134.7573, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4391873776912689
distance x is tensor(128.8008, device='cuda:0')
benign distance is  tensor(128.8008, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6323123574256897
distance x is tensor(119.4808, device='cuda:0')
benign distance is  tensor(119.4808, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6296965479850769
distance x is tensor(96.8628, device='cuda:0')
benign distance is  tensor(96.8628, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.34826958179473877
distance x is tensor(120.5168, device='cuda:0')
benign distance is  tensor(120.5168, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2562909424304962
distance x is tensor(130.5487, device='cuda:0')
benign distance is  tensor(130.5487, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5144340395927429
distance x is tensor(124.2119, device='cuda:0')
benign distance is  tensor(124.2119, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5952824354171753
distance x is tensor(119.6442, device='cuda:0')
benign distance is  tensor(119.6442, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6611128449440002
distance x is tensor(154.8097, device='cuda:0')
benign distance is  tensor(154.8097, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.6302585005760193
distance x is tensor(138.1534, device='cuda:0')
benign distance is  tensor(138.1534, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3693617880344391
distance x is tensor(121.0386, device='cuda:0')
benign distance is  tensor(121.0386, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.47360795736312866
distance x is tensor(120.5436, device='cuda:0')
benign distance is  tensor(120.5436, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7665631175041199
distance x is tensor(118.5484, device='cuda:0')
benign distance is  tensor(118.5484, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5682586431503296
distance x is tensor(132.7063, device='cuda:0')
benign distance is  tensor(132.7063, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6084791421890259
distance x is tensor(130.1870, device='cuda:0')
benign distance is  tensor(130.1870, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.1281159669160843
distance x is tensor(126.8757, device='cuda:0')
benign distance is  tensor(126.8757, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9699853658676147
distance x is tensor(124.6347, device='cuda:0')
benign distance is  tensor(124.6347, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3263782560825348
distance x is tensor(119.5636, device='cuda:0')
benign distance is  tensor(119.5636, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.671953558921814
distance x is tensor(122.0497, device='cuda:0')
benign distance is  tensor(122.0497, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7996013760566711
distance x is tensor(115.7254, device='cuda:0')
benign distance is  tensor(115.7254, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7880523800849915
distance x is tensor(120.8651, device='cuda:0')
benign distance is  tensor(120.8651, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5284327268600464
distance x is tensor(119.2697, device='cuda:0')
benign distance is  tensor(119.2697, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.2648068964481354
distance x is tensor(115.9059, device='cuda:0')
benign distance is  tensor(115.9059, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.3399582505226135
distance x is tensor(129.0043, device='cuda:0')
benign distance is  tensor(129.0043, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.7450865507125854
distance x is tensor(121.3970, device='cuda:0')
benign distance is  tensor(121.3970, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.17477509379386902
distance x is tensor(121.5463, device='cuda:0')
benign distance is  tensor(121.5463, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.19647490978240967
distance x is tensor(126.8843, device='cuda:0')
benign distance is  tensor(126.8843, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.23985615372657776
distance x is tensor(122.7953, device='cuda:0')
benign distance is  tensor(122.7953, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.42001575231552124
distance x is tensor(123.9956, device='cuda:0')
benign distance is  tensor(123.9956, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.0212093591690063
distance x is tensor(128.5849, device='cuda:0')
benign distance is  tensor(128.5849, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.3357923626899719
distance x is tensor(125.6875, device='cuda:0')
benign distance is  tensor(125.6875, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.5517600774765015
mal_entropy is 0.09494620561599731
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 88.92% 

Test Accuracy: 87.76% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6440802812576294
distance x is tensor(129.8989, device='cuda:0')
benign distance is  tensor(129.8989, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7794584631919861
distance x is tensor(128.2961, device='cuda:0')
benign distance is  tensor(128.2961, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1482144594192505
distance x is tensor(140.8416, device='cuda:0')
benign distance is  tensor(140.8416, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8548539280891418
distance x is tensor(120.8636, device='cuda:0')
benign distance is  tensor(120.8636, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8258930444717407
distance x is tensor(121.8445, device='cuda:0')
benign distance is  tensor(121.8445, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6660867929458618
distance x is tensor(135.0457, device='cuda:0')
benign distance is  tensor(135.0457, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.37160351872444153
distance x is tensor(134.5559, device='cuda:0')
benign distance is  tensor(134.5559, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3706669509410858
distance x is tensor(145.3278, device='cuda:0')
benign distance is  tensor(145.3278, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.5144200325012207
mal_entropy is 0.24299822747707367
user_PLR len size 28
counter_tensor is  tensor([26., 27., 22., 19., 27., 27., 26., 17., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 24., 20., 25., 16., 25., 16., 26.,  3.])
count_res tensor([8.2999e-02, 2.2561e-01, 1.5202e-03, 7.5685e-05, 2.2561e-01, 2.2561e-01,
        8.2999e-02, 1.0243e-05, 3.7681e-06, 3.7681e-06, 3.7681e-06, 3.7681e-06,
        3.7681e-06, 3.7681e-06, 3.7681e-06, 3.7681e-06, 3.7681e-06, 3.7681e-06,
        3.7681e-06, 3.7681e-06, 1.1233e-02, 2.0573e-04, 3.0533e-02, 3.7681e-06,
        3.0533e-02, 3.7681e-06, 8.2999e-02, 8.5172e-12])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 89.78% 

Test Accuracy: 88.40% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.46269768476486206
distance x is tensor(120.8782, device='cuda:0')
benign distance is  tensor(120.8782, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7587565183639526
distance x is tensor(100.1369, device='cuda:0')
benign distance is  tensor(100.1369, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.21700409054756165
distance x is tensor(147.6004, device='cuda:0')
benign distance is  tensor(147.6004, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.825775146484375
distance x is tensor(117.3933, device='cuda:0')
benign distance is  tensor(117.3933, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8758248090744019
distance x is tensor(61.0963, device='cuda:0')
benign distance is  tensor(61.0963, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.4542410373687744
distance x is tensor(128.2263, device='cuda:0')
benign distance is  tensor(128.2263, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.36307233572006226
distance x is tensor(98.7524, device='cuda:0')
benign distance is  tensor(98.7524, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.44066324830055237
distance x is tensor(129.4006, device='cuda:0')
benign distance is  tensor(129.4006, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4122183322906494
distance x is tensor(141.1032, device='cuda:0')
benign distance is  tensor(141.1032, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.23016396164894104
distance x is tensor(138.3165, device='cuda:0')
benign distance is  tensor(138.3165, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0129499435424805
distance x is tensor(127.5224, device='cuda:0')
benign distance is  tensor(127.5224, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4700089693069458
distance x is tensor(123.5331, device='cuda:0')
benign distance is  tensor(123.5331, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.1587066352367401
distance x is tensor(115.8761, device='cuda:0')
benign distance is  tensor(115.8761, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.16298650205135345
distance x is tensor(125.7720, device='cuda:0')
benign distance is  tensor(125.7720, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5232623815536499
distance x is tensor(130.9283, device='cuda:0')
benign distance is  tensor(130.9283, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6187729835510254
distance x is tensor(145.8841, device='cuda:0')
benign distance is  tensor(145.8841, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 1.0624936819076538
mal_entropy is 0.038492973893880844
user_PLR len size 28
counter_tensor is  tensor([12., 12., 12., 27., 25., 12., 25., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 26., 12., 12., 27., 27., 12., 27., 12.])
count_res tensor([6.5945e-08, 6.5945e-08, 6.5945e-08, 2.1558e-01, 2.9175e-02, 6.5945e-08,
        2.9175e-02, 6.5945e-08, 3.6005e-06, 3.6005e-06, 3.6005e-06, 3.6005e-06,
        3.6005e-06, 3.6005e-06, 3.6005e-06, 3.6005e-06, 3.6005e-06, 3.6005e-06,
        3.6005e-06, 3.6005e-06, 7.9306e-02, 6.5945e-08, 6.5945e-08, 2.1558e-01,
        2.1558e-01, 6.5945e-08, 2.1558e-01, 6.5945e-08])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 89.67% 

Test Accuracy: 89.09% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5857835412025452
distance x is tensor(125.2974, device='cuda:0')
benign distance is  tensor(125.2974, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8147822618484497
distance x is tensor(120.9028, device='cuda:0')
benign distance is  tensor(120.9028, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.027506891638040543
distance x is tensor(134.0683, device='cuda:0')
benign distance is  tensor(134.0683, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3388834595680237
distance x is tensor(110.5590, device='cuda:0')
benign distance is  tensor(110.5590, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3293362855911255
distance x is tensor(85.2653, device='cuda:0')
benign distance is  tensor(85.2653, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9249895811080933
distance x is tensor(119.7833, device='cuda:0')
benign distance is  tensor(119.7833, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.20438142120838165
distance x is tensor(102.2755, device='cuda:0')
benign distance is  tensor(102.2755, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3374277651309967
distance x is tensor(123.4402, device='cuda:0')
benign distance is  tensor(123.4402, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.43984609842300415
distance x is tensor(122.6381, device='cuda:0')
benign distance is  tensor(122.6381, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.13533265888690948
distance x is tensor(154.9438, device='cuda:0')
benign distance is  tensor(154.9438, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5347323417663574
distance x is tensor(127.1828, device='cuda:0')
benign distance is  tensor(127.1828, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2157057523727417
distance x is tensor(121.8227, device='cuda:0')
benign distance is  tensor(121.8227, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.604776918888092
distance x is tensor(115.9292, device='cuda:0')
benign distance is  tensor(115.9292, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8959697484970093
distance x is tensor(120.0727, device='cuda:0')
benign distance is  tensor(120.0727, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3571047782897949
distance x is tensor(130.7905, device='cuda:0')
benign distance is  tensor(130.7905, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.11913999170064926
distance x is tensor(139.0035, device='cuda:0')
benign distance is  tensor(139.0035, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.3350583612918854
mal_entropy is 0.060254551470279694
user_PLR len size 44
counter_tensor is  tensor([ 0., 43.,  0., 40., 27.,  5., 43.,  0., 29., 29., 29., 29., 29., 29.,
        29., 29., 29., 29., 29., 29., 16., 16., 42., 16., 29., 43., 15., 43.,
         2.,  0., 17., 43., 42., 15., 17., 42., 14., 16., 43., 14.,  1.,  0.,
        14., 14.])
count_res tensor([2.9568e-20, 1.3979e-01, 2.9568e-20, 6.9599e-03, 1.5732e-08, 4.3883e-18,
        1.3979e-01, 2.9568e-20, 1.1624e-07, 1.1624e-07, 1.1624e-07, 1.1624e-07,
        1.1624e-07, 1.1624e-07, 1.1624e-07, 1.1624e-07, 1.1624e-07, 1.1624e-07,
        1.1624e-07, 1.1624e-07, 2.6274e-13, 2.6274e-13, 5.1427e-02, 2.6274e-13,
        1.1624e-07, 1.3979e-01, 9.6658e-14, 1.3979e-01, 2.1848e-19, 2.9568e-20,
        7.1421e-13, 1.3979e-01, 5.1427e-02, 9.6658e-14, 7.1421e-13, 5.1427e-02,
        3.5559e-14, 2.6274e-13, 1.3979e-01, 3.5559e-14, 8.0374e-20, 2.9568e-20,
        3.5559e-14, 3.5559e-14])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 90.02% 

Test Accuracy: 89.06% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.05184140056371689
distance x is tensor(121.0599, device='cuda:0')
benign distance is  tensor(121.0599, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7214155197143555
distance x is tensor(115.0209, device='cuda:0')
benign distance is  tensor(115.0209, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.41295480728149414
distance x is tensor(137.6078, device='cuda:0')
benign distance is  tensor(137.6078, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.39977917075157166
distance x is tensor(111.9110, device='cuda:0')
benign distance is  tensor(111.9110, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5007991194725037
distance x is tensor(88.0415, device='cuda:0')
benign distance is  tensor(88.0415, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.35495513677597046
distance x is tensor(110.0219, device='cuda:0')
benign distance is  tensor(110.0219, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6632978320121765
distance x is tensor(89.6152, device='cuda:0')
benign distance is  tensor(89.6152, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5140007138252258
distance x is tensor(126.1747, device='cuda:0')
benign distance is  tensor(126.1747, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.39794883131980896
distance x is tensor(144.8594, device='cuda:0')
benign distance is  tensor(144.8594, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.2381938695907593
distance x is tensor(122.0310, device='cuda:0')
benign distance is  tensor(122.0310, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5627781748771667
distance x is tensor(128.7426, device='cuda:0')
benign distance is  tensor(128.7426, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7725547552108765
distance x is tensor(116.2102, device='cuda:0')
benign distance is  tensor(116.2102, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5315274596214294
distance x is tensor(113.7578, device='cuda:0')
benign distance is  tensor(113.7578, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.07646874338388443
distance x is tensor(113.1596, device='cuda:0')
benign distance is  tensor(113.1596, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.19664831459522247
distance x is tensor(126.9826, device='cuda:0')
benign distance is  tensor(126.9826, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4992089867591858
distance x is tensor(123.9306, device='cuda:0')
benign distance is  tensor(123.9306, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.4208657741546631
distance x is tensor(134.7293, device='cuda:0')
benign distance is  tensor(134.7293, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6105807423591614
distance x is tensor(137.9663, device='cuda:0')
benign distance is  tensor(137.9663, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.26638275384902954
distance x is tensor(137.5879, device='cuda:0')
benign distance is  tensor(137.5879, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5992208123207092
distance x is tensor(128.6015, device='cuda:0')
benign distance is  tensor(128.6015, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5099760293960571
distance x is tensor(123.3005, device='cuda:0')
benign distance is  tensor(123.3005, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5257072448730469
distance x is tensor(142.5309, device='cuda:0')
benign distance is  tensor(142.5309, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.39535290002822876
distance x is tensor(134.0593, device='cuda:0')
benign distance is  tensor(134.0593, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.28056979179382324
distance x is tensor(119.0965, device='cuda:0')
benign distance is  tensor(119.0965, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.43575653433799744
distance x is tensor(141.3984, device='cuda:0')
benign distance is  tensor(141.3984, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.03814898803830147
distance x is tensor(140.0428, device='cuda:0')
benign distance is  tensor(140.0428, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.12677201628684998
distance x is tensor(128.2952, device='cuda:0')
benign distance is  tensor(128.2952, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.22518953680992126
distance x is tensor(130.7696, device='cuda:0')
benign distance is  tensor(130.7696, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.046977162361145
distance x is tensor(132.9202, device='cuda:0')
benign distance is  tensor(132.9202, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.21462348103523254
distance x is tensor(110.9910, device='cuda:0')
benign distance is  tensor(110.9910, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.40421849489212036
distance x is tensor(132.7409, device='cuda:0')
benign distance is  tensor(132.7409, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.4693130552768707
distance x is tensor(124.8596, device='cuda:0')
benign distance is  tensor(124.8596, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.6083751916885376
mal_entropy is 0.044811125844717026
user_PLR len size 20
counter_tensor is  tensor([13., 12., 12., 12., 13., 12., 19., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([7.3709e-05, 2.7116e-05, 2.7116e-05, 2.7116e-05, 7.3709e-05, 2.7116e-05,
        2.9736e-02, 2.7116e-05, 8.0832e-02, 8.0832e-02, 8.0832e-02, 8.0832e-02,
        8.0832e-02, 8.0832e-02, 8.0832e-02, 8.0832e-02, 8.0832e-02, 8.0832e-02,
        8.0832e-02, 8.0832e-02])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 88.81% 

Test Accuracy: 87.58% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9379544258117676
distance x is tensor(140.4943, device='cuda:0')
benign distance is  tensor(140.4943, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4018399119377136
distance x is tensor(150.0605, device='cuda:0')
benign distance is  tensor(150.0605, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.08160624653100967
distance x is tensor(153.4071, device='cuda:0')
benign distance is  tensor(153.4071, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5630139112472534
distance x is tensor(127.0602, device='cuda:0')
benign distance is  tensor(127.0602, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5849214792251587
distance x is tensor(107.3361, device='cuda:0')
benign distance is  tensor(107.3361, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6254544258117676
distance x is tensor(134.3436, device='cuda:0')
benign distance is  tensor(134.3436, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2541656196117401
distance x is tensor(109.6471, device='cuda:0')
benign distance is  tensor(109.6471, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3473741114139557
distance x is tensor(150.6013, device='cuda:0')
benign distance is  tensor(150.6013, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.7500000005
mal_loss is 2.9756274223327637
mal_entropy is 0.09978824853897095
user_PLR len size 44
counter_tensor is  tensor([23., 30., 34., 17., 41., 26., 37., 27., 31., 31., 31., 31., 31., 31.,
        31., 31., 31., 31., 31., 31., 40.,  3., 43., 43., 20., 37., 32., 35.,
        40., 43., 24., 39., 39., 39., 41.,  6., 17., 32., 37., 36., 42., 41.,
         6.,  6.])
count_res tensor([5.2349e-10, 5.7408e-07, 3.1344e-05, 1.2976e-12, 3.4372e-02, 1.0515e-08,
        6.2955e-04, 2.8582e-08, 1.5605e-06, 1.5605e-06, 1.5605e-06, 1.5605e-06,
        1.5605e-06, 1.5605e-06, 1.5605e-06, 1.5605e-06, 1.5605e-06, 1.5605e-06,
        1.5605e-06, 1.5605e-06, 1.2645e-02, 1.0790e-18, 2.5398e-01, 2.5398e-01,
        2.6063e-11, 6.2955e-04, 4.2419e-06, 8.5201e-05, 1.2645e-02, 2.5398e-01,
        1.4230e-09, 4.6518e-03, 4.6518e-03, 4.6518e-03, 3.4372e-02, 2.1672e-17,
        1.2976e-12, 4.2419e-06, 6.2955e-04, 2.3160e-04, 9.3434e-02, 3.4372e-02,
        2.1672e-17, 2.1672e-17])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 89.73% 

Test Accuracy: 89.20% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6228299140930176
distance x is tensor(126.7557, device='cuda:0')
benign distance is  tensor(126.7557, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.593399167060852
distance x is tensor(122.2404, device='cuda:0')
benign distance is  tensor(122.2404, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.24904975295066833
distance x is tensor(129.0565, device='cuda:0')
benign distance is  tensor(129.0565, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6136771440505981
distance x is tensor(103.4630, device='cuda:0')
benign distance is  tensor(103.4630, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.25371113419532776
distance x is tensor(86.8364, device='cuda:0')
benign distance is  tensor(86.8364, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.2964813709259033
distance x is tensor(116.4883, device='cuda:0')
benign distance is  tensor(116.4883, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.46533775329589844
distance x is tensor(97.5305, device='cuda:0')
benign distance is  tensor(97.5305, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3148183226585388
distance x is tensor(131.0925, device='cuda:0')
benign distance is  tensor(131.0925, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.11224408447742462
distance x is tensor(139.3069, device='cuda:0')
benign distance is  tensor(139.3069, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3823690712451935
distance x is tensor(127.0654, device='cuda:0')
benign distance is  tensor(127.0654, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.402924120426178
distance x is tensor(126.9662, device='cuda:0')
benign distance is  tensor(126.9662, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.717924952507019
distance x is tensor(130.2632, device='cuda:0')
benign distance is  tensor(130.2632, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.41468754410743713
distance x is tensor(112.8362, device='cuda:0')
benign distance is  tensor(112.8362, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.13430143892765045
distance x is tensor(115.5225, device='cuda:0')
benign distance is  tensor(115.5225, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5668286085128784
distance x is tensor(133.3933, device='cuda:0')
benign distance is  tensor(133.3933, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.5661346912384033
distance x is tensor(132.4851, device='cuda:0')
benign distance is  tensor(132.4851, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3462332785129547
distance x is tensor(113.2118, device='cuda:0')
benign distance is  tensor(113.2118, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9430813789367676
distance x is tensor(128.1583, device='cuda:0')
benign distance is  tensor(128.1583, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5129185318946838
distance x is tensor(128.8931, device='cuda:0')
benign distance is  tensor(128.8931, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4069337844848633
distance x is tensor(125.9078, device='cuda:0')
benign distance is  tensor(125.9078, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4527364671230316
distance x is tensor(132.1186, device='cuda:0')
benign distance is  tensor(132.1186, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4361910820007324
distance x is tensor(115.7556, device='cuda:0')
benign distance is  tensor(115.7556, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.7244643568992615
distance x is tensor(127.4975, device='cuda:0')
benign distance is  tensor(127.4975, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4704294800758362
distance x is tensor(140.6763, device='cuda:0')
benign distance is  tensor(140.6763, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.13603666424751282
distance x is tensor(127.7020, device='cuda:0')
benign distance is  tensor(127.7020, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.4516594409942627
distance x is tensor(124.0946, device='cuda:0')
benign distance is  tensor(124.0946, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.150334432721138
distance x is tensor(105.7258, device='cuda:0')
benign distance is  tensor(105.7258, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.4017866253852844
distance x is tensor(114.0504, device='cuda:0')
benign distance is  tensor(114.0504, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.1862170696258545
distance x is tensor(131.5439, device='cuda:0')
benign distance is  tensor(131.5439, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5365029573440552
distance x is tensor(126.2744, device='cuda:0')
benign distance is  tensor(126.2744, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8004530072212219
distance x is tensor(142.2733, device='cuda:0')
benign distance is  tensor(142.2733, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.511500895023346
distance x is tensor(129.6700, device='cuda:0')
benign distance is  tensor(129.6700, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 0.5517601370811462
mal_entropy is 0.10253914445638657
user_PLR len size 20
counter_tensor is  tensor([15., 15., 13., 15., 19., 14., 18., 15., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([5.3759e-04, 5.3759e-04, 7.2755e-05, 5.3759e-04, 2.9352e-02, 1.9777e-04,
        1.0798e-02, 5.3759e-04, 7.9786e-02, 7.9786e-02, 7.9786e-02, 7.9786e-02,
        7.9786e-02, 7.9786e-02, 7.9786e-02, 7.9786e-02, 7.9786e-02, 7.9786e-02,
        7.9786e-02, 7.9786e-02])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 88.63% 

Test Accuracy: 87.90% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5099971890449524
distance x is tensor(147.6858, device='cuda:0')
benign distance is  tensor(147.6858, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8025479316711426
distance x is tensor(128.0361, device='cuda:0')
benign distance is  tensor(128.0361, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.18822650611400604
distance x is tensor(150.9289, device='cuda:0')
benign distance is  tensor(150.9289, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5056248903274536
distance x is tensor(153.7665, device='cuda:0')
benign distance is  tensor(153.7665, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.43891820311546326
distance x is tensor(109.3542, device='cuda:0')
benign distance is  tensor(109.3542, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.49934911727905273
distance x is tensor(135.0333, device='cuda:0')
benign distance is  tensor(135.0333, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7077393531799316
distance x is tensor(120.1604, device='cuda:0')
benign distance is  tensor(120.1604, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.24558886885643005
distance x is tensor(141.5300, device='cuda:0')
benign distance is  tensor(141.5300, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 1.2028920650482178
mal_entropy is 0.046974800527095795
user_PLR len size 36
counter_tensor is  tensor([35., 31., 15., 22., 34., 34., 35., 33., 23., 23., 23., 23., 23., 23.,
        23., 23., 23., 23., 23., 23., 18., 35., 35., 34., 34., 35., 31., 35.,
        13., 32., 33., 29., 23., 29., 24., 15.])
count_res tensor([1.2765e-01, 2.3381e-03, 2.6311e-10, 2.8854e-07, 4.6961e-02, 4.6961e-02,
        1.2765e-01, 1.7276e-02, 7.8433e-07, 7.8433e-07, 7.8433e-07, 7.8433e-07,
        7.8433e-07, 7.8433e-07, 7.8433e-07, 7.8433e-07, 7.8433e-07, 7.8433e-07,
        7.8433e-07, 7.8433e-07, 5.2848e-09, 1.2765e-01, 1.2765e-01, 4.6961e-02,
        4.6961e-02, 1.2765e-01, 2.3381e-03, 1.2765e-01, 3.5609e-11, 6.3555e-03,
        1.7276e-02, 3.1642e-04, 7.8433e-07, 3.1642e-04, 2.1320e-06, 2.6311e-10])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 90.06% 

Test Accuracy: 89.05% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5172014236450195
distance x is tensor(118.4792, device='cuda:0')
benign distance is  tensor(118.4792, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.43230801820755005
distance x is tensor(115.3877, device='cuda:0')
benign distance is  tensor(115.3877, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.15299661457538605
distance x is tensor(133.0037, device='cuda:0')
benign distance is  tensor(133.0037, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3382767140865326
distance x is tensor(115.7451, device='cuda:0')
benign distance is  tensor(115.7451, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.25789177417755127
distance x is tensor(83.2241, device='cuda:0')
benign distance is  tensor(83.2241, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7930232286453247
distance x is tensor(118.1286, device='cuda:0')
benign distance is  tensor(118.1286, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5871956944465637
distance x is tensor(87.2426, device='cuda:0')
benign distance is  tensor(87.2426, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.37285396456718445
distance x is tensor(132.6115, device='cuda:0')
benign distance is  tensor(132.6115, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4514633119106293
distance x is tensor(144.7726, device='cuda:0')
benign distance is  tensor(144.7726, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4762696623802185
distance x is tensor(133.3607, device='cuda:0')
benign distance is  tensor(133.3607, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7575096487998962
distance x is tensor(124.6111, device='cuda:0')
benign distance is  tensor(124.6111, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5026731491088867
distance x is tensor(121.6081, device='cuda:0')
benign distance is  tensor(121.6081, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0171793699264526
distance x is tensor(116.0797, device='cuda:0')
benign distance is  tensor(116.0797, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3077557682991028
distance x is tensor(120.1860, device='cuda:0')
benign distance is  tensor(120.1860, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4464476704597473
distance x is tensor(132.0996, device='cuda:0')
benign distance is  tensor(132.0996, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9012457132339478
distance x is tensor(138.1812, device='cuda:0')
benign distance is  tensor(138.1812, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.6779404282569885
distance x is tensor(136.9677, device='cuda:0')
benign distance is  tensor(136.9677, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9491288065910339
distance x is tensor(128.2362, device='cuda:0')
benign distance is  tensor(128.2362, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.06391147524118423
distance x is tensor(139.1446, device='cuda:0')
benign distance is  tensor(139.1446, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.15918973088264465
distance x is tensor(126.5862, device='cuda:0')
benign distance is  tensor(126.5862, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.2808187007904053
distance x is tensor(121.1648, device='cuda:0')
benign distance is  tensor(121.1648, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4307214319705963
distance x is tensor(119.1157, device='cuda:0')
benign distance is  tensor(119.1157, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.23223698139190674
distance x is tensor(139.2061, device='cuda:0')
benign distance is  tensor(139.2061, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.5278552174568176
distance x is tensor(113.2442, device='cuda:0')
benign distance is  tensor(113.2442, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9500000005
mal_loss is 0.6268303990364075
mal_entropy is 0.021098656579852104
user_PLR len size 36
counter_tensor is  tensor([12., 12., 12., 35., 35., 12., 35., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 16., 12., 19., 12., 12., 12., 29., 22.,
        33., 33.,  0., 32., 12., 12., 12., 12.])
count_res tensor([3.0880e-11, 3.0880e-11, 3.0880e-11, 3.0092e-01, 3.0092e-01, 3.0880e-11,
        3.0092e-01, 3.0880e-11, 5.0259e-06, 5.0259e-06, 5.0259e-06, 5.0259e-06,
        5.0259e-06, 5.0259e-06, 5.0259e-06, 5.0259e-06, 5.0259e-06, 5.0259e-06,
        5.0259e-06, 5.0259e-06, 1.6860e-09, 3.0880e-11, 3.3864e-08, 3.0880e-11,
        3.0880e-11, 3.0880e-11, 7.4591e-04, 6.8018e-07, 4.0725e-02, 4.0725e-02,
        1.8973e-16, 1.4982e-02, 3.0880e-11, 3.0880e-11, 3.0880e-11, 3.0880e-11])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 90.05% 

Test Accuracy: 89.15% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2894252836704254
distance x is tensor(118.8166, device='cuda:0')
benign distance is  tensor(118.8166, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7272855043411255
distance x is tensor(133.8029, device='cuda:0')
benign distance is  tensor(133.8029, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.15100084245204926
distance x is tensor(150.2708, device='cuda:0')
benign distance is  tensor(150.2708, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.11767180263996124
distance x is tensor(94.9091, device='cuda:0')
benign distance is  tensor(94.9091, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4393949508666992
distance x is tensor(88.8661, device='cuda:0')
benign distance is  tensor(88.8661, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.30598878860473633
distance x is tensor(134.4035, device='cuda:0')
benign distance is  tensor(134.4035, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.12220203876495361
distance x is tensor(97.4001, device='cuda:0')
benign distance is  tensor(97.4001, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.18394547700881958
distance x is tensor(139.7445, device='cuda:0')
benign distance is  tensor(139.7445, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3150281310081482
distance x is tensor(147.5093, device='cuda:0')
benign distance is  tensor(147.5093, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.27390068769454956
distance x is tensor(155.9586, device='cuda:0')
benign distance is  tensor(155.9586, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.44922566413879395
distance x is tensor(141.5549, device='cuda:0')
benign distance is  tensor(141.5549, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.18445222079753876
distance x is tensor(140.5340, device='cuda:0')
benign distance is  tensor(140.5340, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.10689661651849747
distance x is tensor(156.5537, device='cuda:0')
benign distance is  tensor(156.5537, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8042905926704407
distance x is tensor(148.5642, device='cuda:0')
benign distance is  tensor(148.5642, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5002545118331909
distance x is tensor(154.3540, device='cuda:0')
benign distance is  tensor(154.3540, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.36612629890441895
distance x is tensor(144.5022, device='cuda:0')
benign distance is  tensor(144.5022, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.63125079870224
distance x is tensor(144.0988, device='cuda:0')
benign distance is  tensor(144.0988, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.017117707058787346
distance x is tensor(148.9214, device='cuda:0')
benign distance is  tensor(148.9214, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.08565525710582733
distance x is tensor(147.9724, device='cuda:0')
benign distance is  tensor(147.9724, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.4396773874759674
distance x is tensor(145.2262, device='cuda:0')
benign distance is  tensor(145.2262, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.21366870403289795
distance x is tensor(151.2708, device='cuda:0')
benign distance is  tensor(151.2708, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.42056313157081604
distance x is tensor(136.1394, device='cuda:0')
benign distance is  tensor(136.1394, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.5541682243347168
distance x is tensor(151.5356, device='cuda:0')
benign distance is  tensor(151.5356, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.20911583304405212
distance x is tensor(138.7477, device='cuda:0')
benign distance is  tensor(138.7477, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.450203001499176
mal_entropy is 0.1125873550772667
user_PLR len size 28
counter_tensor is  tensor([20., 21., 21., 26., 27., 27., 19., 19., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 23., 24., 26., 24., 19., 23., 23., 21.])
count_res tensor([3.1446e-04, 8.5479e-04, 8.5479e-04, 1.2686e-01, 3.4485e-01, 3.4485e-01,
        1.1568e-04, 1.1568e-04, 5.7595e-06, 5.7595e-06, 5.7595e-06, 5.7595e-06,
        5.7595e-06, 5.7595e-06, 5.7595e-06, 5.7595e-06, 5.7595e-06, 5.7595e-06,
        5.7595e-06, 5.7595e-06, 6.3161e-03, 1.7169e-02, 1.2686e-01, 1.7169e-02,
        1.1568e-04, 6.3161e-03, 6.3161e-03, 8.5479e-04])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 89.89% 

Test Accuracy: 88.70% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.020965050905942917
distance x is tensor(140.4792, device='cuda:0')
benign distance is  tensor(140.4792, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0440905094146729
distance x is tensor(129.6849, device='cuda:0')
benign distance is  tensor(129.6849, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7116768956184387
distance x is tensor(160.6823, device='cuda:0')
benign distance is  tensor(160.6823, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3744570314884186
distance x is tensor(127.0379, device='cuda:0')
benign distance is  tensor(127.0379, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1358240842819214
distance x is tensor(76.5699, device='cuda:0')
benign distance is  tensor(76.5699, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7325146794319153
distance x is tensor(102.5362, device='cuda:0')
benign distance is  tensor(102.5362, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3142310082912445
distance x is tensor(89.5434, device='cuda:0')
benign distance is  tensor(89.5434, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.26442521810531616
distance x is tensor(155.0722, device='cuda:0')
benign distance is  tensor(155.0722, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.20087000727653503
distance x is tensor(161.1586, device='cuda:0')
benign distance is  tensor(161.1586, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.36760812997817993
distance x is tensor(153.7617, device='cuda:0')
benign distance is  tensor(153.7617, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.2074350118637085
distance x is tensor(137.3667, device='cuda:0')
benign distance is  tensor(137.3667, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.30418357253074646
distance x is tensor(145.1890, device='cuda:0')
benign distance is  tensor(145.1890, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5597965121269226
distance x is tensor(131.0711, device='cuda:0')
benign distance is  tensor(131.0711, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2240944355726242
distance x is tensor(138.5507, device='cuda:0')
benign distance is  tensor(138.5507, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.41458767652511597
distance x is tensor(162.6711, device='cuda:0')
benign distance is  tensor(162.6711, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.2925763726234436
distance x is tensor(144.7160, device='cuda:0')
benign distance is  tensor(144.7160, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.326494961977005
mal_entropy is 0.07655628025531769
user_PLR len size 20
counter_tensor is  tensor([17., 18., 16., 16., 14., 14., 18., 16., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([0.0040, 0.0109, 0.0015, 0.0015, 0.0002, 0.0002, 0.0109, 0.0015, 0.0808,
        0.0808, 0.0808, 0.0808, 0.0808, 0.0808, 0.0808, 0.0808, 0.0808, 0.0808,
        0.0808, 0.0808])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 88.47% 

Test Accuracy: 87.31% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.1751408874988556
distance x is tensor(169.4352, device='cuda:0')
benign distance is  tensor(169.4352, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.09406685829162598
distance x is tensor(188.9220, device='cuda:0')
benign distance is  tensor(188.9220, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.15617969632148743
distance x is tensor(209.7034, device='cuda:0')
benign distance is  tensor(209.7034, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7000095844268799
distance x is tensor(166.3325, device='cuda:0')
benign distance is  tensor(166.3325, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5936716198921204
distance x is tensor(144.7158, device='cuda:0')
benign distance is  tensor(144.7158, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2437684535980225
distance x is tensor(180.0487, device='cuda:0')
benign distance is  tensor(180.0487, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6848436594009399
distance x is tensor(160.6364, device='cuda:0')
benign distance is  tensor(160.6364, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.12538187205791473
distance x is tensor(190.3502, device='cuda:0')
benign distance is  tensor(190.3502, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.8500000005
mal_loss is 1.314192533493042
mal_entropy is 0.052003681659698486
user_PLR len size 52
counter_tensor is  tensor([39., 42., 49., 48., 49., 41., 51., 31., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 29., 45., 51., 51., 27., 33., 51., 46.,
        51., 51., 41., 44., 43., 50., 39., 39., 44., 32., 36., 30., 51., 24.,
        30., 35., 39., 47., 28., 28., 27., 37., 37., 31.])
count_res tensor([7.9604e-07, 1.5989e-05, 1.7534e-02, 6.4504e-03, 1.7534e-02, 5.8820e-06,
        1.2956e-01, 2.6704e-10, 2.1639e-06, 2.1639e-06, 2.1639e-06, 2.1639e-06,
        2.1639e-06, 2.1639e-06, 2.1639e-06, 2.1639e-06, 2.1639e-06, 2.1639e-06,
        2.1639e-06, 2.1639e-06, 3.6140e-11, 3.2115e-04, 1.2956e-01, 1.2956e-01,
        4.8910e-12, 1.9732e-09, 1.2956e-01, 8.7296e-04, 1.2956e-01, 1.2956e-01,
        5.8820e-06, 1.1814e-04, 4.3462e-05, 4.7662e-02, 7.9604e-07, 7.9604e-07,
        1.1814e-04, 7.2589e-10, 3.9633e-08, 9.8239e-11, 1.2956e-01, 2.4351e-13,
        9.8239e-11, 1.4580e-08, 7.9604e-07, 2.3730e-03, 1.3295e-11, 1.3295e-11,
        4.8910e-12, 1.0773e-07, 1.0773e-07, 2.6704e-10])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 89.85% 

Test Accuracy: 88.98% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.28970757126808167
distance x is tensor(114.5686, device='cuda:0')
benign distance is  tensor(114.5686, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.44408902525901794
distance x is tensor(121.3212, device='cuda:0')
benign distance is  tensor(121.3212, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.06328694522380829
distance x is tensor(129.8700, device='cuda:0')
benign distance is  tensor(129.8700, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.31123143434524536
distance x is tensor(114.9125, device='cuda:0')
benign distance is  tensor(114.9125, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3656122088432312
distance x is tensor(87.7549, device='cuda:0')
benign distance is  tensor(87.7549, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4075005054473877
distance x is tensor(114.6516, device='cuda:0')
benign distance is  tensor(114.6516, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.343905508518219
distance x is tensor(97.2740, device='cuda:0')
benign distance is  tensor(97.2740, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3312602937221527
distance x is tensor(136.4761, device='cuda:0')
benign distance is  tensor(136.4761, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.21649852395057678
distance x is tensor(148.2211, device='cuda:0')
benign distance is  tensor(148.2211, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5098106861114502
distance x is tensor(132.8384, device='cuda:0')
benign distance is  tensor(132.8384, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.42150282859802246
distance x is tensor(126.8554, device='cuda:0')
benign distance is  tensor(126.8554, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.489967405796051
distance x is tensor(132.6591, device='cuda:0')
benign distance is  tensor(132.6591, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3812100291252136
distance x is tensor(115.6482, device='cuda:0')
benign distance is  tensor(115.6482, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7507302165031433
distance x is tensor(127.4417, device='cuda:0')
benign distance is  tensor(127.4417, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5127072334289551
distance x is tensor(147.6325, device='cuda:0')
benign distance is  tensor(147.6325, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3649760484695435
distance x is tensor(140.7626, device='cuda:0')
benign distance is  tensor(140.7626, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3312249183654785
distance x is tensor(124.0766, device='cuda:0')
benign distance is  tensor(124.0766, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.244275450706482
distance x is tensor(142.3238, device='cuda:0')
benign distance is  tensor(142.3238, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.031611740589141846
distance x is tensor(135.4204, device='cuda:0')
benign distance is  tensor(135.4204, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.061228178441524506
distance x is tensor(129.6047, device='cuda:0')
benign distance is  tensor(129.6047, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4838465750217438
distance x is tensor(122.9237, device='cuda:0')
benign distance is  tensor(122.9237, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.110539197921753
distance x is tensor(127.8255, device='cuda:0')
benign distance is  tensor(127.8255, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2518440783023834
distance x is tensor(129.1717, device='cuda:0')
benign distance is  tensor(129.1717, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.43895912170410156
distance x is tensor(136.9097, device='cuda:0')
benign distance is  tensor(136.9097, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.40763258934020996
distance x is tensor(120.9501, device='cuda:0')
benign distance is  tensor(120.9501, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6914603114128113
distance x is tensor(117.5347, device='cuda:0')
benign distance is  tensor(117.5347, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.10280165821313858
distance x is tensor(150.4236, device='cuda:0')
benign distance is  tensor(150.4236, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.048202671110630035
distance x is tensor(128.4864, device='cuda:0')
benign distance is  tensor(128.4864, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8274809718132019
distance x is tensor(115.5006, device='cuda:0')
benign distance is  tensor(115.5006, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.2865827977657318
distance x is tensor(131.2837, device='cuda:0')
benign distance is  tensor(131.2837, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.22309978306293488
distance x is tensor(143.4460, device='cuda:0')
benign distance is  tensor(143.4460, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.08463700860738754
distance x is tensor(126.2643, device='cuda:0')
benign distance is  tensor(126.2643, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.1616819202899933
distance x is tensor(131.0879, device='cuda:0')
benign distance is  tensor(131.0879, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.21628454327583313
distance x is tensor(131.7046, device='cuda:0')
benign distance is  tensor(131.7046, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.041499171406030655
distance x is tensor(122.2686, device='cuda:0')
benign distance is  tensor(122.2686, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.10099060833454132
distance x is tensor(124.4157, device='cuda:0')
benign distance is  tensor(124.4157, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.2931481897830963
distance x is tensor(122.2268, device='cuda:0')
benign distance is  tensor(122.2268, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.0476783514022827
distance x is tensor(131.9768, device='cuda:0')
benign distance is  tensor(131.9768, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7343406081199646
distance x is tensor(133.7018, device='cuda:0')
benign distance is  tensor(133.7018, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.45814481377601624
distance x is tensor(134.1719, device='cuda:0')
benign distance is  tensor(134.1719, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 0.33573830127716064
mal_entropy is 0.07987695187330246
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 19., 12., 12., 19., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.6336e-05, 2.6336e-05, 2.6336e-05, 2.8881e-02, 2.6336e-05, 2.6336e-05,
        2.8881e-02, 2.6336e-05, 7.8507e-02, 7.8507e-02, 7.8507e-02, 7.8507e-02,
        7.8507e-02, 7.8507e-02, 7.8507e-02, 7.8507e-02, 7.8507e-02, 7.8507e-02,
        7.8507e-02, 7.8507e-02])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 88.88% 

Test Accuracy: 87.84% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5968419909477234
distance x is tensor(159.4182, device='cuda:0')
benign distance is  tensor(159.4182, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5512529611587524
distance x is tensor(139.9782, device='cuda:0')
benign distance is  tensor(139.9782, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.20227256417274475
distance x is tensor(155.8030, device='cuda:0')
benign distance is  tensor(155.8030, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7047117948532104
distance x is tensor(139.6644, device='cuda:0')
benign distance is  tensor(139.6644, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4536869525909424
distance x is tensor(107.4320, device='cuda:0')
benign distance is  tensor(107.4320, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6601144075393677
distance x is tensor(139.1178, device='cuda:0')
benign distance is  tensor(139.1178, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2460731565952301
distance x is tensor(103.3344, device='cuda:0')
benign distance is  tensor(103.3344, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1081007570028305
distance x is tensor(143.9628, device='cuda:0')
benign distance is  tensor(143.9628, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_acc is 0.9000000005000001
mal_loss is 1.1969658136367798
mal_entropy is 0.08786080032587051
user_PLR len size 36
counter_tensor is  tensor([30., 27., 26., 31., 32., 32., 20., 33., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 34., 24., 32., 22., 35., 32., 25., 27.,
        31., 26., 33., 33., 22., 34., 29., 29.])
count_res tensor([2.8187e-03, 1.4034e-04, 5.1627e-05, 7.6621e-03, 2.0828e-02, 2.0828e-02,
        1.2797e-07, 5.6616e-02, 6.9869e-06, 6.9869e-06, 6.9869e-06, 6.9869e-06,
        6.9869e-06, 6.9869e-06, 6.9869e-06, 6.9869e-06, 6.9869e-06, 6.9869e-06,
        6.9869e-06, 6.9869e-06, 1.5390e-01, 6.9869e-06, 2.0828e-02, 9.4558e-07,
        4.1834e-01, 2.0828e-02, 1.8992e-05, 1.4034e-04, 7.6621e-03, 5.1627e-05,
        5.6616e-02, 5.6616e-02, 9.4558e-07, 1.5390e-01, 1.0370e-03, 1.0370e-03])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 89.90% 

Test Accuracy: 88.87% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 89.90%
|----0th round Training Accuracy : 88.32%
|----1th round Training Accuracy : 88.81%
|----2th round Training Accuracy : 89.02%
|----3th round Training Accuracy : 89.12%
|----4th round Training Accuracy : 88.73%
|----5th round Training Accuracy : 89.12%
|----6th round Training Accuracy : 86.78%
|----7th round Training Accuracy : 89.58%
|----8th round Training Accuracy : 89.19%
|----9th round Training Accuracy : 88.34%
|----10th round Training Accuracy : 85.37%
|----11th round Training Accuracy : 89.36%
|----12th round Training Accuracy : 88.08%
|----13th round Training Accuracy : 89.34%
|----14th round Training Accuracy : 89.03%
|----15th round Training Accuracy : 89.64%
|----16th round Training Accuracy : 88.33%
|----17th round Training Accuracy : 89.58%
|----18th round Training Accuracy : 88.24%
|----19th round Training Accuracy : 89.70%
|----20th round Training Accuracy : 89.02%
|----21th round Training Accuracy : 89.30%
|----22th round Training Accuracy : 87.23%
|----23th round Training Accuracy : 89.79%
|----24th round Training Accuracy : 88.98%
|----25th round Training Accuracy : 88.98%
|----26th round Training Accuracy : 89.75%
|----27th round Training Accuracy : 89.43%
|----28th round Training Accuracy : 87.10%
|----29th round Training Accuracy : 89.96%
|----30th round Training Accuracy : 88.83%
|----31th round Training Accuracy : 89.78%
|----32th round Training Accuracy : 89.54%
|----33th round Training Accuracy : 89.72%
|----34th round Training Accuracy : 89.68%
|----35th round Training Accuracy : 89.93%
|----36th round Training Accuracy : 88.92%
|----37th round Training Accuracy : 89.78%
|----38th round Training Accuracy : 89.67%
|----39th round Training Accuracy : 90.02%
|----40th round Training Accuracy : 88.81%
|----41th round Training Accuracy : 89.73%
|----42th round Training Accuracy : 88.63%
|----43th round Training Accuracy : 90.06%
|----44th round Training Accuracy : 90.05%
|----45th round Training Accuracy : 89.89%
|----46th round Training Accuracy : 88.47%
|----47th round Training Accuracy : 89.85%
|----48th round Training Accuracy : 88.88%
|----49th round Training Accuracy : 89.90%
|----Final Test Accuracy: 88.87%
|----0th round Final Test Accuracy : 87.37%
|----1th round Final Test Accuracy : 87.34%
|----2th round Final Test Accuracy : 88.67%
|----3th round Final Test Accuracy : 88.42%
|----4th round Final Test Accuracy : 87.96%
|----5th round Final Test Accuracy : 88.45%
|----6th round Final Test Accuracy : 85.91%
|----7th round Final Test Accuracy : 88.62%
|----8th round Final Test Accuracy : 88.55%
|----9th round Final Test Accuracy : 87.72%
|----10th round Final Test Accuracy : 84.53%
|----11th round Final Test Accuracy : 88.58%
|----12th round Final Test Accuracy : 87.50%
|----13th round Final Test Accuracy : 88.44%
|----14th round Final Test Accuracy : 88.00%
|----15th round Final Test Accuracy : 88.72%
|----16th round Final Test Accuracy : 87.36%
|----17th round Final Test Accuracy : 88.54%
|----18th round Final Test Accuracy : 87.03%
|----19th round Final Test Accuracy : 88.82%
|----20th round Final Test Accuracy : 87.84%
|----21th round Final Test Accuracy : 88.29%
|----22th round Final Test Accuracy : 86.48%
|----23th round Final Test Accuracy : 88.87%
|----24th round Final Test Accuracy : 88.34%
|----25th round Final Test Accuracy : 88.40%
|----26th round Final Test Accuracy : 88.90%
|----27th round Final Test Accuracy : 88.27%
|----28th round Final Test Accuracy : 86.05%
|----29th round Final Test Accuracy : 89.11%
|----30th round Final Test Accuracy : 87.96%
|----31th round Final Test Accuracy : 88.81%
|----32th round Final Test Accuracy : 88.20%
|----33th round Final Test Accuracy : 88.93%
|----34th round Final Test Accuracy : 88.81%
|----35th round Final Test Accuracy : 88.82%
|----36th round Final Test Accuracy : 87.76%
|----37th round Final Test Accuracy : 88.40%
|----38th round Final Test Accuracy : 89.09%
|----39th round Final Test Accuracy : 89.06%
|----40th round Final Test Accuracy : 87.58%
|----41th round Final Test Accuracy : 89.20%
|----42th round Final Test Accuracy : 87.90%
|----43th round Final Test Accuracy : 89.05%
|----44th round Final Test Accuracy : 89.15%
|----45th round Final Test Accuracy : 88.70%
|----46th round Final Test Accuracy : 87.31%
|----47th round Final Test Accuracy : 88.98%
|----48th round Final Test Accuracy : 87.84%
|----49th round Final Test Accuracy : 88.87%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 3421.2800
