
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     None of attack is done!

attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8107999563217163
distance x is tensor(117.0497, device='cuda:0')
benign distance is  tensor(117.0497, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8051605224609375
distance x is tensor(114.4539, device='cuda:0')
benign distance is  tensor(114.4539, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3571770191192627
distance x is tensor(123.7518, device='cuda:0')
benign distance is  tensor(123.7518, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8437261581420898
distance x is tensor(114.3169, device='cuda:0')
benign distance is  tensor(114.3169, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3001989424228668
distance x is tensor(106.2085, device='cuda:0')
benign distance is  tensor(106.2085, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.42169371247291565
distance x is tensor(120.7251, device='cuda:0')
benign distance is  tensor(120.7251, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.435831218957901
distance x is tensor(105.4776, device='cuda:0')
benign distance is  tensor(105.4776, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2696654200553894
distance x is tensor(120.8277, device='cuda:0')
benign distance is  tensor(120.8277, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.28805917501449585
distance x is tensor(140.2170, device='cuda:0')
benign distance is  tensor(140.2170, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.46367770433425903
distance x is tensor(139.2515, device='cuda:0')
benign distance is  tensor(139.2515, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.2838089168071747
distance x is tensor(122.2663, device='cuda:0')
benign distance is  tensor(122.2663, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.11702845245599747
distance x is tensor(127.7702, device='cuda:0')
benign distance is  tensor(127.7702, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4558316767215729
distance x is tensor(120.7691, device='cuda:0')
benign distance is  tensor(120.7691, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2441597282886505
distance x is tensor(140.0448, device='cuda:0')
benign distance is  tensor(140.0448, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6987314820289612
distance x is tensor(138.8130, device='cuda:0')
benign distance is  tensor(138.8130, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.2472100704908371
distance x is tensor(136.1508, device='cuda:0')
benign distance is  tensor(136.1508, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3086868226528168
distance x is tensor(126.1919, device='cuda:0')
benign distance is  tensor(126.1919, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.0215835571289062
distance x is tensor(140.0691, device='cuda:0')
benign distance is  tensor(140.0691, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5394998788833618
distance x is tensor(123.1332, device='cuda:0')
benign distance is  tensor(123.1332, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7705472707748413
distance x is tensor(127.2952, device='cuda:0')
benign distance is  tensor(127.2952, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.1065794974565506
distance x is tensor(127.1456, device='cuda:0')
benign distance is  tensor(127.1456, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.22881731390953064
distance x is tensor(122.4529, device='cuda:0')
benign distance is  tensor(122.4529, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2185676395893097
distance x is tensor(138.2446, device='cuda:0')
benign distance is  tensor(138.2446, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.9373054504394531
distance x is tensor(129.5611, device='cuda:0')
benign distance is  tensor(129.5611, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.4005895256996155
distance x is tensor(154.3364, device='cuda:0')
benign distance is  tensor(154.3364, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.49840983748435974
distance x is tensor(123.4356, device='cuda:0')
benign distance is  tensor(123.4356, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.34746065735816956
distance x is tensor(144.4287, device='cuda:0')
benign distance is  tensor(144.4287, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4557635188102722
distance x is tensor(137.4857, device='cuda:0')
benign distance is  tensor(137.4857, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.0498374700546265
distance x is tensor(126.3288, device='cuda:0')
benign distance is  tensor(126.3288, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8274843096733093
distance x is tensor(134.4518, device='cuda:0')
benign distance is  tensor(134.4518, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.25414544343948364
distance x is tensor(124.2989, device='cuda:0')
benign distance is  tensor(124.2989, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7845290899276733
distance x is tensor(130.8899, device='cuda:0')
benign distance is  tensor(130.8899, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.4292657971382141
distance x is tensor(134.5565, device='cuda:0')
benign distance is  tensor(134.5565, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.26031234860420227
distance x is tensor(127.7022, device='cuda:0')
benign distance is  tensor(127.7022, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.2619622051715851
distance x is tensor(139.6786, device='cuda:0')
benign distance is  tensor(139.6786, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.07271061092615128
distance x is tensor(123.1112, device='cuda:0')
benign distance is  tensor(123.1112, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4367603659629822
distance x is tensor(130.9647, device='cuda:0')
benign distance is  tensor(130.9647, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.48691004514694214
distance x is tensor(121.3002, device='cuda:0')
benign distance is  tensor(121.3002, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.4728028178215027
distance x is tensor(125.3313, device='cuda:0')
benign distance is  tensor(125.3313, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.18573424220085144
distance x is tensor(125.4976, device='cuda:0')
benign distance is  tensor(125.4976, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.09984256327152252
distance x is tensor(122.8732, device='cuda:0')
benign distance is  tensor(122.8732, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.20871631801128387
distance x is tensor(124.2577, device='cuda:0')
benign distance is  tensor(124.2577, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.18788138031959534
distance x is tensor(128.1047, device='cuda:0')
benign distance is  tensor(128.1047, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.4191078245639801
distance x is tensor(138.7315, device='cuda:0')
benign distance is  tensor(138.7315, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5395141839981079
distance x is tensor(136.4764, device='cuda:0')
benign distance is  tensor(136.4764, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.3469545245170593
distance x is tensor(130.5852, device='cuda:0')
benign distance is  tensor(130.5852, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6313832402229309
distance x is tensor(134.5545, device='cuda:0')
benign distance is  tensor(134.5545, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.20058956742286682
distance x is tensor(139.1900, device='cuda:0')
benign distance is  tensor(139.1900, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([18., 18., 14., 14., 19., 14., 19., 14., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([0.0249, 0.0249, 0.0005, 0.0005, 0.0677, 0.0005, 0.0677, 0.0005, 0.0677,
        0.0677, 0.0677, 0.0677, 0.0677, 0.0677, 0.0677, 0.0677, 0.0677, 0.0677,
        0.0677, 0.0677])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 10.48% 

Test Accuracy: 10.03% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.2873826026916504
distance x is tensor(1902.8092, device='cuda:0')
benign distance is  tensor(1902.8092, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.295635461807251
distance x is tensor(2217.9866, device='cuda:0')
benign distance is  tensor(2217.9866, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.308084726333618
distance x is tensor(3602.3767, device='cuda:0')
benign distance is  tensor(3602.3767, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.299715280532837
distance x is tensor(3103.5679, device='cuda:0')
benign distance is  tensor(3103.5679, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.304379463195801
distance x is tensor(3333.5063, device='cuda:0')
benign distance is  tensor(3333.5063, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.308384418487549
distance x is tensor(3894.8708, device='cuda:0')
benign distance is  tensor(3894.8708, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3004136085510254
distance x is tensor(2780.9053, device='cuda:0')
benign distance is  tensor(2780.9053, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2967638969421387
distance x is tensor(4461.3472, device='cuda:0')
benign distance is  tensor(4461.3472, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([20., 20., 20., 20., 20., 20., 20., 20., 27., 27., 27., 27., 27., 27.,
        27., 27., 27., 27., 27., 27., 14., 21., 25., 26., 23., 26., 24., 27.])
count_res tensor([6.5373e-05, 6.5373e-05, 6.5373e-05, 6.5373e-05, 6.5373e-05, 6.5373e-05,
        6.5373e-05, 6.5373e-05, 7.1690e-02, 7.1690e-02, 7.1690e-02, 7.1690e-02,
        7.1690e-02, 7.1690e-02, 7.1690e-02, 7.1690e-02, 7.1690e-02, 7.1690e-02,
        7.1690e-02, 7.1690e-02, 1.6204e-07, 1.7770e-04, 9.7022e-03, 2.6373e-02,
        1.3130e-03, 2.6373e-02, 3.5692e-03, 7.1690e-02])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 10.43% 

Test Accuracy: 10.00% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.296342134475708
distance x is tensor(32611458., device='cuda:0')
benign distance is  tensor(32611458., device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.3027987480163574
distance x is tensor(48226808., device='cuda:0')
benign distance is  tensor(48226808., device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3045623302459717
distance x is tensor(24295858., device='cuda:0')
benign distance is  tensor(24295858., device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2989614009857178
distance x is tensor(36981428., device='cuda:0')
benign distance is  tensor(36981428., device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.311768054962158
distance x is tensor(45194552., device='cuda:0')
benign distance is  tensor(45194552., device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.310288906097412
distance x is tensor(35082004., device='cuda:0')
benign distance is  tensor(35082004., device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2941880226135254
distance x is tensor(40556108., device='cuda:0')
benign distance is  tensor(40556108., device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.303368091583252
distance x is tensor(44812720., device='cuda:0')
benign distance is  tensor(44812720., device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.3325490951538086
distance x is tensor(39343360., device='cuda:0')
benign distance is  tensor(39343360., device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.3162810802459717
distance x is tensor(43634736., device='cuda:0')
benign distance is  tensor(43634736., device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.2942070960998535
distance x is tensor(35658892., device='cuda:0')
benign distance is  tensor(35658892., device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.302645206451416
distance x is tensor(33733264., device='cuda:0')
benign distance is  tensor(33733264., device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.314167022705078
distance x is tensor(37164704., device='cuda:0')
benign distance is  tensor(37164704., device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.2961320877075195
distance x is tensor(39245588., device='cuda:0')
benign distance is  tensor(39245588., device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.293978452682495
distance x is tensor(40381404., device='cuda:0')
benign distance is  tensor(40381404., device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.2763454914093018
distance x is tensor(43851976., device='cuda:0')
benign distance is  tensor(43851976., device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([20., 20., 20., 20., 20., 20., 20., 20., 15., 15., 15., 15., 15., 15.,
        15., 15., 15., 15., 15., 15., 15., 25., 23., 13., 27., 27., 27., 27.])
count_res tensor([2.1915e-04, 2.1915e-04, 2.1915e-04, 2.1915e-04, 2.1915e-04, 2.1915e-04,
        2.1915e-04, 2.1915e-04, 1.4766e-06, 1.4766e-06, 1.4766e-06, 1.4766e-06,
        1.4766e-06, 1.4766e-06, 1.4766e-06, 1.4766e-06, 1.4766e-06, 1.4766e-06,
        1.4766e-06, 1.4766e-06, 1.4766e-06, 3.2524e-02, 4.4017e-03, 1.9984e-07,
        2.4033e-01, 2.4033e-01, 2.4033e-01, 2.4033e-01])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 9.99% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.275379180908203
distance x is tensor(5.0876, device='cuda:0')
benign distance is  tensor(5.0876, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.311650514602661
distance x is tensor(3.1684, device='cuda:0')
benign distance is  tensor(3.1684, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.319403648376465
distance x is tensor(5.0840, device='cuda:0')
benign distance is  tensor(5.0840, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.300724744796753
distance x is tensor(6.0929, device='cuda:0')
benign distance is  tensor(6.0929, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.36435866355896
distance x is tensor(8.4335, device='cuda:0')
benign distance is  tensor(8.4335, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3005385398864746
distance x is tensor(7.0815, device='cuda:0')
benign distance is  tensor(7.0815, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.364581823348999
distance x is tensor(8.0102, device='cuda:0')
benign distance is  tensor(8.0102, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2641072273254395
distance x is tensor(11.3479, device='cuda:0')
benign distance is  tensor(11.3479, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.3235116004943848
distance x is tensor(7.6764, device='cuda:0')
benign distance is  tensor(7.6764, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.33603572845459
distance x is tensor(2.8503, device='cuda:0')
benign distance is  tensor(2.8503, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.27402925491333
distance x is tensor(9.3759, device='cuda:0')
benign distance is  tensor(9.3759, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.320370674133301
distance x is tensor(7.3684, device='cuda:0')
benign distance is  tensor(7.3684, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.334378719329834
distance x is tensor(5.9088, device='cuda:0')
benign distance is  tensor(5.9088, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  2.279317855834961
distance x is tensor(4.3677, device='cuda:0')
benign distance is  tensor(4.3677, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.3011157512664795
distance x is tensor(7.6843, device='cuda:0')
benign distance is  tensor(7.6843, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.3070342540740967
distance x is tensor(6.4283, device='cuda:0')
benign distance is  tensor(6.4283, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 36
counter_tensor is  tensor([20., 20., 20., 20., 20., 20., 20., 20., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20., 18., 17., 18., 29., 35., 17., 13., 32.,
        20., 20., 20., 20., 20., 20., 20., 20.])
count_res tensor([2.9071e-07, 2.9071e-07, 2.9071e-07, 2.9071e-07, 2.9071e-07, 2.9071e-07,
        2.9071e-07, 2.9071e-07, 2.9071e-07, 2.9071e-07, 2.9071e-07, 2.9071e-07,
        2.9071e-07, 2.9071e-07, 2.9071e-07, 2.9071e-07, 2.9071e-07, 2.9071e-07,
        2.9071e-07, 2.9071e-07, 3.9343e-08, 1.4473e-08, 3.9343e-08, 2.3556e-03,
        9.5032e-01, 1.4473e-08, 2.6509e-10, 4.7314e-02, 2.9071e-07, 2.9071e-07,
        2.9071e-07, 2.9071e-07, 2.9071e-07, 2.9071e-07, 2.9071e-07, 2.9071e-07])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 70.18% 

Test Accuracy: 69.94% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5895968079566956
distance x is tensor(171.1750, device='cuda:0')
benign distance is  tensor(171.1750, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5242518186569214
distance x is tensor(172.9910, device='cuda:0')
benign distance is  tensor(172.9910, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1919180154800415
distance x is tensor(170.2179, device='cuda:0')
benign distance is  tensor(170.2179, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7224447131156921
distance x is tensor(162.1192, device='cuda:0')
benign distance is  tensor(162.1192, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3772338926792145
distance x is tensor(176.8080, device='cuda:0')
benign distance is  tensor(176.8080, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6511719822883606
distance x is tensor(178.0354, device='cuda:0')
benign distance is  tensor(178.0354, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.346025288105011
distance x is tensor(182.0693, device='cuda:0')
benign distance is  tensor(182.0693, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5699225068092346
distance x is tensor(172.3883, device='cuda:0')
benign distance is  tensor(172.3883, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7130653262138367
distance x is tensor(191.8965, device='cuda:0')
benign distance is  tensor(191.8965, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.34450146555900574
distance x is tensor(165.2502, device='cuda:0')
benign distance is  tensor(165.2502, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5264087915420532
distance x is tensor(165.6535, device='cuda:0')
benign distance is  tensor(165.6535, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.674188494682312
distance x is tensor(175.6175, device='cuda:0')
benign distance is  tensor(175.6175, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1118712425231934
distance x is tensor(182.1124, device='cuda:0')
benign distance is  tensor(182.1124, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.37960687279701233
distance x is tensor(166.6194, device='cuda:0')
benign distance is  tensor(166.6194, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8219441175460815
distance x is tensor(169.9983, device='cuda:0')
benign distance is  tensor(169.9983, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.22065460681915283
distance x is tensor(186.5605, device='cuda:0')
benign distance is  tensor(186.5605, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.4788571298122406
distance x is tensor(173.6775, device='cuda:0')
benign distance is  tensor(173.6775, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.2852246165275574
distance x is tensor(158.2863, device='cuda:0')
benign distance is  tensor(158.2863, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.23540611565113068
distance x is tensor(190.9053, device='cuda:0')
benign distance is  tensor(190.9053, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5157140493392944
distance x is tensor(187.7231, device='cuda:0')
benign distance is  tensor(187.7231, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6551119089126587
distance x is tensor(161.9261, device='cuda:0')
benign distance is  tensor(161.9261, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.3544217050075531
distance x is tensor(171.3201, device='cuda:0')
benign distance is  tensor(171.3201, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.46284371614456177
distance x is tensor(174.6663, device='cuda:0')
benign distance is  tensor(174.6663, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.19495442509651184
distance x is tensor(162.7884, device='cuda:0')
benign distance is  tensor(162.7884, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([25., 26., 24., 20., 27., 22., 18., 20., 27., 27., 27., 27., 27., 27.,
        27., 27., 27., 27., 27., 27., 27., 23., 25., 21., 18., 19., 23., 24.])
count_res tensor([9.1527e-03, 2.4880e-02, 3.3671e-03, 6.1670e-05, 6.7630e-02, 4.5569e-04,
        8.3462e-06, 6.1670e-05, 6.7630e-02, 6.7630e-02, 6.7630e-02, 6.7630e-02,
        6.7630e-02, 6.7630e-02, 6.7630e-02, 6.7630e-02, 6.7630e-02, 6.7630e-02,
        6.7630e-02, 6.7630e-02, 6.7630e-02, 1.2387e-03, 9.1527e-03, 1.6764e-04,
        8.3462e-06, 2.2687e-05, 1.2387e-03, 3.3671e-03])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 10.43% 

Test Accuracy: 10.00% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.2937235832214355
distance x is tensor(5256.9097, device='cuda:0')
benign distance is  tensor(5256.9097, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.3004508018493652
distance x is tensor(7255.4375, device='cuda:0')
benign distance is  tensor(7255.4375, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3176565170288086
distance x is tensor(6587.5591, device='cuda:0')
benign distance is  tensor(6587.5591, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.294668674468994
distance x is tensor(7633.9653, device='cuda:0')
benign distance is  tensor(7633.9653, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3007307052612305
distance x is tensor(6733.4248, device='cuda:0')
benign distance is  tensor(6733.4248, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.30902361869812
distance x is tensor(5615.9292, device='cuda:0')
benign distance is  tensor(5615.9292, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2972261905670166
distance x is tensor(3854.9526, device='cuda:0')
benign distance is  tensor(3854.9526, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.292239189147949
distance x is tensor(6295.7422, device='cuda:0')
benign distance is  tensor(6295.7422, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  2.299173593521118
distance x is tensor(8203.3223, device='cuda:0')
benign distance is  tensor(8203.3223, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.2885446548461914
distance x is tensor(7559.8740, device='cuda:0')
benign distance is  tensor(7559.8740, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  2.347109794616699
distance x is tensor(5786.0220, device='cuda:0')
benign distance is  tensor(5786.0220, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.314122200012207
distance x is tensor(5860.2773, device='cuda:0')
benign distance is  tensor(5860.2773, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  2.2774271965026855
distance x is tensor(6856.6133, device='cuda:0')
benign distance is  tensor(6856.6133, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  2.2955143451690674
distance x is tensor(7825.5527, device='cuda:0')
benign distance is  tensor(7825.5527, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.310460329055786
distance x is tensor(4948.8755, device='cuda:0')
benign distance is  tensor(4948.8755, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  2.297644853591919
distance x is tensor(5840.3872, device='cuda:0')
benign distance is  tensor(5840.3872, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 44
counter_tensor is  tensor([28., 28., 28., 28., 28., 28., 28., 28., 27., 27., 27., 27., 27., 27.,
        27., 27., 27., 27., 27., 27., 34., 41., 42., 23., 24., 43., 20., 43.,
        28., 28., 28., 28., 28., 28., 28., 28., 25.,  8., 23.,  6.,  4., 30.,
        22., 19.])
count_res tensor([1.2220e-07, 1.2220e-07, 1.2220e-07, 1.2220e-07, 1.2220e-07, 1.2220e-07,
        1.2220e-07, 1.2220e-07, 4.4954e-08, 4.4954e-08, 4.4954e-08, 4.4954e-08,
        4.4954e-08, 4.4954e-08, 4.4954e-08, 4.4954e-08, 4.4954e-08, 4.4954e-08,
        4.4954e-08, 4.4954e-08, 4.9298e-05, 5.4062e-02, 1.4696e-01, 8.2336e-10,
        2.2381e-09, 3.9947e-01, 4.0993e-11, 3.9947e-01, 1.2220e-07, 1.2220e-07,
        1.2220e-07, 1.2220e-07, 1.2220e-07, 1.2220e-07, 1.2220e-07, 1.2220e-07,
        6.0838e-09, 2.5187e-16, 8.2336e-10, 3.4087e-17, 4.6131e-18, 9.0292e-07,
        3.0290e-10, 1.5080e-11])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 88.76% 

Test Accuracy: 88.24% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3263396918773651
distance x is tensor(112.4949, device='cuda:0')
benign distance is  tensor(112.4949, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4597853720188141
distance x is tensor(131.1994, device='cuda:0')
benign distance is  tensor(131.1994, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4510827958583832
distance x is tensor(121.3253, device='cuda:0')
benign distance is  tensor(121.3253, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.50966477394104
distance x is tensor(120.3501, device='cuda:0')
benign distance is  tensor(120.3501, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5444726943969727
distance x is tensor(116.4597, device='cuda:0')
benign distance is  tensor(116.4597, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4546932280063629
distance x is tensor(131.8670, device='cuda:0')
benign distance is  tensor(131.8670, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.25938355922698975
distance x is tensor(119.3969, device='cuda:0')
benign distance is  tensor(119.3969, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.43640369176864624
distance x is tensor(121.3065, device='cuda:0')
benign distance is  tensor(121.3065, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.367466539144516
distance x is tensor(138.6377, device='cuda:0')
benign distance is  tensor(138.6377, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3062071204185486
distance x is tensor(131.2105, device='cuda:0')
benign distance is  tensor(131.2105, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5489791631698608
distance x is tensor(138.8649, device='cuda:0')
benign distance is  tensor(138.8649, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.2230747640132904
distance x is tensor(132.8261, device='cuda:0')
benign distance is  tensor(132.8261, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.36582621932029724
distance x is tensor(132.0163, device='cuda:0')
benign distance is  tensor(132.0163, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.18763136863708496
distance x is tensor(135.8207, device='cuda:0')
benign distance is  tensor(135.8207, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6939753293991089
distance x is tensor(138.1615, device='cuda:0')
benign distance is  tensor(138.1615, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6183357238769531
distance x is tensor(146.8752, device='cuda:0')
benign distance is  tensor(146.8752, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.18823589384555817
distance x is tensor(134.9366, device='cuda:0')
benign distance is  tensor(134.9366, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7869653701782227
distance x is tensor(139.9220, device='cuda:0')
benign distance is  tensor(139.9220, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4686318337917328
distance x is tensor(129.9916, device='cuda:0')
benign distance is  tensor(129.9916, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2406248301267624
distance x is tensor(131.2486, device='cuda:0')
benign distance is  tensor(131.2486, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.48908430337905884
distance x is tensor(132.9993, device='cuda:0')
benign distance is  tensor(132.9993, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7907625436782837
distance x is tensor(125.2560, device='cuda:0')
benign distance is  tensor(125.2560, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2567134499549866
distance x is tensor(130.0180, device='cuda:0')
benign distance is  tensor(130.0180, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5252052545547485
distance x is tensor(135.0486, device='cuda:0')
benign distance is  tensor(135.0486, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.09112861007452011
distance x is tensor(125.9836, device='cuda:0')
benign distance is  tensor(125.9836, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.19521117210388184
distance x is tensor(134.0777, device='cuda:0')
benign distance is  tensor(134.0777, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.22742624580860138
distance x is tensor(133.5619, device='cuda:0')
benign distance is  tensor(133.5619, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.2949668765068054
distance x is tensor(147.1667, device='cuda:0')
benign distance is  tensor(147.1667, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.49720555543899536
distance x is tensor(139.8205, device='cuda:0')
benign distance is  tensor(139.8205, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7405794858932495
distance x is tensor(109.6630, device='cuda:0')
benign distance is  tensor(109.6630, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.23142385482788086
distance x is tensor(138.9196, device='cuda:0')
benign distance is  tensor(138.9196, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6658777594566345
distance x is tensor(112.1294, device='cuda:0')
benign distance is  tensor(112.1294, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([19., 19., 14., 18., 19., 19., 19., 13., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([0.0575, 0.0575, 0.0004, 0.0212, 0.0575, 0.0575, 0.0575, 0.0001, 0.0575,
        0.0575, 0.0575, 0.0575, 0.0575, 0.0575, 0.0575, 0.0575, 0.0575, 0.0575,
        0.0575, 0.0575])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 11.18% 

Test Accuracy: 10.59% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.2985129356384277
distance x is tensor(693.3958, device='cuda:0')
benign distance is  tensor(693.3958, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.2958881855010986
distance x is tensor(584.4553, device='cuda:0')
benign distance is  tensor(584.4553, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3152384757995605
distance x is tensor(645.3333, device='cuda:0')
benign distance is  tensor(645.3333, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.292714834213257
distance x is tensor(493.7898, device='cuda:0')
benign distance is  tensor(493.7898, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3066506385803223
distance x is tensor(702.9858, device='cuda:0')
benign distance is  tensor(702.9858, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3044209480285645
distance x is tensor(605.9005, device='cuda:0')
benign distance is  tensor(605.9005, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.295943260192871
distance x is tensor(492.8822, device='cuda:0')
benign distance is  tensor(492.8822, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2975504398345947
distance x is tensor(605.9973, device='cuda:0')
benign distance is  tensor(605.9973, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 36
counter_tensor is  tensor([28., 28., 28., 28., 28., 28., 28., 28., 23., 23., 23., 23., 23., 23.,
        23., 23., 23., 23., 23., 23., 34., 27., 12., 27., 20., 25., 18., 19.,
        32., 32., 25., 20., 15., 12.,  2., 27.])
count_res tensor([1.9160e-03, 1.9160e-03, 1.9160e-03, 1.9160e-03, 1.9160e-03, 1.9160e-03,
        1.9160e-03, 1.9160e-03, 1.2910e-05, 1.2910e-05, 1.2910e-05, 1.2910e-05,
        1.2910e-05, 1.2910e-05, 1.2910e-05, 1.2910e-05, 1.2910e-05, 1.2910e-05,
        1.2910e-05, 1.2910e-05, 7.7299e-01, 7.0487e-04, 2.1562e-10, 7.0487e-04,
        6.4276e-07, 9.5394e-05, 8.6988e-08, 2.3646e-07, 1.0461e-01, 1.0461e-01,
        9.5394e-05, 6.4276e-07, 4.3309e-09, 2.1562e-10, 9.7892e-15, 7.0487e-04])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 87.02% 

Test Accuracy: 86.28% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.933711051940918
distance x is tensor(144.2879, device='cuda:0')
benign distance is  tensor(144.2879, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8536745309829712
distance x is tensor(135.7523, device='cuda:0')
benign distance is  tensor(135.7523, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.19725075364112854
distance x is tensor(126.8130, device='cuda:0')
benign distance is  tensor(126.8130, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.40603065490722656
distance x is tensor(121.4420, device='cuda:0')
benign distance is  tensor(121.4420, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5266374349594116
distance x is tensor(120.8342, device='cuda:0')
benign distance is  tensor(120.8342, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6428178548812866
distance x is tensor(130.4473, device='cuda:0')
benign distance is  tensor(130.4473, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.13051557540893555
distance x is tensor(125.7882, device='cuda:0')
benign distance is  tensor(125.7882, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.31430453062057495
distance x is tensor(141.8395, device='cuda:0')
benign distance is  tensor(141.8395, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4147718846797943
distance x is tensor(145.5546, device='cuda:0')
benign distance is  tensor(145.5546, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.2835273742675781
distance x is tensor(132.0895, device='cuda:0')
benign distance is  tensor(132.0895, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4166319966316223
distance x is tensor(135.0818, device='cuda:0')
benign distance is  tensor(135.0818, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5942466855049133
distance x is tensor(136.0979, device='cuda:0')
benign distance is  tensor(136.0979, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.800566554069519
distance x is tensor(132.4151, device='cuda:0')
benign distance is  tensor(132.4151, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.0723380446434021
distance x is tensor(134.6349, device='cuda:0')
benign distance is  tensor(134.6349, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8283988237380981
distance x is tensor(137.6728, device='cuda:0')
benign distance is  tensor(137.6728, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5719434022903442
distance x is tensor(129.9035, device='cuda:0')
benign distance is  tensor(129.9035, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.5725125670433044
distance x is tensor(91.6059, device='cuda:0')
benign distance is  tensor(91.6059, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.3191583752632141
distance x is tensor(132.4817, device='cuda:0')
benign distance is  tensor(132.4817, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3876616954803467
distance x is tensor(133.2394, device='cuda:0')
benign distance is  tensor(133.2394, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.0136107206344604
distance x is tensor(146.3356, device='cuda:0')
benign distance is  tensor(146.3356, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.5087326765060425
distance x is tensor(117.3179, device='cuda:0')
benign distance is  tensor(117.3179, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.2593589723110199
distance x is tensor(146.6656, device='cuda:0')
benign distance is  tensor(146.6656, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4483738839626312
distance x is tensor(131.9000, device='cuda:0')
benign distance is  tensor(131.9000, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.21206462383270264
distance x is tensor(130.1188, device='cuda:0')
benign distance is  tensor(130.1188, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([19., 22., 16., 21., 22., 20., 21., 26., 27., 27., 27., 27., 27., 27.,
        27., 27., 27., 27., 27., 27., 26., 27., 26., 26., 27., 22., 26., 27.])
count_res tensor([1.9890e-05, 3.9950e-04, 9.9027e-07, 1.4697e-04, 3.9950e-04, 5.4067e-05,
        1.4697e-04, 2.1812e-02, 5.9291e-02, 5.9291e-02, 5.9291e-02, 5.9291e-02,
        5.9291e-02, 5.9291e-02, 5.9291e-02, 5.9291e-02, 5.9291e-02, 5.9291e-02,
        5.9291e-02, 5.9291e-02, 2.1812e-02, 5.9291e-02, 2.1812e-02, 2.1812e-02,
        5.9291e-02, 3.9950e-04, 2.1812e-02, 5.9291e-02])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 10.43% 

Test Accuracy: 10.00% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.2977705001831055
distance x is tensor(2827.8772, device='cuda:0')
benign distance is  tensor(2827.8772, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.300999879837036
distance x is tensor(2713.5842, device='cuda:0')
benign distance is  tensor(2713.5842, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.304918050765991
distance x is tensor(2782.1538, device='cuda:0')
benign distance is  tensor(2782.1538, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.28828763961792
distance x is tensor(2268.9048, device='cuda:0')
benign distance is  tensor(2268.9048, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3001632690429688
distance x is tensor(2729.2263, device='cuda:0')
benign distance is  tensor(2729.2263, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3069870471954346
distance x is tensor(2471.9487, device='cuda:0')
benign distance is  tensor(2471.9487, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.300187826156616
distance x is tensor(2071.0696, device='cuda:0')
benign distance is  tensor(2071.0696, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2958621978759766
distance x is tensor(2690.0981, device='cuda:0')
benign distance is  tensor(2690.0981, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.317647695541382
distance x is tensor(2504.3914, device='cuda:0')
benign distance is  tensor(2504.3914, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.2945685386657715
distance x is tensor(2352.5264, device='cuda:0')
benign distance is  tensor(2352.5264, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.2782883644104004
distance x is tensor(2689.2517, device='cuda:0')
benign distance is  tensor(2689.2517, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.308847427368164
distance x is tensor(2560.9255, device='cuda:0')
benign distance is  tensor(2560.9255, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.3003249168395996
distance x is tensor(3008.2405, device='cuda:0')
benign distance is  tensor(3008.2405, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  2.306312322616577
distance x is tensor(2935.7292, device='cuda:0')
benign distance is  tensor(2935.7292, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.263784885406494
distance x is tensor(2881.3730, device='cuda:0')
benign distance is  tensor(2881.3730, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.360145092010498
distance x is tensor(2498.1619, device='cuda:0')
benign distance is  tensor(2498.1619, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 36
counter_tensor is  tensor([20., 20., 20., 20., 20., 20., 20., 20., 17., 17., 17., 17., 17., 17.,
        17., 17., 17., 17., 17., 17., 20., 20., 20., 20., 20., 20., 20., 20.,
        16., 33., 32., 19., 21., 35.,  0., 16.])
count_res tensor([2.5812e-07, 2.5812e-07, 2.5812e-07, 2.5812e-07, 2.5812e-07, 2.5812e-07,
        2.5812e-07, 2.5812e-07, 1.2851e-08, 1.2851e-08, 1.2851e-08, 1.2851e-08,
        1.2851e-08, 1.2851e-08, 1.2851e-08, 1.2851e-08, 1.2851e-08, 1.2851e-08,
        1.2851e-08, 1.2851e-08, 2.5812e-07, 2.5812e-07, 2.5812e-07, 2.5812e-07,
        2.5812e-07, 2.5812e-07, 2.5812e-07, 2.5812e-07, 4.7276e-09, 1.1419e-01,
        4.2010e-02, 9.4956e-08, 7.0164e-07, 8.4379e-01, 5.3202e-16, 4.7276e-09])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 87.47% 

Test Accuracy: 86.93% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4859088063240051
distance x is tensor(145.2346, device='cuda:0')
benign distance is  tensor(145.2346, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1693252325057983
distance x is tensor(125.2591, device='cuda:0')
benign distance is  tensor(125.2591, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2183462679386139
distance x is tensor(130.4539, device='cuda:0')
benign distance is  tensor(130.4539, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3116641938686371
distance x is tensor(131.2223, device='cuda:0')
benign distance is  tensor(131.2223, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.57421875
distance x is tensor(129.8497, device='cuda:0')
benign distance is  tensor(129.8497, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.29143670201301575
distance x is tensor(145.7973, device='cuda:0')
benign distance is  tensor(145.7973, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2129594385623932
distance x is tensor(127.0474, device='cuda:0')
benign distance is  tensor(127.0474, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.44486361742019653
distance x is tensor(130.2211, device='cuda:0')
benign distance is  tensor(130.2211, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5570732355117798
distance x is tensor(143.8303, device='cuda:0')
benign distance is  tensor(143.8303, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.2234421968460083
distance x is tensor(148.3041, device='cuda:0')
benign distance is  tensor(148.3041, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5221119523048401
distance x is tensor(143.0054, device='cuda:0')
benign distance is  tensor(143.0054, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.23482120037078857
distance x is tensor(139.1015, device='cuda:0')
benign distance is  tensor(139.1015, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8090766668319702
distance x is tensor(129.5847, device='cuda:0')
benign distance is  tensor(129.5847, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3123953938484192
distance x is tensor(92.8841, device='cuda:0')
benign distance is  tensor(92.8841, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.14173859357833862
distance x is tensor(136.2790, device='cuda:0')
benign distance is  tensor(136.2790, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8518284559249878
distance x is tensor(139.4201, device='cuda:0')
benign distance is  tensor(139.4201, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8172096014022827
distance x is tensor(145.8816, device='cuda:0')
benign distance is  tensor(145.8816, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.08661321550607681
distance x is tensor(139.2233, device='cuda:0')
benign distance is  tensor(139.2233, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.4292554259300232
distance x is tensor(152.9301, device='cuda:0')
benign distance is  tensor(152.9301, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.39334654808044434
distance x is tensor(146.6245, device='cuda:0')
benign distance is  tensor(146.6245, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.50171959400177
distance x is tensor(138.6345, device='cuda:0')
benign distance is  tensor(138.6345, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.45615729689598083
distance x is tensor(131.3447, device='cuda:0')
benign distance is  tensor(131.3447, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.2472926825284958
distance x is tensor(131.0896, device='cuda:0')
benign distance is  tensor(131.0896, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.3979589343070984
distance x is tensor(128.2128, device='cuda:0')
benign distance is  tensor(128.2128, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([15., 13., 19., 16., 18., 16., 19., 18., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([0.0012, 0.0002, 0.0673, 0.0034, 0.0248, 0.0034, 0.0673, 0.0248, 0.0673,
        0.0673, 0.0673, 0.0673, 0.0673, 0.0673, 0.0673, 0.0673, 0.0673, 0.0673,
        0.0673, 0.0673])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 10.43% 

Test Accuracy: 10.00% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.30149245262146
distance x is tensor(5134.2368, device='cuda:0')
benign distance is  tensor(5134.2368, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.306483745574951
distance x is tensor(5298.5596, device='cuda:0')
benign distance is  tensor(5298.5596, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.296377420425415
distance x is tensor(6101.3994, device='cuda:0')
benign distance is  tensor(6101.3994, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2906546592712402
distance x is tensor(6134.2222, device='cuda:0')
benign distance is  tensor(6134.2222, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.301842451095581
distance x is tensor(4533.4023, device='cuda:0')
benign distance is  tensor(4533.4023, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3092668056488037
distance x is tensor(4542.5298, device='cuda:0')
benign distance is  tensor(4542.5298, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.296745538711548
distance x is tensor(4549.7422, device='cuda:0')
benign distance is  tensor(4549.7422, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2915687561035156
distance x is tensor(5115.4951, device='cuda:0')
benign distance is  tensor(5115.4951, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 52
counter_tensor is  tensor([36., 36., 36., 36., 36., 36., 36., 36., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 47., 51., 48., 50., 17., 45., 16., 19.,
        16.,  0., 51.,  0., 28., 15., 48.,  0., 36., 36., 36., 36., 36., 36.,
        36., 36., 50., 51.,  0., 20., 30., 18., 16., 49.])
count_res tensor([7.6639e-08, 7.6639e-08, 7.6639e-08, 7.6639e-08, 7.6639e-08, 7.6639e-08,
        7.6639e-08, 7.6639e-08, 1.5796e-16, 1.5796e-16, 1.5796e-16, 1.5796e-16,
        1.5796e-16, 1.5796e-16, 1.5796e-16, 1.5796e-16, 1.5796e-16, 1.5796e-16,
        1.5796e-16, 1.5796e-16, 4.5887e-03, 2.5053e-01, 1.2473e-02, 9.2166e-02,
        4.2939e-16, 6.2101e-04, 1.5796e-16, 3.1728e-15, 1.5796e-16, 1.7777e-23,
        2.5053e-01, 1.7777e-23, 2.5710e-11, 5.8112e-17, 1.2473e-02, 1.7777e-23,
        7.6639e-08, 7.6639e-08, 7.6639e-08, 7.6639e-08, 7.6639e-08, 7.6639e-08,
        7.6639e-08, 7.6639e-08, 9.2166e-02, 2.5053e-01, 1.7777e-23, 8.6246e-15,
        1.8997e-10, 1.1672e-15, 1.5796e-16, 3.3906e-02])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 89.22% 

Test Accuracy: 88.19% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9940081834793091
distance x is tensor(122.3729, device='cuda:0')
benign distance is  tensor(122.3729, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9861170649528503
distance x is tensor(118.3347, device='cuda:0')
benign distance is  tensor(118.3347, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.24293217062950134
distance x is tensor(122.6706, device='cuda:0')
benign distance is  tensor(122.6706, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.24584269523620605
distance x is tensor(107.9459, device='cuda:0')
benign distance is  tensor(107.9459, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7837535738945007
distance x is tensor(104.3580, device='cuda:0')
benign distance is  tensor(104.3580, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.489179790019989
distance x is tensor(124.7360, device='cuda:0')
benign distance is  tensor(124.7360, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.36325621604919434
distance x is tensor(113.2360, device='cuda:0')
benign distance is  tensor(113.2360, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.40133604407310486
distance x is tensor(116.4832, device='cuda:0')
benign distance is  tensor(116.4832, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.382276713848114
distance x is tensor(116.1938, device='cuda:0')
benign distance is  tensor(116.1938, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6347469091415405
distance x is tensor(124.3066, device='cuda:0')
benign distance is  tensor(124.3066, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8290234804153442
distance x is tensor(126.6918, device='cuda:0')
benign distance is  tensor(126.6918, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6544697284698486
distance x is tensor(116.4393, device='cuda:0')
benign distance is  tensor(116.4393, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.48979896306991577
distance x is tensor(127.2399, device='cuda:0')
benign distance is  tensor(127.2399, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1580350697040558
distance x is tensor(108.3979, device='cuda:0')
benign distance is  tensor(108.3979, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3227683901786804
distance x is tensor(121.2079, device='cuda:0')
benign distance is  tensor(121.2079, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.572548508644104
distance x is tensor(121.7162, device='cuda:0')
benign distance is  tensor(121.7162, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2977568805217743
distance x is tensor(120.3113, device='cuda:0')
benign distance is  tensor(120.3113, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.647628128528595
distance x is tensor(145.8999, device='cuda:0')
benign distance is  tensor(145.8999, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3001077473163605
distance x is tensor(122.6720, device='cuda:0')
benign distance is  tensor(122.6720, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.22920174896717072
distance x is tensor(122.9770, device='cuda:0')
benign distance is  tensor(122.9770, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4077468514442444
distance x is tensor(130.2765, device='cuda:0')
benign distance is  tensor(130.2765, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.37959742546081543
distance x is tensor(114.0123, device='cuda:0')
benign distance is  tensor(114.0123, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.17315730452537537
distance x is tensor(123.1549, device='cuda:0')
benign distance is  tensor(123.1549, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.306207537651062
distance x is tensor(119.7659, device='cuda:0')
benign distance is  tensor(119.7659, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.6763614416122437
distance x is tensor(111.4735, device='cuda:0')
benign distance is  tensor(111.4735, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5797480344772339
distance x is tensor(115.1351, device='cuda:0')
benign distance is  tensor(115.1351, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.08634378015995026
distance x is tensor(117.2295, device='cuda:0')
benign distance is  tensor(117.2295, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.7715002298355103
distance x is tensor(136.1138, device='cuda:0')
benign distance is  tensor(136.1138, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.26650577783584595
distance x is tensor(109.9494, device='cuda:0')
benign distance is  tensor(109.9494, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8042014837265015
distance x is tensor(121.6370, device='cuda:0')
benign distance is  tensor(121.6370, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.1508929431438446
distance x is tensor(124.7198, device='cuda:0')
benign distance is  tensor(124.7198, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.92890864610672
distance x is tensor(121.1823, device='cuda:0')
benign distance is  tensor(121.1823, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.17528152465820312
distance x is tensor(129.6816, device='cuda:0')
benign distance is  tensor(129.6816, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.40830621123313904
distance x is tensor(104.1656, device='cuda:0')
benign distance is  tensor(104.1656, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.1273169219493866
distance x is tensor(116.5040, device='cuda:0')
benign distance is  tensor(116.5040, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.3498903810977936
distance x is tensor(113.7278, device='cuda:0')
benign distance is  tensor(113.7278, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.47335711121559143
distance x is tensor(125.0337, device='cuda:0')
benign distance is  tensor(125.0337, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.0357264280319214
distance x is tensor(117.5506, device='cuda:0')
benign distance is  tensor(117.5506, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9774185419082642
distance x is tensor(127.7229, device='cuda:0')
benign distance is  tensor(127.7229, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5033798217773438
distance x is tensor(113.4740, device='cuda:0')
benign distance is  tensor(113.4740, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([15., 18., 14., 16., 12., 19., 19., 19., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([1.1860e-03, 2.3821e-02, 4.3629e-04, 3.2238e-03, 5.9046e-05, 6.4752e-02,
        6.4752e-02, 6.4752e-02, 6.4752e-02, 6.4752e-02, 6.4752e-02, 6.4752e-02,
        6.4752e-02, 6.4752e-02, 6.4752e-02, 6.4752e-02, 6.4752e-02, 6.4752e-02,
        6.4752e-02, 6.4752e-02])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 10.43% 

Test Accuracy: 10.00% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.29732084274292
distance x is tensor(2505.8904, device='cuda:0')
benign distance is  tensor(2505.8904, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.3041560649871826
distance x is tensor(2871.4019, device='cuda:0')
benign distance is  tensor(2871.4019, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3026175498962402
distance x is tensor(3235.0300, device='cuda:0')
benign distance is  tensor(3235.0300, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.286099910736084
distance x is tensor(2610.4753, device='cuda:0')
benign distance is  tensor(2610.4753, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.304594039916992
distance x is tensor(2561.9026, device='cuda:0')
benign distance is  tensor(2561.9026, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.29789137840271
distance x is tensor(4323.1748, device='cuda:0')
benign distance is  tensor(4323.1748, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3024325370788574
distance x is tensor(2827.4221, device='cuda:0')
benign distance is  tensor(2827.4221, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2939438819885254
distance x is tensor(1677.4924, device='cuda:0')
benign distance is  tensor(1677.4924, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([20., 20., 20., 20., 20., 20., 20., 20., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 24., 10., 27., 24., 24., 25., 25.])
count_res tensor([3.7564e-04, 3.7564e-04, 3.7564e-04, 3.7564e-04, 3.7564e-04, 3.7564e-04,
        3.7564e-04, 3.7564e-04, 6.8801e-06, 6.8801e-06, 6.8801e-06, 6.8801e-06,
        6.8801e-06, 6.8801e-06, 6.8801e-06, 6.8801e-06, 6.8801e-06, 6.8801e-06,
        6.8801e-06, 6.8801e-06, 4.1194e-01, 2.0509e-02, 1.7054e-08, 4.1194e-01,
        2.0509e-02, 2.0509e-02, 5.5750e-02, 5.5750e-02])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 88.90% 

Test Accuracy: 87.89% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2484773397445679
distance x is tensor(116.8910, device='cuda:0')
benign distance is  tensor(116.8910, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8063047528266907
distance x is tensor(115.0048, device='cuda:0')
benign distance is  tensor(115.0048, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3467487692832947
distance x is tensor(121.7159, device='cuda:0')
benign distance is  tensor(121.7159, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3638521432876587
distance x is tensor(123.1408, device='cuda:0')
benign distance is  tensor(123.1408, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5634370446205139
distance x is tensor(115.0403, device='cuda:0')
benign distance is  tensor(115.0403, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7023992538452148
distance x is tensor(125.2124, device='cuda:0')
benign distance is  tensor(125.2124, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4650654196739197
distance x is tensor(123.3191, device='cuda:0')
benign distance is  tensor(123.3191, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.40723276138305664
distance x is tensor(115.9646, device='cuda:0')
benign distance is  tensor(115.9646, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.1619572937488556
distance x is tensor(120.2286, device='cuda:0')
benign distance is  tensor(120.2286, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5531703233718872
distance x is tensor(119.9103, device='cuda:0')
benign distance is  tensor(119.9103, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7393839359283447
distance x is tensor(131.3891, device='cuda:0')
benign distance is  tensor(131.3891, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.2454005479812622
distance x is tensor(113.0718, device='cuda:0')
benign distance is  tensor(113.0718, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4586283564567566
distance x is tensor(120.4318, device='cuda:0')
benign distance is  tensor(120.4318, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7621424794197083
distance x is tensor(117.9212, device='cuda:0')
benign distance is  tensor(117.9212, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.11428763717412949
distance x is tensor(122.9931, device='cuda:0')
benign distance is  tensor(122.9931, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8834449052810669
distance x is tensor(124.9636, device='cuda:0')
benign distance is  tensor(124.9636, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 36
counter_tensor is  tensor([33., 33.,  7., 25.,  4., 28., 35., 35., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 35.,  6.,  6., 31., 27., 35., 25., 35.,
        30., 31.,  1., 30., 26., 32., 32., 32.])
count_res tensor([2.4733e-02, 2.4733e-02, 1.2636e-13, 8.2971e-06, 6.2913e-15, 1.6665e-04,
        1.8276e-01, 1.8276e-01, 3.0523e-06, 3.0523e-06, 3.0523e-06, 3.0523e-06,
        3.0523e-06, 3.0523e-06, 3.0523e-06, 3.0523e-06, 3.0523e-06, 3.0523e-06,
        3.0523e-06, 3.0523e-06, 1.8276e-01, 4.6487e-14, 4.6487e-14, 3.3473e-03,
        6.1308e-05, 1.8276e-01, 8.2971e-06, 1.8276e-01, 1.2314e-03, 3.3473e-03,
        3.1323e-16, 1.2314e-03, 2.2554e-05, 9.0988e-03, 9.0988e-03, 9.0988e-03])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 89.33% 

Test Accuracy: 88.58% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.31122034788131714
distance x is tensor(113.2782, device='cuda:0')
benign distance is  tensor(113.2782, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8119978904724121
distance x is tensor(121.3854, device='cuda:0')
benign distance is  tensor(121.3854, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.0839957594871521
distance x is tensor(125.4168, device='cuda:0')
benign distance is  tensor(125.4168, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.23123565316200256
distance x is tensor(115.2507, device='cuda:0')
benign distance is  tensor(115.2507, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7310689091682434
distance x is tensor(112.7383, device='cuda:0')
benign distance is  tensor(112.7383, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5665554404258728
distance x is tensor(129.1063, device='cuda:0')
benign distance is  tensor(129.1063, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.35282960534095764
distance x is tensor(104.7700, device='cuda:0')
benign distance is  tensor(104.7700, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7639847993850708
distance x is tensor(118.7609, device='cuda:0')
benign distance is  tensor(118.7609, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.556412398815155
distance x is tensor(125.5188, device='cuda:0')
benign distance is  tensor(125.5188, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4592319428920746
distance x is tensor(134.2496, device='cuda:0')
benign distance is  tensor(134.2496, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.09806983917951584
distance x is tensor(122.7243, device='cuda:0')
benign distance is  tensor(122.7243, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4268902838230133
distance x is tensor(125.5362, device='cuda:0')
benign distance is  tensor(125.5362, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.2685595750808716
distance x is tensor(127.0782, device='cuda:0')
benign distance is  tensor(127.0782, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9173361659049988
distance x is tensor(121.8971, device='cuda:0')
benign distance is  tensor(121.8971, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2111973762512207
distance x is tensor(137.2483, device='cuda:0')
benign distance is  tensor(137.2483, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5173708200454712
distance x is tensor(128.2421, device='cuda:0')
benign distance is  tensor(128.2421, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.28634777665138245
distance x is tensor(116.5791, device='cuda:0')
benign distance is  tensor(116.5791, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.19802799820899963
distance x is tensor(120.0990, device='cuda:0')
benign distance is  tensor(120.0990, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.3269968330860138
distance x is tensor(132.8368, device='cuda:0')
benign distance is  tensor(132.8368, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.24507930874824524
distance x is tensor(126.1074, device='cuda:0')
benign distance is  tensor(126.1074, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.2524557113647461
distance x is tensor(128.8955, device='cuda:0')
benign distance is  tensor(128.8955, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.41041311621665955
distance x is tensor(114.3682, device='cuda:0')
benign distance is  tensor(114.3682, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.4484570026397705
distance x is tensor(121.2703, device='cuda:0')
benign distance is  tensor(121.2703, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.5575237274169922
distance x is tensor(125.7806, device='cuda:0')
benign distance is  tensor(125.7806, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 36
counter_tensor is  tensor([30., 35., 21., 34., 35., 35., 30., 24., 23., 23., 23., 23., 23., 23.,
        23., 23., 23., 23., 23., 23., 20.,  4., 35.,  5.,  5., 22., 19., 27.,
        19., 21.,  6., 32., 28., 24.,  2., 22.])
count_res tensor([1.5201e-03, 2.2561e-01, 1.8760e-07, 8.2996e-02, 2.2561e-01, 2.2561e-01,
        1.5201e-03, 3.7680e-06, 1.3862e-06, 1.3862e-06, 1.3862e-06, 1.3862e-06,
        1.3862e-06, 1.3862e-06, 1.3862e-06, 1.3862e-06, 1.3862e-06, 1.3862e-06,
        1.3862e-06, 1.3862e-06, 6.9013e-08, 7.7664e-15, 2.2561e-01, 2.1111e-14,
        2.1111e-14, 5.0994e-07, 2.5389e-08, 7.5682e-05, 2.5389e-08, 1.8760e-07,
        5.7387e-14, 1.1232e-02, 2.0573e-04, 3.7680e-06, 1.0511e-15, 5.0994e-07])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 89.63% 

Test Accuracy: 88.65% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4862311780452728
distance x is tensor(125.4391, device='cuda:0')
benign distance is  tensor(125.4391, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3187493681907654
distance x is tensor(110.6269, device='cuda:0')
benign distance is  tensor(110.6269, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2728641629219055
distance x is tensor(125.8809, device='cuda:0')
benign distance is  tensor(125.8809, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7829000949859619
distance x is tensor(120.1276, device='cuda:0')
benign distance is  tensor(120.1276, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5090322494506836
distance x is tensor(106.2772, device='cuda:0')
benign distance is  tensor(106.2772, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.21652813255786896
distance x is tensor(120.5068, device='cuda:0')
benign distance is  tensor(120.5068, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.175013467669487
distance x is tensor(119.4227, device='cuda:0')
benign distance is  tensor(119.4227, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4941033720970154
distance x is tensor(109.7591, device='cuda:0')
benign distance is  tensor(109.7591, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5799627900123596
distance x is tensor(132.6803, device='cuda:0')
benign distance is  tensor(132.6803, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7605568766593933
distance x is tensor(132.6047, device='cuda:0')
benign distance is  tensor(132.6047, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5655314326286316
distance x is tensor(127.4741, device='cuda:0')
benign distance is  tensor(127.4741, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7182440757751465
distance x is tensor(135.1789, device='cuda:0')
benign distance is  tensor(135.1789, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5278469324111938
distance x is tensor(129.7650, device='cuda:0')
benign distance is  tensor(129.7650, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5627093315124512
distance x is tensor(117.0533, device='cuda:0')
benign distance is  tensor(117.0533, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6497705578804016
distance x is tensor(124.2448, device='cuda:0')
benign distance is  tensor(124.2448, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4801212251186371
distance x is tensor(143.5986, device='cuda:0')
benign distance is  tensor(143.5986, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.1998458355665207
distance x is tensor(112.2134, device='cuda:0')
benign distance is  tensor(112.2134, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9171491861343384
distance x is tensor(134.1358, device='cuda:0')
benign distance is  tensor(134.1358, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.22371697425842285
distance x is tensor(126.9553, device='cuda:0')
benign distance is  tensor(126.9553, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4745754599571228
distance x is tensor(142.4797, device='cuda:0')
benign distance is  tensor(142.4797, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.2018013000488281
distance x is tensor(118.3068, device='cuda:0')
benign distance is  tensor(118.3068, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.46481356024742126
distance x is tensor(126.8241, device='cuda:0')
benign distance is  tensor(126.8241, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7760416269302368
distance x is tensor(132.8601, device='cuda:0')
benign distance is  tensor(132.8601, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6402707695960999
distance x is tensor(127.0722, device='cuda:0')
benign distance is  tensor(127.0722, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([17., 16., 14., 19., 15., 17., 15., 18., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([0.0099, 0.0036, 0.0005, 0.0728, 0.0013, 0.0099, 0.0013, 0.0268, 0.0728,
        0.0728, 0.0728, 0.0728, 0.0728, 0.0728, 0.0728, 0.0728, 0.0728, 0.0728,
        0.0728, 0.0728])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 10.43% 

Test Accuracy: 10.00% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.2965550422668457
distance x is tensor(12838.6006, device='cuda:0')
benign distance is  tensor(12838.6006, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.2819666862487793
distance x is tensor(11320.5869, device='cuda:0')
benign distance is  tensor(11320.5869, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.2996020317077637
distance x is tensor(8138.0366, device='cuda:0')
benign distance is  tensor(8138.0366, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.291355848312378
distance x is tensor(7565.7383, device='cuda:0')
benign distance is  tensor(7565.7383, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3112070560455322
distance x is tensor(10216.4658, device='cuda:0')
benign distance is  tensor(10216.4658, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3096652030944824
distance x is tensor(5430.8560, device='cuda:0')
benign distance is  tensor(5430.8560, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.298422336578369
distance x is tensor(7607.4897, device='cuda:0')
benign distance is  tensor(7607.4897, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2911150455474854
distance x is tensor(7646.7817, device='cuda:0')
benign distance is  tensor(7646.7817, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 44
counter_tensor is  tensor([36., 36., 36., 36., 36., 36., 36., 36., 22., 22., 22., 22., 22., 22.,
        22., 22., 22., 22., 22., 22., 36., 43.,  8., 43.,  9., 21., 14., 34.,
        27., 20., 26., 33., 35.,  9., 37., 39., 32., 34., 14., 43., 15., 42.,
        34., 18.])
count_res tensor([2.6839e-04, 2.6839e-04, 2.6839e-04, 2.6839e-04, 2.6839e-04, 2.6839e-04,
        2.6839e-04, 2.6839e-04, 2.2317e-10, 2.2317e-10, 2.2317e-10, 2.2317e-10,
        2.2317e-10, 2.2317e-10, 2.2317e-10, 2.2317e-10, 2.2317e-10, 2.2317e-10,
        2.2317e-10, 2.2317e-10, 2.6839e-04, 2.9432e-01, 1.8557e-16, 2.9432e-01,
        5.0444e-16, 8.2100e-11, 7.4865e-14, 3.6322e-05, 3.3121e-08, 3.0203e-11,
        1.2185e-08, 1.3362e-05, 9.8734e-05, 5.0444e-16, 7.2955e-04, 5.3907e-03,
        4.9157e-06, 3.6322e-05, 7.4865e-14, 2.9432e-01, 2.0351e-13, 1.0827e-01,
        3.6322e-05, 4.0875e-12])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 88.82% 

Test Accuracy: 87.96% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.876042366027832
distance x is tensor(123.8495, device='cuda:0')
benign distance is  tensor(123.8495, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7989960312843323
distance x is tensor(118.5771, device='cuda:0')
benign distance is  tensor(118.5771, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.08765430003404617
distance x is tensor(124.4880, device='cuda:0')
benign distance is  tensor(124.4880, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5487807393074036
distance x is tensor(116.5087, device='cuda:0')
benign distance is  tensor(116.5087, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.42048200964927673
distance x is tensor(100.9338, device='cuda:0')
benign distance is  tensor(100.9338, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8340034484863281
distance x is tensor(113.4233, device='cuda:0')
benign distance is  tensor(113.4233, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.24920813739299774
distance x is tensor(125.2967, device='cuda:0')
benign distance is  tensor(125.2967, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3304083049297333
distance x is tensor(114.0539, device='cuda:0')
benign distance is  tensor(114.0539, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.10896800458431244
distance x is tensor(126.3390, device='cuda:0')
benign distance is  tensor(126.3390, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7164124250411987
distance x is tensor(134.6018, device='cuda:0')
benign distance is  tensor(134.6018, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8655737638473511
distance x is tensor(120.8781, device='cuda:0')
benign distance is  tensor(120.8781, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.641304612159729
distance x is tensor(111.0704, device='cuda:0')
benign distance is  tensor(111.0704, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7482357025146484
distance x is tensor(126.0572, device='cuda:0')
benign distance is  tensor(126.0572, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.14398442208766937
distance x is tensor(116.5409, device='cuda:0')
benign distance is  tensor(116.5409, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5403317213058472
distance x is tensor(126.9114, device='cuda:0')
benign distance is  tensor(126.9114, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7698937654495239
distance x is tensor(125.5118, device='cuda:0')
benign distance is  tensor(125.5118, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5481550693511963
distance x is tensor(128.1283, device='cuda:0')
benign distance is  tensor(128.1283, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8374409675598145
distance x is tensor(137.6557, device='cuda:0')
benign distance is  tensor(137.6557, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.275158554315567
distance x is tensor(118.2115, device='cuda:0')
benign distance is  tensor(118.2115, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.27648210525512695
distance x is tensor(121.7946, device='cuda:0')
benign distance is  tensor(121.7946, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.22017411887645721
distance x is tensor(129.2295, device='cuda:0')
benign distance is  tensor(129.2295, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0028961896896362
distance x is tensor(121.9226, device='cuda:0')
benign distance is  tensor(121.9226, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5797378420829773
distance x is tensor(128.4287, device='cuda:0')
benign distance is  tensor(128.4287, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6054234504699707
distance x is tensor(128.2500, device='cuda:0')
benign distance is  tensor(128.2500, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.1999836415052414
distance x is tensor(133.6934, device='cuda:0')
benign distance is  tensor(133.6934, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.5201693773269653
distance x is tensor(93.5789, device='cuda:0')
benign distance is  tensor(93.5789, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.30699583888053894
distance x is tensor(138.2118, device='cuda:0')
benign distance is  tensor(138.2118, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.30503612756729126
distance x is tensor(105.7413, device='cuda:0')
benign distance is  tensor(105.7413, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7388719320297241
distance x is tensor(129.4635, device='cuda:0')
benign distance is  tensor(129.4635, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8412543535232544
distance x is tensor(127.3373, device='cuda:0')
benign distance is  tensor(127.3373, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6820343732833862
distance x is tensor(138.9533, device='cuda:0')
benign distance is  tensor(138.9533, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.31497877836227417
distance x is tensor(119.3737, device='cuda:0')
benign distance is  tensor(119.3737, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([16., 16., 18., 18., 19., 17., 18., 19., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([0.0032, 0.0032, 0.0240, 0.0240, 0.0652, 0.0088, 0.0240, 0.0652, 0.0652,
        0.0652, 0.0652, 0.0652, 0.0652, 0.0652, 0.0652, 0.0652, 0.0652, 0.0652,
        0.0652, 0.0652])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 10.43% 

Test Accuracy: 10.00% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.3008012771606445
distance x is tensor(3991.9246, device='cuda:0')
benign distance is  tensor(3991.9246, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.3031725883483887
distance x is tensor(5397.1138, device='cuda:0')
benign distance is  tensor(5397.1138, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.307664155960083
distance x is tensor(3331.7917, device='cuda:0')
benign distance is  tensor(3331.7917, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2929024696350098
distance x is tensor(3628.8271, device='cuda:0')
benign distance is  tensor(3628.8271, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.306190013885498
distance x is tensor(2746.4434, device='cuda:0')
benign distance is  tensor(2746.4434, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.294501304626465
distance x is tensor(3461.2959, device='cuda:0')
benign distance is  tensor(3461.2959, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2963151931762695
distance x is tensor(4592.3003, device='cuda:0')
benign distance is  tensor(4592.3003, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2916817665100098
distance x is tensor(3931.3113, device='cuda:0')
benign distance is  tensor(3931.3113, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 44
counter_tensor is  tensor([36., 36., 36., 36., 36., 36., 36., 36., 23., 23., 23., 23., 23., 23.,
        23., 23., 23., 23., 23., 23., 14., 29., 16., 10., 43., 27., 41., 17.,
        43., 41.,  9., 37., 14., 41., 33., 30., 16., 39., 21., 40., 30., 43.,
        32., 34.])
count_res tensor([2.6173e-04, 2.6173e-04, 2.6173e-04, 2.6173e-04, 2.6173e-04, 2.6173e-04,
        2.6173e-04, 2.6173e-04, 5.9159e-10, 5.9159e-10, 5.9159e-10, 5.9159e-10,
        5.9159e-10, 5.9159e-10, 5.9159e-10, 5.9159e-10, 5.9159e-10, 5.9159e-10,
        5.9159e-10, 5.9159e-10, 7.3008e-14, 2.3867e-07, 5.3946e-13, 1.3372e-15,
        2.8702e-01, 3.2300e-08, 3.8844e-02, 1.4664e-12, 2.8702e-01, 3.8844e-02,
        4.9193e-16, 7.1145e-04, 7.3008e-14, 3.8844e-02, 1.3031e-05, 6.4876e-07,
        5.3946e-13, 5.2570e-03, 8.0063e-11, 1.4290e-02, 6.4876e-07, 2.8702e-01,
        4.7937e-06, 3.5421e-05])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 89.36% 

Test Accuracy: 88.47% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4092628061771393
distance x is tensor(112.5493, device='cuda:0')
benign distance is  tensor(112.5493, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3792860805988312
distance x is tensor(116.7012, device='cuda:0')
benign distance is  tensor(116.7012, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.05177103728055954
distance x is tensor(129.9136, device='cuda:0')
benign distance is  tensor(129.9136, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.887142539024353
distance x is tensor(115.7766, device='cuda:0')
benign distance is  tensor(115.7766, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9320384860038757
distance x is tensor(114.9345, device='cuda:0')
benign distance is  tensor(114.9345, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8766939043998718
distance x is tensor(123.4620, device='cuda:0')
benign distance is  tensor(123.4620, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.12492682039737701
distance x is tensor(120.3994, device='cuda:0')
benign distance is  tensor(120.3994, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9473428726196289
distance x is tensor(121.2792, device='cuda:0')
benign distance is  tensor(121.2792, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.15208446979522705
distance x is tensor(138.9822, device='cuda:0')
benign distance is  tensor(138.9822, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.587584376335144
distance x is tensor(125.5735, device='cuda:0')
benign distance is  tensor(125.5735, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3243253231048584
distance x is tensor(123.9833, device='cuda:0')
benign distance is  tensor(123.9833, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4428674578666687
distance x is tensor(128.5807, device='cuda:0')
benign distance is  tensor(128.5807, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9876689910888672
distance x is tensor(111.2971, device='cuda:0')
benign distance is  tensor(111.2971, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.286295086145401
distance x is tensor(99.7684, device='cuda:0')
benign distance is  tensor(99.7684, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.35256654024124146
distance x is tensor(130.6111, device='cuda:0')
benign distance is  tensor(130.6111, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6122581362724304
distance x is tensor(133.8627, device='cuda:0')
benign distance is  tensor(133.8627, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.5603551864624023
distance x is tensor(97.7207, device='cuda:0')
benign distance is  tensor(97.7207, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7478147149085999
distance x is tensor(122.8153, device='cuda:0')
benign distance is  tensor(122.8153, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5153055191040039
distance x is tensor(127.9972, device='cuda:0')
benign distance is  tensor(127.9972, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.18695659935474396
distance x is tensor(133.1969, device='cuda:0')
benign distance is  tensor(133.1969, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7929790616035461
distance x is tensor(120.1467, device='cuda:0')
benign distance is  tensor(120.1467, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.21113264560699463
distance x is tensor(135.0145, device='cuda:0')
benign distance is  tensor(135.0145, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.27901381254196167
distance x is tensor(141.2374, device='cuda:0')
benign distance is  tensor(141.2374, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.171756774187088
distance x is tensor(130.0489, device='cuda:0')
benign distance is  tensor(130.0489, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.36238017678260803
distance x is tensor(129.8594, device='cuda:0')
benign distance is  tensor(129.8594, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.18676802515983582
distance x is tensor(128.8345, device='cuda:0')
benign distance is  tensor(128.8345, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.07607416063547134
distance x is tensor(132.7287, device='cuda:0')
benign distance is  tensor(132.7287, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.15564420819282532
distance x is tensor(122.9216, device='cuda:0')
benign distance is  tensor(122.9216, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.2538263499736786
distance x is tensor(114.7276, device='cuda:0')
benign distance is  tensor(114.7276, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.5632658004760742
distance x is tensor(113.0106, device='cuda:0')
benign distance is  tensor(113.0106, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.47601041197776794
distance x is tensor(119.4125, device='cuda:0')
benign distance is  tensor(119.4125, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.3185462951660156
distance x is tensor(120.5461, device='cuda:0')
benign distance is  tensor(120.5461, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([27., 27., 27., 26.,  7., 26., 26., 16., 15., 15., 15., 15., 15., 15.,
        15., 15., 15., 15., 15., 15., 27., 26., 23., 14., 25., 25., 27., 24.])
count_res tensor([1.4683e-01, 1.4683e-01, 1.4683e-01, 5.4017e-02, 3.0265e-10, 5.4017e-02,
        5.4017e-02, 2.4524e-06, 9.0218e-07, 9.0218e-07, 9.0218e-07, 9.0218e-07,
        9.0218e-07, 9.0218e-07, 9.0218e-07, 9.0218e-07, 9.0218e-07, 9.0218e-07,
        9.0218e-07, 9.0218e-07, 1.4683e-01, 5.4017e-02, 2.6894e-03, 3.3189e-07,
        1.9872e-02, 1.9872e-02, 1.4683e-01, 7.3105e-03])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 89.50% 

Test Accuracy: 89.03% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5237906575202942
distance x is tensor(112.2079, device='cuda:0')
benign distance is  tensor(112.2079, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8501849174499512
distance x is tensor(106.3750, device='cuda:0')
benign distance is  tensor(106.3750, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.20124199986457825
distance x is tensor(130.1743, device='cuda:0')
benign distance is  tensor(130.1743, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5936002731323242
distance x is tensor(114.6044, device='cuda:0')
benign distance is  tensor(114.6044, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4978419244289398
distance x is tensor(117.2672, device='cuda:0')
benign distance is  tensor(117.2672, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3521423935890198
distance x is tensor(125.7102, device='cuda:0')
benign distance is  tensor(125.7102, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.49661868810653687
distance x is tensor(113.0692, device='cuda:0')
benign distance is  tensor(113.0692, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.35359707474708557
distance x is tensor(119.8336, device='cuda:0')
benign distance is  tensor(119.8336, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5542247891426086
distance x is tensor(128.0780, device='cuda:0')
benign distance is  tensor(128.0780, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.1840368509292603
distance x is tensor(135.8412, device='cuda:0')
benign distance is  tensor(135.8412, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4799814820289612
distance x is tensor(125.0374, device='cuda:0')
benign distance is  tensor(125.0374, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.5106399655342102
distance x is tensor(129.1085, device='cuda:0')
benign distance is  tensor(129.1085, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3174557089805603
distance x is tensor(130.9293, device='cuda:0')
benign distance is  tensor(130.9293, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8565081357955933
distance x is tensor(122.4723, device='cuda:0')
benign distance is  tensor(122.4723, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.15908657014369965
distance x is tensor(121.7241, device='cuda:0')
benign distance is  tensor(121.7241, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6185160875320435
distance x is tensor(130.4387, device='cuda:0')
benign distance is  tensor(130.4387, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([24., 24., 24., 27., 11., 27., 26., 23., 13., 13., 13., 13., 13., 13.,
        13., 13., 13., 13., 13., 13., 27., 24., 25., 21., 22., 26., 19., 22.])
count_res tensor([1.2129e-02, 1.2129e-02, 1.2129e-02, 2.4361e-01, 2.7415e-08, 2.4361e-01,
        8.9621e-02, 4.4619e-03, 2.0257e-07, 2.0257e-07, 2.0257e-07, 2.0257e-07,
        2.0257e-07, 2.0257e-07, 2.0257e-07, 2.0257e-07, 2.0257e-07, 2.0257e-07,
        2.0257e-07, 2.0257e-07, 2.4361e-01, 1.2129e-02, 3.2970e-02, 6.0386e-04,
        1.6415e-03, 8.9621e-02, 8.1723e-05, 1.6415e-03])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 89.87% 

Test Accuracy: 88.81% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5480747818946838
distance x is tensor(125.8313, device='cuda:0')
benign distance is  tensor(125.8313, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.037744164466858
distance x is tensor(116.4968, device='cuda:0')
benign distance is  tensor(116.4968, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.24439164996147156
distance x is tensor(127.5836, device='cuda:0')
benign distance is  tensor(127.5836, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5110653042793274
distance x is tensor(111.6713, device='cuda:0')
benign distance is  tensor(111.6713, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.10098838806152344
distance x is tensor(133.4693, device='cuda:0')
benign distance is  tensor(133.4693, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.23842117190361023
distance x is tensor(110.2578, device='cuda:0')
benign distance is  tensor(110.2578, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.17378118634223938
distance x is tensor(108.5171, device='cuda:0')
benign distance is  tensor(108.5171, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3286060690879822
distance x is tensor(115.5237, device='cuda:0')
benign distance is  tensor(115.5237, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.12703320384025574
distance x is tensor(126.1693, device='cuda:0')
benign distance is  tensor(126.1693, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.35894322395324707
distance x is tensor(129.8518, device='cuda:0')
benign distance is  tensor(129.8518, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7525684833526611
distance x is tensor(137.7218, device='cuda:0')
benign distance is  tensor(137.7218, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0409443378448486
distance x is tensor(119.5111, device='cuda:0')
benign distance is  tensor(119.5111, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.36019259691238403
distance x is tensor(139.8904, device='cuda:0')
benign distance is  tensor(139.8904, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2154514491558075
distance x is tensor(115.3385, device='cuda:0')
benign distance is  tensor(115.3385, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6422135233879089
distance x is tensor(129.7454, device='cuda:0')
benign distance is  tensor(129.7454, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6521881818771362
distance x is tensor(145.7710, device='cuda:0')
benign distance is  tensor(145.7710, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([13., 19., 13., 19., 19., 13., 17., 15., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([0.0002, 0.0660, 0.0002, 0.0660, 0.0660, 0.0002, 0.0089, 0.0012, 0.0660,
        0.0660, 0.0660, 0.0660, 0.0660, 0.0660, 0.0660, 0.0660, 0.0660, 0.0660,
        0.0660, 0.0660])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 10.43% 

Test Accuracy: 10.00% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.297592878341675
distance x is tensor(4593.5215, device='cuda:0')
benign distance is  tensor(4593.5215, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.301649808883667
distance x is tensor(3997.1887, device='cuda:0')
benign distance is  tensor(3997.1887, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3053548336029053
distance x is tensor(4764.6797, device='cuda:0')
benign distance is  tensor(4764.6797, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2938196659088135
distance x is tensor(5724.3442, device='cuda:0')
benign distance is  tensor(5724.3442, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.309072971343994
distance x is tensor(4509.6958, device='cuda:0')
benign distance is  tensor(4509.6958, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3068933486938477
distance x is tensor(3525.5115, device='cuda:0')
benign distance is  tensor(3525.5115, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2811782360076904
distance x is tensor(4847.6274, device='cuda:0')
benign distance is  tensor(4847.6274, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.279642105102539
distance x is tensor(4818.5396, device='cuda:0')
benign distance is  tensor(4818.5396, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 52
counter_tensor is  tensor([44., 44., 44., 44., 44., 44., 44., 44., 17., 17., 17., 17., 17., 17.,
        17., 17., 17., 17., 17., 17., 21., 48.,  8., 43., 49., 51., 51., 11.,
        39., 11., 50., 10.,  8., 10.,  1., 50., 38., 49., 17., 50., 51., 51.,
        25., 51., 10., 50., 20., 50., 50., 27., 40., 13.])
count_res tensor([1.2101e-04, 1.2101e-04, 1.2101e-04, 1.2101e-04, 1.2101e-04, 1.2101e-04,
        1.2101e-04, 1.2101e-04, 2.2745e-16, 2.2745e-16, 2.2745e-16, 2.2745e-16,
        2.2745e-16, 2.2745e-16, 2.2745e-16, 2.2745e-16, 2.2745e-16, 2.2745e-16,
        2.2745e-16, 2.2745e-16, 1.2418e-14, 6.6071e-03, 2.8069e-20, 4.4518e-05,
        1.7960e-02, 1.3271e-01, 1.3271e-01, 5.6379e-19, 8.1538e-07, 5.6379e-19,
        4.8820e-02, 2.0741e-19, 2.8069e-20, 2.0741e-19, 2.5596e-23, 4.8820e-02,
        2.9996e-07, 1.7960e-02, 2.2745e-16, 4.8820e-02, 1.3271e-01, 1.3271e-01,
        6.7801e-13, 1.3271e-01, 2.0741e-19, 4.8820e-02, 4.5684e-15, 4.8820e-02,
        4.8820e-02, 5.0099e-12, 2.2164e-06, 4.1659e-18])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 89.72% 

Test Accuracy: 89.06% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6493407487869263
distance x is tensor(102.7080, device='cuda:0')
benign distance is  tensor(102.7080, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.39214569330215454
distance x is tensor(106.8954, device='cuda:0')
benign distance is  tensor(106.8954, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.24180999398231506
distance x is tensor(122.0150, device='cuda:0')
benign distance is  tensor(122.0150, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5614510178565979
distance x is tensor(112.3030, device='cuda:0')
benign distance is  tensor(112.3030, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.43562325835227966
distance x is tensor(106.8350, device='cuda:0')
benign distance is  tensor(106.8350, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.363384485244751
distance x is tensor(109.0143, device='cuda:0')
benign distance is  tensor(109.0143, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3871091902256012
distance x is tensor(108.3723, device='cuda:0')
benign distance is  tensor(108.3723, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5403830409049988
distance x is tensor(117.1929, device='cuda:0')
benign distance is  tensor(117.1929, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.13988861441612244
distance x is tensor(122.8294, device='cuda:0')
benign distance is  tensor(122.8294, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4644044041633606
distance x is tensor(123.8018, device='cuda:0')
benign distance is  tensor(123.8018, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8359299898147583
distance x is tensor(121.2042, device='cuda:0')
benign distance is  tensor(121.2042, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5677970051765442
distance x is tensor(108.6117, device='cuda:0')
benign distance is  tensor(108.6117, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5692073106765747
distance x is tensor(109.2384, device='cuda:0')
benign distance is  tensor(109.2384, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1741897165775299
distance x is tensor(107.7618, device='cuda:0')
benign distance is  tensor(107.7618, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6468157768249512
distance x is tensor(119.9839, device='cuda:0')
benign distance is  tensor(119.9839, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4970046579837799
distance x is tensor(131.3369, device='cuda:0')
benign distance is  tensor(131.3369, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.29422396421432495
distance x is tensor(131.0861, device='cuda:0')
benign distance is  tensor(131.0861, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7413630485534668
distance x is tensor(137.0571, device='cuda:0')
benign distance is  tensor(137.0571, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4579288065433502
distance x is tensor(119.7154, device='cuda:0')
benign distance is  tensor(119.7154, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.30447012186050415
distance x is tensor(123.2552, device='cuda:0')
benign distance is  tensor(123.2552, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.2153201550245285
distance x is tensor(122.1504, device='cuda:0')
benign distance is  tensor(122.1504, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.812096118927002
distance x is tensor(114.7986, device='cuda:0')
benign distance is  tensor(114.7986, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.08677570521831512
distance x is tensor(134.2091, device='cuda:0')
benign distance is  tensor(134.2091, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5551098585128784
distance x is tensor(122.4891, device='cuda:0')
benign distance is  tensor(122.4891, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.19306263327598572
distance x is tensor(112.9882, device='cuda:0')
benign distance is  tensor(112.9882, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6033154726028442
distance x is tensor(125.0853, device='cuda:0')
benign distance is  tensor(125.0853, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.72405606508255
distance x is tensor(122.4253, device='cuda:0')
benign distance is  tensor(122.4253, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.38859909772872925
distance x is tensor(130.2249, device='cuda:0')
benign distance is  tensor(130.2249, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5055840611457825
distance x is tensor(105.6185, device='cuda:0')
benign distance is  tensor(105.6185, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5814215540885925
distance x is tensor(130.8802, device='cuda:0')
benign distance is  tensor(130.8802, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4437732696533203
distance x is tensor(125.1899, device='cuda:0')
benign distance is  tensor(125.1899, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.20356205105781555
distance x is tensor(119.7511, device='cuda:0')
benign distance is  tensor(119.7511, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.10578528791666031
distance x is tensor(122.2385, device='cuda:0')
benign distance is  tensor(122.2385, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.5519509315490723
distance x is tensor(106.5659, device='cuda:0')
benign distance is  tensor(106.5659, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.31042614579200745
distance x is tensor(122.6258, device='cuda:0')
benign distance is  tensor(122.6258, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.27275094389915466
distance x is tensor(123.1697, device='cuda:0')
benign distance is  tensor(123.1697, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.28479623794555664
distance x is tensor(123.5317, device='cuda:0')
benign distance is  tensor(123.5317, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.6443984508514404
distance x is tensor(118.5935, device='cuda:0')
benign distance is  tensor(118.5935, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.0991456508636475
distance x is tensor(119.5551, device='cuda:0')
benign distance is  tensor(119.5551, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.678001880645752
distance x is tensor(121.6485, device='cuda:0')
benign distance is  tensor(121.6485, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([25., 24., 23., 24., 13., 13., 20., 24., 27., 27., 27., 27., 27., 27.,
        27., 27., 27., 27., 27., 27., 27., 16., 27., 18., 27., 27., 22., 27.])
count_res tensor([7.8180e-03, 2.8761e-03, 1.0580e-03, 2.8761e-03, 4.8035e-08, 4.8035e-08,
        5.2677e-05, 2.8761e-03, 5.7767e-02, 5.7767e-02, 5.7767e-02, 5.7767e-02,
        5.7767e-02, 5.7767e-02, 5.7767e-02, 5.7767e-02, 5.7767e-02, 5.7767e-02,
        5.7767e-02, 5.7767e-02, 5.7767e-02, 9.6481e-07, 5.7767e-02, 7.1291e-06,
        5.7767e-02, 5.7767e-02, 3.8923e-04, 5.7767e-02])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 10.43% 

Test Accuracy: 10.00% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.308258295059204
distance x is tensor(1517.0178, device='cuda:0')
benign distance is  tensor(1517.0178, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.297391176223755
distance x is tensor(1400.8488, device='cuda:0')
benign distance is  tensor(1400.8488, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3024563789367676
distance x is tensor(1331.5251, device='cuda:0')
benign distance is  tensor(1331.5251, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2919187545776367
distance x is tensor(1719.9657, device='cuda:0')
benign distance is  tensor(1719.9657, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3048183917999268
distance x is tensor(1520.2188, device='cuda:0')
benign distance is  tensor(1520.2188, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.311918020248413
distance x is tensor(1303.3282, device='cuda:0')
benign distance is  tensor(1303.3282, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2943358421325684
distance x is tensor(1194.7549, device='cuda:0')
benign distance is  tensor(1194.7549, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2969183921813965
distance x is tensor(1167.6992, device='cuda:0')
benign distance is  tensor(1167.6992, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  2.299421787261963
distance x is tensor(1154.1981, device='cuda:0')
benign distance is  tensor(1154.1981, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.295441150665283
distance x is tensor(1210.5934, device='cuda:0')
benign distance is  tensor(1210.5934, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  2.355297327041626
distance x is tensor(1308.1677, device='cuda:0')
benign distance is  tensor(1308.1677, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.3126299381256104
distance x is tensor(1556.0658, device='cuda:0')
benign distance is  tensor(1556.0658, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  2.2914276123046875
distance x is tensor(1222.3264, device='cuda:0')
benign distance is  tensor(1222.3264, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  2.2914700508117676
distance x is tensor(1485.6080, device='cuda:0')
benign distance is  tensor(1485.6080, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.3153696060180664
distance x is tensor(889.4139, device='cuda:0')
benign distance is  tensor(889.4139, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  2.297252655029297
distance x is tensor(1275.9203, device='cuda:0')
benign distance is  tensor(1275.9203, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([20., 20., 20., 20., 20., 20., 20., 20., 27., 27., 27., 27., 27., 27.,
        27., 27., 27., 27., 27., 27., 20., 27., 25., 22., 21., 27., 14., 23.])
count_res tensor([6.4348e-05, 6.4348e-05, 6.4348e-05, 6.4348e-05, 6.4348e-05, 6.4348e-05,
        6.4348e-05, 6.4348e-05, 7.0566e-02, 7.0566e-02, 7.0566e-02, 7.0566e-02,
        7.0566e-02, 7.0566e-02, 7.0566e-02, 7.0566e-02, 7.0566e-02, 7.0566e-02,
        7.0566e-02, 7.0566e-02, 6.4348e-05, 7.0566e-02, 9.5501e-03, 4.7547e-04,
        1.7492e-04, 7.0566e-02, 1.5950e-07, 1.2925e-03])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 10.43% 

Test Accuracy: 10.00% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.3012566566467285
distance x is tensor(3747799.7500, device='cuda:0')
benign distance is  tensor(3747799.7500, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.2945399284362793
distance x is tensor(5263867., device='cuda:0')
benign distance is  tensor(5263867., device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3089911937713623
distance x is tensor(4788836.5000, device='cuda:0')
benign distance is  tensor(4788836.5000, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2927143573760986
distance x is tensor(3331578.2500, device='cuda:0')
benign distance is  tensor(3331578.2500, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.310248851776123
distance x is tensor(4683416.5000, device='cuda:0')
benign distance is  tensor(4683416.5000, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.309415102005005
distance x is tensor(3447409., device='cuda:0')
benign distance is  tensor(3447409., device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2977261543273926
distance x is tensor(4199567.5000, device='cuda:0')
benign distance is  tensor(4199567.5000, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.299518346786499
distance x is tensor(4808355., device='cuda:0')
benign distance is  tensor(4808355., device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.3385403156280518
distance x is tensor(3512672.2500, device='cuda:0')
benign distance is  tensor(3512672.2500, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.315859317779541
distance x is tensor(4038078.5000, device='cuda:0')
benign distance is  tensor(4038078.5000, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.2959141731262207
distance x is tensor(4592379., device='cuda:0')
benign distance is  tensor(4592379., device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.3100152015686035
distance x is tensor(3363202.2500, device='cuda:0')
benign distance is  tensor(3363202.2500, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.316807985305786
distance x is tensor(3658223.5000, device='cuda:0')
benign distance is  tensor(3658223.5000, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.2922072410583496
distance x is tensor(4605537.5000, device='cuda:0')
benign distance is  tensor(4605537.5000, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.2966532707214355
distance x is tensor(5022310., device='cuda:0')
benign distance is  tensor(5022310., device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.2911438941955566
distance x is tensor(4233633., device='cuda:0')
benign distance is  tensor(4233633., device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([20., 20., 20., 20., 20., 20., 20., 20., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 19., 24.,  8., 26., 27., 24., 22., 20.])
count_res tensor([6.1492e-04, 6.1492e-04, 6.1492e-04, 6.1492e-04, 6.1492e-04, 6.1492e-04,
        6.1492e-04, 6.1492e-04, 1.1263e-05, 1.1263e-05, 1.1263e-05, 1.1263e-05,
        1.1263e-05, 1.1263e-05, 1.1263e-05, 1.1263e-05, 1.1263e-05, 1.1263e-05,
        1.1263e-05, 1.1263e-05, 2.2622e-04, 3.3573e-02, 3.7782e-09, 2.4808e-01,
        6.7434e-01, 3.3573e-02, 4.5437e-03, 6.1492e-04])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 5.35% 

Test Accuracy: 4.95% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.305453062057495
distance x is tensor(717.6561, device='cuda:0')
benign distance is  tensor(717.6561, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0208500623703003
distance x is tensor(793.5286, device='cuda:0')
benign distance is  tensor(793.5286, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3366284370422363
distance x is tensor(1129.2731, device='cuda:0')
benign distance is  tensor(1129.2731, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.7077354192733765
distance x is tensor(533.4427, device='cuda:0')
benign distance is  tensor(533.4427, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3317110538482666
distance x is tensor(448.7106, device='cuda:0')
benign distance is  tensor(448.7106, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.322657585144043
distance x is tensor(680.9910, device='cuda:0')
benign distance is  tensor(680.9910, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1087796688079834
distance x is tensor(946.7033, device='cuda:0')
benign distance is  tensor(946.7033, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.303722858428955
distance x is tensor(732.5826, device='cuda:0')
benign distance is  tensor(732.5826, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.2875170707702637
distance x is tensor(657.7575, device='cuda:0')
benign distance is  tensor(657.7575, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.31793475151062
distance x is tensor(1071.3523, device='cuda:0')
benign distance is  tensor(1071.3523, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.1557097434997559
distance x is tensor(547.5275, device='cuda:0')
benign distance is  tensor(547.5275, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.8810689449310303
distance x is tensor(531.2496, device='cuda:0')
benign distance is  tensor(531.2496, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.300300121307373
distance x is tensor(365.0807, device='cuda:0')
benign distance is  tensor(365.0807, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  2.309095621109009
distance x is tensor(724.1244, device='cuda:0')
benign distance is  tensor(724.1244, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.9223356246948242
distance x is tensor(618.4700, device='cuda:0')
benign distance is  tensor(618.4700, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.244581699371338
distance x is tensor(521.2699, device='cuda:0')
benign distance is  tensor(521.2699, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 36
counter_tensor is  tensor([23., 21., 23., 22., 23., 23., 21., 23., 13., 13., 13., 13., 13., 13.,
        13., 13., 13., 13., 13., 13., 35., 14., 14., 13., 18., 15., 34., 35.,
        23., 23., 23., 23., 23., 23., 23., 23.])
count_res tensor([2.5947e-06, 3.5116e-07, 2.5947e-06, 9.5455e-07, 2.5947e-06, 2.5947e-06,
        3.5116e-07, 2.5947e-06, 1.1780e-10, 1.1780e-10, 1.1780e-10, 1.1780e-10,
        1.1780e-10, 1.1780e-10, 1.1780e-10, 1.1780e-10, 1.1780e-10, 1.1780e-10,
        1.1780e-10, 1.1780e-10, 4.2230e-01, 3.2021e-10, 3.2021e-10, 1.1780e-10,
        1.7483e-08, 8.7043e-10, 1.5536e-01, 4.2230e-01, 2.5947e-06, 2.5947e-06,
        2.5947e-06, 2.5947e-06, 2.5947e-06, 2.5947e-06, 2.5947e-06, 2.5947e-06])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 83.32% 

Test Accuracy: 82.53% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.13543514907360077
distance x is tensor(132.0937, device='cuda:0')
benign distance is  tensor(132.0937, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.45860499143600464
distance x is tensor(133.9858, device='cuda:0')
benign distance is  tensor(133.9858, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.39208361506462097
distance x is tensor(142.3747, device='cuda:0')
benign distance is  tensor(142.3747, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.23364417254924774
distance x is tensor(134.8530, device='cuda:0')
benign distance is  tensor(134.8530, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.22943539917469025
distance x is tensor(133.6587, device='cuda:0')
benign distance is  tensor(133.6587, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4920753836631775
distance x is tensor(137.6025, device='cuda:0')
benign distance is  tensor(137.6025, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6824716329574585
distance x is tensor(145.8167, device='cuda:0')
benign distance is  tensor(145.8167, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5222911834716797
distance x is tensor(138.2128, device='cuda:0')
benign distance is  tensor(138.2128, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7083232402801514
distance x is tensor(142.0691, device='cuda:0')
benign distance is  tensor(142.0691, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.2990535497665405
distance x is tensor(140.5166, device='cuda:0')
benign distance is  tensor(140.5166, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6419053077697754
distance x is tensor(134.2448, device='cuda:0')
benign distance is  tensor(134.2448, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4168469309806824
distance x is tensor(133.4606, device='cuda:0')
benign distance is  tensor(133.4606, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6964154839515686
distance x is tensor(133.4229, device='cuda:0')
benign distance is  tensor(133.4229, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.20756463706493378
distance x is tensor(133.2285, device='cuda:0')
benign distance is  tensor(133.2285, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3716154992580414
distance x is tensor(143.2735, device='cuda:0')
benign distance is  tensor(143.2735, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5979694128036499
distance x is tensor(135.4971, device='cuda:0')
benign distance is  tensor(135.4971, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.6567278504371643
distance x is tensor(109.0962, device='cuda:0')
benign distance is  tensor(109.0962, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6321927309036255
distance x is tensor(132.5574, device='cuda:0')
benign distance is  tensor(132.5574, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.29781484603881836
distance x is tensor(127.3830, device='cuda:0')
benign distance is  tensor(127.3830, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.015842080116272
distance x is tensor(143.3490, device='cuda:0')
benign distance is  tensor(143.3490, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.5691094398498535
distance x is tensor(141.1694, device='cuda:0')
benign distance is  tensor(141.1694, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.19307562708854675
distance x is tensor(135.7216, device='cuda:0')
benign distance is  tensor(135.7216, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.22747854888439178
distance x is tensor(138.3218, device='cuda:0')
benign distance is  tensor(138.3218, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.4212455749511719
distance x is tensor(129.7680, device='cuda:0')
benign distance is  tensor(129.7680, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([15., 19., 18., 13., 14., 17., 18., 19., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([0.0012, 0.0671, 0.0247, 0.0002, 0.0005, 0.0091, 0.0247, 0.0671, 0.0671,
        0.0671, 0.0671, 0.0671, 0.0671, 0.0671, 0.0671, 0.0671, 0.0671, 0.0671,
        0.0671, 0.0671])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 10.43% 

Test Accuracy: 10.00% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.291579008102417
distance x is tensor(8597.4932, device='cuda:0')
benign distance is  tensor(8597.4932, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.2853574752807617
distance x is tensor(7131.3721, device='cuda:0')
benign distance is  tensor(7131.3721, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.2953104972839355
distance x is tensor(10328.0225, device='cuda:0')
benign distance is  tensor(10328.0225, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2761940956115723
distance x is tensor(10894.6084, device='cuda:0')
benign distance is  tensor(10894.6084, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.29995059967041
distance x is tensor(12352.8643, device='cuda:0')
benign distance is  tensor(12352.8643, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.301351308822632
distance x is tensor(9690.6289, device='cuda:0')
benign distance is  tensor(9690.6289, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.299809455871582
distance x is tensor(11081.2676, device='cuda:0')
benign distance is  tensor(11081.2676, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.298560857772827
distance x is tensor(10392.0957, device='cuda:0')
benign distance is  tensor(10392.0957, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 52
counter_tensor is  tensor([30., 30., 30., 30., 30., 30., 30., 30., 22., 22., 22., 22., 22., 22.,
        22., 22., 22., 22., 22., 22., 22., 22., 23., 22., 51., 50., 22., 22.,
        30., 30., 30., 30., 30., 30., 30., 30., 30., 30., 28., 29., 30., 30.,
        29., 29., 29., 23., 22., 23.,  0., 50., 22., 22.])
count_res tensor([4.3684e-10, 4.3684e-10, 4.3684e-10, 4.3684e-10, 4.3684e-10, 4.3684e-10,
        4.3684e-10, 4.3684e-10, 1.4654e-13, 1.4654e-13, 1.4654e-13, 1.4654e-13,
        1.4654e-13, 1.4654e-13, 1.4654e-13, 1.4654e-13, 1.4654e-13, 1.4654e-13,
        1.4654e-13, 1.4654e-13, 1.4654e-13, 1.4654e-13, 3.9835e-13, 1.4654e-13,
        5.7612e-01, 2.1194e-01, 1.4654e-13, 1.4654e-13, 4.3684e-10, 4.3684e-10,
        4.3684e-10, 4.3684e-10, 4.3684e-10, 4.3684e-10, 4.3684e-10, 4.3684e-10,
        4.3684e-10, 4.3684e-10, 5.9120e-11, 1.6071e-10, 4.3684e-10, 4.3684e-10,
        1.6071e-10, 1.6071e-10, 1.6071e-10, 3.9835e-13, 1.4654e-13, 3.9835e-13,
        4.0878e-23, 2.1194e-01, 1.4654e-13, 1.4654e-13])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 89.43% 

Test Accuracy: 88.20% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.28995445370674133
distance x is tensor(121.9118, device='cuda:0')
benign distance is  tensor(121.9118, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5201984643936157
distance x is tensor(114.2824, device='cuda:0')
benign distance is  tensor(114.2824, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.31783512234687805
distance x is tensor(125.7504, device='cuda:0')
benign distance is  tensor(125.7504, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6567047834396362
distance x is tensor(118.8655, device='cuda:0')
benign distance is  tensor(118.8655, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8913676142692566
distance x is tensor(105.2695, device='cuda:0')
benign distance is  tensor(105.2695, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.38158756494522095
distance x is tensor(120.6457, device='cuda:0')
benign distance is  tensor(120.6457, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3537061810493469
distance x is tensor(126.2558, device='cuda:0')
benign distance is  tensor(126.2558, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6987704038619995
distance x is tensor(121.6396, device='cuda:0')
benign distance is  tensor(121.6396, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.44656118750572205
distance x is tensor(129.2376, device='cuda:0')
benign distance is  tensor(129.2376, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.25410333275794983
distance x is tensor(121.8592, device='cuda:0')
benign distance is  tensor(121.8592, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6397543549537659
distance x is tensor(126.9419, device='cuda:0')
benign distance is  tensor(126.9419, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8863590955734253
distance x is tensor(124.7850, device='cuda:0')
benign distance is  tensor(124.7850, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5256174206733704
distance x is tensor(126.2157, device='cuda:0')
benign distance is  tensor(126.2157, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.16409412026405334
distance x is tensor(101.2871, device='cuda:0')
benign distance is  tensor(101.2871, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7283580899238586
distance x is tensor(121.7411, device='cuda:0')
benign distance is  tensor(121.7411, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7018786072731018
distance x is tensor(147.0191, device='cuda:0')
benign distance is  tensor(147.0191, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.1930648237466812
distance x is tensor(129.0247, device='cuda:0')
benign distance is  tensor(129.0247, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.034467339515686
distance x is tensor(148.6597, device='cuda:0')
benign distance is  tensor(148.6597, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3850685954093933
distance x is tensor(133.7180, device='cuda:0')
benign distance is  tensor(133.7180, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2754287123680115
distance x is tensor(134.6861, device='cuda:0')
benign distance is  tensor(134.6861, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.41871270537376404
distance x is tensor(126.2900, device='cuda:0')
benign distance is  tensor(126.2900, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8718745112419128
distance x is tensor(126.0585, device='cuda:0')
benign distance is  tensor(126.0585, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.14122192561626434
distance x is tensor(134.8281, device='cuda:0')
benign distance is  tensor(134.8281, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.32720279693603516
distance x is tensor(124.1541, device='cuda:0')
benign distance is  tensor(124.1541, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.40928953886032104
distance x is tensor(130.1231, device='cuda:0')
benign distance is  tensor(130.1231, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.05873296409845352
distance x is tensor(139.8550, device='cuda:0')
benign distance is  tensor(139.8550, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.24662017822265625
distance x is tensor(125.4356, device='cuda:0')
benign distance is  tensor(125.4356, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.3013034462928772
distance x is tensor(124.0795, device='cuda:0')
benign distance is  tensor(124.0795, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.3439599871635437
distance x is tensor(123.9397, device='cuda:0')
benign distance is  tensor(123.9397, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.3353668749332428
distance x is tensor(125.7931, device='cuda:0')
benign distance is  tensor(125.7931, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.4827025830745697
distance x is tensor(129.8386, device='cuda:0')
benign distance is  tensor(129.8386, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.09949641674757004
distance x is tensor(124.4601, device='cuda:0')
benign distance is  tensor(124.4601, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.0716860443353653
distance x is tensor(130.0340, device='cuda:0')
benign distance is  tensor(130.0340, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.10749107599258423
distance x is tensor(123.8403, device='cuda:0')
benign distance is  tensor(123.8403, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.03415655344724655
distance x is tensor(132.0580, device='cuda:0')
benign distance is  tensor(132.0580, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.5656797289848328
distance x is tensor(126.2023, device='cuda:0')
benign distance is  tensor(126.2023, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.096017599105835
distance x is tensor(97.3699, device='cuda:0')
benign distance is  tensor(97.3699, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5161162614822388
distance x is tensor(126.6206, device='cuda:0')
benign distance is  tensor(126.6206, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.2160732746124268
distance x is tensor(132.3518, device='cuda:0')
benign distance is  tensor(132.3518, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7916693091392517
distance x is tensor(123.3989, device='cuda:0')
benign distance is  tensor(123.3989, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([19., 17., 19., 19., 13., 18., 16., 19., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([0.0604, 0.0082, 0.0604, 0.0604, 0.0001, 0.0222, 0.0030, 0.0604, 0.0604,
        0.0604, 0.0604, 0.0604, 0.0604, 0.0604, 0.0604, 0.0604, 0.0604, 0.0604,
        0.0604, 0.0604])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 10.43% 

Test Accuracy: 10.00% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.3015923500061035
distance x is tensor(2639.4492, device='cuda:0')
benign distance is  tensor(2639.4492, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.3196887969970703
distance x is tensor(2037.2715, device='cuda:0')
benign distance is  tensor(2037.2715, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3035531044006348
distance x is tensor(2119.6133, device='cuda:0')
benign distance is  tensor(2119.6133, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2903780937194824
distance x is tensor(2784.2981, device='cuda:0')
benign distance is  tensor(2784.2981, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.2996387481689453
distance x is tensor(2344.9277, device='cuda:0')
benign distance is  tensor(2344.9277, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3062541484832764
distance x is tensor(1714.8264, device='cuda:0')
benign distance is  tensor(1714.8264, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.291947841644287
distance x is tensor(2972.4800, device='cuda:0')
benign distance is  tensor(2972.4800, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2953639030456543
distance x is tensor(2295.4392, device='cuda:0')
benign distance is  tensor(2295.4392, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 36
counter_tensor is  tensor([28., 28., 28., 28., 28., 28., 28., 28., 11., 11., 11., 11., 11., 11.,
        11., 11., 11., 11., 11., 11., 31., 35., 29., 13., 35., 33., 27., 35.,
         8., 35.,  9., 30., 16., 35., 18., 33.])
count_res tensor([1.7186e-04, 1.7186e-04, 1.7186e-04, 1.7186e-04, 1.7186e-04, 1.7186e-04,
        1.7186e-04, 1.7186e-04, 7.1151e-12, 7.1151e-12, 7.1151e-12, 7.1151e-12,
        7.1151e-12, 7.1151e-12, 7.1151e-12, 7.1151e-12, 7.1151e-12, 7.1151e-12,
        7.1151e-12, 7.1151e-12, 3.4520e-03, 1.8847e-01, 4.6717e-04, 5.2574e-11,
        1.8847e-01, 2.5507e-02, 6.3225e-05, 1.8847e-01, 3.5424e-13, 1.8847e-01,
        9.6292e-13, 1.2699e-03, 1.0560e-09, 1.8847e-01, 7.8026e-09, 2.5507e-02])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 89.78% 

Test Accuracy: 88.60% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7913644909858704
distance x is tensor(116.8643, device='cuda:0')
benign distance is  tensor(116.8643, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6144905090332031
distance x is tensor(114.2632, device='cuda:0')
benign distance is  tensor(114.2632, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.48220664262771606
distance x is tensor(124.2437, device='cuda:0')
benign distance is  tensor(124.2437, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3821678161621094
distance x is tensor(123.1249, device='cuda:0')
benign distance is  tensor(123.1249, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7171186804771423
distance x is tensor(118.8705, device='cuda:0')
benign distance is  tensor(118.8705, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5488519668579102
distance x is tensor(126.4413, device='cuda:0')
benign distance is  tensor(126.4413, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4011600911617279
distance x is tensor(120.7835, device='cuda:0')
benign distance is  tensor(120.7835, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7156955003738403
distance x is tensor(129.4668, device='cuda:0')
benign distance is  tensor(129.4668, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7640159726142883
distance x is tensor(126.7489, device='cuda:0')
benign distance is  tensor(126.7489, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4044230580329895
distance x is tensor(121.2747, device='cuda:0')
benign distance is  tensor(121.2747, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3320426940917969
distance x is tensor(134.1987, device='cuda:0')
benign distance is  tensor(134.1987, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4265322685241699
distance x is tensor(131.3616, device='cuda:0')
benign distance is  tensor(131.3616, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.43823304772377014
distance x is tensor(118.5066, device='cuda:0')
benign distance is  tensor(118.5066, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.08388247340917587
distance x is tensor(101.2207, device='cuda:0')
benign distance is  tensor(101.2207, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8599511384963989
distance x is tensor(131.6177, device='cuda:0')
benign distance is  tensor(131.6177, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0474860668182373
distance x is tensor(124.2313, device='cuda:0')
benign distance is  tensor(124.2313, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.5440111756324768
distance x is tensor(101.7466, device='cuda:0')
benign distance is  tensor(101.7466, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5345982313156128
distance x is tensor(112.0529, device='cuda:0')
benign distance is  tensor(112.0529, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.15129630267620087
distance x is tensor(125.3949, device='cuda:0')
benign distance is  tensor(125.3949, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.6346789598464966
distance x is tensor(137.2426, device='cuda:0')
benign distance is  tensor(137.2426, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9221903681755066
distance x is tensor(102.7953, device='cuda:0')
benign distance is  tensor(102.7953, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.46975669264793396
distance x is tensor(120.8252, device='cuda:0')
benign distance is  tensor(120.8252, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5544909238815308
distance x is tensor(121.5559, device='cuda:0')
benign distance is  tensor(121.5559, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.17353777587413788
distance x is tensor(113.2973, device='cuda:0')
benign distance is  tensor(113.2973, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([26., 23., 25., 22., 23., 27., 27., 23., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27.,  8., 18., 25., 24., 25., 23., 20.])
count_res tensor([9.4209e-02, 4.6904e-03, 3.4658e-02, 1.7255e-03, 4.6904e-03, 2.5609e-01,
        2.5609e-01, 4.6904e-03, 4.2771e-06, 4.2771e-06, 4.2771e-06, 4.2771e-06,
        4.2771e-06, 4.2771e-06, 4.2771e-06, 4.2771e-06, 4.2771e-06, 4.2771e-06,
        4.2771e-06, 4.2771e-06, 2.5609e-01, 1.4348e-09, 3.1604e-05, 3.4658e-02,
        1.2750e-02, 3.4658e-02, 4.6904e-03, 2.3352e-04])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 89.73% 

Test Accuracy: 88.85% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.757552981376648
distance x is tensor(104.2206, device='cuda:0')
benign distance is  tensor(104.2206, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3134019076824188
distance x is tensor(117.7596, device='cuda:0')
benign distance is  tensor(117.7596, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.09472544491291046
distance x is tensor(129.2941, device='cuda:0')
benign distance is  tensor(129.2941, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7869421243667603
distance x is tensor(111.6356, device='cuda:0')
benign distance is  tensor(111.6356, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2093927413225174
distance x is tensor(114.3147, device='cuda:0')
benign distance is  tensor(114.3147, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0535680055618286
distance x is tensor(103.8470, device='cuda:0')
benign distance is  tensor(103.8470, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3860938549041748
distance x is tensor(90.0864, device='cuda:0')
benign distance is  tensor(90.0864, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7138587236404419
distance x is tensor(126.2819, device='cuda:0')
benign distance is  tensor(126.2819, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.35066282749176025
distance x is tensor(111.9531, device='cuda:0')
benign distance is  tensor(111.9531, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6657885909080505
distance x is tensor(141.0483, device='cuda:0')
benign distance is  tensor(141.0483, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5249550342559814
distance x is tensor(126.7132, device='cuda:0')
benign distance is  tensor(126.7132, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.5353882908821106
distance x is tensor(126.5096, device='cuda:0')
benign distance is  tensor(126.5096, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.1676648110151291
distance x is tensor(124.7603, device='cuda:0')
benign distance is  tensor(124.7603, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6363397240638733
distance x is tensor(117.0464, device='cuda:0')
benign distance is  tensor(117.0464, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.05569196492433548
distance x is tensor(124.8882, device='cuda:0')
benign distance is  tensor(124.8882, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5561776757240295
distance x is tensor(139.6277, device='cuda:0')
benign distance is  tensor(139.6277, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([ 4., 21., 27., 25., 14., 20., 20., 20., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 14., 18., 22., 21., 25., 27., 24., 26.])
count_res tensor([3.7963e-11, 9.1700e-04, 3.6995e-01, 5.0067e-02, 8.3620e-07, 3.3735e-04,
        3.3735e-04, 3.3735e-04, 6.1787e-06, 6.1787e-06, 6.1787e-06, 6.1787e-06,
        6.1787e-06, 6.1787e-06, 6.1787e-06, 6.1787e-06, 6.1787e-06, 6.1787e-06,
        6.1787e-06, 6.1787e-06, 8.3620e-07, 4.5655e-05, 2.4927e-03, 9.1700e-04,
        5.0067e-02, 3.6995e-01, 1.8419e-02, 1.3610e-01])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 89.78% 

Test Accuracy: 88.93% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.18541300296783447
distance x is tensor(124.1131, device='cuda:0')
benign distance is  tensor(124.1131, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3676757216453552
distance x is tensor(118.3699, device='cuda:0')
benign distance is  tensor(118.3699, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.11304112523794174
distance x is tensor(110.8931, device='cuda:0')
benign distance is  tensor(110.8931, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.1743083894252777
distance x is tensor(118.6261, device='cuda:0')
benign distance is  tensor(118.6261, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5309444665908813
distance x is tensor(111.0043, device='cuda:0')
benign distance is  tensor(111.0043, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.588653564453125
distance x is tensor(114.6534, device='cuda:0')
benign distance is  tensor(114.6534, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1153094619512558
distance x is tensor(116.7561, device='cuda:0')
benign distance is  tensor(116.7561, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.43096327781677246
distance x is tensor(136.9038, device='cuda:0')
benign distance is  tensor(136.9038, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.11531058698892593
distance x is tensor(126.1301, device='cuda:0')
benign distance is  tensor(126.1301, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.22138801217079163
distance x is tensor(122.6420, device='cuda:0')
benign distance is  tensor(122.6420, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4415246844291687
distance x is tensor(117.3456, device='cuda:0')
benign distance is  tensor(117.3456, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6524117588996887
distance x is tensor(122.1930, device='cuda:0')
benign distance is  tensor(122.1930, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7949622869491577
distance x is tensor(129.7075, device='cuda:0')
benign distance is  tensor(129.7075, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.0932384580373764
distance x is tensor(73.0922, device='cuda:0')
benign distance is  tensor(73.0922, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6201199293136597
distance x is tensor(128.2726, device='cuda:0')
benign distance is  tensor(128.2726, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5281565189361572
distance x is tensor(128.7535, device='cuda:0')
benign distance is  tensor(128.7535, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([27., 24., 16., 15., 15., 26., 21., 18., 27., 27., 27., 27., 27., 27.,
        27., 27., 27., 27., 27., 27., 21., 18., 16., 20., 25., 27., 27., 25.])
count_res tensor([6.3717e-02, 3.1723e-03, 1.0642e-06, 3.9149e-07, 3.9149e-07, 2.3440e-02,
        1.5794e-04, 7.8633e-06, 6.3717e-02, 6.3717e-02, 6.3717e-02, 6.3717e-02,
        6.3717e-02, 6.3717e-02, 6.3717e-02, 6.3717e-02, 6.3717e-02, 6.3717e-02,
        6.3717e-02, 6.3717e-02, 1.5794e-04, 7.8633e-06, 1.0642e-06, 5.8102e-05,
        8.6231e-03, 6.3717e-02, 6.3717e-02, 8.6231e-03])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 10.43% 

Test Accuracy: 10.00% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.2903997898101807
distance x is tensor(4920.7104, device='cuda:0')
benign distance is  tensor(4920.7104, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.2995047569274902
distance x is tensor(5187.2935, device='cuda:0')
benign distance is  tensor(5187.2935, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.30505108833313
distance x is tensor(7425.4648, device='cuda:0')
benign distance is  tensor(7425.4648, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.303410291671753
distance x is tensor(5008.5596, device='cuda:0')
benign distance is  tensor(5008.5596, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.2999768257141113
distance x is tensor(5000.7734, device='cuda:0')
benign distance is  tensor(5000.7734, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3095555305480957
distance x is tensor(6232.2290, device='cuda:0')
benign distance is  tensor(6232.2290, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.298386812210083
distance x is tensor(5893.4321, device='cuda:0')
benign distance is  tensor(5893.4321, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2908873558044434
distance x is tensor(6015.2573, device='cuda:0')
benign distance is  tensor(6015.2573, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  2.3003640174865723
distance x is tensor(4646.9121, device='cuda:0')
benign distance is  tensor(4646.9121, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.295257091522217
distance x is tensor(4956.4771, device='cuda:0')
benign distance is  tensor(4956.4771, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  2.360193967819214
distance x is tensor(3824.6216, device='cuda:0')
benign distance is  tensor(3824.6216, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.3185033798217773
distance x is tensor(7435.2944, device='cuda:0')
benign distance is  tensor(7435.2944, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  2.2863576412200928
distance x is tensor(6178.0576, device='cuda:0')
benign distance is  tensor(6178.0576, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  2.282304048538208
distance x is tensor(4551.9468, device='cuda:0')
benign distance is  tensor(4551.9468, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.3104095458984375
distance x is tensor(6525.0278, device='cuda:0')
benign distance is  tensor(6525.0278, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  2.2866568565368652
distance x is tensor(4892.4082, device='cuda:0')
benign distance is  tensor(4892.4082, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 52
counter_tensor is  tensor([44., 44., 44., 44., 44., 44., 44., 44., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20., 50., 50., 42., 49., 48.,  3., 12., 51.,
        48., 50.,  8.,  8., 50., 18., 32., 47., 24., 42.,  9., 13., 36., 50.,
        46.,  1., 20., 47., 15., 50., 43., 51., 12., 15.])
count_res tensor([2.0294e-04, 2.0294e-04, 2.0294e-04, 2.0294e-04, 2.0294e-04, 2.0294e-04,
        2.0294e-04, 2.0294e-04, 7.6611e-15, 7.6611e-15, 7.6611e-15, 7.6611e-15,
        7.6611e-15, 7.6611e-15, 7.6611e-15, 7.6611e-15, 7.6611e-15, 7.6611e-15,
        7.6611e-15, 7.6611e-15, 8.1870e-02, 8.1870e-02, 2.7464e-05, 3.0118e-02,
        1.1080e-02, 3.1717e-22, 2.5700e-18, 2.2255e-01, 1.1080e-02, 8.1870e-02,
        4.7072e-20, 4.7072e-20, 8.1870e-02, 1.0368e-15, 1.2469e-09, 4.0761e-03,
        4.1828e-13, 2.7464e-05, 1.2795e-19, 6.9860e-18, 6.8078e-08, 8.1870e-02,
        1.4995e-03, 4.2924e-23, 7.6611e-15, 4.0761e-03, 5.1620e-17, 8.1870e-02,
        7.4656e-05, 2.2255e-01, 2.5700e-18, 5.1620e-17])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 89.88% 

Test Accuracy: 88.68% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.20141175389289856
distance x is tensor(119.4883, device='cuda:0')
benign distance is  tensor(119.4883, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7528232336044312
distance x is tensor(126.9877, device='cuda:0')
benign distance is  tensor(126.9877, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.05781028792262077
distance x is tensor(126.2674, device='cuda:0')
benign distance is  tensor(126.2674, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8087398409843445
distance x is tensor(113.3841, device='cuda:0')
benign distance is  tensor(113.3841, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5225846171379089
distance x is tensor(110.6443, device='cuda:0')
benign distance is  tensor(110.6443, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6994626522064209
distance x is tensor(113.1410, device='cuda:0')
benign distance is  tensor(113.1410, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6294571757316589
distance x is tensor(113.9278, device='cuda:0')
benign distance is  tensor(113.9278, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.30143579840660095
distance x is tensor(122.7537, device='cuda:0')
benign distance is  tensor(122.7537, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.33514389395713806
distance x is tensor(127.0284, device='cuda:0')
benign distance is  tensor(127.0284, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.0845130681991577
distance x is tensor(119.4653, device='cuda:0')
benign distance is  tensor(119.4653, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5632721185684204
distance x is tensor(120.5555, device='cuda:0')
benign distance is  tensor(120.5555, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2855840921401978
distance x is tensor(121.7299, device='cuda:0')
benign distance is  tensor(121.7299, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7595099210739136
distance x is tensor(124.0127, device='cuda:0')
benign distance is  tensor(124.0127, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.38515955209732056
distance x is tensor(96.1738, device='cuda:0')
benign distance is  tensor(96.1738, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.554686427116394
distance x is tensor(125.0203, device='cuda:0')
benign distance is  tensor(125.0203, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5332515835762024
distance x is tensor(116.9782, device='cuda:0')
benign distance is  tensor(116.9782, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.32889026403427124
distance x is tensor(116.1132, device='cuda:0')
benign distance is  tensor(116.1132, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7927159070968628
distance x is tensor(138.8025, device='cuda:0')
benign distance is  tensor(138.8025, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.21498361229896545
distance x is tensor(127.2375, device='cuda:0')
benign distance is  tensor(127.2375, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.13052603602409363
distance x is tensor(121.5130, device='cuda:0')
benign distance is  tensor(121.5130, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.18192914128303528
distance x is tensor(123.9977, device='cuda:0')
benign distance is  tensor(123.9977, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7912843227386475
distance x is tensor(123.8935, device='cuda:0')
benign distance is  tensor(123.8935, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.08746825158596039
distance x is tensor(134.6177, device='cuda:0')
benign distance is  tensor(134.6177, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.49436649680137634
distance x is tensor(134.1412, device='cuda:0')
benign distance is  tensor(134.1412, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.17010626196861267
distance x is tensor(115.9279, device='cuda:0')
benign distance is  tensor(115.9279, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7624872922897339
distance x is tensor(113.8978, device='cuda:0')
benign distance is  tensor(113.8978, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.6079121828079224
distance x is tensor(137.0016, device='cuda:0')
benign distance is  tensor(137.0016, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5319005846977234
distance x is tensor(131.7977, device='cuda:0')
benign distance is  tensor(131.7977, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.1187684535980225
distance x is tensor(114.3332, device='cuda:0')
benign distance is  tensor(114.3332, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5876668691635132
distance x is tensor(125.2581, device='cuda:0')
benign distance is  tensor(125.2581, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6649600863456726
distance x is tensor(132.3123, device='cuda:0')
benign distance is  tensor(132.3123, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.4824792444705963
distance x is tensor(116.8788, device='cuda:0')
benign distance is  tensor(116.8788, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.21791689097881317
distance x is tensor(137.0792, device='cuda:0')
benign distance is  tensor(137.0792, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.6059342622756958
distance x is tensor(97.6737, device='cuda:0')
benign distance is  tensor(97.6737, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.6103650331497192
distance x is tensor(133.2712, device='cuda:0')
benign distance is  tensor(133.2712, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.4631574749946594
distance x is tensor(122.7235, device='cuda:0')
benign distance is  tensor(122.7235, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.4856886863708496
distance x is tensor(119.1146, device='cuda:0')
benign distance is  tensor(119.1146, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.3386436998844147
distance x is tensor(112.3366, device='cuda:0')
benign distance is  tensor(112.3366, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6938941478729248
distance x is tensor(131.5643, device='cuda:0')
benign distance is  tensor(131.5643, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  1.08053719997406
distance x is tensor(111.4430, device='cuda:0')
benign distance is  tensor(111.4430, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([16., 19., 17., 19., 19., 18., 18., 16., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([0.0031, 0.0626, 0.0085, 0.0626, 0.0626, 0.0230, 0.0230, 0.0031, 0.0626,
        0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626, 0.0626,
        0.0626, 0.0626])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 10.43% 

Test Accuracy: 10.00% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.2984700202941895
distance x is tensor(4294.8130, device='cuda:0')
benign distance is  tensor(4294.8130, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.2995645999908447
distance x is tensor(3922.6035, device='cuda:0')
benign distance is  tensor(3922.6035, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3025989532470703
distance x is tensor(5492.1177, device='cuda:0')
benign distance is  tensor(5492.1177, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2909584045410156
distance x is tensor(3992.2886, device='cuda:0')
benign distance is  tensor(3992.2886, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3109042644500732
distance x is tensor(4880.0435, device='cuda:0')
benign distance is  tensor(4880.0435, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.2999603748321533
distance x is tensor(4372.2109, device='cuda:0')
benign distance is  tensor(4372.2109, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2862343788146973
distance x is tensor(3541.7732, device='cuda:0')
benign distance is  tensor(3541.7732, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.3042101860046387
distance x is tensor(3505.2275, device='cuda:0')
benign distance is  tensor(3505.2275, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([20., 20., 20., 20., 20., 20., 20., 20., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 23., 25., 27., 27., 25., 23.,  9., 27.])
count_res tensor([2.7509e-04, 2.7509e-04, 2.7509e-04, 2.7509e-04, 2.7509e-04, 2.7509e-04,
        2.7509e-04, 2.7509e-04, 5.0385e-06, 5.0385e-06, 5.0385e-06, 5.0385e-06,
        5.0385e-06, 5.0385e-06, 5.0385e-06, 5.0385e-06, 5.0385e-06, 5.0385e-06,
        5.0385e-06, 5.0385e-06, 5.5254e-03, 4.0828e-02, 3.0168e-01, 3.0168e-01,
        4.0828e-02, 5.5254e-03, 4.5945e-09, 3.0168e-01])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 89.17% 

Test Accuracy: 88.53% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.39780157804489136
distance x is tensor(113.6699, device='cuda:0')
benign distance is  tensor(113.6699, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.540244460105896
distance x is tensor(115.7870, device='cuda:0')
benign distance is  tensor(115.7870, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.07769110053777695
distance x is tensor(126.4036, device='cuda:0')
benign distance is  tensor(126.4036, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7444003820419312
distance x is tensor(119.4097, device='cuda:0')
benign distance is  tensor(119.4097, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3052518963813782
distance x is tensor(106.5753, device='cuda:0')
benign distance is  tensor(106.5753, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8374689221382141
distance x is tensor(127.7697, device='cuda:0')
benign distance is  tensor(127.7697, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.19352588057518005
distance x is tensor(121.9434, device='cuda:0')
benign distance is  tensor(121.9434, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.623685896396637
distance x is tensor(133.3529, device='cuda:0')
benign distance is  tensor(133.3529, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.28191953897476196
distance x is tensor(142.9200, device='cuda:0')
benign distance is  tensor(142.9200, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.45724692940711975
distance x is tensor(126.8941, device='cuda:0')
benign distance is  tensor(126.8941, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8909137845039368
distance x is tensor(114.2580, device='cuda:0')
benign distance is  tensor(114.2580, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3973987102508545
distance x is tensor(102.8331, device='cuda:0')
benign distance is  tensor(102.8331, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.26131120324134827
distance x is tensor(124.1127, device='cuda:0')
benign distance is  tensor(124.1127, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4030103087425232
distance x is tensor(102.8601, device='cuda:0')
benign distance is  tensor(102.8601, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6619457006454468
distance x is tensor(135.6293, device='cuda:0')
benign distance is  tensor(135.6293, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4712519645690918
distance x is tensor(115.5396, device='cuda:0')
benign distance is  tensor(115.5396, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([27., 25., 22., 19., 27., 23., 19., 27., 15., 15., 15., 15., 15., 15.,
        15., 15., 15., 15., 15., 15., 26., 27., 18., 27., 27.,  4., 25., 26.])
count_res tensor([1.4220e-01, 1.9245e-02, 9.5814e-04, 4.7703e-05, 1.4220e-01, 2.6045e-03,
        4.7703e-05, 1.4220e-01, 8.7371e-07, 8.7371e-07, 8.7371e-07, 8.7371e-07,
        8.7371e-07, 8.7371e-07, 8.7371e-07, 8.7371e-07, 8.7371e-07, 8.7371e-07,
        8.7371e-07, 8.7371e-07, 5.2312e-02, 1.4220e-01, 1.7549e-05, 1.4220e-01,
        1.4220e-01, 1.4592e-11, 1.9245e-02, 5.2312e-02])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 89.97% 

Test Accuracy: 89.04% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3069773018360138
distance x is tensor(118.0503, device='cuda:0')
benign distance is  tensor(118.0503, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6087325215339661
distance x is tensor(112.7905, device='cuda:0')
benign distance is  tensor(112.7905, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.024096369743347168
distance x is tensor(125.2898, device='cuda:0')
benign distance is  tensor(125.2898, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9887464642524719
distance x is tensor(121.5852, device='cuda:0')
benign distance is  tensor(121.5852, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4280305802822113
distance x is tensor(109.6785, device='cuda:0')
benign distance is  tensor(109.6785, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2075269222259521
distance x is tensor(127.1578, device='cuda:0')
benign distance is  tensor(127.1578, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.37565740942955017
distance x is tensor(115.5357, device='cuda:0')
benign distance is  tensor(115.5357, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.44755253195762634
distance x is tensor(118.4371, device='cuda:0')
benign distance is  tensor(118.4371, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2643493413925171
distance x is tensor(122.4463, device='cuda:0')
benign distance is  tensor(122.4463, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.21989302337169647
distance x is tensor(136.1402, device='cuda:0')
benign distance is  tensor(136.1402, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4460591673851013
distance x is tensor(119.7654, device='cuda:0')
benign distance is  tensor(119.7654, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.38184648752212524
distance x is tensor(128.6196, device='cuda:0')
benign distance is  tensor(128.6196, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.03919531777501106
distance x is tensor(125.1582, device='cuda:0')
benign distance is  tensor(125.1582, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5649288892745972
distance x is tensor(116.5191, device='cuda:0')
benign distance is  tensor(116.5191, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.18153506517410278
distance x is tensor(121.7338, device='cuda:0')
benign distance is  tensor(121.7338, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.43499231338500977
distance x is tensor(124.4792, device='cuda:0')
benign distance is  tensor(124.4792, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 44
counter_tensor is  tensor([43., 43.,  8.,  9., 43., 40., 42.,  8., 15., 15., 15., 15., 15., 15.,
        15., 15., 15., 15., 15., 15., 36., 36., 36., 36., 36., 36., 36., 36.,
        43., 36., 16., 43., 41., 40., 42., 40.,  9., 29.,  9., 35., 43., 42.,
         0.,  8.])
count_res tensor([1.3519e-01, 1.3519e-01, 8.5240e-17, 2.3171e-16, 1.3519e-01, 6.7308e-03,
        4.9734e-02, 8.5240e-17, 9.3477e-14, 9.3477e-14, 9.3477e-14, 9.3477e-14,
        9.3477e-14, 9.3477e-14, 9.3477e-14, 9.3477e-14, 9.3477e-14, 9.3477e-14,
        9.3477e-14, 9.3477e-14, 1.2328e-04, 1.2328e-04, 1.2328e-04, 1.2328e-04,
        1.2328e-04, 1.2328e-04, 1.2328e-04, 1.2328e-04, 1.3519e-01, 1.2328e-04,
        2.5410e-13, 1.3519e-01, 1.8296e-02, 6.7308e-03, 4.9734e-02, 6.7308e-03,
        2.3171e-16, 1.1242e-07, 2.3171e-16, 4.5352e-05, 1.3519e-01, 4.9734e-02,
        2.8595e-20, 8.5240e-17])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 89.97% 

Test Accuracy: 89.11% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.03726266324520111
distance x is tensor(104.8413, device='cuda:0')
benign distance is  tensor(104.8413, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6439968347549438
distance x is tensor(112.0484, device='cuda:0')
benign distance is  tensor(112.0484, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3986685872077942
distance x is tensor(125.3200, device='cuda:0')
benign distance is  tensor(125.3200, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.21864619851112366
distance x is tensor(113.8308, device='cuda:0')
benign distance is  tensor(113.8308, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7105982899665833
distance x is tensor(95.3100, device='cuda:0')
benign distance is  tensor(95.3100, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8510808944702148
distance x is tensor(123.9305, device='cuda:0')
benign distance is  tensor(123.9305, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.41910070180892944
distance x is tensor(120.5879, device='cuda:0')
benign distance is  tensor(120.5879, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7263656854629517
distance x is tensor(125.4368, device='cuda:0')
benign distance is  tensor(125.4368, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5027332305908203
distance x is tensor(133.4282, device='cuda:0')
benign distance is  tensor(133.4282, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4487913250923157
distance x is tensor(122.0924, device='cuda:0')
benign distance is  tensor(122.0924, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6291857957839966
distance x is tensor(122.0075, device='cuda:0')
benign distance is  tensor(122.0075, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6340330243110657
distance x is tensor(122.6243, device='cuda:0')
benign distance is  tensor(122.6243, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9268602132797241
distance x is tensor(120.1974, device='cuda:0')
benign distance is  tensor(120.1974, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.11834677308797836
distance x is tensor(99.6182, device='cuda:0')
benign distance is  tensor(99.6182, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.1955123394727707
distance x is tensor(134.1879, device='cuda:0')
benign distance is  tensor(134.1879, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.47773995995521545
distance x is tensor(124.4359, device='cuda:0')
benign distance is  tensor(124.4359, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.0673794150352478
distance x is tensor(97.1808, device='cuda:0')
benign distance is  tensor(97.1808, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.284149169921875
distance x is tensor(126.0445, device='cuda:0')
benign distance is  tensor(126.0445, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.2733011841773987
distance x is tensor(121.2879, device='cuda:0')
benign distance is  tensor(121.2879, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.28228187561035156
distance x is tensor(137.4776, device='cuda:0')
benign distance is  tensor(137.4776, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8813514709472656
distance x is tensor(120.0281, device='cuda:0')
benign distance is  tensor(120.0281, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.1679368019104004
distance x is tensor(131.6253, device='cuda:0')
benign distance is  tensor(131.6253, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.31781014800071716
distance x is tensor(137.5524, device='cuda:0')
benign distance is  tensor(137.5524, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.2216637134552002
distance x is tensor(128.4888, device='cuda:0')
benign distance is  tensor(128.4888, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.6726046800613403
distance x is tensor(137.8270, device='cuda:0')
benign distance is  tensor(137.8270, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.12616445124149323
distance x is tensor(134.0234, device='cuda:0')
benign distance is  tensor(134.0234, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.3379841148853302
distance x is tensor(135.5413, device='cuda:0')
benign distance is  tensor(135.5413, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.9542816877365112
distance x is tensor(126.5885, device='cuda:0')
benign distance is  tensor(126.5885, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.31840234994888306
distance x is tensor(127.2408, device='cuda:0')
benign distance is  tensor(127.2408, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.32783958315849304
distance x is tensor(119.0043, device='cuda:0')
benign distance is  tensor(119.0043, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.2999369204044342
distance x is tensor(124.6974, device='cuda:0')
benign distance is  tensor(124.6974, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.27912360429763794
distance x is tensor(127.5145, device='cuda:0')
benign distance is  tensor(127.5145, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([19., 19., 13., 19., 17., 18., 14., 15., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([0.0644, 0.0644, 0.0002, 0.0644, 0.0087, 0.0237, 0.0004, 0.0012, 0.0644,
        0.0644, 0.0644, 0.0644, 0.0644, 0.0644, 0.0644, 0.0644, 0.0644, 0.0644,
        0.0644, 0.0644])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 10.43% 

Test Accuracy: 10.00% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.299388885498047
distance x is tensor(5492.8374, device='cuda:0')
benign distance is  tensor(5492.8374, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.300615072250366
distance x is tensor(8247.6035, device='cuda:0')
benign distance is  tensor(8247.6035, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.2990834712982178
distance x is tensor(5219.9062, device='cuda:0')
benign distance is  tensor(5219.9062, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2901244163513184
distance x is tensor(4854.7568, device='cuda:0')
benign distance is  tensor(4854.7568, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.304189920425415
distance x is tensor(5268.6958, device='cuda:0')
benign distance is  tensor(5268.6958, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.2817063331604004
distance x is tensor(5250.9155, device='cuda:0')
benign distance is  tensor(5250.9155, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.291724681854248
distance x is tensor(4335.9453, device='cuda:0')
benign distance is  tensor(4335.9453, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2888143062591553
distance x is tensor(6677.7070, device='cuda:0')
benign distance is  tensor(6677.7070, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 44
counter_tensor is  tensor([36., 36., 36., 36., 36., 36., 36., 36., 18., 18., 18., 18., 18., 18.,
        18., 18., 18., 18., 18., 18., 42., 38., 32., 17., 40.,  8., 13., 41.,
        42.,  1., 42., 37., 34., 43., 40., 34., 14., 11., 19., 28., 15., 39.,
        32., 43.])
count_res tensor([2.7029e-04, 2.7029e-04, 2.7029e-04, 2.7029e-04, 2.7029e-04, 2.7029e-04,
        2.7029e-04, 2.7029e-04, 4.1166e-12, 4.1166e-12, 4.1166e-12, 4.1166e-12,
        4.1166e-12, 4.1166e-12, 4.1166e-12, 4.1166e-12, 4.1166e-12, 4.1166e-12,
        4.1166e-12, 4.1166e-12, 1.0904e-01, 1.9972e-03, 4.9506e-06, 1.5144e-12,
        1.4758e-02, 1.8689e-16, 2.7737e-14, 4.0115e-02, 1.0904e-01, 1.7042e-19,
        1.0904e-01, 7.3474e-04, 3.6580e-05, 2.9641e-01, 1.4758e-02, 3.6580e-05,
        7.5398e-14, 3.7538e-15, 1.1190e-11, 9.0674e-08, 2.0495e-13, 5.4290e-03,
        4.9506e-06, 2.9641e-01])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 89.78% 

Test Accuracy: 89.08% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7543318271636963
distance x is tensor(103.8056, device='cuda:0')
benign distance is  tensor(103.8056, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4787900447845459
distance x is tensor(112.8120, device='cuda:0')
benign distance is  tensor(112.8120, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.17521780729293823
distance x is tensor(130.0554, device='cuda:0')
benign distance is  tensor(130.0554, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.49136772751808167
distance x is tensor(119.5723, device='cuda:0')
benign distance is  tensor(119.5723, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.636618971824646
distance x is tensor(99.9394, device='cuda:0')
benign distance is  tensor(99.9394, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3412797451019287
distance x is tensor(116.3360, device='cuda:0')
benign distance is  tensor(116.3360, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.13854488730430603
distance x is tensor(117.9715, device='cuda:0')
benign distance is  tensor(117.9715, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6780897974967957
distance x is tensor(123.1987, device='cuda:0')
benign distance is  tensor(123.1987, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.28533512353897095
distance x is tensor(131.9247, device='cuda:0')
benign distance is  tensor(131.9247, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6348199248313904
distance x is tensor(122.8294, device='cuda:0')
benign distance is  tensor(122.8294, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7290565371513367
distance x is tensor(126.3638, device='cuda:0')
benign distance is  tensor(126.3638, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7937103509902954
distance x is tensor(115.0587, device='cuda:0')
benign distance is  tensor(115.0587, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5691028833389282
distance x is tensor(115.7094, device='cuda:0')
benign distance is  tensor(115.7094, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.14745576679706573
distance x is tensor(98.8928, device='cuda:0')
benign distance is  tensor(98.8928, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4042724072933197
distance x is tensor(129.8716, device='cuda:0')
benign distance is  tensor(129.8716, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1023720502853394
distance x is tensor(104.4630, device='cuda:0')
benign distance is  tensor(104.4630, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.33403444290161133
distance x is tensor(122.6769, device='cuda:0')
benign distance is  tensor(122.6769, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4664933681488037
distance x is tensor(135.8441, device='cuda:0')
benign distance is  tensor(135.8441, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.28595393896102905
distance x is tensor(122.8000, device='cuda:0')
benign distance is  tensor(122.8000, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.18969875574111938
distance x is tensor(118.2025, device='cuda:0')
benign distance is  tensor(118.2025, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.24150457978248596
distance x is tensor(120.1218, device='cuda:0')
benign distance is  tensor(120.1218, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6246899366378784
distance x is tensor(113.0646, device='cuda:0')
benign distance is  tensor(113.0646, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.6081582903862
distance x is tensor(147.4174, device='cuda:0')
benign distance is  tensor(147.4174, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7876907587051392
distance x is tensor(123.0338, device='cuda:0')
benign distance is  tensor(123.0338, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.2628452181816101
distance x is tensor(117.6949, device='cuda:0')
benign distance is  tensor(117.6949, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.6111634969711304
distance x is tensor(113.4871, device='cuda:0')
benign distance is  tensor(113.4871, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.025398289784789085
distance x is tensor(128.5342, device='cuda:0')
benign distance is  tensor(128.5342, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.6324111819267273
distance x is tensor(132.6539, device='cuda:0')
benign distance is  tensor(132.6539, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.34763383865356445
distance x is tensor(109.9300, device='cuda:0')
benign distance is  tensor(109.9300, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.636282742023468
distance x is tensor(122.5474, device='cuda:0')
benign distance is  tensor(122.5474, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.119203805923462
distance x is tensor(126.6526, device='cuda:0')
benign distance is  tensor(126.6526, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.43987005949020386
distance x is tensor(123.5906, device='cuda:0')
benign distance is  tensor(123.5906, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([19., 14., 16., 15., 13., 18., 19., 12., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([6.9223e-02, 4.6642e-04, 3.4464e-03, 1.2679e-03, 1.7159e-04, 2.5466e-02,
        6.9223e-02, 6.3123e-05, 6.9223e-02, 6.9223e-02, 6.9223e-02, 6.9223e-02,
        6.9223e-02, 6.9223e-02, 6.9223e-02, 6.9223e-02, 6.9223e-02, 6.9223e-02,
        6.9223e-02, 6.9223e-02])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 10.43% 

Test Accuracy: 10.00% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.298003673553467
distance x is tensor(14721.7617, device='cuda:0')
benign distance is  tensor(14721.7617, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.298171043395996
distance x is tensor(14393.9990, device='cuda:0')
benign distance is  tensor(14393.9990, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.2977161407470703
distance x is tensor(12897.9971, device='cuda:0')
benign distance is  tensor(12897.9971, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.289097309112549
distance x is tensor(13872.7822, device='cuda:0')
benign distance is  tensor(13872.7822, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3077759742736816
distance x is tensor(11954.0469, device='cuda:0')
benign distance is  tensor(11954.0469, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3031933307647705
distance x is tensor(8871.3389, device='cuda:0')
benign distance is  tensor(8871.3389, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.294343948364258
distance x is tensor(10127.1387, device='cuda:0')
benign distance is  tensor(10127.1387, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2906692028045654
distance x is tensor(13234.2793, device='cuda:0')
benign distance is  tensor(13234.2793, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 36
counter_tensor is  tensor([28., 28., 28., 28., 28., 28., 28., 28., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 29., 27., 35., 23., 33., 34., 13., 35.,
         8., 24., 14.,  9.,  8., 32.,  8., 28.])
count_res tensor([3.5561e-04, 3.5561e-04, 3.5561e-04, 3.5561e-04, 3.5561e-04, 3.5561e-04,
        3.5561e-04, 3.5561e-04, 6.5133e-06, 6.5133e-06, 6.5133e-06, 6.5133e-06,
        6.5133e-06, 6.5133e-06, 6.5133e-06, 6.5133e-06, 6.5133e-06, 6.5133e-06,
        6.5133e-06, 6.5133e-06, 9.6666e-04, 1.3082e-04, 3.8998e-01, 2.3961e-06,
        5.2778e-02, 1.4346e-01, 1.0878e-10, 3.8998e-01, 7.3298e-13, 6.5133e-06,
        2.9570e-10, 1.9924e-12, 7.3298e-13, 1.9416e-02, 7.3298e-13, 3.5561e-04])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 88.28% 

Test Accuracy: 87.49% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.38870126008987427
distance x is tensor(119.1225, device='cuda:0')
benign distance is  tensor(119.1225, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5309469103813171
distance x is tensor(114.7183, device='cuda:0')
benign distance is  tensor(114.7183, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.362802654504776
distance x is tensor(132.6874, device='cuda:0')
benign distance is  tensor(132.6874, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.39239296317100525
distance x is tensor(129.7735, device='cuda:0')
benign distance is  tensor(129.7735, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5649958252906799
distance x is tensor(107.7750, device='cuda:0')
benign distance is  tensor(107.7750, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6961307525634766
distance x is tensor(143.1985, device='cuda:0')
benign distance is  tensor(143.1985, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.05260127782821655
distance x is tensor(120.6376, device='cuda:0')
benign distance is  tensor(120.6376, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4188833236694336
distance x is tensor(140.4915, device='cuda:0')
benign distance is  tensor(140.4915, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.44255226850509644
distance x is tensor(151.5008, device='cuda:0')
benign distance is  tensor(151.5008, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.2889309823513031
distance x is tensor(122.0339, device='cuda:0')
benign distance is  tensor(122.0339, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7670163512229919
distance x is tensor(126.3558, device='cuda:0')
benign distance is  tensor(126.3558, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7649589776992798
distance x is tensor(130.9538, device='cuda:0')
benign distance is  tensor(130.9538, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.47180986404418945
distance x is tensor(133.3792, device='cuda:0')
benign distance is  tensor(133.3792, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.36566802859306335
distance x is tensor(99.9912, device='cuda:0')
benign distance is  tensor(99.9912, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7032638192176819
distance x is tensor(121.9227, device='cuda:0')
benign distance is  tensor(121.9227, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5375487804412842
distance x is tensor(130.1138, device='cuda:0')
benign distance is  tensor(130.1138, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.7415167093276978
distance x is tensor(108.0400, device='cuda:0')
benign distance is  tensor(108.0400, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5890033841133118
distance x is tensor(127.4460, device='cuda:0')
benign distance is  tensor(127.4460, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.4828469753265381
distance x is tensor(109.1950, device='cuda:0')
benign distance is  tensor(109.1950, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.26217222213745117
distance x is tensor(127.4874, device='cuda:0')
benign distance is  tensor(127.4874, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8785233497619629
distance x is tensor(124.5956, device='cuda:0')
benign distance is  tensor(124.5956, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.531964123249054
distance x is tensor(128.9673, device='cuda:0')
benign distance is  tensor(128.9673, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.2506493628025055
distance x is tensor(125.3040, device='cuda:0')
benign distance is  tensor(125.3040, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.2547852098941803
distance x is tensor(114.4169, device='cuda:0')
benign distance is  tensor(114.4169, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 36
counter_tensor is  tensor([35., 34., 24., 19., 33., 35., 31.,  0., 13., 13., 13., 13., 13., 13.,
        13., 13., 13., 13., 13., 13., 28., 29., 35., 31., 35., 35., 30., 34.,
        35., 34., 29., 35., 34.,  1., 11.,  5.])
count_res tensor([1.1553e-01, 4.2499e-02, 1.9295e-06, 1.3001e-08, 1.5635e-02, 1.1553e-01,
        2.1159e-03, 7.2840e-17, 3.2225e-11, 3.2225e-11, 3.2225e-11, 3.2225e-11,
        3.2225e-11, 3.2225e-11, 3.2225e-11, 3.2225e-11, 3.2225e-11, 3.2225e-11,
        3.2225e-11, 3.2225e-11, 1.0535e-04, 2.8636e-04, 1.1553e-01, 2.1159e-03,
        1.1553e-01, 1.1553e-01, 7.7840e-04, 4.2499e-02, 1.1553e-01, 4.2499e-02,
        2.8636e-04, 1.1553e-01, 4.2499e-02, 1.9800e-16, 4.3612e-12, 1.0810e-14])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 90.02% 

Test Accuracy: 89.39% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.23222236335277557
distance x is tensor(88.9411, device='cuda:0')
benign distance is  tensor(88.9411, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7913731336593628
distance x is tensor(113.2937, device='cuda:0')
benign distance is  tensor(113.2937, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1542024314403534
distance x is tensor(127.1051, device='cuda:0')
benign distance is  tensor(127.1051, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.47379574179649353
distance x is tensor(114.7817, device='cuda:0')
benign distance is  tensor(114.7817, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6505898237228394
distance x is tensor(96.7424, device='cuda:0')
benign distance is  tensor(96.7424, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7802382707595825
distance x is tensor(120.9274, device='cuda:0')
benign distance is  tensor(120.9274, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1777917593717575
distance x is tensor(114.3740, device='cuda:0')
benign distance is  tensor(114.3740, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4049686789512634
distance x is tensor(122.0982, device='cuda:0')
benign distance is  tensor(122.0982, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4141792356967926
distance x is tensor(121.5303, device='cuda:0')
benign distance is  tensor(121.5303, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.724108099937439
distance x is tensor(138.5419, device='cuda:0')
benign distance is  tensor(138.5419, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.25825023651123047
distance x is tensor(128.4525, device='cuda:0')
benign distance is  tensor(128.4525, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.310371458530426
distance x is tensor(115.3464, device='cuda:0')
benign distance is  tensor(115.3464, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3588997721672058
distance x is tensor(119.4259, device='cuda:0')
benign distance is  tensor(119.4259, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.664648175239563
distance x is tensor(117.0705, device='cuda:0')
benign distance is  tensor(117.0705, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.657777726650238
distance x is tensor(118.9319, device='cuda:0')
benign distance is  tensor(118.9319, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3832734525203705
distance x is tensor(132.0502, device='cuda:0')
benign distance is  tensor(132.0502, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.44988173246383667
distance x is tensor(136.2943, device='cuda:0')
benign distance is  tensor(136.2943, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.06984920054674149
distance x is tensor(135.7211, device='cuda:0')
benign distance is  tensor(135.7211, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5468345880508423
distance x is tensor(130.2638, device='cuda:0')
benign distance is  tensor(130.2638, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.18923409283161163
distance x is tensor(133.8690, device='cuda:0')
benign distance is  tensor(133.8690, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.31630414724349976
distance x is tensor(118.7722, device='cuda:0')
benign distance is  tensor(118.7722, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8005781173706055
distance x is tensor(125.7828, device='cuda:0')
benign distance is  tensor(125.7828, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.4490912854671478
distance x is tensor(117.9562, device='cuda:0')
benign distance is  tensor(117.9562, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.1173742413520813
distance x is tensor(118.5064, device='cuda:0')
benign distance is  tensor(118.5064, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([26., 23., 17., 26., 27., 24., 18., 25., 27., 27., 27., 27., 27., 27.,
        27., 27., 27., 27., 27., 27., 21., 24., 17., 18., 13., 27., 26., 16.])
count_res tensor([2.3951e-02, 1.1924e-03, 2.9558e-06, 2.3951e-02, 6.5105e-02, 3.2414e-03,
        8.0347e-06, 8.8111e-03, 6.5105e-02, 6.5105e-02, 6.5105e-02, 6.5105e-02,
        6.5105e-02, 6.5105e-02, 6.5105e-02, 6.5105e-02, 6.5105e-02, 6.5105e-02,
        6.5105e-02, 6.5105e-02, 1.6138e-04, 3.2414e-03, 2.9558e-06, 8.0347e-06,
        5.4137e-08, 6.5105e-02, 2.3951e-02, 1.0874e-06])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 10.43% 

Test Accuracy: 10.00% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.294726610183716
distance x is tensor(6668.8223, device='cuda:0')
benign distance is  tensor(6668.8223, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.2963290214538574
distance x is tensor(7272.3179, device='cuda:0')
benign distance is  tensor(7272.3179, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.29866099357605
distance x is tensor(4764.1396, device='cuda:0')
benign distance is  tensor(4764.1396, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.291348695755005
distance x is tensor(5243.8608, device='cuda:0')
benign distance is  tensor(5243.8608, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3056116104125977
distance x is tensor(6692.7300, device='cuda:0')
benign distance is  tensor(6692.7300, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3033714294433594
distance x is tensor(6635.4126, device='cuda:0')
benign distance is  tensor(6635.4126, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2887351512908936
distance x is tensor(5323.3818, device='cuda:0')
benign distance is  tensor(5323.3818, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.292841672897339
distance x is tensor(10980.2314, device='cuda:0')
benign distance is  tensor(10980.2314, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.3117709159851074
distance x is tensor(9750.5889, device='cuda:0')
benign distance is  tensor(9750.5889, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.338148832321167
distance x is tensor(6773.3164, device='cuda:0')
benign distance is  tensor(6773.3164, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.2919039726257324
distance x is tensor(6761.9761, device='cuda:0')
benign distance is  tensor(6761.9761, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.3015313148498535
distance x is tensor(8849.9336, device='cuda:0')
benign distance is  tensor(8849.9336, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.314924478530884
distance x is tensor(9544.5000, device='cuda:0')
benign distance is  tensor(9544.5000, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.293039560317993
distance x is tensor(6830.1362, device='cuda:0')
benign distance is  tensor(6830.1362, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.2969298362731934
distance x is tensor(8603.7910, device='cuda:0')
benign distance is  tensor(8603.7910, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.2786965370178223
distance x is tensor(7494.2725, device='cuda:0')
benign distance is  tensor(7494.2725, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([7.5944e-05, 7.5944e-05, 7.5944e-05, 7.5944e-05, 7.5944e-05, 7.5944e-05,
        7.5944e-05, 7.5944e-05, 8.3283e-02, 8.3283e-02, 8.3283e-02, 8.3283e-02,
        8.3283e-02, 8.3283e-02, 8.3283e-02, 8.3283e-02, 8.3283e-02, 8.3283e-02,
        8.3283e-02, 8.3283e-02])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 10.43% 

Test Accuracy: 10.00% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.4373137950897217
distance x is tensor(4.9434e+10, device='cuda:0')
benign distance is  tensor(4.9434e+10, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.1742336750030518
distance x is tensor(1.4875e+09, device='cuda:0')
benign distance is  tensor(1.4875e+09, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3095412254333496
distance x is tensor(4.5716e+11, device='cuda:0')
benign distance is  tensor(4.5716e+11, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.3919155597686768
distance x is tensor(1.7368e+09, device='cuda:0')
benign distance is  tensor(1.7368e+09, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.313220977783203
distance x is tensor(1.6986e+11, device='cuda:0')
benign distance is  tensor(1.6986e+11, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3192694187164307
distance x is tensor(2.6605e+11, device='cuda:0')
benign distance is  tensor(2.6605e+11, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.4097495079040527
distance x is tensor(1.6856e+09, device='cuda:0')
benign distance is  tensor(1.6856e+09, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.6526527404785156
distance x is tensor(2.0495e+09, device='cuda:0')
benign distance is  tensor(2.0495e+09, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 52
counter_tensor is  tensor([36., 36., 36., 36., 36., 36., 36., 36., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 42., 16., 32., 51., 17., 16., 16., 50.,
        16., 50., 51., 51.,  0.,  0., 17., 21., 35.,  6., 16., 51., 51., 50.,
        51., 16., 36., 36., 36., 36., 36., 36., 36., 36.])
count_res tensor([4.3062e-08, 4.3062e-08, 4.3062e-08, 4.3062e-08, 4.3062e-08, 4.3062e-08,
        4.3062e-08, 4.3062e-08, 8.8757e-17, 8.8757e-17, 8.8757e-17, 8.8757e-17,
        8.8757e-17, 8.8757e-17, 8.8757e-17, 8.8757e-17, 8.8757e-17, 8.8757e-17,
        8.8757e-17, 8.8757e-17, 1.7372e-05, 8.8757e-17, 7.8871e-10, 1.4077e-01,
        2.4127e-16, 8.8757e-17, 8.8757e-17, 5.1787e-02, 8.8757e-17, 5.1787e-02,
        1.4077e-01, 1.4077e-01, 9.9883e-24, 9.9883e-24, 2.4127e-16, 1.3173e-14,
        1.5842e-08, 4.0296e-21, 8.8757e-17, 1.4077e-01, 1.4077e-01, 5.1787e-02,
        1.4077e-01, 8.8757e-17, 4.3062e-08, 4.3062e-08, 4.3062e-08, 4.3062e-08,
        4.3062e-08, 4.3062e-08, 4.3062e-08, 4.3062e-08])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 11.83% 

Test Accuracy: 11.48% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3595856726169586
distance x is tensor(110.8140, device='cuda:0')
benign distance is  tensor(110.8140, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.48270711302757263
distance x is tensor(103.4621, device='cuda:0')
benign distance is  tensor(103.4621, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6010645627975464
distance x is tensor(103.4520, device='cuda:0')
benign distance is  tensor(103.4520, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6888930201530457
distance x is tensor(103.3046, device='cuda:0')
benign distance is  tensor(103.3046, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8344284892082214
distance x is tensor(103.9257, device='cuda:0')
benign distance is  tensor(103.9257, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5406451225280762
distance x is tensor(104.1368, device='cuda:0')
benign distance is  tensor(104.1368, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7437146306037903
distance x is tensor(104.6794, device='cuda:0')
benign distance is  tensor(104.6794, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5685034990310669
distance x is tensor(116.3133, device='cuda:0')
benign distance is  tensor(116.3133, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6851948499679565
distance x is tensor(105.7554, device='cuda:0')
benign distance is  tensor(105.7554, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5681033730506897
distance x is tensor(104.2376, device='cuda:0')
benign distance is  tensor(104.2376, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.469463586807251
distance x is tensor(113.0929, device='cuda:0')
benign distance is  tensor(113.0929, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.811865508556366
distance x is tensor(114.2509, device='cuda:0')
benign distance is  tensor(114.2509, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4547666609287262
distance x is tensor(96.5440, device='cuda:0')
benign distance is  tensor(96.5440, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5806262493133545
distance x is tensor(111.2185, device='cuda:0')
benign distance is  tensor(111.2185, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.49844256043434143
distance x is tensor(107.9312, device='cuda:0')
benign distance is  tensor(107.9312, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4803350567817688
distance x is tensor(106.2355, device='cuda:0')
benign distance is  tensor(106.2355, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.6689846515655518
distance x is tensor(105.0977, device='cuda:0')
benign distance is  tensor(105.0977, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5376830101013184
distance x is tensor(104.5802, device='cuda:0')
benign distance is  tensor(104.5802, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.7259364724159241
distance x is tensor(107.1681, device='cuda:0')
benign distance is  tensor(107.1681, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8822982907295227
distance x is tensor(108.8246, device='cuda:0')
benign distance is  tensor(108.8246, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5264734029769897
distance x is tensor(108.7024, device='cuda:0')
benign distance is  tensor(108.7024, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4644092619419098
distance x is tensor(107.7603, device='cuda:0')
benign distance is  tensor(107.7603, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3752952218055725
distance x is tensor(113.8571, device='cuda:0')
benign distance is  tensor(113.8571, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7835533618927002
distance x is tensor(112.6367, device='cuda:0')
benign distance is  tensor(112.6367, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.8973185420036316
distance x is tensor(121.9101, device='cuda:0')
benign distance is  tensor(121.9101, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6029974222183228
distance x is tensor(110.2034, device='cuda:0')
benign distance is  tensor(110.2034, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5207384824752808
distance x is tensor(107.3363, device='cuda:0')
benign distance is  tensor(107.3363, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5499626398086548
distance x is tensor(109.2987, device='cuda:0')
benign distance is  tensor(109.2987, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7017470598220825
distance x is tensor(112.5210, device='cuda:0')
benign distance is  tensor(112.5210, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.65003502368927
distance x is tensor(110.3472, device='cuda:0')
benign distance is  tensor(110.3472, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7186118364334106
distance x is tensor(108.5969, device='cuda:0')
benign distance is  tensor(108.5969, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.4907570481300354
distance x is tensor(107.3922, device='cuda:0')
benign distance is  tensor(107.3922, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.8943939208984375
distance x is tensor(116.8588, device='cuda:0')
benign distance is  tensor(116.8588, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.9486888647079468
distance x is tensor(102.9266, device='cuda:0')
benign distance is  tensor(102.9266, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.5635625123977661
distance x is tensor(107.4640, device='cuda:0')
benign distance is  tensor(107.4640, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.4193076491355896
distance x is tensor(107.9586, device='cuda:0')
benign distance is  tensor(107.9586, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6718577742576599
distance x is tensor(106.3405, device='cuda:0')
benign distance is  tensor(106.3405, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5976222157478333
distance x is tensor(111.9689, device='cuda:0')
benign distance is  tensor(111.9689, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6658638715744019
distance x is tensor(116.7153, device='cuda:0')
benign distance is  tensor(116.7153, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5806307196617126
distance x is tensor(101.3960, device='cuda:0')
benign distance is  tensor(101.3960, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([13., 12., 12., 14., 12., 12., 13., 12., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([2.0628e-04, 7.5887e-05, 7.5887e-05, 5.6074e-04, 7.5887e-05, 7.5887e-05,
        2.0628e-04, 7.5887e-05, 8.3221e-02, 8.3221e-02, 8.3221e-02, 8.3221e-02,
        8.3221e-02, 8.3221e-02, 8.3221e-02, 8.3221e-02, 8.3221e-02, 8.3221e-02,
        8.3221e-02, 8.3221e-02])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 9.95% 

Test Accuracy: 9.88% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:0')
benign distance is  tensor(nan, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.3010120391845703
distance x is tensor(6.8537e+09, device='cuda:0')
benign distance is  tensor(6.8537e+09, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:0')
benign distance is  tensor(nan, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2912087440490723
distance x is tensor(2.6812e+09, device='cuda:0')
benign distance is  tensor(2.6812e+09, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.300349712371826
distance x is tensor(12704798., device='cuda:0')
benign distance is  tensor(12704798., device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.310927152633667
distance x is tensor(96364192., device='cuda:0')
benign distance is  tensor(96364192., device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:0')
benign distance is  tensor(nan, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.291689872741699
distance x is tensor(10423908., device='cuda:0')
benign distance is  tensor(10423908., device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 36
counter_tensor is  tensor([ 0., 27.,  0., 27., 27., 27.,  0., 27., 13., 13., 13.,  0., 13., 13.,
        13., 13., 13., 13., 13., 13., 12., 10., 31.,  7., 13., 13., 30., 14.,
        19., 19., 19., 19., 19., 19., 20., 19.])
count_res tensor([2.3586e-14, 1.2549e-02, 2.3586e-14, 1.2549e-02, 1.2549e-02, 1.2549e-02,
        2.3586e-14, 1.2549e-02, 1.0435e-08, 1.0435e-08, 1.0435e-08, 2.3586e-14,
        1.0435e-08, 1.0435e-08, 1.0435e-08, 1.0435e-08, 1.0435e-08, 1.0435e-08,
        1.0435e-08, 1.0435e-08, 3.8388e-09, 5.1953e-10, 6.8516e-01, 2.5866e-11,
        1.0435e-08, 1.0435e-08, 2.5206e-01, 2.8365e-08, 4.2098e-06, 4.2098e-06,
        4.2098e-06, 4.2098e-06, 4.2098e-06, 4.2098e-06, 1.1443e-05, 4.2098e-06])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 9.71%
|----0th round Training Accuracy : 10.48%
|----1th round Training Accuracy : 10.43%
|----2th round Training Accuracy : 10.20%
|----3th round Training Accuracy : 70.18%
|----4th round Training Accuracy : 10.43%
|----5th round Training Accuracy : 88.76%
|----6th round Training Accuracy : 11.18%
|----7th round Training Accuracy : 87.02%
|----8th round Training Accuracy : 10.43%
|----9th round Training Accuracy : 87.47%
|----10th round Training Accuracy : 10.43%
|----11th round Training Accuracy : 89.22%
|----12th round Training Accuracy : 10.43%
|----13th round Training Accuracy : 88.90%
|----14th round Training Accuracy : 89.33%
|----15th round Training Accuracy : 89.63%
|----16th round Training Accuracy : 10.43%
|----17th round Training Accuracy : 88.82%
|----18th round Training Accuracy : 10.43%
|----19th round Training Accuracy : 89.36%
|----20th round Training Accuracy : 89.50%
|----21th round Training Accuracy : 89.87%
|----22th round Training Accuracy : 10.43%
|----23th round Training Accuracy : 89.72%
|----24th round Training Accuracy : 10.43%
|----25th round Training Accuracy : 10.43%
|----26th round Training Accuracy : 5.35%
|----27th round Training Accuracy : 83.32%
|----28th round Training Accuracy : 10.43%
|----29th round Training Accuracy : 89.43%
|----30th round Training Accuracy : 10.43%
|----31th round Training Accuracy : 89.78%
|----32th round Training Accuracy : 89.73%
|----33th round Training Accuracy : 89.78%
|----34th round Training Accuracy : 10.43%
|----35th round Training Accuracy : 89.88%
|----36th round Training Accuracy : 10.43%
|----37th round Training Accuracy : 89.17%
|----38th round Training Accuracy : 89.97%
|----39th round Training Accuracy : 89.97%
|----40th round Training Accuracy : 10.43%
|----41th round Training Accuracy : 89.78%
|----42th round Training Accuracy : 10.43%
|----43th round Training Accuracy : 88.28%
|----44th round Training Accuracy : 90.02%
|----45th round Training Accuracy : 10.43%
|----46th round Training Accuracy : 10.43%
|----47th round Training Accuracy : 11.83%
|----48th round Training Accuracy : 9.95%
|----49th round Training Accuracy : 9.71%
|----Final Test Accuracy: 10.00%
|----0th round Final Test Accuracy : 10.03%
|----1th round Final Test Accuracy : 10.00%
|----2th round Final Test Accuracy : 9.99%
|----3th round Final Test Accuracy : 69.94%
|----4th round Final Test Accuracy : 10.00%
|----5th round Final Test Accuracy : 88.24%
|----6th round Final Test Accuracy : 10.59%
|----7th round Final Test Accuracy : 86.28%
|----8th round Final Test Accuracy : 10.00%
|----9th round Final Test Accuracy : 86.93%
|----10th round Final Test Accuracy : 10.00%
|----11th round Final Test Accuracy : 88.19%
|----12th round Final Test Accuracy : 10.00%
|----13th round Final Test Accuracy : 87.89%
|----14th round Final Test Accuracy : 88.58%
|----15th round Final Test Accuracy : 88.65%
|----16th round Final Test Accuracy : 10.00%
|----17th round Final Test Accuracy : 87.96%
|----18th round Final Test Accuracy : 10.00%
|----19th round Final Test Accuracy : 88.47%
|----20th round Final Test Accuracy : 89.03%
|----21th round Final Test Accuracy : 88.81%
|----22th round Final Test Accuracy : 10.00%
|----23th round Final Test Accuracy : 89.06%
|----24th round Final Test Accuracy : 10.00%
|----25th round Final Test Accuracy : 10.00%
|----26th round Final Test Accuracy : 4.95%
|----27th round Final Test Accuracy : 82.53%
|----28th round Final Test Accuracy : 10.00%
|----29th round Final Test Accuracy : 88.20%
|----30th round Final Test Accuracy : 10.00%
|----31th round Final Test Accuracy : 88.60%
|----32th round Final Test Accuracy : 88.85%
|----33th round Final Test Accuracy : 88.93%
|----34th round Final Test Accuracy : 10.00%
|----35th round Final Test Accuracy : 88.68%
|----36th round Final Test Accuracy : 10.00%
|----37th round Final Test Accuracy : 88.53%
|----38th round Final Test Accuracy : 89.04%
|----39th round Final Test Accuracy : 89.11%
|----40th round Final Test Accuracy : 10.00%
|----41th round Final Test Accuracy : 89.08%
|----42th round Final Test Accuracy : 10.00%
|----43th round Final Test Accuracy : 87.49%
|----44th round Final Test Accuracy : 89.39%
|----45th round Final Test Accuracy : 10.00%
|----46th round Final Test Accuracy : 10.00%
|----47th round Final Test Accuracy : 11.48%
|----48th round Final Test Accuracy : 9.88%
|----49th round Final Test Accuracy : 10.00%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     None of attack is done!


 Total Run Time: 3384.4441
