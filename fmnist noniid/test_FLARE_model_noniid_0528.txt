
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     None of attack is done!

attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7123423833400011
distance x is tensor(122.8636, device='cuda:0')
benign distance is  tensor(122.8636, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.871001485735178
distance x is tensor(110.1063, device='cuda:0')
benign distance is  tensor(110.1063, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5376510992646217
distance x is tensor(108.2308, device='cuda:0')
benign distance is  tensor(108.2308, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9827605094760656
distance x is tensor(159.7725, device='cuda:0')
benign distance is  tensor(159.7725, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8266419935971498
distance x is tensor(102.5354, device='cuda:0')
benign distance is  tensor(102.5354, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.712595924269408
distance x is tensor(98.0458, device='cuda:0')
benign distance is  tensor(98.0458, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0754376836121082
distance x is tensor(112.1478, device='cuda:0')
benign distance is  tensor(112.1478, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6646759863942862
distance x is tensor(83.9328, device='cuda:0')
benign distance is  tensor(83.9328, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7777662016451359
distance x is tensor(115.5573, device='cuda:0')
benign distance is  tensor(115.5573, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7105397875420749
distance x is tensor(127.3510, device='cuda:0')
benign distance is  tensor(127.3510, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.147868750616908
distance x is tensor(92.4455, device='cuda:0')
benign distance is  tensor(92.4455, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4117972888052464
distance x is tensor(123.0175, device='cuda:0')
benign distance is  tensor(123.0175, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1244312822818756
distance x is tensor(162.8657, device='cuda:0')
benign distance is  tensor(162.8657, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6151170209050179
distance x is tensor(67.0662, device='cuda:0')
benign distance is  tensor(67.0662, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8532660957425833
distance x is tensor(145.4600, device='cuda:0')
benign distance is  tensor(145.4600, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1035456620156765
distance x is tensor(134.2259, device='cuda:0')
benign distance is  tensor(134.2259, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.4551476687192917
distance x is tensor(127.0411, device='cuda:0')
benign distance is  tensor(127.0411, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6182012557983398
distance x is tensor(114.6127, device='cuda:0')
benign distance is  tensor(114.6127, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9517539236694574
distance x is tensor(118.9898, device='cuda:0')
benign distance is  tensor(118.9898, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7085816394537687
distance x is tensor(117.7707, device='cuda:0')
benign distance is  tensor(117.7707, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0409556003287435
distance x is tensor(86.4199, device='cuda:0')
benign distance is  tensor(86.4199, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6712086591869593
distance x is tensor(209.1092, device='cuda:0')
benign distance is  tensor(209.1092, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1761133447289467
distance x is tensor(154.1537, device='cuda:0')
benign distance is  tensor(154.1537, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6400802033022046
distance x is tensor(111.8595, device='cuda:0')
benign distance is  tensor(111.8595, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.8964809719473124
distance x is tensor(139.8126, device='cuda:0')
benign distance is  tensor(139.8126, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5550822652876377
distance x is tensor(77.5736, device='cuda:0')
benign distance is  tensor(77.5736, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.0264240689575672
distance x is tensor(138.6175, device='cuda:0')
benign distance is  tensor(138.6175, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.1894213035702705
distance x is tensor(116.1385, device='cuda:0')
benign distance is  tensor(116.1385, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7334363777190447
distance x is tensor(126.4239, device='cuda:0')
benign distance is  tensor(126.4239, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8750167917460203
distance x is tensor(136.7998, device='cuda:0')
benign distance is  tensor(136.7998, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.49082621838897467
distance x is tensor(107.8026, device='cuda:0')
benign distance is  tensor(107.8026, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.759638074785471
distance x is tensor(170.7803, device='cuda:0')
benign distance is  tensor(170.7803, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7058832235634327
distance x is tensor(116.2752, device='cuda:0')
benign distance is  tensor(116.2752, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.7524204701185226
distance x is tensor(104.9919, device='cuda:0')
benign distance is  tensor(104.9919, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5666747456416488
distance x is tensor(148.0177, device='cuda:0')
benign distance is  tensor(148.0177, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.4137140847742558
distance x is tensor(120.4126, device='cuda:0')
benign distance is  tensor(120.4126, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8313265163451433
distance x is tensor(113.9526, device='cuda:0')
benign distance is  tensor(113.9526, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8085254672914743
distance x is tensor(82.4350, device='cuda:0')
benign distance is  tensor(82.4350, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7391406055539846
distance x is tensor(99.0537, device='cuda:0')
benign distance is  tensor(99.0537, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8229596689343452
distance x is tensor(124.3112, device='cuda:0')
benign distance is  tensor(124.3112, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.185599647462368
distance x is tensor(108.7754, device='cuda:0')
benign distance is  tensor(108.7754, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.1348627656698227
distance x is tensor(138.9426, device='cuda:0')
benign distance is  tensor(138.9426, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.1761855855584145
distance x is tensor(145.5676, device='cuda:0')
benign distance is  tensor(145.5676, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.9552089087665081
distance x is tensor(102.5538, device='cuda:0')
benign distance is  tensor(102.5538, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5226169377565384
distance x is tensor(152.3791, device='cuda:0')
benign distance is  tensor(152.3791, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7021470470353961
distance x is tensor(139.4241, device='cuda:0')
benign distance is  tensor(139.4241, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6901939734816551
distance x is tensor(104.2348, device='cuda:0')
benign distance is  tensor(104.2348, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.629851434379816
distance x is tensor(133.2489, device='cuda:0')
benign distance is  tensor(133.2489, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 569.0983,  506.0601,  500.4859,  725.7419,  470.0196,  443.5473,
         521.1371,  383.1544, 3938.1785, 3988.2112, 3958.0669, 3958.3113,
        3950.4280, 3964.7517, 3978.0488, 3956.3032, 3981.9597, 3957.6897,
        3959.5085, 4012.4856], device='cuda:0')
sorted_norm is   tensor([ 383.1544,  443.5473,  470.0196,  500.4859,  506.0601,  521.1371,
         569.0983,  725.7419, 3938.1785, 3950.4280, 3956.3032, 3957.6897,
        3958.0669, 3958.3113, 3959.5085, 3964.7517, 3978.0488, 3981.9597,
        3988.2112, 4012.4856], device='cuda:0')
used idx is  tensor([ 7,  5,  4,  2,  1,  6,  0,  3,  8, 12, 15, 17, 10, 11, 18, 13],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.3377303257584572
distance x is tensor(120.2175, device='cuda:0')
benign distance is  tensor(120.2175, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.9771807119250298
distance x is tensor(79.6409, device='cuda:0')
benign distance is  tensor(79.6409, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.928713709115982
distance x is tensor(51.2273, device='cuda:0')
benign distance is  tensor(51.2273, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.848762884736061
distance x is tensor(119.2487, device='cuda:0')
benign distance is  tensor(119.2487, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.8916109651327133
distance x is tensor(76.3644, device='cuda:0')
benign distance is  tensor(76.3644, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.002463184297085
distance x is tensor(55.3474, device='cuda:0')
benign distance is  tensor(55.3474, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.531302809715271
distance x is tensor(97.0693, device='cuda:0')
benign distance is  tensor(97.0693, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.385605573654175
distance x is tensor(63.0088, device='cuda:0')
benign distance is  tensor(63.0088, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 721.7891,  524.3525,  380.2587,  706.4276,  574.2924,  406.1943,
         586.7238,  456.2971,  360.9151,  641.2365,  615.5000,  645.7852,
         578.1951,  512.8257,  634.5953,  561.3762,  544.4687,  633.9578,
         590.0910,  682.5210, 2032.8458, 2063.4355, 2006.1644, 2037.9838,
        2116.0803, 1985.7196, 2075.4783, 2056.1562], device='cuda:0')
sorted_norm is   tensor([ 360.9151,  380.2587,  406.1943,  456.2971,  512.8257,  524.3525,
         544.4687,  561.3762,  574.2924,  578.1951,  586.7238,  590.0910,
         615.5000,  633.9578,  634.5953,  641.2365,  645.7852,  682.5210,
         706.4276,  721.7891, 1985.7196, 2006.1644, 2032.8458, 2037.9838,
        2056.1562, 2063.4355, 2075.4783, 2116.0803], device='cuda:0')
used idx is  tensor([ 8,  2,  5,  7, 13,  1, 16, 15,  4, 12,  6, 18, 10, 17, 14,  9, 11, 19,
         3,  0, 25, 22], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9898079484701157
distance x is tensor(142.7238, device='cuda:0')
benign distance is  tensor(142.7238, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.198885127902031
distance x is tensor(90.3562, device='cuda:0')
benign distance is  tensor(90.3562, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.650246098637581
distance x is tensor(66.2459, device='cuda:0')
benign distance is  tensor(66.2459, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.3529172390699387
distance x is tensor(141.3774, device='cuda:0')
benign distance is  tensor(141.3774, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.1566642224788666
distance x is tensor(117.1776, device='cuda:0')
benign distance is  tensor(117.1776, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.7962657064199448
distance x is tensor(77.2425, device='cuda:0')
benign distance is  tensor(77.2425, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.196427695453167
distance x is tensor(111.2146, device='cuda:0')
benign distance is  tensor(111.2146, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.050240345299244
distance x is tensor(93.1704, device='cuda:0')
benign distance is  tensor(93.1704, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.6472233086824417
distance x is tensor(98.2463, device='cuda:0')
benign distance is  tensor(98.2463, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.5097021460533142
distance x is tensor(118.2686, device='cuda:0')
benign distance is  tensor(118.2686, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.1535630971193314
distance x is tensor(104.2385, device='cuda:0')
benign distance is  tensor(104.2385, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.6410239413380623
distance x is tensor(114.6960, device='cuda:0')
benign distance is  tensor(114.6960, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.312890700995922
distance x is tensor(138.4622, device='cuda:0')
benign distance is  tensor(138.4622, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.032827392220497
distance x is tensor(63.4951, device='cuda:0')
benign distance is  tensor(63.4951, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.7481406480073929
distance x is tensor(126.5998, device='cuda:0')
benign distance is  tensor(126.5998, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  5.377782806754112
distance x is tensor(128.9145, device='cuda:0')
benign distance is  tensor(128.9145, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 677.3932,  497.2571,  407.9769,  694.0552,  555.6426,  429.9939,
         584.0236,  496.0168,  644.9079,  780.2228,  684.8586,  762.9667,
         682.9352,  643.6830,  784.0530,  664.8101,  712.6661,  710.3441,
         725.1014,  839.3631, 1875.2861, 1863.2540, 1870.7711, 1878.5439,
        1828.0424, 2044.9395, 1925.7964, 1868.6567], device='cuda:0')
sorted_norm is   tensor([ 407.9769,  429.9939,  496.0168,  497.2571,  555.6426,  584.0236,
         643.6830,  644.9079,  664.8101,  677.3932,  682.9352,  684.8586,
         694.0552,  710.3441,  712.6661,  725.1014,  762.9667,  780.2228,
         784.0530,  839.3631, 1828.0424, 1863.2540, 1868.6567, 1870.7711,
        1875.2861, 1878.5439, 1925.7964, 2044.9395], device='cuda:0')
used idx is  tensor([ 2,  5,  7,  1,  4,  6, 13,  8, 15,  0, 12, 10,  3, 17, 16, 18, 11,  9,
        14, 19, 24, 21], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2359697073698044
distance x is tensor(116.9229, device='cuda:0')
benign distance is  tensor(116.9229, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.5181652531027794
distance x is tensor(67.8032, device='cuda:0')
benign distance is  tensor(67.8032, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.165572836995125
distance x is tensor(25.7821, device='cuda:0')
benign distance is  tensor(25.7821, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.4080407842993736
distance x is tensor(103.1938, device='cuda:0')
benign distance is  tensor(103.1938, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.549414873123169
distance x is tensor(66.8980, device='cuda:0')
benign distance is  tensor(66.8980, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.144482411444187
distance x is tensor(38.9882, device='cuda:0')
benign distance is  tensor(38.9882, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.614123836159706
distance x is tensor(75.9210, device='cuda:0')
benign distance is  tensor(75.9210, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.3949458450078964
distance x is tensor(54.0054, device='cuda:0')
benign distance is  tensor(54.0054, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.945974573493004
distance x is tensor(62.7241, device='cuda:0')
benign distance is  tensor(62.7241, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.101597025990486
distance x is tensor(70.2376, device='cuda:0')
benign distance is  tensor(70.2376, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  3.026317536830902
distance x is tensor(67.6009, device='cuda:0')
benign distance is  tensor(67.6009, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  3.153009980916977
distance x is tensor(92.8580, device='cuda:0')
benign distance is  tensor(92.8580, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.4185278713703156
distance x is tensor(65.9343, device='cuda:0')
benign distance is  tensor(65.9343, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.5594352036714554
distance x is tensor(130.0758, device='cuda:0')
benign distance is  tensor(130.0758, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.4306505843997
distance x is tensor(126.7366, device='cuda:0')
benign distance is  tensor(126.7366, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.7301115244627
distance x is tensor(103.3790, device='cuda:0')
benign distance is  tensor(103.3790, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 728.2401,  516.0055,  342.6518,  688.8329,  521.0094,  331.6593,
         568.7477,  456.5299,  408.9559,  696.0671,  609.6193,  654.2780,
         611.2648,  552.6409,  671.3840,  606.9904,  570.2687,  645.2195,
         635.2844,  684.6143, 1950.9003, 1871.6263, 1945.0542, 1915.6547,
        1931.9423, 1941.6891, 1905.5046, 2012.8058,  574.3267,  643.6431,
         578.6334,  648.9561,  722.2067,  425.2743,  683.8990,  690.4201],
       device='cuda:0')
sorted_norm is   tensor([ 331.6593,  342.6518,  408.9559,  425.2743,  456.5299,  516.0055,
         521.0094,  552.6409,  568.7477,  570.2687,  574.3267,  578.6334,
         606.9904,  609.6193,  611.2648,  635.2844,  643.6431,  645.2195,
         648.9561,  654.2780,  671.3840,  683.8990,  684.6143,  688.8329,
         690.4201,  696.0671,  722.2067,  728.2401, 1871.6263, 1905.5046,
        1915.6547, 1931.9423, 1941.6891, 1945.0542, 1950.9003, 2012.8058],
       device='cuda:0')
used idx is  tensor([ 5,  2,  8, 33,  7,  1,  4, 13,  6, 16, 28, 30, 15, 10, 12, 18, 29, 17,
        31, 11, 14, 34, 19,  3, 35,  9, 32,  0], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9542726241052151
distance x is tensor(154.7513, device='cuda:0')
benign distance is  tensor(154.7513, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.4311152771115303
distance x is tensor(101.0406, device='cuda:0')
benign distance is  tensor(101.0406, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.203770160675049
distance x is tensor(82.1565, device='cuda:0')
benign distance is  tensor(82.1565, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.8312553763389587
distance x is tensor(141.6148, device='cuda:0')
benign distance is  tensor(141.6148, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.2117667347192764
distance x is tensor(115.6788, device='cuda:0')
benign distance is  tensor(115.6788, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.9720276221632957
distance x is tensor(99.4122, device='cuda:0')
benign distance is  tensor(99.4122, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.802631914615631
distance x is tensor(118.2808, device='cuda:0')
benign distance is  tensor(118.2808, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.56131874024868
distance x is tensor(104.2868, device='cuda:0')
benign distance is  tensor(104.2868, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.696091890335083
distance x is tensor(110.3086, device='cuda:0')
benign distance is  tensor(110.3086, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.038428343832493
distance x is tensor(129.2727, device='cuda:0')
benign distance is  tensor(129.2727, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.882002964615822
distance x is tensor(107.6895, device='cuda:0')
benign distance is  tensor(107.6895, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.635532528162003
distance x is tensor(126.6461, device='cuda:0')
benign distance is  tensor(126.6461, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.0225507766008377
distance x is tensor(142.4610, device='cuda:0')
benign distance is  tensor(142.4610, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.9984122216701508
distance x is tensor(93.5151, device='cuda:0')
benign distance is  tensor(93.5151, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.9744169265031815
distance x is tensor(152.9998, device='cuda:0')
benign distance is  tensor(152.9998, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.63502736389637
distance x is tensor(139.3853, device='cuda:0')
benign distance is  tensor(139.3853, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.67213723808527
distance x is tensor(133.5120, device='cuda:0')
benign distance is  tensor(133.5120, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.811000794172287
distance x is tensor(84.6904, device='cuda:0')
benign distance is  tensor(84.6904, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.4361851438879967
distance x is tensor(141.0559, device='cuda:0')
benign distance is  tensor(141.0559, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  4.5998198091983795
distance x is tensor(120.1346, device='cuda:0')
benign distance is  tensor(120.1346, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  2.2404865622520447
distance x is tensor(119.7487, device='cuda:0')
benign distance is  tensor(119.7487, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.143653556704521
distance x is tensor(135.7100, device='cuda:0')
benign distance is  tensor(135.7100, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7972915563732386
distance x is tensor(122.6028, device='cuda:0')
benign distance is  tensor(122.6028, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  3.2072242349386215
distance x is tensor(146.0444, device='cuda:0')
benign distance is  tensor(146.0444, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 702.7728,  479.6806,  417.6548,  651.6271,  526.6277,  486.7164,
         563.0855,  489.7342,  669.3080,  779.2399,  680.6405,  726.1028,
         637.9173,  672.9443,  746.7019,  639.6424,  741.6402,  698.0334,
         700.0692,  829.5118, 1974.8237, 1963.9015, 2025.2932, 1983.6052,
        1968.8861, 1940.4806, 1954.7848, 1982.8068], device='cuda:0')
sorted_norm is   tensor([ 417.6548,  479.6806,  486.7164,  489.7342,  526.6277,  563.0855,
         637.9173,  639.6424,  651.6271,  669.3080,  672.9443,  680.6405,
         698.0334,  700.0692,  702.7728,  726.1028,  741.6402,  746.7019,
         779.2399,  829.5118, 1940.4806, 1954.7848, 1963.9015, 1968.8861,
        1974.8237, 1982.8068, 1983.6052, 2025.2932], device='cuda:0')
used idx is  tensor([ 2,  1,  5,  7,  4,  6, 12, 15,  3,  8, 13, 10, 17, 18,  0, 11, 16, 14,
         9, 19, 25, 26], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1987678073346615
distance x is tensor(119.6916, device='cuda:0')
benign distance is  tensor(119.6916, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.9699535965919495
distance x is tensor(72.7040, device='cuda:0')
benign distance is  tensor(72.7040, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.4901088923215866
distance x is tensor(48.4112, device='cuda:0')
benign distance is  tensor(48.4112, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.578876681625843
distance x is tensor(121.4284, device='cuda:0')
benign distance is  tensor(121.4284, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.843657411634922
distance x is tensor(80.2498, device='cuda:0')
benign distance is  tensor(80.2498, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.2098667174577713
distance x is tensor(62.0589, device='cuda:0')
benign distance is  tensor(62.0589, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.5640227794647217
distance x is tensor(89.3958, device='cuda:0')
benign distance is  tensor(89.3958, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.3078978061676025
distance x is tensor(72.3366, device='cuda:0')
benign distance is  tensor(72.3366, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.435067541897297
distance x is tensor(99.2376, device='cuda:0')
benign distance is  tensor(99.2376, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.3048460632562637
distance x is tensor(73.7382, device='cuda:0')
benign distance is  tensor(73.7382, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  2.4301941096782684
distance x is tensor(84.6029, device='cuda:0')
benign distance is  tensor(84.6029, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  3.5703991800546646
distance x is tensor(81.7984, device='cuda:0')
benign distance is  tensor(81.7984, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.3420974053442478
distance x is tensor(99.7453, device='cuda:0')
benign distance is  tensor(99.7453, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  2.461445651948452
distance x is tensor(81.7098, device='cuda:0')
benign distance is  tensor(81.7098, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.134039416909218
distance x is tensor(52.5715, device='cuda:0')
benign distance is  tensor(52.5715, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.415740467607975
distance x is tensor(86.3236, device='cuda:0')
benign distance is  tensor(86.3236, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([ 703.7504,  519.7339,  385.1112,  730.5654,  551.3162,  415.3692,
         575.2473,  479.0279,  594.5813,  719.5693,  658.2776,  713.5797,
         660.2745,  645.3096,  712.8445,  646.1793,  662.4754,  678.6837,
         678.2907,  784.3887, 1887.1447, 1927.5701, 1940.7034, 1868.3105,
        1964.6992, 1932.7411, 1883.9507, 1917.3281,  504.8157,  525.5504,
         520.9508,  648.7332,  538.2711,  780.5696,  753.1359,  667.3489,
         636.6210,  714.3988,  608.8754,  700.3220,  757.5518,  573.8445,
         796.1167,  740.7844], device='cuda:0')
sorted_norm is   tensor([ 385.1112,  415.3692,  479.0279,  504.8157,  519.7339,  520.9508,
         525.5504,  538.2711,  551.3162,  573.8445,  575.2473,  594.5813,
         608.8754,  636.6210,  645.3096,  646.1793,  648.7332,  658.2776,
         660.2745,  662.4754,  667.3489,  678.2907,  678.6837,  700.3220,
         703.7504,  712.8445,  713.5797,  714.3988,  719.5693,  730.5654,
         740.7844,  753.1359,  757.5518,  780.5696,  784.3887,  796.1167,
        1868.3105, 1883.9507, 1887.1447, 1917.3281, 1927.5701, 1932.7411,
        1940.7034, 1964.6992], device='cuda:0')
used idx is  tensor([ 2,  5,  7, 28,  1, 30, 29, 32,  4, 41,  6,  8, 38, 36, 13, 15, 31, 10,
        12, 16, 35, 18, 17, 39,  0, 14, 11, 37,  9,  3, 43, 34, 40, 33, 19],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 0.01% 

Test Accuracy: 10.23% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8595537096261978
distance x is tensor(149.0710, device='cuda:0')
benign distance is  tensor(149.0710, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.306848593056202
distance x is tensor(103.9168, device='cuda:0')
benign distance is  tensor(103.9168, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.0310621559619904
distance x is tensor(83.8007, device='cuda:0')
benign distance is  tensor(83.8007, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.078429013490677
distance x is tensor(146.8629, device='cuda:0')
benign distance is  tensor(146.8629, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.7935053557157516
distance x is tensor(114.4644, device='cuda:0')
benign distance is  tensor(114.4644, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.7482288926839828
distance x is tensor(101.6911, device='cuda:0')
benign distance is  tensor(101.6911, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.208901271224022
distance x is tensor(128.1120, device='cuda:0')
benign distance is  tensor(128.1120, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.1507232934236526
distance x is tensor(101.8172, device='cuda:0')
benign distance is  tensor(101.8172, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.1448713168501854
distance x is tensor(104.4656, device='cuda:0')
benign distance is  tensor(104.4656, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.7081400156021118
distance x is tensor(128.7137, device='cuda:0')
benign distance is  tensor(128.7137, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.0416364893317223
distance x is tensor(103.1020, device='cuda:0')
benign distance is  tensor(103.1020, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.4815143048763275
distance x is tensor(120.8633, device='cuda:0')
benign distance is  tensor(120.8633, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  3.226690486073494
distance x is tensor(155.2741, device='cuda:0')
benign distance is  tensor(155.2741, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.214619070291519
distance x is tensor(98.4640, device='cuda:0')
benign distance is  tensor(98.4640, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.6066695749759674
distance x is tensor(137.7951, device='cuda:0')
benign distance is  tensor(137.7951, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.181822940707207
distance x is tensor(125.8663, device='cuda:0')
benign distance is  tensor(125.8663, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.808439925312996
distance x is tensor(105.4192, device='cuda:0')
benign distance is  tensor(105.4192, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.8663561046123505
distance x is tensor(114.2184, device='cuda:0')
benign distance is  tensor(114.2184, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.796235606074333
distance x is tensor(116.7090, device='cuda:0')
benign distance is  tensor(116.7090, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.301905259490013
distance x is tensor(129.5787, device='cuda:0')
benign distance is  tensor(129.5787, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.9272663295269012
distance x is tensor(115.2473, device='cuda:0')
benign distance is  tensor(115.2473, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.2789969444274902
distance x is tensor(196.9709, device='cuda:0')
benign distance is  tensor(196.9709, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.9476097151637077
distance x is tensor(152.6299, device='cuda:0')
benign distance is  tensor(152.6299, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.1178761050105095
distance x is tensor(123.6867, device='cuda:0')
benign distance is  tensor(123.6867, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  4.371718779206276
distance x is tensor(102.1528, device='cuda:0')
benign distance is  tensor(102.1528, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  3.513934910297394
distance x is tensor(125.0063, device='cuda:0')
benign distance is  tensor(125.0063, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.1939035430550575
distance x is tensor(156.1501, device='cuda:0')
benign distance is  tensor(156.1501, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  2.0398084297776222
distance x is tensor(79.0939, device='cuda:0')
benign distance is  tensor(79.0939, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.3713909536600113
distance x is tensor(143.7274, device='cuda:0')
benign distance is  tensor(143.7274, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.239831544458866
distance x is tensor(111.7491, device='cuda:0')
benign distance is  tensor(111.7491, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  3.4059954583644867
distance x is tensor(99.5499, device='cuda:0')
benign distance is  tensor(99.5499, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.837315171957016
distance x is tensor(138.9482, device='cuda:0')
benign distance is  tensor(138.9482, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([674.4641, 485.2001, 425.4795, 680.6816, 535.8961, 502.2094, 611.7102,
        486.8092, 657.9543, 770.1563, 679.9584, 702.9189, 640.8306, 675.2589,
        754.3356, 643.3036, 719.6067, 697.4471, 686.2314, 825.6208],
       device='cuda:0')
sorted_norm is   tensor([425.4795, 485.2001, 486.8092, 502.2094, 535.8961, 611.7102, 640.8306,
        643.3036, 657.9543, 674.4641, 675.2589, 679.9584, 680.6816, 686.2314,
        697.4471, 702.9189, 719.6067, 754.3356, 770.1563, 825.6208],
       device='cuda:0')
used idx is  tensor([ 2,  1,  7,  5,  4,  6, 12, 15,  8,  0, 13, 10,  3, 18, 17, 11],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.368013858795166
distance x is tensor(123.2312, device='cuda:0')
benign distance is  tensor(123.2312, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.472822055220604
distance x is tensor(80.4912, device='cuda:0')
benign distance is  tensor(80.4912, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.660101592540741
distance x is tensor(48.0767, device='cuda:0')
benign distance is  tensor(48.0767, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.5904505103826523
distance x is tensor(119.7135, device='cuda:0')
benign distance is  tensor(119.7135, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.1361259445548058
distance x is tensor(85.1367, device='cuda:0')
benign distance is  tensor(85.1367, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.130592480301857
distance x is tensor(66.7102, device='cuda:0')
benign distance is  tensor(66.7102, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.7176885306835175
distance x is tensor(93.0099, device='cuda:0')
benign distance is  tensor(93.0099, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.249774821102619
distance x is tensor(71.2530, device='cuda:0')
benign distance is  tensor(71.2530, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([729.9979, 556.8893, 386.3264, 702.1141, 562.8731, 441.7155, 599.7990,
        488.9128, 454.0338, 630.6643, 610.5777, 645.3315, 592.5261, 534.6553,
        642.6442, 569.2358, 583.7303, 602.3411, 589.8395, 721.3627, 687.7776,
        509.5011, 710.0686, 657.9266, 654.2543, 701.4824, 665.8629, 741.1016,
        584.4735, 689.1571, 563.2372, 643.3557, 768.9933, 532.7281, 720.9348,
        664.8862], device='cuda:0')
sorted_norm is   tensor([386.3264, 441.7155, 454.0338, 488.9128, 509.5011, 532.7281, 534.6553,
        556.8893, 562.8731, 563.2372, 569.2358, 583.7303, 584.4735, 589.8395,
        592.5261, 599.7990, 602.3411, 610.5777, 630.6643, 642.6442, 643.3557,
        645.3315, 654.2543, 657.9266, 664.8862, 665.8629, 687.7776, 689.1571,
        701.4824, 702.1141, 710.0686, 720.9348, 721.3627, 729.9979, 741.1016,
        768.9933], device='cuda:0')
used idx is  tensor([ 2,  5,  8,  7, 21, 33, 13,  1,  4, 30, 15, 16, 28, 18, 12,  6, 17, 10,
         9, 14, 31, 11, 24, 23, 35, 26, 20, 29], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 7.58% 

Test Accuracy: 20.96% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0503809601068497
distance x is tensor(154.3712, device='cuda:0')
benign distance is  tensor(154.3712, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.8257850259542465
distance x is tensor(100.2032, device='cuda:0')
benign distance is  tensor(100.2032, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.883453294634819
distance x is tensor(79.3252, device='cuda:0')
benign distance is  tensor(79.3252, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.496293231844902
distance x is tensor(143.1258, device='cuda:0')
benign distance is  tensor(143.1258, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.42314775288105
distance x is tensor(117.8365, device='cuda:0')
benign distance is  tensor(117.8365, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.7928636074066162
distance x is tensor(101.4322, device='cuda:0')
benign distance is  tensor(101.4322, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.036596417427063
distance x is tensor(120.9800, device='cuda:0')
benign distance is  tensor(120.9800, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.0440487414598465
distance x is tensor(102.2433, device='cuda:0')
benign distance is  tensor(102.2433, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.649529032409191
distance x is tensor(118.6142, device='cuda:0')
benign distance is  tensor(118.6142, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.2623895555734634
distance x is tensor(121.4412, device='cuda:0')
benign distance is  tensor(121.4412, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.1315393894910812
distance x is tensor(99.0544, device='cuda:0')
benign distance is  tensor(99.0544, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.467524021863937
distance x is tensor(117.0201, device='cuda:0')
benign distance is  tensor(117.0201, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.2373637929558754
distance x is tensor(151.0364, device='cuda:0')
benign distance is  tensor(151.0364, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.5083587616682053
distance x is tensor(89.5305, device='cuda:0')
benign distance is  tensor(89.5305, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.7071232199668884
distance x is tensor(148.0974, device='cuda:0')
benign distance is  tensor(148.0974, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.792998224496841
distance x is tensor(127.1547, device='cuda:0')
benign distance is  tensor(127.1547, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.7401322945952415
distance x is tensor(132.0397, device='cuda:0')
benign distance is  tensor(132.0397, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.6915058121085167
distance x is tensor(80.7347, device='cuda:0')
benign distance is  tensor(80.7347, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  3.0084706395864487
distance x is tensor(138.4949, device='cuda:0')
benign distance is  tensor(138.4949, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  5.006860926747322
distance x is tensor(114.1634, device='cuda:0')
benign distance is  tensor(114.1634, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  2.0590513423085213
distance x is tensor(117.4501, device='cuda:0')
benign distance is  tensor(117.4501, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.9152611792087555
distance x is tensor(121.2744, device='cuda:0')
benign distance is  tensor(121.2744, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  1.0232125855982304
distance x is tensor(118.8145, device='cuda:0')
benign distance is  tensor(118.8145, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  3.730492055416107
distance x is tensor(149.4955, device='cuda:0')
benign distance is  tensor(149.4955, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([679.7903, 462.1205, 397.7978, 648.2879, 533.4073, 487.4733, 538.7310,
        467.1074, 716.8898, 837.6866, 727.7755, 748.3201, 692.8960, 726.3997,
        805.8410, 681.3553, 792.7426, 733.8350, 746.4406, 880.6816, 495.3011,
        531.0951, 546.1934, 608.5798, 517.5643, 875.7428, 682.8688, 583.0009],
       device='cuda:0')
sorted_norm is   tensor([397.7978, 462.1205, 467.1074, 487.4733, 495.3011, 517.5643, 531.0951,
        533.4073, 538.7310, 546.1934, 583.0009, 608.5798, 648.2879, 679.7903,
        681.3553, 682.8688, 692.8960, 716.8898, 726.3997, 727.7755, 733.8350,
        746.4406, 748.3201, 792.7426, 805.8410, 837.6866, 875.7428, 880.6816],
       device='cuda:0')
used idx is  tensor([ 2,  1,  7,  5, 20, 24, 21,  4,  6, 22, 27, 23,  3,  0, 15, 26, 12,  8,
        13, 10, 17, 18], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 12.93% 

Test Accuracy: 38.54% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8416078239679337
distance x is tensor(146.1960, device='cuda:0')
benign distance is  tensor(146.1960, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.2490768432617188
distance x is tensor(102.4925, device='cuda:0')
benign distance is  tensor(102.4925, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.7246792167425156
distance x is tensor(82.9182, device='cuda:0')
benign distance is  tensor(82.9182, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.0820531621575356
distance x is tensor(145.6759, device='cuda:0')
benign distance is  tensor(145.6759, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.119690850377083
distance x is tensor(109.8691, device='cuda:0')
benign distance is  tensor(109.8691, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.6682024374604225
distance x is tensor(101.4730, device='cuda:0')
benign distance is  tensor(101.4730, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2942586094141006
distance x is tensor(112.7637, device='cuda:0')
benign distance is  tensor(112.7637, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.8860073164105415
distance x is tensor(101.1804, device='cuda:0')
benign distance is  tensor(101.1804, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.5842389911413193
distance x is tensor(98.4640, device='cuda:0')
benign distance is  tensor(98.4640, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.211260065436363
distance x is tensor(108.2797, device='cuda:0')
benign distance is  tensor(108.2797, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.137845627963543
distance x is tensor(112.0496, device='cuda:0')
benign distance is  tensor(112.0496, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.005194827914238
distance x is tensor(128.0325, device='cuda:0')
benign distance is  tensor(128.0325, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.248010590672493
distance x is tensor(103.8392, device='cuda:0')
benign distance is  tensor(103.8392, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.573996141552925
distance x is tensor(200.3956, device='cuda:0')
benign distance is  tensor(200.3956, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.9603239595890045
distance x is tensor(149.5915, device='cuda:0')
benign distance is  tensor(149.5915, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.6248553916811943
distance x is tensor(117.4527, device='cuda:0')
benign distance is  tensor(117.4527, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([645.2318, 460.7959, 408.3317, 640.4013, 503.7358, 477.6699, 502.2194,
        464.5692, 736.6513, 875.0873, 752.0521, 850.8429, 721.8809, 767.4681,
        840.1437, 731.6528, 818.1287, 760.9669, 786.0655, 907.2097, 711.3260,
        600.8925, 654.0092, 655.3828, 714.3375, 596.0891, 476.2387, 650.1119,
        540.7156, 565.8228, 445.8775, 544.3006, 673.8534, 422.0085, 671.5515,
        595.8333], device='cuda:0')
sorted_norm is   tensor([408.3317, 422.0085, 445.8775, 460.7959, 464.5692, 476.2387, 477.6699,
        502.2194, 503.7358, 540.7156, 544.3006, 565.8228, 595.8333, 596.0891,
        600.8925, 640.4013, 645.2318, 650.1119, 654.0092, 655.3828, 671.5515,
        673.8534, 711.3260, 714.3375, 721.8809, 731.6528, 736.6513, 752.0521,
        760.9669, 767.4681, 786.0655, 818.1287, 840.1437, 850.8429, 875.0873,
        907.2097], device='cuda:0')
used idx is  tensor([ 2, 33, 30,  1,  7, 26,  5,  6,  4, 28, 31, 29, 35, 25, 21,  3,  0, 27,
        22, 23, 34, 32, 20, 24, 12, 15,  8, 10], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 7.15% 

Test Accuracy: 36.59% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9474211819469929
distance x is tensor(143.0808, device='cuda:0')
benign distance is  tensor(143.0808, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.858931414783001
distance x is tensor(108.9714, device='cuda:0')
benign distance is  tensor(108.9714, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.6528310775756836
distance x is tensor(88.8843, device='cuda:0')
benign distance is  tensor(88.8843, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.38379093259573
distance x is tensor(144.2469, device='cuda:0')
benign distance is  tensor(144.2469, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.8754422068595886
distance x is tensor(112.7216, device='cuda:0')
benign distance is  tensor(112.7216, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.644046612083912
distance x is tensor(106.4971, device='cuda:0')
benign distance is  tensor(106.4971, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.5036292523145676
distance x is tensor(111.9214, device='cuda:0')
benign distance is  tensor(111.9214, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.896194413304329
distance x is tensor(96.9761, device='cuda:0')
benign distance is  tensor(96.9761, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.392409086227417
distance x is tensor(108.5308, device='cuda:0')
benign distance is  tensor(108.5308, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.804725855588913
distance x is tensor(122.8151, device='cuda:0')
benign distance is  tensor(122.8151, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.5862308964133263
distance x is tensor(103.8677, device='cuda:0')
benign distance is  tensor(103.8677, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.049234837293625
distance x is tensor(115.9664, device='cuda:0')
benign distance is  tensor(115.9664, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.4772032499313354
distance x is tensor(149.6152, device='cuda:0')
benign distance is  tensor(149.6152, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.875935137271881
distance x is tensor(85.1840, device='cuda:0')
benign distance is  tensor(85.1840, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.6666548997163773
distance x is tensor(141.4442, device='cuda:0')
benign distance is  tensor(141.4442, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.261751264333725
distance x is tensor(128.5805, device='cuda:0')
benign distance is  tensor(128.5805, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.1310112215578556
distance x is tensor(120.8222, device='cuda:0')
benign distance is  tensor(120.8222, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.3614916801452637
distance x is tensor(107.2056, device='cuda:0')
benign distance is  tensor(107.2056, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  2.8728048652410507
distance x is tensor(115.2443, device='cuda:0')
benign distance is  tensor(115.2443, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  5.165902376174927
distance x is tensor(120.8840, device='cuda:0')
benign distance is  tensor(120.8840, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9005042426288128
distance x is tensor(127.4914, device='cuda:0')
benign distance is  tensor(127.4914, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.64906894415617
distance x is tensor(101.5957, device='cuda:0')
benign distance is  tensor(101.5957, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.7040279358625412
distance x is tensor(96.4613, device='cuda:0')
benign distance is  tensor(96.4613, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.0260749086737633
distance x is tensor(119.8533, device='cuda:0')
benign distance is  tensor(119.8533, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([621.7692, 476.5873, 413.7716, 615.6363, 502.1985, 474.5344, 485.0036,
        438.1273, 821.1171, 913.6461, 821.2554, 869.4740, 777.8949, 833.8227,
        898.1333, 778.1685, 885.5134, 827.5521, 861.5468, 977.0587],
       device='cuda:0')
sorted_norm is   tensor([413.7716, 438.1273, 474.5344, 476.5873, 485.0036, 502.1985, 615.6363,
        621.7692, 777.8949, 778.1685, 821.1171, 821.2554, 827.5521, 833.8227,
        861.5468, 869.4740, 885.5134, 898.1333, 913.6461, 977.0587],
       device='cuda:0')
used idx is  tensor([ 2,  7,  5,  1,  6,  4,  3,  0, 12, 15,  8, 10, 17, 13, 18, 11],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.521920122206211
distance x is tensor(95.8219, device='cuda:0')
benign distance is  tensor(95.8219, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.5274984538555145
distance x is tensor(61.5032, device='cuda:0')
benign distance is  tensor(61.5032, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.8227753341197968
distance x is tensor(44.6537, device='cuda:0')
benign distance is  tensor(44.6537, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.3627863004803658
distance x is tensor(105.2308, device='cuda:0')
benign distance is  tensor(105.2308, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.395841747522354
distance x is tensor(62.9591, device='cuda:0')
benign distance is  tensor(62.9591, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.243479944765568
distance x is tensor(48.5072, device='cuda:0')
benign distance is  tensor(48.5072, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.908781260251999
distance x is tensor(76.4230, device='cuda:0')
benign distance is  tensor(76.4230, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  3.01833339035511
distance x is tensor(33.5811, device='cuda:0')
benign distance is  tensor(33.5811, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([665.2316, 505.5270, 382.8466, 687.1367, 539.5922, 378.5031, 546.6235,
        339.5954, 306.4434, 633.6119, 445.5536, 603.6035, 572.3889, 465.0501,
        544.8611, 488.6895, 465.2833, 546.3826, 541.4578, 651.8356, 565.4445,
        676.1143, 792.1344, 502.1175, 748.0696, 621.0779, 566.1685, 731.7764,
        708.5762, 514.2264, 714.0118, 635.5100, 657.8894, 667.3195, 673.3920,
        769.8740, 586.4935, 622.5765, 638.0836, 697.8339, 600.8004, 972.6307,
        775.7512, 673.6191, 638.9866, 697.5834, 606.9324, 664.4598, 787.6235,
        540.4439, 771.1422, 701.5256], device='cuda:0')
sorted_norm is   tensor([306.4434, 339.5954, 378.5031, 382.8466, 445.5536, 465.0501, 465.2833,
        488.6895, 502.1175, 505.5270, 514.2264, 539.5922, 540.4439, 541.4578,
        544.8611, 546.3826, 546.6235, 565.4445, 566.1685, 572.3889, 586.4935,
        600.8004, 603.6035, 606.9324, 621.0779, 622.5765, 633.6119, 635.5100,
        638.0836, 638.9866, 651.8356, 657.8894, 664.4598, 665.2316, 667.3195,
        673.3920, 673.6191, 676.1143, 687.1367, 697.5834, 697.8339, 701.5256,
        708.5762, 714.0118, 731.7764, 748.0696, 769.8740, 771.1422, 775.7512,
        787.6235, 792.1344, 972.6307], device='cuda:0')
used idx is  tensor([ 8,  7,  5,  2, 10, 13, 16, 15, 23,  1, 29,  4, 49, 18, 14, 17,  6, 20,
        26, 12, 36, 40, 11, 46, 25, 37,  9, 31, 38, 44, 19, 32, 47,  0, 33, 34,
        43, 21,  3, 45, 39], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 14.18% 

Test Accuracy: 48.00% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8596048280596733
distance x is tensor(141.4332, device='cuda:0')
benign distance is  tensor(141.4332, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.0829697027802467
distance x is tensor(102.6254, device='cuda:0')
benign distance is  tensor(102.6254, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.947001099586487
distance x is tensor(81.4861, device='cuda:0')
benign distance is  tensor(81.4861, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.391299769282341
distance x is tensor(139.1250, device='cuda:0')
benign distance is  tensor(139.1250, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.55488733202219
distance x is tensor(104.6344, device='cuda:0')
benign distance is  tensor(104.6344, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.6000578552484512
distance x is tensor(103.2467, device='cuda:0')
benign distance is  tensor(103.2467, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.6609834134578705
distance x is tensor(104.8397, device='cuda:0')
benign distance is  tensor(104.8397, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.005010686814785
distance x is tensor(92.5924, device='cuda:0')
benign distance is  tensor(92.5924, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.975111797451973
distance x is tensor(100.9941, device='cuda:0')
benign distance is  tensor(100.9941, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.580015905201435
distance x is tensor(125.4646, device='cuda:0')
benign distance is  tensor(125.4646, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.2049513459205627
distance x is tensor(91.1440, device='cuda:0')
benign distance is  tensor(91.1440, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.009462386369705
distance x is tensor(112.1611, device='cuda:0')
benign distance is  tensor(112.1611, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.5577059760689735
distance x is tensor(134.5175, device='cuda:0')
benign distance is  tensor(134.5175, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.1413122713565826
distance x is tensor(86.9555, device='cuda:0')
benign distance is  tensor(86.9555, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.6827006936073303
distance x is tensor(140.7342, device='cuda:0')
benign distance is  tensor(140.7342, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.510352060198784
distance x is tensor(113.8844, device='cuda:0')
benign distance is  tensor(113.8844, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  4.0907749235630035
distance x is tensor(95.0292, device='cuda:0')
benign distance is  tensor(95.0292, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.1556743532419205
distance x is tensor(107.9090, device='cuda:0')
benign distance is  tensor(107.9090, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.022486060857773
distance x is tensor(110.8663, device='cuda:0')
benign distance is  tensor(110.8663, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.8704055175185204
distance x is tensor(126.1527, device='cuda:0')
benign distance is  tensor(126.1527, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.6967685520648956
distance x is tensor(100.2082, device='cuda:0')
benign distance is  tensor(100.2082, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.316178847104311
distance x is tensor(199.0556, device='cuda:0')
benign distance is  tensor(199.0556, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.0154412537813187
distance x is tensor(146.0120, device='cuda:0')
benign distance is  tensor(146.0120, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.1803836822509766
distance x is tensor(117.4718, device='cuda:0')
benign distance is  tensor(117.4718, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.9050307124853134
distance x is tensor(125.2009, device='cuda:0')
benign distance is  tensor(125.2009, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.848475143313408
distance x is tensor(89.1256, device='cuda:0')
benign distance is  tensor(89.1256, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.41411242634058
distance x is tensor(128.3990, device='cuda:0')
benign distance is  tensor(128.3990, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  3.449881762266159
distance x is tensor(106.6974, device='cuda:0')
benign distance is  tensor(106.6974, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.5691938698291779
distance x is tensor(117.0589, device='cuda:0')
benign distance is  tensor(117.0589, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.3110038712620735
distance x is tensor(112.7727, device='cuda:0')
benign distance is  tensor(112.7727, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.8667421862483025
distance x is tensor(115.8320, device='cuda:0')
benign distance is  tensor(115.8320, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  3.1944667994976044
distance x is tensor(139.2102, device='cuda:0')
benign distance is  tensor(139.2102, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  3.665383741259575
distance x is tensor(87.4437, device='cuda:0')
benign distance is  tensor(87.4437, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  3.894832521677017
distance x is tensor(125.8108, device='cuda:0')
benign distance is  tensor(125.8108, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.165695771574974
distance x is tensor(148.9527, device='cuda:0')
benign distance is  tensor(148.9527, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  2.0403658747673035
distance x is tensor(81.2032, device='cuda:0')
benign distance is  tensor(81.2032, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.857183188199997
distance x is tensor(141.9309, device='cuda:0')
benign distance is  tensor(141.9309, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.0663391947746277
distance x is tensor(117.4577, device='cuda:0')
benign distance is  tensor(117.4577, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  3.513340637087822
distance x is tensor(96.1876, device='cuda:0')
benign distance is  tensor(96.1876, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.8330463115125895
distance x is tensor(136.8373, device='cuda:0')
benign distance is  tensor(136.8373, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([624.2694, 461.1596, 395.7097, 611.2663, 479.5439, 476.6254, 472.4612,
        424.6270, 801.1271, 897.5832, 799.5649, 843.2111, 771.5129, 814.3566,
        881.3539, 767.9507, 871.8705, 821.2722, 831.1675, 968.8333],
       device='cuda:0')
sorted_norm is   tensor([395.7097, 424.6270, 461.1596, 472.4612, 476.6254, 479.5439, 611.2663,
        624.2694, 767.9507, 771.5129, 799.5649, 801.1271, 814.3566, 821.2722,
        831.1675, 843.2111, 871.8705, 881.3539, 897.5832, 968.8333],
       device='cuda:0')
used idx is  tensor([ 2,  7,  1,  6,  5,  4,  3,  0, 15, 12, 10,  8, 13, 17, 18, 11],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.095973029732704
distance x is tensor(61.2026, device='cuda:0')
benign distance is  tensor(61.2026, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.7187873870134354
distance x is tensor(36.7702, device='cuda:0')
benign distance is  tensor(36.7702, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.2074493020772934
distance x is tensor(39.3319, device='cuda:0')
benign distance is  tensor(39.3319, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.396582469344139
distance x is tensor(112.1196, device='cuda:0')
benign distance is  tensor(112.1196, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.1365215107798576
distance x is tensor(81.5914, device='cuda:0')
benign distance is  tensor(81.5914, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.473654717206955
distance x is tensor(49.5003, device='cuda:0')
benign distance is  tensor(49.5003, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.5384828001260757
distance x is tensor(84.6952, device='cuda:0')
benign distance is  tensor(84.6952, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.976056843996048
distance x is tensor(14.1687, device='cuda:0')
benign distance is  tensor(14.1687, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([524.7050, 423.8462, 376.2203, 703.6414, 540.1135, 381.7375, 585.5190,
        271.8979, 311.0931, 601.0220, 386.2117, 609.5081, 539.9341, 438.2641,
        520.5859, 414.4170, 459.1041, 580.2648, 542.6100, 633.2562, 623.7149,
        724.1036, 574.1360, 665.6828, 778.6857, 562.3264, 781.1325, 668.9266],
       device='cuda:0')
sorted_norm is   tensor([271.8979, 311.0931, 376.2203, 381.7375, 386.2117, 414.4170, 423.8462,
        438.2641, 459.1041, 520.5859, 524.7050, 539.9341, 540.1135, 542.6100,
        562.3264, 574.1360, 580.2648, 585.5190, 601.0220, 609.5081, 623.7149,
        633.2562, 665.6828, 668.9266, 703.6414, 724.1036, 778.6857, 781.1325],
       device='cuda:0')
used idx is  tensor([ 7,  8,  2,  5, 10, 15,  1, 13, 16, 14,  0, 12,  4, 18, 25, 22, 17,  6,
         9, 11, 20, 19], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 44.47% 

Test Accuracy: 10.01% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9243179671466351
distance x is tensor(151.3721, device='cuda:0')
benign distance is  tensor(151.3721, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.464547097682953
distance x is tensor(101.9147, device='cuda:0')
benign distance is  tensor(101.9147, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.696399137377739
distance x is tensor(70.8262, device='cuda:0')
benign distance is  tensor(70.8262, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.5167474523186684
distance x is tensor(144.9805, device='cuda:0')
benign distance is  tensor(144.9805, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.0945315062999725
distance x is tensor(112.6958, device='cuda:0')
benign distance is  tensor(112.6958, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.4999213442206383
distance x is tensor(97.7980, device='cuda:0')
benign distance is  tensor(97.7980, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.5774238854646683
distance x is tensor(112.5044, device='cuda:0')
benign distance is  tensor(112.5044, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2576342970132828
distance x is tensor(104.1316, device='cuda:0')
benign distance is  tensor(104.1316, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.840292952954769
distance x is tensor(106.1175, device='cuda:0')
benign distance is  tensor(106.1175, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.6560415849089622
distance x is tensor(121.0932, device='cuda:0')
benign distance is  tensor(121.0932, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.488025411963463
distance x is tensor(105.5154, device='cuda:0')
benign distance is  tensor(105.5154, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.398549363017082
distance x is tensor(123.7288, device='cuda:0')
benign distance is  tensor(123.7288, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.917565241456032
distance x is tensor(141.8503, device='cuda:0')
benign distance is  tensor(141.8503, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.1430792957544327
distance x is tensor(81.9593, device='cuda:0')
benign distance is  tensor(81.9593, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.944170005619526
distance x is tensor(144.0101, device='cuda:0')
benign distance is  tensor(144.0101, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.476000338792801
distance x is tensor(130.3216, device='cuda:0')
benign distance is  tensor(130.3216, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([725.9360, 515.6280, 419.9539, 699.3669, 559.7167, 503.9951, 567.8831,
        526.3258, 576.5959, 686.4611, 624.3669, 640.2433, 579.2438, 555.4990,
        673.1363, 568.2333, 641.6193, 632.1833, 612.1211, 746.8822, 676.2258,
        626.3207, 666.4733, 655.6238, 701.9213, 604.8777, 572.2554, 683.5633,
        561.7427, 623.7488, 636.9093, 687.9481, 577.2914, 974.1025, 761.1767,
        664.0748], device='cuda:0')
sorted_norm is   tensor([419.9539, 503.9951, 515.6280, 526.3258, 555.4990, 559.7167, 561.7427,
        567.8831, 568.2333, 572.2554, 576.5959, 577.2914, 579.2438, 604.8777,
        612.1211, 623.7488, 624.3669, 626.3207, 632.1833, 636.9093, 640.2433,
        641.6193, 655.6238, 664.0748, 666.4733, 673.1363, 676.2258, 683.5633,
        686.4611, 687.9481, 699.3669, 701.9213, 725.9360, 746.8822, 761.1767,
        974.1025], device='cuda:0')
used idx is  tensor([ 2,  5,  1,  7, 13,  4, 28,  6, 15, 26,  8, 32, 12, 25, 18, 29, 10, 21,
        17, 30, 11, 16, 23, 35, 22, 14, 20, 27], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 4.93% 

Test Accuracy: 14.21% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8186036795377731
distance x is tensor(149.1986, device='cuda:0')
benign distance is  tensor(149.1986, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.558004342019558
distance x is tensor(116.0500, device='cuda:0')
benign distance is  tensor(116.0500, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.7665260583162308
distance x is tensor(90.5222, device='cuda:0')
benign distance is  tensor(90.5222, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.4967763870954514
distance x is tensor(152.5448, device='cuda:0')
benign distance is  tensor(152.5448, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.9954899474978447
distance x is tensor(116.2854, device='cuda:0')
benign distance is  tensor(116.2854, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.791645735502243
distance x is tensor(108.7332, device='cuda:0')
benign distance is  tensor(108.7332, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.0739065408706665
distance x is tensor(116.5614, device='cuda:0')
benign distance is  tensor(116.5614, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.1453852877020836
distance x is tensor(104.7651, device='cuda:0')
benign distance is  tensor(104.7651, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  4.40617461502552
distance x is tensor(105.9240, device='cuda:0')
benign distance is  tensor(105.9240, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.8841743543744087
distance x is tensor(116.2036, device='cuda:0')
benign distance is  tensor(116.2036, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.5625371485948563
distance x is tensor(123.4844, device='cuda:0')
benign distance is  tensor(123.4844, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.0515972897410393
distance x is tensor(133.3278, device='cuda:0')
benign distance is  tensor(133.3278, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.136718936264515
distance x is tensor(113.0992, device='cuda:0')
benign distance is  tensor(113.0992, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.5364720448851585
distance x is tensor(201.1586, device='cuda:0')
benign distance is  tensor(201.1586, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.0426588878035545
distance x is tensor(155.5627, device='cuda:0')
benign distance is  tensor(155.5627, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.0602421015501022
distance x is tensor(129.8428, device='cuda:0')
benign distance is  tensor(129.8428, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.15148950740695
distance x is tensor(127.1538, device='cuda:0')
benign distance is  tensor(127.1538, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.1994039341807365
distance x is tensor(110.4105, device='cuda:0')
benign distance is  tensor(110.4105, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  2.933653011918068
distance x is tensor(117.9917, device='cuda:0')
benign distance is  tensor(117.9917, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  5.1301382184028625
distance x is tensor(121.6665, device='cuda:0')
benign distance is  tensor(121.6665, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.0119619332253933
distance x is tensor(136.4114, device='cuda:0')
benign distance is  tensor(136.4114, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.8195676133036613
distance x is tensor(103.3806, device='cuda:0')
benign distance is  tensor(103.3806, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.7604772597551346
distance x is tensor(101.7669, device='cuda:0')
benign distance is  tensor(101.7669, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.0733044706285
distance x is tensor(121.7236, device='cuda:0')
benign distance is  tensor(121.7236, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([641.9944, 496.8050, 427.1209, 647.7870, 512.5967, 488.4123, 511.3700,
        457.5562, 756.9185, 863.8857, 748.3906, 781.0115, 715.6793, 772.8630,
        841.0917, 736.8997, 806.3504, 782.7966, 775.2603, 918.4364, 583.0366,
        474.2165, 609.4708, 524.1232, 574.2939, 559.1556, 580.5912, 668.7524,
        534.4226, 591.7831, 518.4268, 598.7535, 675.3292, 434.8784, 683.0507,
        627.7181], device='cuda:0')
sorted_norm is   tensor([427.1209, 434.8784, 457.5562, 474.2165, 488.4123, 496.8050, 511.3700,
        512.5967, 518.4268, 524.1232, 534.4226, 559.1556, 574.2939, 580.5912,
        583.0366, 591.7831, 598.7535, 609.4708, 627.7181, 641.9944, 647.7870,
        668.7524, 675.3292, 683.0507, 715.6793, 736.8997, 748.3906, 756.9185,
        772.8630, 775.2603, 781.0115, 782.7966, 806.3504, 841.0917, 863.8857,
        918.4364], device='cuda:0')
used idx is  tensor([ 2, 33,  7, 21,  5,  1,  6,  4, 30, 23, 28, 25, 24, 26, 20, 29, 31, 22,
        35,  0,  3, 27, 32, 34, 12, 15, 10,  8], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 32.04% 

Test Accuracy: 59.98% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1076065972447395
distance x is tensor(132.1563, device='cuda:0')
benign distance is  tensor(132.1563, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.7089833170175552
distance x is tensor(97.1263, device='cuda:0')
benign distance is  tensor(97.1263, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3370539471507072
distance x is tensor(77.6920, device='cuda:0')
benign distance is  tensor(77.6920, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.0817445516586304
distance x is tensor(128.1318, device='cuda:0')
benign distance is  tensor(128.1318, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.8657057657837868
distance x is tensor(96.5275, device='cuda:0')
benign distance is  tensor(96.5275, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.749437801539898
distance x is tensor(94.7277, device='cuda:0')
benign distance is  tensor(94.7277, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3161999508738518
distance x is tensor(100.3399, device='cuda:0')
benign distance is  tensor(100.3399, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.9334563240408897
distance x is tensor(82.7140, device='cuda:0')
benign distance is  tensor(82.7140, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.821771800518036
distance x is tensor(102.4415, device='cuda:0')
benign distance is  tensor(102.4415, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.9181462451815605
distance x is tensor(115.7592, device='cuda:0')
benign distance is  tensor(115.7592, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.710328161716461
distance x is tensor(88.1684, device='cuda:0')
benign distance is  tensor(88.1684, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.6889503449201584
distance x is tensor(104.0759, device='cuda:0')
benign distance is  tensor(104.0759, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.1095953285694122
distance x is tensor(137.1242, device='cuda:0')
benign distance is  tensor(137.1242, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.7891574651002884
distance x is tensor(72.7416, device='cuda:0')
benign distance is  tensor(72.7416, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.8633561432361603
distance x is tensor(127.8290, device='cuda:0')
benign distance is  tensor(127.8290, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.808908715844154
distance x is tensor(111.4189, device='cuda:0')
benign distance is  tensor(111.4189, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.055584132671356
distance x is tensor(122.0839, device='cuda:0')
benign distance is  tensor(122.0839, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.7579416930675507
distance x is tensor(89.6328, device='cuda:0')
benign distance is  tensor(89.6328, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.7445468232035637
distance x is tensor(118.6154, device='cuda:0')
benign distance is  tensor(118.6154, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  3.888602316379547
distance x is tensor(101.9630, device='cuda:0')
benign distance is  tensor(101.9630, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.8077382072806358
distance x is tensor(103.5312, device='cuda:0')
benign distance is  tensor(103.5312, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.0770752876996994
distance x is tensor(113.0733, device='cuda:0')
benign distance is  tensor(113.0733, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7006865534931421
distance x is tensor(103.9225, device='cuda:0')
benign distance is  tensor(103.9225, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  3.100732207298279
distance x is tensor(135.3105, device='cuda:0')
benign distance is  tensor(135.3105, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 575.9655,  435.1202,  381.2071,  563.3629,  437.4133,  438.5673,
         448.9181,  385.2802,  933.2168, 1023.7822,  923.7579,  940.6398,
         925.9559,  956.9284,  998.1898,  899.2262, 1004.6785,  958.6057,
         962.6001, 1099.9139], device='cuda:0')
sorted_norm is   tensor([ 381.2071,  385.2802,  435.1202,  437.4133,  438.5673,  448.9181,
         563.3629,  575.9655,  899.2262,  923.7579,  925.9559,  933.2168,
         940.6398,  956.9284,  958.6057,  962.6001,  998.1898, 1004.6785,
        1023.7822, 1099.9139], device='cuda:0')
used idx is  tensor([ 2,  7,  1,  4,  5,  6,  3,  0, 15, 10, 12,  8, 11, 13, 17, 18],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.571736879646778
distance x is tensor(111.7472, device='cuda:0')
benign distance is  tensor(111.7472, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.2211750894784927
distance x is tensor(81.4085, device='cuda:0')
benign distance is  tensor(81.4085, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.5407522916793823
distance x is tensor(46.2472, device='cuda:0')
benign distance is  tensor(46.2472, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.844757601618767
distance x is tensor(115.3526, device='cuda:0')
benign distance is  tensor(115.3526, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.8996500372886658
distance x is tensor(75.5928, device='cuda:0')
benign distance is  tensor(75.5928, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.227611504495144
distance x is tensor(49.4737, device='cuda:0')
benign distance is  tensor(49.4737, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.667387083172798
distance x is tensor(82.7519, device='cuda:0')
benign distance is  tensor(82.7519, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.7126695066690445
distance x is tensor(57.5156, device='cuda:0')
benign distance is  tensor(57.5156, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([710.7963, 553.9294, 353.8295, 724.1602, 569.3405, 398.1841, 576.1963,
        463.9581, 414.4949, 603.0963, 488.6790, 601.3483, 554.1369, 498.2831,
        606.3950, 558.2537, 569.8762, 593.7266, 553.4205, 665.0236, 568.2078,
        728.4308, 812.0643, 556.3554, 788.2668, 693.7153, 609.4767, 764.5869,
        592.8827, 642.3535, 672.2267, 703.9987, 627.2128, 983.7890, 790.3110,
        706.2423, 688.9908, 744.6763, 614.2026, 687.5386, 802.5004, 576.2774,
        784.4354, 702.9203], device='cuda:0')
sorted_norm is   tensor([353.8295, 398.1841, 414.4949, 463.9581, 488.6790, 498.2831, 553.4205,
        553.9294, 554.1369, 556.3554, 558.2537, 568.2078, 569.3405, 569.8762,
        576.1963, 576.2774, 592.8827, 593.7266, 601.3483, 603.0963, 606.3950,
        609.4767, 614.2026, 627.2128, 642.3535, 665.0236, 672.2267, 687.5386,
        688.9908, 693.7153, 702.9203, 703.9987, 706.2423, 710.7963, 724.1602,
        728.4308, 744.6763, 764.5869, 784.4354, 788.2668, 790.3110, 802.5004,
        812.0643, 983.7890], device='cuda:0')
used idx is  tensor([ 2,  5,  8,  7, 10, 13, 18,  1, 12, 23, 15, 20,  4, 16,  6, 41, 28, 17,
        11,  9, 14, 26, 38, 32, 29, 19, 30, 39, 36, 25, 43, 31, 35,  0,  3],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 14.02% 

Test Accuracy: 41.38% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9110742323100567
distance x is tensor(145.7372, device='cuda:0')
benign distance is  tensor(145.7372, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.5875901207327843
distance x is tensor(115.2805, device='cuda:0')
benign distance is  tensor(115.2805, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.297885589301586
distance x is tensor(84.0176, device='cuda:0')
benign distance is  tensor(84.0176, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2434217631816864
distance x is tensor(150.1814, device='cuda:0')
benign distance is  tensor(150.1814, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.9532116949558258
distance x is tensor(113.9528, device='cuda:0')
benign distance is  tensor(113.9528, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5173574164509773
distance x is tensor(105.4645, device='cuda:0')
benign distance is  tensor(105.4645, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8461672589182854
distance x is tensor(110.1376, device='cuda:0')
benign distance is  tensor(110.1376, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.168449454009533
distance x is tensor(103.2297, device='cuda:0')
benign distance is  tensor(103.2297, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.8269411697983742
distance x is tensor(109.8019, device='cuda:0')
benign distance is  tensor(109.8019, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.8054030686616898
distance x is tensor(126.0816, device='cuda:0')
benign distance is  tensor(126.0816, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.619412362575531
distance x is tensor(94.9050, device='cuda:0')
benign distance is  tensor(94.9050, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  5.053307965397835
distance x is tensor(117.9905, device='cuda:0')
benign distance is  tensor(117.9905, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.658587545156479
distance x is tensor(139.4244, device='cuda:0')
benign distance is  tensor(139.4244, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.3853821232914925
distance x is tensor(99.1344, device='cuda:0')
benign distance is  tensor(99.1344, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.9083408862352371
distance x is tensor(141.5118, device='cuda:0')
benign distance is  tensor(141.5118, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  5.026345148682594
distance x is tensor(125.0321, device='cuda:0')
benign distance is  tensor(125.0321, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  4.446508392691612
distance x is tensor(102.7943, device='cuda:0')
benign distance is  tensor(102.7943, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.8521072939038277
distance x is tensor(108.9630, device='cuda:0')
benign distance is  tensor(108.9630, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.8794049695134163
distance x is tensor(112.5148, device='cuda:0')
benign distance is  tensor(112.5148, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.1627409011125565
distance x is tensor(135.2089, device='cuda:0')
benign distance is  tensor(135.2089, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.7683206498622894
distance x is tensor(112.9971, device='cuda:0')
benign distance is  tensor(112.9971, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.5130553022027016
distance x is tensor(200.9762, device='cuda:0')
benign distance is  tensor(200.9762, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.7413397431373596
distance x is tensor(156.2657, device='cuda:0')
benign distance is  tensor(156.2657, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.7208677306771278
distance x is tensor(123.0691, device='cuda:0')
benign distance is  tensor(123.0691, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  4.781784683465958
distance x is tensor(91.4834, device='cuda:0')
benign distance is  tensor(91.4834, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  4.194767773151398
distance x is tensor(131.8894, device='cuda:0')
benign distance is  tensor(131.8894, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.414347119629383
distance x is tensor(152.0502, device='cuda:0')
benign distance is  tensor(152.0502, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  2.27206102758646
distance x is tensor(87.0541, device='cuda:0')
benign distance is  tensor(87.0541, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.3442749939858913
distance x is tensor(151.3562, device='cuda:0')
benign distance is  tensor(151.3562, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.2227862402796745
distance x is tensor(121.0412, device='cuda:0')
benign distance is  tensor(121.0412, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  3.930730491876602
distance x is tensor(103.9951, device='cuda:0')
benign distance is  tensor(103.9951, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7007940579205751
distance x is tensor(144.6031, device='cuda:0')
benign distance is  tensor(144.6031, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([625.9879, 496.6000, 401.8874, 640.5679, 501.5584, 478.3073, 482.8781,
        454.0964, 781.5452, 892.9667, 798.8498, 822.6606, 756.1340, 798.5339,
        868.4237, 751.9941, 862.3130, 809.3268, 821.8826, 957.6088],
       device='cuda:0')
sorted_norm is   tensor([401.8874, 454.0964, 478.3073, 482.8781, 496.6000, 501.5584, 625.9879,
        640.5679, 751.9941, 756.1340, 781.5452, 798.5339, 798.8498, 809.3268,
        821.8826, 822.6606, 862.3130, 868.4237, 892.9667, 957.6088],
       device='cuda:0')
used idx is  tensor([ 2,  7,  5,  6,  1,  4,  0,  3, 15, 12,  8, 13, 10, 17, 18, 11],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.6669981554150581
distance x is tensor(101.3404, device='cuda:0')
benign distance is  tensor(101.3404, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.9806642085313797
distance x is tensor(69.8855, device='cuda:0')
benign distance is  tensor(69.8855, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.9816251397132874
distance x is tensor(48.4705, device='cuda:0')
benign distance is  tensor(48.4705, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.350324884057045
distance x is tensor(114.5969, device='cuda:0')
benign distance is  tensor(114.5969, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.9491676837205887
distance x is tensor(71.0878, device='cuda:0')
benign distance is  tensor(71.0878, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.0845237374305725
distance x is tensor(51.2673, device='cuda:0')
benign distance is  tensor(51.2673, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.1552363112568855
distance x is tensor(74.1065, device='cuda:0')
benign distance is  tensor(74.1065, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.1498220711946487
distance x is tensor(54.3346, device='cuda:0')
benign distance is  tensor(54.3346, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([680.4348, 532.5986, 377.9127, 694.8996, 537.3388, 373.5680, 506.5490,
        438.6285, 309.6213, 588.0746, 473.6064, 569.9797, 569.1027, 476.4354,
        591.3553, 512.1870, 491.1820, 570.0419, 567.1385, 672.1161, 694.1359,
        608.5572, 662.8719, 657.5597, 712.6620, 588.6564, 567.6802, 673.1743,
        738.1380, 654.4011, 734.3928, 677.3273, 693.4031, 729.1571, 698.7390,
        804.8853, 638.3595, 705.6702, 563.3450, 662.7617, 757.7463, 571.8630,
        769.0583, 685.8527], device='cuda:0')
sorted_norm is   tensor([309.6213, 373.5680, 377.9127, 438.6285, 473.6064, 476.4354, 491.1820,
        506.5490, 512.1870, 532.5986, 537.3388, 563.3450, 567.1385, 567.6802,
        569.1027, 569.9797, 570.0419, 571.8630, 588.0746, 588.6564, 591.3553,
        608.5572, 638.3595, 654.4011, 657.5597, 662.7617, 662.8719, 672.1161,
        673.1743, 677.3273, 680.4348, 685.8527, 693.4031, 694.1359, 694.8996,
        698.7390, 705.6702, 712.6620, 729.1571, 734.3928, 738.1380, 757.7463,
        769.0583, 804.8853], device='cuda:0')
used idx is  tensor([ 8,  5,  2,  7, 10, 13, 16,  6, 15,  1,  4, 38, 18, 26, 12, 11, 17, 41,
         9, 25, 14, 21, 36, 29, 23, 39, 22, 19, 27, 31,  0, 43, 32, 20,  3],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 16.92% 

Test Accuracy: 40.31% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9968783743679523
distance x is tensor(143.8075, device='cuda:0')
benign distance is  tensor(143.8075, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.118128553032875
distance x is tensor(103.9776, device='cuda:0')
benign distance is  tensor(103.9776, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.8452180176973343
distance x is tensor(85.4431, device='cuda:0')
benign distance is  tensor(85.4431, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.3663031086325645
distance x is tensor(145.0498, device='cuda:0')
benign distance is  tensor(145.0498, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.15122851729393
distance x is tensor(111.7079, device='cuda:0')
benign distance is  tensor(111.7079, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.7162088006734848
distance x is tensor(105.6653, device='cuda:0')
benign distance is  tensor(105.6653, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.1797406524419785
distance x is tensor(110.6969, device='cuda:0')
benign distance is  tensor(110.6969, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2977788373827934
distance x is tensor(99.4196, device='cuda:0')
benign distance is  tensor(99.4196, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.5031117871403694
distance x is tensor(109.7870, device='cuda:0')
benign distance is  tensor(109.7870, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.0163621604442596
distance x is tensor(128.9137, device='cuda:0')
benign distance is  tensor(128.9137, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.8030567467212677
distance x is tensor(99.5150, device='cuda:0')
benign distance is  tensor(99.5150, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.932933270931244
distance x is tensor(121.4633, device='cuda:0')
benign distance is  tensor(121.4633, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  3.0884898006916046
distance x is tensor(147.0269, device='cuda:0')
benign distance is  tensor(147.0269, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.9492234364151955
distance x is tensor(88.1920, device='cuda:0')
benign distance is  tensor(88.1920, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.9753475412726402
distance x is tensor(146.2429, device='cuda:0')
benign distance is  tensor(146.2429, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  5.1308697909116745
distance x is tensor(121.3917, device='cuda:0')
benign distance is  tensor(121.3917, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.0906797125935555
distance x is tensor(130.7765, device='cuda:0')
benign distance is  tensor(130.7765, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.801504373550415
distance x is tensor(91.6472, device='cuda:0')
benign distance is  tensor(91.6472, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.6061695739626884
distance x is tensor(132.5823, device='cuda:0')
benign distance is  tensor(132.5823, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  4.445000201463699
distance x is tensor(114.6340, device='cuda:0')
benign distance is  tensor(114.6340, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.755086287856102
distance x is tensor(116.9243, device='cuda:0')
benign distance is  tensor(116.9243, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.9597676321864128
distance x is tensor(122.8133, device='cuda:0')
benign distance is  tensor(122.8133, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7395405638962984
distance x is tensor(124.0942, device='cuda:0')
benign distance is  tensor(124.0942, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.8655600249767303
distance x is tensor(146.5975, device='cuda:0')
benign distance is  tensor(146.5975, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.1615816056728363
distance x is tensor(125.7280, device='cuda:0')
benign distance is  tensor(125.7280, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.2501148506999016
distance x is tensor(101.5441, device='cuda:0')
benign distance is  tensor(101.5441, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  3.2387697249650955
distance x is tensor(118.8862, device='cuda:0')
benign distance is  tensor(118.8862, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  4.872718334197998
distance x is tensor(124.0077, device='cuda:0')
benign distance is  tensor(124.0077, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.453019805252552
distance x is tensor(126.9645, device='cuda:0')
benign distance is  tensor(126.9645, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.9739193841814995
distance x is tensor(106.8799, device='cuda:0')
benign distance is  tensor(106.8799, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.0275211483240128
distance x is tensor(102.2417, device='cuda:0')
benign distance is  tensor(102.2417, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9126255959272385
distance x is tensor(122.8878, device='cuda:0')
benign distance is  tensor(122.8878, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([623.5118, 454.4724, 407.1255, 621.3850, 496.5650, 481.3716, 486.6351,
        442.6080, 771.7546, 888.0463, 785.3206, 825.6387, 759.4131, 796.7888,
        856.2191, 751.3917, 836.4164, 789.6138, 807.3433, 964.4022, 450.8898,
        491.8183, 512.5956, 596.9247, 498.8850, 871.9370, 668.6014, 562.9531],
       device='cuda:0')
sorted_norm is   tensor([407.1255, 442.6080, 450.8898, 454.4724, 481.3716, 486.6351, 491.8183,
        496.5650, 498.8850, 512.5956, 562.9531, 596.9247, 621.3850, 623.5118,
        668.6014, 751.3917, 759.4131, 771.7546, 785.3206, 789.6138, 796.7888,
        807.3433, 825.6387, 836.4164, 856.2191, 871.9370, 888.0463, 964.4022],
       device='cuda:0')
used idx is  tensor([ 2,  7, 20,  1,  5,  6, 21,  4, 24, 22, 27, 23,  3,  0, 26, 15, 12,  8,
        10, 17, 13, 18], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 13.11% 

Test Accuracy: 37.23% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.765497975051403
distance x is tensor(146.9940, device='cuda:0')
benign distance is  tensor(146.9940, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.1537633016705513
distance x is tensor(106.8613, device='cuda:0')
benign distance is  tensor(106.8613, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.8454789966344833
distance x is tensor(89.6584, device='cuda:0')
benign distance is  tensor(89.6584, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2572632431983948
distance x is tensor(151.9116, device='cuda:0')
benign distance is  tensor(151.9116, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.0011871829628944
distance x is tensor(110.3975, device='cuda:0')
benign distance is  tensor(110.3975, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.4649231731891632
distance x is tensor(106.8965, device='cuda:0')
benign distance is  tensor(106.8965, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.9553589671850204
distance x is tensor(111.7239, device='cuda:0')
benign distance is  tensor(111.7239, device='cuda:0')
current submit client idx and staleness is 
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     None of attack is done!

attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]
 7 1
grad,shape is torch.Size([215370])
 benign loss is  1.8633096292614937
distance x is tensor(97.8869, device='cuda:0')
benign distance is  tensor(97.8869, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.5610022842884064
distance x is tensor(104.5941, device='cuda:0')
benign distance is  tensor(104.5941, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.1859971433877945
distance x is tensor(114.6952, device='cuda:0')
benign distance is  tensor(114.6952, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.2487884163856506
distance x is tensor(118.5384, device='cuda:0')
benign distance is  tensor(118.5384, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.0757744759321213
distance x is tensor(172.3139, device='cuda:0')
benign distance is  tensor(172.3139, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.191447228193283
distance x is tensor(109.4248, device='cuda:0')
benign distance is  tensor(109.4248, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.3188552856445312
distance x is tensor(200.0734, device='cuda:0')
benign distance is  tensor(200.0734, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.5964667797088623
distance x is tensor(153.9704, device='cuda:0')
benign distance is  tensor(153.9704, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.6034051552414894
distance x is tensor(115.2487, device='cuda:0')
benign distance is  tensor(115.2487, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([624.0409, 462.5971, 425.7523, 634.8931, 490.1593, 470.2033, 481.1824,
        431.9572, 780.1827, 894.6319, 792.0366, 841.7855, 766.6675, 819.2437,
        865.4467, 735.5720, 841.4549, 822.1784, 836.0991, 966.4135, 498.9883,
        592.4812, 434.0683, 541.3657, 644.2957, 403.7679, 646.2286, 552.3275],
       device='cuda:0')
sorted_norm is   tensor([403.7679, 425.7523, 431.9572, 434.0683, 462.5971, 470.2033, 481.1824,
        490.1593, 498.9883, 541.3657, 552.3275, 592.4812, 624.0409, 634.8931,
        644.2957, 646.2286, 735.5720, 766.6675, 780.1827, 792.0366, 819.2437,
        822.1784, 836.0991, 841.4549, 841.7855, 865.4467, 894.6319, 966.4135],
       device='cuda:0')
used idx is  tensor([25,  2,  7, 22,  1,  5,  6,  4, 20, 23, 27, 21,  0,  3, 24, 26, 15, 12,
         8, 10, 13, 17], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 24.64% 

Test Accuracy: 55.21% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8080733586102724
distance x is tensor(154.1999, device='cuda:0')
benign distance is  tensor(154.1999, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.208373062312603
distance x is tensor(106.6311, device='cuda:0')
benign distance is  tensor(106.6311, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.312944933772087
distance x is tensor(89.0143, device='cuda:0')
benign distance is  tensor(89.0143, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.7111766785383224
distance x is tensor(148.0246, device='cuda:0')
benign distance is  tensor(148.0246, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.27254755795002
distance x is tensor(116.4953, device='cuda:0')
benign distance is  tensor(116.4953, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5488654673099518
distance x is tensor(104.9273, device='cuda:0')
benign distance is  tensor(104.9273, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.348659060895443
distance x is tensor(115.5241, device='cuda:0')
benign distance is  tensor(115.5241, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.0293643921613693
distance x is tensor(93.0890, device='cuda:0')
benign distance is  tensor(93.0890, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.135109305381775
distance x is tensor(109.6829, device='cuda:0')
benign distance is  tensor(109.6829, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.502551853656769
distance x is tensor(126.8975, device='cuda:0')
benign distance is  tensor(126.8975, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.7428459450602531
distance x is tensor(102.6936, device='cuda:0')
benign distance is  tensor(102.6936, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.162899821996689
distance x is tensor(113.6726, device='cuda:0')
benign distance is  tensor(113.6726, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.675226040184498
distance x is tensor(141.6592, device='cuda:0')
benign distance is  tensor(141.6592, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.668946549296379
distance x is tensor(84.6593, device='cuda:0')
benign distance is  tensor(84.6593, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.6345791891217232
distance x is tensor(141.5316, device='cuda:0')
benign distance is  tensor(141.5316, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.852390617132187
distance x is tensor(121.0500, device='cuda:0')
benign distance is  tensor(121.0500, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 657.7485,  452.1320,  410.4835,  615.9977,  499.8731,  474.3077,
         489.5037,  408.6169,  840.3417,  950.5281,  841.7491,  888.0767,
         812.3976,  866.4441,  929.0660,  801.6176,  920.4523,  843.5463,
         882.9926, 1004.2740], device='cuda:0')
sorted_norm is   tensor([ 408.6169,  410.4835,  452.1320,  474.3077,  489.5037,  499.8731,
         615.9977,  657.7485,  801.6176,  812.3976,  840.3417,  841.7491,
         843.5463,  866.4441,  882.9926,  888.0767,  920.4523,  929.0660,
         950.5281, 1004.2740], device='cuda:0')
used idx is  tensor([ 7,  2,  1,  5,  6,  4,  3,  0, 15, 12,  8, 10, 17, 13, 18, 11],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.6937061175704002
distance x is tensor(105.1994, device='cuda:0')
benign distance is  tensor(105.1994, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.8943158984184265
distance x is tensor(74.3035, device='cuda:0')
benign distance is  tensor(74.3035, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.754376605153084
distance x is tensor(43.9164, device='cuda:0')
benign distance is  tensor(43.9164, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.169929765164852
distance x is tensor(109.3429, device='cuda:0')
benign distance is  tensor(109.3429, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.628602087497711
distance x is tensor(75.3862, device='cuda:0')
benign distance is  tensor(75.3862, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.3818060010671616
distance x is tensor(45.0561, device='cuda:0')
benign distance is  tensor(45.0561, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3428142443299294
distance x is tensor(83.7370, device='cuda:0')
benign distance is  tensor(83.7370, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  3.174727901816368
distance x is tensor(57.7107, device='cuda:0')
benign distance is  tensor(57.7107, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6996842473745346
distance x is tensor(121.2658, device='cuda:1')
benign distance is  tensor(121.2658, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7882310748100281
distance x is tensor(105.3253, device='cuda:1')
benign distance is  tensor(105.3253, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.590034956112504
distance x is tensor(109.4441, device='cuda:1')
benign distance is  tensor(109.4441, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9679732285439968
distance x is tensor(151.2816, device='cuda:1')
benign distance is  tensor(151.2816, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9229400949552655
distance x is tensor(101.2018, device='cuda:1')
benign distance is  tensor(101.2018, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6410968978889287
distance x is tensor(96.6611, device='cuda:1')
benign distance is  tensor(96.6611, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.227093305438757
distance x is tensor(119.3578, device='cuda:1')
benign distance is  tensor(119.3578, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6951198671013117
distance x is tensor(83.4621, device='cuda:1')
benign distance is  tensor(83.4621, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8526025749742985
distance x is tensor(113.2021, device='cuda:1')
benign distance is  tensor(113.2021, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6617663614451885
distance x is tensor(126.3776, device='cuda:1')
benign distance is  tensor(126.3776, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1878706868737936
distance x is tensor(89.3532, device='cuda:1')
benign distance is  tensor(89.3532, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2315814532339573
distance x is tensor(123.7838, device='cuda:1')
benign distance is  tensor(123.7838, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0240898244082928
distance x is tensor(162.7253, device='cuda:1')
benign distance is  tensor(162.7253, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6154197948053479
distance x is tensor(67.0810, device='cuda:1')
benign distance is  tensor(67.0810, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.835636580362916
distance x is tensor(146.8421, device='cuda:1')
benign distance is  tensor(146.8421, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3216418959200382
distance x is tensor(128.2261, device='cuda:1')
benign distance is  tensor(128.2261, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.2117092423141003
distance x is tensor(131.2202, device='cuda:1')
benign distance is  tensor(131.2202, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7133666956797242
distance x is tensor(115.7779, device='cuda:1')
benign distance is  tensor(115.7779, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9139134287834167
distance x is tensor(118.9485, device='cuda:1')
benign distance is  tensor(118.9485, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7034620959311724
distance x is tensor(123.2278, device='cuda:1')
benign distance is  tensor(123.2278, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.995133776217699
distance x is tensor(85.0279, device='cuda:1')
benign distance is  tensor(85.0279, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7229340579360723
distance x is tensor(209.8640, device='cuda:1')
benign distance is  tensor(209.8640, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0040651708841324
distance x is tensor(150.6547, device='cuda:1')
benign distance is  tensor(150.6547, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.640631165355444
distance x is tensor(118.1926, device='cuda:1')
benign distance is  tensor(118.1926, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.8202343676239252
distance x is tensor(118.1334, device='cuda:1')
benign distance is  tensor(118.1334, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6165103670209646
distance x is tensor(81.0728, device='cuda:1')
benign distance is  tensor(81.0728, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.0371930114924908
distance x is tensor(147.1079, device='cuda:1')
benign distance is  tensor(147.1079, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.3346724286675453
distance x is tensor(115.0285, device='cuda:1')
benign distance is  tensor(115.0285, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7030472792685032
distance x is tensor(122.0468, device='cuda:1')
benign distance is  tensor(122.0468, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7360980045050383
distance x is tensor(117.8185, device='cuda:1')
benign distance is  tensor(117.8185, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5055386330932379
distance x is tensor(108.5862, device='cuda:1')
benign distance is  tensor(108.5862, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.8438907768577337
distance x is tensor(175.3633, device='cuda:1')
benign distance is  tensor(175.3633, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7294776365160942
distance x is tensor(116.3085, device='cuda:1')
benign distance is  tensor(116.3085, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.8116274662315845
distance x is tensor(106.0723, device='cuda:1')
benign distance is  tensor(106.0723, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6141425464302301
distance x is tensor(145.2453, device='cuda:1')
benign distance is  tensor(145.2453, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.2366689257323742
distance x is tensor(124.2771, device='cuda:1')
benign distance is  tensor(124.2771, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9357230234891176
distance x is tensor(114.3307, device='cuda:1')
benign distance is  tensor(114.3307, device='cuda:1')
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([674.9183, 547.4781, 394.8226, 691.4312, 516.9082, 367.5848, 573.4564,
        442.6724, 416.9545, 612.4388, 515.8423, 600.6387, 545.0835, 469.6061,
        619.2696, 553.5034, 476.5019, 584.1940, 569.1606, 667.5414, 552.1028,
        725.8426, 799.1235, 552.5412, 792.0924, 686.5190, 608.8156, 771.4409,
        708.6462, 585.3615, 722.9000, 654.2800, 660.1796, 684.5792, 704.5847,
        774.6074, 603.3006, 642.0867, 658.8042, 840.4919, 617.9257, 977.1160,
        788.5656, 664.3009, 653.9297, 735.3967, 603.8066, 665.9214, 781.2883,
        554.9942, 784.7746, 687.0422], device='cuda:0')
sorted_norm is   tensor([367.5848, 394.8226, 416.9545, 442.6724, 469.6061, 476.5019, 515.8423,
        516.9082, 545.0835, 547.4781, 552.1028, 552.5412, 553.5034, 554.9942,
        569.1606, 573.4564, 584.1940, 585.3615, 600.6387, 603.3006, 603.8066,
        608.8156, 612.4388, 617.9257, 619.2696, 642.0867, 653.9297, 654.2800,
        658.8042, 660.1796, 664.3009, 665.9214, 667.5414, 674.9183, 684.5792,
        686.5190, 687.0422, 691.4312, 704.5847, 708.6462, 722.9000, 725.8426,
        735.3967, 771.4409, 774.6074, 781.2883, 784.7746, 788.5656, 792.0924,
        799.1235, 840.4919, 977.1160], device='cuda:0')
used idx is  tensor([ 5,  2,  8,  7, 13, 16, 10,  4, 12,  1, 20, 23, 15, 49, 18,  6, 17, 29,
        11, 36, 46, 26,  9, 40, 14, 37, 44, 31, 38, 32, 43, 47, 19,  0, 33, 25,
        51,  3, 34, 28, 30], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 32.95% 

Test Accuracy: 57.05% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9292783252894878
distance x is tensor(133.0491, device='cuda:0')
benign distance is  tensor(133.0491, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.7843532264232635
distance x is tensor(105.8410, device='cuda:0')
benign distance is  tensor(105.8410, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.636054515838623
distance x is tensor(84.1996, device='cuda:0')
benign distance is  tensor(84.1996, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.2372083961963654
distance x is tensor(139.4293, device='cuda:0')
benign distance is  tensor(139.4293, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.7074939161539078
distance x is tensor(111.9730, device='cuda:0')
benign distance is  tensor(111.9730, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.6016892232000828
distance x is tensor(103.3411, device='cuda:0')
benign distance is  tensor(103.3411, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.41352092474699
distance x is tensor(106.3776, device='cuda:0')
benign distance is  tensor(106.3776, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.1888920813798904
distance x is tensor(92.1061, device='cuda:0')
benign distance is  tensor(92.1061, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  3.0592813193798065
distance x is tensor(107.9862, device='cuda:0')
benign distance is  tensor(107.9862, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.8040125370025635
distance x is tensor(124.7749, device='cuda:0')
benign distance is  tensor(124.7749, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.892728291451931
distance x is tensor(100.7076, device='cuda:0')
benign distance is  tensor(100.7076, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.708618804812431
distance x is tensor(111.6341, device='cuda:0')
benign distance is  tensor(111.6341, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.566284030675888
distance x is tensor(141.4951, device='cuda:0')
benign distance is  tensor(141.4951, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.2821564376354218
distance x is tensor(80.5346, device='cuda:0')
benign distance is  tensor(80.5346, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.8746310248970985
distance x is tensor(139.8465, device='cuda:0')
benign distance is  tensor(139.8465, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.373449578881264
distance x is tensor(123.7868, device='cuda:0')
benign distance is  tensor(123.7868, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.237554505467415
distance x is tensor(101.5396, device='cuda:0')
benign distance is  tensor(101.5396, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.2831177711486816
distance x is tensor(110.5193, device='cuda:0')
benign distance is  tensor(110.5193, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.088923417031765
distance x is tensor(111.5811, device='cuda:0')
benign distance is  tensor(111.5811, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.314568154513836
distance x is tensor(127.8754, device='cuda:0')
benign distance is  tensor(127.8754, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.0093639716506004
distance x is tensor(103.0131, device='cuda:0')
benign distance is  tensor(103.0131, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.6620590388774872
distance x is tensor(197.0079, device='cuda:0')
benign distance is  tensor(197.0079, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.0130567997694016
distance x is tensor(154.7112, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.9100307067856193
distance x is tensor(83.3724, device='cuda:1')
benign distance is  tensor(83.3724, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7672229614108801
distance x is tensor(103.4113, device='cuda:1')
benign distance is  tensor(103.4113, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8493148274719715
distance x is tensor(122.1276, device='cuda:1')
benign distance is  tensor(122.1276, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.5925935059785843
distance x is tensor(116.9369, device='cuda:1')
benign distance is  tensor(116.9369, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.2596839405596256
distance x is tensor(139.4064, device='cuda:1')
benign distance is  tensor(139.4064, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.2325350157916546
distance x is tensor(141.1880, device='cuda:1')
benign distance is  tensor(141.1880, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.1026030778884888
distance x is tensor(100.0176, device='cuda:1')
benign distance is  tensor(100.0176, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5495724063366652
distance x is tensor(154.8598, device='cuda:1')
benign distance is  tensor(154.8598, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.712652362883091
distance x is tensor(135.3880, device='cuda:1')
benign distance is  tensor(135.3880, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7004494518041611
distance x is tensor(101.5347, device='cuda:1')
benign distance is  tensor(101.5347, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5216062963008881
distance x is tensor(132.9079, device='cuda:1')
benign distance is  tensor(132.9079, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([12., 14., 16., 19., 18., 19., 19., 14., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([5.9090e-05, 4.3662e-04, 3.2262e-03, 6.4800e-02, 2.3839e-02, 6.4800e-02,
        6.4800e-02, 4.3662e-04, 6.4800e-02, 6.4800e-02, 6.4800e-02, 6.4800e-02,
        6.4800e-02, 6.4800e-02, 6.4800e-02, 6.4800e-02, 6.4800e-02, 6.4800e-02,
        6.4800e-02, 6.4800e-02])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 0.66% 

Test Accuracy: 10.04% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.7458895444869995
distance x is tensor(1429.0682, device='cuda:1')
benign distance is  tensor(1429.0682, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.3013196140527725
distance x is tensor(4545.0278, device='cuda:1')
benign distance is  tensor(4545.0278, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.961515858769417
distance x is tensor(2571.7954, device='cuda:1')
benign distance is  tensor(2571.7954, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.862517163157463
distance x is tensor(2383.1218, device='cuda:1')
benign distance is  tensor(2383.1218, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.9707246869802475
distance x is tensor(1241.0323, device='cuda:1')
benign distance is  tensor(1241.0323, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.593542218208313
distance x is tensor(1552.3627, device='cuda:1')
benign distance is  tensor(1552.3627, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.818642944097519
distance x is tensor(2577.4104, device='cuda:1')
benign distance is  tensor(2577.4104, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.7419998943805695
distance x is tensor(1386.2251, device='cuda:1')
benign distance is  tensor(1386.2251, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
benign distance is  tensor(154.7112, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.254445604979992
distance x is tensor(119.2922, device='cuda:0')
benign distance is  tensor(119.2922, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.7513818070292473
distance x is tensor(119.8305, device='cuda:0')
benign distance is  tensor(119.8305, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  2.192545436322689
distance x is tensor(83.1900, device='cuda:0')
benign distance is  tensor(83.1900, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.9923041388392448
distance x is tensor(121.4544, device='cuda:0')
benign distance is  tensor(121.4544, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  4.414112165570259
distance x is tensor(106.3588, device='cuda:0')
benign distance is  tensor(106.3588, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.7190410569310188
distance x is tensor(112.8543, device='cuda:0')
benign distance is  tensor(112.8543, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.0033321604132652
distance x is tensor(114.7230, device='cuda:0')
benign distance is  tensor(114.7230, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7362825600430369
distance x is tensor(110.6266, device='cuda:0')
benign distance is  tensor(110.6266, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  3.0661267042160034
distance x is tensor(140.8560, device='cuda:0')
benign distance is  tensor(140.8560, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  4.3110663294792175
distance x is tensor(95.8698, device='cuda:0')
benign distance is  tensor(95.8698, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  4.747942239046097
distance x is tensor(124.9396, device='cuda:0')
benign distance is  tensor(124.9396, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.364084117114544
distance x is tensor(151.0506, device='cuda:0')
benign distance is  tensor(151.0506, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.9593122601509094
distance x is tensor(88.1732, device='cuda:0')
benign distance is  tensor(88.1732, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.6463229954242706
distance x is tensor(140.2343, device='cuda:0')
benign distance is  tensor(140.2343, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.866600677371025
distance x is tensor(124.4236, device='cuda:0')
benign distance is  tensor(124.4236, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  3.765153408050537
distance x is tensor(103.4015, device='cuda:0')
benign distance is  tensor(103.4015, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6621004715561867
distance x is tensor(141.3442, device='cuda:0')
benign distance is  tensor(141.3442, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 591.3439,  457.6211,  401.8275,  606.5920,  484.9759,  470.1166,
         466.5229,  419.4273,  829.0166,  961.6881,  855.8199,  876.9451,
         826.0394,  895.3221,  933.0412,  803.0480,  912.7861,  865.3728,
         887.9530, 1016.9210,  551.8298,  435.7802,  529.3366,  510.8979,
         548.5276,  451.5713,  422.8572,  542.0633], device='cuda:0')
sorted_norm is   tensor([ 401.8275,  419.4273,  422.8572,  435.7802,  451.5713,  457.6211,
         466.5229,  470.1166,  484.9759,  510.8979,  529.3366,  542.0633,
         548.5276,  551.8298,  591.3439,  606.5920,  803.0480,  826.0394,
         829.0166,  855.8199,  865.3728,  876.9451,  887.9530,  895.3221,
         912.7861,  933.0412,  961.6881, 1016.9210], device='cuda:0')
used idx is  tensor([ 2,  7, 26, 21, 25,  1,  6,  5,  4, 23, 22, 27, 24, 20,  0,  3, 15, 12,
         8, 10, 17, 11], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 22.35% 

Test Accuracy: 48.46% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7866588272154331
distance x is tensor(143.1229, device='cuda:0')
benign distance is  tensor(143.1229, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.4924701675772667
distance x is tensor(108.5557, device='cuda:0')
benign distance is  tensor(108.5557, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.5643290579319
distance x is tensor(87.4384, device='cuda:0')
benign distance is  tensor(87.4384, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.9587547928094864
distance x is tensor(145.3502, device='cuda:0')
benign distance is  tensor(145.3502, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.339081898331642
distance x is tensor(111.4945, device='cuda:0')
benign distance is  tensor(111.4945, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5713055059313774
distance x is tensor(109.0591, device='cuda:0')
benign distance is  tensor(109.0591, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8543464317917824
distance x is tensor(108.3843, device='cuda:0')
benign distance is  tensor(108.3843, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.9324264228343964
distance x is tensor(98.5011, device='cuda:0')
benign distance is  tensor(98.5011, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.1332308389246464
distance x is tensor(121.0487, device='cuda:0')
benign distance is  tensor(121.0487, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.1995634362101555
distance x is tensor(108.6313, device='cuda:0')
benign distance is  tensor(108.6313, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  2.6862757205963135
distance x is tensor(116.6409, device='cuda:0')
benign distance is  tensor(116.6409, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  4.59030756354332
distance x is tensor(120.8818, device='cuda:0')
benign distance is  tensor(120.8818, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.0572890676558018
distance x is tensor(118.8463, device='cuda:0')
benign distance is  tensor(118.8463, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.6688258275389671
distance x is tensor(104.7156, device='cuda:0')
benign distance is  tensor(104.7156, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.1113648042082787
distance x is tensor(98.0681, device='cuda:0')
benign distance is  tensor(98.0681, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9512544982135296
distance x is tensor(126.1429, device='cuda:0')
benign distance is  tensor(126.1429, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 616.7318,  462.1288,  411.0403,  621.5414,  474.4789,  478.3304,
         471.1268,  435.5886,  847.4594,  934.0996,  830.9608,  926.2612,
         803.1959,  867.5408,  929.7120,  801.7971,  906.8228,  865.7052,
         865.9724, 1019.0720,  488.3386,  563.4331,  452.7961,  515.5659,
         637.1723,  374.0039,  622.6393,  557.7183], device='cuda:0')
sorted_norm is   tensor([ 374.0039,  411.0403,  435.5886,  452.7961,  462.1288,  471.1268,
         474.4789,  478.3304,  488.3386,  515.5659,  557.7183,  563.4331,
         616.7318,  621.5414,  622.6393,  637.1723,  801.7971,  803.1959,
         830.9608,  847.4594,  865.7052,  865.9724,  867.5408,  906.8228,
         926.2612,  929.7120,  934.0996, 1019.0720], device='cuda:0')
used idx is  tensor([25,  2,  7, 22,  1,  6,  4,  5, 20, 23, 27, 21,  0,  3, 26, 24, 15, 12,
        10,  8, 17, 18], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 28.08% 

Test Accuracy: 56.91% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8269868679344654
distance x is tensor(141.0448, device='cuda:0')
benign distance is  tensor(141.0448, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.248931959271431
distance x is tensor(105.6918, device='cuda:0')
benign distance is  tensor(105.6918, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.9026684165000916
distance x is tensor(94.1724, device='cuda:0')
benign distance is  tensor(94.1724, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.179035574197769
distance x is tensor(144.6326, device='cuda:0')
benign distance is  tensor(144.6326, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.9903613403439522
distance x is tensor(115.5764, device='cuda:0')
benign distance is  tensor(115.5764, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.8922492116689682
distance x is tensor(108.1231, device='cuda:0')
benign distance is  tensor(108.1231, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is 
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([20., 20., 20., 20., 20., 20., 20., 20., 13., 13., 13., 13., 13., 13.,
        13., 13., 13., 13., 13., 13., 27., 19., 27., 27., 18., 27., 17.,  5.])
count_res tensor([2.2753e-04, 2.2753e-04, 2.2753e-04, 2.2753e-04, 2.2753e-04, 2.2753e-04,
        2.2753e-04, 2.2753e-04, 2.0748e-07, 2.0748e-07, 2.0748e-07, 2.0748e-07,
        2.0748e-07, 2.0748e-07, 2.0748e-07, 2.0748e-07, 2.0748e-07, 2.0748e-07,
        2.0748e-07, 2.0748e-07, 2.4951e-01, 8.3702e-05, 2.4951e-01, 2.4951e-01,
        3.0792e-05, 2.4951e-01, 1.1328e-05, 6.9601e-11])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 88.82% 

Test Accuracy: 86.47% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7068321667611599
distance x is tensor(122.4782, device='cuda:1')
benign distance is  tensor(122.4782, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6802430674433708
distance x is tensor(106.2179, device='cuda:1')
benign distance is  tensor(106.2179, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7194765284657478
distance x is tensor(113.7746, device='cuda:1')
benign distance is  tensor(113.7746, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9299876410514116
distance x is tensor(152.5654, device='cuda:1')
benign distance is  tensor(152.5654, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7781497165560722
distance x is tensor(91.9485, device='cuda:1')
benign distance is  tensor(91.9485, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6312715178355575
distance x is tensor(100.2407, device='cuda:1')
benign distance is  tensor(100.2407, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1463200189173222
distance x is tensor(99.9577, device='cuda:1')
benign distance is  tensor(99.9577, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5614924971014261
distance x is tensor(87.7088, device='cuda:1')
benign distance is  tensor(87.7088, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9434837065637112
distance x is tensor(99.8242, device='cuda:1')
benign distance is  tensor(99.8242, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6030103410594165
distance x is tensor(129.8572, device='cuda:1')
benign distance is  tensor(129.8572, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.035111092031002
distance x is tensor(67.8126, device='cuda:1')
benign distance is  tensor(67.8126, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3046733289957047
distance x is tensor(107.7674, device='cuda:1')
benign distance is  tensor(107.7674, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1466043703258038
distance x is tensor(180.5841, device='cuda:1')
benign distance is  tensor(180.5841, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7047740211710334
distance x is tensor(64.7792, device='cuda:1')
benign distance is  tensor(64.7792, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8444441175088286
distance x is tensor(141.9253, device='cuda:1')
benign distance is  tensor(141.9253, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.5983018055558205
distance x is tensor(136.7684, device='cuda:1')
benign distance is  tensor(136.7684, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([ 0., 15., 18., 21., 24., 23., 20., 22., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 24., 16., 27., 24., 23., 26., 23., 26.])
count_res tensor([9.6359e-13, 3.1500e-06, 6.3269e-05, 1.2708e-03, 2.5525e-02, 9.3900e-03,
        4.6750e-04, 3.4544e-03, 8.5626e-06, 8.5626e-06, 8.5626e-06, 8.5626e-06,
        8.5626e-06, 8.5626e-06, 8.5626e-06, 8.5626e-06, 8.5626e-06, 8.5626e-06,
        8.5626e-06, 8.5626e-06, 2.5525e-02, 8.5626e-06, 5.1268e-01, 2.5525e-02,
        9.3900e-03, 1.8860e-01, 9.3900e-03, 1.8860e-01])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 81.54% 

Test Accuracy: 84.82% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7996901534497738
distance x is tensor(125.1081, device='cuda:1')
benign distance is  tensor(125.1081, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7841393370181322
distance x is tensor(103.8607, device='cuda:1')
benign distance is  tensor(103.8607, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7300731129944324
distance x is tensor(109.8382, device='cuda:1')
benign distance is  tensor(109.8382, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0548036992549896
distance x is tensor(153.4232, device='cuda:1')
benign distance is  tensor(153.4232, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9450301565229893
distance x is tensor(93.8489, device='cuda:1')
benign distance is  tensor(93.8489, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7503047687932849
distance x is tensor(108.6165, device='cuda:1')
benign distance is  tensor(108.6165, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1560418382287025torch.Size([215370])
 benign loss is  2.462660349905491
distance x is tensor(114.0027, device='cuda:0')
benign distance is  tensor(114.0027, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.760486289858818
distance x is tensor(97.9640, device='cuda:0')
benign distance is  tensor(97.9640, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.3760441541671753
distance x is tensor(112.5819, device='cuda:0')
benign distance is  tensor(112.5819, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.6657334193587303
distance x is tensor(127.1808, device='cuda:0')
benign distance is  tensor(127.1808, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.8986207246780396
distance x is tensor(101.9681, device='cuda:0')
benign distance is  tensor(101.9681, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.083224132657051
distance x is tensor(112.8723, device='cuda:0')
benign distance is  tensor(112.8723, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.510568603873253
distance x is tensor(148.5271, device='cuda:0')
benign distance is  tensor(148.5271, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.688492737710476
distance x is tensor(82.3292, device='cuda:0')
benign distance is  tensor(82.3292, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.4734865203499794
distance x is tensor(141.5543, device='cuda:0')
benign distance is  tensor(141.5543, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.636072799563408
distance x is tensor(117.4489, device='cuda:0')
benign distance is  tensor(117.4489, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 596.3827,  452.4272,  429.3372,  603.6403,  502.8306,  472.1198,
         477.0943,  429.8965,  849.4329,  958.6454,  865.7306,  896.3212,
         820.9666,  902.5739,  932.8098,  823.2309,  920.3058,  870.9819,
         892.6674, 1037.3983,  447.1062,  481.1365,  494.3165,  556.8124,
         443.6777,  848.6379,  655.5284,  533.3035], device='cuda:0')
sorted_norm is   tensor([ 429.3372,  429.8965,  443.6777,  447.1062,  452.4272,  472.1198,
         477.0943,  481.1365,  494.3165,  502.8306,  533.3035,  556.8124,
         596.3827,  603.6403,  655.5284,  820.9666,  823.2309,  848.6379,
         849.4329,  865.7306,  870.9819,  892.6674,  896.3212,  902.5739,
         920.3058,  932.8098,  958.6454, 1037.3983], device='cuda:0')
used idx is  tensor([ 2,  7, 24, 20,  1,  5,  6, 21, 22,  4, 27, 23,  0,  3, 26, 12, 15, 25,
         8, 10, 17, 18], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 21.20% 

Test Accuracy: 54.43% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8703195415437222
distance x is tensor(141.3336, device='cuda:0')
benign distance is  tensor(141.3336, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.0363450050354004
distance x is tensor(104.0468, device='cuda:0')
benign distance is  tensor(104.0468, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.6530642211437225
distance x is tensor(89.7370, device='cuda:0')
benign distance is  tensor(89.7370, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.3315172269940376
distance x is tensor(147.0578, device='cuda:0')
benign distance is  tensor(147.0578, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.8610452488064766
distance x is tensor(105.3710, device='cuda:0')
benign distance is  tensor(105.3710, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.72457617521286
distance x is tensor(107.6386, device='cuda:0')
benign distance is  tensor(107.6386, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.4458438754081726
distance x is tensor(112.2113, device='cuda:0')
benign distance is  tensor(112.2113, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.9341839402914047
distance x is tensor(101.9103, device='cuda:0')
benign distance is  tensor(101.9103, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.603102445602417
distance x is tensor(99.6430, device='cuda:0')
benign distance is  tensor(99.6430, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.85067767649889
distance x is tensor(107.9305, device='cuda:0')
benign distance is  tensor(107.9305, device='cuda:0')
current submit client idx and staleness is 
distance x is tensor(97.0377, device='cuda:1')
benign distance is  tensor(97.0377, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6865098867565393
distance x is tensor(90.2432, device='cuda:1')
benign distance is  tensor(90.2432, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.3176048621535301
distance x is tensor(114.7998, device='cuda:1')
benign distance is  tensor(114.7998, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7714473959058523
distance x is tensor(111.8627, device='cuda:1')
benign distance is  tensor(111.8627, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9524906296283007
distance x is tensor(101.0681, device='cuda:1')
benign distance is  tensor(101.0681, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9906499441713095
distance x is tensor(116.0874, device='cuda:1')
benign distance is  tensor(116.0874, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.1327657010406256
distance x is tensor(91.1932, device='cuda:1')
benign distance is  tensor(91.1932, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7369700698181987
distance x is tensor(203.3113, device='cuda:1')
benign distance is  tensor(203.3113, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1606896221637726
distance x is tensor(141.7634, device='cuda:1')
benign distance is  tensor(141.7634, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.688485381193459
distance x is tensor(103.3165, device='cuda:1')
benign distance is  tensor(103.3165, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 36
counter_tensor is  tensor([18., 10., 29., 22., 27., 27., 35., 29., 14., 14., 14., 14., 14., 14.,
        14., 14., 14., 14., 14., 14., 31., 30., 34.,  9., 25., 32., 35., 35.,
         0., 32., 30., 30., 33., 25., 35., 10.])
count_res tensor([8.9088e-09, 2.9886e-12, 5.3340e-04, 4.8640e-07, 7.2188e-05, 7.2188e-05,
        2.1519e-01, 5.3340e-04, 1.6317e-10, 1.6317e-10, 1.6317e-10, 1.6317e-10,
        1.6317e-10, 1.6317e-10, 1.6317e-10, 1.6317e-10, 1.6317e-10, 1.6317e-10,
        1.6317e-10, 1.6317e-10, 3.9414e-03, 1.4499e-03, 7.9164e-02, 1.0994e-12,
        9.7696e-06, 1.0714e-02, 2.1519e-01, 2.1519e-01, 1.3568e-16, 1.0714e-02,
        1.4499e-03, 1.4499e-03, 2.9123e-02, 9.7696e-06, 2.1519e-01, 2.9886e-12])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 91.53% 

Test Accuracy: 87.26% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7387154139578342
distance x is tensor(119.7931, device='cuda:1')
benign distance is  tensor(119.7931, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8108542170375586
distance x is tensor(115.6793, device='cuda:1')
benign distance is  tensor(115.6793, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6386572103947401
distance x is tensor(100.6024, device='cuda:1')
benign distance is  tensor(100.6024, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9117131009697914
distance x is tensor(141.9682, device='cuda:1')
benign distance is  tensor(141.9682, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0062664784491062
distance x is tensor(96.3631, device='cuda:1')
benign distance is  tensor(96.3631, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7349263830110431
distance x is tensor(92.5382, device='cuda:1')
benign distance is  tensor(92.5382, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2377530578523874
distance x is tensor(99.8475, device='cuda:1')
benign distance is  tensor(99.8475, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6138994628563523
distance x is tensor(81.7052, device='cuda:1')
benign distance is  tensor(81.7052, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9698066618293524
distance x is tensor(108.4963, device='cuda:1')
benign distance is  tensor(108.4963, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6847668155096471
distance x is tensor(119.7245, device='cuda:1')
benign distance is  tensor(119.7245, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0192021634429693
distance x is tensor(82.2994, device='cuda:1')
benign distance is  tensor(82.2994, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.5085652582347393
distance x is tensor(118.8491, device='cuda:1')
benign distance is  tensor(118.8491, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2416660748422146
distance x is tensor(159.3268, device='cuda:1')
benign distance is  tensor(159.3268, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6421492043882608
distance x is tensor(63.8340, device='cuda:1')
benign distance is  tensor(63.8340, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9437688030302525
distance x is tensor(131.5304, device='cuda:1')
benign distance is  tensor(131.5304, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0973354615271091
distance x is tensor(124.3566, device='cuda:1')
benign distance is  tensor(124.3566, device='cuda:1') 18 3
grad,shape is torch.Size([215370])
 benign loss is  2.4549538791179657
distance x is tensor(122.9513, device='cuda:0')
benign distance is  tensor(122.9513, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.0844466760754585
distance x is tensor(125.6228, device='cuda:0')
benign distance is  tensor(125.6228, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.623364746570587
distance x is tensor(104.5161, device='cuda:0')
benign distance is  tensor(104.5161, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.4333892613649368
distance x is tensor(207.1618, device='cuda:0')
benign distance is  tensor(207.1618, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.48504289239645
distance x is tensor(160.4026, device='cuda:0')
benign distance is  tensor(160.4026, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.6151465699076653
distance x is tensor(119.0025, device='cuda:0')
benign distance is  tensor(119.0025, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([ 600.6515,  443.7860,  418.4643,  612.8066,  451.0211,  473.1339,
         472.3111,  435.5458,  860.4136,  977.9830,  881.8819,  908.9406,
         829.5325,  926.0113,  953.5994,  836.9202,  937.8639,  916.7253,
         907.6115, 1036.1095,  520.9355,  394.5494,  528.8918,  480.5016,
         507.4971,  514.3547,  512.8122,  628.4788,  485.8579,  566.1412,
         436.0745,  507.7795,  654.3486,  365.9156,  614.7720,  513.2589],
       device='cuda:0')
sorted_norm is   tensor([ 365.9156,  394.5494,  418.4643,  435.5458,  436.0745,  443.7860,
         451.0211,  472.3111,  473.1339,  480.5016,  485.8579,  507.4971,
         507.7795,  512.8122,  513.2589,  514.3547,  520.9355,  528.8918,
         566.1412,  600.6515,  612.8066,  614.7720,  628.4788,  654.3486,
         829.5325,  836.9202,  860.4136,  881.8819,  907.6115,  908.9406,
         916.7253,  926.0113,  937.8639,  953.5994,  977.9830, 1036.1095],
       device='cuda:0')
used idx is  tensor([33, 21,  2,  7, 30,  1,  4,  6,  5, 23, 28, 24, 31, 26, 35, 25, 20, 22,
        29,  0,  3, 34, 27, 32, 12, 15,  8, 10], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 42.59% 

Test Accuracy: 68.91% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0983404032886028
distance x is tensor(126.2807, device='cuda:0')
benign distance is  tensor(126.2807, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.1624553576111794
distance x is tensor(94.8784, device='cuda:0')
benign distance is  tensor(94.8784, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.3273956328630447
distance x is tensor(82.3637, device='cuda:0')
benign distance is  tensor(82.3637, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.145250119268894
distance x is tensor(132.7084, device='cuda:0')
benign distance is  tensor(132.7084, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.8656731247901917
distance x is tensor(96.1692, device='cuda:0')
benign distance is  tensor(96.1692, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.6797486618161201
distance x is tensor(95.6080, device='cuda:0')
benign distance is  tensor(95.6080, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2189206182956696
distance x is tensor(98.6068, device='cuda:0')
benign distance is  tensor(98.6068, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.8584672659635544
distance x is tensor(83.6681, device='cuda:0')
benign distance is  tensor(83.6681, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.482127383351326
distance x is tensor(93.3336, device='cuda:0')
benign distance is  tensor(93.3336, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.5477235615253448
distance x is tensor(118.2493, device='cuda:0')
benign distance is  tensor(118.2493, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.1864095106720924
distance x is tensor(81.9570, device='cuda:0')
benign distance is  tensor(81.9570, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.082036077976227
distance x is tensor(97.8708, device='cuda:0')
benign distance is  tensor(97.8708, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.6641841530799866
distance x is tensor(130.5039, device='cuda:0')
benign distance is  tensor(130.5039, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.105226866900921
distance x is tensor(68.3361, device='cuda:0')
benign distance is  tensor(68.3361, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.756663329899311
distance x is tensor(127.3940, device='cuda:0')
benign distance is  tensor(127.3940, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.827078565955162
distance x is tensor(100.7116, device='cuda:0')
benign distance is  tensor(100.7116, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.6326580867171288
distance x is tensor(109.3939, device='cuda:0')
benign distance is  tensor(109.3939, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  2.1205845773220062
distance x is tensor(72.9819, device='cuda:0')
benign distance is  tensor(72.9819, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.204832546412945
distance x is tensor(110.9283, device='cuda:0')
benign distance is  tensor(110.9283, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  3.8809852600097656
distance x is tensor(95.6395, device='cuda:0')
benign distance is  tensor(95.6395, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.710542120039463
distance x is tensor(102.5058, device='cuda:0')
benign distance is  tensor(102.5058, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.9326650127768517
distance x is tensor(100.5452, device='cuda:0')
benign distance is  tensor(100.5452, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6637746095657349
distance x is tensor(102.5851, device='cuda:0')
benign distance is  tensor(102.5851, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.5222391560673714
distance x is tensor(140.3851, device='cuda:0')
benign distance is  tensor(140.3851, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 551.6429,  422.8667,  396.6864,  561.5873,  421.9669,  428.0706,
         417.1829,  370.6762, 1029.5991, 1135.5197, 1034.7172, 1066.0245,
        1008.2735, 1049.4423, 1102.6669, 1015.2391, 1100.0972, 1046.6057,
        1073.2350, 1172.3733], device='cuda:0')
sorted_norm is   tensor([ 370.6762,  396.6864,  417.1829,  421.9669,  422.8667,  428.0706,
         551.6429,  561.5873, 1008.2735, 1015.2391, 1029.5991, 1034.7172,
        1046.6057, 1049.4423, 1066.0245, 1073.2350, 1100.0972, 1102.6669,
        1135.5197, 1172.3733], device='cuda:0')
used idx is  tensor([ 7,  2,  6,  4,  1,  5,  0,  3, 12, 15,  8, 10, 17, 13, 11, 18],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.3895254135131836
distance x is tensor(122.4155, device='cuda:0')
benign distance is  tensor(122.4155, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.581580474972725
distance x is tensor(77.0795, device='cuda:0')
benign distance is  tensor(77.0795, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.862827643752098
distance x is tensor(41.5980, device='cuda:0')
benign distance is  tensor(41.5980, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.597588926553726
distance x is tensor(104.5723, device='cuda:0')
benign distance is  tensor(104.5723, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.8629017621278763
distance x is tensor(63.9158, device='cuda:0')
benign distance is  tensor(63.9158, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.2000380381941795
distance x is tensor(36.5912, device='cuda:0')
benign distance is  tensor(36.5912, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.7417510747909546
distance x is tensor(92.1683, device='cuda:0')
benign distance is  tensor(92.1683, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.2848264649510384
distance x is tensor(50.4529, device='cuda:0')
benign distance is  tensor(50.4529, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.013191418722272
distance x is tensor(111.7105, device='cuda:1')
benign distance is  tensor(111.7105, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5499045960605145
distance x is tensor(79.1806, device='cuda:1')
benign distance is  tensor(79.1806, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8558128271251917
distance x is tensor(118.1282, device='cuda:1')
benign distance is  tensor(118.1282, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2016251999884844
distance x is tensor(119.8731, device='cuda:1')
benign distance is  tensor(119.8731, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7482485454529524
distance x is tensor(114.8309, device='cuda:1')
benign distance is  tensor(114.8309, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9129655547440052
distance x is tensor(109.4428, device='cuda:1')
benign distance is  tensor(109.4428, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6200763378292322
distance x is tensor(99.4650, device='cuda:1')
benign distance is  tensor(99.4650, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7888814713805914
distance x is tensor(164.1937, device='cuda:1')
benign distance is  tensor(164.1937, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([10., 23., 21., 19., 20., 20., 27., 21., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 15., 27., 27., 26., 27., 23., 17., 21.])
count_res tensor([9.3783e-09, 4.1491e-03, 5.6152e-04, 7.5994e-05, 2.0657e-04, 2.0657e-04,
        2.2653e-01, 5.6152e-04, 3.7835e-06, 3.7835e-06, 3.7835e-06, 3.7835e-06,
        3.7835e-06, 3.7835e-06, 3.7835e-06, 3.7835e-06, 3.7835e-06, 3.7835e-06,
        3.7835e-06, 3.7835e-06, 1.3919e-06, 2.2653e-01, 2.2653e-01, 8.3337e-02,
        2.2653e-01, 4.1491e-03, 1.0285e-05, 5.6152e-04])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 91.25% 

Test Accuracy: 87.48% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7397857923060656
distance x is tensor(109.4964, device='cuda:1')
benign distance is  tensor(109.4964, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7776489499956369
distance x is tensor(110.4702, device='cuda:1')
benign distance is  tensor(110.4702, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6314658839255571
distance x is tensor(108.1727, device='cuda:1')
benign distance is  tensor(108.1727, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7911857459694147
distance x is tensor(152.4899, device='cuda:1')
benign distance is  tensor(152.4899, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.002888866700232
distance x is tensor(83.2316, device='cuda:1')
benign distance is  tensor(83.2316, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6832131156697869
distance x is tensor(111.8389, device='cuda:1')
benign distance is  tensor(111.8389, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.022759722545743
distance x is tensor(84.0345, device='cuda:1')
benign distance is  tensor(84.0345, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6674248157069087
distance x is tensor(87.1356, device='cuda:1')
benign distance is  tensor(87.1356, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.6879968699067831
distance x is tensor(113.3589, device='cuda:1')
benign distance is  tensor(113.3589, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.9382479442283511
distance x is tensor(92.1134, device='cuda:1')
benign distance is  tensor(92.1134, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6823401339352131
distance x is tensor(146.0769, device='cuda:1')
benign distance is  tensor(146.0769, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.5518600195646286
distance x is tensor(125.5431, device='cuda:1')
benign distance is  tensor(125.5431, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8622978627681732
distance x is tensor(98.6013, device='cuda:1')
benign distance is  tensor(98.6013, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7174442745745182
distance x is tensor(94.2492, device='cuda:1')
benign distance is  tensor(94.2492, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7930780742317438
distance x is tensor(93.2280, device='cuda:1')
benign distance is  tensor(93.2280, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.67558435164392
distance x is tensor(130.1024, device='cuda:1')
benign distance is  tensor(130.1024, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is 
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 736.6050,  541.5073,  378.5277,  691.3742,  559.8545,  308.1661,
         622.4866,  427.2120,  310.5655,  651.4111,  535.6731,  626.6913,
         573.2587,  489.3868,  598.2627,  561.5759,  526.4763,  554.7929,
         562.0486,  627.6210,  600.2143,  723.0449,  810.5152,  590.2519,
         789.8221,  726.5126,  624.8567,  790.7542,  714.5401,  658.8684,
         698.4365,  690.6620,  695.3822,  638.4227,  609.7327,  722.4391,
         623.2268,  656.1711,  718.8769,  722.2234,  634.1234, 1041.5615,
         838.8917,  716.6691,  698.6594,  789.4862,  630.4600,  697.3695,
         826.8049,  600.2081,  825.4515,  709.5522], device='cuda:0')
sorted_norm is   tensor([ 308.1661,  310.5655,  378.5277,  427.2120,  489.3868,  526.4763,
         535.6731,  541.5073,  554.7929,  559.8545,  561.5759,  562.0486,
         573.2587,  590.2519,  598.2627,  600.2081,  600.2143,  609.7327,
         622.4866,  623.2268,  624.8567,  626.6913,  627.6210,  630.4600,
         634.1234,  638.4227,  651.4111,  656.1711,  658.8684,  690.6620,
         691.3742,  695.3822,  697.3695,  698.4365,  698.6594,  709.5522,
         714.5401,  716.6691,  718.8769,  722.2234,  722.4391,  723.0449,
         726.5126,  736.6050,  789.4862,  789.8221,  790.7542,  810.5152,
         825.4515,  826.8049,  838.8917, 1041.5615], device='cuda:0')
used idx is  tensor([ 5,  8,  2,  7, 13, 16, 10,  1, 17,  4, 15, 18, 12, 23, 14, 49, 20, 34,
         6, 36, 26, 11, 19, 46, 40, 33,  9, 37, 29, 31,  3, 32, 47, 30, 44, 51,
        28, 43, 38, 39, 35], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 34.99% 

Test Accuracy: 60.69% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7139100432395935
distance x is tensor(142.8929, device='cuda:0')
benign distance is  tensor(142.8929, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.7288796976208687
distance x is tensor(103.0160, device='cuda:0')
benign distance is  tensor(103.0160, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.171462446451187
distance x is tensor(85.8032, device='cuda:0')
benign distance is  tensor(85.8032, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.142292246222496
distance x is tensor(141.4598, device='cuda:0')
benign distance is  tensor(141.4598, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.099245101213455
distance x is tensor(105.6487, device='cuda:0')
benign distance is  tensor(105.6487, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.6489769890904427
distance x is tensor(105.2578, device='cuda:0')
benign distance is  tensor(105.2578, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3526569977402687
distance x is tensor(110.0649, device='cuda:0')
benign distance is  tensor(110.0649, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.9361138567328453
distance x is tensor(96.6872, device='cuda:0')
benign distance is  tensor(96.6872, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.377341128885746
distance x is tensor(104.9356, device='cuda:0')
benign distance is  tensor(104.9356, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.719130426645279
distance x is tensor(123.5072, device='cuda:0')
benign distance is  tensor(123.5072, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.2699377089738846
distance x is tensor(89.2467, device='cuda:0')
benign distance is  tensor(89.2467, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.183528169989586
distance x is tensor(109.3582, device='cuda:0')
benign distance is  tensor(109.3582, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.5283366963267326
distance x is tensor(148.4459, device='cuda:0')
benign distance is  tensor(148.4459, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.5228646025061607
distance x is tensor(83.0172, device='cuda:0')
benign distance is  tensor(83.0172, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.8181357011198997
distance x is tensor(140.4764, device='cuda:0')
benign distance is  tensor(140.4764, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  5.060867145657539
distance x is tensor(125.3801, device='cuda:0')
benign distance is  tensor(125.3801, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.9049085527658463
distance x is tensor(107.4353, device='cuda:0')
benign distance is  tensor(107.4353, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.766988955438137
distance x is tensor(110.1074, device='cuda:0')
benign distance is  tensor(110.1074, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.1048049852252007
distance x is tensor(116.5958, device='cuda:0')
benign distance is  tensor(116.5958, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.7127919793128967
distance x is tensor(131.6671, device='cuda:0')
benign distance is  tensor(131.6671, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.705484464764595
distance x is tensor(98.5184, device='cuda:0')
benign distance is  tensor(98.5184, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.5510564893484116
distance x is tensor(197.9357, device='cuda:0')
benign distance is  tensor(197.9357, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.8605024442076683
distance x is tensor(157.5322, device='cuda:0')
benign distance is  tensor(157.5322, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.7521307319402695
distance x is tensor(118.3562, device='cuda:0')
benign distance is  tensor(118.3562, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.2915305234491825
distance x is tensor(117.6041, device='cuda:0')
benign distance is  tensor(117.6041, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.9755327999591827
distance x is tensor(98.6319, device='cuda:0')
benign distance is  tensor(98.6319, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  2.8702402114868164
distance x is tensor(119.2425, device='cuda:0')
benign distance is  tensor(119.2425, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  4.460917502641678
distance x is tensor(119.9608, device='cuda:0')
benign distance is  tensor(119.9608, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.9875631369650364
distance x is tensor(121.3509, device='cuda:0')
benign distance is  tensor(121.3509, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.8341044783592224
distance x is tensor(104.2726, device='cuda:0')
benign distance is  tensor(104.2726, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.7506893947720528
distance x is tensor(95.6651, device='cuda:0')
benign distance is  tensor(95.6651, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.929631756618619
distance x is tensor(117.9000, device='cuda:0')
benign distance is  tensor(117.9000, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  3.3920067101716995
distance x is tensor(94.9697, device='cuda:0')
benign distance is  tensor(94.9697, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  3.1472093015909195
distance x is tensor(127.9751, device='cuda:0')
benign distance is  tensor(127.9751, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.4923833906650543
distance x is tensor(144.5452, device='cuda:0')
benign distance is  tensor(144.5452, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  2.0145630538463593
distance x is tensor(87.6624, device='cuda:0')
benign distance is  tensor(87.6624, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.3299555592238903
distance x is tensor(139.8856, device='cuda:0')
benign distance is  tensor(139.8856, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.015156202018261
distance x is tensor(124.3718, device='cuda:0')
benign distance is  tensor(124.3718, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  3.7550677210092545
distance x is tensor(99.9740, device='cuda:0')
benign distance is  tensor(99.9740, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.708935210481286
distance x is tensor(136.5473, device='cuda:0')
benign distance is  tensor(136.5473, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 607.1288,  442.1280,  399.6368,  590.5092,  461.1051,  465.4132,
         470.9819,  423.0338,  874.9025,  986.5940,  883.5903,  911.3257,
         848.5493,  907.4765,  967.4835,  853.4807,  941.4765,  892.1537,
         921.1899, 1048.9105], device='cuda:0') 51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 44
counter_tensor is  tensor([ 9., 24., 40., 23.,  4., 40., 43.,  4., 17., 17., 17., 17., 17., 17.,
        17., 17., 17., 17., 17., 17., 43., 20., 38., 43., 35., 36., 20., 36.,
        43., 43., 34., 41., 43., 34.,  1.,  1., 43., 30., 42., 42., 32., 21.,
         0.,  6.])
count_res tensor([2.1478e-16, 7.0212e-10, 6.2391e-03, 2.5830e-10, 1.4472e-18, 6.2391e-03,
        1.2532e-01, 1.4472e-18, 6.4025e-13, 6.4025e-13, 6.4025e-13, 6.4025e-13,
        6.4025e-13, 6.4025e-13, 6.4025e-13, 6.4025e-13, 6.4025e-13, 6.4025e-13,
        6.4025e-13, 6.4025e-13, 1.2532e-01, 1.2860e-11, 8.4437e-04, 1.2532e-01,
        4.2039e-05, 1.1427e-04, 1.2860e-11, 1.1427e-04, 1.2532e-01, 1.2532e-01,
        1.5465e-05, 1.6960e-02, 1.2532e-01, 1.5465e-05, 7.2051e-20, 7.2051e-20,
        1.2532e-01, 2.8326e-07, 4.6101e-02, 4.6101e-02, 2.0930e-06, 3.4956e-11,
        2.6506e-20, 1.0693e-17])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 88.91% 

Test Accuracy: 87.49% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7014642730355263
distance x is tensor(109.6476, device='cuda:1')
benign distance is  tensor(109.6476, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7779924925416708
distance x is tensor(101.4927, device='cuda:1')
benign distance is  tensor(101.4927, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6868705246597528
distance x is tensor(112.7461, device='cuda:1')
benign distance is  tensor(112.7461, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8864336721599102
distance x is tensor(150.5323, device='cuda:1')
benign distance is  tensor(150.5323, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0131913963705301
distance x is tensor(89.5807, device='cuda:1')
benign distance is  tensor(89.5807, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7049332009628415
distance x is tensor(103.8846, device='cuda:1')
benign distance is  tensor(103.8846, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8762214835733175
distance x is tensor(90.6400, device='cuda:1')
benign distance is  tensor(90.6400, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6065273405984044
distance x is tensor(86.3518, device='cuda:1')
benign distance is  tensor(86.3518, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.8230294976383448
distance x is tensor(90.8971, device='cuda:1')
benign distance is  tensor(90.8971, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6106079593300819
distance x is tensor(129.2769, device='cuda:1')
benign distance is  tensor(129.2769, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9373033940792084
distance x is tensor(77.7421, device='cuda:1')
benign distance is  tensor(77.7421, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3783363364636898
distance x is tensor(107.0863, device='cuda:1')
benign distance is  tensor(107.0863, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.055127089843154
distance x is tensor(156.7722, device='cuda:1')
benign distance is  tensor(156.7722, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.807054877281189
distance x is tensor(69.4966, device='cuda:1')
benign distance is  tensor(69.4966, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8996157646179199
distance x is tensor(135.4766, device='cuda:1')
benign distance is  tensor(135.4766, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.4332966282963753
distance x is tensor(122.0001, device='cuda:1')
benign distance is  tensor(122.0001, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1121220290660858
distance x is tensor(87.8734, device='cuda:1')
benign distance is  tensor(87.8734, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7413522154092789
distance x is tensor(100.0801, device='cuda:1')
benign distance is  tensor(100.0801, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8381391260772943
distance x is tensor(110.6723, device='cuda:1')
benign distance is  tensor(110.6723, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7693871259689331
distance x is tensor(119.8938, device='cuda:1')
benign distance is  tensor(119.8938, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9386343248188496
distance x is tensor(68.3818, device='cuda:1')
benign distance is  tensor(68.3818, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7119764108210802
distance x is tensor(204.0223, device='cuda:1')
benign distance is  tensor(204.0223, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1260484866797924
distance x is tensor(147.7758, device='cuda:1')
benign distance is  tensor(147.7758, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7382461335510015
distance x is tensor(109.7977, device='cuda:1')
benign distance is  tensor(109.7977, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.1440442651510239
distance x is tensor(101.7809, device='cuda:1')
benign distance is  tensor(101.7809, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.6271437779068947
distance x is tensor(136.7247, device='cuda:1')
benign distance is  tensor(136.7247, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.2105556465685368
distance x is tensor(144.0751, device='cuda:1')
sorted_norm is   tensor([ 399.6368,  423.0338,  442.1280,  461.1051,  465.4132,  470.9819,
         590.5092,  607.1288,  848.5493,  853.4807,  874.9025,  883.5903,
         892.1537,  907.4765,  911.3257,  921.1899,  941.4765,  967.4835,
         986.5940, 1048.9105], device='cuda:0')
used idx is  tensor([ 2,  7,  1,  4,  5,  6,  3,  0, 12, 15,  8, 10, 17, 13, 11, 18],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.7546445652842522
distance x is tensor(61.0587, device='cuda:0')
benign distance is  tensor(61.0587, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.7093326821923256
distance x is tensor(49.1358, device='cuda:0')
benign distance is  tensor(49.1358, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.1811622828245163
distance x is tensor(35.5048, device='cuda:0')
benign distance is  tensor(35.5048, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.253494620323181
distance x is tensor(108.2621, device='cuda:0')
benign distance is  tensor(108.2621, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.4030183032155037
distance x is tensor(64.1587, device='cuda:0')
benign distance is  tensor(64.1587, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.131094478070736
distance x is tensor(42.2558, device='cuda:0')
benign distance is  tensor(42.2558, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.8580612391233444
distance x is tensor(70.4452, device='cuda:0')
benign distance is  tensor(70.4452, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.6369363218545914
distance x is tensor(20.1867, device='cuda:0')
benign distance is  tensor(20.1867, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([509.7589, 476.4338, 362.3438, 714.1318, 529.3483, 362.6115, 549.3838,
        290.2658, 311.2121, 577.3177, 364.5907, 574.0682, 510.1278, 447.3901,
        563.1334, 558.8227, 461.5845, 543.6183, 523.4747, 674.0795, 738.6534,
        626.7343, 740.0920, 688.9732, 723.7451, 712.0834, 724.6765, 846.1138,
        654.2853, 736.9764, 586.3891, 666.2925, 825.6611, 570.4959, 798.8376,
        718.9249], device='cuda:0')
sorted_norm is   tensor([290.2658, 311.2121, 362.3438, 362.6115, 364.5907, 447.3901, 461.5845,
        476.4338, 509.7589, 510.1278, 523.4747, 529.3483, 543.6183, 549.3838,
        558.8227, 563.1334, 570.4959, 574.0682, 577.3177, 586.3891, 626.7343,
        654.2853, 666.2925, 674.0795, 688.9732, 712.0834, 714.1318, 718.9249,
        723.7451, 724.6765, 736.9764, 738.6534, 740.0920, 798.8376, 825.6611,
        846.1138], device='cuda:0')
used idx is  tensor([ 7,  8,  2,  5, 10, 13, 16,  1,  0, 12, 18,  4, 17,  6, 15, 14, 33, 11,
         9, 30, 21, 28, 31, 19, 23, 25,  3, 35], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 33.71% 

Test Accuracy: 25.53% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0097979307174683
distance x is tensor(154.1855, device='cuda:0')
benign distance is  tensor(154.1855, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.01971685141325
distance x is tensor(112.4782, device='cuda:0')
benign distance is  tensor(112.4782, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.733673833310604
distance x is tensor(91.0300, device='cuda:0')
benign distance is  tensor(91.0300, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.313880518078804
distance x is tensor(151.0966, device='cuda:0')
benign distance is  tensor(151.0966, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.425835020840168
distance x is tensor(126.3857, device='cuda:0')
benign distance is  tensor(126.3857, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.8663802072405815
distance x is tensor(119.4525, device='cuda:0')
benign distance is  tensor(119.4525, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.5145634040236473
distance x is tensor(122.5408, device='cuda:0')
benign distance is  tensor(122.5408, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.9022383391857147
distance x is tensor(105.8844, device='cuda:0')
benign distance is  tensor(105.8844, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.4366458281874657
distance x is tensor(121.2767, device='cuda:0')
benign distance is  tensor(121.2767, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.7069008350372314
distance x is tensor(132.4655, device='cuda:0')
benign distance is  tensor(132.4655, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.2701202034950256
distance x is tensor(107.3829, device='cuda:0')
benign distance is  tensor(107.3829, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.158383101224899
distance x is tensor(126.2441, device='cuda:0')
benign distance is  tensor(126.2441, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.581942468881607
distance x is tensor(148.2354, device='cuda:0')
benign distance is  tensor(148.2354, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.6857201606035233
distance x is tensor(99.8825, device='cuda:0')
benign distance is  tensor(99.8825, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.7749395668506622
distance x is tensor(145.1060, device='cuda:0')
benign distance is  tensor(145.1060, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  5.335864543914795
distance x is tensor(131.3820, device='cuda:0')
benign distance is  tensor(131.3820, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.8479060605168343
distance x is tensor(134.1238, device='cuda:0')
benign distance is  tensor(134.1238, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  2.2940748184919357
distance x is tensor(101.4897, device='cuda:0')
benign distance is  tensor(101.4897, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.173179715871811
distance x is tensor(142.5302, device='cuda:0')
benign distance is  tensor(142.5302, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  4.430268511176109
distance x is tensor(120.4434, device='cuda:0')
benign distance is  tensor(120.4434, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.8329344540834427
distance x is tensor(132.6992, device='cuda:0')
benign distance is  tensor(132.6992, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.8783970549702644
distance x is tensor(140.4290, device='cuda:0')
benign distance is  tensor(140.4290, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.73315654322505
distance x is tensor(132.7046, device='cuda:0')
benign distance is  tensor(132.7046, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.5599822774529457
distance x is tensor(154.6660, device='cuda:0')
benign distance is  tensor(154.6660, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([651.9459, 484.6945, 430.0467, 640.1030, 534.1652, 519.1434, 523.9519,
        467.2771, 717.8136, 828.5482, 713.3466, 748.8043, 686.6420, 740.0571,
        805.1821, 688.7758, 790.1273, 733.5793, 757.4050, 892.6831, 548.0057,
        568.3074, 593.1224, 648.0342, 517.7357, 926.0574, 738.9203, 614.3215],
       device='cuda:0')
sorted_norm is   tensor([430.0467, 467.2771, 484.6945, 517.7357, 519.1434, 523.9519, 534.1652,
        548.0057, 568.3074, 593.1224, 614.3215, 640.1030, 648.0342, 651.9459,
        686.6420, 688.7758, 713.3466, 717.8136, 733.5793, 738.9203, 740.0571,
        748.8043, 757.4050, 790.1273, 805.1821, 828.5482, 892.6831, 926.0574],
       device='cuda:0')
used idx is  tensor([ 2,  7,  1, 24,  5,  6,  4, 20, 21, 22, 27,  3, 23,  0, 12, 15, 10,  8,
        17, 26, 13, 11], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 13.08% 

Test Accuracy: 30.85% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8711496591567993
distance x is tensor(150.9773, device='cuda:0')
benign distance is  tensor(150.9773, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.44473222643137
distance x is tensor(111.1136, device='cuda:0')
benign distance is  tensor(111.1136, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.4487534761428833
distance x is tensor(92.4176, device='cuda:0')
benign distance is  tensor(92.4176, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
benign distance is  tensor(144.0751, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.8848889525979757
distance x is tensor(87.4833, device='cuda:1')
benign distance is  tensor(87.4833, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6291849091649055
distance x is tensor(153.5445, device='cuda:1')
benign distance is  tensor(153.5445, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8785550370812416
distance x is tensor(135.2025, device='cuda:1')
benign distance is  tensor(135.2025, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.882947850972414
distance x is tensor(91.1560, device='cuda:1')
benign distance is  tensor(91.1560, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5804886007681489
distance x is tensor(114.1779, device='cuda:1')
benign distance is  tensor(114.1779, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([14., 19., 18., 13., 15., 18., 19., 14., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([0.0005, 0.0677, 0.0249, 0.0002, 0.0012, 0.0249, 0.0677, 0.0005, 0.0677,
        0.0677, 0.0677, 0.0677, 0.0677, 0.0677, 0.0677, 0.0677, 0.0677, 0.0677,
        0.0677, 0.0677])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 0.65% 

Test Accuracy: 10.01% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.7500773668289185
distance x is tensor(3138.7180, device='cuda:1')
benign distance is  tensor(3138.7180, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.2001559138298035
distance x is tensor(3619.8845, device='cuda:1')
benign distance is  tensor(3619.8845, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.1039927154779434
distance x is tensor(2883.5491, device='cuda:1')
benign distance is  tensor(2883.5491, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.9079141169786453
distance x is tensor(5446.4941, device='cuda:1')
benign distance is  tensor(5446.4941, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.991964489221573
distance x is tensor(3050.9902, device='cuda:1')
benign distance is  tensor(3050.9902, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.5786521583795547
distance x is tensor(3867.4785, device='cuda:1')
benign distance is  tensor(3867.4785, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.7997254878282547
distance x is tensor(5032.7280, device='cuda:1')
benign distance is  tensor(5032.7280, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.718269780278206
distance x is tensor(3148.3259, device='cuda:1')
benign distance is  tensor(3148.3259, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 36
counter_tensor is  tensor([28., 28., 28., 28., 28., 28., 28., 28., 17., 17., 17., 17., 17., 17.,
        17., 17., 17., 17., 17., 17., 33.,  8.,  0., 24., 21., 35., 35., 23.,
        18., 35., 28.,  3., 35., 25., 34.,  8.])
count_res tensor([2.0212e-04, 2.0212e-04, 2.0212e-04, 2.0212e-04, 2.0212e-04, 2.0212e-04,
        2.0212e-04, 2.0212e-04, 3.3758e-09, 3.3758e-09, 3.3758e-09, 3.3758e-09,
        3.3758e-09, 3.3758e-09, 3.3758e-09, 3.3758e-09, 3.3758e-09, 3.3758e-09,
        3.3758e-09, 3.3758e-09, 2.9998e-02, 4.1661e-13, 1.3976e-16, 3.7020e-06,
        1.8431e-07, 2.2166e-01, 2.2166e-01, 1.3619e-06, 9.1764e-09, 2.2166e-01,
        2.0212e-04, 2.8071e-15, 2.2166e-01, 1.0063e-05, 8.1543e-02, 4.1661e-13])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 91.03% 

Test Accuracy: 87.45% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6270028054714203
distance x is tensor(108.7390, device='cuda:1')
benign distance is  tensor(108.7390, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0824146158993244
distance x is tensor(115.6277, device='cuda:1')
benign distance is  tensor(115.6277, device='cuda:1')
 benign loss is  2.565747916698456
distance x is tensor(145.3325, device='cuda:0')
benign distance is  tensor(145.3325, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.790173590183258
distance x is tensor(120.0753, device='cuda:0')
benign distance is  tensor(120.0753, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.551488108932972
distance x is tensor(111.8936, device='cuda:0')
benign distance is  tensor(111.8936, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.546604886651039
distance x is tensor(115.9415, device='cuda:0')
benign distance is  tensor(115.9415, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.217795990407467
distance x is tensor(100.9277, device='cuda:0')
benign distance is  tensor(100.9277, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.635672375559807
distance x is tensor(102.3834, device='cuda:0')
benign distance is  tensor(102.3834, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.1586787328124046
distance x is tensor(115.2785, device='cuda:0')
benign distance is  tensor(115.2785, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  3.191017985343933
distance x is tensor(123.8825, device='cuda:0')
benign distance is  tensor(123.8825, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.103772312402725
distance x is tensor(134.1102, device='cuda:0')
benign distance is  tensor(134.1102, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.0810849219560623
distance x is tensor(115.8071, device='cuda:0')
benign distance is  tensor(115.8071, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.4492922872304916
distance x is tensor(208.3183, device='cuda:0')
benign distance is  tensor(208.3183, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.2171473130583763
distance x is tensor(162.4415, device='cuda:0')
benign distance is  tensor(162.4415, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.7545849680900574
distance x is tensor(125.2562, device='cuda:0')
benign distance is  tensor(125.2562, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([625.8730, 464.6921, 433.3138, 612.4712, 510.7985, 482.9702, 491.5468,
        430.5285, 803.3102, 919.6765, 809.3717, 841.6852, 770.3788, 840.4448,
        907.9843, 786.7001, 868.7493, 824.8833, 857.7133, 993.1661, 494.6427,
        544.9838, 422.3656, 518.6216, 618.6245, 402.6217, 588.9191, 535.0651],
       device='cuda:0')
sorted_norm is   tensor([402.6217, 422.3656, 430.5285, 433.3138, 464.6921, 482.9702, 491.5468,
        494.6427, 510.7985, 518.6216, 535.0651, 544.9838, 588.9191, 612.4712,
        618.6245, 625.8730, 770.3788, 786.7001, 803.3102, 809.3717, 824.8833,
        840.4448, 841.6852, 857.7133, 868.7493, 907.9843, 919.6765, 993.1661],
       device='cuda:0')
used idx is  tensor([25, 22,  7,  2,  1,  5,  6, 20,  4, 23, 27, 21, 26,  3, 24,  0, 12, 15,
         8, 10, 17, 13], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 24.94% 

Test Accuracy: 55.21% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8706784509122372
distance x is tensor(141.0560, device='cuda:0')
benign distance is  tensor(141.0560, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.2642660588026047
distance x is tensor(108.1619, device='cuda:0')
benign distance is  tensor(108.1619, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.0805844962596893
distance x is tensor(92.5837, device='cuda:0')
benign distance is  tensor(92.5837, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.2842458933591843
distance x is tensor(148.7234, device='cuda:0')
benign distance is  tensor(148.7234, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.149384632706642
distance x is tensor(115.9692, device='cuda:0')
benign distance is  tensor(115.9692, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.728024996817112
distance x is tensor(106.8602, device='cuda:0')
benign distance is  tensor(106.8602, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2581735476851463
distance x is tensor(111.8194, device='cuda:0')
benign distance is  tensor(111.8194, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.8806060999631882
distance x is tensor(97.2057, device='cuda:0')
benign distance is  tensor(97.2057, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.1458271965384483
distance x is tensor(105.2431, device='cuda:0')
benign distance is  tensor(105.2431, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.1285298615694046
distance x is tensor(137.4775, device='cuda:0')
benign distance is  tensor(137.4775, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.210121102631092
distance x is tensor(97.3688, device='cuda:0')
benign distance is  tensor(97.3688, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.674195110797882
distance x is tensor(115.0724, device='cuda:0')
benign distance is  tensor(115.0724, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.430618353188038
distance x is tensor(143.1352, device='cuda:0')
benign distance is  tensor(143.1352, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.617128349840641
distance x is tensor(84.6411, device='cuda:0')
benign distance is  tensor(84.6411, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.0440956875681877
distance x is tensor(139.1741, device='cuda:0')
benign distance is  tensor(139.1741, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.9202988296747208
distance x is tensor(121.5612, device='cuda:0')
benign distance is  tensor(121.5612, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 598.3295,  461.9556,  430.4846,  627.1508,  497.1679,  472.2051,
         478.9359,  433.7272,  827.9207,  938.2280,  836.7312,  876.8292,
         810.4860,  866.5831,  903.8806,  795.8304,  902.3518,  850.0122,
         885.2987, 1002.6638,  568.2317,  470.3349,  573.4207,  553.5903,
         574.4120,  480.8640,  447.7958,  562.4634], device='cuda:0')
sorted_norm is   tensor([ 430.4846,  433.7272,  447.7958,  461.9556,  470.3349,  472.2051,
         478.9359,  480.8640,  497.1679,  553.5903,  562.4634,  568.2317,
         573.4207,  574.4120,  598.3295,  627.1508,  795.8304,  810.4860,
         827.9207,  836.7312,  850.0122,  866.5831,  876.8292,  885.2987,
         902.3518,  903.8806,  938.2280, 1002.6638], device='cuda:0')
used idx is  tensor([ 2,  7, 26,  1, 21,  5,  6, 25,  4, 23, 27, 20, 22, 24,  0,  3, 15, 12,
         8, 10, 17, 13], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 28.02% 

Test Accuracy: 54.14% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0001284591853619
distance x is tensor(142.8249, device='cuda:0')
benign distance is  tensor(142.8249, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.0911752805113792
distance x is tensor(108.8451, device='cuda:0')
benign distance is  tensor(108.8451, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.204069696366787
distance x is tensor(87.7056, device='cuda:0')
benign distance is  tensor(87.7056, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.9770092740654945
distance x is tensor(145.3305, device='cuda:0')
benign distance is  tensor(145.3305, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.7240266129374504
distance x is tensor(108.9325, device='cuda:0')
benign distance is  tensor(108.9325, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3704055361449718
distance x is tensor(109.4722, device='cuda:0')
benign distance is  tensor(109.4722, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.767172858119011
distance x is tensor(116.0845, device='cuda:0')
benign distance is  tensor(116.0845, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.1787915751338005
distance x is tensor(101.4419, device='cuda:0')
benign distance is  tensor(101.4419, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.1514066234230995
distance x is tensor(123.3281, device='cuda:0')
benign distance is  tensor(123.3281, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.9580987468361855
distance x is tensor(105.3386, device='cuda:0')
benign distance is  tensor(105.3386, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  2.3378985971212387
distance x is tensor(127.2777, device='cuda:0')
benign distance is  tensor(127.2777, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  4.181435480713844
distance x is tensor(122.8664, device='cuda:0')
benign distance is  tensor(122.8664, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.0964297465980053
distance x is tensor(118.8204, device='cuda:0')
benign distance is  tensor(118.8204, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.8164787739515305
distance x is tensor(106.3034, device='cuda:0')
benign distance is  tensor(106.3034, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.525502197444439
distance x is tensor(102.3799, device='cuda:0')
benign distance is  tensor(102.3799, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9192347228527069
distance x is tensor(128.3476, device='cuda:0')
benign distance is  tensor(128.3476, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 603.9679,  462.3013,  401.9382,  607.7880,  465.6210,  475.1099,
         487.4787,  443.8722,  862.4715,  986.7546,  884.2866,  908.9108,
         850.9702,  890.9411,  943.6948,  847.3465,  942.1541,  873.5839,
         911.7146, 1041.5682,  431.4623,  573.6790,  636.7649,  429.6561,
         632.5649,  559.7620,  465.3735,  610.5169,  520.9431,  458.3782,
         543.7661,  476.9577,  514.0773,  578.3019,  541.2001,  627.2070,
         430.0174,  478.1736,  512.3122,  555.8037,  465.6270,  864.9319,
         659.4036,  531.3876,  464.1111,  599.3899,  419.5336,  507.4698,
         624.8985,  378.9583,  608.9323,  532.0171], device='cuda:0')
sorted_norm is   tensor([ 378.9583,  401.9382,  419.5336,  429.6561,  430.0174,  431.4623,
         443.8722,  458.3782,  462.3013,  464.1111,  465.3735,  465.6210,
         465.6270,  475.1099,  476.9577,  478.1736,  487.4787,  507.4698,
         512.3122,  514.0773,  520.9431,  531.3876,  532.0171,  541.2001,
         543.7661,  555.8037,  559.7620,  573.6790,  578.3019,  599.3899,
         603.9679,  607.7880,  608.9323,  610.5169,  624.8985,  627.2070,
         632.5649,  636.7649,  659.4036,  847.3465,  850.9702,  862.4715,
         864.9319,  873.5839,  884.2866,  890.9411,  908.9108,  911.7146,
         942.1541,  943.6948,  986.7546, 1041.5682], device='cuda:0')
used idx is  tensor([49,  2, 46, 23, 36, 20,  7, 29,  1, 44, 26,  4, 40,  5, 31, 37,  6, 47,
        38, 32, 28, 43, 51, 34, 30, 39, 25, 21, 33, 45,  0,  3, 50, 27, 48, 35,
        24, 22, 42, 15, 12], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 41.82% 

Test Accuracy: 70.65% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7483062017709017
distance x is tensor(121.6546, device='cuda:0')
benign distance is  tensor(121.6546, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.887703314423561
distance x is tensor(92.1119, device='cuda:0')
benign distance is  tensor(92.1119, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.78981015086174
distance x is tensor(77.2054, device='cuda:0')
benign distance is  tensor(77.2054, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.0846534818410873
distance x is tensor(119.5529, device='cuda:0')
benign distance is  tensor(119.5529, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3141505047678947
distance x is tensor(85.3657, device='cuda:0')
benign distance is  tensor(85.3657, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3315504565835
distance x is tensor(89.9963, device='cuda:0')
benign distance is  tensor(89.9963, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.493818052113056
distance x is tensor(83.7756, device='cuda:0')
benign distance is  tensor(83.7756, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.0982237458229065
distance x is tensor(80.5325, device='cuda:0')
benign distance is  tensor(80.5325, device='cuda:0')
current submit client idx and staleness is 
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5557343233376741
distance x is tensor(114.4339, device='cuda:1')
benign distance is  tensor(114.4339, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8624022640287876
distance x is tensor(151.0422, device='cuda:1')
benign distance is  tensor(151.0422, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9307068008929491
distance x is tensor(103.3731, device='cuda:1')
benign distance is  tensor(103.3731, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6519184792414308
distance x is tensor(95.5918, device='cuda:1')
benign distance is  tensor(95.5918, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.27639389783144
distance x is tensor(103.8541, device='cuda:1')
benign distance is  tensor(103.8541, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4900324633345008
distance x is tensor(84.6942, device='cuda:1')
benign distance is  tensor(84.6942, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9584431573748589
distance x is tensor(98.2584, device='cuda:1')
benign distance is  tensor(98.2584, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6153858071193099
distance x is tensor(105.9413, device='cuda:1')
benign distance is  tensor(105.9413, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.037643525749445
distance x is tensor(75.7693, device='cuda:1')
benign distance is  tensor(75.7693, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2367958948016167
distance x is tensor(114.7138, device='cuda:1')
benign distance is  tensor(114.7138, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.126853123307228
distance x is tensor(160.3894, device='cuda:1')
benign distance is  tensor(160.3894, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9349980093538761
distance x is tensor(74.0400, device='cuda:1')
benign distance is  tensor(74.0400, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9798092655837536
distance x is tensor(148.1168, device='cuda:1')
benign distance is  tensor(148.1168, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1464440561830997
distance x is tensor(118.7803, device='cuda:1')
benign distance is  tensor(118.7803, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.9769005309790373
distance x is tensor(103.2734, device='cuda:1')
benign distance is  tensor(103.2734, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6979967318475246
distance x is tensor(107.2911, device='cuda:1')
benign distance is  tensor(107.2911, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.785687793046236
distance x is tensor(123.6733, device='cuda:1')
benign distance is  tensor(123.6733, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2402688059955835
distance x is tensor(116.0749, device='cuda:1')
benign distance is  tensor(116.0749, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.685050898231566
distance x is tensor(112.3830, device='cuda:1')
benign distance is  tensor(112.3830, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7068869145587087
distance x is tensor(99.9502, device='cuda:1')
benign distance is  tensor(99.9502, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5869880113750696
distance x is tensor(101.8668, device='cuda:1')
benign distance is  tensor(101.8668, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7382516283541918
distance x is tensor(165.4404, device='cuda:1')
benign distance is  tensor(165.4404, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([24., 26., 23., 14., 19., 21.,  3., 21., 15., 15., 15., 15., 15., 15.,
        15., 15., 15., 15., 15., 15., 17., 21., 26., 26., 15., 27., 18., 27.])
count_res tensor([1.5657e-02, 1.1569e-01, 5.7601e-03, 7.1085e-07, 1.0550e-04, 7.7954e-04,
        1.1872e-11, 7.7954e-04, 1.9323e-06, 1.9323e-06, 1.9323e-06, 1.9323e-06,
        1.9323e-06, 1.9323e-06, 1.9323e-06, 1.9323e-06, 1.9323e-06, 1.9323e-06,
        1.9323e-06, 1.9323e-06, 1.4278e-05, 7.7954e-04, 1.1569e-01, 1.1569e-01,
        1.9323e-06, 3.1449e-01, 3.8811e-05, 3.1449e-01])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 84.75% 

Test Accuracy: 86.41% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6070357840508223
distance x is tensor(128.6609, device='cuda:1')
benign distance is  tensor(128.6609, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.910049975849688
distance x is tensor(99.6601, device='cuda:1')
benign distance is  tensor(99.6601, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6167599596083164
distance x is tensor(104.7334, device='cuda:1')
benign distance is  tensor(104.7334, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0833833441138268
distance x is tensor(151.7208, device='cuda:1')
benign distance is  tensor(151.7208, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.9665881544351578
distance x is tensor(84.6971, device='cuda:0')
benign distance is  tensor(84.6971, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.205842986702919
distance x is tensor(111.3977, device='cuda:0')
benign distance is  tensor(111.3977, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.4893481135368347
distance x is tensor(69.9732, device='cuda:0')
benign distance is  tensor(69.9732, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.9959093034267426
distance x is tensor(91.6327, device='cuda:0')
benign distance is  tensor(91.6327, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.658314935863018
distance x is tensor(122.3046, device='cuda:0')
benign distance is  tensor(122.3046, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.603979952633381
distance x is tensor(55.9287, device='cuda:0')
benign distance is  tensor(55.9287, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.5179710015654564
distance x is tensor(117.4226, device='cuda:0')
benign distance is  tensor(117.4226, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.126088991761208
distance x is tensor(95.0193, device='cuda:0')
benign distance is  tensor(95.0193, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.079269379377365
distance x is tensor(75.0216, device='cuda:0')
benign distance is  tensor(75.0216, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.7921939939260483
distance x is tensor(86.7154, device='cuda:0')
benign distance is  tensor(86.7154, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.1480718553066254
distance x is tensor(98.4176, device='cuda:0')
benign distance is  tensor(98.4176, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.135104313492775
distance x is tensor(108.1336, device='cuda:0')
benign distance is  tensor(108.1336, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.9505511373281479
distance x is tensor(85.7844, device='cuda:0')
benign distance is  tensor(85.7844, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.4922268465161324
distance x is tensor(175.6319, device='cuda:0')
benign distance is  tensor(175.6319, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.5920569226145744
distance x is tensor(131.7448, device='cuda:0')
benign distance is  tensor(131.7448, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.6237508356571198
distance x is tensor(90.3005, device='cuda:0')
benign distance is  tensor(90.3005, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.3083158135414124
distance x is tensor(107.9636, device='cuda:0')
benign distance is  tensor(107.9636, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.5911318138241768
distance x is tensor(69.3159, device='cuda:0')
benign distance is  tensor(69.3159, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.6338221579790115
distance x is tensor(103.6856, device='cuda:0')
benign distance is  tensor(103.6856, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  3.109081909060478
distance x is tensor(89.4818, device='cuda:0')
benign distance is  tensor(89.4818, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.7849446386098862
distance x is tensor(97.5366, device='cuda:0')
benign distance is  tensor(97.5366, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.5899770334362984
distance x is tensor(94.9059, device='cuda:0')
benign distance is  tensor(94.9059, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7414298001676798
distance x is tensor(91.5693, device='cuda:0')
benign distance is  tensor(91.5693, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.014932729303837
distance x is tensor(134.9864, device='cuda:0')
benign distance is  tensor(134.9864, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.462834417819977
distance x is tensor(88.2815, device='cuda:0')
benign distance is  tensor(88.2815, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  3.731846198439598
distance x is tensor(112.4741, device='cuda:0')
benign distance is  tensor(112.4741, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.606063909828663
distance x is tensor(124.1591, device='cuda:0')
benign distance is  tensor(124.1591, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.8263938501477242
distance x is tensor(74.0896, device='cuda:0')
benign distance is  tensor(74.0896, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.559358648955822
distance x is tensor(126.1866, device='cuda:0')
benign distance is  tensor(126.1866, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.3462145999073982
distance x is tensor(116.8818, device='cuda:0')
benign distance is  tensor(116.8818, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  2.675571635365486
distance x is tensor(80.7532, device='cuda:0')
benign distance is  tensor(80.7532, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6614690627902746
distance x is tensor(113.8163, device='cuda:0')
benign distance is  tensor(113.8163, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 541.1636,  412.6536,  367.4682,  521.3629,  384.9590,  400.9670,
         369.5476,  360.8035, 1151.0424, 1248.7958, 1164.3004, 1216.5837,
        1145.6625, 1181.2893, 1219.9297, 1138.5167, 1245.9282, 1156.2607,
        1201.7340, 1306.0983], device='cuda:0')
sorted_norm is   tensor([ 360.8035,  367.4682,  369.5476,  384.9590,  400.9670,  412.6536,
         521.3629,  541.1636, 1138.5167, 1145.6625, 1151.0424, 1156.2607,
        1164.3004, 1181.2893, 1201.7340, 1216.5837, 1219.9297, 1245.9282,
        1248.7958, 1306.0983], device='cuda:0')
used idx is  tensor([ 7,  2,  6,  4,  5,  1,  3,  0, 15, 12,  8, 17, 10, 13, 18, 11],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.4324655272066593
distance x is tensor(118.4814, device='cuda:0')
benign distance is  tensor(118.4814, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.1886217296123505
distance x is tensor(73.9239, device='cuda:0')
benign distance is  tensor(73.9239, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.5386122465133667
distance x is tensor(44.5948, device='cuda:0')
benign distance is  tensor(44.5948, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.6426171213388443
distance x is tensor(125.0656, device='cuda:0')
benign distance is  tensor(125.0656, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.5852062106132507
distance x is tensor(58.5133, device='cuda:0')
benign distance is  tensor(58.5133, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.200643591582775
distance x is tensor(41.2440, device='cuda:0')
benign distance is  tensor(41.2440, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.8790618032217026
distance x is tensor(85.6315, device='cuda:0')
benign distance is  tensor(85.6315, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.753229260444641
distance x is tensor(31.5628, device='cuda:0')
benign distance is  tensor(31.5628, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([726.3690, 505.7980, 375.9746, 732.7800, 532.9541, 323.5695, 593.7427,
        333.7044, 312.3110, 621.3897, 521.0078, 583.7428, 540.7071, 485.1035,
        560.0189, 536.7481, 490.8074, 607.5938, 537.7554, 664.9448, 726.8483,
        813.9773, 658.1970, 734.2528, 856.1571, 624.6483, 843.5668, 743.5331],
       device='cuda:0')
sorted_norm is   tensor([312.3110, 323.5695, 333.7044, 375.9746, 485.1035, 490.8074, 505.7980,
        521.0078, 532.9541, 536.7481, 537.7554, 540.7071, 560.0189, 583.7428,
        593.7427, 607.5938, 621.3897, 624.6483, 658.1970, 664.9448, 726.3690,
        726.8483, 732.7800, 734.2528, 743.5331, 813.9773, 843.5668, 856.1571],
       device='cuda:0')
used idx is  tensor([ 8,  5,  7,  2, 13, 16,  1, 10,  4, 15, 18, 12, 14, 11,  6, 17,  9, 25,
        22, 19,  0, 20], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 34.86% 

Test Accuracy: 10.00% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8991042971611023
distance x is tensor(151.4906, device='cuda:0')
benign distance is  tensor(151.4906, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.382226027548313
distance x is tensor(99.2018, device='cuda:0')
benign distance is  tensor(99.2018, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2313641160726547
distance x is tensor(90.7945, device='cuda:1')
benign distance is  tensor(90.7945, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7043541735038161
distance x is tensor(99.6123, device='cuda:1')
benign distance is  tensor(99.6123, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1454917937517166
distance x is tensor(85.9686, device='cuda:1')
benign distance is  tensor(85.9686, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7634495999664068
distance x is tensor(85.1854, device='cuda:1')
benign distance is  tensor(85.1854, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1231498047709465
distance x is tensor(93.0660, device='cuda:1')
benign distance is  tensor(93.0660, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7498472053557634
distance x is tensor(114.1141, device='cuda:1')
benign distance is  tensor(114.1141, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9188392516225576
distance x is tensor(126.3418, device='cuda:1')
benign distance is  tensor(126.3418, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8313358202576637
distance x is tensor(113.6753, device='cuda:1')
benign distance is  tensor(113.6753, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.888634717091918
distance x is tensor(80.6509, device='cuda:1')
benign distance is  tensor(80.6509, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7175653371959925
distance x is tensor(202.1543, device='cuda:1')
benign distance is  tensor(202.1543, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.3243796229362488
distance x is tensor(146.6788, device='cuda:1')
benign distance is  tensor(146.6788, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7362373564392328
distance x is tensor(84.7116, device='cuda:1')
benign distance is  tensor(84.7116, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 36
counter_tensor is  tensor([31., 35., 30., 35.,  7., 30., 35., 32., 15., 15., 15., 15., 15., 15.,
        15., 15., 15., 15., 15., 15.,  8., 27., 33., 34., 30., 34., 27., 35.,
         4.,  1., 27., 35., 35.,  5., 35., 33.])
count_res tensor([2.2624e-03, 1.2352e-01, 8.3228e-04, 1.2352e-01, 8.5408e-14, 8.3228e-04,
        1.2352e-01, 6.1498e-03, 2.5460e-10, 2.5460e-10, 2.5460e-10, 2.5460e-10,
        2.5460e-10, 2.5460e-10, 2.5460e-10, 2.5460e-10, 2.5460e-10, 2.5460e-10,
        2.5460e-10, 2.5460e-10, 2.3216e-13, 4.1437e-05, 1.6717e-02, 4.5441e-02,
        8.3228e-04, 4.5441e-02, 4.1437e-05, 1.2352e-01, 4.2522e-15, 2.1170e-16,
        4.1437e-05, 1.2352e-01, 1.2352e-01, 1.1559e-14, 1.2352e-01, 1.6717e-02])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 87.24% 

Test Accuracy: 87.40% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5937032736837864
distance x is tensor(108.9955, device='cuda:1')
benign distance is  tensor(108.9955, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7312428634613752
distance x is tensor(91.7765, device='cuda:1')
benign distance is  tensor(91.7765, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7302841916680336
distance x is tensor(107.8740, device='cuda:1')
benign distance is  tensor(107.8740, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8809088738635182
distance x is tensor(137.5056, device='cuda:1')
benign distance is  tensor(137.5056, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8534087422303855
distance x is tensor(85.1253, device='cuda:1')
benign distance is  tensor(85.1253, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7184563800692558
distance x is tensor(94.7765, device='cuda:1')
benign distance is  tensor(94.7765, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2395623810589314
distance x is tensor(85.8281, device='cuda:1')
benign distance is  tensor(85.8281, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6481018159538507
distance x is tensor(86.2349, device='cuda:1')
benign distance is  tensor(86.2349, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0096583925187588
distance x is tensor(106.5200, device='cuda:1')
benign distance is  tensor(106.5200, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6797998258844018
distance x is tensor(120.4690, device='cuda:1')
benign distance is  tensor(120.4690, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9434209428727627
distance x is tensor(68.9702, device='cuda:1')
benign distance is  tensor(68.9702, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0647648051381111
distance x is tensor(106.9126, device='cuda:1')
benign distance is  tensor(106.9126, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1154453810304403
distance x is tensor(148.2184, device='cuda:1')
benign distance is  tensor(148.2184, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6986146308481693
distance x is 2.6411482244729996
distance x is tensor(76.9171, device='cuda:0')
benign distance is  tensor(76.9171, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.049004226922989
distance x is tensor(161.4264, device='cuda:0')
benign distance is  tensor(161.4264, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.442324161529541
distance x is tensor(118.5460, device='cuda:0')
benign distance is  tensor(118.5460, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.7501931712031364
distance x is tensor(92.4191, device='cuda:0')
benign distance is  tensor(92.4191, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.6679189205169678
distance x is tensor(113.8549, device='cuda:0')
benign distance is  tensor(113.8549, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.236693285405636
distance x is tensor(108.3591, device='cuda:0')
benign distance is  tensor(108.3591, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.349492631852627
distance x is tensor(111.4699, device='cuda:0')
benign distance is  tensor(111.4699, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.9730324000120163
distance x is tensor(128.5777, device='cuda:0')
benign distance is  tensor(128.5777, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.154941290616989
distance x is tensor(107.3245, device='cuda:0')
benign distance is  tensor(107.3245, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  5.180193588137627
distance x is tensor(126.4632, device='cuda:0')
benign distance is  tensor(126.4632, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.893027886748314
distance x is tensor(147.5392, device='cuda:0')
benign distance is  tensor(147.5392, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.7369491308927536
distance x is tensor(91.3343, device='cuda:0')
benign distance is  tensor(91.3343, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.3613307774066925
distance x is tensor(144.5939, device='cuda:0')
benign distance is  tensor(144.5939, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  6.052229255437851
distance x is tensor(129.9606, device='cuda:0')
benign distance is  tensor(129.9606, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 683.8795,  490.7781,  415.3468,  717.3160,  549.2823,  477.5463,
         553.6536,  519.1089,  598.8729,  714.0102,  653.1871,  671.8228,
         611.3851,  617.5933,  699.5528,  570.1232,  663.1084,  663.3899,
         659.0403,  789.7112,  627.0228,  674.0450,  713.4888,  745.9175,
         655.0326, 1021.3180,  830.5904,  696.5563], device='cuda:0')
sorted_norm is   tensor([ 415.3468,  477.5463,  490.7781,  519.1089,  549.2823,  553.6536,
         570.1232,  598.8729,  611.3851,  617.5933,  627.0228,  653.1871,
         655.0326,  659.0403,  663.1084,  663.3899,  671.8228,  674.0450,
         683.8795,  696.5563,  699.5528,  713.4888,  714.0102,  717.3160,
         745.9175,  789.7112,  830.5904, 1021.3180], device='cuda:0')
used idx is  tensor([ 2,  5,  1,  7,  4,  6, 15,  8, 12, 13, 20, 10, 24, 18, 16, 17, 11, 21,
         0, 27, 14, 22], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.037504781037569
distance x is tensor(150.5753, device='cuda:0')
benign distance is  tensor(150.5753, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.0948591604828835
distance x is tensor(116.9864, device='cuda:0')
benign distance is  tensor(116.9864, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.90673965215683
distance x is tensor(83.9850, device='cuda:0')
benign distance is  tensor(83.9850, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.32272619754076
distance x is tensor(161.5057, device='cuda:0')
benign distance is  tensor(161.5057, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.8968553096055984
distance x is tensor(128.1221, device='cuda:0')
benign distance is  tensor(128.1221, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.6978049576282501
distance x is tensor(118.6189, device='cuda:0')
benign distance is  tensor(118.6189, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.0212646275758743
distance x is tensor(132.2713, device='cuda:0')
benign distance is  tensor(132.2713, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.8362154811620712
distance x is tensor(115.0015, device='cuda:0')
benign distance is  tensor(115.0015, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.131225124001503
distance x is tensor(120.5545, device='cuda:0')
benign distance is  tensor(120.5545, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.1953230798244476
distance x is tensor(118.3436, device='cuda:0')
benign distance is  tensor(118.3436, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.7175304889678955
distance x is tensor(123.7427, device='cuda:0')
benign distance is  tensor(123.7427, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.6019356474280357
distance x is tensor(142.3440, device='cuda:0')
benign distance is  tensor(142.3440, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.0361735597252846
distance x is tensor(118.8591, device='cuda:0')
benign distance is  tensor(118.8591, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.4258899800479412
distance x is tensor(205.8475, device='cuda:0')
benign distance is  tensor(205.8475, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.0993332266807556
distance x is tensor(173.3294, device='cuda:0')
benign distance is  tensor(173.3294, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.7851764410734177
distance x is tensor(132.2667, device='cuda:0')
benign distance is  tensor(132.2667, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([657.6744, 511.8372, 419.3284, 685.4112, 560.4478, 515.9464, 568.1731,
        505.6041, 624.7710, 767.0791, 656.7798, 708.9857, 664.9813, 681.9979,
        749.0120, 638.2979, 728.0728, 679.8366, 692.8651, 845.8961, 664.1979,
        575.5964, 672.4713, 641.1046, 636.6172, 582.0897, 555.5897, 682.2593,
        707.8740, 581.9653, 699.4835, 643.7032, 688.9350, 679.6618, 675.8312,
        809.4384, 564.5300, 622.0822, 536.0734, 618.4235, 709.4461, 480.0686,
        687.6125, 643.6812], device='cuda:0')
sorted_norm is   tensor([419.3284, 480.0686, 505.6041, 511.8372, 515.9464, 536.0734, 555.5897,
        560.4478, 564.5300, 568.1731, 575.5964, 581.9653, 582.0897, 618.4235,
        622.0822, 624.7710, 636.6172, 638.2979, 641.1046, 643.6812, 643.7032,
        656.7798, 657.6744, 664.1979, 664.9813, 672.4713, 675.8312, 679.6618,
        679.8366, 681.9979, 682.2593, 685.4112, 687.6125, 688.9350, 692.8651,
        699.4835, 707.8740, 708.9857, 709.4461, 728.0728, 749.0120, 767.0791,
        809.4384, 845.8961], device='cuda:0')
used idx is  tensor([ 2, 41,  7,  1,  5, 38, 26,  4, 36,  6, 21, 29, 25, 39, 37,  8, 24, 15,
        23, 43, 31, 10,  0, 20, 12, 22, 34, 33, 17, 13, 27,  3, 42, 32, 18],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 39.81% 

Test Accuracy: 62.56% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8851183280348778
distance x is tensor(134.8499, device='cuda:0')
benign distance is  tensor(134.8499, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.148983933031559
distance x is tensor(99.7897, device='cuda:0')
benign distance is  tensor(99.7897, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.4763871654868126
distance x is tensor(85.2542, device='cuda:0')
benign distance is  tensor(85.2542, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.178880847990513
distance x is tensor(137.6797, device='cuda:0')
benign distance is  tensor(137.6797, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.4942867755889893
distance x is tensor(108.8170, device='cuda:0')
benign distance is  tensor(108.8170, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.6708249747753143
distance x is tensor(100.5254, device='cuda:0')
benign distance is  tensor(100.5254, device='cuda:0') tensor(65.8254, device='cuda:1')
benign distance is  tensor(65.8254, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.823203545063734
distance x is tensor(127.4919, device='cuda:1')
benign distance is  tensor(127.4919, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3240245431661606
distance x is tensor(119.0528, device='cuda:1')
benign distance is  tensor(119.0528, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7211542595177889
distance x is tensor(131.5264, device='cuda:1')
benign distance is  tensor(131.5264, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.6748331617563963
distance x is tensor(103.9541, device='cuda:1')
benign distance is  tensor(103.9541, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7038137260824442
distance x is tensor(140.6478, device='cuda:1')
benign distance is  tensor(140.6478, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.6706749722361565
distance x is tensor(121.1496, device='cuda:1')
benign distance is  tensor(121.1496, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7283819131553173
distance x is tensor(102.5532, device='cuda:1')
benign distance is  tensor(102.5532, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.810608652420342
distance x is tensor(85.5051, device='cuda:1')
benign distance is  tensor(85.5051, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7425521928817034
distance x is tensor(78.7170, device='cuda:1')
benign distance is  tensor(78.7170, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7140720952302217
distance x is tensor(110.4969, device='cuda:1')
benign distance is  tensor(110.4969, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([13., 16., 17., 12., 17., 12., 17., 12., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([1.9892e-04, 3.9954e-03, 1.0861e-02, 7.3179e-05, 1.0861e-02, 7.3179e-05,
        1.0861e-02, 7.3179e-05, 8.0250e-02, 8.0250e-02, 8.0250e-02, 8.0250e-02,
        8.0250e-02, 8.0250e-02, 8.0250e-02, 8.0250e-02, 8.0250e-02, 8.0250e-02,
        8.0250e-02, 8.0250e-02])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 0.63% 

Test Accuracy: 10.00% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.7588672190904617
distance x is tensor(12761.5459, device='cuda:1')
benign distance is  tensor(12761.5459, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.0668794065713882
distance x is tensor(23661.6445, device='cuda:1')
benign distance is  tensor(23661.6445, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.875796362757683
distance x is tensor(15173.9590, device='cuda:1')
benign distance is  tensor(15173.9590, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  19.377992689609528
distance x is tensor(51182.0195, device='cuda:1')
benign distance is  tensor(51182.0195, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.967900365591049
distance x is tensor(13642.8213, device='cuda:1')
benign distance is  tensor(13642.8213, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.5543270856142044
distance x is tensor(12139.2236, device='cuda:1')
benign distance is  tensor(12139.2236, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.8042440116405487
distance x is tensor(77609.1953, device='cuda:1')
benign distance is  tensor(77609.1953, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.7122797071933746
distance x is tensor(39693.4180, device='cuda:1')
benign distance is  tensor(39693.4180, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 52
counter_tensor is  tensor([44., 44., 44., 44., 44., 44., 44., 44., 25., 25., 25., 25., 25., 25.,
        25., 25., 25., 25., 25., 25., 40., 48., 50., 51.,  1., 47.,  5.,  0.,
        21., 44.,  5., 17., 11., 50., 38., 49.,  6., 43., 40., 50., 28.,  9.,
         6.,  9., 47., 36.,  3., 48., 10., 44., 26., 10.])
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.7853143066167831
distance x is tensor(102.1031, device='cuda:0')
benign distance is  tensor(102.1031, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.9261390790343285
distance x is tensor(97.7723, device='cuda:0')
benign distance is  tensor(97.7723, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.923407182097435
distance x is tensor(101.1395, device='cuda:0')
benign distance is  tensor(101.1395, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.874580591917038
distance x is tensor(126.3906, device='cuda:0')
benign distance is  tensor(126.3906, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.765135332942009
distance x is tensor(90.7906, device='cuda:0')
benign distance is  tensor(90.7906, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.256339907646179
distance x is tensor(109.2701, device='cuda:0')
benign distance is  tensor(109.2701, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.6866617128252983
distance x is tensor(144.6175, device='cuda:0')
benign distance is  tensor(144.6175, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.6719298139214516
distance x is tensor(77.8260, device='cuda:0')
benign distance is  tensor(77.8260, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.653464414179325
distance x is tensor(143.6479, device='cuda:0')
benign distance is  tensor(143.6479, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  5.091881260275841
distance x is tensor(119.7447, device='cuda:0')
benign distance is  tensor(119.7447, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.9414405599236488
distance x is tensor(124.2976, device='cuda:0')
benign distance is  tensor(124.2976, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.8524993807077408
distance x is tensor(87.3140, device='cuda:0')
benign distance is  tensor(87.3140, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.0150913447141647
distance x is tensor(120.1413, device='cuda:0')
benign distance is  tensor(120.1413, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  3.6617800891399384
distance x is tensor(104.9066, device='cuda:0')
benign distance is  tensor(104.9066, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.477664276957512
distance x is tensor(111.0855, device='cuda:0')
benign distance is  tensor(111.0855, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.043281629681587
distance x is tensor(119.0205, device='cuda:0')
benign distance is  tensor(119.0205, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6890996601432562
distance x is tensor(116.0279, device='cuda:0')
benign distance is  tensor(116.0279, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  3.16780549287796
distance x is tensor(143.6710, device='cuda:0')
benign distance is  tensor(143.6710, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.9414839558303356
distance x is tensor(116.8531, device='cuda:0')
benign distance is  tensor(116.8531, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.0107892975211143
distance x is tensor(99.6675, device='cuda:0')
benign distance is  tensor(99.6675, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  3.3816269040107727
distance x is tensor(113.6385, device='cuda:0')
benign distance is  tensor(113.6385, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  3.744183525443077
distance x is tensor(118.4024, device='cuda:0')
benign distance is  tensor(118.4024, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8504874110221863
distance x is tensor(116.9656, device='cuda:0')
benign distance is  tensor(116.9656, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.987298846244812
distance x is tensor(94.2560, device='cuda:0')
benign distance is  tensor(94.2560, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.0245987996459007
distance x is tensor(92.0055, device='cuda:0')
benign distance is  tensor(92.0055, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.2236357741057873
distance x is tensor(119.8687, device='cuda:0')
benign distance is  tensor(119.8687, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 572.7921,  437.1870,  398.4958,  579.1156,  468.7220,  450.8592,
         434.6837,  425.2169,  922.3901, 1022.7415,  909.6058,  957.6660,
         895.9470,  934.2833,  985.6689,  883.8410,  975.4880,  926.2905,
         955.7639, 1080.1322], device='cuda:0')
sorted_norm is   tensor([ 398.4958,  425.2169,  434.6837,  437.1870,  450.8592,  468.7220,
         572.7921,  579.1156,  883.8410,  895.9470,  909.6058,  922.3901,
         926.2905,  934.2833,  955.7639,  957.6660,  975.4880,  985.6689,
        1022.7415, 1080.1322], device='cuda:0')
used idx is  tensor([ 2,  7,  6,  1,  5,  4,  0,  3, 15, 12, 10,  8, 17, 13, 18, 11],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.4669283330440521
distance x is tensor(117.5194, device='cuda:0')
benign distance is  tensor(117.5194, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.587882436811924
distance x is tensor(74.5503, device='cuda:0')
benign distance is  tensor(74.5503, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.43279992043972
distance x is tensor(50.8505, device='cuda:0')
benign distance is  tensor(50.8505, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.748552903532982
distance x is tensor(116.2423, device='cuda:0')
benign distance is  tensor(116.2423, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.4164270609617233
distance x is tensor(75.7116, device='cuda:0')
benign distance is  tensor(75.7116, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.1948403418064117
distance x is tensor(58.2192, device='cuda:0')
benign distance is  tensor(58.2192, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.8099094182252884
distance x is tensor(85.9193, device='cuda:0')
benign distance is  tensor(85.9193, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.6572105288505554
distance x is tensor(64.9789, device='cuda:0')
benign distance is  tensor(64.9789, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 35
weight size is  torch.Size([44, 215370])
norm res is  tensor([707.4085, 512.1252, 390.1579, 692.0312, 555.9566, 389.0880, 579.2415,
        459.6922, 408.9249, 606.4150, 524.2858, 581.8749, 548.3294, 499.2716,
        633.8706, 560.6582, 513.6248, 626.4269, 579.3663, 692.6204, 708.1916,
        803.5023, 854.0798, 669.4233, 871.7651, 828.9377, 696.6371, 817.9861,
        612.2899, 602.7888, 620.2856, 680.4243, 583.9446, 949.1425, 787.6701,
        664.3644, 660.7443, 760.5198, 621.4812, 682.5953, 823.9634, 572.0763,
        821.7102, 717.2348], device='cuda:0')
sorted_norm is   tensor([389.0880, 390.1579, 408.9249, 459.6922, 499.2716, 512.1252, 513.6248,
        524.2858, 548.3294, 555.9566, 560.6582, 572.0763, 579.2415, 579.3663,
        581.8749, 583.9446, 602.7888, 606.4150, 612.2899, 620.2856, 621.4812,
        626.4269, 633.8706, 660.7443, 664.3644, 669.4233, 680.4243, 682.5953,
        692.0312, 692.6204, 696.6371, 707.4085, 708.1916, 717.2348, 760.5198,
        787.6701, 803.5023, 817.9861, 821.7102, 823.9634, 828.9377, 854.0798,
        871.7651, 949.1425], device='cuda:0')
used idx is  tensor([ 5,  2,  8,  7, 13,  1, 16, 10, 12,  4, 15, 41,  6, 18, 11, 32, 29,  9,
        28, 30, 38, 17, 14, 36, 35, 23, 31, 39,  3, 19, 26,  0, 20, 43, 37],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 17.60% 

Test Accuracy: 43.03% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8742968514561653
distance x is tensor(147.4422, device='cuda:0')
benign distance is  tensor(147.4422, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.8593852519989014
distance x is tensor(109.4644, device='cuda:0')
benign distance is  tensor(109.4644, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.444380909204483
distance x is tensor(91.7098, device='cuda:0')
benign distance is  tensor(91.7098, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.357407607138157
distance x is tensor(149.5771, device='cuda:0')
count_res tensor([3.8239e-04, 3.8239e-04, 3.8239e-04, 3.8239e-04, 3.8239e-04, 3.8239e-04,
        3.8239e-04, 3.8239e-04, 2.1425e-12, 2.1425e-12, 2.1425e-12, 2.1425e-12,
        2.1425e-12, 2.1425e-12, 2.1425e-12, 2.1425e-12, 2.1425e-12, 2.1425e-12,
        2.1425e-12, 2.1425e-12, 7.0038e-06, 2.0878e-02, 1.5427e-01, 4.1935e-01,
        8.0881e-23, 7.6806e-03, 4.4160e-21, 2.9755e-23, 3.9241e-14, 3.8239e-04,
        4.4160e-21, 7.1872e-16, 1.7815e-18, 1.5427e-01, 9.4786e-07, 5.6752e-02,
        1.2004e-20, 1.4067e-04, 7.0038e-06, 1.5427e-01, 4.3033e-11, 2.4110e-19,
        1.2004e-20, 2.4110e-19, 7.6806e-03, 1.2828e-07, 5.9764e-22, 2.0878e-02,
        6.5539e-19, 3.8239e-04, 5.8238e-12, 6.5539e-19])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 71.63% 

Test Accuracy: 79.76% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7018756866455078
distance x is tensor(125.1517, device='cuda:1')
benign distance is  tensor(125.1517, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8908579833805561
distance x is tensor(104.5309, device='cuda:1')
benign distance is  tensor(104.5309, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7519690208137035
distance x is tensor(108.0522, device='cuda:1')
benign distance is  tensor(108.0522, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.078346835449338
distance x is tensor(147.4973, device='cuda:1')
benign distance is  tensor(147.4973, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8347553797066212
distance x is tensor(103.9098, device='cuda:1')
benign distance is  tensor(103.9098, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8101470656692982
distance x is tensor(111.4308, device='cuda:1')
benign distance is  tensor(111.4308, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3369708471000195
distance x is tensor(105.9205, device='cuda:1')
benign distance is  tensor(105.9205, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7430898789316416
distance x is tensor(93.6025, device='cuda:1')
benign distance is  tensor(93.6025, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0354292653501034
distance x is tensor(100.5720, device='cuda:1')
benign distance is  tensor(100.5720, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6274168398231268
distance x is tensor(116.0743, device='cuda:1')
benign distance is  tensor(116.0743, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1272071432322264
distance x is tensor(80.2958, device='cuda:1')
benign distance is  tensor(80.2958, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.1897498406469822
distance x is tensor(117.5832, device='cuda:1')
benign distance is  tensor(117.5832, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.092334795743227
distance x is tensor(155.0898, device='cuda:1')
benign distance is  tensor(155.0898, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7322576381266117
distance x is tensor(76.6913, device='cuda:1')
benign distance is  tensor(76.6913, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9977765809744596
distance x is tensor(145.4653, device='cuda:1')
benign distance is  tensor(145.4653, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.6249236166477203
distance x is tensor(132.4566, device='cuda:1')
benign distance is  tensor(132.4566, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1509719267487526
distance x is tensor(94.2204, device='cuda:1')
benign distance is  tensor(94.2204, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7490574978291988
distance x is tensor(106.6118, device='cuda:1')
benign distance is  tensor(106.6118, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9217225685715675
distance x is tensor(122.4958, device='cuda:1')
benign distance is  tensor(122.4958, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.9495270885527134
distance x is tensor(119.0130, device='cuda:1')
benign distance is  tensor(119.0130, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.2120425775647163
distance x is tensor(84.4234, device='cuda:1')
benign distance is  tensor(84.4234, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7281315866857767
distance x is tensor(197.8133, device='cuda:1')
benign distance is  tensor(197.8133, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0683623664081097
distance x is tensor(143.1029, device='cuda:1')
benign distance is  tensor(143.1029, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6953108282759786
distance x is tensor(109.2664, device='cuda:1')
benign distance is  tensor(109.2664, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.1379156894981861
distance x is tensor(110.9651, device='cuda:1')
benign distance is  tensor(110.9651, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7113347984850407
distance x is tensor(84.0034, device='cuda:1')
benign distance is  tensor(84.0034, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.0303298383951187
distance x is tensor(119.1758, device='cuda:1')
benign distance is  tensor(119.1758, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.468775849789381
distance x is tensor(112.5937, device='cuda:1')
benign distance is  tensor(112.5937, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8565061688423157
distance x is tensor(125.9129, device='cuda:1')
benign distance is  tensor(125.9129, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.994144644588232
distance x is tensor(101.8029, device='cuda:1')
benign distance is  tensor(101.8029, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.562132366001606
distance x is tensor(121.4657, device='cuda:1')
benign distance is  tensor(121.4657, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7773072198033333
distance x is tensor(153.3601, device='cuda:1')
benign distance is  tensor(153.3601, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.309765711426735
distance x is tensor(116.9726, device='cuda:1')
benign distance is  tensor(116.9726, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is
benign distance is  tensor(149.5771, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.4695312082767487
distance x is tensor(115.4362, device='cuda:0')
benign distance is  tensor(115.4362, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.7391980662941933
distance x is tensor(114.3460, device='cuda:0')
benign distance is  tensor(114.3460, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.641763597726822
distance x is tensor(115.8802, device='cuda:0')
benign distance is  tensor(115.8802, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.27458643168211
distance x is tensor(108.0354, device='cuda:0')
benign distance is  tensor(108.0354, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.3690483644604683
distance x is tensor(115.3046, device='cuda:0')
benign distance is  tensor(115.3046, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.706439696252346
distance x is tensor(132.4555, device='cuda:0')
benign distance is  tensor(132.4555, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.1517018526792526
distance x is tensor(99.4993, device='cuda:0')
benign distance is  tensor(99.4993, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.753047540783882
distance x is tensor(114.9765, device='cuda:0')
benign distance is  tensor(114.9765, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.7790678963065147
distance x is tensor(155.3445, device='cuda:0')
benign distance is  tensor(155.3445, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.012334018945694
distance x is tensor(96.4493, device='cuda:0')
benign distance is  tensor(96.4493, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.156641624867916
distance x is tensor(154.0153, device='cuda:0')
benign distance is  tensor(154.0153, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.819620743393898
distance x is tensor(121.2328, device='cuda:0')
benign distance is  tensor(121.2328, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.3416695296764374
distance x is tensor(103.7492, device='cuda:0')
benign distance is  tensor(103.7492, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.6593239158391953
distance x is tensor(111.3526, device='cuda:0')
benign distance is  tensor(111.3526, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.2641405537724495
distance x is tensor(123.4572, device='cuda:0')
benign distance is  tensor(123.4572, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.2087921127676964
distance x is tensor(136.3188, device='cuda:0')
benign distance is  tensor(136.3188, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  3.0438283532857895
distance x is tensor(113.2037, device='cuda:0')
benign distance is  tensor(113.2037, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.3996330350637436
distance x is tensor(198.4376, device='cuda:0')
benign distance is  tensor(198.4376, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.920379400253296
distance x is tensor(158.3715, device='cuda:0')
benign distance is  tensor(158.3715, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.6251525282859802
distance x is tensor(125.4855, device='cuda:0')
benign distance is  tensor(125.4855, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  3.8396690636873245
distance x is tensor(103.3010, device='cuda:0')
benign distance is  tensor(103.3010, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  3.789364993572235
distance x is tensor(132.9819, device='cuda:0')
benign distance is  tensor(132.9819, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.108130693435669
distance x is tensor(160.3564, device='cuda:0')
benign distance is  tensor(160.3564, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  2.0288856104016304
distance x is tensor(92.0206, device='cuda:0')
benign distance is  tensor(92.0206, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.982660986483097
distance x is tensor(150.4542, device='cuda:0')
benign distance is  tensor(150.4542, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.2177142649888992
distance x is tensor(134.3066, device='cuda:0')
benign distance is  tensor(134.3066, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  4.213672757148743
distance x is tensor(108.1784, device='cuda:0')
benign distance is  tensor(108.1784, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.8668700531125069
distance x is tensor(159.3736, device='cuda:0')
benign distance is  tensor(159.3736, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([620.9750, 471.3553, 428.0672, 626.5826, 493.7188, 503.7686, 485.7434,
        458.4555, 783.9421, 907.2278, 784.5972, 827.0812, 760.2880, 826.3611,
        896.2301, 749.7429, 868.3392, 810.3974, 834.4855, 973.9279],
       device='cuda:0')
sorted_norm is   tensor([428.0672, 458.4555, 471.3553, 485.7434, 493.7188, 503.7686, 620.9750,
        626.5826, 749.7429, 760.2880, 783.9421, 784.5972, 810.3974, 826.3611,
        827.0812, 834.4855, 868.3392, 896.2301, 907.2278, 973.9279],
       device='cuda:0')
used idx is  tensor([ 2,  7,  1,  6,  4,  5,  0,  3, 15, 12,  8, 10, 17, 13, 11, 18],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.421982802450657
distance x is tensor(111.8584, device='cuda:0')
benign distance is  tensor(111.8584, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.4826320186257362
distance x is tensor(77.7329, device='cuda:0')
benign distance is  tensor(77.7329, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.97789965569973
distance x is tensor(45.2032, device='cuda:0')
benign distance is  tensor(45.2032, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.207446001470089
distance x is tensor(109.0375, device='cuda:0')
benign distance is  tensor(109.0375, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.6672181636095047
distance x is tensor(72.2953, device='cuda:0')
benign distance is  tensor(72.2953, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.1018109023571014
distance x is tensor(52.5037, device='cuda:0')
benign distance is  tensor(52.5037, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.243708074092865
distance x is tensor(83.6774, device='cuda:0')
benign distance is  tensor(83.6774, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.470074251294136
distance x is tensor(49.4906, device='cuda:0')
benign distance is  tensor(49.4906, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([700.9366, 543.9913, 382.4397, 696.0429, 537.0002, 389.4458, 570.8242,
        404.4051, 312.6070, 603.3576, 518.7229, 593.3897, 538.5270, 491.8971,
        608.0257, 519.9852, 515.8127, 588.7036, 572.9393, 653.5226, 733.7511,
        607.7377, 720.1283, 676.3802, 704.6396, 720.5459, 720.5016, 820.3303,
        637.7010, 720.2815, 574.4081, 642.6843, 800.9330, 567.3969, 793.4325,
        671.5763], device='cuda:0')
sorted_norm is   tensor([312.6070, 382.4397, 389.4458, 404.4051, 491.8971, 515.8127, 518.7229,
        519.9852, 537.0002, 538.5270, 543.9913, 567.3969, 570.8242, 572.9393,
        574.4081, 588.7036, 593.3897, 603.3576, 607.7377, 608.0257, 637.7010,
        642.6843, 653.5226, 671.5763, 676.3802, 696.0429, 700.9366, 704.6396,
        720.1283, 720.2815, 720.5016, 720.5459, 733.7511, 793.4325, 800.9330,
        820.3303], device='cuda:0')
used idx is  tensor([ 8,  2,  5,  7, 13, 16, 10, 15,  4, 12,  1, 33,  6, 18, 30, 17, 11,  9,
        21, 14, 28, 31, 19, 35, 23,  3,  0, 24], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 5.48% 

Test Accuracy: 14.19% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7991329431533813
distance x is tensor(151.0035, device='cuda:0')
benign distance is  tensor(151.0035, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.299203582108021
distance x is tensor(112.3128, device='cuda:0')
benign distance is  tensor(112.3128, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.11677522957325
distance x is tensor(90.2296, device='cuda:0')
benign distance is  tensor(90.2296, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.910608395934105
distance x is tensor(157.6919, device='cuda:0')
benign distance is  torch.Size([215370])
 benign loss is  1.2449864074587822
distance x is tensor(126.2367, device='cuda:1')
benign distance is  tensor(126.2367, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.3874791227281094
distance x is tensor(136.4680, device='cuda:1')
benign distance is  tensor(136.4680, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.3469107449054718
distance x is tensor(78.4027, device='cuda:1')
benign distance is  tensor(78.4027, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6179712079465389
distance x is tensor(154.5644, device='cuda:1')
benign distance is  tensor(154.5644, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8796116337180138
distance x is tensor(131.0187, device='cuda:1')
benign distance is  tensor(131.0187, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9464397057890892
distance x is tensor(99.1185, device='cuda:1')
benign distance is  tensor(99.1185, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6386641161516309
distance x is tensor(128.3694, device='cuda:1')
benign distance is  tensor(128.3694, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([19., 19., 19., 13., 19., 19., 19., 17., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([0.0551, 0.0551, 0.0551, 0.0001, 0.0551, 0.0551, 0.0551, 0.0075, 0.0551,
        0.0551, 0.0551, 0.0551, 0.0551, 0.0551, 0.0551, 0.0551, 0.0551, 0.0551,
        0.0551, 0.0551])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 0.62% 

Test Accuracy: 10.00% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.6016810089349747
distance x is tensor(716.5866, device='cuda:1')
benign distance is  tensor(716.5866, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.2947317212820053
distance x is tensor(759.6014, device='cuda:1')
benign distance is  tensor(759.6014, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.901273638010025
distance x is tensor(1042.2379, device='cuda:1')
benign distance is  tensor(1042.2379, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.868212342262268
distance x is tensor(823.2304, device='cuda:1')
benign distance is  tensor(823.2304, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.0106217116117477
distance x is tensor(671.6309, device='cuda:1')
benign distance is  tensor(671.6309, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.597854182124138
distance x is tensor(652.6129, device='cuda:1')
benign distance is  tensor(652.6129, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.815322980284691
distance x is tensor(795.4536, device='cuda:1')
benign distance is  tensor(795.4536, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.701230302453041
distance x is tensor(870.7377, device='cuda:1')
benign distance is  tensor(870.7377, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([21., 20., 21., 21., 21., 21., 21., 21., 14., 14., 14., 14., 14., 14.,
        14., 14., 14., 14., 14., 14., 27., 20., 27., 17., 27., 17.,  3., 18.])
count_res tensor([8.2094e-04, 3.0201e-04, 8.2094e-04, 8.2094e-04, 8.2094e-04, 8.2094e-04,
        8.2094e-04, 8.2094e-04, 7.4860e-07, 7.4860e-07, 7.4860e-07, 7.4860e-07,
        7.4860e-07, 7.4860e-07, 7.4860e-07, 7.4860e-07, 7.4860e-07, 7.4860e-07,
        7.4860e-07, 7.4860e-07, 3.3119e-01, 3.0201e-04, 3.3119e-01, 1.5036e-05,
        3.3119e-01, 1.5036e-05, 1.2503e-11, 4.0872e-05])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 74.01% 

Test Accuracy: 82.99% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.641414912417531
distance x is tensor(113.5327, device='cuda:1')
benign distance is  tensor(113.5327, device='cuda:1')
current submit client idx and staleness is  1 1 tensor(157.6919, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.9088242948055267
distance x is tensor(122.9890, device='cuda:0')
benign distance is  tensor(122.9890, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.123938024044037
distance x is tensor(116.6769, device='cuda:0')
benign distance is  tensor(116.6769, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.262443855404854
distance x is tensor(124.9103, device='cuda:0')
benign distance is  tensor(124.9103, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.011450655758381
distance x is tensor(113.2890, device='cuda:0')
benign distance is  tensor(113.2890, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  3.0104140266776085
distance x is tensor(119.2361, device='cuda:0')
benign distance is  tensor(119.2361, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.588757336139679
distance x is tensor(136.9787, device='cuda:0')
benign distance is  tensor(136.9787, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.103292889893055
distance x is tensor(108.5472, device='cuda:0')
benign distance is  tensor(108.5472, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.169464707374573
distance x is tensor(127.6003, device='cuda:0')
benign distance is  tensor(127.6003, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.688984990119934
distance x is tensor(149.6027, device='cuda:0')
benign distance is  tensor(149.6027, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.6045035347342491
distance x is tensor(98.3176, device='cuda:0')
benign distance is  tensor(98.3176, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.2003298699855804
distance x is tensor(151.4607, device='cuda:0')
benign distance is  tensor(151.4607, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.8938808292150497
distance x is tensor(135.7601, device='cuda:0')
benign distance is  tensor(135.7601, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.9980939850211143
distance x is tensor(135.9247, device='cuda:0')
benign distance is  tensor(135.9247, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  2.2702934443950653
distance x is tensor(86.1813, device='cuda:0')
benign distance is  tensor(86.1813, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.448284201323986
distance x is tensor(140.7221, device='cuda:0')
benign distance is  tensor(140.7221, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  4.438849791884422
distance x is tensor(116.8464, device='cuda:0')
benign distance is  tensor(116.8464, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.6914581283926964
distance x is tensor(130.5572, device='cuda:0')
benign distance is  tensor(130.5572, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.0684088841080666
distance x is tensor(138.4626, device='cuda:0')
benign distance is  tensor(138.4626, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7477305121719837
distance x is tensor(127.4715, device='cuda:0')
benign distance is  tensor(127.4715, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  3.4215570986270905
distance x is tensor(150.3629, device='cuda:0')
benign distance is  tensor(150.3629, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([638.6556, 487.2981, 426.4159, 653.4344, 523.3160, 513.6177, 529.1458,
        483.0768, 685.7166, 815.0065, 685.5840, 751.6338, 677.3101, 723.7314,
        787.5366, 669.2068, 789.3442, 725.8180, 738.8721, 884.6217, 642.0070,
        558.3862, 642.0314, 630.3243, 637.3126, 544.8480, 534.8699, 652.4272,
        502.7058, 550.3333, 587.5203, 626.4185, 529.1212, 912.6758, 713.5466,
        600.2661], device='cuda:0')
sorted_norm is   tensor([426.4159, 483.0768, 487.2981, 502.7058, 513.6177, 523.3160, 529.1212,
        529.1458, 534.8699, 544.8480, 550.3333, 558.3862, 587.5203, 600.2661,
        626.4185, 630.3243, 637.3126, 638.6556, 642.0070, 642.0314, 652.4272,
        653.4344, 669.2068, 677.3101, 685.5840, 685.7166, 713.5466, 723.7314,
        725.8180, 738.8721, 751.6338, 787.5366, 789.3442, 815.0065, 884.6217,
        912.6758], device='cuda:0')
used idx is  tensor([ 2,  7,  1, 28,  5,  4, 32,  6, 26, 25, 29, 21, 30, 35, 31, 23, 24,  0,
        20, 22, 27,  3, 15, 12, 10,  8, 34, 13], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 38.13% 

Test Accuracy: 65.29% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8577128797769547
distance x is tensor(135.8654, device='cuda:0')
benign distance is  tensor(135.8654, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.885844960808754
distance x is tensor(95.5710, device='cuda:0')
benign distance is  tensor(95.5710, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.572044253349304
distance x is tensor(81.2536, device='cuda:0')
benign distance is  tensor(81.2536, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.3615511879324913
distance x is tensor(132.8795, device='cuda:0')
benign distance is  tensor(132.8795, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.983970046043396
distance x is tensor(98.0351, device='cuda:0')
benign distance is  tensor(98.0351, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.8435926958918571
distance x is tensor(99.8008, device='cuda:0')
benign distance is  tensor(99.8008, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.417269065976143
distance x is tensor(102.1415, device='cuda:0')
benign distance is  tensor(102.1415, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.312084913253784
distance x is tensor(89.6758, device='cuda:0')
benign distance is  tensor(89.6758, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.862147629261017
distance x is tensor(95.3876, device='cuda:0')
benign distance is  tensor(95.3876, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.934051752090454
distance x is tensor(96.3847, device='cuda:0')
benign distance is  tensor(96.3847, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.9168799668550491
distance x is tensor(122.8940, device='cuda:0')
benign distance is  tensor(122.8940, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.5642260685563087
distance x is tensor(119.5404, device='cuda:0')
benign distance is  tensor(119.5404, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.145408608019352
distance x is tensor(93.5663, device='cuda:0')
benign distance is  tensor(93.5663, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.29778703302145
distance x is tensor(195.7511, device='cuda:0')
benign distance is  tensor(195.7511, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.7904971539974213
distance x is tensor(144.1330, device='cuda:0')
benign distance is  tensor(144.1330, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.638259194791317
distance x is tensor(106.6312, device='cuda:0')
benign distance is  tensor(106.6312, device='cuda:0')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.1460640579462051
distance x is tensor(112.3860, device='cuda:0')
benign distance is  tensor(112.3860, device='cuda:0')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.1166813001036644
distance x is tensor(97.4068, device='cuda:0')
benign distance is  tensor(97.4068, device='cuda:0')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  2.3007002994418144
distance x is tensor(114.1842, device='cuda:0')
benign distance is  tensor(114.1842, device='cuda:0')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  4.044377982616425
distance x is tensor(107.1454, device='cuda:0')
benign distance is  tensor(107.1454, device='cuda:0')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8662387430667877
distance x is tensor(114.6321, device='cuda:0')
benign distance is  tensor(114.6321, device='cuda:0')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.753378413617611
distance x is tensor(93.9079, device='cuda:0')
benign distance is  tensor(93.9079, device='cuda:0')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.106602191925049
distance x is tensor(89.8436, device='cuda:0')
benign distance is  tensor(89.8436, device='cuda:0')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7847856972366571
distance x is tensor(112.2630, device='cuda:0')
benign distance is  tensor(112.2630, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is
grad,shape is torch.Size([215370])
 benign loss is  0.8818083498626947
distance x is tensor(99.6845, device='cuda:1')
benign distance is  tensor(99.6845, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8565849624574184
distance x is tensor(103.2168, device='cuda:1')
benign distance is  tensor(103.2168, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9726493246853352
distance x is tensor(142.8989, device='cuda:1')
benign distance is  tensor(142.8989, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9415781395509839
distance x is tensor(95.2707, device='cuda:1')
benign distance is  tensor(95.2707, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6128319557756186
distance x is tensor(100.7849, device='cuda:1')
benign distance is  tensor(100.7849, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1996021643280983
distance x is tensor(88.1300, device='cuda:1')
benign distance is  tensor(88.1300, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8789162673056126
distance x is tensor(86.7708, device='cuda:1')
benign distance is  tensor(86.7708, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.2078413106501102
distance x is tensor(74.1974, device='cuda:1')
benign distance is  tensor(74.1974, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6571597550064325
distance x is tensor(113.1771, device='cuda:1')
benign distance is  tensor(113.1771, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.097029011696577
distance x is tensor(77.7037, device='cuda:1')
benign distance is  tensor(77.7037, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2616826929152012
distance x is tensor(113.5784, device='cuda:1')
benign distance is  tensor(113.5784, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2221304886043072
distance x is tensor(145.7417, device='cuda:1')
benign distance is  tensor(145.7417, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7125367037951946
distance x is tensor(60.5787, device='cuda:1')
benign distance is  tensor(60.5787, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.098995104432106
distance x is tensor(130.6893, device='cuda:1')
benign distance is  tensor(130.6893, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.3881817646324635
distance x is tensor(112.7598, device='cuda:1')
benign distance is  tensor(112.7598, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 36
counter_tensor is  tensor([27.,  9., 32., 19., 14., 22., 32., 29., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20., 30., 33.,  0.,  8., 35.,  5., 24., 24.,
        16., 18., 29., 35., 34., 35., 31., 16.])
count_res tensor([9.2333e-05, 1.4062e-12, 1.3703e-02, 3.0974e-08, 2.0870e-10, 6.2214e-07,
        1.3703e-02, 6.8226e-04, 8.4197e-08, 8.4197e-08, 8.4197e-08, 8.4197e-08,
        8.4197e-08, 8.4197e-08, 8.4197e-08, 8.4197e-08, 8.4197e-08, 8.4197e-08,
        8.4197e-08, 8.4197e-08, 1.8546e-03, 3.7250e-02, 1.7354e-16, 5.1732e-13,
        2.7524e-01, 2.5756e-14, 4.5970e-06, 4.5970e-06, 1.5421e-09, 1.1395e-08,
        6.8226e-04, 2.7524e-01, 1.0126e-01, 2.7524e-01, 5.0412e-03, 1.5421e-09])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 87.24% 

Test Accuracy: 85.20% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6662789415568113
distance x is tensor(115.6390, device='cuda:1')
benign distance is  tensor(115.6390, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6306137619540095
distance x is tensor(103.8327, device='cuda:1')
benign distance is  tensor(103.8327, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6243114918470383
distance x is tensor(96.8684, device='cuda:1')
benign distance is  tensor(96.8684, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8900113347917795
distance x is tensor(137.7747, device='cuda:1')
benign distance is  tensor(137.7747, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6813189378008246
distance x is tensor(83.8267, device='cuda:1')
benign distance is  tensor(83.8267, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6384672308340669
distance x is tensor(96.3688, device='cuda:1')
benign distance is  tensor(96.3688, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2685572281479836
distance x is tensor(89.6805, device='cuda:1')
benign distance is  tensor(89.6805, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6329191774129868
distance x is tensor(87.3608, device='cuda:1')
benign distance is  tensor(87.3608, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1714328452944756
distance x is tensor(108.5767, device='cuda:1')
benign distance is  tensor(108.5767, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7342808544635773
distance x is tensor(109.1544, device='cuda:1')
benign distance is  tensor(109.1544, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8503997586667538
distance x is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 22
weight size is  torch.Size([28, 215370])
norm res is  tensor([ 577.6063,  428.0407,  395.5471,  563.1364,  430.4750,  433.0655,
         430.8154,  391.7904,  972.6042, 1080.8707,  970.0890, 1000.7233,
         960.6526, 1040.3364, 1046.2263,  967.0783, 1042.4734, 1000.5072,
        1029.7762, 1134.9189,  420.6639,  493.4417,  370.2072,  473.4806,
         552.8849,  332.1267,  546.7084,  493.5951], device='cuda:0')
sorted_norm is   tensor([ 332.1267,  370.2072,  391.7904,  395.5471,  420.6639,  428.0407,
         430.4750,  430.8154,  433.0655,  473.4806,  493.4417,  493.5951,
         546.7084,  552.8849,  563.1364,  577.6063,  960.6526,  967.0783,
         970.0890,  972.6042, 1000.5072, 1000.7233, 1029.7762, 1040.3364,
        1042.4734, 1046.2263, 1080.8707, 1134.9189], device='cuda:0')
used idx is  tensor([25, 22,  7,  2, 20,  1,  4,  6,  5, 23, 21, 27, 26, 24,  3,  0, 12, 15,
        10,  8, 17, 11], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 25.64% 

Test Accuracy: 57.25% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.055142942816019
distance x is tensor(143.5645, device='cuda:0')
benign distance is  tensor(143.5645, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.4334192350506783
distance x is tensor(108.7054, device='cuda:0')
benign distance is  tensor(108.7054, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.4974709153175354
distance x is tensor(93.5720, device='cuda:0')
benign distance is  tensor(93.5720, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.4854096099734306
distance x is tensor(148.1710, device='cuda:0')
benign distance is  tensor(148.1710, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.7238104045391083
distance x is tensor(119.7497, device='cuda:0')
benign distance is  tensor(119.7497, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5447845086455345
distance x is tensor(110.4931, device='cuda:0')
benign distance is  tensor(110.4931, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.3537487238645554
distance x is tensor(121.8209, device='cuda:0')
benign distance is  tensor(121.8209, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.429688982665539
distance x is tensor(101.1080, device='cuda:0')
benign distance is  tensor(101.1080, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.5179789438843727
distance x is tensor(109.6473, device='cuda:0')
benign distance is  tensor(109.6473, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.543172426521778
distance x is tensor(131.4053, device='cuda:0')
benign distance is  tensor(131.4053, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.177698366343975
distance x is tensor(95.0166, device='cuda:0')
benign distance is  tensor(95.0166, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  4.776344135403633
distance x is tensor(113.7126, device='cuda:0')
benign distance is  tensor(113.7126, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.903589203953743
distance x is tensor(149.5239, device='cuda:0')
benign distance is  tensor(149.5239, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.8369692489504814
distance x is tensor(89.0608, device='cuda:0')
benign distance is  tensor(89.0608, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.0220021679997444
distance x is tensor(139.9796, device='cuda:0')
benign distance is  tensor(139.9796, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.384639635682106
distance x is tensor(122.5223, device='cuda:0')
benign distance is  tensor(122.5223, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 599.8784,  456.7124,  437.4672,  610.1146,  504.6430,  487.2964,
         504.7868,  436.3056,  824.5113,  945.5085,  830.8481,  868.1171,
         804.9690,  876.7931,  916.3488,  793.3417,  901.5542,  847.4842,
         875.1739, 1013.2701], device='cuda:0')
sorted_norm is   tensor([ 436.3056,  437.4672,  456.7124,  487.2964,  504.6430,  504.7868,
         599.8784,  610.1146,  793.3417,  804.9690,  824.5113,  830.8481,
         847.4842,  868.1171,  875.1739,  876.7931,  901.5542,  916.3488,
         945.5085, 1013.2701], device='cuda:0')
used idx is  tensor([ 7,  2,  1,  5,  4,  6,  0,  3, 15, 12,  8, 10, 17, 11, 18, 13],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.513541229069233
distance x is tensor(46.1461, device='cuda:0')
benign distance is  tensor(46.1461, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.202143281698227
distance x is tensor(34.7072, device='cuda:0')
benign distance is  tensor(34.7072, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.8438433706760406
distance x is tensor(24.1461, device='cuda:0')
benign distance is  tensor(24.1461, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.698283463716507
distance x is tensor(97.6656, device='cuda:0')
benign distance is  tensor(97.6656, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.4784218072891235
distance x is tensor(65.3485, device='cuda:0')
benign distance is  tensor(65.3485, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.694995179772377
distance x is tensor(30.1442, device='cuda:0')
benign distance is  tensor(30.1442, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.1426563560962677
distance x is tensor(57.7051, device='cuda:0')
benign distance is  tensor(57.7051, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.7222982347011566
distance x is tensor(5.3205, device='cuda:0')
benign distance is  tensor(5.3205, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 41
weight size is  torch.Size([52, 215370])
norm res is  tensor([ 411.1052,  405.5725,  342.5021,  665.9176,  450.8981,  289.5693,
         506.5541,  272.8067,  310.3813,  578.8730,  362.6965,  558.7219,
         503.1715,  456.7647,  530.9353,  429.4184,  452.8605,  530.1973,
         510.5008,  637.4313,  588.3149,  718.0686,  814.4572,  559.4347,
         797.1779,  710.6851,  615.2614,  810.2793,  689.2561,  489.1737,
         695.3668,  616.9281,  658.6552,  685.1226,  666.9091,  741.9662,
         653.3995,  660.4974,  752.9242,  744.2878,  639.4247, 1034.6985,
         834.0197,  713.2251,  645.4404,  732.4606,  577.8460,  654.4972,
         792.1932,  564.5010,  774.1953,  687.4835], device='cuda:0')
sorted_norm is   tensor([ 272.8067,  289.5693,  310.3813,  342.5021,  362.6965,  405.5725,
         411.1052,  429.4184,  450.8981,  452.8605,  456.7647,  489.1737,
         503.1715,  506.5541,  510.5008,  530.1973,  530.9353,  558.7219,
         559.4347,  564.5010,  577.8460,  578.8730,  588.3149,  615.2614,
         616.9281,  637.4313,  639.4247,  645.4404,  653.3995,  654.4972,
         658.6552,  660.4974,  665.9176,  666.9091,  685.1226,  687.4835,
         689.2561,  695.3668,  710.6851,  713.2251,  718.0686,  732.4606,
         741.9662,  744.2878,  752.9242,  774.1953,  792.1932,  797.1779,
         810.2793,  814.4572,  834.0197, 1034.6985], device='cuda:0')
used idx is  tensor([ 7,  5,  8,  2, 10,  1,  0, 15,  4, 16, 13, 29, 12,  6, 18, 17, 14, 11,
        23, 49, 46,  9, 20, 26, 31, 19, 40, 44, 36, 47, 32, 37,  3, 34, 33, 51,
        28, 30, 25, 43, 21], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 38.03% 

Test Accuracy: 58.74% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7770720813423395
distance x is tensor(138.8269, device='cuda:0')
benign distance is  tensor(138.8269, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.0363261103630066
distance x is tensor(105.5042, device='cuda:0')
benign distance is  tensor(105.5042, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.07304111123085
distance x is tensor(87.0473, device='cuda:0')
benign distance is  tensor(87.0473, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.0120576173067093
distance x is tensor(146.9640, device='cuda:0')
benign distance is  tensor(146.9640, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6759220138192177
distance x is tensor(119.1468, device='cuda:0')
benign distance is  tensor(119.1468, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  tensor(110.3173, device='cuda:1')
benign distance is  tensor(110.3173, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7268872857093811
distance x is tensor(98.6207, device='cuda:1')
benign distance is  tensor(98.6207, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.8515641298145056
distance x is tensor(66.1478, device='cuda:1')
benign distance is  tensor(66.1478, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.693330429494381
distance x is tensor(189.3275, device='cuda:1')
benign distance is  tensor(189.3275, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0773036368191242
distance x is tensor(136.8715, device='cuda:1')
benign distance is  tensor(136.8715, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7194711957126856
distance x is tensor(96.0631, device='cuda:1')
benign distance is  tensor(96.0631, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7766075357794762
distance x is tensor(109.7303, device='cuda:1')
benign distance is  tensor(109.7303, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.9172314126044512
distance x is tensor(86.3554, device='cuda:1')
benign distance is  tensor(86.3554, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6568513922393322
distance x is tensor(130.8123, device='cuda:1')
benign distance is  tensor(130.8123, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.2921610623598099
distance x is tensor(112.0399, device='cuda:1')
benign distance is  tensor(112.0399, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7350737024098635
distance x is tensor(101.6956, device='cuda:1')
benign distance is  tensor(101.6956, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7745131775736809
distance x is tensor(80.0816, device='cuda:1')
benign distance is  tensor(80.0816, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.6795970965176821
distance x is tensor(86.1887, device='cuda:1')
benign distance is  tensor(86.1887, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.6495182011276484
distance x is tensor(109.6102, device='cuda:1')
benign distance is  tensor(109.6102, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 36
counter_tensor is  tensor([ 0., 28., 29., 25., 25., 20.,  4., 29., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19., 35., 35., 15., 34., 35., 35., 27., 25.,
        35.,  4., 25., 21.,  0., 34., 34., 26.])
count_res tensor([1.0319e-16, 1.4924e-04, 4.0568e-04, 7.4302e-06, 7.4302e-06, 5.0065e-08,
        5.6340e-15, 4.0568e-04, 1.8418e-08, 1.8418e-08, 1.8418e-08, 1.8418e-08,
        1.8418e-08, 1.8418e-08, 1.8418e-08, 1.8418e-08, 1.8418e-08, 1.8418e-08,
        1.8418e-08, 1.8418e-08, 1.6366e-01, 1.6366e-01, 3.3733e-10, 6.0208e-02,
        1.6366e-01, 1.6366e-01, 5.4903e-05, 7.4302e-06, 1.6366e-01, 5.6340e-15,
        7.4302e-06, 1.3609e-07, 1.0319e-16, 6.0208e-02, 6.0208e-02, 2.0198e-05])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 75.37% 

Test Accuracy: 83.93% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7054258845746517
distance x is tensor(112.4712, device='cuda:1')
benign distance is  tensor(112.4712, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9845219757407904
distance x is tensor(94.3065, device='cuda:1')
benign distance is  tensor(94.3065, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8305043242871761
distance x is tensor(108.3413, device='cuda:1')
benign distance is  tensor(108.3413, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1898827478289604
distance x is tensor(143.1464, device='cuda:1')
benign distance is  tensor(143.1464, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0353874638676643
distance x is tensor(90.6036, device='cuda:1')
benign distance is  tensor(90.6036, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7208900945261121
distance x is tensor(99.9450, device='cuda:1')
benign distance is  tensor(99.9450, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0496831759810448
distance x is tensor(104.6738, device='cuda:1')
benign distance is  tensor(104.6738, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8672457784414291
distance x is tensor(91.7470, device='cuda:1')
benign distance is  tensor(91.7470, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.131820322945714
distance x is tensor(83.8082, device='cuda:1')
benign distance is  tensor(83.8082, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8122988771647215
distance x is tensor(113.8926, device='cuda:1')
benign distance is  tensor(113.8926, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.136278085410595
distance x is tensor(70.9029, device='cuda:1')
benign distance is  tensor(70.9029, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4682262241840363
distance x is tensor(112.7212, device='cuda:1')
benign distance is  tensor(112.7212, device='cuda:1') 1.3833428025245667
distance x is tensor(105.9049, device='cuda:0')
benign distance is  tensor(105.9049, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.449463076889515
distance x is tensor(107.9100, device='cuda:0')
benign distance is  tensor(107.9100, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.8818895071744919
distance x is tensor(100.3354, device='cuda:0')
benign distance is  tensor(100.3354, device='cuda:0')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.1640546321868896
distance x is tensor(105.0587, device='cuda:0')
benign distance is  tensor(105.0587, device='cuda:0')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.7903941422700882
distance x is tensor(133.1145, device='cuda:0')
benign distance is  tensor(133.1145, device='cuda:0')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.095129244029522
distance x is tensor(90.3160, device='cuda:0')
benign distance is  tensor(90.3160, device='cuda:0')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.7038132548332214
distance x is tensor(112.7935, device='cuda:0')
benign distance is  tensor(112.7935, device='cuda:0')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.7341711223125458
distance x is tensor(142.6027, device='cuda:0')
benign distance is  tensor(142.6027, device='cuda:0')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.287001296877861
distance x is tensor(84.5757, device='cuda:0')
benign distance is  tensor(84.5757, device='cuda:0')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.660877175629139
distance x is tensor(142.0931, device='cuda:0')
benign distance is  tensor(142.0931, device='cuda:0')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.435033783316612
distance x is tensor(121.8139, device='cuda:0')
benign distance is  tensor(121.8139, device='cuda:0')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.8607932329177856
distance x is tensor(95.0506, device='cuda:0')
benign distance is  tensor(95.0506, device='cuda:0')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  2.110187903046608
distance x is tensor(107.4065, device='cuda:0')
benign distance is  tensor(107.4065, device='cuda:0')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  3.20429827272892
distance x is tensor(121.2244, device='cuda:0')
benign distance is  tensor(121.2244, device='cuda:0')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.0723572373390198
distance x is tensor(124.8717, device='cuda:0')
benign distance is  tensor(124.8717, device='cuda:0')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.9680948331952095
distance x is tensor(113.0364, device='cuda:0')
benign distance is  tensor(113.0364, device='cuda:0')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.2369768507778645
distance x is tensor(204.9081, device='cuda:0')
benign distance is  tensor(204.9081, device='cuda:0')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.4843460321426392
distance x is tensor(155.4978, device='cuda:0')
benign distance is  tensor(155.4978, device='cuda:0')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.348539337515831
distance x is tensor(116.9742, device='cuda:0')
benign distance is  tensor(116.9742, device='cuda:0')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.2642631754279137
distance x is tensor(125.1756, device='cuda:0')
benign distance is  tensor(125.1756, device='cuda:0')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.8879800513386726
distance x is tensor(90.4853, device='cuda:0')
benign distance is  tensor(90.4853, device='cuda:0')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.189963847398758
distance x is tensor(133.9954, device='cuda:0')
benign distance is  tensor(133.9954, device='cuda:0')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  4.176792398095131
distance x is tensor(110.3253, device='cuda:0')
benign distance is  tensor(110.3253, device='cuda:0')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.5956352800130844
distance x is tensor(116.5893, device='cuda:0')
benign distance is  tensor(116.5893, device='cuda:0')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.813008964061737
distance x is tensor(122.1427, device='cuda:0')
benign distance is  tensor(122.1427, device='cuda:0')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6913390764966607
distance x is tensor(118.5094, device='cuda:0')
benign distance is  tensor(118.5094, device='cuda:0')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.69569081813097
distance x is tensor(151.7030, device='cuda:0')
benign distance is  tensor(151.7030, device='cuda:0')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  3.66189444065094
distance x is tensor(100.8831, device='cuda:0')
benign distance is  tensor(100.8831, device='cuda:0')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  4.4959129095077515
distance x is tensor(124.1894, device='cuda:0')
benign distance is  tensor(124.1894, device='cuda:0')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.7961448803544044
distance x is tensor(149.3930, device='cuda:0')
benign distance is  tensor(149.3930, device='cuda:0')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.7957559525966644
distance x is tensor(91.3004, device='cuda:0')
benign distance is  tensor(91.3004, device='cuda:0')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.5370136201381683
distance x is tensor(148.6710, device='cuda:0')
benign distance is  tensor(148.6710, device='cuda:0')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.8235648199915886
distance x is tensor(127.1031, device='cuda:0')
benign distance is  tensor(127.1031, device='cuda:0')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  3.1609114706516266
distance x is tensor(104.1913, device='cuda:0')
benign distance is  tensor(104.1913, device='cuda:0')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7344768662005663
distance x is tensor(138.7395, device='cuda:0')
benign distance is  tensor(138.7395, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 16
weight size is  torch.Size([20, 215370])
norm res is  tensor([ 594.0044,  462.9245,  408.3653,  612.6762,  503.7916,  473.1786,
         458.6111,  432.5762,  842.7842,  975.0886,  864.5312,  901.4009,
         817.4318,  870.8456,  920.9279,  809.3292,  912.4009,  865.7521,
         895.0212, 1010.1093], device='cuda:0')
sorted_norm is   tensor([ 408.3653,  432.5762,  458.6111,  462.9245,  473.1786,  503.7916,
         594.0044,  612.6762,  809.3292,  817.4318,  842.7842,  864.5312,
         865.7521,  870.8456,  895.0212,  901.4009,  912.4009,  920.9279,
         975.0886, 1010.1093], device='cuda:0')
used idx is  tensor([ 2,  7,  6,  1,  5,  4,  0,  3, 15, 12,  8, 10, 17, 13, 18, 11],
       device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.5731999650597572
distance x is tensor(102.7922, device='cuda:0')
benign distance is  tensor(102.7922, device='cuda:0')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.5066167190670967
distance x is tensor(63.7233, device='cuda:0')
benign distance is  tensor(63.7233, device='cuda:0')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.9199881106615067
distance x is tensor(36.0256, device='cuda:0')
benign distance is  tensor(36.0256, device='cuda:0')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.036902531981468
distance x is tensor(108.4552, device='cuda:0')
benign distance is  tensor(108.4552, device='cuda:0')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.9716207832098007
distance x is tensor(45.4792, device='cuda:0')
benign distance is  tensor(45.4792, device='cuda:0')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.7448723763227463
distance x is tensor(28.9176, device='cuda:0')
benign distance is  tensor(28.9176, device='cuda:0')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.2785584181547165
distance x is tensor(74.1600, device='cuda:0')
benign distance is  tensor(74.1600, device='cuda:0')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.809088408946991
distance x is tensor(22.2882, device='cuda:0')
benign distance is  tensor(22.2882, device='cuda:0')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
grad,shape is torch.Size([215370])
idx is 28
weight size is  torch.Size([36, 215370])
norm res is  tensor([645.0931, 507.5365, 370.0293, 715.3227, 471.0227, 254.3520, 546.7454,
        280.0862, 313.2368, 598.9297, 381.3725, 582.2994, 517.9666, 453.8487,
        539.2283, 500.4033, 447.5680, 578.9304, 516.5333, 655.5585, 742.7775,
        665.9835, 748.6331, 713.9766, 734.2209, 664.9357, 643.8416, 738.7635,
        638.7626, 750.3992, 573.1697, 669.3116, 786.3362, 562.6614, 778.0762,
        693.0582], device='cuda:0')
sorted_norm is   tensor([254.3520, 280.0862, 313.2368, 370.0293, 381.3725, 447.5680, 453.8487,
        471.0227, 500.4033, 507.5365, 516.5333, 517.9666, 539.2283, 546.7454,
        562.6614, 573.1697, 578.9304, 582.2994, 598.9297, 638.7626, 643.8416,
        645.0931, 655.5585, 664.9357, 665.9835, 669.3116, 693.0582, 713.9766,
        715.3227, 734.2209, 738.7635, 742.7775, 748.6331, 750.3992, 778.0762,
        786.3362], device='cuda:0')
used idx is  tensor([ 5,  7,  8,  2, 10, 16, 13,  4, 15,  1, 18, 12, 14,  6, 33, 30, 17, 11,
         9, 28, 26,  0, 19, 25, 21, 31, 35, 23], device='cuda:0')
weight size is  torch.Size([215370])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 34.42% 

Test Accuracy: 25.62% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 34.42%
|----0th round Training Accuracy : 0.00%
|----1th round Training Accuracy : 0.00%
|----2th round Training Accuracy : 0.00%
|----3th round Training Accuracy : 0.00%
|----4th round Training Accuracy : 0.00%
|----5th round Training Accuracy : 0.01%
|----6th round Training Accuracy : 0.00%
|----7th round Training Accuracy : 7.58%
|----8th round Training Accuracy : 12.93%
|----9th round Training Accuracy : 7.15%
|----10th round Training Accuracy : 0.00%
|----11th round Training Accuracy : 14.18%
|----12th round Training Accuracy : 0.00%
|----13th round Training Accuracy : 44.47%
|----14th round Training Accuracy : 4.93%
|----15th round Training Accuracy : 32.04%
|----16th round Training Accuracy : 0.00%
|----17th round Training Accuracy : 14.02%
|----18th round Training Accuracy : 0.00%
|----19th round Training Accuracy : 16.92%
|----20th round Training Accuracy : 13.11%
|----21th round Training Accuracy : 24.64%
|----22th round Training Accuracy : 0.00%
|----23th round Training Accuracy : 32.95%
|----24th round Training Accuracy : 22.35%
|----25th round Training Accuracy : 28.08%
|----26th round Training Accuracy : 21.20%
|----27th round Training Accuracy : 42.59%
|----28th round Training Accuracy : 0.00%
|----29th round Training Accuracy : 34.99%
|----30th round Training Accuracy : 0.00%
|----31th round Training Accuracy : 33.71%
|----32th round Training Accuracy : 13.08%
|----33th round Training Accuracy : 24.94%
|----34th round Training Accuracy : 28.02%
|----35th round Training Accuracy : 41.82%
|----36th round Training Accuracy : 0.00%
|----37th round Training Accuracy : 34.86%
|----38th round Training Accuracy : 0.00%
|----39th round Training Accuracy : 39.81%
|----40th round Training Accuracy : 0.00%
|----41th round Training Accuracy : 17.60%
|----42th round Training Accuracy : 0.00%
|----43th round Training Accuracy : 5.48%
|----44th round Training Accuracy : 38.13%
|----45th round Training Accuracy : 25.64%
|----46th round Training Accuracy : 0.00%
|----47th round Training Accuracy : 38.03%
|----48th round Training Accuracy : 0.00%
|----49th round Training Accuracy : 34.42%
|----Final Test Accuracy: 25.62%
|----0th round Final Test Accuracy : 10.00%
|----1th round Final Test Accuracy : 10.00%
|----2th round Final Test Accuracy : 10.00%
|----3th round Final Test Accuracy : 10.00%
|----4th round Final Test Accuracy : 10.00%
|----5th round Final Test Accuracy : 10.23%
|----6th round Final Test Accuracy : 10.00%
|----7th round Final Test Accuracy : 20.96%
|----8th round Final Test Accuracy : 38.54%
|----9th round Final Test Accuracy : 36.59%
|----10th round Final Test Accuracy : 10.00%
|----11th round Final Test Accuracy : 48.00%
|----12th round Final Test Accuracy : 10.00%
|----13th round Final Test Accuracy : 10.01%
|----14th round Final Test Accuracy : 14.21%
|----15th round Final Test Accuracy : 59.98%
|----16th round Final Test Accuracy : 10.00%
|----17th round Final Test Accuracy : 41.38%
|----18th round Final Test Accuracy : 10.00%
|----19th round Final Test Accuracy : 40.31%
|----20th round Final Test Accuracy : 37.23%
|----21th round Final Test Accuracy : 55.21%
|----22th round Final Test Accuracy : 10.00%
|----23th round Final Test Accuracy : 57.05%
|----24th round Final Test Accuracy : 48.46%
|----25th round Final Test Accuracy : 56.91%
|----26th round Final Test Accuracy : 54.43%
|----27th round Final Test Accuracy : 68.91%
|----28th round Final Test Accuracy : 10.00%
|----29th round Final Test Accuracy : 60.69%
|----30th round Final Test Accuracy : 10.00%
|----31th round Final Test Accuracy : 25.53%
|----32th round Final Test Accuracy : 30.85%
|----33th round Final Test Accuracy : 55.21%
|----34th round Final Test Accuracy : 54.14%
|----35th round Final Test Accuracy : 70.65%
|----36th round Final Test Accuracy : 10.00%
|----37th round Final Test Accuracy : 10.00%
|----38th round Final Test Accuracy : 10.00%
|----39th round Final Test Accuracy : 62.56%
|----40th round Final Test Accuracy : 10.00%
|----41th round Final Test Accuracy : 43.03%
|----42th round Final Test Accuracy : 10.00%
|----43th round Final Test Accuracy : 14.19%
|----44th round Final Test Accuracy : 65.29%
|----45th round Final Test Accuracy : 57.25%
|----46th round Final Test Accuracy : 10.00%
|----47th round Final Test Accuracy : 58.74%
|----48th round Final Test Accuracy : 10.00%
|----49th round Final Test Accuracy : 25.62%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     None of attack is done!


 Total Run Time: 3372.3880

current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1790310703217983
distance x is tensor(174.6545, device='cuda:1')
benign distance is  tensor(174.6545, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7687834613025188
distance x is tensor(65.1225, device='cuda:1')
benign distance is  tensor(65.1225, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9561372585594654
distance x is tensor(127.3166, device='cuda:1')
benign distance is  tensor(127.3166, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.277247291058302
distance x is tensor(113.0827, device='cuda:1')
benign distance is  tensor(113.0827, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.1309224627912045
distance x is tensor(105.6104, device='cuda:1')
benign distance is  tensor(105.6104, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9097168371081352
distance x is tensor(72.5455, device='cuda:1')
benign distance is  tensor(72.5455, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.94741540402174
distance x is tensor(114.3472, device='cuda:1')
benign distance is  tensor(114.3472, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.2150874957442284
distance x is tensor(101.0176, device='cuda:1')
benign distance is  tensor(101.0176, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8774473927915096
distance x is tensor(110.5430, device='cuda:1')
benign distance is  tensor(110.5430, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9708335548639297
distance x is tensor(98.2420, device='cuda:1')
benign distance is  tensor(98.2420, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.55291030369699
distance x is tensor(106.7885, device='cuda:1')
benign distance is  tensor(106.7885, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7694556219503284
distance x is tensor(155.7948, device='cuda:1')
benign distance is  tensor(155.7948, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([19., 19., 15., 18., 13., 18., 19., 17., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([0.0629, 0.0629, 0.0012, 0.0231, 0.0002, 0.0231, 0.0629, 0.0085, 0.0629,
        0.0629, 0.0629, 0.0629, 0.0629, 0.0629, 0.0629, 0.0629, 0.0629, 0.0629,
        0.0629, 0.0629])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 0.62% 

Test Accuracy: 10.00% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.704059973359108
distance x is tensor(4869.2959, device='cuda:1')
benign distance is  tensor(4869.2959, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.9253794699907303
distance x is tensor(3076.0420, device='cuda:1')
benign distance is  tensor(3076.0420, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.914455786347389
distance x is tensor(3428.1987, device='cuda:1')
benign distance is  tensor(3428.1987, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.8578122556209564
distance x is tensor(4970.2676, device='cuda:1')
benign distance is  tensor(4970.2676, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.0070021003484726
distance x is tensor(2113.3589, device='cuda:1')
benign distance is  tensor(2113.3589, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.563638523221016
distance x is tensor(3615.7275, device='cuda:1')
benign distance is  tensor(3615.7275, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.793145164847374
distance x is tensor(4380.8159, device='cuda:1')
benign distance is  tensor(4380.8159, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.5999674052000046
distance x is tensor(3054.4900, device='cuda:1')
benign distance is  tensor(3054.4900, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 44
counter_tensor is  tensor([36., 36., 36., 36., 36., 36., 36., 36., 12., 12., 12., 12., 12., 12.,
        12., 12., 12., 12., 12., 12., 33., 36.,  0., 43., 33., 10., 35., 35.,
        22., 23., 34., 43., 16.,  1., 42.,  8., 15., 43., 43., 43., 15.,  9.,
         0., 38.])
count_res tensor([1.6938e-04, 1.6938e-04, 1.6938e-04, 1.6938e-04, 1.6938e-04, 1.6938e-04,
        1.6938e-04, 1.6938e-04, 6.3942e-15, 6.3942e-15, 6.3942e-15, 6.3942e-15,
        6.3942e-15, 6.3942e-15, 6.3942e-15, 6.3942e-15, 6.3942e-15, 6.3942e-15,
        6.3942e-15, 6.3942e-15, 8.4328e-06, 1.6938e-04, 3.9288e-20, 1.8575e-01,
        8.4328e-06, 8.6537e-16, 6.2311e-05, 6.2311e-05, 1.4084e-10, 3.8285e-10,
        2.2923e-05, 1.8575e-01, 3.4911e-13, 1.0679e-19, 6.8332e-02, 1.1711e-16,
        1.2843e-13, 1.8575e-01, 1.8575e-01, 1.8575e-01, 1.2843e-13, 3.1835e-16,
        3.9288e-20, 1.2515e-03])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 78.05% 

Test Accuracy: 84.69% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5915185455232859
distance x is tensor(118.4676, device='cuda:1')
benign distance is  tensor(118.4676, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.833998866379261
distance x is tensor(104.0950, device='cuda:1')
benign distance is  tensor(104.0950, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8253852389752865
distance x is tensor(105.3964, device='cuda:1')
benign distance is  tensor(105.3964, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.880721889436245
distance x is tensor(145.7803, device='cuda:1')
benign distance is  tensor(145.7803, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9031394533813
distance x is tensor(83.4548, device='cuda:1')
benign distance is  tensor(83.4548, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7033313848078251
distance x is tensor(99.0534, device='cuda:1')
benign distance is  tensor(99.0534, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1882096827030182
distance x is tensor(89.4789, device='cuda:1')
benign distance is  tensor(89.4789, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7181224394589663
distance x is tensor(86.0703, device='cuda:1')
benign distance is  tensor(86.0703, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9948490597307682
distance x is tensor(86.1557, device='cuda:1')
benign distance is  tensor(86.1557, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8132374305278063
distance x is tensor(99.3443, device='cuda:1')
benign distance is  tensor(99.3443, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2149808034300804
distance x is tensor(61.2388, device='cuda:1')
benign distance is  tensor(61.2388, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2489710040390491
distance x is tensor(94.0425, device='cuda:1')
benign distance is  tensor(94.0425, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0186061076819897
distance x is tensor(151.5375, device='cuda:1')
benign distance is  tensor(151.5375, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7091816272586584
distance x is tensor(53.3719, device='cuda:1')
benign distance is  tensor(53.3719, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0988822467625141
distance x is tensor(129.0046, device='cuda:1')
benign distance is  tensor(129.0046, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.32439698651433
distance x is tensor(112.8681, device='cuda:1')
benign distance is  tensor(112.8681, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.0964766666293144
distance x is tensor(83.1120, device='cuda:1')
benign distance is  tensor(83.1120, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8393509406596422
distance x is tensor(97.1544, device='cuda:1')
benign distance is  tensor(97.1544, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9407310299575329
distance x is tensor(112.9533, device='cuda:1')
benign distance is  tensor(112.9533, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.893225658684969
distance x is tensor(108.5283, device='cuda:1')
benign distance is  tensor(108.5283, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.9700507875531912
distance x is tensor(69.4643, device='cuda:1')
benign distance is  tensor(69.4643, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6015965286642313
distance x is tensor(194.1446, device='cuda:1')
benign distance is  tensor(194.1446, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1261349320411682
distance x is tensor(129.4034, device='cuda:1')
benign distance is  tensor(129.4034, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7013780483976007
distance x is tensor(102.7173, device='cuda:1')
benign distance is  tensor(102.7173, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.5956098288297653
distance x is tensor(106.4697, device='cuda:1')
benign distance is  tensor(106.4697, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.2742134854197502
distance x is tensor(125.5254, device='cuda:1')
benign distance is  tensor(125.5254, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.0061754304915667
distance x is tensor(125.3700, device='cuda:1')
benign distance is  tensor(125.3700, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.9330636821687222
distance x is tensor(67.1167, device='cuda:1')
benign distance is  tensor(67.1167, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.663833862170577
distance x is tensor(148.4754, device='cuda:1')
benign distance is  tensor(148.4754, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7834775689989328
distance x is tensor(124.5079, device='cuda:1')
benign distance is  tensor(124.5079, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.817255973815918
distance x is tensor(93.6070, device='cuda:1')
benign distance is  tensor(93.6070, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6581106940284371
distance x is tensor(118.7907, device='cuda:1')
benign distance is  tensor(118.7907, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([14., 18., 12., 13., 15., 17., 13., 14., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([5.3728e-04, 2.9334e-02, 7.2713e-05, 1.9765e-04, 1.4605e-03, 1.0792e-02,
        1.9765e-04, 5.3728e-04, 7.9739e-02, 7.9739e-02, 7.9739e-02, 7.9739e-02,
        7.9739e-02, 7.9739e-02, 7.9739e-02, 7.9739e-02, 7.9739e-02, 7.9739e-02,
        7.9739e-02, 7.9739e-02])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 0.62% 

Test Accuracy: 10.00% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.6544946879148483
distance x is tensor(25612.6172, device='cuda:1')
benign distance is  tensor(25612.6172, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.0200506448745728
distance x is tensor(42389.2109, device='cuda:1')
benign distance is  tensor(42389.2109, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.6955356150865555
distance x is tensor(47531.0586, device='cuda:1')
benign distance is  tensor(47531.0586, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.8633768260478973
distance x is tensor(128908.7266, device='cuda:1')
benign distance is  tensor(128908.7266, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.9830724895000458
distance x is tensor(27233.3477, device='cuda:1')
benign distance is  tensor(27233.3477, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.5763906985521317
distance x is tensor(63386.6953, device='cuda:1')
benign distance is  tensor(63386.6953, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.7983853071928024
distance x is tensor(111282.8516, device='cuda:1')
benign distance is  tensor(111282.8516, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.6862364262342453
distance x is tensor(67153.9062, device='cuda:1')
benign distance is  tensor(67153.9062, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 44
counter_tensor is  tensor([36., 36., 36., 36., 36., 36., 36., 36., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 11., 29., 43., 28., 21., 14., 34.,  0.,
        30., 43., 32., 34., 41., 24.,  0., 42., 14.,  8., 12., 29., 41., 39.,
        11., 28.])
count_res tensor([3.4224e-04, 3.4224e-04, 3.4224e-04, 3.4224e-04, 3.4224e-04, 3.4224e-04,
        3.4224e-04, 3.4224e-04, 2.1028e-09, 2.1028e-09, 2.1028e-09, 2.1028e-09,
        2.1028e-09, 2.1028e-09, 2.1028e-09, 2.1028e-09, 2.1028e-09, 2.1028e-09,
        2.1028e-09, 2.1028e-09, 4.7531e-15, 3.1209e-07, 3.7532e-01, 1.1481e-07,
        1.0469e-10, 9.5468e-14, 4.6318e-05, 7.9384e-20, 8.4834e-07, 3.7532e-01,
        6.2684e-06, 4.6318e-05, 5.0793e-02, 2.1028e-09, 7.9384e-20, 1.3807e-01,
        9.5468e-14, 2.3664e-16, 1.2920e-14, 3.1209e-07, 5.0793e-02, 6.8741e-03,
        4.7531e-15, 1.1481e-07])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 63.54% 

Test Accuracy: 76.85% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6776347449049354
distance x is tensor(119.3753, device='cuda:1')
benign distance is  tensor(119.3753, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2031747177243233
distance x is tensor(105.1762, device='cuda:1')
benign distance is  tensor(105.1762, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0689678750932217
distance x is tensor(101.9614, device='cuda:1')
benign distance is  tensor(101.9614, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2151393741369247
distance x is tensor(141.8109, device='cuda:1')
benign distance is  tensor(141.8109, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3798265270888805
distance x is tensor(94.2297, device='cuda:1')
benign distance is  tensor(94.2297, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.904245812445879
distance x is tensor(102.4958, device='cuda:1')
benign distance is  tensor(102.4958, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5871037244796753
distance x is tensor(102.7100, device='cuda:1')
benign distance is  tensor(102.7100, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8980195540934801
distance x is tensor(96.4340, device='cuda:1')
benign distance is  tensor(96.4340, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1337204687297344
distance x is tensor(87.5345, device='cuda:1')
benign distance is  tensor(87.5345, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9480918552726507
distance x is tensor(127.4049, device='cuda:1')
benign distance is  tensor(127.4049, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3341937512159348
distance x is tensor(91.9888, device='cuda:1')
benign distance is  tensor(91.9888, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.721343919634819
distance x is tensor(116.9963, device='cuda:1')
benign distance is  tensor(116.9963, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1343003138899803
distance x is tensor(149.4256, device='cuda:1')
benign distance is  tensor(149.4256, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.0481074936687946
distance x is tensor(73.1648, device='cuda:1')
benign distance is  tensor(73.1648, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9150471240282059
distance x is tensor(129.9885, device='cuda:1')
benign distance is  tensor(129.9885, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.8618508987128735
distance x is tensor(120.3885, device='cuda:1')
benign distance is  tensor(120.3885, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.2681810781359673
distance x is tensor(108.6359, device='cuda:1')
benign distance is  tensor(108.6359, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9184279926121235
distance x is tensor(58.4610, device='cuda:1')
benign distance is  tensor(58.4610, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.2700717560946941
distance x is tensor(127.1071, device='cuda:1')
benign distance is  tensor(127.1071, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.3158287331461906
distance x is tensor(115.5926, device='cuda:1')
benign distance is  tensor(115.5926, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.0791036076843739
distance x is tensor(109.3396, device='cuda:1')
benign distance is  tensor(109.3396, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.1288847737014294
distance x is tensor(110.1125, device='cuda:1')
benign distance is  tensor(110.1125, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6134983319789171
distance x is tensor(116.9577, device='cuda:1')
benign distance is  tensor(116.9577, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.2263042740523815
distance x is tensor(157.3105, device='cuda:1')
benign distance is  tensor(157.3105, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8588342312723398
distance x is tensor(123.6848, device='cuda:1')
benign distance is  tensor(123.6848, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.238191094249487
distance x is tensor(105.4822, device='cuda:1')
benign distance is  tensor(105.4822, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.9681923240423203
distance x is tensor(131.3447, device='cuda:1')
benign distance is  tensor(131.3447, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.8440417647361755
distance x is tensor(120.9807, device='cuda:1')
benign distance is  tensor(120.9807, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8929174169898033
distance x is tensor(111.9796, device='cuda:1')
benign distance is  tensor(111.9796, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.0390811003744602
distance x is tensor(88.9351, device='cuda:1')
benign distance is  tensor(88.9351, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.9962168969213963
distance x is tensor(91.2758, device='cuda:1')
benign distance is  tensor(91.2758, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7534261420369148
distance x is tensor(116.9562, device='cuda:1')
benign distance is  tensor(116.9562, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([27., 27., 27., 25., 27., 27., 27., 26., 12., 12., 12., 12., 12., 12.,
        12., 12., 12., 12., 12., 12., 23., 23., 16., 26., 22., 24., 23., 10.])
count_res tensor([1.4321e-01, 1.4321e-01, 1.4321e-01, 1.9382e-02, 1.4321e-01, 1.4321e-01,
        1.4321e-01, 5.2685e-02, 4.3809e-08, 4.3809e-08, 4.3809e-08, 4.3809e-08,
        4.3809e-08, 4.3809e-08, 4.3809e-08, 4.3809e-08, 4.3809e-08, 4.3809e-08,
        4.3809e-08, 4.3809e-08, 2.6230e-03, 2.6230e-03, 2.3919e-06, 5.2685e-02,
        9.6496e-04, 7.1302e-03, 2.6230e-03, 5.9289e-09])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 80.08% 

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     None of attack is done!


Test Accuracy: 85.65% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8383935391902924
distance x is tensor(115.7097, device='cuda:1')
benign distance is  tensor(115.7097, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9457050301134586
distance x is tensor(101.2968, device='cuda:1')
benign distance is  tensor(101.2968, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8460990702733397
distance x is tensor(100.1598, device='cuda:1')
benign distance is  tensor(100.1598, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1499310322105885
distance x is tensor(138.9363, device='cuda:1')
benign distance is  tensor(138.9363, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0869630742818117
distance x is tensor(74.6365, device='cuda:1')
benign distance is  tensor(74.6365, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.854337602853775
distance x is tensor(104.2241, device='cuda:1')
benign distance is  tensor(104.2241, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3280552811920643
distance x is tensor(82.3857, device='cuda:1')
benign distance is  tensor(82.3857, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8127640672028065
distance x is tensor(84.7842, device='cuda:1')
benign distance is  tensor(84.7842, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1725592836737633
distance x is tensor(105.1699, device='cuda:1')
benign distance is  tensor(105.1699, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8085711915045977
distance x is tensor(111.0775, device='cuda:1')
benign distance is  tensor(111.0775, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.0233620665967464
distance x is tensor(115.1311, device='cuda:1')
benign distance is  tensor(115.1311, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.0981569103896618
distance x is tensor(102.4817, device='cuda:1')
benign distance is  tensor(102.4817, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0701167844235897
distance x is tensor(72.6230, device='cuda:1')
benign distance is  tensor(72.6230, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.012951161712408
distance x is tensor(189.2382, device='cuda:1')
benign distance is  tensor(189.2382, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.179619699716568
distance x is tensor(133.8213, device='cuda:1')
benign distance is  tensor(133.8213, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7204933231696486
distance x is tensor(98.2669, device='cuda:1')
benign distance is  tensor(98.2669, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([26., 27., 24.,  3., 27., 25., 27., 27., 13., 13., 13., 13., 13., 13.,
        13., 13., 13., 13., 13., 13., 27., 26., 25., 23., 26., 25., 19., 26.])
count_res tensor([5.2963e-02, 1.4397e-01, 7.1678e-03, 5.4350e-12, 1.4397e-01, 1.9484e-02,
        1.4397e-01, 1.4397e-01, 1.1971e-07, 1.1971e-07, 1.1971e-07, 1.1971e-07,
        1.1971e-07, 1.1971e-07, 1.1971e-07, 1.1971e-07, 1.1971e-07, 1.1971e-07,
        1.1971e-07, 1.1971e-07, 1.4397e-01, 5.2963e-02, 1.9484e-02, 2.6369e-03,
        5.2963e-02, 1.9484e-02, 4.8296e-05, 5.2963e-02])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 76.54% 

Test Accuracy: 85.11% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7363698221743107
distance x is tensor(110.8415, device='cuda:1')
benign distance is  tensor(110.8415, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.902018005028367
distance x is tensor(88.7008, device='cuda:1')
benign distance is  tensor(88.7008, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9146150220185518
distance x is tensor(99.0581, device='cuda:1')
benign distance is  tensor(99.0581, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0641287732869387
distance x is tensor(143.7401, device='cuda:1')
benign distance is  tensor(143.7401, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2155596651136875
distance x is tensor(129.8061, device='cuda:1')
benign distance is  tensor(129.8061, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8218901716172695
distance x is tensor(99.8452, device='cuda:1')
benign distance is  tensor(99.8452, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2926490232348442
distance x is tensor(81.3593, device='cuda:1')
benign distance is  tensor(81.3593, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7116095200181007
distance x is tensor(82.1595, device='cuda:1')
benign distance is  tensor(82.1595, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.176685033366084
distance x is tensor(83.1976, device='cuda:1')
benign distance is  tensor(83.1976, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8237906452268362
distance x is tensor(108.7651, device='cuda:1')
benign distance is  tensor(108.7651, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2081108689308167
distance x is tensor(80.2246, device='cuda:1')
benign distance is  tensor(80.2246, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3691332191228867
distance x is tensor(113.9390, device='cuda:1')
benign distance is  tensor(113.9390, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.4818024784326553
distance x is tensor(134.4015, device='cuda:1')
benign distance is  tensor(134.4015, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.821703739464283
distance x is tensor(58.1692, device='cuda:1')
benign distance is  tensor(58.1692, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0038713961839676
distance x is tensor(131.9316, device='cuda:1')
benign distance is  tensor(131.9316, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.9746277183294296
distance x is tensor(130.8437, device='cuda:1')
benign distance is  tensor(130.8437, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([13., 19., 19., 18., 12., 15., 12., 19., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([1.6106e-04, 6.4975e-02, 6.4975e-02, 2.3903e-02, 5.9250e-05, 1.1901e-03,
        5.9250e-05, 6.4975e-02, 6.4975e-02, 6.4975e-02, 6.4975e-02, 6.4975e-02,
        6.4975e-02, 6.4975e-02, 6.4975e-02, 6.4975e-02, 6.4975e-02, 6.4975e-02,
        6.4975e-02, 6.4975e-02])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 0.62% 

Test Accuracy: 10.00% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.662787899374962
distance x is tensor(60376.5000, device='cuda:1')
benign distance is  tensor(60376.5000, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.9543595761060715
distance x is tensor(18138.9805, device='cuda:1')
benign distance is  tensor(18138.9805, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.9269194900989532
distance x is tensor(17199.5762, device='cuda:1')
benign distance is  tensor(17199.5762, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.847327545285225
distance x is tensor(107705.1719, device='cuda:1')
benign distance is  tensor(107705.1719, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.9812355637550354
distance x is tensor(24340.8633, device='cuda:1')
benign distance is  tensor(24340.8633, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.5714545249938965
distance x is tensor(79784.6484, device='cuda:1')
benign distance is  tensor(79784.6484, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.800669491291046
distance x is tensor(36211.7500, device='cuda:1')
benign distance is  tensor(36211.7500, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.6813221871852875
distance x is tensor(76739.7109, device='cuda:1')
benign distance is  tensor(76739.7109, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 52
counter_tensor is  tensor([44., 44., 44., 44., 44., 44., 44., 44.,  8.,  8.,  8.,  8.,  8.,  8.,
         8.,  8.,  8.,  8.,  8.,  8.,  0., 29.,  0., 50.,  0., 46., 17.,  0.,
        40., 51., 11., 51., 36.,  1., 42., 51., 50., 42., 40., 47., 27., 51.,
        51., 48.,  9., 27., 51., 21.,  8., 44., 39.,  0.])
count_res tensor([1.3372e-04, 1.3372e-04, 1.3372e-04, 1.3372e-04, 1.3372e-04, 1.3372e-04,
        1.3372e-04, 1.3372e-04, 3.1018e-20, 3.1018e-20, 3.1018e-20, 3.1018e-20,
        3.1018e-20, 3.1018e-20, 3.1018e-20, 3.1018e-20, 3.1018e-20, 3.1018e-20,
        3.1018e-20, 3.1018e-20, 1.0405e-23, 4.0907e-11, 1.0405e-23, 5.3948e-02,
        1.0405e-23, 9.8810e-04, 2.5134e-16, 1.0405e-23, 2.4493e-06, 1.4665e-01,
        6.2301e-19, 1.4665e-01, 4.4860e-08, 2.8285e-23, 1.8098e-05, 1.4665e-01,
        5.3948e-02, 1.8098e-05, 2.4493e-06, 2.6859e-03, 5.5361e-12, 1.4665e-01,
        1.4665e-01, 7.3011e-03, 8.4315e-20, 5.5361e-12, 1.4665e-01, 1.3723e-14,
        3.1018e-20, 1.3372e-04, 9.0103e-07, 1.0405e-23])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 62.92% 

Test Accuracy: 80.81% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7607769519090652
distance x is tensor(117.1365, device='cuda:1')
benign distance is  tensor(117.1365, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0000709854066372
distance x is tensor(91.6853, device='cuda:1')
benign distance is  tensor(91.6853, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9761258456856012
distance x is tensor(97.7063, device='cuda:1')
benign distance is  tensor(97.7063, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0972946360707283
distance x is tensor(131.9324, device='cuda:1')
benign distance is  tensor(131.9324, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1256069336086512
distance x is tensor(87.4996, device='cuda:1')
benign distance is  tensor(87.4996, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9369530845433474
distance x is tensor(97.0784, device='cuda:1')
benign distance is  tensor(97.0784, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5973044596612453
distance x is tensor(82.4882, device='cuda:1')
benign distance is  tensor(82.4882, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0165603682398796
distance x is tensor(81.2045, device='cuda:1')
benign distance is  tensor(81.2045, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.389687329530716
distance x is tensor(86.6372, device='cuda:1')
benign distance is  tensor(86.6372, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.138068314641714
distance x is tensor(123.6161, device='cuda:1')
benign distance is  tensor(123.6161, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.462834257632494
distance x is tensor(61.8891, device='cuda:1')
benign distance is  tensor(61.8891, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.3169009760022163
distance x is tensor(116.8344, device='cuda:1')
benign distance is  tensor(116.8344, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2110777013003826
distance x is tensor(138.0458, device='cuda:1')
benign distance is  tensor(138.0458, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.011010717600584
distance x is tensor(69.8453, device='cuda:1')
benign distance is  tensor(69.8453, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1824551783502102
distance x is tensor(120.8282, device='cuda:1')
benign distance is  tensor(120.8282, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.0927915051579475
distance x is tensor(127.9724, device='cuda:1')
benign distance is  tensor(127.9724, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.7531316615641117
distance x is tensor(87.9886, device='cuda:1')
benign distance is  tensor(87.9886, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8957143165171146
distance x is tensor(105.4868, device='cuda:1')
benign distance is  tensor(105.4868, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.1381979696452618
distance x is tensor(111.4663, device='cuda:1')
benign distance is  tensor(111.4663, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.3470384888350964
distance x is tensor(104.7762, device='cuda:1')
benign distance is  tensor(104.7762, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0605216305702925
distance x is tensor(73.6010, device='cuda:1')
benign distance is  tensor(73.6010, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9073444437235594
distance x is tensor(189.7235, device='cuda:1')
benign distance is  tensor(189.7235, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1220723241567612
distance x is tensor(138.5519, device='cuda:1')
benign distance is  tensor(138.5519, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.1109747812151909
distance x is tensor(98.3345, device='cuda:1')
benign distance is  tensor(98.3345, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.3659976795315742
distance x is tensor(109.9545, device='cuda:1')
benign distance is  tensor(109.9545, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9295959062874317
distance x is tensor(61.8528, device='cuda:1')
benign distance is  tensor(61.8528, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.1682692542672157
distance x is tensor(120.6723, device='cuda:1')
benign distance is  tensor(120.6723, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.1018794029951096
distance x is tensor(94.1191, device='cuda:1')
benign distance is  tensor(94.1191, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.0744410641491413
distance x is tensor(102.6960, device='cuda:1')
benign distance is  tensor(102.6960, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.056674076244235
distance x is tensor(97.6802, device='cuda:1')
benign distance is  tensor(97.6802, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5319107454270124
distance x is tensor(115.4225, device='cuda:1')
benign distance is  tensor(115.4225, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.0933395400643349
distance x is tensor(151.1965, device='cuda:1')
benign distance is  tensor(151.1965, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.3053564950823784
distance x is tensor(89.7617, device='cuda:1')
benign distance is  tensor(89.7617, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.4067292883992195
distance x is tensor(121.0053, device='cuda:1')
benign distance is  tensor(121.0053, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.331438772380352
distance x is tensor(128.9767, device='cuda:1')
benign distance is  tensor(128.9767, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.150544285774231
distance x is tensor(76.3739, device='cuda:1')
benign distance is  tensor(76.3739, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.862873088568449
distance x is tensor(148.0980, device='cuda:1')
benign distance is  tensor(148.0980, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.1732307262718678
distance x is tensor(123.0574, device='cuda:1')
benign distance is  tensor(123.0574, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.0787116643041372
distance x is tensor(101.1790, device='cuda:1')
benign distance is  tensor(101.1790, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5482033984735608
distance x is tensor(125.8826, device='cuda:1')
benign distance is  tensor(125.8826, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([24., 27., 26., 26.,  5., 27., 26., 27., 14., 14., 14., 14., 14., 14.,
        14., 14., 14., 14., 14., 14., 27., 27., 23., 27., 22., 27., 27., 19.])
count_res tensor([5.4241e-03, 1.0895e-01, 4.0079e-02, 4.0079e-02, 3.0390e-11, 1.0895e-01,
        4.0079e-02, 1.0895e-01, 2.4625e-07, 2.4625e-07, 2.4625e-07, 2.4625e-07,
        2.4625e-07, 2.4625e-07, 2.4625e-07, 2.4625e-07, 2.4625e-07, 2.4625e-07,
        2.4625e-07, 2.4625e-07, 1.0895e-01, 1.0895e-01, 1.9954e-03, 1.0895e-01,
        7.3407e-04, 1.0895e-01, 1.0895e-01, 3.6547e-05])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 75.43% 

Test Accuracy: 84.86% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7332798521965742
distance x is tensor(123.8600, device='cuda:1')
benign distance is  tensor(123.8600, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8478290345519781
distance x is tensor(91.5057, device='cuda:1')
benign distance is  tensor(91.5057, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9488159827888012
distance x is tensor(101.3465, device='cuda:1')
benign distance is  tensor(101.3465, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.102959644049406
distance x is tensor(130.9585, device='cuda:1')
benign distance is  tensor(130.9585, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1367818303406239
distance x is tensor(89.7256, device='cuda:1')
benign distance is  tensor(89.7256, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7196809155866504
distance x is tensor(84.6243, device='cuda:1')
benign distance is  tensor(84.6243, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.257241401821375
distance x is tensor(101.5544, device='cuda:1')
benign distance is  tensor(101.5544, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8426001630723476
distance x is tensor(78.6745, device='cuda:1')
benign distance is  tensor(78.6745, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7658899128437042
distance x is tensor(115.6534, device='cuda:1')
benign distance is  tensor(115.6534, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.1852911841124296
distance x is tensor(85.0223, device='cuda:1')
benign distance is  tensor(85.0223, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.928624827414751
distance x is tensor(125.8777, device='cuda:1')
benign distance is  tensor(125.8777, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.6251997649669647
distance x is tensor(103.4688, device='cuda:1')
benign distance is  tensor(103.4688, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.834586625918746
distance x is tensor(109.9126, device='cuda:1')
benign distance is  tensor(109.9126, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.9010486770421267
distance x is tensor(87.5814, device='cuda:1')
benign distance is  tensor(87.5814, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7763513419777155
distance x is tensor(82.7649, device='cuda:1')
benign distance is  tensor(82.7649, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7238395623862743
distance x is tensor(113.2882, device='cuda:1')
benign distance is  tensor(113.2882, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([27., 22., 26., 25., 26., 25., 27., 27., 15., 15., 15., 15., 15., 15.,
        15., 15., 15., 15., 15., 15., 25., 25., 27., 27., 26., 26.,  1., 26.])
count_res tensor([1.3536e-01, 9.1207e-04, 4.9797e-02, 1.8319e-02, 4.9797e-02, 1.8319e-02,
        1.3536e-01, 1.3536e-01, 8.3170e-07, 8.3170e-07, 8.3170e-07, 8.3170e-07,
        8.3170e-07, 8.3170e-07, 8.3170e-07, 8.3170e-07, 8.3170e-07, 8.3170e-07,
        8.3170e-07, 8.3170e-07, 1.8319e-02, 1.8319e-02, 1.3536e-01, 1.3536e-01,
        4.9797e-02, 4.9797e-02, 6.9158e-13, 4.9797e-02])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 77.36% 

Test Accuracy: 84.51% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7806723173707724
distance x is tensor(103.5529, device='cuda:1')
benign distance is  tensor(103.5529, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.797606747597456
distance x is tensor(95.7077, device='cuda:1')
benign distance is  tensor(95.7077, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7984483409672976
distance x is tensor(102.4459, device='cuda:1')
benign distance is  tensor(102.4459, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0362309701740742
distance x is tensor(141.0932, device='cuda:1')
benign distance is  tensor(141.0932, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9257359765470028
distance x is tensor(85.8008, device='cuda:1')
benign distance is  tensor(85.8008, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8801126731559634
distance x is tensor(102.4116, device='cuda:1')
benign distance is  tensor(102.4116, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5708989165723324
distance x is tensor(85.4711, device='cuda:1')
benign distance is  tensor(85.4711, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9133178852498531
distance x is tensor(74.3593, device='cuda:1')
benign distance is  tensor(74.3593, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1551229991018772
distance x is tensor(89.7258, device='cuda:1')
benign distance is  tensor(89.7258, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6989801283925772
distance x is tensor(113.1194, device='cuda:1')
benign distance is  tensor(113.1194, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1475683152675629
distance x is tensor(70.1559, device='cuda:1')
benign distance is  tensor(70.1559, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3862175308167934
distance x is tensor(103.0914, device='cuda:1')
benign distance is  tensor(103.0914, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.3120689652860165
distance x is tensor(139.3943, device='cuda:1')
benign distance is  tensor(139.3943, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8201993349939585
distance x is tensor(59.8735, device='cuda:1')
benign distance is  tensor(59.8735, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.846082704141736
distance x is tensor(128.6299, device='cuda:1')
benign distance is  tensor(128.6299, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.7393800616264343
distance x is tensor(113.4445, device='cuda:1')
benign distance is  tensor(113.4445, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([27., 17., 18., 22., 26., 24., 26.,  4., 14., 14., 14., 14., 14., 14.,
        14., 14., 14., 14., 14., 14., 27., 22., 24., 26., 22., 25., 26., 21.])
count_res tensor([2.6815e-01, 1.2174e-05, 3.3092e-05, 1.8068e-03, 9.8645e-02, 1.3350e-02,
        9.8645e-02, 2.7517e-11, 6.0610e-07, 6.0610e-07, 6.0610e-07, 6.0610e-07,
        6.0610e-07, 6.0610e-07, 6.0610e-07, 6.0610e-07, 6.0610e-07, 6.0610e-07,
        6.0610e-07, 6.0610e-07, 2.6815e-01, 1.8068e-03, 1.3350e-02, 9.8645e-02,
        1.8068e-03, 3.6290e-02, 9.8645e-02, 6.6467e-04])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 84.56% 

Test Accuracy: 86.35% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8065043445676565
distance x is tensor(112.9575, device='cuda:1')
benign distance is  tensor(112.9575, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8995001167058945
distance x is tensor(97.1932, device='cuda:1')
benign distance is  tensor(97.1932, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7400734657421708
distance x is tensor(103.2440, device='cuda:1')
benign distance is  tensor(103.2440, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9661469794809818
distance x is tensor(135.6160, device='cuda:1')
benign distance is  tensor(135.6160, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0802654344588518
distance x is tensor(82.5307, device='cuda:1')
benign distance is  tensor(82.5307, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6632726825773716
distance x is tensor(105.9576, device='cuda:1')
benign distance is  tensor(105.9576, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3242484405636787
distance x is tensor(80.0908, device='cuda:1')
benign distance is  tensor(80.0908, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8211302757263184
distance x is tensor(80.1490, device='cuda:1')
benign distance is  tensor(80.1490, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1491455882787704
distance x is tensor(76.3961, device='cuda:1')
benign distance is  tensor(76.3961, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7616101913154125
distance x is tensor(106.6717, device='cuda:1')
benign distance is  tensor(106.6717, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8972000107169151
distance x is tensor(107.8283, device='cuda:1')
benign distance is  tensor(107.8283, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.1042007505893707
distance x is tensor(114.7106, device='cuda:1')
benign distance is  tensor(114.7106, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.8979438040405512
distance x is tensor(68.2747, device='cuda:1')
benign distance is  tensor(68.2747, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7232414577156305
distance x is tensor(192.2962, device='cuda:1')
benign distance is  tensor(192.2962, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1455369759351015
distance x is tensor(133.0662, device='cuda:1')
benign distance is  tensor(133.0662, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8396348189562559
distance x is tensor(105.3160, device='cuda:1')
benign distance is  tensor(105.3160, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 36
counter_tensor is  tensor([33., 35., 30.,  0., 29., 34., 34., 34.,  2.,  2.,  2.,  2.,  2.,  2.,
         2.,  2.,  2.,  2.,  2.,  2., 33., 34., 14., 33., 31.,  8., 35., 35.,
        32.,  5., 32., 35., 21., 34., 30., 34.])
count_res tensor([2.0058e-02, 1.4821e-01, 9.9864e-04, 9.3449e-17, 3.6738e-04, 5.4524e-02,
        5.4524e-02, 5.4524e-02, 6.9050e-16, 6.9050e-16, 6.9050e-16, 6.9050e-16,
        6.9050e-16, 6.9050e-16, 6.9050e-16, 6.9050e-16, 6.9050e-16, 6.9050e-16,
        6.9050e-16, 6.9050e-16, 2.0058e-02, 5.4524e-02, 1.1238e-10, 2.0058e-02,
        2.7146e-03, 2.7857e-13, 1.4821e-01, 1.4821e-01, 7.3790e-03, 1.3869e-14,
        7.3790e-03, 1.4821e-01, 1.2324e-07, 5.4524e-02, 9.9864e-04, 5.4524e-02])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 86.05% 

Test Accuracy: 86.60% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7155301850289106
distance x is tensor(110.5018, device='cuda:1')
benign distance is  tensor(110.5018, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8180097080767155
distance x is tensor(82.1239, device='cuda:1')
benign distance is  tensor(82.1239, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8341183755546808
distance x is tensor(96.9121, device='cuda:1')
benign distance is  tensor(96.9121, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.102230954915285
distance x is tensor(139.8315, device='cuda:1')
benign distance is  tensor(139.8315, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9244494121521711
distance x is tensor(83.4678, device='cuda:1')
benign distance is  tensor(83.4678, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6333255944773555
distance x is tensor(91.2631, device='cuda:1')
benign distance is  tensor(91.2631, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0566086005419493
distance x is tensor(77.1283, device='cuda:1')
benign distance is  tensor(77.1283, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8559713121503592
distance x is tensor(80.7634, device='cuda:1')
benign distance is  tensor(80.7634, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.0005559846758842
distance x is tensor(84.4201, device='cuda:1')
benign distance is  tensor(84.4201, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6976515441201627
distance x is tensor(114.5798, device='cuda:1')
benign distance is  tensor(114.5798, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.005526004359126
distance x is tensor(61.0079, device='cuda:1')
benign distance is  tensor(61.0079, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4922348223626614
distance x is tensor(93.9309, device='cuda:1')
benign distance is  tensor(93.9309, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.3446652814745903
distance x is tensor(153.3304, device='cuda:1')
benign distance is  tensor(153.3304, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8153029521927238
distance x is tensor(55.2028, device='cuda:1')
benign distance is  tensor(55.2028, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8231566129252315
distance x is tensor(132.3852, device='cuda:1')
benign distance is  tensor(132.3852, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.492136251181364
distance x is tensor(118.7044, device='cuda:1')
benign distance is  tensor(118.7044, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.2360008619725704
distance x is tensor(105.8186, device='cuda:1')
benign distance is  tensor(105.8186, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7849031928926706
distance x is tensor(68.0641, device='cuda:1')
benign distance is  tensor(68.0641, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.1833959929645061
distance x is tensor(114.9305, device='cuda:1')
benign distance is  tensor(114.9305, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.4880226105451584
distance x is tensor(90.0046, device='cuda:1')
benign distance is  tensor(90.0046, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7534522507339716
distance x is tensor(101.0279, device='cuda:1')
benign distance is  tensor(101.0279, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8778709564357996
distance x is tensor(96.8532, device='cuda:1')
benign distance is  tensor(96.8532, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5493621062487364
distance x is tensor(110.6300, device='cuda:1')
benign distance is  tensor(110.6300, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.8792515806853771
distance x is tensor(151.4071, device='cuda:1')
benign distance is  tensor(151.4071, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([19., 19., 19., 18., 19., 19., 19., 19., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([0.0516, 0.0516, 0.0516, 0.0190, 0.0516, 0.0516, 0.0516, 0.0516, 0.0516,
        0.0516, 0.0516, 0.0516, 0.0516, 0.0516, 0.0516, 0.0516, 0.0516, 0.0516,
        0.0516, 0.0516])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 0.62% 

Test Accuracy: 10.00% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.715089336037636
distance x is tensor(1005.3055, device='cuda:1')
benign distance is  tensor(1005.3055, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.4442117363214493
distance x is tensor(1612.6968, device='cuda:1')
benign distance is  tensor(1612.6968, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.970879167318344
distance x is tensor(1717.5706, device='cuda:1')
benign distance is  tensor(1717.5706, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.882901817560196
distance x is tensor(3271.1572, device='cuda:1')
benign distance is  tensor(3271.1572, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.6958726793527603
distance x is tensor(821.3859, device='cuda:1')
benign distance is  tensor(821.3859, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.593700870871544
distance x is tensor(1250.2393, device='cuda:1')
benign distance is  tensor(1250.2393, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.7973803728818893
distance x is tensor(1224.3989, device='cuda:1')
benign distance is  tensor(1224.3989, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.630843609571457
distance x is tensor(2167.6108, device='cuda:1')
benign distance is  tensor(2167.6108, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 52
counter_tensor is  tensor([45., 45., 45., 45., 46., 45., 45., 45., 13., 13., 13., 13., 13., 13.,
        13., 13., 13., 13., 13., 13.,  5., 44.,  2., 51., 51., 17., 34., 42.,
        31., 25., 51., 51., 26., 51., 42., 11.,  8., 36., 38., 14.,  2., 37.,
        51., 29., 20., 16., 29., 46.,  0., 49.,  0., 43.])
count_res tensor([4.0190e-04, 4.0190e-04, 4.0190e-04, 4.0190e-04, 1.0925e-03, 4.0190e-04,
        4.0190e-04, 4.0190e-04, 5.0897e-18, 5.0897e-18, 5.0897e-18, 5.0897e-18,
        5.0897e-18, 5.0897e-18, 5.0897e-18, 5.0897e-18, 5.0897e-18, 5.0897e-18,
        5.0897e-18, 5.0897e-18, 1.7074e-21, 1.4785e-04, 8.5006e-23, 1.6214e-01,
        1.6214e-01, 2.7789e-16, 6.7123e-09, 2.0009e-05, 3.3419e-10, 8.2837e-13,
        1.6214e-01, 1.6214e-01, 2.2517e-12, 1.6214e-01, 2.0009e-05, 6.8881e-19,
        3.4294e-20, 4.9598e-08, 3.6648e-07, 1.3835e-17, 8.5006e-23, 1.3482e-07,
        1.6214e-01, 4.5227e-11, 5.5815e-15, 1.0223e-16, 4.5227e-11, 1.0925e-03,
        1.1504e-23, 2.1943e-02, 1.1504e-23, 5.4391e-05])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 72.63% 

Test Accuracy: 82.90% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6012400146573782
distance x is tensor(112.2618, device='cuda:1')
benign distance is  tensor(112.2618, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.996569100767374
distance x is tensor(90.2537, device='cuda:1')
benign distance is  tensor(90.2537, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8956465572118759
distance x is tensor(94.8639, device='cuda:1')
benign distance is  tensor(94.8639, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0930858589708805
distance x is tensor(142.3775, device='cuda:1')
benign distance is  tensor(142.3775, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9996088780462742
distance x is tensor(74.3030, device='cuda:1')
benign distance is  tensor(74.3030, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8076100628823042
distance x is tensor(93.1007, device='cuda:1')
benign distance is  tensor(93.1007, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4349884018301964
distance x is tensor(78.9779, device='cuda:1')
benign distance is  tensor(78.9779, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8218925204128027
distance x is tensor(85.4901, device='cuda:1')
benign distance is  tensor(85.4901, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1559295058250427
distance x is tensor(85.0195, device='cuda:1')
benign distance is  tensor(85.0195, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9450125358998775
distance x is tensor(108.7699, device='cuda:1')
benign distance is  tensor(108.7699, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.241344552487135
distance x is tensor(68.2449, device='cuda:1')
benign distance is  tensor(68.2449, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.55004608258605
distance x is tensor(101.8028, device='cuda:1')
benign distance is  tensor(101.8028, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0610415898263454
distance x is tensor(134.8845, device='cuda:1')
benign distance is  tensor(134.8845, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7441731998696923
distance x is tensor(62.4247, device='cuda:1')
benign distance is  tensor(62.4247, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0629266873002052
distance x is tensor(122.1535, device='cuda:1')
benign distance is  tensor(122.1535, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.6516107805073261
distance x is tensor(115.9218, device='cuda:1')
benign distance is  tensor(115.9218, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.499093372374773
distance x is tensor(97.7050, device='cuda:1')
benign distance is  tensor(97.7050, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8209423683583736
distance x is tensor(96.7068, device='cuda:1')
benign distance is  tensor(96.7068, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.0485696252435446
distance x is tensor(112.2015, device='cuda:1')
benign distance is  tensor(112.2015, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.0469224117696285
distance x is tensor(105.5983, device='cuda:1')
benign distance is  tensor(105.5983, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.243417575955391
distance x is tensor(75.0748, device='cuda:1')
benign distance is  tensor(75.0748, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.905121436342597
distance x is tensor(186.7489, device='cuda:1')
benign distance is  tensor(186.7489, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0330959856510162
distance x is tensor(117.8430, device='cuda:1')
benign distance is  tensor(117.8430, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.0004526302218437
distance x is tensor(99.9821, device='cuda:1')
benign distance is  tensor(99.9821, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7405131012201309
distance x is tensor(111.8977, device='cuda:1')
benign distance is  tensor(111.8977, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.1262699253857136
distance x is tensor(94.7097, device='cuda:1')
benign distance is  tensor(94.7097, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.8706559184938669
distance x is tensor(119.1745, device='cuda:1')
benign distance is  tensor(119.1745, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.6432375609874725
distance x is tensor(113.0463, device='cuda:1')
benign distance is  tensor(113.0463, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6681274361908436
distance x is tensor(117.5926, device='cuda:1')
benign distance is  tensor(117.5926, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.0133239980787039
distance x is tensor(69.4930, device='cuda:1')
benign distance is  tensor(69.4930, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.070917658507824
distance x is tensor(83.2427, device='cuda:1')
benign distance is  tensor(83.2427, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8683310821652412
distance x is tensor(134.1611, device='cuda:1')
benign distance is  tensor(134.1611, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.7457365058362484
distance x is tensor(101.7297, device='cuda:1')
benign distance is  tensor(101.7297, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.5502483695745468
distance x is tensor(136.5468, device='cuda:1')
benign distance is  tensor(136.5468, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.1044089123606682
distance x is tensor(129.7495, device='cuda:1')
benign distance is  tensor(129.7495, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.210762932896614
distance x is tensor(63.2733, device='cuda:1')
benign distance is  tensor(63.2733, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6440325137227774
distance x is tensor(133.6295, device='cuda:1')
benign distance is  tensor(133.6295, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.0023486986756325
distance x is tensor(119.5000, device='cuda:1')
benign distance is  tensor(119.5000, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.2809339351952076
distance x is tensor(99.0564, device='cuda:1')
benign distance is  tensor(99.0564, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5826321803033352
distance x is tensor(131.1337, device='cuda:1')
benign distance is  tensor(131.1337, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([15., 14., 13., 19., 17., 15., 17., 19., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([0.0013, 0.0005, 0.0002, 0.0698, 0.0095, 0.0013, 0.0095, 0.0698, 0.0698,
        0.0698, 0.0698, 0.0698, 0.0698, 0.0698, 0.0698, 0.0698, 0.0698, 0.0698,
        0.0698, 0.0698])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 0.62% 

Test Accuracy: 10.00% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.6741509437561035
distance x is tensor(456280.7812, device='cuda:1')
benign distance is  tensor(456280.7812, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.0066289454698563
distance x is tensor(116600.3203, device='cuda:1')
benign distance is  tensor(116600.3203, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.901032194495201
distance x is tensor(165996.7656, device='cuda:1')
benign distance is  tensor(165996.7656, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.849357858300209
distance x is tensor(956642.8125, device='cuda:1')
benign distance is  tensor(956642.8125, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.981741890311241
distance x is tensor(196746.1094, device='cuda:1')
benign distance is  tensor(196746.1094, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.5859002768993378
distance x is tensor(259040.5156, device='cuda:1')
benign distance is  tensor(259040.5156, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.808417573571205
distance x is tensor(282759.6562, device='cuda:1')
benign distance is  tensor(282759.6562, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.6834977716207504
distance x is tensor(252260.7188, device='cuda:1')
benign distance is  tensor(252260.7188, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 36
counter_tensor is  tensor([28., 28., 28., 28., 28., 28., 28., 28.,  9.,  9.,  9.,  9.,  9.,  9.,
         9.,  9.,  9.,  9.,  9.,  9., 35., 10., 35., 14., 26., 27., 34.,  8.,
        35., 35., 14., 26., 35., 30., 35., 12.])
count_res tensor([1.4287e-04, 1.4287e-04, 1.4287e-04, 1.4287e-04, 1.4287e-04, 1.4287e-04,
        1.4287e-04, 1.4287e-04, 8.0048e-13, 8.0048e-13, 8.0048e-13, 8.0048e-13,
        8.0048e-13, 8.0048e-13, 8.0048e-13, 8.0048e-13, 8.0048e-13, 8.0048e-13,
        8.0048e-13, 8.0048e-13, 1.5668e-01, 2.1759e-12, 1.5668e-01, 1.1880e-10,
        1.9336e-05, 5.2560e-05, 5.7639e-02, 2.9448e-13, 1.5668e-01, 1.5668e-01,
        1.1880e-10, 1.9336e-05, 1.5668e-01, 1.0557e-03, 1.5668e-01, 1.6078e-11])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 28.43% 

Test Accuracy: 45.67% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8499447461217642
distance x is tensor(228.2023, device='cuda:1')
benign distance is  tensor(228.2023, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.8870707675814629
distance x is tensor(185.8619, device='cuda:1')
benign distance is  tensor(185.8619, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.5144795179367065
distance x is tensor(153.7649, device='cuda:1')
benign distance is  tensor(153.7649, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1699755638837814
distance x is tensor(259.7151, device='cuda:1')
benign distance is  tensor(259.7151, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6924342326819897
distance x is tensor(240.4034, device='cuda:1')
benign distance is  tensor(240.4034, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3592392355203629
distance x is tensor(195.9846, device='cuda:1')
benign distance is  tensor(195.9846, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.393695369362831
distance x is tensor(282.9427, device='cuda:1')
benign distance is  tensor(282.9427, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2385957390069962
distance x is tensor(178.3159, device='cuda:1')
benign distance is  tensor(178.3159, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.427123386412859
distance x is tensor(195.3366, device='cuda:1')
benign distance is  tensor(195.3366, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.4899856485426426
distance x is tensor(219.9229, device='cuda:1')
benign distance is  tensor(219.9229, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.5101338028907776
distance x is tensor(206.0871, device='cuda:1')
benign distance is  tensor(206.0871, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.662325367331505
distance x is tensor(227.2050, device='cuda:1')
benign distance is  tensor(227.2050, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.831002026796341
distance x is tensor(243.9899, device='cuda:1')
benign distance is  tensor(243.9899, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.495234027504921
distance x is tensor(141.6345, device='cuda:1')
benign distance is  tensor(141.6345, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.3417824283242226
distance x is tensor(237.5043, device='cuda:1')
benign distance is  tensor(237.5043, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.4092247262597084
distance x is tensor(227.5844, device='cuda:1')
benign distance is  tensor(227.5844, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.730535164475441
distance x is tensor(255.3347, device='cuda:1')
benign distance is  tensor(255.3347, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9664284437894821
distance x is tensor(203.0846, device='cuda:1')
benign distance is  tensor(203.0846, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.556074008345604
distance x is tensor(235.4153, device='cuda:1')
benign distance is  tensor(235.4153, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  3.76146636903286
distance x is tensor(247.5999, device='cuda:1')
benign distance is  tensor(247.5999, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.3665763102471828
distance x is tensor(244.6479, device='cuda:1')
benign distance is  tensor(244.6479, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.8911386877298355
distance x is tensor(232.3685, device='cuda:1')
benign distance is  tensor(232.3685, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6896835714578629
distance x is tensor(242.9743, device='cuda:1')
benign distance is  tensor(242.9743, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.5044847279787064
distance x is tensor(230.7621, device='cuda:1')
benign distance is  tensor(230.7621, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([27., 27., 27., 25., 25., 27., 23., 27.,  9.,  9.,  9.,  9.,  9.,  9.,
         9.,  9.,  9.,  9.,  9.,  9., 27., 27., 27., 23., 25., 23., 24., 13.])
count_res tensor([1.1750e-01, 1.1750e-01, 1.1750e-01, 1.5902e-02, 1.5902e-02, 1.1750e-01,
        2.1521e-03, 1.1750e-01, 1.7895e-09, 1.7895e-09, 1.7895e-09, 1.7895e-09,
        1.7895e-09, 1.7895e-09, 1.7895e-09, 1.7895e-09, 1.7895e-09, 1.7895e-09,
        1.7895e-09, 1.7895e-09, 1.1750e-01, 1.1750e-01, 1.1750e-01, 2.1521e-03,
        1.5902e-02, 2.1521e-03, 5.8499e-03, 9.7703e-08])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 68.76% 

Test Accuracy: 82.41% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7744315713644028
distance x is tensor(102.0346, device='cuda:1')
benign distance is  tensor(102.0346, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9264596551656723
distance x is tensor(95.6464, device='cuda:1')
benign distance is  tensor(95.6464, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.946461133658886
distance x is tensor(96.9977, device='cuda:1')
benign distance is  tensor(96.9977, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0898967012763023
distance x is tensor(143.8918, device='cuda:1')
benign distance is  tensor(143.8918, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3835864253342152
distance x is tensor(94.6967, device='cuda:1')
benign distance is  tensor(94.6967, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8088734354823828
distance x is tensor(93.1901, device='cuda:1')
benign distance is  tensor(93.1901, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6345927082002163
distance x is tensor(85.0693, device='cuda:1')
benign distance is  tensor(85.0693, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0414851978421211
distance x is tensor(84.9628, device='cuda:1')
benign distance is  tensor(84.9628, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.4004597663879395
distance x is tensor(75.2123, device='cuda:1')
benign distance is  tensor(75.2123, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.0843706540763378
distance x is tensor(93.5023, device='cuda:1')
benign distance is  tensor(93.5023, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.040977168828249
distance x is tensor(99.6014, device='cuda:1')
benign distance is  tensor(99.6014, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.2706023156642914
distance x is tensor(105.1047, device='cuda:1')
benign distance is  tensor(105.1047, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.3226222731173038
distance x is tensor(68.2189, device='cuda:1')
benign distance is  tensor(68.2189, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9744821116328239
distance x is tensor(198.3149, device='cuda:1')
benign distance is  tensor(198.3149, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.325213149189949
distance x is tensor(121.8910, device='cuda:1')
benign distance is  tensor(121.8910, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.0708027444779873
distance x is tensor(93.8956, device='cuda:1')
benign distance is  tensor(93.8956, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([ 4., 27., 23., 27., 26., 25., 27., 27., 12., 12., 12., 12., 12., 12.,
        12., 12., 12., 12., 12., 12., 27., 27., 27., 27., 27., 27., 26., 27.])
count_res tensor([8.6311e-12, 8.4108e-02, 1.5405e-03, 8.4108e-02, 3.0942e-02, 1.1383e-02,
        8.4108e-02, 8.4108e-02, 2.5729e-08, 2.5729e-08, 2.5729e-08, 2.5729e-08,
        2.5729e-08, 2.5729e-08, 2.5729e-08, 2.5729e-08, 2.5729e-08, 2.5729e-08,
        2.5729e-08, 2.5729e-08, 8.4108e-02, 8.4108e-02, 8.4108e-02, 8.4108e-02,
        8.4108e-02, 8.4108e-02, 3.0942e-02, 8.4108e-02])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 56.14% 

Test Accuracy: 79.81% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7461207173764706
distance x is tensor(114.3564, device='cuda:1')
benign distance is  tensor(114.3564, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2623861357569695
distance x is tensor(84.5517, device='cuda:1')
benign distance is  tensor(84.5517, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1257527004927397
distance x is tensor(99.8918, device='cuda:1')
benign distance is  tensor(99.8918, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3635135665535927
distance x is tensor(141.8604, device='cuda:1')
benign distance is  tensor(141.8604, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4595911465585232
distance x is tensor(86.1894, device='cuda:1')
benign distance is  tensor(86.1894, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.039920587092638
distance x is tensor(92.5915, device='cuda:1')
benign distance is  tensor(92.5915, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8086079135537148
distance x is tensor(73.2357, device='cuda:1')
benign distance is  tensor(73.2357, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9635335337370634
distance x is tensor(82.3805, device='cuda:1')
benign distance is  tensor(82.3805, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.4165575057268143
distance x is tensor(73.4845, device='cuda:1')
benign distance is  tensor(73.4845, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.1622595079243183
distance x is tensor(110.3504, device='cuda:1')
benign distance is  tensor(110.3504, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.6376227587461472
distance x is tensor(71.5409, device='cuda:1')
benign distance is  tensor(71.5409, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.5895786732435226
distance x is tensor(89.6753, device='cuda:1')
benign distance is  tensor(89.6753, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.5868842415511608
distance x is tensor(139.5777, device='cuda:1')
benign distance is  tensor(139.5777, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.1239333264529705
distance x is tensor(51.0807, device='cuda:1')
benign distance is  tensor(51.0807, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.4661782905459404
distance x is tensor(129.4722, device='cuda:1')
benign distance is  tensor(129.4722, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.172538921236992
distance x is tensor(105.5497, device='cuda:1')
benign distance is  tensor(105.5497, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([26., 21., 26., 20., 19., 26., 27., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27.,  2., 24., 15., 27., 14., 18., 27.])
count_res tensor([5.9745e-02, 4.0256e-04, 5.9745e-02, 1.4809e-04, 5.4480e-05, 5.9745e-02,
        1.6240e-01, 1.6240e-01, 2.7124e-06, 2.7124e-06, 2.7124e-06, 2.7124e-06,
        2.7124e-06, 2.7124e-06, 2.7124e-06, 2.7124e-06, 2.7124e-06, 2.7124e-06,
        2.7124e-06, 2.7124e-06, 1.6240e-01, 2.2555e-12, 8.0856e-03, 9.9784e-07,
        1.6240e-01, 3.6709e-07, 2.0042e-05, 1.6240e-01])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 91.99% 

Test Accuracy: 87.84% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6200072206556797
distance x is tensor(108.2924, device='cuda:1')
benign distance is  tensor(108.2924, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8672723602503538
distance x is tensor(94.6003, device='cuda:1')
benign distance is  tensor(94.6003, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6741306260228157
distance x is tensor(100.4973, device='cuda:1')
benign distance is  tensor(100.4973, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9210186637938023
distance x is tensor(144.9481, device='cuda:1')
benign distance is  tensor(144.9481, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2942789383232594
distance x is tensor(81.7050, device='cuda:1')
benign distance is  tensor(81.7050, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6896445797756314
distance x is tensor(94.6011, device='cuda:1')
benign distance is  tensor(94.6011, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4866912234574556
distance x is tensor(86.0146, device='cuda:1')
benign distance is  tensor(86.0146, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6147967036813498
distance x is tensor(73.7668, device='cuda:1')
benign distance is  tensor(73.7668, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7918634563684464
distance x is tensor(117.9550, device='cuda:1')
benign distance is  tensor(117.9550, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.9309999532997608
distance x is tensor(94.6863, device='cuda:1')
benign distance is  tensor(94.6863, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6918080504983664
distance x is tensor(122.1860, device='cuda:1')
benign distance is  tensor(122.1860, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.9658924266695976
distance x is tensor(114.0605, device='cuda:1')
benign distance is  tensor(114.0605, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7470552045851946
distance x is tensor(100.5471, device='cuda:1')
benign distance is  tensor(100.5471, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7768842987716198
distance x is tensor(72.1140, device='cuda:1')
benign distance is  tensor(72.1140, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7803714666515589
distance x is tensor(82.1370, device='cuda:1')
benign distance is  tensor(82.1370, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.6046031704172492
distance x is tensor(95.3049, device='cuda:1')
benign distance is  tensor(95.3049, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 52
counter_tensor is  tensor([ 6., 38., 49., 51., 49., 51., 51., 21.,  2.,  2.,  2.,  2.,  2.,  2.,
         2.,  2.,  2.,  2.,  2.,  2.,  3., 47., 36., 50., 45., 49., 50., 23.,
        51., 51., 51., 51., 40., 51., 50., 51.,  1.,  0.,  2., 49.,  7., 50.,
        50.,  0., 51., 21., 46.,  5.,  0., 51.,  1., 51.])
count_res tensor([1.9867e-21, 1.5688e-07, 9.3929e-03, 6.9404e-02, 9.3929e-03, 6.9404e-02,
        6.9404e-02, 6.4946e-15, 3.6388e-23, 3.6388e-23, 3.6388e-23, 3.6388e-23,
        3.6388e-23, 3.6388e-23, 3.6388e-23, 3.6388e-23, 3.6388e-23, 3.6388e-23,
        3.6388e-23, 3.6388e-23, 9.8913e-23, 1.2712e-03, 2.1231e-08, 2.5532e-02,
        1.7204e-04, 9.3929e-03, 2.5532e-02, 4.7989e-14, 6.9404e-02, 6.9404e-02,
        6.9404e-02, 6.9404e-02, 1.1592e-06, 6.9404e-02, 2.5532e-02, 6.9404e-02,
        1.3386e-23, 4.9246e-24, 3.6388e-23, 9.3929e-03, 5.4005e-21, 2.5532e-02,
        2.5532e-02, 4.9246e-24, 6.9404e-02, 6.4946e-15, 4.6764e-04, 7.3087e-22,
        4.9246e-24, 6.9404e-02, 1.3386e-23, 6.9404e-02])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 65.67% 

Test Accuracy: 81.86% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6927829347550869
distance x is tensor(120.3010, device='cuda:1')
benign distance is  tensor(120.3010, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9652337767183781
distance x is tensor(88.8832, device='cuda:1')
benign distance is  tensor(88.8832, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8481172062456608
distance x is tensor(95.7012, device='cuda:1')
benign distance is  tensor(95.7012, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3367741890251637
distance x is tensor(136.5379, device='cuda:1')
benign distance is  tensor(136.5379, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3919831924140453
distance x is tensor(80.8787, device='cuda:1')
benign distance is  tensor(80.8787, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9722537510097027
distance x is tensor(85.1461, device='cuda:1')
benign distance is  tensor(85.1461, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5695129185914993
distance x is tensor(73.5246, device='cuda:1')
benign distance is  tensor(73.5246, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1604318879544735
distance x is tensor(77.4416, device='cuda:1')
benign distance is  tensor(77.4416, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.5565720796585083
distance x is tensor(78.6638, device='cuda:1')
benign distance is  tensor(78.6638, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9433227218687534
distance x is tensor(109.4394, device='cuda:1')
benign distance is  tensor(109.4394, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.6349169090390205
distance x is tensor(65.7627, device='cuda:1')
benign distance is  tensor(65.7627, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.240145929157734
distance x is tensor(95.3430, device='cuda:1')
benign distance is  tensor(95.3430, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2137424536049366
distance x is tensor(138.7151, device='cuda:1')
benign distance is  tensor(138.7151, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9353434275835752
distance x is tensor(54.1542, device='cuda:1')
benign distance is  tensor(54.1542, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1782942675054073
distance x is tensor(131.2423, device='cuda:1')
benign distance is  tensor(131.2423, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.0772321969270706
distance x is tensor(103.9959, device='cuda:1')
benign distance is  tensor(103.9959, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.0882244445383549
distance x is tensor(72.8237, device='cuda:1')
benign distance is  tensor(72.8237, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.1315873973071575
distance x is tensor(97.7602, device='cuda:1')
benign distance is  tensor(97.7602, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.3974551297724247
distance x is tensor(111.6809, device='cuda:1')
benign distance is  tensor(111.6809, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.3695257008075714
distance x is tensor(100.2706, device='cuda:1')
benign distance is  tensor(100.2706, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.3467729985713959
distance x is tensor(66.5966, device='cuda:1')
benign distance is  tensor(66.5966, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8426866549998522
distance x is tensor(179.2217, device='cuda:1')
benign distance is  tensor(179.2217, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.9414091929793358
distance x is tensor(136.1873, device='cuda:1')
benign distance is  tensor(136.1873, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.1218844763934612
distance x is tensor(98.0244, device='cuda:1')
benign distance is  tensor(98.0244, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.4734120890498161
distance x is tensor(90.6467, device='cuda:1')
benign distance is  tensor(90.6467, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.1977342069149017
distance x is tensor(135.1290, device='cuda:1')
benign distance is  tensor(135.1290, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.4466376453638077
distance x is tensor(97.4067, device='cuda:1')
benign distance is  tensor(97.4067, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.5792909786105156
distance x is tensor(87.6093, device='cuda:1')
benign distance is  tensor(87.6093, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8236985336989164
distance x is tensor(97.9354, device='cuda:1')
benign distance is  tensor(97.9354, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.247036688029766
distance x is tensor(89.5310, device='cuda:1')
benign distance is  tensor(89.5310, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5807882435619831
distance x is tensor(104.2557, device='cuda:1')
benign distance is  tensor(104.2557, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.1394891254603863
distance x is tensor(149.0592, device='cuda:1')
benign distance is  tensor(149.0592, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.262296549975872
distance x is tensor(85.0138, device='cuda:1')
benign distance is  tensor(85.0138, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.692454755306244
distance x is tensor(124.6615, device='cuda:1')
benign distance is  tensor(124.6615, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.5124910101294518
distance x is tensor(123.7473, device='cuda:1')
benign distance is  tensor(123.7473, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.3830461390316486
distance x is tensor(78.7462, device='cuda:1')
benign distance is  tensor(78.7462, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.9880858659744263
distance x is tensor(130.9012, device='cuda:1')
benign distance is  tensor(130.9012, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.2892779856920242
distance x is tensor(122.0204, device='cuda:1')
benign distance is  tensor(122.0204, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9445673655718565
distance x is tensor(85.0384, device='cuda:1')
benign distance is  tensor(85.0384, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5955755682662129
distance x is tensor(117.6057, device='cuda:1')
benign distance is  tensor(117.6057, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([19., 18., 19., 16., 15., 19., 18., 16., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([0.0631, 0.0232, 0.0631, 0.0031, 0.0012, 0.0631, 0.0232, 0.0031, 0.0631,
        0.0631, 0.0631, 0.0631, 0.0631, 0.0631, 0.0631, 0.0631, 0.0631, 0.0631,
        0.0631, 0.0631])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.6920554488897324
distance x is tensor(701434.1250, device='cuda:1')
benign distance is  tensor(701434.1250, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.956935301423073
distance x is tensor(238647.3281, device='cuda:1')
benign distance is  tensor(238647.3281, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.0524360835552216
distance x is tensor(437401.9062, device='cuda:1')
benign distance is  tensor(437401.9062, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.8528644889593124
distance x is tensor(530055.6875, device='cuda:1')
benign distance is  tensor(530055.6875, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.0081313997507095
distance x is tensor(150760.0156, device='cuda:1')
benign distance is  tensor(150760.0156, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.580994039773941
distance x is tensor(400900.4688, device='cuda:1')
benign distance is  tensor(400900.4688, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.8056689351797104
distance x is tensor(633456.5625, device='cuda:1')
benign distance is  tensor(633456.5625, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.65649376809597
distance x is tensor(2104562., device='cuda:1')
benign distance is  tensor(2104562., device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([20., 20., 20., 20., 20., 20., 20., 20., 14., 14., 14., 14., 14., 14.,
        14., 14., 14., 14., 14., 14., 26., 16., 27., 25., 27., 26.,  3., 19.])
count_res tensor([3.1676e-04, 3.1676e-04, 3.1676e-04, 3.1676e-04, 3.1676e-04, 3.1676e-04,
        3.1676e-04, 3.1676e-04, 7.8517e-07, 7.8517e-07, 7.8517e-07, 7.8517e-07,
        7.8517e-07, 7.8517e-07, 7.8517e-07, 7.8517e-07, 7.8517e-07, 7.8517e-07,
        7.8517e-07, 7.8517e-07, 1.2779e-01, 5.8017e-06, 3.4737e-01, 4.7012e-02,
        3.4737e-01, 1.2779e-01, 1.3114e-11, 1.1653e-04])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 0.19% 

Test Accuracy: 10.21% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.6102819442749023
distance x is tensor(76.8144, device='cuda:1')
benign distance is  tensor(76.8144, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.6940433979034424
distance x is tensor(103.0703, device='cuda:1')
benign distance is  tensor(103.0703, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.1720061153173447
distance x is tensor(47.1296, device='cuda:1')
benign distance is  tensor(47.1296, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.396263599395752
distance x is tensor(99.6554, device='cuda:1')
benign distance is  tensor(99.6554, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.1861981749534607
distance x is tensor(111.0758, device='cuda:1')
benign distance is  tensor(111.0758, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.683163106441498
distance x is tensor(80.9268, device='cuda:1')
benign distance is  tensor(80.9268, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.9984068423509598
distance x is tensor(120.5720, device='cuda:1')
benign distance is  tensor(120.5720, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  3.1343407928943634
distance x is tensor(83.1601, device='cuda:1')
benign distance is  tensor(83.1601, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  3.482454866170883
distance x is tensor(131.1333, device='cuda:1')
benign distance is  tensor(131.1333, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.5464905500411987
distance x is tensor(95.9767, device='cuda:1')
benign distance is  tensor(95.9767, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  3.2307514399290085
distance x is tensor(72.6129, device='cuda:1')
benign distance is  tensor(72.6129, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.5512074679136276
distance x is tensor(75.6393, device='cuda:1')
benign distance is  tensor(75.6393, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  3.0473659187555313
distance x is tensor(145.0765, device='cuda:1')
benign distance is  tensor(145.0765, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.637631669640541
distance x is tensor(91.7369, device='cuda:1')
benign distance is  tensor(91.7369, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.74738809466362
distance x is tensor(117.7566, device='cuda:1')
benign distance is  tensor(117.7566, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.3670820146799088
distance x is tensor(62.5605, device='cuda:1')
benign distance is  tensor(62.5605, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([26., 20., 24., 23., 24., 24., 25., 21., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 26., 26., 20., 27., 12., 19.,  1., 26.])
count_res tensor([1.3236e-01, 3.2809e-04, 1.7913e-02, 6.5899e-03, 1.7913e-02, 1.7913e-02,
        4.8693e-02, 8.9184e-04, 6.0092e-06, 6.0092e-06, 6.0092e-06, 6.0092e-06,
        6.0092e-06, 6.0092e-06, 6.0092e-06, 6.0092e-06, 6.0092e-06, 6.0092e-06,
        6.0092e-06, 6.0092e-06, 1.3236e-01, 1.3236e-01, 3.2809e-04, 3.5979e-01,
        1.1006e-07, 1.2070e-04, 1.8382e-12, 1.3236e-01])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 17.94% 

Test Accuracy: 27.36% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9216246381402016
distance x is tensor(152.3064, device='cuda:1')
benign distance is  tensor(152.3064, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.134414728730917
distance x is tensor(127.5882, device='cuda:1')
benign distance is  tensor(127.5882, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.288527701050043
distance x is tensor(116.9934, device='cuda:1')
benign distance is  tensor(116.9934, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.5469358526170254
distance x is tensor(172.4996, device='cuda:1')
benign distance is  tensor(172.4996, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6623636856675148
distance x is tensor(145.7738, device='cuda:1')
benign distance is  tensor(145.7738, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0650490429252386
distance x is tensor(144.3334, device='cuda:1')
benign distance is  tensor(144.3334, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.7978240624070168
distance x is tensor(148.4537, device='cuda:1')
benign distance is  tensor(148.4537, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0814700946211815
distance x is tensor(126.9842, device='cuda:1')
benign distance is  tensor(126.9842, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.77263992279768
distance x is tensor(153.6462, device='cuda:1')
benign distance is  tensor(153.6462, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.2389675118029118
distance x is tensor(145.7707, device='cuda:1')
benign distance is  tensor(145.7707, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.1486745849251747
distance x is tensor(145.6806, device='cuda:1')
benign distance is  tensor(145.6806, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.5923294723033905
distance x is tensor(127.0663, device='cuda:1')
benign distance is  tensor(127.0663, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.9369391277432442
distance x is tensor(131.8110, device='cuda:1')
benign distance is  tensor(131.8110, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8894982561469078
distance x is tensor(216.8096, device='cuda:1')
benign distance is  tensor(216.8096, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.3297503516077995
distance x is tensor(168.0039, device='cuda:1')
benign distance is  tensor(168.0039, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.3605053164064884
distance x is tensor(155.4120, device='cuda:1')
benign distance is  tensor(155.4120, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 44
counter_tensor is  tensor([ 0., 35., 34., 33., 26., 37., 30., 43., 11., 11., 11., 11., 11., 11.,
        11., 11., 11., 11., 11., 11., 43.,  0.,  4.,  5.,  0., 41., 14., 31.,
        43., 43., 22., 23., 41., 43., 12., 25., 38., 42., 41., 42., 42., 43.,
        38., 40.])
count_res tensor([2.7919e-20, 4.4280e-05, 1.6290e-05, 5.9927e-06, 5.4646e-09, 3.2719e-04,
        2.9836e-07, 1.3200e-01, 1.6716e-15, 1.6716e-15, 1.6716e-15, 1.6716e-15,
        1.6716e-15, 1.6716e-15, 1.6716e-15, 1.6716e-15, 1.6716e-15, 1.6716e-15,
        1.6716e-15, 1.6716e-15, 1.3200e-01, 2.7919e-20, 1.5243e-18, 4.1436e-18,
        2.7919e-20, 1.7864e-02, 3.3576e-14, 8.1102e-07, 1.3200e-01, 1.3200e-01,
        1.0009e-10, 2.7207e-10, 1.7864e-02, 1.3200e-01, 4.5440e-15, 2.0103e-09,
        8.8939e-04, 4.8559e-02, 1.7864e-02, 4.8559e-02, 4.8559e-02, 1.3200e-01,
        8.8939e-04, 6.5718e-03])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 18.63% 

Test Accuracy: 25.88% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0867943726480007
distance x is tensor(165.7948, device='cuda:1')
benign distance is  tensor(165.7948, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1166439279913902
distance x is tensor(136.8481, device='cuda:1')
benign distance is  tensor(136.8481, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1632405780255795
distance x is tensor(127.3963, device='cuda:1')
benign distance is  tensor(127.3963, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4362213052809238
distance x is tensor(179.4328, device='cuda:1')
benign distance is  tensor(179.4328, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.51701982319355
distance x is tensor(155.6064, device='cuda:1')
benign distance is  tensor(155.6064, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.4360283054411411
distance x is tensor(155.5183, device='cuda:1')
benign distance is  tensor(155.5183, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.1106476187705994
distance x is tensor(150.2323, device='cuda:1')
benign distance is  tensor(150.2323, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3466362617909908
distance x is tensor(128.8560, device='cuda:1')
benign distance is  tensor(128.8560, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.4844734780490398
distance x is tensor(131.7172, device='cuda:1')
benign distance is  tensor(131.7172, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.0903849117457867
distance x is tensor(180.7945, device='cuda:1')
benign distance is  tensor(180.7945, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.8580953627824783
distance x is tensor(131.7700, device='cuda:1')
benign distance is  tensor(131.7700, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.4126985296607018
distance x is tensor(166.3663, device='cuda:1')
benign distance is  tensor(166.3663, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.4960088655352592
distance x is tensor(175.3597, device='cuda:1')
benign distance is  tensor(175.3597, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.0823752880096436
distance x is tensor(119.4076, device='cuda:1')
benign distance is  tensor(119.4076, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.4573760032653809
distance x is tensor(191.2642, device='cuda:1')
benign distance is  tensor(191.2642, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.348613426089287
distance x is tensor(171.1624, device='cuda:1')
benign distance is  tensor(171.1624, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.838752605021
distance x is tensor(161.9511, device='cuda:1')
benign distance is  tensor(161.9511, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.1546026356518269
distance x is tensor(122.3852, device='cuda:1')
benign distance is  tensor(122.3852, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.6004382893443108
distance x is tensor(171.8304, device='cuda:1')
benign distance is  tensor(171.8304, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.7207223288714886
distance x is tensor(151.3769, device='cuda:1')
benign distance is  tensor(151.3769, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.5274422727525234
distance x is tensor(154.7110, device='cuda:1')
benign distance is  tensor(154.7110, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.5651760250329971
distance x is tensor(133.9239, device='cuda:1')
benign distance is  tensor(133.9239, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6388478651642799
distance x is tensor(157.0931, device='cuda:1')
benign distance is  tensor(157.0931, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.9869195856153965
distance x is tensor(183.3046, device='cuda:1')
benign distance is  tensor(183.3046, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.9680753778666258
distance x is tensor(156.1547, device='cuda:1')
benign distance is  tensor(156.1547, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.4744995571672916
distance x is tensor(138.6465, device='cuda:1')
benign distance is  tensor(138.6465, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.1196516677737236
distance x is tensor(163.8177, device='cuda:1')
benign distance is  tensor(163.8177, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.2965918481349945
distance x is tensor(162.2672, device='cuda:1')
benign distance is  tensor(162.2672, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.0251196697354317
distance x is tensor(149.9191, device='cuda:1')
benign distance is  tensor(149.9191, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.4470489919185638
distance x is tensor(136.5286, device='cuda:1')
benign distance is  tensor(136.5286, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.2605000957846642
distance x is tensor(128.9970, device='cuda:1')
benign distance is  tensor(128.9970, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.083416122943163
distance x is tensor(150.1721, device='cuda:1')
benign distance is  tensor(150.1721, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([18., 18., 17., 16., 17., 19., 19., 19., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19.])
count_res tensor([0.0229, 0.0229, 0.0084, 0.0031, 0.0084, 0.0623, 0.0623, 0.0623, 0.0623,
        0.0623, 0.0623, 0.0623, 0.0623, 0.0623, 0.0623, 0.0623, 0.0623, 0.0623,
        0.0623, 0.0623])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 0.19% 

Test Accuracy: 10.00% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.6736354529857635
distance x is tensor(9689599., device='cuda:1')
benign distance is  tensor(9689599., device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.022540256381035
distance x is tensor(4260216.5000, device='cuda:1')
benign distance is  tensor(4260216.5000, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.9190368056297302
distance x is tensor(6280697., device='cuda:1')
benign distance is  tensor(6280697., device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.857502982020378
distance x is tensor(7774242., device='cuda:1')
benign distance is  tensor(7774242., device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.0037044286727905
distance x is tensor(1260527.8750, device='cuda:1')
benign distance is  tensor(1260527.8750, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.575310245156288
distance x is tensor(8.9174e+08, device='cuda:1')
benign distance is  tensor(8.9174e+08, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.7924169450998306
distance x is tensor(9.4354e+13, device='cuda:1')
benign distance is  tensor(9.4354e+13, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.6932350397109985
distance x is tensor(7786997., device='cuda:1')
benign distance is  tensor(7786997., device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 44
counter_tensor is  tensor([35., 35., 35., 35., 35., 35., 35., 35.,  8.,  8.,  8.,  8.,  8.,  0.,
         8.,  8.,  8.,  8.,  8.,  8.,  8., 27., 25., 42.,  8.,  8.,  8.,  5.,
        42., 30., 33., 29., 32., 24., 11., 29., 34., 33.,  8., 42., 32., 34.,
         0., 34.])
count_res tensor([3.0309e-04, 3.0309e-04, 3.0309e-04, 3.0309e-04, 3.0309e-04, 3.0309e-04,
        3.0309e-04, 3.0309e-04, 5.6966e-16, 5.6966e-16, 5.6966e-16, 5.6966e-16,
        5.6966e-16, 1.9110e-19, 5.6966e-16, 5.6966e-16, 5.6966e-16, 5.6966e-16,
        5.6966e-16, 5.6966e-16, 5.6966e-16, 1.0167e-07, 1.3760e-08, 3.3237e-01,
        5.6966e-16, 5.6966e-16, 5.6966e-16, 2.8362e-17, 3.3237e-01, 2.0422e-06,
        4.1018e-05, 7.5128e-07, 1.5090e-05, 5.0621e-09, 1.1442e-14, 7.5128e-07,
        1.1150e-04, 4.1018e-05, 5.6966e-16, 3.3237e-01, 1.5090e-05, 1.1150e-04,
        1.9110e-19, 1.1150e-04])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
count_res tensor([0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 36
counter_tensor is  tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
count_res tensor([0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278,
        0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278,
        0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278,
        0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 36
counter_tensor is  tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
count_res tensor([0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278,
        0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278,
        0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278,
        0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 28
counter_tensor is  tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0.])
count_res tensor([0.0357, 0.0357, 0.0357, 0.0357, 0.0357, 0.0357, 0.0357, 0.0357, 0.0357,
        0.0357, 0.0357, 0.0357, 0.0357, 0.0357, 0.0357, 0.0357, 0.0357, 0.0357,
        0.0357, 0.0357, 0.0357, 0.0357, 0.0357, 0.0357, 0.0357, 0.0357, 0.0357,
        0.0357])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
count_res tensor([0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 52
counter_tensor is  tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0.])
count_res tensor([0.0192, 0.0192, 0.0192, 0.0192, 0.0192, 0.0192, 0.0192, 0.0192, 0.0192,
        0.0192, 0.0192, 0.0192, 0.0192, 0.0192, 0.0192, 0.0192, 0.0192, 0.0192,
        0.0192, 0.0192, 0.0192, 0.0192, 0.0192, 0.0192, 0.0192, 0.0192, 0.0192,
        0.0192, 0.0192, 0.0192, 0.0192, 0.0192, 0.0192, 0.0192, 0.0192, 0.0192,
        0.0192, 0.0192, 0.0192, 0.0192, 0.0192, 0.0192, 0.0192, 0.0192, 0.0192,
        0.0192, 0.0192, 0.0192, 0.0192, 0.0192, 0.0192, 0.0192])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 20
counter_tensor is  tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
count_res tensor([0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
distance x is tensor(nan, device='cuda:1')
benign distance is  tensor(nan, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
sign attack scale is  1.0
grad,shape is torch.Size([215370])
user_PLR len size 36
counter_tensor is  tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
count_res tensor([0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278,
        0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278,
        0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278,
        0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278, 0.0278])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 0.00%
|----0th round Training Accuracy : 0.66%
|----1th round Training Accuracy : 88.82%
|----2th round Training Accuracy : 81.54%
|----3th round Training Accuracy : 91.53%
|----4th round Training Accuracy : 91.25%
|----5th round Training Accuracy : 88.91%
|----6th round Training Accuracy : 0.65%
|----7th round Training Accuracy : 91.03%
|----8th round Training Accuracy : 84.75%
|----9th round Training Accuracy : 87.24%
|----10th round Training Accuracy : 0.63%
|----11th round Training Accuracy : 71.63%
|----12th round Training Accuracy : 0.62%
|----13th round Training Accuracy : 74.01%
|----14th round Training Accuracy : 87.24%
|----15th round Training Accuracy : 75.37%
|----16th round Training Accuracy : 0.62%
|----17th round Training Accuracy : 78.05%
|----18th round Training Accuracy : 0.62%
|----19th round Training Accuracy : 63.54%
|----20th round Training Accuracy : 80.08%
|----21th round Training Accuracy : 76.54%
|----22th round Training Accuracy : 0.62%
|----23th round Training Accuracy : 62.92%
|----24th round Training Accuracy : 75.43%
|----25th round Training Accuracy : 77.36%
|----26th round Training Accuracy : 84.56%
|----27th round Training Accuracy : 86.05%
|----28th round Training Accuracy : 0.62%
|----29th round Training Accuracy : 72.63%
|----30th round Training Accuracy : 0.62%
|----31th round Training Accuracy : 28.43%
|----32th round Training Accuracy : 68.76%
|----33th round Training Accuracy : 56.14%
|----34th round Training Accuracy : 91.99%
|----35th round Training Accuracy : 65.67%
|----36th round Training Accuracy : 0.00%
|----37th round Training Accuracy : 0.19%
|----38th round Training Accuracy : 17.94%
|----39th round Training Accuracy : 18.63%
|----40th round Training Accuracy : 0.19%
|----41th round Training Accuracy : 0.00%
|----42th round Training Accuracy : 0.00%
|----43th round Training Accuracy : 0.00%
|----44th round Training Accuracy : 0.00%
|----45th round Training Accuracy : 0.00%
|----46th round Training Accuracy : 0.00%
|----47th round Training Accuracy : 0.00%
|----48th round Training Accuracy : 0.00%
|----49th round Training Accuracy : 0.00%
|----Final Test Accuracy: 10.00%
|----0th round Final Test Accuracy : 10.04%
|----1th round Final Test Accuracy : 86.47%
|----2th round Final Test Accuracy : 84.82%
|----3th round Final Test Accuracy : 87.26%
|----4th round Final Test Accuracy : 87.48%
|----5th round Final Test Accuracy : 87.49%
|----6th round Final Test Accuracy : 10.01%
|----7th round Final Test Accuracy : 87.45%
|----8th round Final Test Accuracy : 86.41%
|----9th round Final Test Accuracy : 87.40%
|----10th round Final Test Accuracy : 10.00%
|----11th round Final Test Accuracy : 79.76%
|----12th round Final Test Accuracy : 10.00%
|----13th round Final Test Accuracy : 82.99%
|----14th round Final Test Accuracy : 85.20%
|----15th round Final Test Accuracy : 83.93%
|----16th round Final Test Accuracy : 10.00%
|----17th round Final Test Accuracy : 84.69%
|----18th round Final Test Accuracy : 10.00%
|----19th round Final Test Accuracy : 76.85%
|----20th round Final Test Accuracy : 85.65%
|----21th round Final Test Accuracy : 85.11%
|----22th round Final Test Accuracy : 10.00%
|----23th round Final Test Accuracy : 80.81%
|----24th round Final Test Accuracy : 84.86%
|----25th round Final Test Accuracy : 84.51%
|----26th round Final Test Accuracy : 86.35%
|----27th round Final Test Accuracy : 86.60%
|----28th round Final Test Accuracy : 10.00%
|----29th round Final Test Accuracy : 82.90%
|----30th round Final Test Accuracy : 10.00%
|----31th round Final Test Accuracy : 45.67%
|----32th round Final Test Accuracy : 82.41%
|----33th round Final Test Accuracy : 79.81%
|----34th round Final Test Accuracy : 87.84%
|----35th round Final Test Accuracy : 81.86%
|----36th round Final Test Accuracy : 10.00%
|----37th round Final Test Accuracy : 10.21%
|----38th round Final Test Accuracy : 27.36%
|----39th round Final Test Accuracy : 25.88%
|----40th round Final Test Accuracy : 10.00%
|----41th round Final Test Accuracy : 10.00%
|----42th round Final Test Accuracy : 10.00%
|----43th round Final Test Accuracy : 10.00%
|----44th round Final Test Accuracy : 10.00%
|----45th round Final Test Accuracy : 10.00%
|----46th round Final Test Accuracy : 10.00%
|----47th round Final Test Accuracy : 10.00%
|----48th round Final Test Accuracy : 10.00%
|----49th round Final Test Accuracy : 10.00%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     None of attack is done!


 Total Run Time: 5623.2503
