
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5282012820243835
distance x is tensor(82.2579, device='cuda:3')
benign distance is  tensor(82.2579, device='cuda:3')
norm1 res is  tensor(359.8207, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.12459567934274673
distance x is tensor(91.5212, device='cuda:3')
benign distance is  tensor(91.5212, device='cuda:3')
norm1 res is  tensor(406.9092, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4404982626438141
distance x is tensor(97.1162, device='cuda:3')
benign distance is  tensor(97.1162, device='cuda:3')
norm1 res is  tensor(424.8423, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.16037917137146
distance x is tensor(86.2345, device='cuda:3')
benign distance is  tensor(86.2345, device='cuda:3')
norm1 res is  tensor(371.2583, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6816177368164062
distance x is tensor(82.7445, device='cuda:3')
benign distance is  tensor(82.7445, device='cuda:3')
norm1 res is  tensor(350.4271, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5619250535964966
distance x is tensor(94.2326, device='cuda:3')
benign distance is  tensor(94.2326, device='cuda:3')
norm1 res is  tensor(413.2556, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4513132572174072
distance x is tensor(87.2959, device='cuda:3')
benign distance is  tensor(87.2959, device='cuda:3')
norm1 res is  tensor(375.4931, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8742169141769409
distance x is tensor(105.0566, device='cuda:3')
benign distance is  tensor(105.0566, device='cuda:3')
norm1 res is  tensor(459.2993, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.21730303764343262
distance x is tensor(119.5003, device='cuda:3')
benign distance is  tensor(119.5003, device='cuda:3')
norm1 res is  tensor(529.1788, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.21255293488502502
distance x is tensor(112.1808, device='cuda:3')
benign distance is  tensor(112.1808, device='cuda:3')
norm1 res is  tensor(488.2246, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.23829326033592224
distance x is tensor(101.4874, device='cuda:3')
benign distance is  tensor(101.4874, device='cuda:3')
norm1 res is  tensor(448.1281, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8192596435546875
distance x is tensor(113.0683, device='cuda:3')
benign distance is  tensor(113.0683, device='cuda:3')
norm1 res is  tensor(490.8957, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4728342592716217
distance x is tensor(103.7194, device='cuda:3')
benign distance is  tensor(103.7194, device='cuda:3')
norm1 res is  tensor(462.9367, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.25452572107315063
distance x is tensor(122.0803, device='cuda:3')
benign distance is  tensor(122.0803, device='cuda:3')
norm1 res is  tensor(525.1479, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5058565139770508
distance x is tensor(103.4568, device='cuda:3')
benign distance is  tensor(103.4568, device='cuda:3')
norm1 res is  tensor(464.0871, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.24464526772499084
distance x is tensor(121.6373, device='cuda:3')
benign distance is  tensor(121.6373, device='cuda:3')
norm1 res is  tensor(524.5422, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.262870728969574
distance x is tensor(102.1946, device='cuda:3')
benign distance is  tensor(102.1946, device='cuda:3')
norm1 res is  tensor(444.2790, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4447849690914154
distance x is tensor(119.7600, device='cuda:3')
benign distance is  tensor(119.7600, device='cuda:3')
norm1 res is  tensor(535.5657, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4197172224521637
distance x is tensor(101.2720, device='cuda:3')
benign distance is  tensor(101.2720, device='cuda:3')
norm1 res is  tensor(452.7957, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.22951781749725342
distance x is tensor(102.4533, device='cuda:3')
benign distance is  tensor(102.4533, device='cuda:3')
norm1 res is  tensor(455.5061, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.029635434970259666
distance x is tensor(109.6465, device='cuda:3')
benign distance is  tensor(109.6465, device='cuda:3')
norm1 res is  tensor(485.7072, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.591468870639801
distance x is tensor(107.3406, device='cuda:3')
benign distance is  tensor(107.3406, device='cuda:3')
norm1 res is  tensor(471.9376, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.05368969589471817
distance x is tensor(112.6267, device='cuda:3')
benign distance is  tensor(112.6267, device='cuda:3')
norm1 res is  tensor(501.7714, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.537237286567688
distance x is tensor(107.2772, device='cuda:3')
benign distance is  tensor(107.2772, device='cuda:3')
norm1 res is  tensor(457.6835, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.24158775806427002
distance x is tensor(118.0133, device='cuda:3')
benign distance is  tensor(118.0133, device='cuda:3')
norm1 res is  tensor(521.3293, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5085455775260925
distance x is tensor(105.4594, device='cuda:3')
benign distance is  tensor(105.4594, device='cuda:3')
norm1 res is  tensor(446.4722, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.7229474782943726
distance x is tensor(113.4446, device='cuda:3')
benign distance is  tensor(113.4446, device='cuda:3')
norm1 res is  tensor(493.9721, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4219695031642914
distance x is tensor(112.5995, device='cuda:3')
benign distance is  tensor(112.5995, device='cuda:3')
norm1 res is  tensor(487.4101, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7133375406265259
distance x is tensor(106.7546, device='cuda:3')
benign distance is  tensor(106.7546, device='cuda:3')
norm1 res is  tensor(461.2287, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5099700689315796
distance x is tensor(114.5810, device='cuda:3')
benign distance is  tensor(114.5810, device='cuda:3')
norm1 res is  tensor(497.6472, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.346971333026886
distance x is tensor(105.6259, device='cuda:3')
benign distance is  tensor(105.6259, device='cuda:3')
norm1 res is  tensor(468.2458, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6122745871543884
distance x is tensor(102.3854, device='cuda:3')
benign distance is  tensor(102.3854, device='cuda:3')
norm1 res is  tensor(464.1942, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.5119765400886536
distance x is tensor(107.5901, device='cuda:3')
benign distance is  tensor(107.5901, device='cuda:3')
norm1 res is  tensor(476.9132, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.1292714774608612
distance x is tensor(104.5591, device='cuda:3')
benign distance is  tensor(104.5591, device='cuda:3')
norm1 res is  tensor(465.9853, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.545384407043457
distance x is tensor(115.7013, device='cuda:3')
benign distance is  tensor(115.7013, device='cuda:3')
norm1 res is  tensor(513.7522, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.44951528310775757
distance x is tensor(105.0977, device='cuda:3')
benign distance is  tensor(105.0977, device='cuda:3')
norm1 res is  tensor(456.0471, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.23178520798683167
distance x is tensor(107.2348, device='cuda:3')
benign distance is  tensor(107.2348, device='cuda:3')
norm1 res is  tensor(483.4139, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.3477766513824463
distance x is tensor(102.3507, device='cuda:3')
benign distance is  tensor(102.3507, device='cuda:3')
norm1 res is  tensor(443.7642, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.6106417775154114
distance x is tensor(104.5861, device='cuda:3')
benign distance is  tensor(104.5861, device='cuda:3')
norm1 res is  tensor(465.5707, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.1402045339345932
distance x is tensor(102.0275, device='cuda:3')
benign distance is  tensor(102.0275, device='cuda:3')
norm1 res is  tensor(445.4859, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.16113634407520294
distance x is tensor(104.8899, device='cuda:3')
benign distance is  tensor(104.8899, device='cuda:3')
norm1 res is  tensor(470.1040, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.17267516255378723
distance x is tensor(101.7717, device='cuda:3')
benign distance is  tensor(101.7717, device='cuda:3')
norm1 res is  tensor(436.7744, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.02269146963953972
distance x is tensor(108.7547, device='cuda:3')
benign distance is  tensor(108.7547, device='cuda:3')
norm1 res is  tensor(477.1950, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.13482815027236938
distance x is tensor(106.6739, device='cuda:3')
benign distance is  tensor(106.6739, device='cuda:3')
norm1 res is  tensor(460.3483, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.4531315863132477
distance x is tensor(109.3495, device='cuda:3')
benign distance is  tensor(109.3495, device='cuda:3')
norm1 res is  tensor(479.3727, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.3296131491661072
distance x is tensor(109.8962, device='cuda:3')
benign distance is  tensor(109.8962, device='cuda:3')
norm1 res is  tensor(479.7307, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.45089593529701233
distance x is tensor(107.5407, device='cuda:3')
benign distance is  tensor(107.5407, device='cuda:3')
norm1 res is  tensor(473.3788, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.21691632270812988
distance x is tensor(110.3310, device='cuda:3')
benign distance is  tensor(110.3310, device='cuda:3')
norm1 res is  tensor(486.0136, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(86.9633, device='cuda:3')
compute distance is  tensor(86.9633, device='cuda:3')
compute norm is  tensor(44.9212, device='cuda:3', dtype=torch.float64)
distance x is tensor(81.8779, device='cuda:3')
compute distance is  tensor(81.8779, device='cuda:3')
compute norm is  tensor(44.9230, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.3622, device='cuda:3')
compute distance is  tensor(95.3622, device='cuda:3')
compute norm is  tensor(45.3023, device='cuda:3', dtype=torch.float64)
distance x is tensor(82.6787, device='cuda:3')
compute distance is  tensor(82.6787, device='cuda:3')
compute norm is  tensor(44.9234, device='cuda:3', dtype=torch.float64)
distance x is tensor(92.4986, device='cuda:3')
compute distance is  tensor(92.4986, device='cuda:3')
compute norm is  tensor(45.0612, device='cuda:3', dtype=torch.float64)
distance x is tensor(94.8911, device='cuda:3')
compute distance is  tensor(94.8911, device='cuda:3')
compute norm is  tensor(45.2273, device='cuda:3', dtype=torch.float64)
distance x is tensor(90.1825, device='cuda:3')
compute distance is  tensor(90.1825, device='cuda:3')
compute norm is  tensor(45.1013, device='cuda:3', dtype=torch.float64)
distance x is tensor(94.5011, device='cuda:3')
compute distance is  tensor(94.5011, device='cuda:3')
compute norm is  tensor(45.0707, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.8369, device='cuda:3')
compute distance is  tensor(103.8369, device='cuda:3')
compute norm is  tensor(45.3198, device='cuda:3', dtype=torch.float64)
distance x is tensor(86.5146, device='cuda:3')
compute distance is  tensor(86.5146, device='cuda:3')
compute norm is  tensor(45.0842, device='cuda:3', dtype=torch.float64)
distance x is tensor(92.5160, device='cuda:3')
compute distance is  tensor(92.5160, device='cuda:3')
compute norm is  tensor(45.1762, device='cuda:3', dtype=torch.float64)
distance x is tensor(87.5209, device='cuda:3')
compute distance is  tensor(87.5209, device='cuda:3')
compute norm is  tensor(45.0362, device='cuda:3', dtype=torch.float64)
batch acc is 0.10215000015633194
mal_rand_acc is 0.10000000049999999
mal_rand loss is 125589944008704.0
len of model dicts is  12
distance x is tensor(86.9633, device='cuda:3')
compute distance is  tensor(86.9633, device='cuda:3')
compute norm is  tensor(44.9212, device='cuda:3', dtype=torch.float64)
distance x is tensor(81.8779, device='cuda:3')
compute distance is  tensor(81.8779, device='cuda:3')
compute norm is  tensor(44.9230, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.3622, device='cuda:3')
compute distance is  tensor(95.3622, device='cuda:3')
compute norm is  tensor(45.3023, device='cuda:3', dtype=torch.float64)
distance x is tensor(82.6787, device='cuda:3')
compute distance is  tensor(82.6787, device='cuda:3')
compute norm is  tensor(44.9234, device='cuda:3', dtype=torch.float64)
distance x is tensor(92.4986, device='cuda:3')
compute distance is  tensor(92.4986, device='cuda:3')
compute norm is  tensor(45.0612, device='cuda:3', dtype=torch.float64)
distance x is tensor(94.8911, device='cuda:3')
compute distance is  tensor(94.8911, device='cuda:3')
compute norm is  tensor(45.2273, device='cuda:3', dtype=torch.float64)
distance x is tensor(90.1825, device='cuda:3')
compute distance is  tensor(90.1825, device='cuda:3')
compute norm is  tensor(45.1013, device='cuda:3', dtype=torch.float64)
distance x is tensor(94.5011, device='cuda:3')
compute distance is  tensor(94.5011, device='cuda:3')
compute norm is  tensor(45.0707, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.8369, device='cuda:3')
compute distance is  tensor(103.8369, device='cuda:3')
compute norm is  tensor(45.3198, device='cuda:3', dtype=torch.float64)
distance x is tensor(86.5146, device='cuda:3')
compute distance is  tensor(86.5146, device='cuda:3')
compute norm is  tensor(45.0842, device='cuda:3', dtype=torch.float64)
distance x is tensor(92.5160, device='cuda:3')
compute distance is  tensor(92.5160, device='cuda:3')
compute norm is  tensor(45.1762, device='cuda:3', dtype=torch.float64)
distance x is tensor(87.5209, device='cuda:3')
compute distance is  tensor(87.5209, device='cuda:3')
compute norm is  tensor(45.0362, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(103.8369, device='cuda:3')
distance x is tensor(106202.3281, device='cuda:3')
distance x is tensor(106202.3281, device='cuda:3')
________________________________
test distance is  tensor(106202.3281, device='cuda:3')
test distance1 is  tensor(106202.3281, device='cuda:3')
test similarity is  tensor(-0.1071, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139294971116345.31
test entropy is  0.0
________________________________
cal ratio is  0.030643263080047896
distance x is tensor(3254.3918, device='cuda:3')
cal_distance is  tensor(3254.3918, device='cuda:3')
cal ratio is  0.17505201219458716
distance x is tensor(569.6920, device='cuda:3')
cal_distance is  tensor(569.6920, device='cuda:3')
cal ratio is  0.418390653899497
distance x is tensor(238.3567, device='cuda:3')
cal_distance is  tensor(238.3567, device='cuda:3')
cal ratio is  0.6468272458016664
distance x is tensor(154.1774, device='cuda:3')
cal_distance is  tensor(154.1774, device='cuda:3')
cal ratio is  0.8042511416342057
distance x is tensor(123.9984, device='cuda:3')
cal_distance is  tensor(123.9984, device='cuda:3')
cal ratio is  0.8967968489860174
distance x is tensor(111.2019, device='cuda:3')
cal_distance is  tensor(111.2019, device='cuda:3')
cal ratio is  0.9469913078612116
distance x is tensor(105.3075, device='cuda:3')
cal_distance is  tensor(105.3075, device='cuda:3')
cal ratio is  0.9731335569629028
distance x is tensor(102.4784, device='cuda:3')
cal_distance is  tensor(102.4784, device='cuda:3')
distance x is tensor(102.4784, device='cuda:3')
return_distance is  tensor(102.4784, device='cuda:3')
distance x is tensor(102.4684, device='cuda:3')
distance x is tensor(102.4684, device='cuda:3')
________________________________
test distance is  tensor(102.4684, device='cuda:3')
test distance1 is  tensor(102.4684, device='cuda:3')
test similarity is  tensor(0.9645, device='cuda:3')
test acc is  0.10000000015633198
test loss is 147.29370261967054
test entropy is  3.0118797534820975e-21
________________________________
0
distance x is tensor(102.4684, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  6.618602570710039e-21
avg test loss is  147.29757519622348
avg accuracy is  0.6783333334896654
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9645, device='cuda:3')
compute_distance is  tensor(102.4684, device='cuda:3')
compute_norm is  tensor(43.8894, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(93.2204, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8516144220635835
avg test loss is  1.2446570466322178
avg accuracy is  0.8730833334896558
solo acc is  0.36740000015634067
compute similarity  is  tensor(0.9672, device='cuda:3')
compute_distance is  tensor(93.2204, device='cuda:3')
compute_norm is  tensor(42.8197, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(96.0575, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7926404278542696
avg test loss is  1.3715185577681324
avg accuracy is  0.8726333334896559
solo acc is  0.25785000015633847
compute similarity  is  tensor(0.9665, device='cuda:3')
compute_distance is  tensor(96.0575, device='cuda:3')
compute_norm is  tensor(42.5399, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(98.4519, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7887579355158532
avg test loss is  1.3395468342278811
avg accuracy is  0.8756000001563224
solo acc is  0.2505500001563382
compute similarity  is  tensor(0.9660, device='cuda:3')
compute_distance is  tensor(98.4519, device='cuda:3')
compute_norm is  tensor(42.2869, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(100.5789, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7925879902549898
avg test loss is  1.297990873741951
avg accuracy is  0.874716666822989
solo acc is  0.253116666823005
compute similarity  is  tensor(0.9655, device='cuda:3')
compute_distance is  tensor(100.5789, device='cuda:3')
compute_norm is  tensor(42.0481, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(102.6691, device='cuda:3')
distance x is tensor(102.6691, device='cuda:3')
________________________________
test distance is  tensor(102.6691, device='cuda:3')
test distance1 is  tensor(102.6691, device='cuda:3')
test similarity is  tensor(0.9651, device='cuda:3')
test acc is  0.23745000015633774
test loss is 1.303598931730429
test entropy is  0.7792370604045356
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.2517668008804321
mal norm is  tensor(513.0864, device='cuda:3')
distance x is tensor(102.6760, device='cuda:3')
mal distance is  tensor(102.6760, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 21.07% 

Test Accuracy: 20.09% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4644409716129303
distance x is tensor(150.3011, device='cuda:3')
benign distance is  tensor(150.3011, device='cuda:3')
norm1 res is  tensor(595.1324, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6020310521125793
distance x is tensor(145.4847, device='cuda:3')
benign distance is  tensor(145.4847, device='cuda:3')
norm1 res is  tensor(570.8964, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.17543122172355652
distance x is tensor(147.5709, device='cuda:3')
benign distance is  tensor(147.5709, device='cuda:3')
norm1 res is  tensor(570.4722, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7621482610702515
distance x is tensor(139.5026, device='cuda:3')
benign distance is  tensor(139.5026, device='cuda:3')
norm1 res is  tensor(541.3881, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0753750801086426
distance x is tensor(138.4574, device='cuda:3')
benign distance is  tensor(138.4574, device='cuda:3')
norm1 res is  tensor(531.9258, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.409682273864746
distance x is tensor(146.9322, device='cuda:3')
benign distance is  tensor(146.9322, device='cuda:3')
norm1 res is  tensor(580.8694, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7457462549209595
distance x is tensor(154.3483, device='cuda:3')
benign distance is  tensor(154.3483, device='cuda:3')
norm1 res is  tensor(595.2995, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4990909993648529
distance x is tensor(145.6874, device='cuda:3')
benign distance is  tensor(145.6874, device='cuda:3')
norm1 res is  tensor(576.4009, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(138.9763, device='cuda:3')
compute distance is  tensor(138.9763, device='cuda:3')
compute norm is  tensor(43.9262, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.2384, device='cuda:3')
compute distance is  tensor(133.2384, device='cuda:3')
compute norm is  tensor(43.8107, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.3673, device='cuda:3')
compute distance is  tensor(146.3673, device='cuda:3')
compute norm is  tensor(44.2421, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.1969, device='cuda:3')
compute distance is  tensor(153.1969, device='cuda:3')
compute norm is  tensor(44.1916, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.0018, device='cuda:3')
compute distance is  tensor(128.0018, device='cuda:3')
compute norm is  tensor(43.7361, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.8938, device='cuda:3')
compute distance is  tensor(153.8938, device='cuda:3')
compute norm is  tensor(44.3600, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.2924, device='cuda:3')
compute distance is  tensor(133.2924, device='cuda:3')
compute norm is  tensor(43.9177, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.3429, device='cuda:3')
compute distance is  tensor(147.3429, device='cuda:3')
compute norm is  tensor(44.1191, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.0904, device='cuda:3')
compute distance is  tensor(143.0904, device='cuda:3')
compute norm is  tensor(44.0164, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.5209, device='cuda:3')
compute distance is  tensor(149.5209, device='cuda:3')
compute norm is  tensor(44.1268, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.3632, device='cuda:3')
compute distance is  tensor(147.3632, device='cuda:3')
compute norm is  tensor(44.1091, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.1131, device='cuda:3')
compute distance is  tensor(132.1131, device='cuda:3')
compute norm is  tensor(43.8081, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(153.8938, device='cuda:3')
distance x is tensor(106139.8594, device='cuda:3')
distance x is tensor(106139.8594, device='cuda:3')
________________________________
test distance is  tensor(106139.8594, device='cuda:3')
test distance1 is  tensor(106139.8594, device='cuda:3')
test similarity is  tensor(0.1186, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139282785849405.14
test entropy is  0.0
________________________________
cal ratio is  0.03731619140304493
distance x is tensor(3960.7407, device='cuda:3')
cal_distance is  tensor(3960.7407, device='cuda:3')
cal ratio is  0.1931738670799957
distance x is tensor(765.1156, device='cuda:3')
cal_distance is  tensor(765.1156, device='cuda:3')
cal ratio is  0.43951433857110406
distance x is tensor(336.2821, device='cuda:3')
cal_distance is  tensor(336.2821, device='cuda:3')
cal ratio is  0.6629559838124263
distance x is tensor(222.9419, device='cuda:3')
cal_distance is  tensor(222.9419, device='cuda:3')
cal ratio is  0.814217959052042
distance x is tensor(181.5243, device='cuda:3')
cal_distance is  tensor(181.5243, device='cuda:3')
cal ratio is  0.9023379303715623
distance x is tensor(163.7967, device='cuda:3')
cal_distance is  tensor(163.7967, device='cuda:3')
cal ratio is  0.9499132980635882
distance x is tensor(155.5930, device='cuda:3')
cal_distance is  tensor(155.5930, device='cuda:3')
cal ratio is  0.97463404797225
distance x is tensor(151.6463, device='cuda:3')
cal_distance is  tensor(151.6463, device='cuda:3')
distance x is tensor(151.6463, device='cuda:3')
return_distance is  tensor(151.6463, device='cuda:3')
distance x is tensor(151.6363, device='cuda:3')
distance x is tensor(151.6363, device='cuda:3')
________________________________
test distance is  tensor(151.6363, device='cuda:3')
test distance1 is  tensor(151.6363, device='cuda:3')
test similarity is  tensor(0.9311, device='cuda:3')
test acc is  0.10000000015633198
test loss is 926.9478496884994
test entropy is  0.0
________________________________
0
distance x is tensor(151.6363, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  926.7606864880397
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9311, device='cuda:3')
compute_distance is  tensor(151.6363, device='cuda:3')
compute_norm is  tensor(45.0452, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(258.8900, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5627001335880142
avg test loss is  2.8481319484426013
avg accuracy is  0.12833333348966525
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8069, device='cuda:3')
compute_distance is  tensor(258.8900, device='cuda:3')
compute_norm is  tensor(54.0427, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(258.7404, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8415965059164491
avg test loss is  3.5771260581799407
avg accuracy is  0.11895000015633192
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8063, device='cuda:3')
compute_distance is  tensor(258.7404, device='cuda:3')
compute_norm is  tensor(54.1886, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(258.5751, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.4760393166084533
avg test loss is  2.598543078914634
avg accuracy is  0.16816666682300127
solo acc is  0.1008833334896653
compute similarity  is  tensor(0.8071, device='cuda:3')
compute_distance is  tensor(258.5751, device='cuda:3')
compute_norm is  tensor(53.6311, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(258.8707, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8147745499097462
avg test loss is  3.258257391102024
avg accuracy is  0.11848333348966525
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.8066, device='cuda:3')
compute_distance is  tensor(258.8707, device='cuda:3')
compute_norm is  tensor(53.7122, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(258.8759, device='cuda:3')
distance x is tensor(258.8759, device='cuda:3')
________________________________
test distance is  tensor(258.8759, device='cuda:3')
test distance1 is  tensor(258.8759, device='cuda:3')
test similarity is  tensor(0.8075, device='cuda:3')
test acc is  0.11315000015633193
test loss is 2.2962181523664675
test entropy is  1.3627573022964412
________________________________
cal ratio is  0.7555979911451357
distance x is tensor(195.6093, device='cuda:3')
cal_distance is  tensor(195.6093, device='cuda:3')
cal ratio is  0.869244245751496
distance x is tensor(170.0325, device='cuda:3')
cal_distance is  tensor(170.0325, device='cuda:3')
cal ratio is  0.9323320694350427
distance x is tensor(158.5269, device='cuda:3')
cal_distance is  tensor(158.5269, device='cuda:3')
cal ratio is  0.9655729765226443
distance x is tensor(153.0693, device='cuda:3')
cal_distance is  tensor(153.0693, device='cuda:3')
distance x is tensor(153.0693, device='cuda:3')
return_distance is  tensor(153.0693, device='cuda:3')
distance x is tensor(153.0657, device='cuda:3')
distance x is tensor(153.0657, device='cuda:3')
________________________________
test distance is  tensor(153.0657, device='cuda:3')
test distance1 is  tensor(153.0657, device='cuda:3')
test similarity is  tensor(0.9164, device='cuda:3')
test acc is  0.11170000015633194
test loss is 2.190166694396086
test entropy is  1.8218415891692075
________________________________
0
distance x is tensor(153.0657, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.8218397029173146
avg test loss is  2.191472187860688
avg accuracy is  0.20970000015633683
solo acc is  0.11238333348966527
compute similarity  is  tensor(0.9164, device='cuda:3')
compute_distance is  tensor(153.0657, device='cuda:3')
compute_norm is  tensor(46.6372, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(154.4522, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6922549146579019
avg test loss is  2.7679762791977254
avg accuracy is  0.14635000015633287
solo acc is  0.1011833334896653
compute similarity  is  tensor(0.9157, device='cuda:3')
compute_distance is  tensor(154.4522, device='cuda:3')
compute_norm is  tensor(46.6526, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(155.6221, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9424538718484866
avg test loss is  1.5677248994424653
avg accuracy is  0.18330000015633546
solo acc is  0.21061666682300348
compute similarity  is  tensor(0.9156, device='cuda:3')
compute_distance is  tensor(155.6221, device='cuda:3')
compute_norm is  tensor(46.4323, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(155.6221, device='cuda:3')
distance x is tensor(155.6221, device='cuda:3')
________________________________
test distance is  tensor(155.6221, device='cuda:3')
test distance1 is  tensor(155.6221, device='cuda:3')
test similarity is  tensor(0.9156, device='cuda:3')
test acc is  0.20808333348967
test loss is 1.5709940380633258
test entropy is  0.942424580550143
________________________________
cal ratio is  0.9745428002012313
distance x is tensor(151.6636, device='cuda:3')
cal_distance is  tensor(151.6636, device='cuda:3')
distance x is tensor(151.6636, device='cuda:3')
return_distance is  tensor(151.6636, device='cuda:3')
distance x is tensor(151.6604, device='cuda:3')
distance x is tensor(151.6604, device='cuda:3')
________________________________
test distance is  tensor(151.6604, device='cuda:3')
test distance1 is  tensor(151.6604, device='cuda:3')
test similarity is  tensor(0.9193, device='cuda:3')
test acc is  0.18908333348966908
test loss is 1.5985588644867512
test entropy is  0.9393416584681854
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.4518396854400635
mal norm is  tensor(808.5258, device='cuda:3')
distance x is tensor(151.6636, device='cuda:3')
mal distance is  tensor(151.6636, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([14., 13., 23., 14., 14., 14., 14., 23., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 14., 12., 22., 12., 20., 13., 17.])
count_res tensor([5.0745e-05, 1.8668e-05, 4.1119e-01, 5.0745e-05, 5.0745e-05, 5.0745e-05,
        5.0745e-05, 4.1119e-01, 3.7496e-04, 3.7496e-04, 3.7496e-04, 3.7496e-04,
        3.7496e-04, 3.7496e-04, 3.7496e-04, 3.7496e-04, 3.7496e-04, 3.7496e-04,
        3.7496e-04, 3.7496e-04, 6.8676e-06, 5.0745e-05, 6.8676e-06, 1.5127e-01,
        6.8676e-06, 2.0472e-02, 1.8668e-05, 1.0192e-03])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 88.94% 

Test Accuracy: 87.89% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8013148307800293
distance x is tensor(105.9713, device='cuda:3')
benign distance is  tensor(105.9713, device='cuda:3')
norm1 res is  tensor(448.5699, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8460448980331421
distance x is tensor(110.3424, device='cuda:3')
benign distance is  tensor(110.3424, device='cuda:3')
norm1 res is  tensor(466.6177, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.01395262498408556
distance x is tensor(97.9766, device='cuda:3')
benign distance is  tensor(97.9766, device='cuda:3')
norm1 res is  tensor(400.1983, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.45081502199172974
distance x is tensor(108.2025, device='cuda:3')
benign distance is  tensor(108.2025, device='cuda:3')
norm1 res is  tensor(443.9632, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.39237740635871887
distance x is tensor(96.0946, device='cuda:3')
benign distance is  tensor(96.0946, device='cuda:3')
norm1 res is  tensor(390.5792, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5408493280410767
distance x is tensor(111.3893, device='cuda:3')
benign distance is  tensor(111.3893, device='cuda:3')
norm1 res is  tensor(467.1449, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3822926878929138
distance x is tensor(109.5306, device='cuda:3')
benign distance is  tensor(109.5306, device='cuda:3')
norm1 res is  tensor(460.0934, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.31511783599853516
distance x is tensor(82.2812, device='cuda:3')
benign distance is  tensor(82.2812, device='cuda:3')
norm1 res is  tensor(343.2905, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.23869231343269348
distance x is tensor(125.5231, device='cuda:3')
benign distance is  tensor(125.5231, device='cuda:3')
norm1 res is  tensor(523.1116, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.34469836950302124
distance x is tensor(133.3240, device='cuda:3')
benign distance is  tensor(133.3240, device='cuda:3')
norm1 res is  tensor(548.2102, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4241296350955963
distance x is tensor(111.0594, device='cuda:3')
benign distance is  tensor(111.0594, device='cuda:3')
norm1 res is  tensor(462.1145, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.570716142654419
distance x is tensor(115.3094, device='cuda:3')
benign distance is  tensor(115.3094, device='cuda:3')
norm1 res is  tensor(483.6981, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6226910352706909
distance x is tensor(118.9921, device='cuda:3')
benign distance is  tensor(118.9921, device='cuda:3')
norm1 res is  tensor(504.0850, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.13227064907550812
distance x is tensor(126.1223, device='cuda:3')
benign distance is  tensor(126.1223, device='cuda:3')
norm1 res is  tensor(527.6002, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5305718183517456
distance x is tensor(122.2649, device='cuda:3')
benign distance is  tensor(122.2649, device='cuda:3')
norm1 res is  tensor(520.4695, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6680102944374084
distance x is tensor(132.2172, device='cuda:3')
benign distance is  tensor(132.2172, device='cuda:3')
norm1 res is  tensor(548.9713, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(110.1436, device='cuda:3')
compute distance is  tensor(110.1436, device='cuda:3')
compute norm is  tensor(44.8147, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.9671, device='cuda:3')
compute distance is  tensor(112.9671, device='cuda:3')
compute norm is  tensor(44.8005, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.3726, device='cuda:3')
compute distance is  tensor(122.3726, device='cuda:3')
compute norm is  tensor(44.9787, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.0304, device='cuda:3')
compute distance is  tensor(112.0304, device='cuda:3')
compute norm is  tensor(44.7973, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.9430, device='cuda:3')
compute distance is  tensor(116.9430, device='cuda:3')
compute norm is  tensor(44.8825, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.1879, device='cuda:3')
compute distance is  tensor(109.1879, device='cuda:3')
compute norm is  tensor(44.7709, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.9549, device='cuda:3')
compute distance is  tensor(120.9549, device='cuda:3')
compute norm is  tensor(45.0146, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.3926, device='cuda:3')
compute distance is  tensor(117.3926, device='cuda:3')
compute norm is  tensor(44.9158, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.9794, device='cuda:3')
compute distance is  tensor(108.9794, device='cuda:3')
compute norm is  tensor(44.6917, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.3549, device='cuda:3')
compute distance is  tensor(109.3549, device='cuda:3')
compute norm is  tensor(44.8150, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.1537, device='cuda:3')
compute distance is  tensor(125.1537, device='cuda:3')
compute norm is  tensor(45.1528, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.3482, device='cuda:3')
compute distance is  tensor(115.3482, device='cuda:3')
compute norm is  tensor(44.8931, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(125.1537, device='cuda:3')
distance x is tensor(106172.1562, device='cuda:3')
distance x is tensor(106172.1562, device='cuda:3')
________________________________
test distance is  tensor(106172.1562, device='cuda:3')
test distance1 is  tensor(106172.1562, device='cuda:3')
test similarity is  tensor(0.0348, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139284355037799.7
test entropy is  0.0
________________________________
cal ratio is  0.033646704864283276
distance x is tensor(3572.3486, device='cuda:3')
cal_distance is  tensor(3572.3486, device='cuda:3')
cal ratio is  0.1834302440683446
distance x is tensor(655.2808, device='cuda:3')
cal_distance is  tensor(655.2808, device='cuda:3')
cal ratio is  0.4282862706535515
distance x is tensor(280.6506, device='cuda:3')
cal_distance is  tensor(280.6506, device='cuda:3')
cal ratio is  0.6544325530621431
distance x is tensor(183.6686, device='cuda:3')
cal_distance is  tensor(183.6686, device='cuda:3')
cal ratio is  0.8089662936560121
distance x is tensor(148.5826, device='cuda:3')
cal_distance is  tensor(148.5826, device='cuda:3')
cal ratio is  0.8994226899933362
distance x is tensor(133.6391, device='cuda:3')
cal_distance is  tensor(133.6391, device='cuda:3')
cal ratio is  0.9483771660859076
distance x is tensor(126.7405, device='cuda:3')
cal_distance is  tensor(126.7405, device='cuda:3')
cal ratio is  0.9738455754999191
distance x is tensor(123.4258, device='cuda:3')
cal_distance is  tensor(123.4258, device='cuda:3')
distance x is tensor(123.4258, device='cuda:3')
return_distance is  tensor(123.4258, device='cuda:3')
distance x is tensor(123.4161, device='cuda:3')
distance x is tensor(123.4161, device='cuda:3')
________________________________
test distance is  tensor(123.4161, device='cuda:3')
test distance1 is  tensor(123.4161, device='cuda:3')
test similarity is  tensor(0.9522, device='cuda:3')
test acc is  0.10000000015633198
test loss is 170.60490427240887
test entropy is  4.9450409412869085e-22
________________________________
0
distance x is tensor(123.4161, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  7.933878191011632e-21
avg test loss is  170.6187552348383
avg accuracy is  0.5368666668230091
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9522, device='cuda:3')
compute_distance is  tensor(123.4161, device='cuda:3')
compute_norm is  tensor(45.0357, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(110.6714, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8338635288703162
avg test loss is  1.2940736444774212
avg accuracy is  0.8634166668229896
solo acc is  0.3469833334896737
compute similarity  is  tensor(0.9554, device='cuda:3')
compute_distance is  tensor(110.6714, device='cuda:3')
compute_norm is  tensor(44.3757, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(112.3896, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7926367298245176
avg test loss is  1.352345577816465
avg accuracy is  0.8664333334896561
solo acc is  0.27261666682300556
compute similarity  is  tensor(0.9549, device='cuda:3')
compute_distance is  tensor(112.3896, device='cuda:3')
compute_norm is  tensor(44.0977, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(113.9474, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7956120803285001
avg test loss is  1.3115058808819826
avg accuracy is  0.8672333334896559
solo acc is  0.26441666682300535
compute similarity  is  tensor(0.9544, device='cuda:3')
compute_distance is  tensor(113.9474, device='cuda:3')
compute_norm is  tensor(43.8393, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.4086, device='cuda:3')
exit early
distance x is tensor(115.4086, device='cuda:3')
distance x is tensor(115.4086, device='cuda:3')
________________________________
test distance is  tensor(115.4086, device='cuda:3')
test distance1 is  tensor(115.4086, device='cuda:3')
test similarity is  tensor(0.9540, device='cuda:3')
test acc is  0.24655000015633813
test loss is 1.307177425701735
test entropy is  0.7852099083506985
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.3412792682647705
mal norm is  tensor(598.5995, device='cuda:3')
distance x is tensor(115.4166, device='cuda:3')
mal distance is  tensor(115.4166, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([13., 13., 13., 12., 13., 12., 12., 13., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 26., 27., 13., 13., 13., 12., 15., 27.])
count_res tensor([3.5114e-07, 3.5114e-07, 3.5114e-07, 1.2918e-07, 3.5114e-07, 1.2918e-07,
        1.2918e-07, 3.5114e-07, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06,
        7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06,
        7.0528e-06, 7.0528e-06, 1.5535e-01, 4.2228e-01, 3.5114e-07, 3.5114e-07,
        3.5114e-07, 1.2918e-07, 2.5946e-06, 4.2228e-01])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 88.57% 

Test Accuracy: 88.28% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3622099757194519
distance x is tensor(87.1004, device='cuda:3')
benign distance is  tensor(87.1004, device='cuda:3')
norm1 res is  tensor(383.7887, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.37135615944862366
distance x is tensor(109.4895, device='cuda:3')
benign distance is  tensor(109.4895, device='cuda:3')
norm1 res is  tensor(473.7033, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.12445883452892303
distance x is tensor(112.7027, device='cuda:3')
benign distance is  tensor(112.7027, device='cuda:3')
norm1 res is  tensor(490.1065, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.745811402797699
distance x is tensor(102.5896, device='cuda:3')
benign distance is  tensor(102.5896, device='cuda:3')
norm1 res is  tensor(451.4938, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8571054339408875
distance x is tensor(81.8977, device='cuda:3')
benign distance is  tensor(81.8977, device='cuda:3')
norm1 res is  tensor(356.5426, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.512474000453949
distance x is tensor(103.5635, device='cuda:3')
benign distance is  tensor(103.5635, device='cuda:3')
norm1 res is  tensor(461.2219, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.31530478596687317
distance x is tensor(100.5708, device='cuda:3')
benign distance is  tensor(100.5708, device='cuda:3')
norm1 res is  tensor(434.1803, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5390003323554993
distance x is tensor(93.4915, device='cuda:3')
benign distance is  tensor(93.4915, device='cuda:3')
norm1 res is  tensor(418.9173, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4024829864501953
distance x is tensor(106.3964, device='cuda:3')
benign distance is  tensor(106.3964, device='cuda:3')
norm1 res is  tensor(467.0018, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6606935262680054
distance x is tensor(102.3920, device='cuda:3')
benign distance is  tensor(102.3920, device='cuda:3')
norm1 res is  tensor(448.9622, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.24470655620098114
distance x is tensor(116.3201, device='cuda:3')
benign distance is  tensor(116.3201, device='cuda:3')
norm1 res is  tensor(494.5926, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.1448027789592743
distance x is tensor(110.9038, device='cuda:3')
benign distance is  tensor(110.9038, device='cuda:3')
norm1 res is  tensor(496.2487, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.46765559911727905
distance x is tensor(117.8662, device='cuda:3')
benign distance is  tensor(117.8662, device='cuda:3')
norm1 res is  tensor(520.1553, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.29647061228752136
distance x is tensor(108.3669, device='cuda:3')
benign distance is  tensor(108.3669, device='cuda:3')
norm1 res is  tensor(485.2359, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3603132367134094
distance x is tensor(131.4170, device='cuda:3')
benign distance is  tensor(131.4170, device='cuda:3')
norm1 res is  tensor(583.9395, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6030628085136414
distance x is tensor(86.9492, device='cuda:3')
benign distance is  tensor(86.9492, device='cuda:3')
norm1 res is  tensor(382.6719, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(103.8684, device='cuda:3')
compute distance is  tensor(103.8684, device='cuda:3')
compute norm is  tensor(45.8779, device='cuda:3', dtype=torch.float64)
distance x is tensor(94.0068, device='cuda:3')
compute distance is  tensor(94.0068, device='cuda:3')
compute norm is  tensor(45.7446, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.3667, device='cuda:3')
compute distance is  tensor(107.3667, device='cuda:3')
compute norm is  tensor(46.1640, device='cuda:3', dtype=torch.float64)
distance x is tensor(90.8749, device='cuda:3')
compute distance is  tensor(90.8749, device='cuda:3')
compute norm is  tensor(45.6768, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.8786, device='cuda:3')
compute distance is  tensor(99.8786, device='cuda:3')
compute norm is  tensor(45.9042, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.4216, device='cuda:3')
compute distance is  tensor(101.4216, device='cuda:3')
compute norm is  tensor(45.9658, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.0955, device='cuda:3')
compute distance is  tensor(103.0955, device='cuda:3')
compute norm is  tensor(45.9038, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.5139, device='cuda:3')
compute distance is  tensor(102.5139, device='cuda:3')
compute norm is  tensor(45.9242, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.5319, device='cuda:3')
compute distance is  tensor(107.5319, device='cuda:3')
compute norm is  tensor(46.0008, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.9820, device='cuda:3')
compute distance is  tensor(106.9820, device='cuda:3')
compute norm is  tensor(46.0347, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.0264, device='cuda:3')
compute distance is  tensor(111.0264, device='cuda:3')
compute norm is  tensor(46.1438, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.0987, device='cuda:3')
compute distance is  tensor(99.0987, device='cuda:3')
compute norm is  tensor(45.8616, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(111.0264, device='cuda:3')
distance x is tensor(106204.4688, device='cuda:3')
distance x is tensor(106204.4688, device='cuda:3')
________________________________
test distance is  tensor(106204.4688, device='cuda:3')
test distance1 is  tensor(106204.4688, device='cuda:3')
test similarity is  tensor(-0.1036, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139281750446560.34
test entropy is  0.0
________________________________
cal ratio is  0.031686025542879886
distance x is tensor(3365.2029, device='cuda:3')
cal_distance is  tensor(3365.2029, device='cuda:3')
cal ratio is  0.17800554130499915
distance x is tensor(599.0289, device='cuda:3')
cal_distance is  tensor(599.0289, device='cuda:3')
cal ratio is  0.4219055943309859
distance x is tensor(252.7365, device='cuda:3')
cal_distance is  tensor(252.7365, device='cuda:3')
cal ratio is  0.6495388481956579
distance x is tensor(164.1640, device='cuda:3')
cal_distance is  tensor(164.1640, device='cuda:3')
cal ratio is  0.8059353867229845
distance x is tensor(132.3065, device='cuda:3')
cal_distance is  tensor(132.3065, device='cuda:3')
cal ratio is  0.8977356767831715
distance x is tensor(118.7768, device='cuda:3')
cal_distance is  tensor(118.7768, device='cuda:3')
cal ratio is  0.94748709840974
distance x is tensor(112.5398, device='cuda:3')
cal_distance is  tensor(112.5398, device='cuda:3')
cal ratio is  0.9733883522570879
distance x is tensor(109.5450, device='cuda:3')
cal_distance is  tensor(109.5450, device='cuda:3')
distance x is tensor(109.5450, device='cuda:3')
return_distance is  tensor(109.5450, device='cuda:3')
distance x is tensor(109.5351, device='cuda:3')
distance x is tensor(109.5351, device='cuda:3')
________________________________
test distance is  tensor(109.5351, device='cuda:3')
test distance1 is  tensor(109.5351, device='cuda:3')
test similarity is  tensor(0.9611, device='cuda:3')
test acc is  0.10000000015633198
test loss is 200.3492564545003
test entropy is  3.920307469454345e-25
________________________________
0
distance x is tensor(109.5351, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.0320942518573253e-25
avg test loss is  200.37127134083175
avg accuracy is  0.5017833334896754
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9611, device='cuda:3')
compute_distance is  tensor(109.5351, device='cuda:3')
compute_norm is  tensor(44.7310, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(97.7872, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8200296853651116
avg test loss is  1.358847779060986
avg accuracy is  0.8619500001563228
solo acc is  0.3125333334896731
compute similarity  is  tensor(0.9644, device='cuda:3')
compute_distance is  tensor(97.7872, device='cuda:3')
compute_norm is  tensor(43.6793, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(100.5605, device='cuda:3')
exit early
distance x is tensor(100.5605, device='cuda:3')
distance x is tensor(100.5605, device='cuda:3')
________________________________
test distance is  tensor(100.5605, device='cuda:3')
test distance1 is  tensor(100.5605, device='cuda:3')
test similarity is  tensor(0.9637, device='cuda:3')
test acc is  0.2637000001563386
test loss is 1.3640480140633167
test entropy is  0.8008573895324268
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.0685679912567139
mal norm is  tensor(533.5435, device='cuda:3')
distance x is tensor(100.5678, device='cuda:3')
mal distance is  tensor(100.5678, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([12., 33., 21., 23., 12., 14., 12., 13., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 29., 28., 13., 21., 35., 31., 26., 24.,
        27., 15., 17., 17., 16., 26., 14., 15.])
count_res tensor([8.8629e-11, 1.1689e-01, 7.1817e-07, 5.3066e-06, 8.8629e-11, 6.5488e-10,
        8.8629e-11, 2.4092e-10, 1.4425e-05, 1.4425e-05, 1.4425e-05, 1.4425e-05,
        1.4425e-05, 1.4425e-05, 1.4425e-05, 1.4425e-05, 1.4425e-05, 1.4425e-05,
        1.4425e-05, 1.4425e-05, 2.1408e-03, 7.8757e-04, 2.4092e-10, 7.1817e-07,
        8.6367e-01, 1.5819e-02, 1.0659e-04, 1.4425e-05, 2.8973e-04, 1.7802e-09,
        1.3154e-08, 1.3154e-08, 4.8390e-09, 1.0659e-04, 6.5488e-10, 1.7802e-09])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 88.21% 

Test Accuracy: 87.78% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9140052795410156
distance x is tensor(117.9337, device='cuda:3')
benign distance is  tensor(117.9337, device='cuda:3')
norm1 res is  tensor(532.7495, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8057612180709839
distance x is tensor(106.1439, device='cuda:3')
benign distance is  tensor(106.1439, device='cuda:3')
norm1 res is  tensor(474.3231, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.07639019191265106
distance x is tensor(128.0722, device='cuda:3')
benign distance is  tensor(128.0722, device='cuda:3')
norm1 res is  tensor(551.5067, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7032933235168457
distance x is tensor(119.8119, device='cuda:3')
benign distance is  tensor(119.8119, device='cuda:3')
norm1 res is  tensor(511.8049, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0536009073257446
distance x is tensor(103.4977, device='cuda:3')
benign distance is  tensor(103.4977, device='cuda:3')
norm1 res is  tensor(437.8785, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9027673602104187
distance x is tensor(113.4721, device='cuda:3')
benign distance is  tensor(113.4721, device='cuda:3')
norm1 res is  tensor(509.0916, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4100017547607422
distance x is tensor(114.6695, device='cuda:3')
benign distance is  tensor(114.6695, device='cuda:3')
norm1 res is  tensor(493.1332, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.26668795943260193
distance x is tensor(113.1482, device='cuda:3')
benign distance is  tensor(113.1482, device='cuda:3')
norm1 res is  tensor(503.0955, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.19587981700897217
distance x is tensor(120.3650, device='cuda:3')
benign distance is  tensor(120.3650, device='cuda:3')
norm1 res is  tensor(527.2771, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7701217532157898
distance x is tensor(123.6421, device='cuda:3')
benign distance is  tensor(123.6421, device='cuda:3')
norm1 res is  tensor(532.9015, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5642276406288147
distance x is tensor(120.4949, device='cuda:3')
benign distance is  tensor(120.4949, device='cuda:3')
norm1 res is  tensor(533.3852, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0057857036590576
distance x is tensor(114.0452, device='cuda:3')
benign distance is  tensor(114.0452, device='cuda:3')
norm1 res is  tensor(508.1779, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.2540438771247864
distance x is tensor(115.4007, device='cuda:3')
benign distance is  tensor(115.4007, device='cuda:3')
norm1 res is  tensor(517.7150, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.12720632553100586
distance x is tensor(142.6437, device='cuda:3')
benign distance is  tensor(142.6437, device='cuda:3')
norm1 res is  tensor(625.2845, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.45051079988479614
distance x is tensor(132.9351, device='cuda:3')
benign distance is  tensor(132.9351, device='cuda:3')
norm1 res is  tensor(589.2350, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9171335101127625
distance x is tensor(134.8224, device='cuda:3')
benign distance is  tensor(134.8224, device='cuda:3')
norm1 res is  tensor(583.3447, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3892894685268402
distance x is tensor(127.9832, device='cuda:3')
benign distance is  tensor(127.9832, device='cuda:3')
norm1 res is  tensor(563.5015, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5792167782783508
distance x is tensor(116.2249, device='cuda:3')
benign distance is  tensor(116.2249, device='cuda:3')
norm1 res is  tensor(499.5630, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.47810491919517517
distance x is tensor(131.9555, device='cuda:3')
benign distance is  tensor(131.9555, device='cuda:3')
norm1 res is  tensor(572.4459, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.6933138966560364
distance x is tensor(144.5993, device='cuda:3')
benign distance is  tensor(144.5993, device='cuda:3')
norm1 res is  tensor(626.3171, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6991972923278809
distance x is tensor(51.2367, device='cuda:3')
benign distance is  tensor(51.2367, device='cuda:3')
norm1 res is  tensor(224.2065, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.0255062580108643
distance x is tensor(115.0660, device='cuda:3')
benign distance is  tensor(115.0660, device='cuda:3')
norm1 res is  tensor(523.9368, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.34472328424453735
distance x is tensor(128.5105, device='cuda:3')
benign distance is  tensor(128.5105, device='cuda:3')
norm1 res is  tensor(569.0180, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.17166897654533386
distance x is tensor(123.9400, device='cuda:3')
benign distance is  tensor(123.9400, device='cuda:3')
norm1 res is  tensor(549.5995, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(118.5891, device='cuda:3')
compute distance is  tensor(118.5891, device='cuda:3')
compute norm is  tensor(46.4598, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.5094, device='cuda:3')
compute distance is  tensor(107.5094, device='cuda:3')
compute norm is  tensor(46.1693, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.9518, device='cuda:3')
compute distance is  tensor(114.9518, device='cuda:3')
compute norm is  tensor(46.4610, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.6853, device='cuda:3')
compute distance is  tensor(102.6853, device='cuda:3')
compute norm is  tensor(46.1667, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.7399, device='cuda:3')
compute distance is  tensor(124.7399, device='cuda:3')
compute norm is  tensor(46.6886, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.4057, device='cuda:3')
compute distance is  tensor(107.4057, device='cuda:3')
compute norm is  tensor(46.3356, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.6536, device='cuda:3')
compute distance is  tensor(126.6536, device='cuda:3')
compute norm is  tensor(46.7553, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.0200, device='cuda:3')
compute distance is  tensor(131.0200, device='cuda:3')
compute norm is  tensor(46.6542, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.5713, device='cuda:3')
compute distance is  tensor(119.5713, device='cuda:3')
compute norm is  tensor(46.4560, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.3932, device='cuda:3')
compute distance is  tensor(119.3932, device='cuda:3')
compute norm is  tensor(46.5968, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.1179, device='cuda:3')
compute distance is  tensor(118.1179, device='cuda:3')
compute norm is  tensor(46.5511, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.7558, device='cuda:3')
compute distance is  tensor(111.7558, device='cuda:3')
compute norm is  tensor(46.4097, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(131.0200, device='cuda:3')
distance x is tensor(106200.4844, device='cuda:3')
distance x is tensor(106200.4844, device='cuda:3')
________________________________
test distance is  tensor(106200.4844, device='cuda:3')
test distance1 is  tensor(106200.4844, device='cuda:3')
test similarity is  tensor(-0.0975, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139283985366690.66
test entropy is  0.0
________________________________
cal ratio is  0.03442164572432909
distance x is tensor(3655.6008, device='cuda:3')
cal_distance is  tensor(3655.6008, device='cuda:3')
cal ratio is  0.18553057856821367
distance x is tensor(678.2297, device='cuda:3')
cal_distance is  tensor(678.2297, device='cuda:3')
cal ratio is  0.43073133189092655
distance x is tensor(292.1377, device='cuda:3')
cal_distance is  tensor(292.1377, device='cuda:3')
cal ratio is  0.656298026489195
distance x is tensor(191.7311, device='cuda:3')
cal_distance is  tensor(191.7311, device='cuda:3')
cal ratio is  0.8101186150957137
distance x is tensor(155.3259, device='cuda:3')
cal_distance is  tensor(155.3259, device='cuda:3')
cal ratio is  0.9000631186419127
distance x is tensor(139.8036, device='cuda:3')
cal_distance is  tensor(139.8036, device='cuda:3')
cal ratio is  0.9487149121904139
distance x is tensor(132.6340, device='cuda:3')
cal_distance is  tensor(132.6340, device='cuda:3')
cal ratio is  0.9740189660862555
distance x is tensor(129.1882, device='cuda:3')
cal_distance is  tensor(129.1882, device='cuda:3')
distance x is tensor(129.1882, device='cuda:3')
return_distance is  tensor(129.1882, device='cuda:3')
distance x is tensor(129.1783, device='cuda:3')
distance x is tensor(129.1783, device='cuda:3')
________________________________
test distance is  tensor(129.1783, device='cuda:3')
test distance1 is  tensor(129.1783, device='cuda:3')
test similarity is  tensor(0.9478, device='cuda:3')
test acc is  0.10000000015633198
test loss is 431.82942495773085
test entropy is  1.0113849257440311e-45
________________________________
0
distance x is tensor(129.1783, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.1234290460258661e-45
avg test loss is  431.85064622435743
avg accuracy is  0.17288333348966817
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9478, device='cuda:3')
compute_distance is  tensor(129.1783, device='cuda:3')
compute_norm is  tensor(45.5567, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(112.2179, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8424715733350213
avg test loss is  1.3645332920144615
avg accuracy is  0.832950000156324
solo acc is  0.32246666682300656
compute similarity  is  tensor(0.9537, device='cuda:3')
compute_distance is  tensor(112.2179, device='cuda:3')
compute_norm is  tensor(44.3638, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.1000, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7836612245675597
avg test loss is  1.4463087372434165
avg accuracy is  0.8338833334896574
solo acc is  0.24676666682300477
compute similarity  is  tensor(0.9529, device='cuda:3')
compute_distance is  tensor(115.1000, device='cuda:3')
compute_norm is  tensor(44.0675, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.5444, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7965714507011462
avg test loss is  1.371851720408336
avg accuracy is  0.8360666668229906
solo acc is  0.25233333348967163
compute similarity  is  tensor(0.9522, device='cuda:3')
compute_distance is  tensor(117.5444, device='cuda:3')
compute_norm is  tensor(43.7982, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(119.8792, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7810306503955744
avg test loss is  1.3616088788900802
avg accuracy is  0.8366166668229906
solo acc is  0.24023333348967119
compute similarity  is  tensor(0.9516, device='cuda:3')
compute_distance is  tensor(119.8792, device='cuda:3')
compute_norm is  tensor(43.5447, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(122.0436, device='cuda:3')
distance x is tensor(122.0436, device='cuda:3')
________________________________
test distance is  tensor(122.0436, device='cuda:3')
test distance1 is  tensor(122.0436, device='cuda:3')
test similarity is  tensor(0.9511, device='cuda:3')
test acc is  0.24556666682300476
test loss is 1.319472377996709
test entropy is  0.7888627576548407
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.2410061359405518
mal norm is  tensor(624.1805, device='cuda:3')
distance x is tensor(122.0504, device='cuda:3')
mal distance is  tensor(122.0504, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([13., 13., 19., 13., 14., 17., 13., 17., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 26., 13., 22., 14., 15., 12.])
count_res tensor([2.2159e-06, 2.2159e-06, 8.9395e-04, 2.2159e-06, 6.0234e-06, 1.2098e-04,
        2.2159e-06, 1.2098e-04, 4.4507e-05, 4.4507e-05, 4.4507e-05, 4.4507e-05,
        4.4507e-05, 4.4507e-05, 4.4507e-05, 4.4507e-05, 4.4507e-05, 4.4507e-05,
        4.4507e-05, 4.4507e-05, 8.1517e-07, 8.1517e-07, 9.8033e-01, 2.2159e-06,
        1.7955e-02, 6.0234e-06, 1.6373e-05, 8.1517e-07])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 87.77% 

Test Accuracy: 87.32% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.43799883127212524
distance x is tensor(109.0943, device='cuda:3')
benign distance is  tensor(109.0943, device='cuda:3')
norm1 res is  tensor(462.9330, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.757794976234436
distance x is tensor(112.7862, device='cuda:3')
benign distance is  tensor(112.7862, device='cuda:3')
norm1 res is  tensor(498.0074, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.28428083658218384
distance x is tensor(118.0613, device='cuda:3')
benign distance is  tensor(118.0613, device='cuda:3')
norm1 res is  tensor(503.7821, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6082333922386169
distance x is tensor(110.1345, device='cuda:3')
benign distance is  tensor(110.1345, device='cuda:3')
norm1 res is  tensor(484.2020, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7614291906356812
distance x is tensor(95.2674, device='cuda:3')
benign distance is  tensor(95.2674, device='cuda:3')
norm1 res is  tensor(407.7166, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7776540517807007
distance x is tensor(116.8447, device='cuda:3')
benign distance is  tensor(116.8447, device='cuda:3')
norm1 res is  tensor(507.9951, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.35584181547164917
distance x is tensor(111.9165, device='cuda:3')
benign distance is  tensor(111.9165, device='cuda:3')
norm1 res is  tensor(466.4454, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.40039530396461487
distance x is tensor(114.2626, device='cuda:3')
benign distance is  tensor(114.2626, device='cuda:3')
norm1 res is  tensor(506.6831, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.21757571399211884
distance x is tensor(127.8096, device='cuda:3')
benign distance is  tensor(127.8096, device='cuda:3')
norm1 res is  tensor(570.5320, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.011022672988474369
distance x is tensor(123.0813, device='cuda:3')
benign distance is  tensor(123.0813, device='cuda:3')
norm1 res is  tensor(530.1027, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.27445369958877563
distance x is tensor(56.1663, device='cuda:3')
benign distance is  tensor(56.1663, device='cuda:3')
norm1 res is  tensor(234.3200, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.19374288618564606
distance x is tensor(119.5737, device='cuda:3')
benign distance is  tensor(119.5737, device='cuda:3')
norm1 res is  tensor(520.0286, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4657149314880371
distance x is tensor(115.9912, device='cuda:3')
benign distance is  tensor(115.9912, device='cuda:3')
norm1 res is  tensor(508.4664, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.3040490746498108
distance x is tensor(133.0047, device='cuda:3')
benign distance is  tensor(133.0047, device='cuda:3')
norm1 res is  tensor(558.1462, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.5723696351051331
distance x is tensor(120.8886, device='cuda:3')
benign distance is  tensor(120.8886, device='cuda:3')
norm1 res is  tensor(522.3946, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.14940717816352844
distance x is tensor(121.7764, device='cuda:3')
benign distance is  tensor(121.7764, device='cuda:3')
norm1 res is  tensor(537.8715, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(114.7533, device='cuda:3')
compute distance is  tensor(114.7533, device='cuda:3')
compute norm is  tensor(46.6230, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.0849, device='cuda:3')
compute distance is  tensor(103.0849, device='cuda:3')
compute norm is  tensor(46.5242, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.3057, device='cuda:3')
compute distance is  tensor(108.3057, device='cuda:3')
compute norm is  tensor(46.7383, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.4072, device='cuda:3')
compute distance is  tensor(110.4072, device='cuda:3')
compute norm is  tensor(46.7589, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.0926, device='cuda:3')
compute distance is  tensor(111.0926, device='cuda:3')
compute norm is  tensor(46.7629, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.0412, device='cuda:3')
compute distance is  tensor(111.0412, device='cuda:3')
compute norm is  tensor(46.7828, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.9870, device='cuda:3')
compute distance is  tensor(107.9870, device='cuda:3')
compute norm is  tensor(46.7172, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.5729, device='cuda:3')
compute distance is  tensor(114.5729, device='cuda:3')
compute norm is  tensor(46.8057, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.8068, device='cuda:3')
compute distance is  tensor(115.8068, device='cuda:3')
compute norm is  tensor(46.8363, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.4236, device='cuda:3')
compute distance is  tensor(106.4236, device='cuda:3')
compute norm is  tensor(46.5802, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.2490, device='cuda:3')
compute distance is  tensor(116.2490, device='cuda:3')
compute norm is  tensor(46.9104, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.3382, device='cuda:3')
compute distance is  tensor(122.3382, device='cuda:3')
compute norm is  tensor(46.8560, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(122.3382, device='cuda:3')
distance x is tensor(106207.9297, device='cuda:3')
distance x is tensor(106207.9297, device='cuda:3')
________________________________
test distance is  tensor(106207.9297, device='cuda:3')
test distance1 is  tensor(106207.9297, device='cuda:3')
test similarity is  tensor(-0.0993, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139283012753202.77
test entropy is  0.0
________________________________
cal ratio is  0.033260485050972954
distance x is tensor(3532.5327, device='cuda:3')
cal_distance is  tensor(3532.5327, device='cuda:3')
cal ratio is  0.18237443432873804
distance x is tensor(644.2477, device='cuda:3')
cal_distance is  tensor(644.2477, device='cuda:3')
cal ratio is  0.42705187206534634
distance x is tensor(275.1300, device='cuda:3')
cal_distance is  tensor(275.1300, device='cuda:3')
cal ratio is  0.6534886654835492
distance x is tensor(179.7961, device='cuda:3')
cal_distance is  tensor(179.7961, device='cuda:3')
cal ratio is  0.8083825064741645
distance x is tensor(145.3450, device='cuda:3')
cal_distance is  tensor(145.3450, device='cuda:3')
cal ratio is  0.8990980069836417
distance x is tensor(130.6799, device='cuda:3')
cal_distance is  tensor(130.6799, device='cuda:3')
cal ratio is  0.9482058481688227
distance x is tensor(123.9117, device='cuda:3')
cal_distance is  tensor(123.9117, device='cuda:3')
cal ratio is  0.9737576341023718
distance x is tensor(120.6601, device='cuda:3')
cal_distance is  tensor(120.6601, device='cuda:3')
distance x is tensor(120.6601, device='cuda:3')
return_distance is  tensor(120.6601, device='cuda:3')
distance x is tensor(120.6502, device='cuda:3')
distance x is tensor(120.6502, device='cuda:3')
________________________________
test distance is  tensor(120.6502, device='cuda:3')
test distance1 is  tensor(120.6502, device='cuda:3')
test similarity is  tensor(0.9551, device='cuda:3')
test acc is  0.10000000015633198
test loss is 314.57199971863963
test entropy is  1.8010375252935182e-42
________________________________
0
distance x is tensor(120.6502, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  5.177065804094358e-43
avg test loss is  314.59483636721876
avg accuracy is  0.2453333334896714
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9551, device='cuda:3')
compute_distance is  tensor(120.6502, device='cuda:3')
compute_norm is  tensor(45.7270, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(105.9804, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8315331215924545
avg test loss is  1.3888661973257816
avg accuracy is  0.8340166668229906
solo acc is  0.30406666682300615
compute similarity  is  tensor(0.9597, device='cuda:3')
compute_distance is  tensor(105.9804, device='cuda:3')
compute_norm is  tensor(44.5054, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(108.7312, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8009796301439118
avg test loss is  1.429546339425451
avg accuracy is  0.8320166668229907
solo acc is  0.24360000015633804
compute similarity  is  tensor(0.9590, device='cuda:3')
compute_distance is  tensor(108.7312, device='cuda:3')
compute_norm is  tensor(44.2188, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(111.0289, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8003272299192099
avg test loss is  1.378863142497504
avg accuracy is  0.8328666668229907
solo acc is  0.2429166668230047
compute similarity  is  tensor(0.9584, device='cuda:3')
compute_distance is  tensor(111.0289, device='cuda:3')
compute_norm is  tensor(43.9568, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(113.1979, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7849190204636629
avg test loss is  1.3637251667122343
avg accuracy is  0.8358333334896572
solo acc is  0.2331000001563377
compute similarity  is  tensor(0.9579, device='cuda:3')
compute_distance is  tensor(113.1979, device='cuda:3')
compute_norm is  tensor(43.7090, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.3170, device='cuda:3')
distance x is tensor(115.3170, device='cuda:3')
________________________________
test distance is  tensor(115.3170, device='cuda:3')
test distance1 is  tensor(115.3170, device='cuda:3')
test similarity is  tensor(0.9574, device='cuda:3')
test acc is  0.225016666823004
test loss is 1.3578397175396428
test entropy is  0.7757223967168885
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.3575185537338257
mal norm is  tensor(589.4322, device='cuda:3')
distance x is tensor(115.3240, device='cuda:3')
mal distance is  tensor(115.3240, device='cuda:3')
user_PLR len size 44
counter_tensor is  tensor([35., 24., 37., 17., 23., 19., 16., 42., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 18., 12., 36., 34., 12., 19., 13., 15.,
        28., 16., 12., 16., 42., 32., 12., 41., 14., 15., 12., 15., 12., 40.,
        37., 39.])
count_res tensor([3.5471e-04, 5.9242e-09, 2.6210e-03, 5.4022e-12, 2.1794e-09, 3.9917e-11,
        1.9874e-12, 3.8898e-01, 1.7660e-05, 1.7660e-05, 1.7660e-05, 1.7660e-05,
        1.7660e-05, 1.7660e-05, 1.7660e-05, 1.7660e-05, 1.7660e-05, 1.7660e-05,
        1.7660e-05, 1.7660e-05, 1.4685e-11, 3.6400e-14, 9.6420e-04, 1.3049e-04,
        3.6400e-14, 3.9917e-11, 9.8945e-14, 7.3111e-13, 3.2345e-07, 1.9874e-12,
        3.6400e-14, 1.9874e-12, 3.8898e-01, 1.7660e-05, 3.6400e-14, 1.4310e-01,
        2.6896e-13, 7.3111e-13, 3.6400e-14, 7.3111e-13, 3.6400e-14, 5.2643e-02,
        2.6210e-03, 1.9366e-02])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 89.15% 

Test Accuracy: 88.46% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0275603532791138
distance x is tensor(87.5650, device='cuda:3')
benign distance is  tensor(87.5650, device='cuda:3')
norm1 res is  tensor(386.5421, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.772009015083313
distance x is tensor(111.7963, device='cuda:3')
benign distance is  tensor(111.7963, device='cuda:3')
norm1 res is  tensor(492.3017, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.09687457978725433
distance x is tensor(109.0824, device='cuda:3')
benign distance is  tensor(109.0824, device='cuda:3')
norm1 res is  tensor(471.0336, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5138111114501953
distance x is tensor(92.8297, device='cuda:3')
benign distance is  tensor(92.8297, device='cuda:3')
norm1 res is  tensor(410.0044, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6035922765731812
distance x is tensor(90.5046, device='cuda:3')
benign distance is  tensor(90.5046, device='cuda:3')
norm1 res is  tensor(386.5469, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4850613474845886
distance x is tensor(102.1370, device='cuda:3')
benign distance is  tensor(102.1370, device='cuda:3')
norm1 res is  tensor(456.4152, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.21663248538970947
distance x is tensor(110.0900, device='cuda:3')
benign distance is  tensor(110.0900, device='cuda:3')
norm1 res is  tensor(481.8745, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7077983617782593
distance x is tensor(80.1492, device='cuda:3')
benign distance is  tensor(80.1492, device='cuda:3')
norm1 res is  tensor(353.3278, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2556781768798828
distance x is tensor(114.0800, device='cuda:3')
benign distance is  tensor(114.0800, device='cuda:3')
norm1 res is  tensor(514.1382, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.49809542298316956
distance x is tensor(113.5099, device='cuda:3')
benign distance is  tensor(113.5099, device='cuda:3')
norm1 res is  tensor(497.3905, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8633826971054077
distance x is tensor(105.7227, device='cuda:3')
benign distance is  tensor(105.7227, device='cuda:3')
norm1 res is  tensor(474.9204, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5895090103149414
distance x is tensor(104.9001, device='cuda:3')
benign distance is  tensor(104.9001, device='cuda:3')
norm1 res is  tensor(461.5958, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6424693465232849
distance x is tensor(109.7464, device='cuda:3')
benign distance is  tensor(109.7464, device='cuda:3')
norm1 res is  tensor(490.4796, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1308712661266327
distance x is tensor(114.8957, device='cuda:3')
benign distance is  tensor(114.8957, device='cuda:3')
norm1 res is  tensor(509.7837, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.40188807249069214
distance x is tensor(117.1013, device='cuda:3')
benign distance is  tensor(117.1013, device='cuda:3')
norm1 res is  tensor(519.8244, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.2973935306072235
distance x is tensor(113.8411, device='cuda:3')
benign distance is  tensor(113.8411, device='cuda:3')
norm1 res is  tensor(496.4156, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.41793569922447205
distance x is tensor(115.8484, device='cuda:3')
benign distance is  tensor(115.8484, device='cuda:3')
norm1 res is  tensor(502.8361, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.170844316482544
distance x is tensor(109.7170, device='cuda:3')
benign distance is  tensor(109.7170, device='cuda:3')
norm1 res is  tensor(487.1916, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5562498569488525
distance x is tensor(109.7590, device='cuda:3')
benign distance is  tensor(109.7590, device='cuda:3')
norm1 res is  tensor(486.5387, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.14389941096305847
distance x is tensor(120.2353, device='cuda:3')
benign distance is  tensor(120.2353, device='cuda:3')
norm1 res is  tensor(537.7117, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3198174834251404
distance x is tensor(87.7737, device='cuda:3')
benign distance is  tensor(87.7737, device='cuda:3')
norm1 res is  tensor(398.1021, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8726519346237183
distance x is tensor(111.3903, device='cuda:3')
benign distance is  tensor(111.3903, device='cuda:3')
norm1 res is  tensor(494.7304, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.245942160487175
distance x is tensor(118.9968, device='cuda:3')
benign distance is  tensor(118.9968, device='cuda:3')
norm1 res is  tensor(518.8800, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7193371057510376
distance x is tensor(102.9505, device='cuda:3')
benign distance is  tensor(102.9505, device='cuda:3')
norm1 res is  tensor(449.9614, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.2967633306980133
distance x is tensor(109.2391, device='cuda:3')
benign distance is  tensor(109.2391, device='cuda:3')
norm1 res is  tensor(492.6322, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.3973672389984131
distance x is tensor(111.2786, device='cuda:3')
benign distance is  tensor(111.2786, device='cuda:3')
norm1 res is  tensor(482.1028, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.07453548908233643
distance x is tensor(110.6815, device='cuda:3')
benign distance is  tensor(110.6815, device='cuda:3')
norm1 res is  tensor(487.2845, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.17072223126888275
distance x is tensor(117.7907, device='cuda:3')
benign distance is  tensor(117.7907, device='cuda:3')
norm1 res is  tensor(515.5981, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.17181025445461273
distance x is tensor(110.8409, device='cuda:3')
benign distance is  tensor(110.8409, device='cuda:3')
norm1 res is  tensor(491.8082, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.9397212862968445
distance x is tensor(115.6282, device='cuda:3')
benign distance is  tensor(115.6282, device='cuda:3')
norm1 res is  tensor(517.8381, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.4965519905090332
distance x is tensor(128.3134, device='cuda:3')
benign distance is  tensor(128.3134, device='cuda:3')
norm1 res is  tensor(550.0867, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6638967990875244
distance x is tensor(129.5905, device='cuda:3')
benign distance is  tensor(129.5905, device='cuda:3')
norm1 res is  tensor(577.9088, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(87.6101, device='cuda:3')
compute distance is  tensor(87.6101, device='cuda:3')
compute norm is  tensor(46.3912, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.0958, device='cuda:3')
compute distance is  tensor(100.0958, device='cuda:3')
compute norm is  tensor(46.5724, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.2449, device='cuda:3')
compute distance is  tensor(103.2449, device='cuda:3')
compute norm is  tensor(46.6728, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.8133, device='cuda:3')
compute distance is  tensor(100.8133, device='cuda:3')
compute norm is  tensor(46.5829, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.0098, device='cuda:3')
compute distance is  tensor(112.0098, device='cuda:3')
compute norm is  tensor(46.7817, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.7189, device='cuda:3')
compute distance is  tensor(98.7189, device='cuda:3')
compute norm is  tensor(46.5859, device='cuda:3', dtype=torch.float64)
distance x is tensor(97.8024, device='cuda:3')
compute distance is  tensor(97.8024, device='cuda:3')
compute norm is  tensor(46.6447, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.7291, device='cuda:3')
compute distance is  tensor(98.7291, device='cuda:3')
compute norm is  tensor(46.5528, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.8869, device='cuda:3')
compute distance is  tensor(106.8869, device='cuda:3')
compute norm is  tensor(46.5860, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.9889, device='cuda:3')
compute distance is  tensor(100.9889, device='cuda:3')
compute norm is  tensor(46.6390, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.9147, device='cuda:3')
compute distance is  tensor(113.9147, device='cuda:3')
compute norm is  tensor(46.7970, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.8705, device='cuda:3')
compute distance is  tensor(100.8705, device='cuda:3')
compute norm is  tensor(46.5793, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(113.9147, device='cuda:3')
distance x is tensor(106206.5156, device='cuda:3')
distance x is tensor(106206.5156, device='cuda:3')
________________________________
test distance is  tensor(106206.5156, device='cuda:3')
test distance1 is  tensor(106206.5156, device='cuda:3')
test similarity is  tensor(-0.1022, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139270964556832.75
test entropy is  0.0
________________________________
cal ratio is  0.03209521820882109
distance x is tensor(3408.7268, device='cuda:3')
cal_distance is  tensor(3408.7268, device='cuda:3')
cal ratio is  0.17915123703455924
distance x is tensor(610.6818, device='cuda:3')
cal_distance is  tensor(610.6818, device='cuda:3')
cal ratio is  0.42326116992329915
distance x is tensor(258.4808, device='cuda:3')
cal_distance is  tensor(258.4808, device='cuda:3')
cal ratio is  0.6505816106317407
distance x is tensor(168.1646, device='cuda:3')
cal_distance is  tensor(168.1646, device='cuda:3')
cal ratio is  0.8065821958943014
distance x is tensor(135.6396, device='cuda:3')
cal_distance is  tensor(135.6396, device='cuda:3')
cal ratio is  0.8980959416774237
distance x is tensor(121.8178, device='cuda:3')
cal_distance is  tensor(121.8178, device='cuda:3')
cal ratio is  0.947677241747796
distance x is tensor(115.4443, device='cuda:3')
cal_distance is  tensor(115.4443, device='cuda:3')
cal ratio is  0.9734859708226745
distance x is tensor(112.3835, device='cuda:3')
cal_distance is  tensor(112.3835, device='cuda:3')
distance x is tensor(112.3835, device='cuda:3')
return_distance is  tensor(112.3835, device='cuda:3')
distance x is tensor(112.3735, device='cuda:3')
distance x is tensor(112.3735, device='cuda:3')
________________________________
test distance is  tensor(112.3735, device='cuda:3')
test distance1 is  tensor(112.3735, device='cuda:3')
test similarity is  tensor(0.9605, device='cuda:3')
test acc is  0.10000000015633198
test loss is 216.77340662453983
test entropy is  9.879064814366285e-28
________________________________
0
distance x is tensor(112.3735, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  8.710940070009858e-29
avg test loss is  216.7702287295734
avg accuracy is  0.5210000001563422
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9605, device='cuda:3')
compute_distance is  tensor(112.3735, device='cuda:3')
compute_norm is  tensor(45.5395, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(101.1111, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8242833071680211
avg test loss is  1.3505014936044526
avg accuracy is  0.8630833334896562
solo acc is  0.32573333348967337
compute similarity  is  tensor(0.9638, device='cuda:3')
compute_distance is  tensor(101.1111, device='cuda:3')
compute_norm is  tensor(44.3878, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(103.7554, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7983536391751345
avg test loss is  1.390974389591705
avg accuracy is  0.8655000001563228
solo acc is  0.2562000001563385
compute similarity  is  tensor(0.9631, device='cuda:3')
compute_distance is  tensor(103.7554, device='cuda:3')
compute_norm is  tensor(44.0945, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(106.1196, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7850318910089383
avg test loss is  1.3576990186786855
avg accuracy is  0.8683666668229892
solo acc is  0.2500166668230049
compute similarity  is  tensor(0.9625, device='cuda:3')
compute_distance is  tensor(106.1196, device='cuda:3')
compute_norm is  tensor(43.8276, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(108.2730, device='cuda:3')
exit early
distance x is tensor(108.2730, device='cuda:3')
distance x is tensor(108.2730, device='cuda:3')
________________________________
test distance is  tensor(108.2730, device='cuda:3')
test distance1 is  tensor(108.2730, device='cuda:3')
test similarity is  tensor(0.9620, device='cuda:3')
test acc is  0.2309000001563376
test loss is 1.3619052293712397
test entropy is  0.769362997907057
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.3705617189407349
mal norm is  tensor(554.5021, device='cuda:3')
distance x is tensor(108.2797, device='cuda:3')
mal distance is  tensor(108.2797, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 19.98% 

Test Accuracy: 19.14% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.651149570941925
distance x is tensor(146.1374, device='cuda:3')
benign distance is  tensor(146.1374, device='cuda:3')
norm1 res is  tensor(585.4944, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9417141675949097
distance x is tensor(148.0653, device='cuda:3')
benign distance is  tensor(148.0653, device='cuda:3')
norm1 res is  tensor(571.5645, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.07587718963623047
distance x is tensor(152.0938, device='cuda:3')
benign distance is  tensor(152.0938, device='cuda:3')
norm1 res is  tensor(597.1241, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8465736508369446
distance x is tensor(151.4095, device='cuda:3')
benign distance is  tensor(151.4095, device='cuda:3')
norm1 res is  tensor(584.4223, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4947528839111328
distance x is tensor(136.0395, device='cuda:3')
benign distance is  tensor(136.0395, device='cuda:3')
norm1 res is  tensor(534.6979, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.594961166381836
distance x is tensor(157.0489, device='cuda:3')
benign distance is  tensor(157.0489, device='cuda:3')
norm1 res is  tensor(626.0953, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5254722833633423
distance x is tensor(149.2773, device='cuda:3')
benign distance is  tensor(149.2773, device='cuda:3')
norm1 res is  tensor(577.4124, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6081749200820923
distance x is tensor(149.6363, device='cuda:3')
benign distance is  tensor(149.6363, device='cuda:3')
norm1 res is  tensor(581.4271, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(148.9555, device='cuda:3')
compute distance is  tensor(148.9555, device='cuda:3')
compute norm is  tensor(45.4788, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.9965, device='cuda:3')
compute distance is  tensor(149.9965, device='cuda:3')
compute norm is  tensor(45.6135, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.8562, device='cuda:3')
compute distance is  tensor(147.8562, device='cuda:3')
compute norm is  tensor(45.7757, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.2022, device='cuda:3')
compute distance is  tensor(151.2022, device='cuda:3')
compute norm is  tensor(45.7342, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.0934, device='cuda:3')
compute distance is  tensor(154.0934, device='cuda:3')
compute norm is  tensor(45.7152, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.8481, device='cuda:3')
compute distance is  tensor(165.8481, device='cuda:3')
compute norm is  tensor(46.2941, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.3924, device='cuda:3')
compute distance is  tensor(148.3924, device='cuda:3')
compute norm is  tensor(45.5285, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.0902, device='cuda:3')
compute distance is  tensor(161.0902, device='cuda:3')
compute norm is  tensor(45.8258, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.2230, device='cuda:3')
compute distance is  tensor(165.2230, device='cuda:3')
compute norm is  tensor(45.9162, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.0460, device='cuda:3')
compute distance is  tensor(154.0460, device='cuda:3')
compute norm is  tensor(45.7565, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.9058, device='cuda:3')
compute distance is  tensor(161.9058, device='cuda:3')
compute norm is  tensor(45.8879, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.0384, device='cuda:3')
compute distance is  tensor(162.0384, device='cuda:3')
compute norm is  tensor(46.0133, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(165.8481, device='cuda:3')
distance x is tensor(106139.5391, device='cuda:3')
distance x is tensor(106139.5391, device='cuda:3')
________________________________
test distance is  tensor(106139.5391, device='cuda:3')
test distance1 is  tensor(106139.5391, device='cuda:3')
test similarity is  tensor(0.1347, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139285973967599.08
test entropy is  0.0
________________________________
cal ratio is  0.0387384932918646
distance x is tensor(4111.6909, device='cuda:3')
cal_distance is  tensor(4111.6909, device='cuda:3')
cal ratio is  0.1968208463417269
distance x is tensor(809.2704, device='cuda:3')
cal_distance is  tensor(809.2704, device='cuda:3')
cal ratio is  0.4436438754409409
distance x is tensor(359.0306, device='cuda:3')
cal_distance is  tensor(359.0306, device='cuda:3')
cal ratio is  0.6660633908949788
distance x is tensor(239.1389, device='cuda:3')
cal_distance is  tensor(239.1389, device='cuda:3')
cal ratio is  0.816124180462508
distance x is tensor(195.1679, device='cuda:3')
cal_distance is  tensor(195.1679, device='cuda:3')
cal ratio is  0.9033937469491289
distance x is tensor(176.3140, device='cuda:3')
cal_distance is  tensor(176.3140, device='cuda:3')
cal ratio is  0.950468938057094
distance x is tensor(167.5812, device='cuda:3')
cal_distance is  tensor(167.5812, device='cuda:3')
cal ratio is  0.9749192192774508
distance x is tensor(163.3783, device='cuda:3')
cal_distance is  tensor(163.3783, device='cuda:3')
distance x is tensor(163.3783, device='cuda:3')
return_distance is  tensor(163.3783, device='cuda:3')
distance x is tensor(163.3683, device='cuda:3')
distance x is tensor(163.3683, device='cuda:3')
________________________________
test distance is  tensor(163.3683, device='cuda:3')
test distance1 is  tensor(163.3683, device='cuda:3')
test similarity is  tensor(0.9284, device='cuda:3')
test acc is  0.10000000015633198
test loss is 1084.8929872167137
test entropy is  0.0
________________________________
0
distance x is tensor(163.3683, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  1084.9030376507528
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9284, device='cuda:3')
compute_distance is  tensor(163.3683, device='cuda:3')
compute_norm is  tensor(47.2465, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(399.3231, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.563795566558838
avg test loss is  2.8508777636200633
avg accuracy is  0.10003333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6345, device='cuda:3')
compute_distance is  tensor(399.3231, device='cuda:3')
compute_norm is  tensor(69.1766, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(398.4352, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8418033719062805
avg test loss is  3.5802430890516432
avg accuracy is  0.1026833334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6342, device='cuda:3')
compute_distance is  tensor(398.4352, device='cuda:3')
compute_norm is  tensor(69.2578, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(396.6051, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5536799430847168
avg test loss is  2.8523826128892553
avg accuracy is  0.10005000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6344, device='cuda:3')
compute_distance is  tensor(396.6051, device='cuda:3')
compute_norm is  tensor(68.5436, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(395.7925, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8418700098991394
avg test loss is  3.574935967225764
avg accuracy is  0.10235000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6342, device='cuda:3')
compute_distance is  tensor(395.7925, device='cuda:3')
compute_norm is  tensor(68.6283, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(394.0251, device='cuda:3')
distance x is tensor(394.0251, device='cuda:3')
________________________________
test distance is  tensor(394.0251, device='cuda:3')
test distance1 is  tensor(394.0251, device='cuda:3')
test similarity is  tensor(0.6343, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8521234615525204
test entropy is  1.5533788204193115
________________________________
cal ratio is  0.6357983646634583
distance x is tensor(250.5230, device='cuda:3')
cal_distance is  tensor(250.5230, device='cuda:3')
cal ratio is  0.7973655991772274
distance x is tensor(199.7588, device='cuda:3')
cal_distance is  tensor(199.7588, device='cuda:3')
cal ratio is  0.8929525638825468
distance x is tensor(178.3753, device='cuda:3')
cal_distance is  tensor(178.3753, device='cuda:3')
cal ratio is  0.9449612324321432
distance x is tensor(168.5578, device='cuda:3')
cal_distance is  tensor(168.5578, device='cuda:3')
cal ratio is  0.9720908891992189
distance x is tensor(163.8536, device='cuda:3')
cal_distance is  tensor(163.8536, device='cuda:3')
distance x is tensor(163.8536, device='cuda:3')
return_distance is  tensor(163.8536, device='cuda:3')
distance x is tensor(163.8505, device='cuda:3')
distance x is tensor(163.8505, device='cuda:3')
________________________________
test distance is  tensor(163.8505, device='cuda:3')
test distance1 is  tensor(163.8505, device='cuda:3')
test similarity is  tensor(0.8875, device='cuda:3')
test acc is  0.10181666682299864
test loss is 2.4566528947114437
test entropy is  2.141183126709863
________________________________
0
distance x is tensor(163.8505, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.1411998439699347
avg test loss is  2.4568335206778067
avg accuracy is  0.2651166668230054
solo acc is  0.10196666682299864
compute similarity  is  tensor(0.8875, device='cuda:3')
compute_distance is  tensor(163.8505, device='cuda:3')
compute_norm is  tensor(50.1483, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(166.5146, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8310351991958456
avg test loss is  3.084975214401034
avg accuracy is  0.1733166668230015
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8862, device='cuda:3')
compute_distance is  tensor(166.5146, device='cuda:3')
compute_norm is  tensor(50.2827, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(167.8293, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9969744239407562
avg test loss is  1.6246253620586923
avg accuracy is  0.2094333334896701
solo acc is  0.21145000015633686
compute similarity  is  tensor(0.8862, device='cuda:3')
compute_distance is  tensor(167.8293, device='cuda:3')
compute_norm is  tensor(50.0802, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(167.8293, device='cuda:3')
distance x is tensor(167.8293, device='cuda:3')
________________________________
test distance is  tensor(167.8293, device='cuda:3')
test distance1 is  tensor(167.8293, device='cuda:3')
test similarity is  tensor(0.8862, device='cuda:3')
test acc is  0.2136833334896703
test loss is 1.6208293121506665
test entropy is  0.9966992209715121
________________________________
cal ratio is  0.9741985250544087
distance x is tensor(163.5008, device='cuda:3')
cal_distance is  tensor(163.5008, device='cuda:3')
distance x is tensor(163.5008, device='cuda:3')
return_distance is  tensor(163.5008, device='cuda:3')
distance x is tensor(163.4990, device='cuda:3')
distance x is tensor(163.4990, device='cuda:3')
________________________________
test distance is  tensor(163.4990, device='cuda:3')
test distance1 is  tensor(163.4990, device='cuda:3')
test similarity is  tensor(0.8910, device='cuda:3')
test acc is  0.1994333334896697
test loss is 1.633025696155613
test entropy is  1.0087158915711874
________________________________
0
distance x is tensor(163.4990, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.009170843467021
avg test loss is  1.633866347229557
avg accuracy is  0.2110833334896701
solo acc is  0.19748333348966954
compute similarity  is  tensor(0.8910, device='cuda:3')
compute_distance is  tensor(163.4990, device='cuda:3')
compute_norm is  tensor(49.8024, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(164.0687, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.5743670999876725
avg test loss is  2.3974974046129662
avg accuracy is  0.15888333348966718
solo acc is  0.10095000015633197
compute similarity  is  tensor(0.8907, device='cuda:3')
compute_distance is  tensor(164.0687, device='cuda:3')
compute_norm is  tensor(49.6127, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(165.5486, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.913633741295414
avg test loss is  1.4905061632839602
avg accuracy is  0.21155000015633676
solo acc is  0.2008666668230031
compute similarity  is  tensor(0.8904, device='cuda:3')
compute_distance is  tensor(165.5486, device='cuda:3')
compute_norm is  tensor(49.3618, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(165.5504, device='cuda:3')
________________________________
test distance is  tensor(165.5504, device='cuda:3')
test similarity is  tensor(0.8904, device='cuda:3')
test acc is  0.21116666682300345
test loss is 1.489717251075102
test entropy is  0.9140933931255137
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2232825756072998
mal norm is  tensor(999.9883, device='cuda:3')
distance x is tensor(165.5504, device='cuda:3')
mal distance is  tensor(165.5504, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([28., 16., 16., 12., 12., 12., 28., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 12., 29., 22., 12., 17., 35., 12., 34.,
        12., 12., 32., 34., 19., 35., 12., 12.])
count_res tensor([3.2683e-04, 2.0081e-09, 2.0081e-09, 3.6780e-11, 3.6780e-11, 3.6780e-11,
        3.2683e-04, 3.6780e-11, 5.9862e-06, 5.9862e-06, 5.9862e-06, 5.9862e-06,
        5.9862e-06, 5.9862e-06, 5.9862e-06, 5.9862e-06, 5.9862e-06, 5.9862e-06,
        5.9862e-06, 5.9862e-06, 3.6780e-11, 8.8843e-04, 8.1014e-07, 3.6780e-11,
        5.4587e-09, 3.5842e-01, 3.6780e-11, 1.3185e-01, 3.6780e-11, 3.6780e-11,
        1.7845e-02, 1.3185e-01, 4.0334e-08, 3.5842e-01, 3.6780e-11, 3.6780e-11])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 89.17% 

Test Accuracy: 88.63% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8989272117614746
distance x is tensor(95.8685, device='cuda:3')
benign distance is  tensor(95.8685, device='cuda:3')
norm1 res is  tensor(427.2401, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2899835705757141
distance x is tensor(97.3959, device='cuda:3')
benign distance is  tensor(97.3959, device='cuda:3')
norm1 res is  tensor(435.8874, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.24554288387298584
distance x is tensor(108.8648, device='cuda:3')
benign distance is  tensor(108.8648, device='cuda:3')
norm1 res is  tensor(480.5304, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.43555527925491333
distance x is tensor(93.7258, device='cuda:3')
benign distance is  tensor(93.7258, device='cuda:3')
norm1 res is  tensor(401.9302, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.25882959365844727
distance x is tensor(95.3515, device='cuda:3')
benign distance is  tensor(95.3515, device='cuda:3')
norm1 res is  tensor(405.8384, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.1380360722541809
distance x is tensor(106.1254, device='cuda:3')
benign distance is  tensor(106.1254, device='cuda:3')
norm1 res is  tensor(476.1344, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.44521769881248474
distance x is tensor(109.9860, device='cuda:3')
benign distance is  tensor(109.9860, device='cuda:3')
norm1 res is  tensor(483.4636, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.16572627425193787
distance x is tensor(103.8243, device='cuda:3')
benign distance is  tensor(103.8243, device='cuda:3')
norm1 res is  tensor(457.1503, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4264088273048401
distance x is tensor(117.7897, device='cuda:3')
benign distance is  tensor(117.7897, device='cuda:3')
norm1 res is  tensor(528.1741, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5229876637458801
distance x is tensor(111.6275, device='cuda:3')
benign distance is  tensor(111.6275, device='cuda:3')
norm1 res is  tensor(494.0730, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.49685320258140564
distance x is tensor(120.9712, device='cuda:3')
benign distance is  tensor(120.9712, device='cuda:3')
norm1 res is  tensor(530.8417, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9362947344779968
distance x is tensor(112.9941, device='cuda:3')
benign distance is  tensor(112.9941, device='cuda:3')
norm1 res is  tensor(495.4534, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7281599640846252
distance x is tensor(113.8744, device='cuda:3')
benign distance is  tensor(113.8744, device='cuda:3')
norm1 res is  tensor(507.9520, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.020956555381417274
distance x is tensor(98.2889, device='cuda:3')
benign distance is  tensor(98.2889, device='cuda:3')
norm1 res is  tensor(443.6976, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5214201211929321
distance x is tensor(123.3575, device='cuda:3')
benign distance is  tensor(123.3575, device='cuda:3')
norm1 res is  tensor(557.0129, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5072146058082581
distance x is tensor(119.8914, device='cuda:3')
benign distance is  tensor(119.8914, device='cuda:3')
norm1 res is  tensor(528.7305, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3080799877643585
distance x is tensor(118.6432, device='cuda:3')
benign distance is  tensor(118.6432, device='cuda:3')
norm1 res is  tensor(524.1721, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.46988654136657715
distance x is tensor(102.8683, device='cuda:3')
benign distance is  tensor(102.8683, device='cuda:3')
norm1 res is  tensor(444.0226, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3318251967430115
distance x is tensor(116.5711, device='cuda:3')
benign distance is  tensor(116.5711, device='cuda:3')
norm1 res is  tensor(523.1768, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.32386866211891174
distance x is tensor(122.3328, device='cuda:3')
benign distance is  tensor(122.3328, device='cuda:3')
norm1 res is  tensor(534.6898, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6599569320678711
distance x is tensor(85.7627, device='cuda:3')
benign distance is  tensor(85.7627, device='cuda:3')
norm1 res is  tensor(375.6995, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8249643445014954
distance x is tensor(89.2388, device='cuda:3')
benign distance is  tensor(89.2388, device='cuda:3')
norm1 res is  tensor(405.9314, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5809102654457092
distance x is tensor(112.7286, device='cuda:3')
benign distance is  tensor(112.7286, device='cuda:3')
norm1 res is  tensor(522.3977, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.16899506747722626
distance x is tensor(114.2681, device='cuda:3')
benign distance is  tensor(114.2681, device='cuda:3')
norm1 res is  tensor(518.0307, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(102.1063, device='cuda:3')
compute distance is  tensor(102.1063, device='cuda:3')
compute norm is  tensor(46.6661, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.4574, device='cuda:3')
compute distance is  tensor(100.4574, device='cuda:3')
compute norm is  tensor(46.6831, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.7140, device='cuda:3')
compute distance is  tensor(104.7140, device='cuda:3')
compute norm is  tensor(46.8795, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.9367, device='cuda:3')
compute distance is  tensor(102.9367, device='cuda:3')
compute norm is  tensor(46.7850, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.6120, device='cuda:3')
compute distance is  tensor(100.6120, device='cuda:3')
compute norm is  tensor(46.6997, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.7133, device='cuda:3')
compute distance is  tensor(102.7133, device='cuda:3')
compute norm is  tensor(46.8588, device='cuda:3', dtype=torch.float64)
distance x is tensor(93.3730, device='cuda:3')
compute distance is  tensor(93.3730, device='cuda:3')
compute norm is  tensor(46.7416, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.5550, device='cuda:3')
compute distance is  tensor(99.5550, device='cuda:3')
compute norm is  tensor(46.6675, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.2755, device='cuda:3')
compute distance is  tensor(109.2755, device='cuda:3')
compute norm is  tensor(46.8949, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.2235, device='cuda:3')
compute distance is  tensor(105.2235, device='cuda:3')
compute norm is  tensor(46.8756, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.6982, device='cuda:3')
compute distance is  tensor(103.6982, device='cuda:3')
compute norm is  tensor(46.8483, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.8144, device='cuda:3')
compute distance is  tensor(102.8144, device='cuda:3')
compute norm is  tensor(46.7483, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(109.2755, device='cuda:3')
distance x is tensor(106205.9922, device='cuda:3')
distance x is tensor(106205.9922, device='cuda:3')
________________________________
test distance is  tensor(106205.9922, device='cuda:3')
test distance1 is  tensor(106205.9922, device='cuda:3')
test similarity is  tensor(-0.1021, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139282985271121.33
test entropy is  0.0
________________________________
cal ratio is  0.03143496713254812
distance x is tensor(3338.5872, device='cuda:3')
cal_distance is  tensor(3338.5872, device='cuda:3')
cal ratio is  0.17729894844763042
distance x is tensor(591.9321, device='cuda:3')
cal_distance is  tensor(591.9321, device='cuda:3')
cal ratio is  0.42106735944413987
distance x is tensor(249.2462, device='cuda:3')
cal_distance is  tensor(249.2462, device='cuda:3')
cal ratio is  0.6488932344953271
distance x is tensor(161.7359, device='cuda:3')
cal_distance is  tensor(161.7359, device='cuda:3')
cal ratio is  0.8055346869370839
distance x is tensor(130.2849, device='cuda:3')
cal_distance is  tensor(130.2849, device='cuda:3')
cal ratio is  0.8975124389216798
distance x is tensor(116.9328, device='cuda:3')
cal_distance is  tensor(116.9328, device='cuda:3')
cal ratio is  0.9473691873534419
distance x is tensor(110.7788, device='cuda:3')
cal_distance is  tensor(110.7788, device='cuda:3')
cal ratio is  0.973327776779248
distance x is tensor(107.8243, device='cuda:3')
cal_distance is  tensor(107.8243, device='cuda:3')
distance x is tensor(107.8243, device='cuda:3')
return_distance is  tensor(107.8243, device='cuda:3')
distance x is tensor(107.8143, device='cuda:3')
distance x is tensor(107.8143, device='cuda:3')
________________________________
test distance is  tensor(107.8143, device='cuda:3')
test distance1 is  tensor(107.8143, device='cuda:3')
test similarity is  tensor(0.9638, device='cuda:3')
test acc is  0.10000000015633198
test loss is 199.09701074466014
test entropy is  4.203807886435943e-27
________________________________
0
distance x is tensor(107.8143, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  6.028512357579098e-25
avg test loss is  199.11615242378545
avg accuracy is  0.5605833334896743
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9638, device='cuda:3')
compute_distance is  tensor(107.8143, device='cuda:3')
compute_norm is  tensor(45.6864, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(98.8354, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8312986288497697
avg test loss is  1.3338638314051923
avg accuracy is  0.8671666668229893
solo acc is  0.32490000015633996
compute similarity  is  tensor(0.9664, device='cuda:3')
compute_distance is  tensor(98.8354, device='cuda:3')
compute_norm is  tensor(44.5075, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(101.5972, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8130063484472506
avg test loss is  1.3507813806218634
avg accuracy is  0.8683666668229892
solo acc is  0.27195000015633886
compute similarity  is  tensor(0.9658, device='cuda:3')
compute_distance is  tensor(101.5972, device='cuda:3')
compute_norm is  tensor(44.2185, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(104.0392, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7909331049746288
avg test loss is  1.336176893032436
avg accuracy is  0.8693000001563226
solo acc is  0.2581666668230051
compute similarity  is  tensor(0.9652, device='cuda:3')
compute_distance is  tensor(104.0392, device='cuda:3')
compute_norm is  tensor(43.9559, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(106.2856, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7867225400928749
avg test loss is  1.3130515797941416
avg accuracy is  0.8718166668229892
solo acc is  0.2505833334896716
compute similarity  is  tensor(0.9647, device='cuda:3')
compute_distance is  tensor(106.2856, device='cuda:3')
compute_norm is  tensor(43.7046, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(108.3835, device='cuda:3')
distance x is tensor(108.3835, device='cuda:3')
________________________________
test distance is  tensor(108.3835, device='cuda:3')
test distance1 is  tensor(108.3835, device='cuda:3')
test similarity is  tensor(0.9643, device='cuda:3')
test acc is  0.24826666682300488
test loss is 1.286888506049032
test entropy is  0.7894625548106521
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.1593900918960571
mal norm is  tensor(539.8497, device='cuda:3')
distance x is tensor(108.3899, device='cuda:3')
mal distance is  tensor(108.3899, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([12., 24., 12., 18., 13., 17., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 14., 12., 22., 12., 12., 27., 12.])
count_res tensor([2.8943e-07, 4.7107e-02, 2.8943e-07, 1.1677e-04, 7.8676e-07, 4.2956e-05,
        2.8943e-07, 2.8943e-07, 1.5803e-05, 1.5803e-05, 1.5803e-05, 1.5803e-05,
        1.5803e-05, 1.5803e-05, 1.5803e-05, 1.5803e-05, 1.5803e-05, 1.5803e-05,
        1.5803e-05, 1.5803e-05, 2.8943e-07, 2.1386e-06, 2.8943e-07, 6.3752e-03,
        2.8943e-07, 2.8943e-07, 9.4616e-01, 2.8943e-07])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 86.67% 

Test Accuracy: 86.25% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.569419801235199
distance x is tensor(117.2571, device='cuda:3')
benign distance is  tensor(117.2571, device='cuda:3')
norm1 res is  tensor(498.5743, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.41332751512527466
distance x is tensor(111.3859, device='cuda:3')
benign distance is  tensor(111.3859, device='cuda:3')
norm1 res is  tensor(480.7435, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.09998969733715057
distance x is tensor(119.3466, device='cuda:3')
benign distance is  tensor(119.3466, device='cuda:3')
norm1 res is  tensor(500.7658, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7445881962776184
distance x is tensor(115.8058, device='cuda:3')
benign distance is  tensor(115.8058, device='cuda:3')
norm1 res is  tensor(477.0996, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8303735852241516
distance x is tensor(105.3310, device='cuda:3')
benign distance is  tensor(105.3310, device='cuda:3')
norm1 res is  tensor(457.1111, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5078726410865784
distance x is tensor(122.9388, device='cuda:3')
benign distance is  tensor(122.9388, device='cuda:3')
norm1 res is  tensor(534.2627, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.49101752042770386
distance x is tensor(112.3020, device='cuda:3')
benign distance is  tensor(112.3020, device='cuda:3')
norm1 res is  tensor(474.8372, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.35419148206710815
distance x is tensor(111.8623, device='cuda:3')
benign distance is  tensor(111.8623, device='cuda:3')
norm1 res is  tensor(477.1286, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.25818371772766113
distance x is tensor(131.0726, device='cuda:3')
benign distance is  tensor(131.0726, device='cuda:3')
norm1 res is  tensor(554.3138, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4319738447666168
distance x is tensor(142.1631, device='cuda:3')
benign distance is  tensor(142.1631, device='cuda:3')
norm1 res is  tensor(590.7494, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8485830426216125
distance x is tensor(130.1765, device='cuda:3')
benign distance is  tensor(130.1765, device='cuda:3')
norm1 res is  tensor(538.7744, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.16777047514915466
distance x is tensor(129.7113, device='cuda:3')
benign distance is  tensor(129.7113, device='cuda:3')
norm1 res is  tensor(573.9476, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.2598205804824829
distance x is tensor(118.4775, device='cuda:3')
benign distance is  tensor(118.4775, device='cuda:3')
norm1 res is  tensor(491.6959, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7108325958251953
distance x is tensor(123.9977, device='cuda:3')
benign distance is  tensor(123.9977, device='cuda:3')
norm1 res is  tensor(522.2234, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2187422215938568
distance x is tensor(87.1670, device='cuda:3')
benign distance is  tensor(87.1670, device='cuda:3')
norm1 res is  tensor(361.2489, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4004046320915222
distance x is tensor(113.3516, device='cuda:3')
benign distance is  tensor(113.3516, device='cuda:3')
norm1 res is  tensor(476.8965, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(111.6783, device='cuda:3')
compute distance is  tensor(111.6783, device='cuda:3')
compute norm is  tensor(47.6382, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.0944, device='cuda:3')
compute distance is  tensor(126.0944, device='cuda:3')
compute norm is  tensor(48.0345, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.9915, device='cuda:3')
compute distance is  tensor(126.9915, device='cuda:3')
compute norm is  tensor(48.0756, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.3228, device='cuda:3')
compute distance is  tensor(123.3228, device='cuda:3')
compute norm is  tensor(47.9444, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.8336, device='cuda:3')
compute distance is  tensor(117.8336, device='cuda:3')
compute norm is  tensor(47.8022, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.0901, device='cuda:3')
compute distance is  tensor(121.0901, device='cuda:3')
compute norm is  tensor(47.9588, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.5334, device='cuda:3')
compute distance is  tensor(110.5334, device='cuda:3')
compute norm is  tensor(47.8463, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.8079, device='cuda:3')
compute distance is  tensor(112.8079, device='cuda:3')
compute norm is  tensor(47.7175, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.2571, device='cuda:3')
compute distance is  tensor(118.2571, device='cuda:3')
compute norm is  tensor(47.7714, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.6221, device='cuda:3')
compute distance is  tensor(117.6221, device='cuda:3')
compute norm is  tensor(47.9032, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.1777, device='cuda:3')
compute distance is  tensor(126.1777, device='cuda:3')
compute norm is  tensor(48.0334, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.0616, device='cuda:3')
compute distance is  tensor(126.0616, device='cuda:3')
compute norm is  tensor(47.9770, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(126.9915, device='cuda:3')
distance x is tensor(106212.2891, device='cuda:3')
distance x is tensor(106212.2891, device='cuda:3')
________________________________
test distance is  tensor(106212.2891, device='cuda:3')
test distance1 is  tensor(106212.2891, device='cuda:3')
test similarity is  tensor(-0.1006, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139285864307565.72
test entropy is  0.0
________________________________
cal ratio is  0.03388645165143023
distance x is tensor(3599.1626, device='cuda:3')
cal_distance is  tensor(3599.1626, device='cuda:3')
cal ratio is  0.18408260185092554
distance x is tensor(662.5472, device='cuda:3')
cal_distance is  tensor(662.5472, device='cuda:3')
cal ratio is  0.4290471835156664
distance x is tensor(284.2669, device='cuda:3')
cal_distance is  tensor(284.2669, device='cuda:3')
cal ratio is  0.6550136098830925
distance x is tensor(186.2004, device='cuda:3')
cal_distance is  tensor(186.2004, device='cuda:3')
cal ratio is  0.8093254386574026
distance x is tensor(150.6977, device='cuda:3')
cal_distance is  tensor(150.6977, device='cuda:3')
cal ratio is  0.8996221968366109
distance x is tensor(135.5715, device='cuda:3')
cal_distance is  tensor(135.5715, device='cuda:3')
cal ratio is  0.948482338022998
distance x is tensor(128.5874, device='cuda:3')
cal_distance is  tensor(128.5874, device='cuda:3')
cal ratio is  0.973899623775478
distance x is tensor(125.2314, device='cuda:3')
cal_distance is  tensor(125.2314, device='cuda:3')
distance x is tensor(125.2314, device='cuda:3')
return_distance is  tensor(125.2314, device='cuda:3')
distance x is tensor(125.2214, device='cuda:3')
distance x is tensor(125.2214, device='cuda:3')
________________________________
test distance is  tensor(125.2214, device='cuda:3')
test distance1 is  tensor(125.2214, device='cuda:3')
test similarity is  tensor(0.9542, device='cuda:3')
test acc is  0.10000000015633198
test loss is 359.2589083348256
test entropy is  3.9083585309902256e-35
________________________________
0
distance x is tensor(125.2214, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  4.280420363631187e-33
avg test loss is  359.30125284093276
avg accuracy is  0.24655000015633816
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9542, device='cuda:3')
compute_distance is  tensor(125.2214, device='cuda:3')
compute_norm is  tensor(46.8878, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(113.0105, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8273958715040293
avg test loss is  1.3928289079208618
avg accuracy is  0.8373833334896572
solo acc is  0.30271666682300624
compute similarity  is  tensor(0.9586, device='cuda:3')
compute_distance is  tensor(113.0105, device='cuda:3')
compute_norm is  tensor(45.7156, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.7383, device='cuda:3')
exit early
distance x is tensor(115.7383, device='cuda:3')
distance x is tensor(115.7383, device='cuda:3')
________________________________
test distance is  tensor(115.7383, device='cuda:3')
test distance1 is  tensor(115.7383, device='cuda:3')
test similarity is  tensor(0.9579, device='cuda:3')
test acc is  0.25840000015633846
test loss is 1.3918667037222685
test entropy is  0.8157051536065938
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2635166645050049
mal norm is  tensor(603.1853, device='cuda:3')
distance x is tensor(115.7447, device='cuda:3')
mal distance is  tensor(115.7447, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 35., 35., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 35., 14., 12., 12., 34., 12., 12., 12.,
        12., 12., 33., 33., 21., 35., 13., 12.])
count_res tensor([2.2122e-11, 2.2122e-11, 2.2122e-11, 2.2122e-11, 2.2122e-11, 2.2122e-11,
        2.1558e-01, 2.1558e-01, 3.6005e-06, 3.6005e-06, 3.6005e-06, 3.6005e-06,
        3.6005e-06, 3.6005e-06, 3.6005e-06, 3.6005e-06, 3.6005e-06, 3.6005e-06,
        3.6005e-06, 3.6005e-06, 2.1558e-01, 1.6346e-10, 2.2122e-11, 2.2122e-11,
        7.9306e-02, 2.2122e-11, 2.2122e-11, 2.2122e-11, 2.2122e-11, 2.2122e-11,
        2.9175e-02, 2.9175e-02, 1.7926e-07, 2.1558e-01, 6.0134e-11, 2.2122e-11])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 89.36% 

Test Accuracy: 88.68% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6673632860183716
distance x is tensor(93.5849, device='cuda:3')
benign distance is  tensor(93.5849, device='cuda:3')
norm1 res is  tensor(414.6139, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5322455167770386
distance x is tensor(97.6413, device='cuda:3')
benign distance is  tensor(97.6413, device='cuda:3')
norm1 res is  tensor(430.4980, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.09923557937145233
distance x is tensor(103.2909, device='cuda:3')
benign distance is  tensor(103.2909, device='cuda:3')
norm1 res is  tensor(445.4332, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.263522207736969
distance x is tensor(96.5758, device='cuda:3')
benign distance is  tensor(96.5758, device='cuda:3')
norm1 res is  tensor(420.1105, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3431132435798645
distance x is tensor(86.3898, device='cuda:3')
benign distance is  tensor(86.3898, device='cuda:3')
norm1 res is  tensor(366.7118, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.25593993067741394
distance x is tensor(99.7948, device='cuda:3')
benign distance is  tensor(99.7948, device='cuda:3')
norm1 res is  tensor(441.9047, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.24244984984397888
distance x is tensor(83.7794, device='cuda:3')
benign distance is  tensor(83.7794, device='cuda:3')
norm1 res is  tensor(364.4825, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4049246311187744
distance x is tensor(94.9659, device='cuda:3')
benign distance is  tensor(94.9659, device='cuda:3')
norm1 res is  tensor(417.9454, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.407419353723526
distance x is tensor(128.9202, device='cuda:3')
benign distance is  tensor(128.9202, device='cuda:3')
norm1 res is  tensor(560.2552, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.2454885244369507
distance x is tensor(122.5009, device='cuda:3')
benign distance is  tensor(122.5009, device='cuda:3')
norm1 res is  tensor(525.7924, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.24536705017089844
distance x is tensor(101.2800, device='cuda:3')
benign distance is  tensor(101.2800, device='cuda:3')
norm1 res is  tensor(446.7119, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5704134106636047
distance x is tensor(106.2321, device='cuda:3')
benign distance is  tensor(106.2321, device='cuda:3')
norm1 res is  tensor(464.8493, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6000087857246399
distance x is tensor(105.3015, device='cuda:3')
benign distance is  tensor(105.3015, device='cuda:3')
norm1 res is  tensor(462.6496, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5931569933891296
distance x is tensor(104.6646, device='cuda:3')
benign distance is  tensor(104.6646, device='cuda:3')
norm1 res is  tensor(467.8875, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5002748966217041
distance x is tensor(114.2930, device='cuda:3')
benign distance is  tensor(114.2930, device='cuda:3')
norm1 res is  tensor(501.7423, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8638578653335571
distance x is tensor(118.4530, device='cuda:3')
benign distance is  tensor(118.4530, device='cuda:3')
norm1 res is  tensor(518.4493, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.5185008645057678
distance x is tensor(112.2475, device='cuda:3')
benign distance is  tensor(112.2475, device='cuda:3')
norm1 res is  tensor(494.8218, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.045605696737766266
distance x is tensor(114.1380, device='cuda:3')
benign distance is  tensor(114.1380, device='cuda:3')
norm1 res is  tensor(503.8479, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.20242102444171906
distance x is tensor(78.9246, device='cuda:3')
benign distance is  tensor(78.9246, device='cuda:3')
norm1 res is  tensor(348.0010, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.19559693336486816
distance x is tensor(118.2996, device='cuda:3')
benign distance is  tensor(118.2996, device='cuda:3')
norm1 res is  tensor(510.7948, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6326103806495667
distance x is tensor(104.2067, device='cuda:3')
benign distance is  tensor(104.2067, device='cuda:3')
norm1 res is  tensor(466.4309, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.26279884576797485
distance x is tensor(113.0126, device='cuda:3')
benign distance is  tensor(113.0126, device='cuda:3')
norm1 res is  tensor(483.1275, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.5040979385375977
distance x is tensor(104.3341, device='cuda:3')
benign distance is  tensor(104.3341, device='cuda:3')
norm1 res is  tensor(462.9003, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.2090548276901245
distance x is tensor(109.9810, device='cuda:3')
benign distance is  tensor(109.9810, device='cuda:3')
norm1 res is  tensor(491.0598, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(99.3095, device='cuda:3')
compute distance is  tensor(99.3095, device='cuda:3')
compute norm is  tensor(47.1445, device='cuda:3', dtype=torch.float64)
distance x is tensor(92.3711, device='cuda:3')
compute distance is  tensor(92.3711, device='cuda:3')
compute norm is  tensor(47.0788, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.7817, device='cuda:3')
compute distance is  tensor(104.7817, device='cuda:3')
compute norm is  tensor(47.4563, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.1782, device='cuda:3')
compute distance is  tensor(98.1782, device='cuda:3')
compute norm is  tensor(47.2965, device='cuda:3', dtype=torch.float64)
distance x is tensor(96.2146, device='cuda:3')
compute distance is  tensor(96.2146, device='cuda:3')
compute norm is  tensor(47.1818, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.8259, device='cuda:3')
compute distance is  tensor(106.8259, device='cuda:3')
compute norm is  tensor(47.4201, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.1096, device='cuda:3')
compute distance is  tensor(99.1096, device='cuda:3')
compute norm is  tensor(47.3033, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.8049, device='cuda:3')
compute distance is  tensor(105.8049, device='cuda:3')
compute norm is  tensor(47.3453, device='cuda:3', dtype=torch.float64)
distance x is tensor(96.6142, device='cuda:3')
compute distance is  tensor(96.6142, device='cuda:3')
compute norm is  tensor(47.2420, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.1122, device='cuda:3')
compute distance is  tensor(101.1122, device='cuda:3')
compute norm is  tensor(47.3482, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.8907, device='cuda:3')
compute distance is  tensor(104.8907, device='cuda:3')
compute norm is  tensor(47.4761, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.9035, device='cuda:3')
compute distance is  tensor(98.9035, device='cuda:3')
compute norm is  tensor(47.2630, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(106.8259, device='cuda:3')
distance x is tensor(106209.6484, device='cuda:3')
distance x is tensor(106209.6484, device='cuda:3')
________________________________
test distance is  tensor(106209.6484, device='cuda:3')
test distance1 is  tensor(106209.6484, device='cuda:3')
test similarity is  tensor(-0.1013, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139277938906336.89
test entropy is  0.0
________________________________
cal ratio is  0.031080091459177575
distance x is tensor(3301.0115, device='cuda:3')
cal_distance is  tensor(3301.0115, device='cuda:3')
cal ratio is  0.17629530525607473
distance x is tensor(581.9569, device='cuda:3')
cal_distance is  tensor(581.9569, device='cuda:3')
cal ratio is  0.41987387531694315
distance x is tensor(244.3514, device='cuda:3')
cal_distance is  tensor(244.3514, device='cuda:3')
cal ratio is  0.6479729274617855
distance x is tensor(158.3349, device='cuda:3')
cal_distance is  tensor(158.3349, device='cuda:3')
cal ratio is  0.8049630962081311
distance x is tensor(127.4547, device='cuda:3')
cal_distance is  tensor(127.4547, device='cuda:3')
cal ratio is  0.8971939235365625
distance x is tensor(114.3521, device='cuda:3')
cal_distance is  tensor(114.3521, device='cuda:3')
cal ratio is  0.9472010715032128
distance x is tensor(108.3147, device='cuda:3')
cal_distance is  tensor(108.3147, device='cuda:3')
cal ratio is  0.9732412002316558
distance x is tensor(105.4165, device='cuda:3')
cal_distance is  tensor(105.4165, device='cuda:3')
distance x is tensor(105.4165, device='cuda:3')
return_distance is  tensor(105.4165, device='cuda:3')
distance x is tensor(105.4065, device='cuda:3')
distance x is tensor(105.4065, device='cuda:3')
________________________________
test distance is  tensor(105.4065, device='cuda:3')
test distance1 is  tensor(105.4065, device='cuda:3')
test similarity is  tensor(0.9662, device='cuda:3')
test acc is  0.10000000015633198
test loss is 171.0381847454795
test entropy is  1.2831288000787616e-22
________________________________
0
distance x is tensor(105.4065, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.2031022205499048e-23
avg test loss is  171.03589306406374
avg accuracy is  0.6415166668230011
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9662, device='cuda:3')
compute_distance is  tensor(105.4065, device='cuda:3')
compute_norm is  tensor(46.1931, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(98.4705, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7860877691809811
avg test loss is  1.425049830347236
avg accuracy is  0.8652333334896559
solo acc is  0.2941000001563394
compute similarity  is  tensor(0.9683, device='cuda:3')
compute_distance is  tensor(98.4705, device='cuda:3')
compute_norm is  tensor(45.0303, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(101.3047, device='cuda:3')
exit early
distance x is tensor(101.3047, device='cuda:3')
distance x is tensor(101.3047, device='cuda:3')
________________________________
test distance is  tensor(101.3047, device='cuda:3')
test distance1 is  tensor(101.3047, device='cuda:3')
test similarity is  tensor(0.9676, device='cuda:3')
test acc is  0.2412000001563379
test loss is 1.428429970482011
test entropy is  0.7717673718166758
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.5206316709518433
mal norm is  tensor(520.9265, device='cuda:3')
distance x is tensor(101.3112, device='cuda:3')
mal distance is  tensor(101.3112, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 20.97% 

Test Accuracy: 19.74% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5875001549720764
distance x is tensor(143.1391, device='cuda:3')
benign distance is  tensor(143.1391, device='cuda:3')
norm1 res is  tensor(573.8886, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8602437973022461
distance x is tensor(152.1662, device='cuda:3')
benign distance is  tensor(152.1662, device='cuda:3')
norm1 res is  tensor(610.2836, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.19329023361206055
distance x is tensor(156.9016, device='cuda:3')
benign distance is  tensor(156.9016, device='cuda:3')
norm1 res is  tensor(621.2853, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2940642833709717
distance x is tensor(150.2937, device='cuda:3')
benign distance is  tensor(150.2937, device='cuda:3')
norm1 res is  tensor(592.9438, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9846259951591492
distance x is tensor(149.6798, device='cuda:3')
benign distance is  tensor(149.6798, device='cuda:3')
norm1 res is  tensor(576.3397, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8865402340888977
distance x is tensor(154.2868, device='cuda:3')
benign distance is  tensor(154.2868, device='cuda:3')
norm1 res is  tensor(609.5052, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3818889856338501
distance x is tensor(132.1865, device='cuda:3')
benign distance is  tensor(132.1865, device='cuda:3')
norm1 res is  tensor(522.5530, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4946584701538086
distance x is tensor(147.0674, device='cuda:3')
benign distance is  tensor(147.0674, device='cuda:3')
norm1 res is  tensor(576.7192, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(152.4432, device='cuda:3')
compute distance is  tensor(152.4432, device='cuda:3')
compute norm is  tensor(46.6390, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.3557, device='cuda:3')
compute distance is  tensor(152.3557, device='cuda:3')
compute norm is  tensor(46.6599, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.7363, device='cuda:3')
compute distance is  tensor(142.7363, device='cuda:3')
compute norm is  tensor(46.5484, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.1078, device='cuda:3')
compute distance is  tensor(143.1078, device='cuda:3')
compute norm is  tensor(46.5146, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.1394, device='cuda:3')
compute distance is  tensor(150.1394, device='cuda:3')
compute norm is  tensor(46.6442, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.4986, device='cuda:3')
compute distance is  tensor(164.4986, device='cuda:3')
compute norm is  tensor(46.9668, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.5477, device='cuda:3')
compute distance is  tensor(155.5477, device='cuda:3')
compute norm is  tensor(46.6342, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.5485, device='cuda:3')
compute distance is  tensor(152.5485, device='cuda:3')
compute norm is  tensor(46.6425, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.0775, device='cuda:3')
compute distance is  tensor(142.0775, device='cuda:3')
compute norm is  tensor(46.4653, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.7358, device='cuda:3')
compute distance is  tensor(146.7358, device='cuda:3')
compute norm is  tensor(46.7462, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.1059, device='cuda:3')
compute distance is  tensor(156.1059, device='cuda:3')
compute norm is  tensor(46.7567, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.9965, device='cuda:3')
compute distance is  tensor(142.9965, device='cuda:3')
compute norm is  tensor(46.4888, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(164.4986, device='cuda:3')
distance x is tensor(106147.3047, device='cuda:3')
distance x is tensor(106147.3047, device='cuda:3')
________________________________
test distance is  tensor(106147.3047, device='cuda:3')
test distance1 is  tensor(106147.3047, device='cuda:3')
test similarity is  tensor(0.1177, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139288916526732.83
test entropy is  0.0
________________________________
cal ratio is  0.03857915870627027
distance x is tensor(4095.0784, device='cuda:3')
cal_distance is  tensor(4095.0784, device='cuda:3')
cal ratio is  0.19641566434176472
distance x is tensor(804.3416, device='cuda:3')
cal_distance is  tensor(804.3416, device='cuda:3')
cal ratio is  0.44318694714721657
distance x is tensor(356.4765, device='cuda:3')
cal_distance is  tensor(356.4765, device='cuda:3')
cal ratio is  0.6657202776384717
distance x is tensor(237.3153, device='cuda:3')
cal_distance is  tensor(237.3153, device='cuda:3')
cal ratio is  0.8159139388418067
distance x is tensor(193.6298, device='cuda:3')
cal_distance is  tensor(193.6298, device='cuda:3')
cal ratio is  0.9032773997804295
distance x is tensor(174.9019, device='cuda:3')
cal_distance is  tensor(174.9019, device='cuda:3')
cal ratio is  0.950407654672018
distance x is tensor(166.2284, device='cuda:3')
cal_distance is  tensor(166.2284, device='cuda:3')
cal ratio is  0.9748878639121807
distance x is tensor(162.0542, device='cuda:3')
cal_distance is  tensor(162.0542, device='cuda:3')
distance x is tensor(162.0542, device='cuda:3')
return_distance is  tensor(162.0542, device='cuda:3')
distance x is tensor(162.0442, device='cuda:3')
distance x is tensor(162.0442, device='cuda:3')
________________________________
test distance is  tensor(162.0442, device='cuda:3')
test distance1 is  tensor(162.0442, device='cuda:3')
test similarity is  tensor(0.9313, device='cuda:3')
test acc is  0.10000000015633198
test loss is 1102.0649330122892
test entropy is  0.0
________________________________
0
distance x is tensor(162.0442, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  1102.021074372314
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9313, device='cuda:3')
compute_distance is  tensor(162.0442, device='cuda:3')
compute_norm is  tensor(48.1421, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(374.1717, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5621732473373413
avg test loss is  2.849830727333199
avg accuracy is  0.11308333348966527
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7066, device='cuda:3')
compute_distance is  tensor(374.1717, device='cuda:3')
compute_norm is  tensor(65.2355, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(373.3821, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8394233584403992
avg test loss is  3.5814800913145803
avg accuracy is  0.10733333348966528
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7064, device='cuda:3')
compute_distance is  tensor(373.3821, device='cuda:3')
compute_norm is  tensor(65.3171, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(371.7563, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5538208484649658
avg test loss is  2.85202246078296
avg accuracy is  0.11291666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7066, device='cuda:3')
compute_distance is  tensor(371.7563, device='cuda:3')
compute_norm is  tensor(64.6412, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(371.0360, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8390583395957947
avg test loss is  3.57844418732088
avg accuracy is  0.10658333348966528
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7063, device='cuda:3')
compute_distance is  tensor(371.0360, device='cuda:3')
compute_norm is  tensor(64.7253, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(369.4565, device='cuda:3')
distance x is tensor(369.4565, device='cuda:3')
________________________________
test distance is  tensor(369.4565, device='cuda:3')
test distance1 is  tensor(369.4565, device='cuda:3')
test similarity is  tensor(0.7065, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.851931568910318
test entropy is  1.553593635559082
________________________________
cal ratio is  0.6539214752776483
distance x is tensor(241.5982, device='cuda:3')
cal_distance is  tensor(241.5982, device='cuda:3')
cal ratio is  0.8086496766288288
distance x is tensor(195.3686, device='cuda:3')
cal_distance is  tensor(195.3686, device='cuda:3')
cal ratio is  0.8992487933909317
distance x is tensor(175.6851, device='cuda:3')
cal_distance is  tensor(175.6851, device='cuda:3')
cal ratio is  0.9482868930072365
distance x is tensor(166.6000, device='cuda:3')
cal_distance is  tensor(166.6000, device='cuda:3')
cal ratio is  0.9737999598304888
distance x is tensor(162.2351, device='cuda:3')
cal_distance is  tensor(162.2351, device='cuda:3')
distance x is tensor(162.2351, device='cuda:3')
return_distance is  tensor(162.2351, device='cuda:3')
distance x is tensor(162.2319, device='cuda:3')
distance x is tensor(162.2319, device='cuda:3')
________________________________
test distance is  tensor(162.2319, device='cuda:3')
test distance1 is  tensor(162.2319, device='cuda:3')
test similarity is  tensor(0.9121, device='cuda:3')
test acc is  0.13675000015633193
test loss is 2.447279149027013
test entropy is  2.106808737142762
________________________________
0
distance x is tensor(162.2319, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.106873053731695
avg test loss is  2.446201721488286
avg accuracy is  0.2286333334896708
solo acc is  0.13758333348966537
compute similarity  is  tensor(0.9121, device='cuda:3')
compute_distance is  tensor(162.2319, device='cuda:3')
compute_norm is  tensor(50.1264, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(164.2481, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7471792355402193
avg test loss is  2.961877300286852
avg accuracy is  0.10676666682299862
solo acc is  0.1006333334896653
compute similarity  is  tensor(0.9112, device='cuda:3')
compute_distance is  tensor(164.2481, device='cuda:3')
compute_norm is  tensor(50.1731, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(166.4768, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.1499644559837863
avg test loss is  1.7920174480501267
avg accuracy is  0.11863333348966526
solo acc is  0.16580000015633442
compute similarity  is  tensor(0.9109, device='cuda:3')
compute_distance is  tensor(166.4768, device='cuda:3')
compute_norm is  tensor(49.9626, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(166.8659, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6504444650876751
avg test loss is  2.5589810764865835
avg accuracy is  0.10406666682299862
solo acc is  0.10018333348966532
compute similarity  is  tensor(0.9106, device='cuda:3')
compute_distance is  tensor(166.8659, device='cuda:3')
compute_norm is  tensor(49.8018, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(168.5083, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0422353823937334
avg test loss is  1.562468090545394
avg accuracy is  0.11365000015633193
solo acc is  0.2107166668230035
compute similarity  is  tensor(0.9102, device='cuda:3')
compute_distance is  tensor(168.5083, device='cuda:3')
compute_norm is  tensor(49.5541, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(168.8461, device='cuda:3')
distance x is tensor(168.8461, device='cuda:3')
________________________________
test distance is  tensor(168.8461, device='cuda:3')
test distance1 is  tensor(168.8461, device='cuda:3')
test similarity is  tensor(0.9100, device='cuda:3')
test acc is  0.10091666682299863
test loss is 2.375067015065313
test entropy is  0.5955093199891577
________________________________
cal ratio is  0.9673011384432193
distance x is tensor(163.3269, device='cuda:3')
cal_distance is  tensor(163.3269, device='cuda:3')
distance x is tensor(163.3269, device='cuda:3')
return_distance is  tensor(163.3269, device='cuda:3')
distance x is tensor(163.3250, device='cuda:3')
distance x is tensor(163.3250, device='cuda:3')
________________________________
test distance is  tensor(163.3250, device='cuda:3')
test distance1 is  tensor(163.3250, device='cuda:3')
test similarity is  tensor(0.9151, device='cuda:3')
test acc is  0.10071666682299864
test loss is 2.3984052780340477
test entropy is  0.6027228091317199
________________________________
0
distance x is tensor(163.3250, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6024267425669282
avg test loss is  2.401493800982738
avg accuracy is  0.10410000015633197
solo acc is  0.10065000015633196
compute similarity  is  tensor(0.9151, device='cuda:3')
compute_distance is  tensor(163.3250, device='cuda:3')
compute_norm is  tensor(49.0965, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(164.9059, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9701579682735492
avg test loss is  1.4783060644735406
avg accuracy is  0.11583333348966528
solo acc is  0.18320000015633545
compute similarity  is  tensor(0.9147, device='cuda:3')
compute_distance is  tensor(164.9059, device='cuda:3')
compute_norm is  tensor(48.8593, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(164.9078, device='cuda:3')
________________________________
test distance is  tensor(164.9078, device='cuda:3')
test similarity is  tensor(0.9147, device='cuda:3')
test acc is  0.11571666682299861
test loss is 1.4777841640433778
test entropy is  0.9679499569096799
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2100788354873657
mal norm is  tensor(878.0312, device='cuda:3')
distance x is tensor(164.9078, device='cuda:3')
mal distance is  tensor(164.9078, device='cuda:3')
user_PLR len size 52
counter_tensor is  tensor([ 1.,  1., 35.,  1.,  1., 20.,  1., 20., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40.,  0.,  0., 17., 47., 14., 47., 46., 51.,
        49., 48.,  1.,  1., 15., 15., 24.,  0., 15., 50.,  0., 17., 14., 41.,
        31., 43.,  0., 51., 49., 49., 43., 51., 12., 44.])
count_res tensor([4.9853e-23, 4.9853e-23, 2.9087e-08, 4.9853e-23, 4.9853e-23, 8.8979e-15,
        4.9853e-23, 8.8979e-15, 4.3169e-06, 4.3169e-06, 4.3169e-06, 4.3169e-06,
        4.3169e-06, 4.3169e-06, 4.3169e-06, 4.3169e-06, 4.3169e-06, 4.3169e-06,
        4.3169e-06, 4.3169e-06, 1.8340e-23, 1.8340e-23, 4.4300e-16, 4.7341e-03,
        2.2056e-17, 4.7341e-03, 1.7416e-03, 2.5847e-01, 3.4981e-02, 1.2869e-02,
        4.9853e-23, 4.9853e-23, 5.9953e-17, 5.9953e-17, 4.8581e-13, 1.8340e-23,
        5.9953e-17, 9.5087e-02, 1.8340e-23, 4.4300e-16, 2.2056e-17, 1.1735e-05,
        5.3275e-10, 8.6708e-05, 1.8340e-23, 2.5847e-01, 3.4981e-02, 3.4981e-02,
        8.6708e-05, 2.5847e-01, 2.9849e-18, 2.3570e-04])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 89.52% 

Test Accuracy: 88.91% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1264370679855347
distance x is tensor(98.6825, device='cuda:3')
benign distance is  tensor(98.6825, device='cuda:3')
norm1 res is  tensor(442.2090, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6794002652168274
distance x is tensor(105.9465, device='cuda:3')
benign distance is  tensor(105.9465, device='cuda:3')
norm1 res is  tensor(472.7762, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.23712857067584991
distance x is tensor(103.6671, device='cuda:3')
benign distance is  tensor(103.6671, device='cuda:3')
norm1 res is  tensor(452.4030, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.571799635887146
distance x is tensor(102.0634, device='cuda:3')
benign distance is  tensor(102.0634, device='cuda:3')
norm1 res is  tensor(443.7669, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.46027833223342896
distance x is tensor(91.6373, device='cuda:3')
benign distance is  tensor(91.6373, device='cuda:3')
norm1 res is  tensor(396.3558, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9161981344223022
distance x is tensor(101.4126, device='cuda:3')
benign distance is  tensor(101.4126, device='cuda:3')
norm1 res is  tensor(447.4902, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.39172208309173584
distance x is tensor(94.5888, device='cuda:3')
benign distance is  tensor(94.5888, device='cuda:3')
norm1 res is  tensor(402.0228, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.36597102880477905
distance x is tensor(81.1517, device='cuda:3')
benign distance is  tensor(81.1517, device='cuda:3')
norm1 res is  tensor(359.9898, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6677773594856262
distance x is tensor(115.6414, device='cuda:3')
benign distance is  tensor(115.6414, device='cuda:3')
norm1 res is  tensor(513.9944, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4776293635368347
distance x is tensor(102.6211, device='cuda:3')
benign distance is  tensor(102.6211, device='cuda:3')
norm1 res is  tensor(451.8629, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.289612352848053
distance x is tensor(116.3937, device='cuda:3')
benign distance is  tensor(116.3937, device='cuda:3')
norm1 res is  tensor(505.0701, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8266302347183228
distance x is tensor(109.2517, device='cuda:3')
benign distance is  tensor(109.2517, device='cuda:3')
norm1 res is  tensor(469.2861, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5398651957511902
distance x is tensor(104.3397, device='cuda:3')
benign distance is  tensor(104.3397, device='cuda:3')
norm1 res is  tensor(454.6791, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6582499146461487
distance x is tensor(88.3745, device='cuda:3')
benign distance is  tensor(88.3745, device='cuda:3')
norm1 res is  tensor(402.7101, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.31635984778404236
distance x is tensor(114.1398, device='cuda:3')
benign distance is  tensor(114.1398, device='cuda:3')
norm1 res is  tensor(508.8212, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7759246826171875
distance x is tensor(117.6992, device='cuda:3')
benign distance is  tensor(117.6992, device='cuda:3')
norm1 res is  tensor(507.4230, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.1814965456724167
distance x is tensor(114.2169, device='cuda:3')
benign distance is  tensor(114.2169, device='cuda:3')
norm1 res is  tensor(487.0894, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8465701937675476
distance x is tensor(110.5181, device='cuda:3')
benign distance is  tensor(110.5181, device='cuda:3')
norm1 res is  tensor(481.0920, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.48397955298423767
distance x is tensor(120.3831, device='cuda:3')
benign distance is  tensor(120.3831, device='cuda:3')
norm1 res is  tensor(518.8375, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.18579088151454926
distance x is tensor(102.1436, device='cuda:3')
benign distance is  tensor(102.1436, device='cuda:3')
norm1 res is  tensor(457.5531, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4022907316684723
distance x is tensor(103.6378, device='cuda:3')
benign distance is  tensor(103.6378, device='cuda:3')
norm1 res is  tensor(460.9028, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9309874773025513
distance x is tensor(110.2766, device='cuda:3')
benign distance is  tensor(110.2766, device='cuda:3')
norm1 res is  tensor(491.0582, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.48017898201942444
distance x is tensor(99.8273, device='cuda:3')
benign distance is  tensor(99.8273, device='cuda:3')
norm1 res is  tensor(435.9025, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5399108529090881
distance x is tensor(102.0429, device='cuda:3')
benign distance is  tensor(102.0429, device='cuda:3')
norm1 res is  tensor(445.7732, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3052665591239929
distance x is tensor(110.9895, device='cuda:3')
benign distance is  tensor(110.9895, device='cuda:3')
norm1 res is  tensor(495.9562, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7632627487182617
distance x is tensor(100.8767, device='cuda:3')
benign distance is  tensor(100.8767, device='cuda:3')
norm1 res is  tensor(429.9211, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8148730397224426
distance x is tensor(109.8332, device='cuda:3')
benign distance is  tensor(109.8332, device='cuda:3')
norm1 res is  tensor(490.8378, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4567490220069885
distance x is tensor(120.9521, device='cuda:3')
benign distance is  tensor(120.9521, device='cuda:3')
norm1 res is  tensor(527.6724, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5475507974624634
distance x is tensor(103.5655, device='cuda:3')
benign distance is  tensor(103.5655, device='cuda:3')
norm1 res is  tensor(451.7477, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6856323480606079
distance x is tensor(123.5138, device='cuda:3')
benign distance is  tensor(123.5138, device='cuda:3')
norm1 res is  tensor(532.8529, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7941335439682007
distance x is tensor(107.0959, device='cuda:3')
benign distance is  tensor(107.0959, device='cuda:3')
norm1 res is  tensor(489.2717, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6973224878311157
distance x is tensor(107.7554, device='cuda:3')
benign distance is  tensor(107.7554, device='cuda:3')
norm1 res is  tensor(488.8271, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.3638961911201477
distance x is tensor(117.8340, device='cuda:3')
benign distance is  tensor(117.8340, device='cuda:3')
norm1 res is  tensor(505.9866, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.45545101165771484
distance x is tensor(120.7351, device='cuda:3')
benign distance is  tensor(120.7351, device='cuda:3')
norm1 res is  tensor(510.7014, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.40567055344581604
distance x is tensor(105.2425, device='cuda:3')
benign distance is  tensor(105.2425, device='cuda:3')
norm1 res is  tensor(467.1689, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.2811751663684845
distance x is tensor(107.8788, device='cuda:3')
benign distance is  tensor(107.8788, device='cuda:3')
norm1 res is  tensor(467.3749, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7235476970672607
distance x is tensor(107.5260, device='cuda:3')
benign distance is  tensor(107.5260, device='cuda:3')
norm1 res is  tensor(469.9431, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.0221302509307861
distance x is tensor(113.6390, device='cuda:3')
benign distance is  tensor(113.6390, device='cuda:3')
norm1 res is  tensor(496.2909, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8624578714370728
distance x is tensor(109.6611, device='cuda:3')
benign distance is  tensor(109.6611, device='cuda:3')
norm1 res is  tensor(479.2957, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.686283528804779
distance x is tensor(96.1954, device='cuda:3')
benign distance is  tensor(96.1954, device='cuda:3')
norm1 res is  tensor(438.7815, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(100.6748, device='cuda:3')
compute distance is  tensor(100.6748, device='cuda:3')
compute norm is  tensor(47.5259, device='cuda:3', dtype=torch.float64)
distance x is tensor(94.4886, device='cuda:3')
compute distance is  tensor(94.4886, device='cuda:3')
compute norm is  tensor(47.5010, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.8475, device='cuda:3')
compute distance is  tensor(107.8475, device='cuda:3')
compute norm is  tensor(47.7733, device='cuda:3', dtype=torch.float64)
distance x is tensor(96.2297, device='cuda:3')
compute distance is  tensor(96.2297, device='cuda:3')
compute norm is  tensor(47.5401, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.4821, device='cuda:3')
compute distance is  tensor(110.4821, device='cuda:3')
compute norm is  tensor(47.7308, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.1679, device='cuda:3')
compute distance is  tensor(104.1679, device='cuda:3')
compute norm is  tensor(47.6651, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.9813, device='cuda:3')
compute distance is  tensor(98.9813, device='cuda:3')
compute norm is  tensor(47.6529, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.6373, device='cuda:3')
compute distance is  tensor(111.6373, device='cuda:3')
compute norm is  tensor(47.8836, device='cuda:3', dtype=torch.float64)
distance x is tensor(97.5028, device='cuda:3')
compute distance is  tensor(97.5028, device='cuda:3')
compute norm is  tensor(47.6157, device='cuda:3', dtype=torch.float64)
distance x is tensor(94.9170, device='cuda:3')
compute distance is  tensor(94.9170, device='cuda:3')
compute norm is  tensor(47.5700, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.2711, device='cuda:3')
compute distance is  tensor(103.2711, device='cuda:3')
compute norm is  tensor(47.7207, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.3265, device='cuda:3')
compute distance is  tensor(109.3265, device='cuda:3')
compute norm is  tensor(47.7049, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(111.6373, device='cuda:3')
distance x is tensor(106212.6719, device='cuda:3')
distance x is tensor(106212.6719, device='cuda:3')
________________________________
test distance is  tensor(106212.6719, device='cuda:3')
test distance1 is  tensor(106212.6719, device='cuda:3')
test similarity is  tensor(-0.1037, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139295243281065.22
test entropy is  0.0
________________________________
cal ratio is  0.031771860884995555
distance x is tensor(3374.5793, device='cuda:3')
cal_distance is  tensor(3374.5793, device='cuda:3')
cal ratio is  0.1782464882245896
distance x is tensor(601.5109, device='cuda:3')
cal_distance is  tensor(601.5109, device='cuda:3')
cal ratio is  0.4221910709763744
distance x is tensor(253.9555, device='cuda:3')
cal_distance is  tensor(253.9555, device='cuda:3')
cal ratio is  0.6497585648867141
distance x is tensor(165.0115, device='cuda:3')
cal_distance is  tensor(165.0115, device='cuda:3')
cal ratio is  0.8060717142061617
distance x is tensor(133.0121, device='cuda:3')
cal_distance is  tensor(133.0121, device='cuda:3')
cal ratio is  0.8978116498120561
distance x is tensor(119.4203, device='cuda:3')
cal_distance is  tensor(119.4203, device='cuda:3')
cal ratio is  0.9475271540150314
distance x is tensor(113.1543, device='cuda:3')
cal_distance is  tensor(113.1543, device='cuda:3')
cal ratio is  0.9734089058951831
distance x is tensor(110.1455, device='cuda:3')
cal_distance is  tensor(110.1455, device='cuda:3')
distance x is tensor(110.1455, device='cuda:3')
return_distance is  tensor(110.1455, device='cuda:3')
distance x is tensor(110.1355, device='cuda:3')
distance x is tensor(110.1355, device='cuda:3')
________________________________
test distance is  tensor(110.1355, device='cuda:3')
test distance1 is  tensor(110.1355, device='cuda:3')
test similarity is  tensor(0.9636, device='cuda:3')
test acc is  0.10000000015633198
test loss is 189.64739490826247
test entropy is  1.9577527001642163e-26
________________________________
0
distance x is tensor(110.1355, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  6.467900078345155e-26
avg test loss is  189.67489425561575
avg accuracy is  0.6208333334896693
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9636, device='cuda:3')
compute_distance is  tensor(110.1355, device='cuda:3')
compute_norm is  tensor(46.5470, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(100.9596, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8029894692175932
avg test loss is  1.3935797622463089
avg accuracy is  0.8699666668229892
solo acc is  0.3087166668230063
compute similarity  is  tensor(0.9663, device='cuda:3')
compute_distance is  tensor(100.9596, device='cuda:3')
compute_norm is  tensor(45.3549, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(103.6849, device='cuda:3')
exit early
distance x is tensor(103.6849, device='cuda:3')
distance x is tensor(103.6849, device='cuda:3')
________________________________
test distance is  tensor(103.6849, device='cuda:3')
test distance1 is  tensor(103.6849, device='cuda:3')
test similarity is  tensor(0.9656, device='cuda:3')
test acc is  0.26338333348967197
test loss is 1.3883772058400519
test entropy is  0.7927033737270054
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.5035946369171143
mal norm is  tensor(540.4944, device='cuda:3')
distance x is tensor(103.6917, device='cuda:3')
mal distance is  tensor(103.6917, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 22.63% 

Test Accuracy: 21.47% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8893945813179016
distance x is tensor(157.6840, device='cuda:3')
benign distance is  tensor(157.6840, device='cuda:3')
norm1 res is  tensor(618.6400, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.562916100025177
distance x is tensor(152.8424, device='cuda:3')
benign distance is  tensor(152.8424, device='cuda:3')
norm1 res is  tensor(601.0567, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.29570043087005615
distance x is tensor(161.0690, device='cuda:3')
benign distance is  tensor(161.0690, device='cuda:3')
norm1 res is  tensor(626.8649, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2584115266799927
distance x is tensor(153.9579, device='cuda:3')
benign distance is  tensor(153.9579, device='cuda:3')
norm1 res is  tensor(602.2496, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.683592677116394
distance x is tensor(165.7943, device='cuda:3')
benign distance is  tensor(165.7943, device='cuda:3')
norm1 res is  tensor(640.6298, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9132563471794128
distance x is tensor(149.9062, device='cuda:3')
benign distance is  tensor(149.9062, device='cuda:3')
norm1 res is  tensor(591.9521, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4608359932899475
distance x is tensor(162.1053, device='cuda:3')
benign distance is  tensor(162.1053, device='cuda:3')
norm1 res is  tensor(642.1921, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.35849621891975403
distance x is tensor(148.2088, device='cuda:3')
benign distance is  tensor(148.2088, device='cuda:3')
norm1 res is  tensor(593.0185, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(148.9736, device='cuda:3')
compute distance is  tensor(148.9736, device='cuda:3')
compute norm is  tensor(46.7563, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.9413, device='cuda:3')
compute distance is  tensor(145.9413, device='cuda:3')
compute norm is  tensor(46.8090, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.3759, device='cuda:3')
compute distance is  tensor(154.3759, device='cuda:3')
compute norm is  tensor(47.1379, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.3279, device='cuda:3')
compute distance is  tensor(156.3279, device='cuda:3')
compute norm is  tensor(46.9717, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.3260, device='cuda:3')
compute distance is  tensor(150.3260, device='cuda:3')
compute norm is  tensor(46.9857, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.9191, device='cuda:3')
compute distance is  tensor(149.9191, device='cuda:3')
compute norm is  tensor(46.9861, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.7667, device='cuda:3')
compute distance is  tensor(144.7667, device='cuda:3')
compute norm is  tensor(46.8608, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.0435, device='cuda:3')
compute distance is  tensor(151.0435, device='cuda:3')
compute norm is  tensor(47.1215, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.0204, device='cuda:3')
compute distance is  tensor(152.0204, device='cuda:3')
compute norm is  tensor(47.0736, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.2450, device='cuda:3')
compute distance is  tensor(153.2450, device='cuda:3')
compute norm is  tensor(47.1419, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.9624, device='cuda:3')
compute distance is  tensor(154.9624, device='cuda:3')
compute norm is  tensor(47.1057, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.3855, device='cuda:3')
compute distance is  tensor(152.3855, device='cuda:3')
compute norm is  tensor(47.1217, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(156.3279, device='cuda:3')
distance x is tensor(106145.8047, device='cuda:3')
distance x is tensor(106145.8047, device='cuda:3')
________________________________
test distance is  tensor(106145.8047, device='cuda:3')
test distance1 is  tensor(106145.8047, device='cuda:3')
test similarity is  tensor(0.1249, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139262177481009.67
test entropy is  0.0
________________________________
cal ratio is  0.03760909845329146
distance x is tensor(3992.0530, device='cuda:3')
cal_distance is  tensor(3992.0530, device='cuda:3')
cal ratio is  0.1939305320900848
distance x is tensor(774.1851, device='cuda:3')
cal_distance is  tensor(774.1851, device='cuda:3')
cal ratio is  0.4403742665813401
distance x is tensor(340.9340, device='cuda:3')
cal_distance is  tensor(340.9340, device='cuda:3')
cal ratio is  0.6636043274954639
distance x is tensor(226.2469, device='cuda:3')
cal_distance is  tensor(226.2469, device='cuda:3')
cal ratio is  0.8146161092975727
distance x is tensor(184.3054, device='cuda:3')
cal_distance is  tensor(184.3054, device='cuda:3')
cal ratio is  0.9025584842298541
distance x is tensor(166.3468, device='cuda:3')
cal_distance is  tensor(166.3468, device='cuda:3')
cal ratio is  0.9500294171095385
distance x is tensor(158.0347, device='cuda:3')
cal_distance is  tensor(158.0347, device='cuda:3')
cal ratio is  0.9746936906750677
distance x is tensor(154.0355, device='cuda:3')
cal_distance is  tensor(154.0355, device='cuda:3')
distance x is tensor(154.0355, device='cuda:3')
return_distance is  tensor(154.0355, device='cuda:3')
distance x is tensor(154.0255, device='cuda:3')
distance x is tensor(154.0255, device='cuda:3')
________________________________
test distance is  tensor(154.0255, device='cuda:3')
test distance1 is  tensor(154.0255, device='cuda:3')
test similarity is  tensor(0.9383, device='cuda:3')
test acc is  0.10000000015633198
test loss is 942.9259866092251
test entropy is  0.0
________________________________
0
distance x is tensor(154.0255, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  942.9678528873143
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9383, device='cuda:3')
compute_distance is  tensor(154.0255, device='cuda:3')
compute_norm is  tensor(48.2550, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(302.9310, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5631443977610135
avg test loss is  2.848488273651107
avg accuracy is  0.18526666682300236
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.7817, device='cuda:3')
compute_distance is  tensor(302.9310, device='cuda:3')
compute_norm is  tensor(59.8747, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(302.6090, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8397574018059509
avg test loss is  3.5807052680424283
avg accuracy is  0.17413333348966828
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7811, device='cuda:3')
compute_distance is  tensor(302.6090, device='cuda:3')
compute_norm is  tensor(59.9846, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(301.3958, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.553811574160163
avg test loss is  2.851904249394626
avg accuracy is  0.18728333348966905
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7815, device='cuda:3')
compute_distance is  tensor(301.3958, device='cuda:3')
compute_norm is  tensor(59.3324, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(301.1980, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8394690508654377
avg test loss is  3.5778374211874597
avg accuracy is  0.1742166668230016
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7810, device='cuda:3')
compute_distance is  tensor(301.1980, device='cuda:3')
compute_norm is  tensor(59.4433, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(300.0799, device='cuda:3')
distance x is tensor(300.0799, device='cuda:3')
________________________________
test distance is  tensor(300.0799, device='cuda:3')
test distance1 is  tensor(300.0799, device='cuda:3')
test similarity is  tensor(0.7815, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8518553407970013
test entropy is  1.5536212191652896
________________________________
cal ratio is  0.7073362143864893
distance x is tensor(212.2611, device='cuda:3')
cal_distance is  tensor(212.2611, device='cuda:3')
cal ratio is  0.8410253802069044
distance x is tensor(178.5174, device='cuda:3')
cal_distance is  tensor(178.5174, device='cuda:3')
cal ratio is  0.9170734163262568
distance x is tensor(163.7137, device='cuda:3')
cal_distance is  tensor(163.7137, device='cuda:3')
cal ratio is  0.9576389513462173
distance x is tensor(156.7787, device='cuda:3')
cal_distance is  tensor(156.7787, device='cuda:3')
cal ratio is  0.9785899872747859
distance x is tensor(153.4222, device='cuda:3')
cal_distance is  tensor(153.4222, device='cuda:3')
distance x is tensor(153.4222, device='cuda:3')
return_distance is  tensor(153.4222, device='cuda:3')
distance x is tensor(153.4177, device='cuda:3')
distance x is tensor(153.4177, device='cuda:3')
________________________________
test distance is  tensor(153.4177, device='cuda:3')
test distance1 is  tensor(153.4177, device='cuda:3')
test similarity is  tensor(0.9236, device='cuda:3')
test acc is  0.18693333348966906
test loss is 2.7859062528305216
test entropy is  1.6879681247129623
________________________________
0
distance x is tensor(153.4177, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.6849476190518216
avg test loss is  2.7877282959057577
avg accuracy is  0.2336500001563378
solo acc is  0.18853333348966925
compute similarity  is  tensor(0.9236, device='cuda:3')
compute_distance is  tensor(153.4177, device='cuda:3')
compute_norm is  tensor(49.6643, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(156.8761, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7977241632907883
avg test loss is  2.9759237397708365
avg accuracy is  0.13296666682299857
solo acc is  0.10096666682299864
compute similarity  is  tensor(0.9227, device='cuda:3')
compute_distance is  tensor(156.8761, device='cuda:3')
compute_norm is  tensor(49.6760, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(160.0766, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0862448702870147
avg test loss is  1.7407650864963085
avg accuracy is  0.13836666682299875
solo acc is  0.1708666668230014
compute similarity  is  tensor(0.9221, device='cuda:3')
compute_distance is  tensor(160.0766, device='cuda:3')
compute_norm is  tensor(49.5035, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(160.9527, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6455616492833665
avg test loss is  2.4894865982568084
avg accuracy is  0.11206666682299861
solo acc is  0.10121666682299864
compute similarity  is  tensor(0.9216, device='cuda:3')
compute_distance is  tensor(160.9527, device='cuda:3')
compute_norm is  tensor(49.3582, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(162.6195, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0020978075227758
avg test loss is  1.5578253979621919
avg accuracy is  0.1383333334896654
solo acc is  0.21180000015633693
compute similarity  is  tensor(0.9213, device='cuda:3')
compute_distance is  tensor(162.6195, device='cuda:3')
compute_norm is  tensor(49.1138, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(163.0231, device='cuda:3')
distance x is tensor(163.0231, device='cuda:3')
________________________________
test distance is  tensor(163.0231, device='cuda:3')
test distance1 is  tensor(163.0231, device='cuda:3')
test similarity is  tensor(0.9211, device='cuda:3')
test acc is  0.10121666682299864
test loss is 2.3316413010361354
test entropy is  0.6036794392793163
________________________________
cal ratio is  0.9596653228254362
distance x is tensor(156.4506, device='cuda:3')
cal_distance is  tensor(156.4506, device='cuda:3')
cal ratio is  0.979615599225133
distance x is tensor(153.2615, device='cuda:3')
cal_distance is  tensor(153.2615, device='cuda:3')
distance x is tensor(153.2615, device='cuda:3')
return_distance is  tensor(153.2615, device='cuda:3')
distance x is tensor(153.2584, device='cuda:3')
distance x is tensor(153.2584, device='cuda:3')
________________________________
test distance is  tensor(153.2584, device='cuda:3')
test distance1 is  tensor(153.2584, device='cuda:3')
test similarity is  tensor(0.9293, device='cuda:3')
test acc is  0.1014333334896653
test loss is 2.3679476267239177
test entropy is  0.6077716067782851
________________________________
0
distance x is tensor(153.2584, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6070284797692858
avg test loss is  2.3662647064814943
avg accuracy is  0.11621666682299861
solo acc is  0.10150000015633197
compute similarity  is  tensor(0.9293, device='cuda:3')
compute_distance is  tensor(153.2584, device='cuda:3')
compute_norm is  tensor(48.4964, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(155.1152, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9625118107938054
avg test loss is  1.4716408271779384
avg accuracy is  0.1451166668229994
solo acc is  0.2214166668230039
compute similarity  is  tensor(0.9288, device='cuda:3')
compute_distance is  tensor(155.1152, device='cuda:3')
compute_norm is  tensor(48.2744, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(155.1183, device='cuda:3')
________________________________
test distance is  tensor(155.1183, device='cuda:3')
test similarity is  tensor(0.9288, device='cuda:3')
test acc is  0.14536666682299945
test loss is 1.4727817214628272
test entropy is  0.9636607068433944
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2365553379058838
mal norm is  tensor(798.9368, device='cuda:3')
distance x is tensor(155.1183, device='cuda:3')
mal distance is  tensor(155.1183, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([12., 12., 12., 12., 21., 12., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 17., 27., 20., 12., 17., 12., 26.])
count_res tensor([2.2303e-07, 2.2303e-07, 2.2303e-07, 2.2303e-07, 1.8072e-03, 2.2303e-07,
        2.2303e-07, 2.2303e-07, 1.2177e-05, 1.2177e-05, 1.2177e-05, 1.2177e-05,
        1.2177e-05, 1.2177e-05, 1.2177e-05, 1.2177e-05, 1.2177e-05, 1.2177e-05,
        1.2177e-05, 1.2177e-05, 2.2303e-07, 3.3101e-05, 7.2909e-01, 6.6485e-04,
        2.2303e-07, 3.3101e-05, 2.2303e-07, 2.6822e-01])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 89.00% 

Test Accuracy: 87.95% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2388277053833008
distance x is tensor(104.3113, device='cuda:3')
benign distance is  tensor(104.3113, device='cuda:3')
norm1 res is  tensor(447.4524, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.43676358461380005
distance x is tensor(112.9587, device='cuda:3')
benign distance is  tensor(112.9587, device='cuda:3')
norm1 res is  tensor(490.2811, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.05851610749959946
distance x is tensor(119.2641, device='cuda:3')
benign distance is  tensor(119.2641, device='cuda:3')
norm1 res is  tensor(511.5744, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5611315965652466
distance x is tensor(103.8346, device='cuda:3')
benign distance is  tensor(103.8346, device='cuda:3')
norm1 res is  tensor(445.8291, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5631025433540344
distance x is tensor(102.8009, device='cuda:3')
benign distance is  tensor(102.8009, device='cuda:3')
norm1 res is  tensor(445.1988, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3406217098236084
distance x is tensor(123.2395, device='cuda:3')
benign distance is  tensor(123.2395, device='cuda:3')
norm1 res is  tensor(530.7100, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6157293319702148
distance x is tensor(118.9368, device='cuda:3')
benign distance is  tensor(118.9368, device='cuda:3')
norm1 res is  tensor(493.5979, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.516781747341156
distance x is tensor(86.5011, device='cuda:3')
benign distance is  tensor(86.5011, device='cuda:3')
norm1 res is  tensor(387.3846, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4838552474975586
distance x is tensor(124.6192, device='cuda:3')
benign distance is  tensor(124.6192, device='cuda:3')
norm1 res is  tensor(540.6006, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7310426831245422
distance x is tensor(115.1639, device='cuda:3')
benign distance is  tensor(115.1639, device='cuda:3')
norm1 res is  tensor(494.1809, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5786105990409851
distance x is tensor(55.8343, device='cuda:3')
benign distance is  tensor(55.8343, device='cuda:3')
norm1 res is  tensor(240.8997, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.31620192527771
distance x is tensor(108.5302, device='cuda:3')
benign distance is  tensor(108.5302, device='cuda:3')
norm1 res is  tensor(466.1727, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5362926125526428
distance x is tensor(116.3583, device='cuda:3')
benign distance is  tensor(116.3583, device='cuda:3')
norm1 res is  tensor(504.8881, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.39290037751197815
distance x is tensor(105.8587, device='cuda:3')
benign distance is  tensor(105.8587, device='cuda:3')
norm1 res is  tensor(460.3164, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.43198251724243164
distance x is tensor(117.5505, device='cuda:3')
benign distance is  tensor(117.5505, device='cuda:3')
norm1 res is  tensor(507.1171, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.199397087097168
distance x is tensor(97.9227, device='cuda:3')
benign distance is  tensor(97.9227, device='cuda:3')
norm1 res is  tensor(424.4065, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(91.6764, device='cuda:3')
compute distance is  tensor(91.6764, device='cuda:3')
compute norm is  tensor(48.1601, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.6940, device='cuda:3')
compute distance is  tensor(110.6940, device='cuda:3')
compute norm is  tensor(48.5225, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.9885, device='cuda:3')
compute distance is  tensor(110.9885, device='cuda:3')
compute norm is  tensor(48.5548, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.4884, device='cuda:3')
compute distance is  tensor(95.4884, device='cuda:3')
compute norm is  tensor(48.2950, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.3835, device='cuda:3')
compute distance is  tensor(107.3835, device='cuda:3')
compute norm is  tensor(48.5320, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.5441, device='cuda:3')
compute distance is  tensor(114.5441, device='cuda:3')
compute norm is  tensor(48.6196, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.0836, device='cuda:3')
compute distance is  tensor(111.0836, device='cuda:3')
compute norm is  tensor(48.5791, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.7702, device='cuda:3')
compute distance is  tensor(112.7702, device='cuda:3')
compute norm is  tensor(48.6018, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.2718, device='cuda:3')
compute distance is  tensor(103.2718, device='cuda:3')
compute norm is  tensor(48.5152, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.7197, device='cuda:3')
compute distance is  tensor(110.7197, device='cuda:3')
compute norm is  tensor(48.4973, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.1129, device='cuda:3')
compute distance is  tensor(122.1129, device='cuda:3')
compute norm is  tensor(48.7894, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.4363, device='cuda:3')
compute distance is  tensor(109.4363, device='cuda:3')
compute norm is  tensor(48.5960, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(122.1129, device='cuda:3')
distance x is tensor(106219.8125, device='cuda:3')
distance x is tensor(106219.8125, device='cuda:3')
________________________________
test distance is  tensor(106219.8125, device='cuda:3')
test distance1 is  tensor(106219.8125, device='cuda:3')
test similarity is  tensor(-0.1037, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139266885681152.0
test entropy is  0.0
________________________________
cal ratio is  0.0332279869549714
distance x is tensor(3529.4758, device='cuda:3')
cal_distance is  tensor(3529.4758, device='cuda:3')
cal ratio is  0.18228531872504922
distance x is tensor(643.3757, device='cuda:3')
cal_distance is  tensor(643.3757, device='cuda:3')
cal ratio is  0.42694750503792084
distance x is tensor(274.6905, device='cuda:3')
cal_distance is  tensor(274.6905, device='cuda:3')
cal ratio is  0.6534087712226809
distance x is tensor(179.4870, device='cuda:3')
cal_distance is  tensor(179.4870, device='cuda:3')
cal ratio is  0.8083330772209417
distance x is tensor(145.0862, device='cuda:3')
cal_distance is  tensor(145.0862, device='cuda:3')
cal ratio is  0.8990704062269687
distance x is tensor(130.4432, device='cuda:3')
cal_distance is  tensor(130.4432, device='cuda:3')
cal ratio is  0.9481913891622581
distance x is tensor(123.6854, device='cuda:3')
cal_distance is  tensor(123.6854, device='cuda:3')
cal ratio is  0.9737501681233408
distance x is tensor(120.4388, device='cuda:3')
cal_distance is  tensor(120.4388, device='cuda:3')
distance x is tensor(120.4388, device='cuda:3')
return_distance is  tensor(120.4388, device='cuda:3')
distance x is tensor(120.4289, device='cuda:3')
distance x is tensor(120.4289, device='cuda:3')
________________________________
test distance is  tensor(120.4289, device='cuda:3')
test distance1 is  tensor(120.4289, device='cuda:3')
test similarity is  tensor(0.9586, device='cuda:3')
test acc is  0.10000000015633198
test loss is 260.0521332795686
test entropy is  1.6159979489914493e-30
________________________________
0
distance x is tensor(120.4289, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0397221126404319e-30
avg test loss is  260.04495806988876
avg accuracy is  0.4422333334896749
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9586, device='cuda:3')
compute_distance is  tensor(120.4289, device='cuda:3')
compute_norm is  tensor(47.5608, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(108.0244, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.85564845355589
avg test loss is  1.321005707483556
avg accuracy is  0.8575166668229897
solo acc is  0.3401500001563403
compute similarity  is  tensor(0.9622, device='cuda:3')
compute_distance is  tensor(108.0244, device='cuda:3')
compute_norm is  tensor(46.4272, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(110.6945, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.76322431179252
avg test loss is  1.4849961405115595
avg accuracy is  0.8578833334896563
solo acc is  0.233033333489671
compute similarity  is  tensor(0.9615, device='cuda:3')
compute_distance is  tensor(110.6945, device='cuda:3')
compute_norm is  tensor(46.1163, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(113.0435, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7970890222327796
avg test loss is  1.3646075129508972
avg accuracy is  0.8597666668229895
solo acc is  0.25373333348967164
compute similarity  is  tensor(0.9610, device='cuda:3')
compute_distance is  tensor(113.0435, device='cuda:3')
compute_norm is  tensor(45.8346, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.2763, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7695612625907987
avg test loss is  1.392801917310971
avg accuracy is  0.8616000001563229
solo acc is  0.22275000015633728
compute similarity  is  tensor(0.9605, device='cuda:3')
compute_distance is  tensor(115.2763, device='cuda:3')
compute_norm is  tensor(45.5709, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.4287, device='cuda:3')
distance x is tensor(117.4287, device='cuda:3')
________________________________
test distance is  tensor(117.4287, device='cuda:3')
test distance1 is  tensor(117.4287, device='cuda:3')
test similarity is  tensor(0.9601, device='cuda:3')
test acc is  0.24028333348967126
test loss is 1.31960670182954
test entropy is  0.7894579582631207
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.2517597675323486
mal norm is  tensor(594.9474, device='cuda:3')
distance x is tensor(117.4357, device='cuda:3')
mal distance is  tensor(117.4357, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([15., 12., 14., 32., 27., 12., 25., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 32., 12., 32., 13., 12., 25., 35., 13.,
        17., 12., 22., 12., 12., 12., 34., 16.])
count_res tensor([1.3579e-09, 6.7607e-11, 4.9955e-10, 3.2801e-02, 2.2101e-04, 6.7607e-11,
        2.9910e-05, 6.7607e-11, 1.1003e-05, 1.1003e-05, 1.1003e-05, 1.1003e-05,
        1.1003e-05, 1.1003e-05, 1.1003e-05, 1.1003e-05, 1.1003e-05, 1.1003e-05,
        1.1003e-05, 1.1003e-05, 3.2801e-02, 6.7607e-11, 3.2801e-02, 1.8378e-10,
        6.7607e-11, 2.9910e-05, 6.5882e-01, 1.8378e-10, 1.0034e-08, 6.7607e-11,
        1.4891e-06, 6.7607e-11, 6.7607e-11, 6.7607e-11, 2.4237e-01, 3.6912e-09])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 89.26% 

Test Accuracy: 88.33% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8255937695503235
distance x is tensor(98.5167, device='cuda:3')
benign distance is  tensor(98.5167, device='cuda:3')
norm1 res is  tensor(436.3076, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3287169337272644
distance x is tensor(105.4545, device='cuda:3')
benign distance is  tensor(105.4545, device='cuda:3')
norm1 res is  tensor(464.2249, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.13686978816986084
distance x is tensor(113.1714, device='cuda:3')
benign distance is  tensor(113.1714, device='cuda:3')
norm1 res is  tensor(487.9632, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0275561809539795
distance x is tensor(104.1451, device='cuda:3')
benign distance is  tensor(104.1451, device='cuda:3')
norm1 res is  tensor(453.1055, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7654531598091125
distance x is tensor(106.0422, device='cuda:3')
benign distance is  tensor(106.0422, device='cuda:3')
norm1 res is  tensor(450.0699, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1529357433319092
distance x is tensor(123.4771, device='cuda:3')
benign distance is  tensor(123.4771, device='cuda:3')
norm1 res is  tensor(542.7397, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3751542568206787
distance x is tensor(98.4982, device='cuda:3')
benign distance is  tensor(98.4982, device='cuda:3')
norm1 res is  tensor(418.1468, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.713948667049408
distance x is tensor(103.4158, device='cuda:3')
benign distance is  tensor(103.4158, device='cuda:3')
norm1 res is  tensor(455.2183, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5868383049964905
distance x is tensor(121.6142, device='cuda:3')
benign distance is  tensor(121.6142, device='cuda:3')
norm1 res is  tensor(529.7455, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8655142784118652
distance x is tensor(125.8689, device='cuda:3')
benign distance is  tensor(125.8689, device='cuda:3')
norm1 res is  tensor(548.6292, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.16261790692806244
distance x is tensor(113.7764, device='cuda:3')
benign distance is  tensor(113.7764, device='cuda:3')
norm1 res is  tensor(498.5673, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3652973175048828
distance x is tensor(110.4576, device='cuda:3')
benign distance is  tensor(110.4576, device='cuda:3')
norm1 res is  tensor(477.7456, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.8058673739433289
distance x is tensor(118.1358, device='cuda:3')
benign distance is  tensor(118.1358, device='cuda:3')
norm1 res is  tensor(508.0380, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5944586992263794
distance x is tensor(104.4601, device='cuda:3')
benign distance is  tensor(104.4601, device='cuda:3')
norm1 res is  tensor(456.2893, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4226536750793457
distance x is tensor(107.6839, device='cuda:3')
benign distance is  tensor(107.6839, device='cuda:3')
norm1 res is  tensor(479.3705, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5334218144416809
distance x is tensor(108.5888, device='cuda:3')
benign distance is  tensor(108.5888, device='cuda:3')
norm1 res is  tensor(471.5616, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.2859572768211365
distance x is tensor(105.3636, device='cuda:3')
benign distance is  tensor(105.3636, device='cuda:3')
norm1 res is  tensor(466.0468, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.3373427987098694
distance x is tensor(123.3343, device='cuda:3')
benign distance is  tensor(123.3343, device='cuda:3')
norm1 res is  tensor(531.3123, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.655872642993927
distance x is tensor(100.9386, device='cuda:3')
benign distance is  tensor(100.9386, device='cuda:3')
norm1 res is  tensor(435.4219, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.11790355294942856
distance x is tensor(112.1073, device='cuda:3')
benign distance is  tensor(112.1073, device='cuda:3')
norm1 res is  tensor(495.2781, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5398474931716919
distance x is tensor(118.6588, device='cuda:3')
benign distance is  tensor(118.6588, device='cuda:3')
norm1 res is  tensor(528.2433, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.46774712204933167
distance x is tensor(119.2422, device='cuda:3')
benign distance is  tensor(119.2422, device='cuda:3')
norm1 res is  tensor(501.4822, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.2481338530778885
distance x is tensor(69.0502, device='cuda:3')
benign distance is  tensor(69.0502, device='cuda:3')
norm1 res is  tensor(297.7675, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.24959726631641388
distance x is tensor(115.7078, device='cuda:3')
benign distance is  tensor(115.7078, device='cuda:3')
norm1 res is  tensor(492.6924, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(103.4118, device='cuda:3')
compute distance is  tensor(103.4118, device='cuda:3')
compute norm is  tensor(47.9195, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.1273, device='cuda:3')
compute distance is  tensor(105.1273, device='cuda:3')
compute norm is  tensor(47.9863, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.9998, device='cuda:3')
compute distance is  tensor(116.9998, device='cuda:3')
compute norm is  tensor(48.2740, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.2489, device='cuda:3')
compute distance is  tensor(106.2489, device='cuda:3')
compute norm is  tensor(48.1035, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.3241, device='cuda:3')
compute distance is  tensor(106.3241, device='cuda:3')
compute norm is  tensor(48.0871, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.6517, device='cuda:3')
compute distance is  tensor(116.6517, device='cuda:3')
compute norm is  tensor(48.4401, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.1023, device='cuda:3')
compute distance is  tensor(102.1023, device='cuda:3')
compute norm is  tensor(48.1445, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.0991, device='cuda:3')
compute distance is  tensor(109.0991, device='cuda:3')
compute norm is  tensor(48.1405, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.0829, device='cuda:3')
compute distance is  tensor(110.0829, device='cuda:3')
compute norm is  tensor(48.2031, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.6102, device='cuda:3')
compute distance is  tensor(104.6102, device='cuda:3')
compute norm is  tensor(47.9989, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.9372, device='cuda:3')
compute distance is  tensor(105.9372, device='cuda:3')
compute norm is  tensor(48.2216, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.1372, device='cuda:3')
compute distance is  tensor(121.1372, device='cuda:3')
compute norm is  tensor(48.3100, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(121.1372, device='cuda:3')
distance x is tensor(106214.3516, device='cuda:3')
distance x is tensor(106214.3516, device='cuda:3')
________________________________
test distance is  tensor(106214.3516, device='cuda:3')
test distance1 is  tensor(106214.3516, device='cuda:3')
test similarity is  tensor(-0.0987, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139292504391610.12
test entropy is  0.0
________________________________
cal ratio is  0.03309583270654555
distance x is tensor(3515.2578, device='cuda:3')
cal_distance is  tensor(3515.2578, device='cuda:3')
cal ratio is  0.18192246095152945
distance x is tensor(639.5084, device='cuda:3')
cal_distance is  tensor(639.5084, device='cuda:3')
cal ratio is  0.42652233286788893
distance x is tensor(272.7675, device='cuda:3')
cal_distance is  tensor(272.7675, device='cuda:3')
cal ratio is  0.6530832675852111
distance x is tensor(178.1416, device='cuda:3')
cal_distance is  tensor(178.1416, device='cuda:3')
cal ratio is  0.8081317527972703
distance x is tensor(143.9629, device='cuda:3')
cal_distance is  tensor(143.9629, device='cuda:3')
cal ratio is  0.8989584664440093
distance x is tensor(129.4172, device='cuda:3')
cal_distance is  tensor(129.4172, device='cuda:3')
cal ratio is  0.9481323132267482
distance x is tensor(122.7049, device='cuda:3')
cal_distance is  tensor(122.7049, device='cuda:3')
cal ratio is  0.9737198627151785
distance x is tensor(119.4803, device='cuda:3')
cal_distance is  tensor(119.4803, device='cuda:3')
distance x is tensor(119.4803, device='cuda:3')
return_distance is  tensor(119.4803, device='cuda:3')
distance x is tensor(119.4703, device='cuda:3')
distance x is tensor(119.4703, device='cuda:3')
________________________________
test distance is  tensor(119.4703, device='cuda:3')
test distance1 is  tensor(119.4703, device='cuda:3')
test similarity is  tensor(0.9585, device='cuda:3')
test acc is  0.10000000015633198
test loss is 267.53427276936674
test entropy is  2.501387916261239e-28
________________________________
0
distance x is tensor(119.4703, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.4260454770021682e-29
avg test loss is  267.4294864190921
avg accuracy is  0.3779833334896741
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9585, device='cuda:3')
compute_distance is  tensor(119.4703, device='cuda:3')
compute_norm is  tensor(47.2378, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(109.6462, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8315487024880676
avg test loss is  1.3412110167525724
avg accuracy is  0.8599666668229896
solo acc is  0.33021666682300677
compute similarity  is  tensor(0.9619, device='cuda:3')
compute_distance is  tensor(109.6462, device='cuda:3')
compute_norm is  tensor(46.0571, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(112.4907, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7946531858398462
avg test loss is  1.4009341345921253
avg accuracy is  0.8607666668229896
solo acc is  0.25423333348967164
compute similarity  is  tensor(0.9612, device='cuda:3')
compute_distance is  tensor(112.4907, device='cuda:3')
compute_norm is  tensor(45.7607, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(114.8858, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7893659868347112
avg test loss is  1.3806178164380445
avg accuracy is  0.8622000001563228
solo acc is  0.23605000015633779
compute similarity  is  tensor(0.9606, device='cuda:3')
compute_distance is  tensor(114.8858, device='cuda:3')
compute_norm is  tensor(45.4915, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.0036, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7924353916889061
avg test loss is  1.3362043683589904
avg accuracy is  0.8619833334896562
solo acc is  0.24086666682300464
compute similarity  is  tensor(0.9602, device='cuda:3')
compute_distance is  tensor(117.0036, device='cuda:3')
compute_norm is  tensor(45.2355, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(119.0482, device='cuda:3')
distance x is tensor(119.0482, device='cuda:3')
________________________________
test distance is  tensor(119.0482, device='cuda:3')
test distance1 is  tensor(119.0482, device='cuda:3')
test similarity is  tensor(0.9597, device='cuda:3')
test acc is  0.20358333348966978
test loss is 1.4085698300587344
test entropy is  0.7460927513997946
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.2584038972854614
mal norm is  tensor(590.9910, device='cuda:3')
distance x is tensor(119.0550, device='cuda:3')
mal distance is  tensor(119.0550, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([12., 34., 12., 12., 12., 35., 35., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 12., 29., 12., 13., 12., 35., 14., 35.,
        17., 18., 12., 12., 12., 35., 12., 12.])
count_res tensor([1.9108e-11, 6.8499e-02, 1.9108e-11, 1.9108e-11, 1.9108e-11, 1.8620e-01,
        1.8620e-01, 1.9108e-11, 3.1099e-06, 3.1099e-06, 3.1099e-06, 3.1099e-06,
        3.1099e-06, 3.1099e-06, 3.1099e-06, 3.1099e-06, 3.1099e-06, 3.1099e-06,
        3.1099e-06, 3.1099e-06, 1.9108e-11, 4.6154e-04, 1.9108e-11, 5.1940e-11,
        1.9108e-11, 1.8620e-01, 1.4119e-10, 1.8620e-01, 2.8358e-09, 7.7086e-09,
        1.9108e-11, 1.9108e-11, 1.9108e-11, 1.8620e-01, 1.9108e-11, 1.9108e-11])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 89.62% 

Test Accuracy: 88.89% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3997868299484253
distance x is tensor(97.6441, device='cuda:3')
benign distance is  tensor(97.6441, device='cuda:3')
norm1 res is  tensor(437.5222, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7464823722839355
distance x is tensor(107.7082, device='cuda:3')
benign distance is  tensor(107.7082, device='cuda:3')
norm1 res is  tensor(471.9163, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.16214576363563538
distance x is tensor(113.2455, device='cuda:3')
benign distance is  tensor(113.2455, device='cuda:3')
norm1 res is  tensor(487.6722, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5342829823493958
distance x is tensor(96.5893, device='cuda:3')
benign distance is  tensor(96.5893, device='cuda:3')
norm1 res is  tensor(419.0739, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.26347607374191284
distance x is tensor(98.6505, device='cuda:3')
benign distance is  tensor(98.6505, device='cuda:3')
norm1 res is  tensor(430.2208, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6562091112136841
distance x is tensor(94.1000, device='cuda:3')
benign distance is  tensor(94.1000, device='cuda:3')
norm1 res is  tensor(403.3195, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4827267527580261
distance x is tensor(78.3069, device='cuda:3')
benign distance is  tensor(78.3069, device='cuda:3')
norm1 res is  tensor(332.7865, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.916282057762146
distance x is tensor(88.5486, device='cuda:3')
benign distance is  tensor(88.5486, device='cuda:3')
norm1 res is  tensor(385.1178, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4668339788913727
distance x is tensor(133.5597, device='cuda:3')
benign distance is  tensor(133.5597, device='cuda:3')
norm1 res is  tensor(582.2305, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.2378883361816406
distance x is tensor(116.2105, device='cuda:3')
benign distance is  tensor(116.2105, device='cuda:3')
norm1 res is  tensor(507.5114, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.03259358927607536
distance x is tensor(103.9762, device='cuda:3')
benign distance is  tensor(103.9762, device='cuda:3')
norm1 res is  tensor(461.2290, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8988515734672546
distance x is tensor(115.3251, device='cuda:3')
benign distance is  tensor(115.3251, device='cuda:3')
norm1 res is  tensor(506.2863, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3614182770252228
distance x is tensor(113.2309, device='cuda:3')
benign distance is  tensor(113.2309, device='cuda:3')
norm1 res is  tensor(497.2108, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3387312591075897
distance x is tensor(84.7357, device='cuda:3')
benign distance is  tensor(84.7357, device='cuda:3')
norm1 res is  tensor(387.0186, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.23288138210773468
distance x is tensor(122.1241, device='cuda:3')
benign distance is  tensor(122.1241, device='cuda:3')
norm1 res is  tensor(535.1555, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8711949586868286
distance x is tensor(108.2012, device='cuda:3')
benign distance is  tensor(108.2012, device='cuda:3')
norm1 res is  tensor(472.3478, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3241097331047058
distance x is tensor(117.8539, device='cuda:3')
benign distance is  tensor(117.8539, device='cuda:3')
norm1 res is  tensor(530.6968, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5604432821273804
distance x is tensor(115.3610, device='cuda:3')
benign distance is  tensor(115.3610, device='cuda:3')
norm1 res is  tensor(501.0281, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.48634928464889526
distance x is tensor(126.1355, device='cuda:3')
benign distance is  tensor(126.1355, device='cuda:3')
norm1 res is  tensor(549.5608, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.1032813787460327
distance x is tensor(117.8041, device='cuda:3')
benign distance is  tensor(117.8041, device='cuda:3')
norm1 res is  tensor(512.9304, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.0317113399505615
distance x is tensor(107.1431, device='cuda:3')
benign distance is  tensor(107.1431, device='cuda:3')
norm1 res is  tensor(461.9578, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6890793442726135
distance x is tensor(103.2026, device='cuda:3')
benign distance is  tensor(103.2026, device='cuda:3')
norm1 res is  tensor(459.4232, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.3599399924278259
distance x is tensor(122.5356, device='cuda:3')
benign distance is  tensor(122.5356, device='cuda:3')
norm1 res is  tensor(539.5149, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6292113661766052
distance x is tensor(107.3102, device='cuda:3')
benign distance is  tensor(107.3102, device='cuda:3')
norm1 res is  tensor(481.7377, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(93.8334, device='cuda:3')
compute distance is  tensor(93.8334, device='cuda:3')
compute norm is  tensor(48.1404, device='cuda:3', dtype=torch.float64)
distance x is tensor(89.9696, device='cuda:3')
compute distance is  tensor(89.9696, device='cuda:3')
compute norm is  tensor(48.1002, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.7953, device='cuda:3')
compute distance is  tensor(109.7953, device='cuda:3')
compute norm is  tensor(48.4803, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.5874, device='cuda:3')
compute distance is  tensor(101.5874, device='cuda:3')
compute norm is  tensor(48.2412, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.2952, device='cuda:3')
compute distance is  tensor(111.2952, device='cuda:3')
compute norm is  tensor(48.3527, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.1160, device='cuda:3')
compute distance is  tensor(108.1160, device='cuda:3')
compute norm is  tensor(48.4644, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.1248, device='cuda:3')
compute distance is  tensor(95.1248, device='cuda:3')
compute norm is  tensor(48.2884, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.7107, device='cuda:3')
compute distance is  tensor(111.7107, device='cuda:3')
compute norm is  tensor(48.4557, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.1642, device='cuda:3')
compute distance is  tensor(108.1642, device='cuda:3')
compute norm is  tensor(48.4341, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.7389, device='cuda:3')
compute distance is  tensor(95.7389, device='cuda:3')
compute norm is  tensor(48.2344, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.3307, device='cuda:3')
compute distance is  tensor(108.3307, device='cuda:3')
compute norm is  tensor(48.4959, device='cuda:3', dtype=torch.float64)
distance x is tensor(93.6284, device='cuda:3')
compute distance is  tensor(93.6284, device='cuda:3')
compute norm is  tensor(48.1285, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(111.7107, device='cuda:3')
distance x is tensor(106213.4375, device='cuda:3')
distance x is tensor(106213.4375, device='cuda:3')
________________________________
test distance is  tensor(106213.4375, device='cuda:3')
test distance1 is  tensor(106213.4375, device='cuda:3')
test similarity is  tensor(-0.0990, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139282652606472.73
test entropy is  0.0
________________________________
cal ratio is  0.03178218044500951
distance x is tensor(3375.7002, device='cuda:3')
cal_distance is  tensor(3375.7002, device='cuda:3')
cal ratio is  0.17827542974180594
distance x is tensor(601.8085, device='cuda:3')
cal_distance is  tensor(601.8085, device='cuda:3')
cal ratio is  0.42222532265980756
distance x is tensor(254.1017, device='cuda:3')
cal_distance is  tensor(254.1017, device='cuda:3')
cal ratio is  0.6497849065156455
distance x is tensor(165.1132, device='cuda:3')
cal_distance is  tensor(165.1132, device='cuda:3')
cal ratio is  0.8060880833171697
distance x is tensor(133.0968, device='cuda:3')
cal_distance is  tensor(133.0968, device='cuda:3')
cal ratio is  0.8978207355391087
distance x is tensor(119.4976, device='cuda:3')
cal_distance is  tensor(119.4976, device='cuda:3')
cal ratio is  0.9475319871560854
distance x is tensor(113.2280, device='cuda:3')
cal_distance is  tensor(113.2280, device='cuda:3')
cal ratio is  0.9734114052350265
distance x is tensor(110.2176, device='cuda:3')
cal_distance is  tensor(110.2176, device='cuda:3')
distance x is tensor(110.2176, device='cuda:3')
return_distance is  tensor(110.2176, device='cuda:3')
distance x is tensor(110.2076, device='cuda:3')
distance x is tensor(110.2076, device='cuda:3')
________________________________
test distance is  tensor(110.2076, device='cuda:3')
test distance1 is  tensor(110.2076, device='cuda:3')
test similarity is  tensor(0.9647, device='cuda:3')
test acc is  0.10000000015633198
test loss is 212.54177988210975
test entropy is  3.166380994961361e-26
________________________________
0
distance x is tensor(110.2076, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  5.750190612074202e-27
avg test loss is  212.47234455100508
avg accuracy is  0.5350833334896756
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9647, device='cuda:3')
compute_distance is  tensor(110.2076, device='cuda:3')
compute_norm is  tensor(47.3272, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(100.9282, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8346477665626673
avg test loss is  1.347019351367503
avg accuracy is  0.8650166668229894
solo acc is  0.3257333334896734
compute similarity  is  tensor(0.9673, device='cuda:3')
compute_distance is  tensor(100.9282, device='cuda:3')
compute_norm is  tensor(46.1602, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(103.7496, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7948766350746155
avg test loss is  1.3889931087046543
avg accuracy is  0.8659666668229893
solo acc is  0.2631166668230053
compute similarity  is  tensor(0.9666, device='cuda:3')
compute_distance is  tensor(103.7496, device='cuda:3')
compute_norm is  tensor(45.8581, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(106.1182, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7827935028177843
avg test loss is  1.3708461141789645
avg accuracy is  0.8688333334896559
solo acc is  0.24333333348967134
compute similarity  is  tensor(0.9661, device='cuda:3')
compute_distance is  tensor(106.1182, device='cuda:3')
compute_norm is  tensor(45.5846, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(108.3433, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7878721040576252
avg test loss is  1.3268201051236215
avg accuracy is  0.8683333334896558
solo acc is  0.2461666668230048
compute similarity  is  tensor(0.9656, device='cuda:3')
compute_distance is  tensor(108.3433, device='cuda:3')
compute_norm is  tensor(45.3266, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(110.4116, device='cuda:3')
distance x is tensor(110.4116, device='cuda:3')
________________________________
test distance is  tensor(110.4116, device='cuda:3')
test distance1 is  tensor(110.4116, device='cuda:3')
test similarity is  tensor(0.9652, device='cuda:3')
test acc is  0.2381833334896712
test loss is 1.3170974456679339
test entropy is  0.776873036170565
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.3010154962539673
mal norm is  tensor(552.4225, device='cuda:3')
distance x is tensor(110.4182, device='cuda:3')
mal distance is  tensor(110.4182, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 20.64% 

Test Accuracy: 19.82% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.49700063467025757
distance x is tensor(144.1114, device='cuda:3')
benign distance is  tensor(144.1114, device='cuda:3')
norm1 res is  tensor(560.1807, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6548236608505249
distance x is tensor(149.9426, device='cuda:3')
benign distance is  tensor(149.9426, device='cuda:3')
norm1 res is  tensor(580.4737, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.41756147146224976
distance x is tensor(154.8086, device='cuda:3')
benign distance is  tensor(154.8086, device='cuda:3')
norm1 res is  tensor(612.4954, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2479148805141449
distance x is tensor(148.5698, device='cuda:3')
benign distance is  tensor(148.5698, device='cuda:3')
norm1 res is  tensor(572.9677, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7099604606628418
distance x is tensor(144.1544, device='cuda:3')
benign distance is  tensor(144.1544, device='cuda:3')
norm1 res is  tensor(556.1229, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5638513565063477
distance x is tensor(139.7763, device='cuda:3')
benign distance is  tensor(139.7763, device='cuda:3')
norm1 res is  tensor(548.8755, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3334693908691406
distance x is tensor(135.3260, device='cuda:3')
benign distance is  tensor(135.3260, device='cuda:3')
norm1 res is  tensor(522.7358, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.36234307289123535
distance x is tensor(150.6652, device='cuda:3')
benign distance is  tensor(150.6652, device='cuda:3')
norm1 res is  tensor(585.4401, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(145.6669, device='cuda:3')
compute distance is  tensor(145.6669, device='cuda:3')
compute norm is  tensor(46.8181, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.1490, device='cuda:3')
compute distance is  tensor(140.1490, device='cuda:3')
compute norm is  tensor(46.7769, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.9855, device='cuda:3')
compute distance is  tensor(162.9855, device='cuda:3')
compute norm is  tensor(47.3295, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.9045, device='cuda:3')
compute distance is  tensor(153.9045, device='cuda:3')
compute norm is  tensor(47.1587, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.4610, device='cuda:3')
compute distance is  tensor(155.4610, device='cuda:3')
compute norm is  tensor(47.1390, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.7234, device='cuda:3')
compute distance is  tensor(157.7234, device='cuda:3')
compute norm is  tensor(47.3360, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.3659, device='cuda:3')
compute distance is  tensor(146.3659, device='cuda:3')
compute norm is  tensor(46.8086, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.8847, device='cuda:3')
compute distance is  tensor(140.8847, device='cuda:3')
compute norm is  tensor(46.8277, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.8571, device='cuda:3')
compute distance is  tensor(161.8571, device='cuda:3')
compute norm is  tensor(47.2270, device='cuda:3', dtype=torch.float64)
distance x is tensor(192.4669, device='cuda:3')
compute distance is  tensor(192.4669, device='cuda:3')
compute norm is  tensor(47.9694, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.4527, device='cuda:3')
compute distance is  tensor(162.4527, device='cuda:3')
compute norm is  tensor(47.3069, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.5839, device='cuda:3')
compute distance is  tensor(160.5839, device='cuda:3')
compute norm is  tensor(47.2358, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(192.4669, device='cuda:3')
distance x is tensor(106150.2188, device='cuda:3')
distance x is tensor(106150.2188, device='cuda:3')
________________________________
test distance is  tensor(106150.2188, device='cuda:3')
test distance1 is  tensor(106150.2188, device='cuda:3')
test similarity is  tensor(0.1229, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139289831412646.48
test entropy is  0.0
________________________________
cal ratio is  0.041729545559906676
distance x is tensor(4429.6060, device='cuda:3')
cal_distance is  tensor(4429.6060, device='cuda:3')
cal ratio is  0.20427797843527407
distance x is tensor(904.8749, device='cuda:3')
cal_distance is  tensor(904.8749, device='cuda:3')
cal ratio is  0.4519702301876821
distance x is tensor(408.9792, device='cuda:3')
cal_distance is  tensor(408.9792, device='cuda:3')
cal ratio is  0.6722850774137312
distance x is tensor(274.9523, device='cuda:3')
cal_distance is  tensor(274.9523, device='cuda:3')
cal ratio is  0.8199274124605508
distance x is tensor(225.4418, device='cuda:3')
cal_distance is  tensor(225.4418, device='cuda:3')
cal ratio is  0.9054966293795669
distance x is tensor(204.1373, device='cuda:3')
cal_distance is  tensor(204.1373, device='cuda:3')
cal ratio is  0.9515747329100995
distance x is tensor(194.2522, device='cuda:3')
cal_distance is  tensor(194.2522, device='cuda:3')
cal ratio is  0.9754862896284745
distance x is tensor(189.4904, device='cuda:3')
cal_distance is  tensor(189.4904, device='cuda:3')
distance x is tensor(189.4904, device='cuda:3')
return_distance is  tensor(189.4904, device='cuda:3')
distance x is tensor(189.4805, device='cuda:3')
distance x is tensor(189.4805, device='cuda:3')
________________________________
test distance is  tensor(189.4805, device='cuda:3')
test distance1 is  tensor(189.4805, device='cuda:3')
test similarity is  tensor(0.9123, device='cuda:3')
test acc is  0.10000000015633198
test loss is 1512.1924339570978
test entropy is  0.0
________________________________
0
distance x is tensor(189.4805, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  1512.437795155084
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9123, device='cuda:3')
compute_distance is  tensor(189.4805, device='cuda:3')
compute_norm is  tensor(49.4565, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1049.3953, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5624535083770752
avg test loss is  2.849868378405378
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3314, device='cuda:3')
compute_distance is  tensor(1049.3953, device='cuda:3')
compute_norm is  tensor(124.5443, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1045.2784, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.839766263961792
avg test loss is  3.581634344322595
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3315, device='cuda:3')
compute_distance is  tensor(1045.2784, device='cuda:3')
compute_norm is  tensor(124.3458, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1040.3154, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5541887283325195
avg test loss is  2.851734432584441
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3314, device='cuda:3')
compute_distance is  tensor(1040.3154, device='cuda:3')
compute_norm is  tensor(123.3972, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1036.2825, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8395767211914062
avg test loss is  3.5778851587889293
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3315, device='cuda:3')
compute_distance is  tensor(1036.2825, device='cuda:3')
compute_norm is  tensor(123.2041, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1031.3917, device='cuda:3')
distance x is tensor(1031.3917, device='cuda:3')
________________________________
test distance is  tensor(1031.3917, device='cuda:3')
test distance1 is  tensor(1031.3917, device='cuda:3')
test similarity is  tensor(0.3314, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.852216968150027
test entropy is  1.553236484527588
________________________________
cal ratio is  0.4233429012201374
distance x is tensor(436.6342, device='cuda:3')
cal_distance is  tensor(436.6342, device='cuda:3')
cal ratio is  0.6506467195471259
distance x is tensor(284.0950, device='cuda:3')
cal_distance is  tensor(284.0950, device='cuda:3')
cal ratio is  0.8066261260200515
distance x is tensor(229.1587, device='cuda:3')
cal_distance is  tensor(229.1587, device='cuda:3')
cal ratio is  0.8981231580860043
distance x is tensor(205.8129, device='cuda:3')
cal_distance is  tensor(205.8129, device='cuda:3')
cal ratio is  0.9476933093014631
distance x is tensor(195.0475, device='cuda:3')
cal_distance is  tensor(195.0475, device='cuda:3')
cal ratio is  0.9734953499223988
distance x is tensor(189.8779, device='cuda:3')
cal_distance is  tensor(189.8779, device='cuda:3')
distance x is tensor(189.8779, device='cuda:3')
return_distance is  tensor(189.8779, device='cuda:3')
distance x is tensor(189.8754, device='cuda:3')
distance x is tensor(189.8754, device='cuda:3')
________________________________
test distance is  tensor(189.8754, device='cuda:3')
test distance1 is  tensor(189.8754, device='cuda:3')
test similarity is  tensor(0.8648, device='cuda:3')
test acc is  0.11055000015633196
test loss is 2.403283877921765
test entropy is  1.954513419411584
________________________________
0
distance x is tensor(189.8754, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.95426461500908
avg test loss is  2.4027140478589644
avg accuracy is  0.3463500001563403
solo acc is  0.11126666682299861
compute similarity  is  tensor(0.8648, device='cuda:3')
compute_distance is  tensor(189.8754, device='cuda:3')
compute_norm is  tensor(53.4037, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(191.3142, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.598727680790399
avg test loss is  2.4333178235777915
avg accuracy is  0.1003333334896653
solo acc is  0.10161666682299864
compute similarity  is  tensor(0.8648, device='cuda:3')
compute_distance is  tensor(191.3142, device='cuda:3')
compute_norm is  tensor(53.1674, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(193.1041, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9064612428008366
avg test loss is  1.4099663268528513
avg accuracy is  0.10071666682299864
solo acc is  0.2956000001563394
compute similarity  is  tensor(0.8645, device='cuda:3')
compute_distance is  tensor(193.1041, device='cuda:3')
compute_norm is  tensor(52.9052, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(193.1041, device='cuda:3')
distance x is tensor(193.1041, device='cuda:3')
________________________________
test distance is  tensor(193.1041, device='cuda:3')
test distance1 is  tensor(193.1041, device='cuda:3')
test similarity is  tensor(0.8645, device='cuda:3')
test acc is  0.2980333334896728
test loss is 1.40888430937521
test entropy is  0.9060035797197428
________________________________
cal ratio is  0.9783817460566041
distance x is tensor(188.9300, device='cuda:3')
cal_distance is  tensor(188.9300, device='cuda:3')
distance x is tensor(188.9300, device='cuda:3')
return_distance is  tensor(188.9300, device='cuda:3')
distance x is tensor(188.9295, device='cuda:3')
distance x is tensor(188.9295, device='cuda:3')
________________________________
test distance is  tensor(188.9295, device='cuda:3')
test distance1 is  tensor(188.9295, device='cuda:3')
test similarity is  tensor(0.8691, device='cuda:3')
test acc is  0.2801000001563391
test loss is 1.4487416274003637
test entropy is  0.8838893196094774
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal loss is 1.077022671699524
mal norm is  tensor(1168.5819, device='cuda:3')
distance x is tensor(188.9300, device='cuda:3')
mal distance is  tensor(188.9300, device='cuda:3')
user_PLR len size 44
counter_tensor is  tensor([27., 27., 27., 27., 36., 27., 27., 27., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 31., 37., 18., 16., 16., 14., 21., 35.,
        43., 16., 21., 22., 40., 43., 19., 25., 36., 19., 21., 40., 32., 43.,
        36., 41.])
count_res tensor([3.4726e-08, 3.4726e-08, 3.4726e-08, 3.4726e-08, 2.8139e-04, 3.4726e-08,
        3.4726e-08, 3.4726e-08, 5.1538e-06, 5.1538e-06, 5.1538e-06, 5.1538e-06,
        5.1538e-06, 5.1538e-06, 5.1538e-06, 5.1538e-06, 5.1538e-06, 5.1538e-06,
        5.1538e-06, 5.1538e-06, 1.8960e-06, 7.6489e-04, 4.2855e-12, 5.7998e-13,
        5.7998e-13, 7.8492e-14, 8.6077e-11, 1.0352e-04, 3.0858e-01, 5.7998e-13,
        8.6077e-11, 2.3398e-10, 1.5363e-02, 3.0858e-01, 1.1649e-11, 4.6996e-09,
        2.8139e-04, 1.1649e-11, 8.6077e-11, 1.5363e-02, 5.1538e-06, 3.0858e-01,
        2.8139e-04, 4.1761e-02])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 89.55% 

Test Accuracy: 88.65% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5703061819076538
distance x is tensor(107.4040, device='cuda:3')
benign distance is  tensor(107.4040, device='cuda:3')
norm1 res is  tensor(483.3091, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5693846940994263
distance x is tensor(102.1151, device='cuda:3')
benign distance is  tensor(102.1151, device='cuda:3')
norm1 res is  tensor(455.2409, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1452203392982483
distance x is tensor(121.4256, device='cuda:3')
benign distance is  tensor(121.4256, device='cuda:3')
norm1 res is  tensor(530.1303, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7157478332519531
distance x is tensor(101.4995, device='cuda:3')
benign distance is  tensor(101.4995, device='cuda:3')
norm1 res is  tensor(453.4918, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5905693769454956
distance x is tensor(101.9152, device='cuda:3')
benign distance is  tensor(101.9152, device='cuda:3')
norm1 res is  tensor(435.7177, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0287940502166748
distance x is tensor(113.8071, device='cuda:3')
benign distance is  tensor(113.8071, device='cuda:3')
norm1 res is  tensor(506.9448, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3224641680717468
distance x is tensor(105.5933, device='cuda:3')
benign distance is  tensor(105.5933, device='cuda:3')
norm1 res is  tensor(456.8572, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.633104145526886
distance x is tensor(103.0061, device='cuda:3')
benign distance is  tensor(103.0061, device='cuda:3')
norm1 res is  tensor(453.6253, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7123324275016785
distance x is tensor(124.1020, device='cuda:3')
benign distance is  tensor(124.1020, device='cuda:3')
norm1 res is  tensor(550.0475, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9176262021064758
distance x is tensor(115.4050, device='cuda:3')
benign distance is  tensor(115.4050, device='cuda:3')
norm1 res is  tensor(503.7820, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3670930862426758
distance x is tensor(107.1762, device='cuda:3')
benign distance is  tensor(107.1762, device='cuda:3')
norm1 res is  tensor(464.9378, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7778141498565674
distance x is tensor(106.0778, device='cuda:3')
benign distance is  tensor(106.0778, device='cuda:3')
norm1 res is  tensor(465.4331, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.49739426374435425
distance x is tensor(108.6472, device='cuda:3')
benign distance is  tensor(108.6472, device='cuda:3')
norm1 res is  tensor(482.1339, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.06171637773513794
distance x is tensor(94.0581, device='cuda:3')
benign distance is  tensor(94.0581, device='cuda:3')
norm1 res is  tensor(417.5788, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2602923810482025
distance x is tensor(116.3634, device='cuda:3')
benign distance is  tensor(116.3634, device='cuda:3')
norm1 res is  tensor(507.6221, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9501304626464844
distance x is tensor(120.1023, device='cuda:3')
benign distance is  tensor(120.1023, device='cuda:3')
norm1 res is  tensor(523.7006, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2646099030971527
distance x is tensor(103.1024, device='cuda:3')
benign distance is  tensor(103.1024, device='cuda:3')
norm1 res is  tensor(462.9559, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8330607414245605
distance x is tensor(123.1176, device='cuda:3')
benign distance is  tensor(123.1176, device='cuda:3')
norm1 res is  tensor(538.8158, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.6304114460945129
distance x is tensor(119.8929, device='cuda:3')
benign distance is  tensor(119.8929, device='cuda:3')
norm1 res is  tensor(516.0236, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.33181941509246826
distance x is tensor(119.5953, device='cuda:3')
benign distance is  tensor(119.5953, device='cuda:3')
norm1 res is  tensor(523.6061, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5744989514350891
distance x is tensor(114.1054, device='cuda:3')
benign distance is  tensor(114.1054, device='cuda:3')
norm1 res is  tensor(501.5816, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.011322259902954
distance x is tensor(84.5710, device='cuda:3')
benign distance is  tensor(84.5710, device='cuda:3')
norm1 res is  tensor(383.7486, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2860686480998993
distance x is tensor(114.2885, device='cuda:3')
benign distance is  tensor(114.2885, device='cuda:3')
norm1 res is  tensor(515.4533, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.28213784098625183
distance x is tensor(106.4642, device='cuda:3')
benign distance is  tensor(106.4642, device='cuda:3')
norm1 res is  tensor(466.3585, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.033508896827697754
distance x is tensor(114.3693, device='cuda:3')
benign distance is  tensor(114.3693, device='cuda:3')
norm1 res is  tensor(505.0011, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.3005920946598053
distance x is tensor(120.5864, device='cuda:3')
benign distance is  tensor(120.5864, device='cuda:3')
norm1 res is  tensor(510.0089, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.2627418637275696
distance x is tensor(116.3214, device='cuda:3')
benign distance is  tensor(116.3214, device='cuda:3')
norm1 res is  tensor(505.8006, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.30492088198661804
distance x is tensor(110.3553, device='cuda:3')
benign distance is  tensor(110.3553, device='cuda:3')
norm1 res is  tensor(479.8063, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7241975665092468
distance x is tensor(113.7700, device='cuda:3')
benign distance is  tensor(113.7700, device='cuda:3')
norm1 res is  tensor(502.6015, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6520483493804932
distance x is tensor(122.7526, device='cuda:3')
benign distance is  tensor(122.7526, device='cuda:3')
norm1 res is  tensor(541.6642, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8544363975524902
distance x is tensor(120.0079, device='cuda:3')
benign distance is  tensor(120.0079, device='cuda:3')
norm1 res is  tensor(518.3102, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.31718653440475464
distance x is tensor(121.0670, device='cuda:3')
benign distance is  tensor(121.0670, device='cuda:3')
norm1 res is  tensor(546.8808, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(95.4371, device='cuda:3')
compute distance is  tensor(95.4371, device='cuda:3')
compute norm is  tensor(48.4332, device='cuda:3', dtype=torch.float64)
distance x is tensor(96.8239, device='cuda:3')
compute distance is  tensor(96.8239, device='cuda:3')
compute norm is  tensor(48.5106, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.5244, device='cuda:3')
compute distance is  tensor(121.5244, device='cuda:3')
compute norm is  tensor(49.1429, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.9403, device='cuda:3')
compute distance is  tensor(104.9403, device='cuda:3')
compute norm is  tensor(48.6650, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.3297, device='cuda:3')
compute distance is  tensor(112.3297, device='cuda:3')
compute norm is  tensor(48.7262, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.5599, device='cuda:3')
compute distance is  tensor(110.5599, device='cuda:3')
compute norm is  tensor(48.8989, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.7839, device='cuda:3')
compute distance is  tensor(102.7839, device='cuda:3')
compute norm is  tensor(48.6803, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.9174, device='cuda:3')
compute distance is  tensor(118.9174, device='cuda:3')
compute norm is  tensor(48.9956, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.2514, device='cuda:3')
compute distance is  tensor(113.2514, device='cuda:3')
compute norm is  tensor(48.7884, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.3120, device='cuda:3')
compute distance is  tensor(98.3120, device='cuda:3')
compute norm is  tensor(48.6260, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.8190, device='cuda:3')
compute distance is  tensor(110.8190, device='cuda:3')
compute norm is  tensor(48.8339, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.8938, device='cuda:3')
compute distance is  tensor(102.8938, device='cuda:3')
compute norm is  tensor(48.5659, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(121.5244, device='cuda:3')
distance x is tensor(106216.2344, device='cuda:3')
distance x is tensor(106216.2344, device='cuda:3')
________________________________
test distance is  tensor(106216.2344, device='cuda:3')
test distance1 is  tensor(106216.2344, device='cuda:3')
test similarity is  tensor(-0.1002, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139282018756813.23
test entropy is  0.0
________________________________
cal ratio is  0.03314838830170249
distance x is tensor(3520.9021, device='cuda:3')
cal_distance is  tensor(3520.9021, device='cuda:3')
cal ratio is  0.1820668537169014
distance x is tensor(641.0436, device='cuda:3')
cal_distance is  tensor(641.0436, device='cuda:3')
cal ratio is  0.42669157383752127
distance x is tensor(273.5308, device='cuda:3')
cal_distance is  tensor(273.5308, device='cuda:3')
cal ratio is  0.6532129364043311
distance x is tensor(178.6756, device='cuda:3')
cal_distance is  tensor(178.6756, device='cuda:3')
cal ratio is  0.8082118990289581
distance x is tensor(144.4087, device='cuda:3')
cal_distance is  tensor(144.4087, device='cuda:3')
cal ratio is  0.8990030084311417
distance x is tensor(129.8244, device='cuda:3')
cal_distance is  tensor(129.8244, device='cuda:3')
cal ratio is  0.9481558293313713
distance x is tensor(123.0940, device='cuda:3')
cal_distance is  tensor(123.0940, device='cuda:3')
cal ratio is  0.9737318850510702
distance x is tensor(119.8607, device='cuda:3')
cal_distance is  tensor(119.8607, device='cuda:3')
distance x is tensor(119.8607, device='cuda:3')
return_distance is  tensor(119.8607, device='cuda:3')
distance x is tensor(119.8507, device='cuda:3')
distance x is tensor(119.8507, device='cuda:3')
________________________________
test distance is  tensor(119.8507, device='cuda:3')
test distance1 is  tensor(119.8507, device='cuda:3')
test similarity is  tensor(0.9592, device='cuda:3')
test acc is  0.10000000015633198
test loss is 273.2995731866182
test entropy is  1.7088116742188598e-30
________________________________
0
distance x is tensor(119.8507, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.269668882918771e-29
avg test loss is  273.2992314580661
avg accuracy is  0.41150000015634125
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9592, device='cuda:3')
compute_distance is  tensor(119.8507, device='cuda:3')
compute_norm is  tensor(47.7849, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(106.8139, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8173638601292933
avg test loss is  1.407478599660178
avg accuracy is  0.8666500001563227
solo acc is  0.3016500001563395
compute similarity  is  tensor(0.9630, device='cuda:3')
compute_distance is  tensor(106.8139, device='cuda:3')
compute_norm is  tensor(46.5775, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(109.5370, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7884635835059924
avg test loss is  1.4243926747775535
avg accuracy is  0.8671166668229893
solo acc is  0.25278333348967164
compute similarity  is  tensor(0.9623, device='cuda:3')
compute_distance is  tensor(109.5370, device='cuda:3')
compute_norm is  tensor(46.2746, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(111.9306, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7998782757248706
avg test loss is  1.3513215329092958
avg accuracy is  0.8707500001563225
solo acc is  0.25580000015633836
compute similarity  is  tensor(0.9618, device='cuda:3')
compute_distance is  tensor(111.9306, device='cuda:3')
compute_norm is  tensor(46.0002, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(114.2072, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7783412293457528
avg test loss is  1.3648359747583678
avg accuracy is  0.8708000001563225
solo acc is  0.23103333348967092
compute similarity  is  tensor(0.9613, device='cuda:3')
compute_distance is  tensor(114.2072, device='cuda:3')
compute_norm is  tensor(45.7378, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(116.3525, device='cuda:3')
distance x is tensor(116.3525, device='cuda:3')
________________________________
test distance is  tensor(116.3525, device='cuda:3')
test distance1 is  tensor(116.3525, device='cuda:3')
test similarity is  tensor(0.9608, device='cuda:3')
test acc is  0.23675000015633785
test loss is 1.3216805112387326
test entropy is  0.7821596762391804
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.2887930870056152
mal norm is  tensor(589.9756, device='cuda:3')
distance x is tensor(116.3595, device='cuda:3')
mal distance is  tensor(116.3595, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 20.30% 

Test Accuracy: 19.22% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5820619463920593
distance x is tensor(164.7294, device='cuda:3')
benign distance is  tensor(164.7294, device='cuda:3')
norm1 res is  tensor(624.1505, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.45784372091293335
distance x is tensor(163.9591, device='cuda:3')
benign distance is  tensor(163.9591, device='cuda:3')
norm1 res is  tensor(644.4520, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9483696818351746
distance x is tensor(154.0723, device='cuda:3')
benign distance is  tensor(154.0723, device='cuda:3')
norm1 res is  tensor(602.0805, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7531698942184448
distance x is tensor(152.7270, device='cuda:3')
benign distance is  tensor(152.7270, device='cuda:3')
norm1 res is  tensor(594.2146, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7607768774032593
distance x is tensor(152.2093, device='cuda:3')
benign distance is  tensor(152.2093, device='cuda:3')
norm1 res is  tensor(586.7048, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7131953239440918
distance x is tensor(169.3160, device='cuda:3')
benign distance is  tensor(169.3160, device='cuda:3')
norm1 res is  tensor(649.3143, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9075098037719727
distance x is tensor(147.9268, device='cuda:3')
benign distance is  tensor(147.9268, device='cuda:3')
norm1 res is  tensor(569.1944, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5108428597450256
distance x is tensor(157.9625, device='cuda:3')
benign distance is  tensor(157.9625, device='cuda:3')
norm1 res is  tensor(610.5048, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(157.3593, device='cuda:3')
compute distance is  tensor(157.3593, device='cuda:3')
compute norm is  tensor(47.5110, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.6668, device='cuda:3')
compute distance is  tensor(162.6668, device='cuda:3')
compute norm is  tensor(47.4898, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.7403, device='cuda:3')
compute distance is  tensor(158.7403, device='cuda:3')
compute norm is  tensor(47.5395, device='cuda:3', dtype=torch.float64)
distance x is tensor(163.9937, device='cuda:3')
compute distance is  tensor(163.9937, device='cuda:3')
compute norm is  tensor(47.6198, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.1405, device='cuda:3')
compute distance is  tensor(164.1405, device='cuda:3')
compute norm is  tensor(47.6347, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.1653, device='cuda:3')
compute distance is  tensor(162.1653, device='cuda:3')
compute norm is  tensor(47.7327, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.7216, device='cuda:3')
compute distance is  tensor(158.7216, device='cuda:3')
compute norm is  tensor(47.4144, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.1960, device='cuda:3')
compute distance is  tensor(160.1960, device='cuda:3')
compute norm is  tensor(47.7979, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.6163, device='cuda:3')
compute distance is  tensor(159.6163, device='cuda:3')
compute norm is  tensor(47.6254, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.3021, device='cuda:3')
compute distance is  tensor(154.3021, device='cuda:3')
compute norm is  tensor(47.5557, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.2485, device='cuda:3')
compute distance is  tensor(159.2485, device='cuda:3')
compute norm is  tensor(47.4270, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.2986, device='cuda:3')
compute distance is  tensor(153.2986, device='cuda:3')
compute norm is  tensor(47.4403, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(164.1405, device='cuda:3')
distance x is tensor(106148.9688, device='cuda:3')
distance x is tensor(106148.9688, device='cuda:3')
________________________________
test distance is  tensor(106148.9688, device='cuda:3')
test distance1 is  tensor(106148.9688, device='cuda:3')
test similarity is  tensor(0.1383, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139293036397487.22
test entropy is  0.0
________________________________
cal ratio is  0.03853683664623568
distance x is tensor(4090.6506, device='cuda:3')
cal_distance is  tensor(4090.6506, device='cuda:3')
cal ratio is  0.19630789131841214
distance x is tensor(803.0309, device='cuda:3')
cal_distance is  tensor(803.0309, device='cuda:3')
cal ratio is  0.4430653860859417
distance x is tensor(355.7980, device='cuda:3')
cal_distance is  tensor(355.7980, device='cuda:3')
cal ratio is  0.6656289515669033
distance x is tensor(236.8312, device='cuda:3')
cal_distance is  tensor(236.8312, device='cuda:3')
cal ratio is  0.8158578792924693
distance x is tensor(193.2215, device='cuda:3')
cal_distance is  tensor(193.2215, device='cuda:3')
cal ratio is  0.9032464410514834
distance x is tensor(174.5271, device='cuda:3')
cal_distance is  tensor(174.5271, device='cuda:3')
cal ratio is  0.9503913920783958
distance x is tensor(165.8693, device='cuda:3')
cal_distance is  tensor(165.8693, device='cuda:3')
cal ratio is  0.9748794670795019
distance x is tensor(161.7027, device='cuda:3')
cal_distance is  tensor(161.7027, device='cuda:3')
distance x is tensor(161.7027, device='cuda:3')
return_distance is  tensor(161.7027, device='cuda:3')
distance x is tensor(161.6927, device='cuda:3')
distance x is tensor(161.6927, device='cuda:3')
________________________________
test distance is  tensor(161.6927, device='cuda:3')
test distance1 is  tensor(161.6927, device='cuda:3')
test similarity is  tensor(0.9350, device='cuda:3')
test acc is  0.10000000015633198
test loss is 885.2590164152035
test entropy is  0.0
________________________________
0
distance x is tensor(161.6927, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  885.2788161418077
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9350, device='cuda:3')
compute_distance is  tensor(161.6927, device='cuda:3')
compute_norm is  tensor(49.0170, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(380.8143, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5607208994660042
avg test loss is  2.849508532074723
avg accuracy is  0.156133333489667
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6633, device='cuda:3')
compute_distance is  tensor(380.8143, device='cuda:3')
compute_norm is  tensor(69.5200, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(380.0824, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8372448970641154
avg test loss is  3.583341522257465
avg accuracy is  0.13118333348966527
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6631, device='cuda:3')
compute_distance is  tensor(380.0824, device='cuda:3')
compute_norm is  tensor(69.5675, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(378.4661, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5536540615787384
avg test loss is  2.852013233882278
avg accuracy is  0.15825000015633386
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6632, device='cuda:3')
compute_distance is  tensor(378.4661, device='cuda:3')
compute_norm is  tensor(68.8848, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(377.8418, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8373303422287329
avg test loss is  3.5806245081968653
avg accuracy is  0.13083333348966525
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6631, device='cuda:3')
compute_distance is  tensor(377.8418, device='cuda:3')
compute_norm is  tensor(68.9366, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(376.2801, device='cuda:3')
distance x is tensor(376.2801, device='cuda:3')
________________________________
test distance is  tensor(376.2801, device='cuda:3')
test distance1 is  tensor(376.2801, device='cuda:3')
test similarity is  tensor(0.6632, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.849615343089805
test entropy is  1.554568478420599
________________________________
cal ratio is  0.6472593361566882
distance x is tensor(243.5543, device='cuda:3')
cal_distance is  tensor(243.5543, device='cuda:3')
cal ratio is  0.8045185097289261
distance x is tensor(195.9444, device='cuda:3')
cal_distance is  tensor(195.9444, device='cuda:3')
cal ratio is  0.8969486604540733
distance x is tensor(175.7522, device='cuda:3')
cal_distance is  tensor(175.7522, device='cuda:3')
cal ratio is  0.9470731215101968
distance x is tensor(166.4503, device='cuda:3')
cal_distance is  tensor(166.4503, device='cuda:3')
cal ratio is  0.9731765568770666
distance x is tensor(161.9856, device='cuda:3')
cal_distance is  tensor(161.9856, device='cuda:3')
distance x is tensor(161.9856, device='cuda:3')
return_distance is  tensor(161.9856, device='cuda:3')
distance x is tensor(161.9814, device='cuda:3')
distance x is tensor(161.9814, device='cuda:3')
________________________________
test distance is  tensor(161.9814, device='cuda:3')
test distance1 is  tensor(161.9814, device='cuda:3')
test similarity is  tensor(0.8952, device='cuda:3')
test acc is  0.1498166668229999
test loss is 4.441090349957887
test entropy is  1.2348795899195966
________________________________
0
distance x is tensor(161.9814, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.234739273977178
avg test loss is  4.448996347150823
avg accuracy is  0.22635000015633747
solo acc is  0.15025000015633325
compute similarity  is  tensor(0.8952, device='cuda:3')
compute_distance is  tensor(161.9814, device='cuda:3')
compute_norm is  tensor(52.0479, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(166.3911, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6953316307398302
avg test loss is  2.7450705817513374
avg accuracy is  0.11171666682299862
solo acc is  0.10245000015633197
compute similarity  is  tensor(0.8944, device='cuda:3')
compute_distance is  tensor(166.3911, device='cuda:3')
compute_norm is  tensor(52.0313, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(169.1761, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9684141217899729
avg test loss is  1.5675415739830114
avg accuracy is  0.1173166668229986
solo acc is  0.18491666682300223
compute similarity  is  tensor(0.8940, device='cuda:3')
compute_distance is  tensor(169.1761, device='cuda:3')
compute_norm is  tensor(51.7962, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(169.1761, device='cuda:3')
distance x is tensor(169.1761, device='cuda:3')
________________________________
test distance is  tensor(169.1761, device='cuda:3')
test distance1 is  tensor(169.1761, device='cuda:3')
test similarity is  tensor(0.8940, device='cuda:3')
test acc is  0.18693333348966898
test loss is 1.566353303918452
test entropy is  0.9686993617238775
________________________________
cal ratio is  0.9653046435317068
distance x is tensor(163.3092, device='cuda:3')
cal_distance is  tensor(163.3092, device='cuda:3')
distance x is tensor(163.3092, device='cuda:3')
return_distance is  tensor(163.3092, device='cuda:3')
distance x is tensor(163.3065, device='cuda:3')
distance x is tensor(163.3065, device='cuda:3')
________________________________
test distance is  tensor(163.3065, device='cuda:3')
test distance1 is  tensor(163.3065, device='cuda:3')
test similarity is  tensor(0.9001, device='cuda:3')
test acc is  0.16831666682300123
test loss is 1.6377310665177385
test entropy is  0.9435905078326715
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.4201161861419678
mal norm is  tensor(999.6652, device='cuda:3')
distance x is tensor(163.3092, device='cuda:3')
mal distance is  tensor(163.3092, device='cuda:3')
user_PLR len size 44
counter_tensor is  tensor([ 0., 23.,  0., 12., 15., 12., 17., 12., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 12., 12., 43., 12., 41., 12., 38., 12.,
        43., 38., 42., 12., 23., 13., 40., 12., 12., 12., 12., 12., 41., 42.,
        42., 43.])
count_res tensor([4.7662e-20, 4.6446e-10, 4.7662e-20, 7.7572e-15, 1.5581e-13, 7.7572e-15,
        1.1513e-12, 7.7572e-15, 3.7635e-06, 3.7635e-06, 3.7635e-06, 3.7635e-06,
        3.7635e-06, 3.7635e-06, 3.7635e-06, 3.7635e-06, 3.7635e-06, 3.7635e-06,
        3.7635e-06, 3.7635e-06, 7.7572e-15, 7.7572e-15, 2.2534e-01, 7.7572e-15,
        3.0496e-02, 7.7572e-15, 1.5183e-03, 7.7572e-15, 2.2534e-01, 1.5183e-03,
        8.2897e-02, 7.7572e-15, 4.6446e-10, 2.1086e-14, 1.1219e-02, 7.7572e-15,
        7.7572e-15, 7.7572e-15, 7.7572e-15, 7.7572e-15, 3.0496e-02, 8.2897e-02,
        8.2897e-02, 2.2534e-01])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 89.86% 

Test Accuracy: 89.42% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6646844744682312
distance x is tensor(111.6662, device='cuda:3')
benign distance is  tensor(111.6662, device='cuda:3')
norm1 res is  tensor(488.4044, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6216717958450317
distance x is tensor(97.5418, device='cuda:3')
benign distance is  tensor(97.5418, device='cuda:3')
norm1 res is  tensor(450.8208, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3903655409812927
distance x is tensor(109.3322, device='cuda:3')
benign distance is  tensor(109.3322, device='cuda:3')
norm1 res is  tensor(475.9125, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.42023906111717224
distance x is tensor(112.0400, device='cuda:3')
benign distance is  tensor(112.0400, device='cuda:3')
norm1 res is  tensor(485.7154, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3668753504753113
distance x is tensor(96.6221, device='cuda:3')
benign distance is  tensor(96.6221, device='cuda:3')
norm1 res is  tensor(421.5049, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7655578851699829
distance x is tensor(94.5679, device='cuda:3')
benign distance is  tensor(94.5679, device='cuda:3')
norm1 res is  tensor(421.2177, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.309993714094162
distance x is tensor(93.7624, device='cuda:3')
benign distance is  tensor(93.7624, device='cuda:3')
norm1 res is  tensor(408.7953, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5343930125236511
distance x is tensor(94.1867, device='cuda:3')
benign distance is  tensor(94.1867, device='cuda:3')
norm1 res is  tensor(409.2951, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7962928414344788
distance x is tensor(115.3584, device='cuda:3')
benign distance is  tensor(115.3584, device='cuda:3')
norm1 res is  tensor(499.6912, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.763881504535675
distance x is tensor(109.9651, device='cuda:3')
benign distance is  tensor(109.9651, device='cuda:3')
norm1 res is  tensor(481.0951, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6025098562240601
distance x is tensor(101.9259, device='cuda:3')
benign distance is  tensor(101.9259, device='cuda:3')
norm1 res is  tensor(449.5143, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.48643797636032104
distance x is tensor(105.1376, device='cuda:3')
benign distance is  tensor(105.1376, device='cuda:3')
norm1 res is  tensor(462.5465, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5357486009597778
distance x is tensor(110.5327, device='cuda:3')
benign distance is  tensor(110.5327, device='cuda:3')
norm1 res is  tensor(491.6342, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5297322273254395
distance x is tensor(85.5529, device='cuda:3')
benign distance is  tensor(85.5529, device='cuda:3')
norm1 res is  tensor(384.7467, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6075611114501953
distance x is tensor(108.5396, device='cuda:3')
benign distance is  tensor(108.5396, device='cuda:3')
norm1 res is  tensor(476.9121, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8014610409736633
distance x is tensor(97.1591, device='cuda:3')
benign distance is  tensor(97.1591, device='cuda:3')
norm1 res is  tensor(433.2849, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.1553904116153717
distance x is tensor(105.1500, device='cuda:3')
benign distance is  tensor(105.1500, device='cuda:3')
norm1 res is  tensor(460.5497, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.0354734659194946
distance x is tensor(108.8077, device='cuda:3')
benign distance is  tensor(108.8077, device='cuda:3')
norm1 res is  tensor(473.7930, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.33288106322288513
distance x is tensor(108.5710, device='cuda:3')
benign distance is  tensor(108.5710, device='cuda:3')
norm1 res is  tensor(470.4593, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3410723805427551
distance x is tensor(115.4933, device='cuda:3')
benign distance is  tensor(115.4933, device='cuda:3')
norm1 res is  tensor(505.5574, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8698590993881226
distance x is tensor(106.3669, device='cuda:3')
benign distance is  tensor(106.3669, device='cuda:3')
norm1 res is  tensor(470.7159, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8764772415161133
distance x is tensor(104.7185, device='cuda:3')
benign distance is  tensor(104.7185, device='cuda:3')
norm1 res is  tensor(474.1616, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.31440168619155884
distance x is tensor(109.3845, device='cuda:3')
benign distance is  tensor(109.3845, device='cuda:3')
norm1 res is  tensor(482.8474, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.37062087655067444
distance x is tensor(110.3602, device='cuda:3')
benign distance is  tensor(110.3602, device='cuda:3')
norm1 res is  tensor(493.5228, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.5233432650566101
distance x is tensor(108.2496, device='cuda:3')
benign distance is  tensor(108.2496, device='cuda:3')
norm1 res is  tensor(477.6778, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.5790073275566101
distance x is tensor(112.4272, device='cuda:3')
benign distance is  tensor(112.4272, device='cuda:3')
norm1 res is  tensor(500.6998, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.242849588394165
distance x is tensor(86.8788, device='cuda:3')
benign distance is  tensor(86.8788, device='cuda:3')
norm1 res is  tensor(392.0076, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.13568313419818878
distance x is tensor(111.8949, device='cuda:3')
benign distance is  tensor(111.8949, device='cuda:3')
norm1 res is  tensor(490.5247, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5145866870880127
distance x is tensor(110.0778, device='cuda:3')
benign distance is  tensor(110.0778, device='cuda:3')
norm1 res is  tensor(490.6316, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8537980914115906
distance x is tensor(106.9466, device='cuda:3')
benign distance is  tensor(106.9466, device='cuda:3')
norm1 res is  tensor(451.2293, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.6017484068870544
distance x is tensor(87.8851, device='cuda:3')
benign distance is  tensor(87.8851, device='cuda:3')
norm1 res is  tensor(388.4445, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.1657734513282776
distance x is tensor(110.3626, device='cuda:3')
benign distance is  tensor(110.3626, device='cuda:3')
norm1 res is  tensor(480.6087, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(95.9227, device='cuda:3')
compute distance is  tensor(95.9227, device='cuda:3')
compute norm is  tensor(48.5880, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.6807, device='cuda:3')
compute distance is  tensor(100.6807, device='cuda:3')
compute norm is  tensor(48.6923, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.9801, device='cuda:3')
compute distance is  tensor(102.9801, device='cuda:3')
compute norm is  tensor(48.9033, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.1029, device='cuda:3')
compute distance is  tensor(95.1029, device='cuda:3')
compute norm is  tensor(48.6162, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.9749, device='cuda:3')
compute distance is  tensor(99.9749, device='cuda:3')
compute norm is  tensor(48.6471, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.8452, device='cuda:3')
compute distance is  tensor(107.8452, device='cuda:3')
compute norm is  tensor(48.8897, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.1541, device='cuda:3')
compute distance is  tensor(99.1541, device='cuda:3')
compute norm is  tensor(48.7228, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.3176, device='cuda:3')
compute distance is  tensor(105.3176, device='cuda:3')
compute norm is  tensor(48.6809, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.3299, device='cuda:3')
compute distance is  tensor(105.3299, device='cuda:3')
compute norm is  tensor(48.8851, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.1009, device='cuda:3')
compute distance is  tensor(106.1009, device='cuda:3')
compute norm is  tensor(48.8604, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.1337, device='cuda:3')
compute distance is  tensor(107.1337, device='cuda:3')
compute norm is  tensor(48.8714, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.1298, device='cuda:3')
compute distance is  tensor(109.1298, device='cuda:3')
compute norm is  tensor(48.8359, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(109.1298, device='cuda:3')
distance x is tensor(106217.7109, device='cuda:3')
distance x is tensor(106217.7109, device='cuda:3')
________________________________
test distance is  tensor(106217.7109, device='cuda:3')
test distance1 is  tensor(106217.7109, device='cuda:3')
test similarity is  tensor(-0.1008, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139281031888057.6
test entropy is  0.0
________________________________
cal ratio is  0.03141226352404068
distance x is tensor(3336.5444, device='cuda:3')
cal_distance is  tensor(3336.5444, device='cuda:3')
cal ratio is  0.17723489786733632
distance x is tensor(591.3561, device='cuda:3')
cal_distance is  tensor(591.3561, device='cuda:3')
cal ratio is  0.420991322284401
distance x is tensor(248.9587, device='cuda:3')
cal_distance is  tensor(248.9587, device='cuda:3')
cal ratio is  0.648834632799559
distance x is tensor(161.5348, device='cuda:3')
cal_distance is  tensor(161.5348, device='cuda:3')
cal ratio is  0.8054982659512449
distance x is tensor(130.1170, device='cuda:3')
cal_distance is  tensor(130.1170, device='cuda:3')
cal ratio is  0.8974921563132495
distance x is tensor(116.7795, device='cuda:3')
cal_distance is  tensor(116.7795, device='cuda:3')
cal ratio is  0.9473584921581812
distance x is tensor(110.6323, device='cuda:3')
cal_distance is  tensor(110.6323, device='cuda:3')
cal ratio is  0.9733223071573346
distance x is tensor(107.6811, device='cuda:3')
cal_distance is  tensor(107.6811, device='cuda:3')
distance x is tensor(107.6811, device='cuda:3')
return_distance is  tensor(107.6811, device='cuda:3')
distance x is tensor(107.6711, device='cuda:3')
distance x is tensor(107.6711, device='cuda:3')
________________________________
test distance is  tensor(107.6711, device='cuda:3')
test distance1 is  tensor(107.6711, device='cuda:3')
test similarity is  tensor(0.9670, device='cuda:3')
test acc is  0.10000000015633198
test loss is 185.91115810825372
test entropy is  1.421768187494561e-24
________________________________
0
distance x is tensor(107.6711, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  4.698988654946826e-24
avg test loss is  185.89469374471636
avg accuracy is  0.5767333334896729
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9670, device='cuda:3')
compute_distance is  tensor(107.6711, device='cuda:3')
compute_norm is  tensor(47.7317, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(100.6493, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8443964682916588
avg test loss is  1.3295914898040706
avg accuracy is  0.8660333334896559
solo acc is  0.3378833334896736
compute similarity  is  tensor(0.9691, device='cuda:3')
compute_distance is  tensor(100.6493, device='cuda:3')
compute_norm is  tensor(46.5462, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(103.4988, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7810957258317008
avg test loss is  1.4231247326204264
avg accuracy is  0.8660833334896559
solo acc is  0.24755000015633816
compute similarity  is  tensor(0.9684, device='cuda:3')
compute_distance is  tensor(103.4988, device='cuda:3')
compute_norm is  tensor(46.2407, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(105.9661, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7704982389010855
avg test loss is  1.3980035040932677
avg accuracy is  0.8681500001563226
solo acc is  0.23045000015633754
compute similarity  is  tensor(0.9679, device='cuda:3')
compute_distance is  tensor(105.9661, device='cuda:3')
compute_norm is  tensor(45.9648, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(108.1930, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7775561631615482
avg test loss is  1.3430713181302492
avg accuracy is  0.8702500001563225
solo acc is  0.2349500001563377
compute similarity  is  tensor(0.9674, device='cuda:3')
compute_distance is  tensor(108.1930, device='cuda:3')
compute_norm is  tensor(45.7040, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(110.3447, device='cuda:3')
distance x is tensor(110.3447, device='cuda:3')
________________________________
test distance is  tensor(110.3447, device='cuda:3')
test distance1 is  tensor(110.3447, device='cuda:3')
test similarity is  tensor(0.9670, device='cuda:3')
test acc is  0.22301666682300395
test loss is 1.3334863663736436
test entropy is  0.7713341835592347
________________________________
cal ratio is  0.974589966996998
distance x is tensor(107.5473, device='cuda:3')
cal_distance is  tensor(107.5473, device='cuda:3')
distance x is tensor(107.5473, device='cuda:3')
return_distance is  tensor(107.5473, device='cuda:3')
distance x is tensor(107.5408, device='cuda:3')
distance x is tensor(107.5408, device='cuda:3')
________________________________
test distance is  tensor(107.5408, device='cuda:3')
test distance1 is  tensor(107.5408, device='cuda:3')
test similarity is  tensor(0.9687, device='cuda:3')
test acc is  0.2875833334896726
test loss is 1.2389540650061708
test entropy is  0.7983857773260267
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal loss is 1.070875883102417
mal norm is  tensor(530.1896, device='cuda:3')
distance x is tensor(107.5473, device='cuda:3')
mal distance is  tensor(107.5473, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([18., 14., 12., 12., 27., 12., 12., 24., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 12., 12., 25., 12., 12., 12.])
count_res tensor([1.0410e-04, 1.9067e-06, 2.5805e-07, 2.5805e-07, 8.4356e-01, 2.5805e-07,
        2.5805e-07, 4.1998e-02, 1.4089e-05, 1.4089e-05, 1.4089e-05, 1.4089e-05,
        1.4089e-05, 1.4089e-05, 1.4089e-05, 1.4089e-05, 1.4089e-05, 1.4089e-05,
        1.4089e-05, 1.4089e-05, 2.5805e-07, 2.5805e-07, 2.5805e-07, 2.5805e-07,
        1.1416e-01, 2.5805e-07, 2.5805e-07, 2.5805e-07])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 88.98% 

Test Accuracy: 87.82% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6251117587089539
distance x is tensor(106.7017, device='cuda:3')
benign distance is  tensor(106.7017, device='cuda:3')
norm1 res is  tensor(471.4834, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0694520473480225
distance x is tensor(126.1130, device='cuda:3')
benign distance is  tensor(126.1130, device='cuda:3')
norm1 res is  tensor(541.9432, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1777069866657257
distance x is tensor(118.6407, device='cuda:3')
benign distance is  tensor(118.6407, device='cuda:3')
norm1 res is  tensor(519.5187, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9192095994949341
distance x is tensor(112.0587, device='cuda:3')
benign distance is  tensor(112.0587, device='cuda:3')
norm1 res is  tensor(491.9748, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6113842725753784
distance x is tensor(70.2350, device='cuda:3')
benign distance is  tensor(70.2350, device='cuda:3')
norm1 res is  tensor(297.9724, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6473076343536377
distance x is tensor(123.5926, device='cuda:3')
benign distance is  tensor(123.5926, device='cuda:3')
norm1 res is  tensor(545.4393, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5126413106918335
distance x is tensor(121.1163, device='cuda:3')
benign distance is  tensor(121.1163, device='cuda:3')
norm1 res is  tensor(516.6251, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.874882698059082
distance x is tensor(105.6456, device='cuda:3')
benign distance is  tensor(105.6456, device='cuda:3')
norm1 res is  tensor(460.7188, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.41398364305496216
distance x is tensor(125.9874, device='cuda:3')
benign distance is  tensor(125.9874, device='cuda:3')
norm1 res is  tensor(543.4057, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7467330694198608
distance x is tensor(136.1257, device='cuda:3')
benign distance is  tensor(136.1257, device='cuda:3')
norm1 res is  tensor(602.4645, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3108368217945099
distance x is tensor(123.0412, device='cuda:3')
benign distance is  tensor(123.0412, device='cuda:3')
norm1 res is  tensor(532.4026, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.33111658692359924
distance x is tensor(125.2246, device='cuda:3')
benign distance is  tensor(125.2246, device='cuda:3')
norm1 res is  tensor(552.5490, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4892485737800598
distance x is tensor(112.1314, device='cuda:3')
benign distance is  tensor(112.1314, device='cuda:3')
norm1 res is  tensor(485.7675, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5475825667381287
distance x is tensor(117.5396, device='cuda:3')
benign distance is  tensor(117.5396, device='cuda:3')
norm1 res is  tensor(504.7253, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.34159454703330994
distance x is tensor(142.0824, device='cuda:3')
benign distance is  tensor(142.0824, device='cuda:3')
norm1 res is  tensor(621.1586, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5133506655693054
distance x is tensor(119.8575, device='cuda:3')
benign distance is  tensor(119.8575, device='cuda:3')
norm1 res is  tensor(501.4638, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(107.5223, device='cuda:3')
compute distance is  tensor(107.5223, device='cuda:3')
compute norm is  tensor(49.3744, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.6958, device='cuda:3')
compute distance is  tensor(111.6958, device='cuda:3')
compute norm is  tensor(49.5600, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.0170, device='cuda:3')
compute distance is  tensor(126.0170, device='cuda:3')
compute norm is  tensor(49.8769, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.9534, device='cuda:3')
compute distance is  tensor(105.9534, device='cuda:3')
compute norm is  tensor(49.4860, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.3364, device='cuda:3')
compute distance is  tensor(106.3364, device='cuda:3')
compute norm is  tensor(49.5056, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.2057, device='cuda:3')
compute distance is  tensor(118.2057, device='cuda:3')
compute norm is  tensor(49.8330, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.2617, device='cuda:3')
compute distance is  tensor(118.2617, device='cuda:3')
compute norm is  tensor(49.6920, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.5127, device='cuda:3')
compute distance is  tensor(123.5127, device='cuda:3')
compute norm is  tensor(49.8324, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.7986, device='cuda:3')
compute distance is  tensor(119.7986, device='cuda:3')
compute norm is  tensor(49.7102, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.9761, device='cuda:3')
compute distance is  tensor(112.9761, device='cuda:3')
compute norm is  tensor(49.6471, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.0307, device='cuda:3')
compute distance is  tensor(121.0307, device='cuda:3')
compute norm is  tensor(49.7221, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.5599, device='cuda:3')
compute distance is  tensor(124.5599, device='cuda:3')
compute norm is  tensor(49.6059, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(126.0170, device='cuda:3')
distance x is tensor(106218.5859, device='cuda:3')
distance x is tensor(106218.5859, device='cuda:3')
________________________________
test distance is  tensor(106218.5859, device='cuda:3')
test distance1 is  tensor(106218.5859, device='cuda:3')
test similarity is  tensor(-0.0993, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139296323783856.86
test entropy is  0.0
________________________________
cal ratio is  0.03375517286523407
distance x is tensor(3585.4321, device='cuda:3')
cal_distance is  tensor(3585.4321, device='cuda:3')
cal ratio is  0.18372566956133865
distance x is tensor(658.7399, device='cuda:3')
cal_distance is  tensor(658.7399, device='cuda:3')
cal ratio is  0.42863102215763504
distance x is tensor(282.3592, device='cuda:3')
cal_distance is  tensor(282.3592, device='cuda:3')
cal ratio is  0.6546958772492057
distance x is tensor(184.8611, device='cuda:3')
cal_distance is  tensor(184.8611, device='cuda:3')
cal ratio is  0.8091290305355628
distance x is tensor(149.5775, device='cuda:3')
cal_distance is  tensor(149.5775, device='cuda:3')
cal ratio is  0.8995130622115729
distance x is tensor(134.5474, device='cuda:3')
cal_distance is  tensor(134.5474, device='cuda:3')
cal ratio is  0.948424849499668
distance x is tensor(127.6084, device='cuda:3')
cal_distance is  tensor(127.6084, device='cuda:3')
cal ratio is  0.9738700577712461
distance x is tensor(124.2741, device='cuda:3')
cal_distance is  tensor(124.2741, device='cuda:3')
distance x is tensor(124.2741, device='cuda:3')
return_distance is  tensor(124.2741, device='cuda:3')
distance x is tensor(124.2642, device='cuda:3')
distance x is tensor(124.2642, device='cuda:3')
________________________________
test distance is  tensor(124.2642, device='cuda:3')
test distance1 is  tensor(124.2642, device='cuda:3')
test similarity is  tensor(0.9580, device='cuda:3')
test acc is  0.10000000015633198
test loss is 319.90425529561315
test entropy is  3.04290956678458e-35
________________________________
0
distance x is tensor(124.2642, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.2255674622491045e-37
avg test loss is  320.02170798620944
avg accuracy is  0.389300000156341
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9580, device='cuda:3')
compute_distance is  tensor(124.2642, device='cuda:3')
compute_norm is  tensor(48.7433, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(112.7137, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8023748088365933
avg test loss is  1.4236005811548944
avg accuracy is  0.8508333334896565
solo acc is  0.2961000001563394
compute similarity  is  tensor(0.9618, device='cuda:3')
compute_distance is  tensor(112.7137, device='cuda:3')
compute_norm is  tensor(47.4707, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.8271, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7790551432795616
avg test loss is  1.4513150775102155
avg accuracy is  0.85016666682299
solo acc is  0.2390333334896712
compute similarity  is  tensor(0.9610, device='cuda:3')
compute_distance is  tensor(115.8271, device='cuda:3')
compute_norm is  tensor(47.1651, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(118.3381, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7934043643825344
avg test loss is  1.3774125952837564
avg accuracy is  0.8521166668229899
solo acc is  0.24388333348967137
compute similarity  is  tensor(0.9605, device='cuda:3')
compute_distance is  tensor(118.3381, device='cuda:3')
compute_norm is  tensor(46.8881, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(120.5559, device='cuda:3')
exit early
distance x is tensor(120.5559, device='cuda:3')
distance x is tensor(120.5559, device='cuda:3')
________________________________
test distance is  tensor(120.5559, device='cuda:3')
test distance1 is  tensor(120.5559, device='cuda:3')
test similarity is  tensor(0.9600, device='cuda:3')
test acc is  0.22628333348967078
test loss is 1.3749986536213075
test entropy is  0.7789229864377711
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 1.2511091232299805
mal norm is  tensor(609.0704, device='cuda:3')
distance x is tensor(120.5622, device='cuda:3')
mal distance is  tensor(120.5622, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 25., 27., 12., 26., 18., 12.])
count_res tensor([2.0345e-07, 2.0345e-07, 2.0345e-07, 2.0345e-07, 2.0345e-07, 2.0345e-07,
        2.0345e-07, 2.0345e-07, 1.1108e-05, 1.1108e-05, 1.1108e-05, 1.1108e-05,
        1.1108e-05, 1.1108e-05, 1.1108e-05, 1.1108e-05, 1.1108e-05, 1.1108e-05,
        1.1108e-05, 1.1108e-05, 2.0345e-07, 2.0345e-07, 9.0011e-02, 6.6510e-01,
        2.0345e-07, 2.4468e-01, 8.2079e-05, 2.0345e-07])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 89.12% 

Test Accuracy: 88.53% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.870518684387207
distance x is tensor(105.0935, device='cuda:3')
benign distance is  tensor(105.0935, device='cuda:3')
norm1 res is  tensor(469.1260, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1902074813842773
distance x is tensor(107.7894, device='cuda:3')
benign distance is  tensor(107.7894, device='cuda:3')
norm1 res is  tensor(480.3441, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.12662725150585175
distance x is tensor(121.6551, device='cuda:3')
benign distance is  tensor(121.6551, device='cuda:3')
norm1 res is  tensor(526.3006, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.537211537361145
distance x is tensor(108.7867, device='cuda:3')
benign distance is  tensor(108.7867, device='cuda:3')
norm1 res is  tensor(457.6098, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8922281265258789
distance x is tensor(100.4732, device='cuda:3')
benign distance is  tensor(100.4732, device='cuda:3')
norm1 res is  tensor(425.7870, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8919385075569153
distance x is tensor(121.7556, device='cuda:3')
benign distance is  tensor(121.7556, device='cuda:3')
norm1 res is  tensor(532.2659, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.335513174533844
distance x is tensor(106.6274, device='cuda:3')
benign distance is  tensor(106.6274, device='cuda:3')
norm1 res is  tensor(471.6723, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.423703134059906
distance x is tensor(105.9317, device='cuda:3')
benign distance is  tensor(105.9317, device='cuda:3')
norm1 res is  tensor(460.0337, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.22223910689353943
distance x is tensor(124.7664, device='cuda:3')
benign distance is  tensor(124.7664, device='cuda:3')
norm1 res is  tensor(557.6971, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9507548213005066
distance x is tensor(131.1741, device='cuda:3')
benign distance is  tensor(131.1741, device='cuda:3')
norm1 res is  tensor(575.1244, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4758543074131012
distance x is tensor(116.2991, device='cuda:3')
benign distance is  tensor(116.2991, device='cuda:3')
norm1 res is  tensor(506.7153, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.3623733520507812
distance x is tensor(77.4187, device='cuda:3')
benign distance is  tensor(77.4187, device='cuda:3')
norm1 res is  tensor(340.3556, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.28462132811546326
distance x is tensor(122.7356, device='cuda:3')
benign distance is  tensor(122.7356, device='cuda:3')
norm1 res is  tensor(521.6547, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8129770159721375
distance x is tensor(77.6479, device='cuda:3')
benign distance is  tensor(77.6479, device='cuda:3')
norm1 res is  tensor(345.5473, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.678252637386322
distance x is tensor(120.8302, device='cuda:3')
benign distance is  tensor(120.8302, device='cuda:3')
norm1 res is  tensor(538.7800, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9195020794868469
distance x is tensor(108.8068, device='cuda:3')
benign distance is  tensor(108.8068, device='cuda:3')
norm1 res is  tensor(478.5725, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(109.8310, device='cuda:3')
compute distance is  tensor(109.8310, device='cuda:3')
compute norm is  tensor(49.4143, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.2176, device='cuda:3')
compute distance is  tensor(120.2176, device='cuda:3')
compute norm is  tensor(49.6664, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.2636, device='cuda:3')
compute distance is  tensor(117.2636, device='cuda:3')
compute norm is  tensor(49.7431, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.0245, device='cuda:3')
compute distance is  tensor(115.0245, device='cuda:3')
compute norm is  tensor(49.5750, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.1227, device='cuda:3')
compute distance is  tensor(117.1227, device='cuda:3')
compute norm is  tensor(49.6014, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.5227, device='cuda:3')
compute distance is  tensor(122.5227, device='cuda:3')
compute norm is  tensor(49.8583, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.0464, device='cuda:3')
compute distance is  tensor(113.0464, device='cuda:3')
compute norm is  tensor(49.5925, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.9813, device='cuda:3')
compute distance is  tensor(105.9813, device='cuda:3')
compute norm is  tensor(49.4035, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.1706, device='cuda:3')
compute distance is  tensor(116.1706, device='cuda:3')
compute norm is  tensor(49.6549, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.3362, device='cuda:3')
compute distance is  tensor(99.3362, device='cuda:3')
compute norm is  tensor(49.4204, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.7776, device='cuda:3')
compute distance is  tensor(111.7776, device='cuda:3')
compute norm is  tensor(49.7421, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.6368, device='cuda:3')
compute distance is  tensor(108.6368, device='cuda:3')
compute norm is  tensor(49.4876, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(122.5227, device='cuda:3')
distance x is tensor(106220.3516, device='cuda:3')
distance x is tensor(106220.3516, device='cuda:3')
________________________________
test distance is  tensor(106220.3516, device='cuda:3')
test distance1 is  tensor(106220.3516, device='cuda:3')
test similarity is  tensor(-0.1012, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139273810951039.19
test entropy is  0.0
________________________________
cal ratio is  0.033283619284245634
distance x is tensor(3535.4036, device='cuda:3')
cal_distance is  tensor(3535.4036, device='cuda:3')
cal ratio is  0.18243783755579943
distance x is tensor(644.9954, device='cuda:3')
cal_distance is  tensor(644.9954, device='cuda:3')
cal ratio is  0.4271260932063268
distance x is tensor(275.4972, device='cuda:3')
cal_distance is  tensor(275.4972, device='cuda:3')
cal ratio is  0.6535454922159688
distance x is tensor(180.0517, device='cuda:3')
cal_distance is  tensor(180.0517, device='cuda:3')
cal ratio is  0.8084176645547704
distance x is tensor(145.5580, device='cuda:3')
cal_distance is  tensor(145.5580, device='cuda:3')
cal ratio is  0.8991174893605798
distance x is tensor(130.8742, device='cuda:3')
cal_distance is  tensor(130.8742, device='cuda:3')
cal ratio is  0.9482161112129674
distance x is tensor(124.0973, device='cuda:3')
cal_distance is  tensor(124.0973, device='cuda:3')
cal ratio is  0.9737629543123425
distance x is tensor(120.8415, device='cuda:3')
cal_distance is  tensor(120.8415, device='cuda:3')
distance x is tensor(120.8415, device='cuda:3')
return_distance is  tensor(120.8415, device='cuda:3')
distance x is tensor(120.8315, device='cuda:3')
distance x is tensor(120.8315, device='cuda:3')
________________________________
test distance is  tensor(120.8315, device='cuda:3')
test distance1 is  tensor(120.8315, device='cuda:3')
test similarity is  tensor(0.9601, device='cuda:3')
test acc is  0.10000000015633198
test loss is 297.9588729923468
test entropy is  2.4854626328832876e-36
________________________________
0
distance x is tensor(120.8315, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  3.006013892251038e-36
avg test loss is  297.93778401193845
avg accuracy is  0.3708166668230074
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9601, device='cuda:3')
compute_distance is  tensor(120.8315, device='cuda:3')
compute_norm is  tensor(48.6357, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(109.4309, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8515180889477354
avg test loss is  1.31834550738843
avg accuracy is  0.8662666668229893
solo acc is  0.3441333334896737
compute similarity  is  tensor(0.9636, device='cuda:3')
compute_distance is  tensor(109.4309, device='cuda:3')
compute_norm is  tensor(47.4070, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(112.1884, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7851884448960391
avg test loss is  1.4320799879936268
avg accuracy is  0.8665666668229893
solo acc is  0.25011666682300493
compute similarity  is  tensor(0.9629, device='cuda:3')
compute_distance is  tensor(112.1884, device='cuda:3')
compute_norm is  tensor(47.0998, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(114.5320, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7901991755088001
avg test loss is  1.3707082322411446
avg accuracy is  0.8677000001563226
solo acc is  0.2496500001563382
compute similarity  is  tensor(0.9624, device='cuda:3')
compute_distance is  tensor(114.5320, device='cuda:3')
compute_norm is  tensor(46.8190, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(116.7769, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7716907846139692
avg test loss is  1.3770707986756427
avg accuracy is  0.8708666668229891
solo acc is  0.2287666668230042
compute similarity  is  tensor(0.9619, device='cuda:3')
compute_distance is  tensor(116.7769, device='cuda:3')
compute_norm is  tensor(46.5533, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(118.9106, device='cuda:3')
distance x is tensor(118.9106, device='cuda:3')
________________________________
test distance is  tensor(118.9106, device='cuda:3')
test distance1 is  tensor(118.9106, device='cuda:3')
test similarity is  tensor(0.9615, device='cuda:3')
test acc is  0.22265000015633724
test loss is 1.3565553414033675
test entropy is  0.7659307339552369
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 1.3381716012954712
mal norm is  tensor(597.4081, device='cuda:3')
distance x is tensor(118.9170, device='cuda:3')
mal distance is  tensor(118.9170, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 18.89% 

Test Accuracy: 18.38% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6934744715690613
distance x is tensor(160.5214, device='cuda:3')
benign distance is  tensor(160.5214, device='cuda:3')
norm1 res is  tensor(624.1273, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5635836720466614
distance x is tensor(161.6608, device='cuda:3')
benign distance is  tensor(161.6608, device='cuda:3')
norm1 res is  tensor(639.5573, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.07818879187107086
distance x is tensor(159.2171, device='cuda:3')
benign distance is  tensor(159.2171, device='cuda:3')
norm1 res is  tensor(613.8655, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7821515202522278
distance x is tensor(153.4899, device='cuda:3')
benign distance is  tensor(153.4899, device='cuda:3')
norm1 res is  tensor(597.4412, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7725094556808472
distance x is tensor(163.8978, device='cuda:3')
benign distance is  tensor(163.8978, device='cuda:3')
norm1 res is  tensor(628.8185, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6321322321891785
distance x is tensor(176.7735, device='cuda:3')
benign distance is  tensor(176.7735, device='cuda:3')
norm1 res is  tensor(675.1303, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8322833776473999
distance x is tensor(155.0774, device='cuda:3')
benign distance is  tensor(155.0774, device='cuda:3')
norm1 res is  tensor(609.3576, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8722565770149231
distance x is tensor(171.2253, device='cuda:3')
benign distance is  tensor(171.2253, device='cuda:3')
norm1 res is  tensor(670.0427, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(150.3897, device='cuda:3')
compute distance is  tensor(150.3897, device='cuda:3')
compute norm is  tensor(48.1109, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.0706, device='cuda:3')
compute distance is  tensor(161.0706, device='cuda:3')
compute norm is  tensor(48.3337, device='cuda:3', dtype=torch.float64)
distance x is tensor(171.0068, device='cuda:3')
compute distance is  tensor(171.0068, device='cuda:3')
compute norm is  tensor(48.6288, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.2946, device='cuda:3')
compute distance is  tensor(158.2946, device='cuda:3')
compute norm is  tensor(48.2796, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.4528, device='cuda:3')
compute distance is  tensor(167.4528, device='cuda:3')
compute norm is  tensor(48.5162, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.5021, device='cuda:3')
compute distance is  tensor(160.5021, device='cuda:3')
compute norm is  tensor(48.4698, device='cuda:3', dtype=torch.float64)
distance x is tensor(168.2511, device='cuda:3')
compute distance is  tensor(168.2511, device='cuda:3')
compute norm is  tensor(48.4067, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.7088, device='cuda:3')
compute distance is  tensor(164.7088, device='cuda:3')
compute norm is  tensor(48.4065, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.6625, device='cuda:3')
compute distance is  tensor(165.6625, device='cuda:3')
compute norm is  tensor(48.4570, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.9296, device='cuda:3')
compute distance is  tensor(161.9296, device='cuda:3')
compute norm is  tensor(48.1916, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.3152, device='cuda:3')
compute distance is  tensor(164.3152, device='cuda:3')
compute norm is  tensor(48.5699, device='cuda:3', dtype=torch.float64)
distance x is tensor(177.0955, device='cuda:3')
compute distance is  tensor(177.0955, device='cuda:3')
compute norm is  tensor(48.5300, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(177.0955, device='cuda:3')
distance x is tensor(106153.2266, device='cuda:3')
distance x is tensor(106153.2266, device='cuda:3')
________________________________
test distance is  tensor(106153.2266, device='cuda:3')
test distance1 is  tensor(106153.2266, device='cuda:3')
test similarity is  tensor(0.1341, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139280683090094.67
test entropy is  0.0
________________________________
cal ratio is  0.04002793470872295
distance x is tensor(4249.0996, device='cuda:3')
cal_distance is  tensor(4249.0996, device='cuda:3')
cal ratio is  0.20006970720781633
distance x is tensor(850.1201, device='cuda:3')
cal_distance is  tensor(850.1201, device='cuda:3')
cal ratio is  0.4472904807834454
distance x is tensor(380.2534, device='cuda:3')
cal_distance is  tensor(380.2534, device='cuda:3')
cal ratio is  0.6687952837986931
distance x is tensor(254.3133, device='cuda:3')
cal_distance is  tensor(254.3133, device='cuda:3')
cal ratio is  0.8177964678961412
distance x is tensor(207.9775, device='cuda:3')
cal_distance is  tensor(207.9775, device='cuda:3')
cal ratio is  0.9043189530052413
distance x is tensor(188.0784, device='cuda:3')
cal_distance is  tensor(188.0784, device='cuda:3')
cal ratio is  0.9509556618597405
distance x is tensor(178.8545, device='cuda:3')
cal_distance is  tensor(178.8545, device='cuda:3')
cal ratio is  0.9751688518666483
distance x is tensor(174.4135, device='cuda:3')
cal_distance is  tensor(174.4135, device='cuda:3')
distance x is tensor(174.4135, device='cuda:3')
return_distance is  tensor(174.4135, device='cuda:3')
distance x is tensor(174.4035, device='cuda:3')
distance x is tensor(174.4035, device='cuda:3')
________________________________
test distance is  tensor(174.4035, device='cuda:3')
test distance1 is  tensor(174.4035, device='cuda:3')
test similarity is  tensor(0.9281, device='cuda:3')
test acc is  0.10000000015633198
test loss is 937.9049892140858
test entropy is  0.0
________________________________
0
distance x is tensor(174.4035, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  937.9187651351571
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9281, device='cuda:3')
compute_distance is  tensor(174.4035, device='cuda:3')
compute_norm is  tensor(50.1587, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(451.5886, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5617087738854545
avg test loss is  2.8492239106184383
avg accuracy is  0.1274666668229986
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6194, device='cuda:3')
compute_distance is  tensor(451.5886, device='cuda:3')
compute_norm is  tensor(75.8139, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(450.4585, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8379476069768609
avg test loss is  3.5827948104089766
avg accuracy is  0.07740000015633205
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6193, device='cuda:3')
compute_distance is  tensor(450.4585, device='cuda:3')
compute_norm is  tensor(75.8357, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(448.4470, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5540969793730453
avg test loss is  2.851639106837925
avg accuracy is  0.12795000015633193
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6194, device='cuda:3')
compute_distance is  tensor(448.4470, device='cuda:3')
compute_norm is  tensor(75.1223, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(447.4306, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8376408101780328
avg test loss is  3.5802468269872767
avg accuracy is  0.07663333348966538
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6193, device='cuda:3')
compute_distance is  tensor(447.4306, device='cuda:3')
compute_norm is  tensor(75.1467, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(445.5283, device='cuda:3')
distance x is tensor(445.5283, device='cuda:3')
________________________________
test distance is  tensor(445.5283, device='cuda:3')
test distance1 is  tensor(445.5283, device='cuda:3')
test similarity is  tensor(0.6193, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8518348828053424
test entropy is  1.5536202436317004
________________________________
cal ratio is  0.6178629299472799
distance x is tensor(275.2787, device='cuda:3')
cal_distance is  tensor(275.2787, device='cuda:3')
cal ratio is  0.7860379120708151
distance x is tensor(216.3799, device='cuda:3')
cal_distance is  tensor(216.3799, device='cuda:3')
cal ratio is  0.8865868942970765
distance x is tensor(191.8399, device='cuda:3')
cal_distance is  tensor(191.8399, device='cuda:3')
cal ratio is  0.9415868024731475
distance x is tensor(180.6340, device='cuda:3')
cal_distance is  tensor(180.6340, device='cuda:3')
cal ratio is  0.970353677695961
distance x is tensor(175.2789, device='cuda:3')
cal_distance is  tensor(175.2789, device='cuda:3')
distance x is tensor(175.2789, device='cuda:3')
return_distance is  tensor(175.2789, device='cuda:3')
distance x is tensor(175.2749, device='cuda:3')
distance x is tensor(175.2749, device='cuda:3')
________________________________
test distance is  tensor(175.2749, device='cuda:3')
test distance1 is  tensor(175.2749, device='cuda:3')
test similarity is  tensor(0.8884, device='cuda:3')
test acc is  0.14128333348966574
test loss is 2.8462541352457076
test entropy is  1.7484689366334536
________________________________
0
distance x is tensor(175.2749, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.7474384018098876
avg test loss is  2.850432903527705
avg accuracy is  0.18476666682300222
solo acc is  0.14105000015633237
compute similarity  is  tensor(0.8884, device='cuda:3')
compute_distance is  tensor(175.2749, device='cuda:3')
compute_norm is  tensor(53.6993, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(178.5390, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.763204852337522
avg test loss is  2.8930538907996626
avg accuracy is  0.12581666682299858
solo acc is  0.10110000015633197
compute similarity  is  tensor(0.8874, device='cuda:3')
compute_distance is  tensor(178.5390, device='cuda:3')
compute_norm is  tensor(53.7103, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(181.4911, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0405171662886767
avg test loss is  1.7563485812022488
avg accuracy is  0.1413333334896657
solo acc is  0.16515000015633433
compute similarity  is  tensor(0.8869, device='cuda:3')
compute_distance is  tensor(181.4911, device='cuda:3')
compute_norm is  tensor(53.5082, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(182.1364, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6046322915218533
avg test loss is  2.508406825665472
avg accuracy is  0.12071666682299859
solo acc is  0.10023333348966532
compute similarity  is  tensor(0.8866, device='cuda:3')
compute_distance is  tensor(182.1364, device='cuda:3')
compute_norm is  tensor(53.3160, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(183.9193, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.003767101368162
avg test loss is  1.5942477408502655
avg accuracy is  0.1420333334896658
solo acc is  0.1750833334896683
compute similarity  is  tensor(0.8863, device='cuda:3')
compute_distance is  tensor(183.9193, device='cuda:3')
compute_norm is  tensor(53.0573, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(184.3069, device='cuda:3')
distance x is tensor(184.3069, device='cuda:3')
________________________________
test distance is  tensor(184.3069, device='cuda:3')
test distance1 is  tensor(184.3069, device='cuda:3')
test similarity is  tensor(0.8861, device='cuda:3')
test acc is  0.10038333348966531
test loss is 2.3521370265021253
test entropy is  0.5873806962707658
________________________________
cal ratio is  0.9606363853891784
distance x is tensor(177.0544, device='cuda:3')
cal_distance is  tensor(177.0544, device='cuda:3')
distance x is tensor(177.0544, device='cuda:3')
return_distance is  tensor(177.0544, device='cuda:3')
distance x is tensor(177.0518, device='cuda:3')
distance x is tensor(177.0518, device='cuda:3')
________________________________
test distance is  tensor(177.0518, device='cuda:3')
test distance1 is  tensor(177.0518, device='cuda:3')
test similarity is  tensor(0.8936, device='cuda:3')
test acc is  0.10031666682299865
test loss is 2.3674556687950834
test entropy is  0.5972862014892513
________________________________
0
distance x is tensor(177.0518, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.5987700380877391
avg test loss is  2.364796470985738
avg accuracy is  0.1180666668229986
solo acc is  0.10025000015633198
compute similarity  is  tensor(0.8936, device='cuda:3')
compute_distance is  tensor(177.0518, device='cuda:3')
compute_norm is  tensor(52.4256, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(178.8922, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9618801147953026
avg test loss is  1.5122695119142024
avg accuracy is  0.13821666682299874
solo acc is  0.19031666682300255
compute similarity  is  tensor(0.8931, device='cuda:3')
compute_distance is  tensor(178.8922, device='cuda:3')
compute_norm is  tensor(52.1748, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(178.8948, device='cuda:3')
________________________________
test distance is  tensor(178.8948, device='cuda:3')
test similarity is  tensor(0.8931, device='cuda:3')
test acc is  0.13756666682299867
test loss is 1.505292903385691
test entropy is  0.9618468289690485
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.2812724113464355
mal norm is  tensor(1045.1810, device='cuda:3')
distance x is tensor(178.8948, device='cuda:3')
mal distance is  tensor(178.8948, device='cuda:3')
user_PLR len size 52
counter_tensor is  tensor([12., 12., 48., 12., 39., 48., 38., 12., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 12., 48., 51., 12., 12., 13., 48., 12.,
        45., 50., 51., 45., 48., 12., 45., 51., 32., 12., 12., 26., 12., 12.,
        51., 17., 12., 23., 17., 13., 46., 12., 13., 16.])
count_res tensor([2.4936e-18, 2.4936e-18, 1.0750e-02, 2.4936e-18, 1.3267e-06, 1.0750e-02,
        4.8807e-07, 2.4936e-18, 3.6063e-06, 3.6063e-06, 3.6063e-06, 3.6063e-06,
        3.6063e-06, 3.6063e-06, 3.6063e-06, 3.6063e-06, 3.6063e-06, 3.6063e-06,
        3.6063e-06, 3.6063e-06, 2.4936e-18, 1.0750e-02, 2.1593e-01, 2.4936e-18,
        2.4936e-18, 6.7782e-18, 1.0750e-02, 2.4936e-18, 5.3523e-04, 7.9435e-02,
        2.1593e-01, 5.3523e-04, 1.0750e-02, 2.4936e-18, 5.3523e-04, 2.1593e-01,
        1.2098e-09, 2.4936e-18, 2.4936e-18, 2.9988e-12, 2.4936e-18, 2.4936e-18,
        2.1593e-01, 3.7008e-16, 2.4936e-18, 1.4930e-13, 3.7008e-16, 6.7782e-18,
        1.4549e-03, 2.4936e-18, 6.7782e-18, 1.3614e-16])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 89.63% 

Test Accuracy: 88.91% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6384246349334717
distance x is tensor(93.6948, device='cuda:3')
benign distance is  tensor(93.6948, device='cuda:3')
norm1 res is  tensor(424.3410, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0491650104522705
distance x is tensor(105.9200, device='cuda:3')
benign distance is  tensor(105.9200, device='cuda:3')
norm1 res is  tensor(465.1871, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.07216159999370575
distance x is tensor(107.0238, device='cuda:3')
benign distance is  tensor(107.0238, device='cuda:3')
norm1 res is  tensor(459.1775, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.473463237285614
distance x is tensor(95.2406, device='cuda:3')
benign distance is  tensor(95.2406, device='cuda:3')
norm1 res is  tensor(416.0708, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1413580179214478
distance x is tensor(84.2828, device='cuda:3')
benign distance is  tensor(84.2828, device='cuda:3')
norm1 res is  tensor(362.2173, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5001322627067566
distance x is tensor(94.8249, device='cuda:3')
benign distance is  tensor(94.8249, device='cuda:3')
norm1 res is  tensor(419.4003, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.19890114665031433
distance x is tensor(88.4575, device='cuda:3')
benign distance is  tensor(88.4575, device='cuda:3')
norm1 res is  tensor(376.7917, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4669151306152344
distance x is tensor(92.7325, device='cuda:3')
benign distance is  tensor(92.7325, device='cuda:3')
norm1 res is  tensor(410.0262, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.475864976644516
distance x is tensor(130.0436, device='cuda:3')
benign distance is  tensor(130.0436, device='cuda:3')
norm1 res is  tensor(558.0139, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5858309268951416
distance x is tensor(117.4250, device='cuda:3')
benign distance is  tensor(117.4250, device='cuda:3')
norm1 res is  tensor(508.8226, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3313661515712738
distance x is tensor(111.1200, device='cuda:3')
benign distance is  tensor(111.1200, device='cuda:3')
norm1 res is  tensor(482.6122, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9544507265090942
distance x is tensor(115.9258, device='cuda:3')
benign distance is  tensor(115.9258, device='cuda:3')
norm1 res is  tensor(512.0485, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.40237507224082947
distance x is tensor(109.6304, device='cuda:3')
benign distance is  tensor(109.6304, device='cuda:3')
norm1 res is  tensor(493.8517, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1438044011592865
distance x is tensor(93.6047, device='cuda:3')
benign distance is  tensor(93.6047, device='cuda:3')
norm1 res is  tensor(420.8896, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5193241834640503
distance x is tensor(108.0204, device='cuda:3')
benign distance is  tensor(108.0204, device='cuda:3')
norm1 res is  tensor(485.8760, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6222696304321289
distance x is tensor(104.5144, device='cuda:3')
benign distance is  tensor(104.5144, device='cuda:3')
norm1 res is  tensor(466.1083, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5581483244895935
distance x is tensor(102.2058, device='cuda:3')
benign distance is  tensor(102.2058, device='cuda:3')
norm1 res is  tensor(455.2588, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6233333349227905
distance x is tensor(124.8237, device='cuda:3')
benign distance is  tensor(124.8237, device='cuda:3')
norm1 res is  tensor(541.5973, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.23397795855998993
distance x is tensor(112.8245, device='cuda:3')
benign distance is  tensor(112.8245, device='cuda:3')
norm1 res is  tensor(486.8007, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.5154700875282288
distance x is tensor(105.0983, device='cuda:3')
benign distance is  tensor(105.0983, device='cuda:3')
norm1 res is  tensor(459.5482, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5352271795272827
distance x is tensor(104.8205, device='cuda:3')
benign distance is  tensor(104.8205, device='cuda:3')
norm1 res is  tensor(456.1627, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8811131715774536
distance x is tensor(97.2875, device='cuda:3')
benign distance is  tensor(97.2875, device='cuda:3')
norm1 res is  tensor(423.1245, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5885223150253296
distance x is tensor(80.4743, device='cuda:3')
benign distance is  tensor(80.4743, device='cuda:3')
norm1 res is  tensor(358.1322, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6277535557746887
distance x is tensor(103.5765, device='cuda:3')
benign distance is  tensor(103.5765, device='cuda:3')
norm1 res is  tensor(436.6096, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.4931918680667877
distance x is tensor(113.0692, device='cuda:3')
benign distance is  tensor(113.0692, device='cuda:3')
norm1 res is  tensor(504.2780, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.8457509875297546
distance x is tensor(94.8716, device='cuda:3')
benign distance is  tensor(94.8716, device='cuda:3')
norm1 res is  tensor(421.8647, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5586996674537659
distance x is tensor(91.4287, device='cuda:3')
benign distance is  tensor(91.4287, device='cuda:3')
norm1 res is  tensor(401.0011, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.18381166458129883
distance x is tensor(113.7667, device='cuda:3')
benign distance is  tensor(113.7667, device='cuda:3')
norm1 res is  tensor(496.1588, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7303670048713684
distance x is tensor(116.8963, device='cuda:3')
benign distance is  tensor(116.8963, device='cuda:3')
norm1 res is  tensor(515.0910, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6547616124153137
distance x is tensor(117.7478, device='cuda:3')
benign distance is  tensor(117.7478, device='cuda:3')
norm1 res is  tensor(508.6266, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6062777042388916
distance x is tensor(115.7852, device='cuda:3')
benign distance is  tensor(115.7852, device='cuda:3')
norm1 res is  tensor(518.9559, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.4361262321472168
distance x is tensor(94.4439, device='cuda:3')
benign distance is  tensor(94.4439, device='cuda:3')
norm1 res is  tensor(431.4598, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.14797021448612213
distance x is tensor(116.8086, device='cuda:3')
benign distance is  tensor(116.8086, device='cuda:3')
norm1 res is  tensor(515.8531, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.8598125576972961
distance x is tensor(106.7322, device='cuda:3')
benign distance is  tensor(106.7322, device='cuda:3')
norm1 res is  tensor(457.4517, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.10856129229068756
distance x is tensor(86.8133, device='cuda:3')
benign distance is  tensor(86.8133, device='cuda:3')
norm1 res is  tensor(389.5033, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.6442533135414124
distance x is tensor(112.9012, device='cuda:3')
benign distance is  tensor(112.9012, device='cuda:3')
norm1 res is  tensor(498.0430, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7523204684257507
distance x is tensor(112.2145, device='cuda:3')
benign distance is  tensor(112.2145, device='cuda:3')
norm1 res is  tensor(489.5912, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.4175412654876709
distance x is tensor(112.5419, device='cuda:3')
benign distance is  tensor(112.5419, device='cuda:3')
norm1 res is  tensor(503.7615, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6529409289360046
distance x is tensor(122.5303, device='cuda:3')
benign distance is  tensor(122.5303, device='cuda:3')
norm1 res is  tensor(531.5953, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.41106629371643066
distance x is tensor(109.7840, device='cuda:3')
benign distance is  tensor(109.7840, device='cuda:3')
norm1 res is  tensor(487.7036, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(92.7210, device='cuda:3')
compute distance is  tensor(92.7210, device='cuda:3')
compute norm is  tensor(49.1006, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.0272, device='cuda:3')
compute distance is  tensor(95.0272, device='cuda:3')
compute norm is  tensor(49.1436, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.1503, device='cuda:3')
compute distance is  tensor(104.1503, device='cuda:3')
compute norm is  tensor(49.3247, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.1052, device='cuda:3')
compute distance is  tensor(98.1052, device='cuda:3')
compute norm is  tensor(49.2055, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.6335, device='cuda:3')
compute distance is  tensor(100.6335, device='cuda:3')
compute norm is  tensor(49.2054, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.2340, device='cuda:3')
compute distance is  tensor(98.2340, device='cuda:3')
compute norm is  tensor(49.2221, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.2546, device='cuda:3')
compute distance is  tensor(102.2546, device='cuda:3')
compute norm is  tensor(49.4081, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.8310, device='cuda:3')
compute distance is  tensor(101.8310, device='cuda:3')
compute norm is  tensor(49.1504, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.8083, device='cuda:3')
compute distance is  tensor(95.8083, device='cuda:3')
compute norm is  tensor(49.2437, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.4115, device='cuda:3')
compute distance is  tensor(101.4115, device='cuda:3')
compute norm is  tensor(49.2868, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.1564, device='cuda:3')
compute distance is  tensor(108.1564, device='cuda:3')
compute norm is  tensor(49.4344, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.7161, device='cuda:3')
compute distance is  tensor(103.7161, device='cuda:3')
compute norm is  tensor(49.2367, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(108.1564, device='cuda:3')
distance x is tensor(106220.3203, device='cuda:3')
distance x is tensor(106220.3203, device='cuda:3')
________________________________
test distance is  tensor(106220.3203, device='cuda:3')
test distance1 is  tensor(106220.3203, device='cuda:3')
test similarity is  tensor(-0.0992, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139303014262150.83
test entropy is  0.0
________________________________
cal ratio is  0.03127147361606753
distance x is tensor(3321.6711, device='cuda:3')
cal_distance is  tensor(3321.6711, device='cuda:3')
cal ratio is  0.17683728062730758
distance x is tensor(587.3994, device='cuda:3')
cal_distance is  tensor(587.3994, device='cuda:3')
cal ratio is  0.42051878186707364
distance x is tensor(247.0154, device='cuda:3')
cal_distance is  tensor(247.0154, device='cuda:3')
cal ratio is  0.648470354291185
distance x is tensor(160.1840, device='cuda:3')
cal_distance is  tensor(160.1840, device='cuda:3')
cal ratio is  0.8052720636378746
distance x is tensor(128.9927, device='cuda:3')
cal_distance is  tensor(128.9927, device='cuda:3')
cal ratio is  0.8973660813305665
distance x is tensor(115.7542, device='cuda:3')
cal_distance is  tensor(115.7542, device='cuda:3')
cal ratio is  0.9472919919212179
distance x is tensor(109.6533, device='cuda:3')
cal_distance is  tensor(109.6533, device='cuda:3')
cal ratio is  0.9732880478047573
distance x is tensor(106.7243, device='cuda:3')
cal_distance is  tensor(106.7243, device='cuda:3')
distance x is tensor(106.7243, device='cuda:3')
return_distance is  tensor(106.7243, device='cuda:3')
distance x is tensor(106.7143, device='cuda:3')
distance x is tensor(106.7143, device='cuda:3')
________________________________
test distance is  tensor(106.7143, device='cuda:3')
test distance1 is  tensor(106.7143, device='cuda:3')
test similarity is  tensor(0.9682, device='cuda:3')
test acc is  0.10000000015633198
test loss is 167.2320372982066
test entropy is  4.3849900172155274e-20
________________________________
0
distance x is tensor(106.7143, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  4.447474643752881e-20
avg test loss is  167.18884744217146
avg accuracy is  0.616566666823003
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9682, device='cuda:3')
compute_distance is  tensor(106.7143, device='cuda:3')
compute_norm is  tensor(48.2318, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(99.4139, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8557313241557017
avg test loss is  1.293588575269622
avg accuracy is  0.8679000001563226
solo acc is  0.3513166668230071
compute similarity  is  tensor(0.9702, device='cuda:3')
compute_distance is  tensor(99.4139, device='cuda:3')
compute_norm is  tensor(47.1147, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(102.1566, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7843128560321417
avg test loss is  1.402336940582373
avg accuracy is  0.8692666668229891
solo acc is  0.2541333334896717
compute similarity  is  tensor(0.9696, device='cuda:3')
compute_distance is  tensor(102.1566, device='cuda:3')
compute_norm is  tensor(46.8149, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(104.6216, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8014602512438923
avg test loss is  1.3460508579892645
avg accuracy is  0.8711500001563225
solo acc is  0.24945000015633823
compute similarity  is  tensor(0.9691, device='cuda:3')
compute_distance is  tensor(104.6216, device='cuda:3')
compute_norm is  tensor(46.5399, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(106.8575, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7719895758354334
avg test loss is  1.367003096827566
avg accuracy is  0.872266666822989
solo acc is  0.2261166668230041
compute similarity  is  tensor(0.9686, device='cuda:3')
compute_distance is  tensor(106.8575, device='cuda:3')
compute_norm is  tensor(46.2800, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(109.0177, device='cuda:3')
distance x is tensor(109.0177, device='cuda:3')
________________________________
test distance is  tensor(109.0177, device='cuda:3')
test distance1 is  tensor(109.0177, device='cuda:3')
test similarity is  tensor(0.9683, device='cuda:3')
test acc is  0.24625000015633813
test loss is 1.28955494137461
test entropy is  0.7984965566887277
________________________________
cal ratio is  0.976121060713094
distance x is tensor(106.4210, device='cuda:3')
cal_distance is  tensor(106.4210, device='cuda:3')
distance x is tensor(106.4210, device='cuda:3')
return_distance is  tensor(106.4210, device='cuda:3')
distance x is tensor(106.4144, device='cuda:3')
distance x is tensor(106.4144, device='cuda:3')
________________________________
test distance is  tensor(106.4144, device='cuda:3')
test distance1 is  tensor(106.4144, device='cuda:3')
test similarity is  tensor(0.9698, device='cuda:3')
test acc is  0.3196333334896732
test loss is 1.1901874943201476
test entropy is  0.8258116003801065
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.074979543685913
mal norm is  tensor(526.5223, device='cuda:3')
distance x is tensor(106.4210, device='cuda:3')
mal distance is  tensor(106.4210, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([12., 13., 12., 12., 12., 12., 14., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 27., 12., 27., 27., 12., 12.])
count_res tensor([1.0196e-07, 2.7716e-07, 1.0196e-07, 1.0196e-07, 1.0196e-07, 1.0196e-07,
        7.5339e-07, 1.0196e-07, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06,
        5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06,
        5.5668e-06, 5.5668e-06, 1.0196e-07, 1.0196e-07, 3.3331e-01, 1.0196e-07,
        3.3331e-01, 3.3331e-01, 1.0196e-07, 1.0196e-07])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 89.40% 

Test Accuracy: 88.71% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4971609115600586
distance x is tensor(105.8848, device='cuda:3')
benign distance is  tensor(105.8848, device='cuda:3')
norm1 res is  tensor(466.1135, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7186515927314758
distance x is tensor(105.2396, device='cuda:3')
benign distance is  tensor(105.2396, device='cuda:3')
norm1 res is  tensor(465.2105, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.18023689091205597
distance x is tensor(122.2654, device='cuda:3')
benign distance is  tensor(122.2654, device='cuda:3')
norm1 res is  tensor(521.6660, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4742108881473541
distance x is tensor(104.2778, device='cuda:3')
benign distance is  tensor(104.2778, device='cuda:3')
norm1 res is  tensor(451.8986, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.73698490858078
distance x is tensor(105.8309, device='cuda:3')
benign distance is  tensor(105.8309, device='cuda:3')
norm1 res is  tensor(453.6546, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0285365581512451
distance x is tensor(102.4407, device='cuda:3')
benign distance is  tensor(102.4407, device='cuda:3')
norm1 res is  tensor(444.9194, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6601430177688599
distance x is tensor(100.4667, device='cuda:3')
benign distance is  tensor(100.4667, device='cuda:3')
norm1 res is  tensor(419.8763, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6737239360809326
distance x is tensor(101.7703, device='cuda:3')
benign distance is  tensor(101.7703, device='cuda:3')
norm1 res is  tensor(432.1259, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.48707589507102966
distance x is tensor(108.8303, device='cuda:3')
benign distance is  tensor(108.8303, device='cuda:3')
norm1 res is  tensor(480.1559, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.0902433842420578
distance x is tensor(131.9001, device='cuda:3')
benign distance is  tensor(131.9001, device='cuda:3')
norm1 res is  tensor(576.8922, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.8738086819648743
distance x is tensor(88.2881, device='cuda:3')
benign distance is  tensor(88.2881, device='cuda:3')
norm1 res is  tensor(384.7274, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.07189054787158966
distance x is tensor(112.4027, device='cuda:3')
benign distance is  tensor(112.4027, device='cuda:3')
norm1 res is  tensor(500.9889, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8988611102104187
distance x is tensor(101.5272, device='cuda:3')
benign distance is  tensor(101.5272, device='cuda:3')
norm1 res is  tensor(457.3569, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.900542140007019
distance x is tensor(103.0650, device='cuda:3')
benign distance is  tensor(103.0650, device='cuda:3')
norm1 res is  tensor(444.9744, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7780818939208984
distance x is tensor(98.4110, device='cuda:3')
benign distance is  tensor(98.4110, device='cuda:3')
norm1 res is  tensor(437.9622, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.47061342000961304
distance x is tensor(113.6295, device='cuda:3')
benign distance is  tensor(113.6295, device='cuda:3')
norm1 res is  tensor(491.8930, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(101.8164, device='cuda:3')
compute distance is  tensor(101.8164, device='cuda:3')
compute norm is  tensor(49.2189, device='cuda:3', dtype=torch.float64)
distance x is tensor(87.3147, device='cuda:3')
compute distance is  tensor(87.3147, device='cuda:3')
compute norm is  tensor(48.9582, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.3502, device='cuda:3')
compute distance is  tensor(123.3502, device='cuda:3')
compute norm is  tensor(49.6090, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.8526, device='cuda:3')
compute distance is  tensor(108.8526, device='cuda:3')
compute norm is  tensor(49.3651, device='cuda:3', dtype=torch.float64)
distance x is tensor(97.7722, device='cuda:3')
compute distance is  tensor(97.7722, device='cuda:3')
compute norm is  tensor(49.1792, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.6677, device='cuda:3')
compute distance is  tensor(111.6677, device='cuda:3')
compute norm is  tensor(49.5166, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.5141, device='cuda:3')
compute distance is  tensor(107.5141, device='cuda:3')
compute norm is  tensor(49.3945, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.4427, device='cuda:3')
compute distance is  tensor(108.4427, device='cuda:3')
compute norm is  tensor(49.4285, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.0020, device='cuda:3')
compute distance is  tensor(115.0020, device='cuda:3')
compute norm is  tensor(49.6416, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.7902, device='cuda:3')
compute distance is  tensor(100.7902, device='cuda:3')
compute norm is  tensor(49.3491, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.5159, device='cuda:3')
compute distance is  tensor(117.5159, device='cuda:3')
compute norm is  tensor(49.6344, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.5435, device='cuda:3')
compute distance is  tensor(105.5435, device='cuda:3')
compute norm is  tensor(49.3374, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(123.3502, device='cuda:3')
distance x is tensor(106223.3438, device='cuda:3')
distance x is tensor(106223.3438, device='cuda:3')
________________________________
test distance is  tensor(106223.3438, device='cuda:3')
test distance1 is  tensor(106223.3438, device='cuda:3')
test similarity is  tensor(-0.1024, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139265966556218.95
test entropy is  0.0
________________________________
cal ratio is  0.033395354179500576
distance x is tensor(3547.3711, device='cuda:3')
cal_distance is  tensor(3547.3711, device='cuda:3')
cal ratio is  0.18274383443785241
distance x is tensor(648.2642, device='cuda:3')
cal_distance is  tensor(648.2642, device='cuda:3')
cal ratio is  0.4274841504756079
distance x is tensor(277.1256, device='cuda:3')
cal_distance is  tensor(277.1256, device='cuda:3')
cal ratio is  0.6538192643130282
distance x is tensor(181.1918, device='cuda:3')
cal_distance is  tensor(181.1918, device='cuda:3')
cal ratio is  0.8085870250624967
distance x is tensor(146.5103, device='cuda:3')
cal_distance is  tensor(146.5103, device='cuda:3')
cal ratio is  0.8992117755529934
distance x is tensor(131.7443, device='cuda:3')
cal_distance is  tensor(131.7443, device='cuda:3')
cal ratio is  0.9482658854013106
distance x is tensor(124.9289, device='cuda:3')
cal_distance is  tensor(124.9289, device='cuda:3')
cal ratio is  0.9737884086163844
distance x is tensor(121.6544, device='cuda:3')
cal_distance is  tensor(121.6544, device='cuda:3')
distance x is tensor(121.6544, device='cuda:3')
return_distance is  tensor(121.6544, device='cuda:3')
distance x is tensor(121.6445, device='cuda:3')
distance x is tensor(121.6445, device='cuda:3')
________________________________
test distance is  tensor(121.6445, device='cuda:3')
test distance1 is  tensor(121.6445, device='cuda:3')
test similarity is  tensor(0.9592, device='cuda:3')
test acc is  0.10000000015633198
test loss is 270.43372702852747
test entropy is  3.7081146320288487e-31
________________________________
0
distance x is tensor(121.6445, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  3.218925311739913e-29
avg test loss is  270.38301040877155
avg accuracy is  0.3863500001563409
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9592, device='cuda:3')
compute_distance is  tensor(121.6445, device='cuda:3')
compute_norm is  tensor(48.4502, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(108.6087, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8328556305309857
avg test loss is  1.3435335726117783
avg accuracy is  0.866583333489656
solo acc is  0.32915000015634
compute similarity  is  tensor(0.9629, device='cuda:3')
compute_distance is  tensor(108.6087, device='cuda:3')
compute_norm is  tensor(47.2961, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(111.2473, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7942962021207505
avg test loss is  1.4004330546108645
avg accuracy is  0.8671333334896559
solo acc is  0.2542833334896717
compute similarity  is  tensor(0.9623, device='cuda:3')
compute_distance is  tensor(111.2473, device='cuda:3')
compute_norm is  tensor(46.9916, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(113.6388, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7801795948161754
avg test loss is  1.3841582488403645
avg accuracy is  0.8695833334896558
solo acc is  0.2383166668230045
compute similarity  is  tensor(0.9617, device='cuda:3')
compute_distance is  tensor(113.6388, device='cuda:3')
compute_norm is  tensor(46.7130, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.7962, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.786431988101524
avg test loss is  1.322384098826695
avg accuracy is  0.8705500001563223
solo acc is  0.24881666682300482
compute similarity  is  tensor(0.9613, device='cuda:3')
compute_distance is  tensor(115.7962, device='cuda:3')
compute_norm is  tensor(46.4506, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.9477, device='cuda:3')
distance x is tensor(117.9477, device='cuda:3')
________________________________
test distance is  tensor(117.9477, device='cuda:3')
test distance1 is  tensor(117.9477, device='cuda:3')
test similarity is  tensor(0.9609, device='cuda:3')
test acc is  0.23273333348967093
test loss is 1.3229703654104203
test entropy is  0.7799029095467728
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.286078691482544
mal norm is  tensor(598.8959, device='cuda:3')
distance x is tensor(117.9548, device='cuda:3')
mal distance is  tensor(117.9548, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([14., 20., 12., 12., 12., 12., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 27., 26., 12., 21., 12., 12., 12.])
count_res tensor([1.6481e-06, 6.6489e-04, 2.2305e-07, 2.2305e-07, 2.2305e-07, 2.2305e-07,
        2.2305e-07, 2.2305e-07, 1.2178e-05, 1.2178e-05, 1.2178e-05, 1.2178e-05,
        1.2178e-05, 1.2178e-05, 1.2178e-05, 1.2178e-05, 1.2178e-05, 1.2178e-05,
        1.2178e-05, 1.2178e-05, 2.2305e-07, 7.2914e-01, 2.6824e-01, 2.2305e-07,
        1.8074e-03, 2.2305e-07, 2.2305e-07, 2.2305e-07])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 89.12% 

Test Accuracy: 88.22% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2735252380371094
distance x is tensor(91.2830, device='cuda:3')
benign distance is  tensor(91.2830, device='cuda:3')
norm1 res is  tensor(400.9812, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.477999210357666
distance x is tensor(109.0114, device='cuda:3')
benign distance is  tensor(109.0114, device='cuda:3')
norm1 res is  tensor(475.2539, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.0663796216249466
distance x is tensor(119.8522, device='cuda:3')
benign distance is  tensor(119.8522, device='cuda:3')
norm1 res is  tensor(520.2324, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5504555702209473
distance x is tensor(111.3484, device='cuda:3')
benign distance is  tensor(111.3484, device='cuda:3')
norm1 res is  tensor(466.2023, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8892137408256531
distance x is tensor(91.2828, device='cuda:3')
benign distance is  tensor(91.2828, device='cuda:3')
norm1 res is  tensor(384.8787, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.557366669178009
distance x is tensor(120.3409, device='cuda:3')
benign distance is  tensor(120.3409, device='cuda:3')
norm1 res is  tensor(519.9601, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.23090514540672302
distance x is tensor(109.3331, device='cuda:3')
benign distance is  tensor(109.3331, device='cuda:3')
norm1 res is  tensor(469.8712, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.265514075756073
distance x is tensor(101.3693, device='cuda:3')
benign distance is  tensor(101.3693, device='cuda:3')
norm1 res is  tensor(447.5694, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5881725549697876
distance x is tensor(127.2933, device='cuda:3')
benign distance is  tensor(127.2933, device='cuda:3')
norm1 res is  tensor(546.6516, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9664174914360046
distance x is tensor(64.1263, device='cuda:3')
benign distance is  tensor(64.1263, device='cuda:3')
norm1 res is  tensor(271.5762, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4492117464542389
distance x is tensor(96.3353, device='cuda:3')
benign distance is  tensor(96.3353, device='cuda:3')
norm1 res is  tensor(415.0504, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8102207183837891
distance x is tensor(115.3226, device='cuda:3')
benign distance is  tensor(115.3226, device='cuda:3')
norm1 res is  tensor(506.7219, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.46622562408447266
distance x is tensor(110.2751, device='cuda:3')
benign distance is  tensor(110.2751, device='cuda:3')
norm1 res is  tensor(484.4608, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2502891421318054
distance x is tensor(103.9463, device='cuda:3')
benign distance is  tensor(103.9463, device='cuda:3')
norm1 res is  tensor(460.5392, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.31408411264419556
distance x is tensor(124.7819, device='cuda:3')
benign distance is  tensor(124.7819, device='cuda:3')
norm1 res is  tensor(545.0811, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8974704742431641
distance x is tensor(113.0921, device='cuda:3')
benign distance is  tensor(113.0921, device='cuda:3')
norm1 res is  tensor(499.6838, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(105.4879, device='cuda:3')
compute distance is  tensor(105.4879, device='cuda:3')
compute norm is  tensor(50.1064, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.8586, device='cuda:3')
compute distance is  tensor(109.8586, device='cuda:3')
compute norm is  tensor(50.2731, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.1626, device='cuda:3')
compute distance is  tensor(111.1626, device='cuda:3')
compute norm is  tensor(50.2854, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.1242, device='cuda:3')
compute distance is  tensor(115.1242, device='cuda:3')
compute norm is  tensor(50.2938, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.0468, device='cuda:3')
compute distance is  tensor(127.0468, device='cuda:3')
compute norm is  tensor(50.4933, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.3007, device='cuda:3')
compute distance is  tensor(118.3007, device='cuda:3')
compute norm is  tensor(50.4338, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.2916, device='cuda:3')
compute distance is  tensor(122.2916, device='cuda:3')
compute norm is  tensor(50.5517, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.2262, device='cuda:3')
compute distance is  tensor(115.2262, device='cuda:3')
compute norm is  tensor(50.2914, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.5161, device='cuda:3')
compute distance is  tensor(108.5161, device='cuda:3')
compute norm is  tensor(50.2054, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.9567, device='cuda:3')
compute distance is  tensor(117.9567, device='cuda:3')
compute norm is  tensor(50.3453, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.4492, device='cuda:3')
compute distance is  tensor(120.4492, device='cuda:3')
compute norm is  tensor(50.5136, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.2171, device='cuda:3')
compute distance is  tensor(108.2171, device='cuda:3')
compute norm is  tensor(50.1740, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(127.0468, device='cuda:3')
distance x is tensor(106223.4922, device='cuda:3')
distance x is tensor(106223.4922, device='cuda:3')
________________________________
test distance is  tensor(106223.4922, device='cuda:3')
test distance1 is  tensor(106223.4922, device='cuda:3')
test similarity is  tensor(-0.0987, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139292911364301.23
test entropy is  0.0
________________________________
cal ratio is  0.03389204203942238
distance x is tensor(3600.1367, device='cuda:3')
cal_distance is  tensor(3600.1367, device='cuda:3')
cal ratio is  0.18409777076680559
distance x is tensor(662.7812, device='cuda:3')
cal_distance is  tensor(662.7812, device='cuda:3')
cal ratio is  0.42906484487938873
distance x is tensor(284.3789, device='cuda:3')
cal_distance is  tensor(284.3789, device='cuda:3')
cal ratio is  0.6550271558228263
distance x is tensor(186.2776, device='cuda:3')
cal_distance is  tensor(186.2776, device='cuda:3')
cal ratio is  0.8093337848582597
distance x is tensor(150.7618, device='cuda:3')
cal_distance is  tensor(150.7618, device='cuda:3')
cal ratio is  0.8996268101078092
distance x is tensor(135.6299, device='cuda:3')
cal_distance is  tensor(135.6299, device='cuda:3')
cal ratio is  0.9484847823396751
distance x is tensor(128.6431, device='cuda:3')
cal_distance is  tensor(128.6431, device='cuda:3')
cal ratio is  0.9739009169003049
distance x is tensor(125.2858, device='cuda:3')
cal_distance is  tensor(125.2858, device='cuda:3')
distance x is tensor(125.2858, device='cuda:3')
return_distance is  tensor(125.2858, device='cuda:3')
distance x is tensor(125.2758, device='cuda:3')
distance x is tensor(125.2758, device='cuda:3')
________________________________
test distance is  tensor(125.2758, device='cuda:3')
test distance1 is  tensor(125.2758, device='cuda:3')
test similarity is  tensor(0.9586, device='cuda:3')
test acc is  0.10000000015633198
test loss is 295.9298155729705
test entropy is  3.1363759619817566e-30
________________________________
0
distance x is tensor(125.2758, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3530976864912893e-32
avg test loss is  296.00426432725465
avg accuracy is  0.392550000156341
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9586, device='cuda:3')
compute_distance is  tensor(125.2758, device='cuda:3')
compute_norm is  tensor(49.4169, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(112.0800, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8359355531267519
avg test loss is  1.3953008091907257
avg accuracy is  0.8562500001563231
solo acc is  0.3118833334896731
compute similarity  is  tensor(0.9623, device='cuda:3')
compute_distance is  tensor(112.0800, device='cuda:3')
compute_norm is  tensor(48.2336, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(114.6685, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7714464321954927
avg test loss is  1.4732217122751003
avg accuracy is  0.8575666668229897
solo acc is  0.24191666682300464
compute similarity  is  tensor(0.9616, device='cuda:3')
compute_distance is  tensor(114.6685, device='cuda:3')
compute_norm is  tensor(47.9182, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(116.9329, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.785639147768651
avg test loss is  1.396168155965012
avg accuracy is  0.8608833334896562
solo acc is  0.24943333348967153
compute similarity  is  tensor(0.9611, device='cuda:3')
compute_distance is  tensor(116.9329, device='cuda:3')
compute_norm is  tensor(47.6329, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(119.0996, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7886950263082345
avg test loss is  1.3580894158847296
avg accuracy is  0.8615333334896562
solo acc is  0.24445000015633805
compute similarity  is  tensor(0.9607, device='cuda:3')
compute_distance is  tensor(119.0996, device='cuda:3')
compute_norm is  tensor(47.3633, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(121.1707, device='cuda:3')
distance x is tensor(121.1707, device='cuda:3')
________________________________
test distance is  tensor(121.1707, device='cuda:3')
test distance1 is  tensor(121.1707, device='cuda:3')
test similarity is  tensor(0.9603, device='cuda:3')
test acc is  0.23181666682300434
test loss is 1.3554353771179215
test entropy is  0.7735976876099226
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.2186108827590942
mal norm is  tensor(616.1359, device='cuda:3')
distance x is tensor(121.1776, device='cuda:3')
mal distance is  tensor(121.1776, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([12., 18., 12., 12., 12., 12., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 27., 12., 24., 27., 12., 12.])
count_res tensor([1.4921e-07, 6.0197e-05, 1.4921e-07, 1.4921e-07, 1.4921e-07, 1.4921e-07,
        1.4921e-07, 1.4921e-07, 8.1467e-06, 8.1467e-06, 8.1467e-06, 8.1467e-06,
        8.1467e-06, 8.1467e-06, 8.1467e-06, 8.1467e-06, 8.1467e-06, 8.1467e-06,
        8.1467e-06, 8.1467e-06, 1.4921e-07, 1.4921e-07, 4.8778e-01, 1.4921e-07,
        2.4285e-02, 4.8778e-01, 1.4921e-07, 1.4921e-07])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 89.62% 

Test Accuracy: 88.64% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3926834464073181
distance x is tensor(110.0876, device='cuda:3')
benign distance is  tensor(110.0876, device='cuda:3')
norm1 res is  tensor(489.9336, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8007861971855164
distance x is tensor(109.7220, device='cuda:3')
benign distance is  tensor(109.7220, device='cuda:3')
norm1 res is  tensor(492.2703, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.21448490023612976
distance x is tensor(124.5012, device='cuda:3')
benign distance is  tensor(124.5012, device='cuda:3')
norm1 res is  tensor(538.3782, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5208854079246521
distance x is tensor(101.9183, device='cuda:3')
benign distance is  tensor(101.9183, device='cuda:3')
norm1 res is  tensor(451.5459, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9661275744438171
distance x is tensor(103.2549, device='cuda:3')
benign distance is  tensor(103.2549, device='cuda:3')
norm1 res is  tensor(433.9211, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9196275472640991
distance x is tensor(107.9753, device='cuda:3')
benign distance is  tensor(107.9753, device='cuda:3')
norm1 res is  tensor(481.5697, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.29727426171302795
distance x is tensor(106.6574, device='cuda:3')
benign distance is  tensor(106.6574, device='cuda:3')
norm1 res is  tensor(466.9632, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6890949010848999
distance x is tensor(105.8017, device='cuda:3')
benign distance is  tensor(105.8017, device='cuda:3')
norm1 res is  tensor(464.3268, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.41662997007369995
distance x is tensor(118.1717, device='cuda:3')
benign distance is  tensor(118.1717, device='cuda:3')
norm1 res is  tensor(512.2454, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5776592493057251
distance x is tensor(121.4206, device='cuda:3')
benign distance is  tensor(121.4206, device='cuda:3')
norm1 res is  tensor(539.5257, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.1779150813817978
distance x is tensor(87.5963, device='cuda:3')
benign distance is  tensor(87.5963, device='cuda:3')
norm1 res is  tensor(379.8910, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.42948785424232483
distance x is tensor(112.8055, device='cuda:3')
benign distance is  tensor(112.8055, device='cuda:3')
norm1 res is  tensor(512.0220, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5860059857368469
distance x is tensor(112.0984, device='cuda:3')
benign distance is  tensor(112.0984, device='cuda:3')
norm1 res is  tensor(497.3039, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8899818658828735
distance x is tensor(76.7565, device='cuda:3')
benign distance is  tensor(76.7565, device='cuda:3')
norm1 res is  tensor(329.3027, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.43561092019081116
distance x is tensor(95.4331, device='cuda:3')
benign distance is  tensor(95.4331, device='cuda:3')
norm1 res is  tensor(421.3792, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5816383361816406
distance x is tensor(109.5896, device='cuda:3')
benign distance is  tensor(109.5896, device='cuda:3')
norm1 res is  tensor(477.3564, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(113.5166, device='cuda:3')
compute distance is  tensor(113.5166, device='cuda:3')
compute norm is  tensor(49.8719, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.4564, device='cuda:3')
compute distance is  tensor(102.4564, device='cuda:3')
compute norm is  tensor(49.7769, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.9957, device='cuda:3')
compute distance is  tensor(107.9957, device='cuda:3')
compute norm is  tensor(50.1348, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.2604, device='cuda:3')
compute distance is  tensor(106.2604, device='cuda:3')
compute norm is  tensor(49.9124, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.2619, device='cuda:3')
compute distance is  tensor(124.2619, device='cuda:3')
compute norm is  tensor(50.1444, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.5460, device='cuda:3')
compute distance is  tensor(104.5460, device='cuda:3')
compute norm is  tensor(49.9629, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.1965, device='cuda:3')
compute distance is  tensor(104.1965, device='cuda:3')
compute norm is  tensor(49.9897, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.2525, device='cuda:3')
compute distance is  tensor(118.2525, device='cuda:3')
compute norm is  tensor(50.1106, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.5720, device='cuda:3')
compute distance is  tensor(112.5720, device='cuda:3')
compute norm is  tensor(50.0339, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.3433, device='cuda:3')
compute distance is  tensor(107.3433, device='cuda:3')
compute norm is  tensor(49.9776, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.2568, device='cuda:3')
compute distance is  tensor(128.2568, device='cuda:3')
compute norm is  tensor(50.3702, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.6501, device='cuda:3')
compute distance is  tensor(104.6501, device='cuda:3')
compute norm is  tensor(49.9241, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(128.2568, device='cuda:3')
distance x is tensor(106221.9219, device='cuda:3')
distance x is tensor(106221.9219, device='cuda:3')
________________________________
test distance is  tensor(106221.9219, device='cuda:3')
test distance1 is  tensor(106221.9219, device='cuda:3')
test similarity is  tensor(-0.0961, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139273460847386.75
test entropy is  0.0
________________________________
cal ratio is  0.034053299501656475
distance x is tensor(3617.2119, device='cuda:3')
cal_distance is  tensor(3617.2119, device='cuda:3')
cal ratio is  0.18453523661435944
distance x is tensor(667.5071, device='cuda:3')
cal_distance is  tensor(667.5071, device='cuda:3')
cal ratio is  0.4295743598965854
distance x is tensor(286.7468, device='cuda:3')
cal_distance is  tensor(286.7468, device='cuda:3')
cal ratio is  0.6554159359848046
distance x is tensor(187.9402, device='cuda:3')
cal_distance is  tensor(187.9402, device='cuda:3')
cal ratio is  0.8095738781085486
distance x is tensor(152.1524, device='cuda:3')
cal_distance is  tensor(152.1524, device='cuda:3')
cal ratio is  0.8997603620074003
distance x is tensor(136.9012, device='cuda:3')
cal_distance is  tensor(136.9012, device='cuda:3')
cal ratio is  0.948555242340902
distance x is tensor(129.8586, device='cuda:3')
cal_distance is  tensor(129.8586, device='cuda:3')
cal ratio is  0.9739370355341201
distance x is tensor(126.4742, device='cuda:3')
cal_distance is  tensor(126.4742, device='cuda:3')
distance x is tensor(126.4742, device='cuda:3')
return_distance is  tensor(126.4742, device='cuda:3')
distance x is tensor(126.4643, device='cuda:3')
distance x is tensor(126.4643, device='cuda:3')
________________________________
test distance is  tensor(126.4643, device='cuda:3')
test distance1 is  tensor(126.4643, device='cuda:3')
test similarity is  tensor(0.9572, device='cuda:3')
test acc is  0.10000000015633198
test loss is 323.9601152171967
test entropy is  8.694519441739199e-37
________________________________
0
distance x is tensor(126.4643, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  9.848662146012214e-37
avg test loss is  324.02829073842906
avg accuracy is  0.3137166668230064
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9572, device='cuda:3')
compute_distance is  tensor(126.4643, device='cuda:3')
compute_norm is  tensor(49.1876, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(113.2378, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.838640691374919
avg test loss is  1.3780079905285256
avg accuracy is  0.8547666668229896
solo acc is  0.32275000015634
compute similarity  is  tensor(0.9611, device='cuda:3')
compute_distance is  tensor(113.2378, device='cuda:3')
compute_norm is  tensor(47.9835, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.7149, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7805068423626011
avg test loss is  1.4574167936849696
avg accuracy is  0.8570000001563229
solo acc is  0.24536666682300473
compute similarity  is  tensor(0.9604, device='cuda:3')
compute_distance is  tensor(115.7149, device='cuda:3')
compute_norm is  tensor(47.6719, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.9583, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7957548938199147
avg test loss is  1.3697828814419093
avg accuracy is  0.8589000001563228
solo acc is  0.2547833334896717
compute similarity  is  tensor(0.9599, device='cuda:3')
compute_distance is  tensor(117.9583, device='cuda:3')
compute_norm is  tensor(47.3869, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(120.1494, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7852141426316203
avg test loss is  1.3486147623961922
avg accuracy is  0.8611833334896561
solo acc is  0.24476666682300474
compute similarity  is  tensor(0.9594, device='cuda:3')
compute_distance is  tensor(120.1494, device='cuda:3')
compute_norm is  tensor(47.1164, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(122.2571, device='cuda:3')
distance x is tensor(122.2571, device='cuda:3')
________________________________
test distance is  tensor(122.2571, device='cuda:3')
test distance1 is  tensor(122.2571, device='cuda:3')
test similarity is  tensor(0.9590, device='cuda:3')
test acc is  0.2515333334896716
test loss is 1.2996679950497552
test entropy is  0.7934080892280221
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2384650707244873
mal norm is  tensor(621.5963, device='cuda:3')
distance x is tensor(122.2641, device='cuda:3')
mal distance is  tensor(122.2641, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([35., 12., 12., 12., 17., 12., 12., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 14., 35., 33., 35., 12., 12., 32., 13.,
        17., 12., 34., 12., 12., 12., 35., 12.])
count_res tensor([2.1963e-01, 2.2538e-11, 2.2538e-11, 2.2538e-11, 3.3449e-09, 2.2538e-11,
        2.2538e-11, 2.2538e-11, 3.6681e-06, 3.6681e-06, 3.6681e-06, 3.6681e-06,
        3.6681e-06, 3.6681e-06, 3.6681e-06, 3.6681e-06, 3.6681e-06, 3.6681e-06,
        3.6681e-06, 3.6681e-06, 1.6653e-10, 2.1963e-01, 2.9723e-02, 2.1963e-01,
        2.2538e-11, 2.2538e-11, 1.0935e-02, 6.1264e-11, 3.3449e-09, 2.2538e-11,
        8.0796e-02, 2.2538e-11, 2.2538e-11, 2.2538e-11, 2.1963e-01, 2.2538e-11])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 89.76% 

Test Accuracy: 88.84% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8593711853027344
distance x is tensor(86.8057, device='cuda:3')
benign distance is  tensor(86.8057, device='cuda:3')
norm1 res is  tensor(388.0888, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.36116451025009155
distance x is tensor(112.4251, device='cuda:3')
benign distance is  tensor(112.4251, device='cuda:3')
norm1 res is  tensor(495.6797, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.08665765821933746
distance x is tensor(115.8206, device='cuda:3')
benign distance is  tensor(115.8206, device='cuda:3')
norm1 res is  tensor(497.3198, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.296630322933197
distance x is tensor(103.7828, device='cuda:3')
benign distance is  tensor(103.7828, device='cuda:3')
norm1 res is  tensor(446.1680, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.834335207939148
distance x is tensor(90.9228, device='cuda:3')
benign distance is  tensor(90.9228, device='cuda:3')
norm1 res is  tensor(379.3973, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3106214106082916
distance x is tensor(110.4315, device='cuda:3')
benign distance is  tensor(110.4315, device='cuda:3')
norm1 res is  tensor(472.0458, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6432912945747375
distance x is tensor(98.0348, device='cuda:3')
benign distance is  tensor(98.0348, device='cuda:3')
norm1 res is  tensor(407.6016, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1960780918598175
distance x is tensor(97.2826, device='cuda:3')
benign distance is  tensor(97.2826, device='cuda:3')
norm1 res is  tensor(428.6600, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.36821800470352173
distance x is tensor(116.3162, device='cuda:3')
benign distance is  tensor(116.3162, device='cuda:3')
norm1 res is  tensor(507.6689, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7891805768013
distance x is tensor(106.4298, device='cuda:3')
benign distance is  tensor(106.4298, device='cuda:3')
norm1 res is  tensor(465.5727, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7529360055923462
distance x is tensor(98.0821, device='cuda:3')
benign distance is  tensor(98.0821, device='cuda:3')
norm1 res is  tensor(431.7761, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0763089656829834
distance x is tensor(108.2420, device='cuda:3')
benign distance is  tensor(108.2420, device='cuda:3')
norm1 res is  tensor(477.3582, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6620151400566101
distance x is tensor(109.6680, device='cuda:3')
benign distance is  tensor(109.6680, device='cuda:3')
norm1 res is  tensor(487.5850, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.22122152149677277
distance x is tensor(95.9255, device='cuda:3')
benign distance is  tensor(95.9255, device='cuda:3')
norm1 res is  tensor(426.8837, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6481767296791077
distance x is tensor(110.7929, device='cuda:3')
benign distance is  tensor(110.7929, device='cuda:3')
norm1 res is  tensor(493.4239, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7212701439857483
distance x is tensor(103.1025, device='cuda:3')
benign distance is  tensor(103.1025, device='cuda:3')
norm1 res is  tensor(455.0670, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.41678112745285034
distance x is tensor(100.3968, device='cuda:3')
benign distance is  tensor(100.3968, device='cuda:3')
norm1 res is  tensor(444.3057, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.0440555810928345
distance x is tensor(94.3164, device='cuda:3')
benign distance is  tensor(94.3164, device='cuda:3')
norm1 res is  tensor(418.1136, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.24105127155780792
distance x is tensor(102.7080, device='cuda:3')
benign distance is  tensor(102.7080, device='cuda:3')
norm1 res is  tensor(458.6532, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.8611788749694824
distance x is tensor(102.6272, device='cuda:3')
benign distance is  tensor(102.6272, device='cuda:3')
norm1 res is  tensor(442.9318, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8228667974472046
distance x is tensor(121.8949, device='cuda:3')
benign distance is  tensor(121.8949, device='cuda:3')
norm1 res is  tensor(532.6752, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5966655611991882
distance x is tensor(112.7947, device='cuda:3')
benign distance is  tensor(112.7947, device='cuda:3')
norm1 res is  tensor(497.8248, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4253907799720764
distance x is tensor(115.6163, device='cuda:3')
benign distance is  tensor(115.6163, device='cuda:3')
norm1 res is  tensor(522.0029, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.05652014538645744
distance x is tensor(93.2757, device='cuda:3')
benign distance is  tensor(93.2757, device='cuda:3')
norm1 res is  tensor(431.1666, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(104.9632, device='cuda:3')
compute distance is  tensor(104.9632, device='cuda:3')
compute norm is  tensor(49.9315, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.0020, device='cuda:3')
compute distance is  tensor(98.0020, device='cuda:3')
compute norm is  tensor(49.8669, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.8134, device='cuda:3')
compute distance is  tensor(111.8134, device='cuda:3')
compute norm is  tensor(50.1055, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.8432, device='cuda:3')
compute distance is  tensor(102.8432, device='cuda:3')
compute norm is  tensor(50.0157, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.9232, device='cuda:3')
compute distance is  tensor(107.9232, device='cuda:3')
compute norm is  tensor(50.0698, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.4874, device='cuda:3')
compute distance is  tensor(98.4874, device='cuda:3')
compute norm is  tensor(49.9334, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.4980, device='cuda:3')
compute distance is  tensor(106.4980, device='cuda:3')
compute norm is  tensor(50.0656, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.4598, device='cuda:3')
compute distance is  tensor(122.4598, device='cuda:3')
compute norm is  tensor(50.2865, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.4786, device='cuda:3')
compute distance is  tensor(107.4786, device='cuda:3')
compute norm is  tensor(50.0849, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.9426, device='cuda:3')
compute distance is  tensor(104.9426, device='cuda:3')
compute norm is  tensor(50.0713, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.3090, device='cuda:3')
compute distance is  tensor(117.3090, device='cuda:3')
compute norm is  tensor(50.2572, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.2740, device='cuda:3')
compute distance is  tensor(100.2740, device='cuda:3')
compute norm is  tensor(49.9831, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(122.4598, device='cuda:3')
distance x is tensor(106222.1953, device='cuda:3')
distance x is tensor(106222.1953, device='cuda:3')
________________________________
test distance is  tensor(106222.1953, device='cuda:3')
test distance1 is  tensor(106222.1953, device='cuda:3')
test similarity is  tensor(-0.0990, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139265241442439.38
test entropy is  0.0
________________________________
cal ratio is  0.0332747818190653
distance x is tensor(3534.5259, device='cuda:3')
cal_distance is  tensor(3534.5259, device='cuda:3')
cal ratio is  0.18241362630259433
distance x is tensor(644.7497, device='cuda:3')
cal_distance is  tensor(644.7497, device='cuda:3')
cal ratio is  0.42709776336281446
distance x is tensor(275.3740, device='cuda:3')
cal_distance is  tensor(275.3740, device='cuda:3')
cal ratio is  0.6535237913379631
distance x is tensor(179.9652, device='cuda:3')
cal_distance is  tensor(179.9652, device='cuda:3')
cal ratio is  0.8084042104849956
distance x is tensor(145.4856, device='cuda:3')
cal_distance is  tensor(145.4856, device='cuda:3')
cal ratio is  0.8991099765985658
distance x is tensor(130.8081, device='cuda:3')
cal_distance is  tensor(130.8081, device='cuda:3')
cal ratio is  0.948212247491739
distance x is tensor(124.0341, device='cuda:3')
cal_distance is  tensor(124.0341, device='cuda:3')
cal ratio is  0.9737608379892059
distance x is tensor(120.7797, device='cuda:3')
cal_distance is  tensor(120.7797, device='cuda:3')
distance x is tensor(120.7797, device='cuda:3')
return_distance is  tensor(120.7797, device='cuda:3')
distance x is tensor(120.7697, device='cuda:3')
distance x is tensor(120.7697, device='cuda:3')
________________________________
test distance is  tensor(120.7697, device='cuda:3')
test distance1 is  tensor(120.7697, device='cuda:3')
test similarity is  tensor(0.9609, device='cuda:3')
test acc is  0.10000000015633198
test loss is 274.8876173267486
test entropy is  1.3120510847761236e-32
________________________________
0
distance x is tensor(120.7697, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0104291153536807e-31
avg test loss is  274.8621091374965
avg accuracy is  0.4042833334896745
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9609, device='cuda:3')
compute_distance is  tensor(120.7697, device='cuda:3')
compute_norm is  tensor(49.1407, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(109.0126, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.805198028461257
avg test loss is  1.3876352068711955
avg accuracy is  0.871266666822989
solo acc is  0.3132166668230064
compute similarity  is  tensor(0.9643, device='cuda:3')
compute_distance is  tensor(109.0126, device='cuda:3')
compute_norm is  tensor(47.9729, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(111.6525, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7929188240565725
avg test loss is  1.4017923165486057
avg accuracy is  0.8719666668229891
solo acc is  0.2592166668230052
compute similarity  is  tensor(0.9636, device='cuda:3')
compute_distance is  tensor(111.6525, device='cuda:3')
compute_norm is  tensor(47.6673, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(113.9375, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.749737943222782
avg test loss is  1.4516558966148636
avg accuracy is  0.8733833334896557
solo acc is  0.2191500001563371
compute similarity  is  tensor(0.9631, device='cuda:3')
compute_distance is  tensor(113.9375, device='cuda:3')
compute_norm is  tensor(47.3867, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(116.1412, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7800330397670966
avg test loss is  1.3546343129326794
avg accuracy is  0.874966666822989
solo acc is  0.2378333334896712
compute similarity  is  tensor(0.9627, device='cuda:3')
compute_distance is  tensor(116.1412, device='cuda:3')
compute_norm is  tensor(47.1201, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(118.2042, device='cuda:3')
distance x is tensor(118.2042, device='cuda:3')
________________________________
test distance is  tensor(118.2042, device='cuda:3')
test distance1 is  tensor(118.2042, device='cuda:3')
test similarity is  tensor(0.9623, device='cuda:3')
test acc is  0.23510000015633775
test loss is 1.3331085838107413
test entropy is  0.7754378726106208
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2514904737472534
mal norm is  tensor(596.4564, device='cuda:3')
distance x is tensor(118.2110, device='cuda:3')
mal distance is  tensor(118.2110, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 19.92% 

Test Accuracy: 19.09% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6057299375534058
distance x is tensor(156.7081, device='cuda:3')
benign distance is  tensor(156.7081, device='cuda:3')
norm1 res is  tensor(612.8746, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7621572613716125
distance x is tensor(164.4275, device='cuda:3')
benign distance is  tensor(164.4275, device='cuda:3')
norm1 res is  tensor(648.3741, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.25666576623916626
distance x is tensor(168.5777, device='cuda:3')
benign distance is  tensor(168.5777, device='cuda:3')
norm1 res is  tensor(646.7100, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.34966713190078735
distance x is tensor(166.4742, device='cuda:3')
benign distance is  tensor(166.4742, device='cuda:3')
norm1 res is  tensor(629.4323, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8971072435379028
distance x is tensor(171.7797, device='cuda:3')
benign distance is  tensor(171.7797, device='cuda:3')
norm1 res is  tensor(639.7104, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8505719900131226
distance x is tensor(149.8461, device='cuda:3')
benign distance is  tensor(149.8461, device='cuda:3')
norm1 res is  tensor(585.4412, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.23673681914806366
distance x is tensor(166.7418, device='cuda:3')
benign distance is  tensor(166.7418, device='cuda:3')
norm1 res is  tensor(635.4751, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7472149729728699
distance x is tensor(158.8517, device='cuda:3')
benign distance is  tensor(158.8517, device='cuda:3')
norm1 res is  tensor(632.0856, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(165.7343, device='cuda:3')
compute distance is  tensor(165.7343, device='cuda:3')
compute norm is  tensor(48.9293, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.3145, device='cuda:3')
compute distance is  tensor(152.3145, device='cuda:3')
compute norm is  tensor(48.5800, device='cuda:3', dtype=torch.float64)
distance x is tensor(177.5802, device='cuda:3')
compute distance is  tensor(177.5802, device='cuda:3')
compute norm is  tensor(49.2033, device='cuda:3', dtype=torch.float64)
distance x is tensor(179.1492, device='cuda:3')
compute distance is  tensor(179.1492, device='cuda:3')
compute norm is  tensor(49.1978, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.0940, device='cuda:3')
compute distance is  tensor(158.0940, device='cuda:3')
compute norm is  tensor(48.8042, device='cuda:3', dtype=torch.float64)
distance x is tensor(176.9737, device='cuda:3')
compute distance is  tensor(176.9737, device='cuda:3')
compute norm is  tensor(49.1732, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.0189, device='cuda:3')
compute distance is  tensor(155.0189, device='cuda:3')
compute norm is  tensor(48.8304, device='cuda:3', dtype=torch.float64)
distance x is tensor(179.8002, device='cuda:3')
compute distance is  tensor(179.8002, device='cuda:3')
compute norm is  tensor(49.1896, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.7847, device='cuda:3')
compute distance is  tensor(167.7847, device='cuda:3')
compute norm is  tensor(48.9742, device='cuda:3', dtype=torch.float64)
distance x is tensor(169.5990, device='cuda:3')
compute distance is  tensor(169.5990, device='cuda:3')
compute norm is  tensor(48.9215, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.9947, device='cuda:3')
compute distance is  tensor(154.9947, device='cuda:3')
compute norm is  tensor(48.8195, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.2836, device='cuda:3')
compute distance is  tensor(154.2836, device='cuda:3')
compute norm is  tensor(48.7707, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(179.8002, device='cuda:3')
distance x is tensor(106153.7188, device='cuda:3')
distance x is tensor(106153.7188, device='cuda:3')
________________________________
test distance is  tensor(106153.7188, device='cuda:3')
test distance1 is  tensor(106153.7188, device='cuda:3')
test similarity is  tensor(0.1349, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139282055173030.48
test entropy is  0.0
________________________________
cal ratio is  0.04033234701598746
distance x is tensor(4281.4341, device='cuda:3')
cal_distance is  tensor(4281.4341, device='cuda:3')
cal ratio is  0.2008290194301028
distance x is tensor(859.8402, device='cuda:3')
cal_distance is  tensor(859.8402, device='cuda:3')
cal ratio is  0.44813847327361694
distance x is tensor(385.3302, device='cuda:3')
cal_distance is  tensor(385.3302, device='cuda:3')
cal ratio is  0.6694290576249687
distance x is tensor(257.9529, device='cuda:3')
cal_distance is  tensor(257.9529, device='cuda:3')
cal ratio is  0.8181838163357475
distance x is tensor(211.0538, device='cuda:3')
cal_distance is  tensor(211.0538, device='cuda:3')
cal ratio is  0.9045331698931208
distance x is tensor(190.9057, device='cuda:3')
cal_distance is  tensor(190.9057, device='cuda:3')
cal ratio is  0.9510683131306341
distance x is tensor(181.5646, device='cuda:3')
cal_distance is  tensor(181.5646, device='cuda:3')
cal ratio is  0.9752265835131207
distance x is tensor(177.0667, device='cuda:3')
cal_distance is  tensor(177.0667, device='cuda:3')
distance x is tensor(177.0667, device='cuda:3')
return_distance is  tensor(177.0667, device='cuda:3')
distance x is tensor(177.0567, device='cuda:3')
distance x is tensor(177.0567, device='cuda:3')
________________________________
test distance is  tensor(177.0567, device='cuda:3')
test distance1 is  tensor(177.0567, device='cuda:3')
test similarity is  tensor(0.9277, device='cuda:3')
test acc is  0.10000000015633198
test loss is 1013.2235374857368
test entropy is  0.0
________________________________
0
distance x is tensor(177.0567, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  1013.5586227709805
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9277, device='cuda:3')
compute_distance is  tensor(177.0567, device='cuda:3')
compute_norm is  tensor(50.8049, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(567.3618, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5615189987967517
avg test loss is  2.8501176536718664
avg accuracy is  0.14385000015633265
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5132, device='cuda:3')
compute_distance is  tensor(567.3618, device='cuda:3')
compute_norm is  tensor(87.9361, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(565.6675, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8378216180720055
avg test loss is  3.5834277433627197
avg accuracy is  0.096200000156332
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5132, device='cuda:3')
compute_distance is  tensor(565.6675, device='cuda:3')
compute_norm is  tensor(87.8961, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(563.0928, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5539146717677492
avg test loss is  2.851860969051369
avg accuracy is  0.144083333489666
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5131, device='cuda:3')
compute_distance is  tensor(563.0928, device='cuda:3')
compute_norm is  tensor(87.1291, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(561.4926, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.83792303651889
avg test loss is  3.5799100548982112
avg accuracy is  0.09673333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5132, device='cuda:3')
compute_distance is  tensor(561.4926, device='cuda:3')
compute_norm is  tensor(87.0935, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(559.0172, device='cuda:3')
distance x is tensor(559.0172, device='cuda:3')
________________________________
test distance is  tensor(559.0172, device='cuda:3')
test distance1 is  tensor(559.0172, device='cuda:3')
test similarity is  tensor(0.5131, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.851957393861783
test entropy is  1.5535068074777436
________________________________
cal ratio is  0.5557871695271086
distance x is tensor(310.6973, device='cuda:3')
cal_distance is  tensor(310.6973, device='cuda:3')
cal ratio is  0.7455081475936459
distance x is tensor(231.6278, device='cuda:3')
cal_distance is  tensor(231.6278, device='cuda:3')
cal ratio is  0.8634273470883288
distance x is tensor(199.9940, device='cuda:3')
cal_distance is  tensor(199.9940, device='cuda:3')
cal ratio is  0.9292073625168614
distance x is tensor(185.8360, device='cuda:3')
cal_distance is  tensor(185.8360, device='cuda:3')
cal ratio is  0.9639536333859241
distance x is tensor(179.1374, device='cuda:3')
cal_distance is  tensor(179.1374, device='cuda:3')
distance x is tensor(179.1374, device='cuda:3')
return_distance is  tensor(179.1374, device='cuda:3')
distance x is tensor(179.1340, device='cuda:3')
distance x is tensor(179.1340, device='cuda:3')
________________________________
test distance is  tensor(179.1340, device='cuda:3')
test distance1 is  tensor(179.1340, device='cuda:3')
test similarity is  tensor(0.8708, device='cuda:3')
test acc is  0.15993333348966732
test loss is 3.032879134485208
test entropy is  1.5002017810400614
________________________________
0
distance x is tensor(179.1340, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.498749424780864
avg test loss is  3.036661922804582
avg accuracy is  0.25273333348967164
solo acc is  0.1588666668230006
compute similarity  is  tensor(0.8708, device='cuda:3')
compute_distance is  tensor(179.1340, device='cuda:3')
compute_norm is  tensor(55.1962, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(181.6054, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6223347340819678
avg test loss is  2.6011130649652054
avg accuracy is  0.10440000015633197
solo acc is  0.10150000015633197
compute similarity  is  tensor(0.8705, device='cuda:3')
compute_distance is  tensor(181.6054, device='cuda:3')
compute_norm is  tensor(54.9816, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(183.3351, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9257639311651177
avg test loss is  1.5597799274204636
avg accuracy is  0.10300000015633197
solo acc is  0.17980000015633532
compute similarity  is  tensor(0.8703, device='cuda:3')
compute_distance is  tensor(183.3351, device='cuda:3')
compute_norm is  tensor(54.7237, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(183.3351, device='cuda:3')
distance x is tensor(183.3351, device='cuda:3')
________________________________
test distance is  tensor(183.3351, device='cuda:3')
test distance1 is  tensor(183.3351, device='cuda:3')
test similarity is  tensor(0.8703, device='cuda:3')
test acc is  0.17926666682300188
test loss is 1.5581578078554637
test entropy is  0.926079181783489
________________________________
cal ratio is  0.9705061632227957
distance x is tensor(177.9297, device='cuda:3')
cal_distance is  tensor(177.9297, device='cuda:3')
distance x is tensor(177.9297, device='cuda:3')
return_distance is  tensor(177.9297, device='cuda:3')
distance x is tensor(177.9278, device='cuda:3')
distance x is tensor(177.9278, device='cuda:3')
________________________________
test distance is  tensor(177.9278, device='cuda:3')
test distance1 is  tensor(177.9278, device='cuda:3')
test similarity is  tensor(0.8764, device='cuda:3')
test acc is  0.16813333348966789
test loss is 1.611285107349282
test entropy is  0.8852196839064169
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.315467119216919
mal norm is  tensor(1176.5386, device='cuda:3')
distance x is tensor(177.9297, device='cuda:3')
mal distance is  tensor(177.9297, device='cuda:3')
user_PLR len size 52
counter_tensor is  tensor([24., 24., 40., 24., 24., 24., 45., 24., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 41., 12., 13., 48., 12., 13., 22., 37.,
        51., 15., 51., 33., 50., 13., 16., 23., 17., 15., 29., 51., 33., 36.,
        51., 48., 16., 24., 44., 38., 42., 12., 33., 16.])
count_res tensor([4.2036e-13, 4.2036e-13, 3.7354e-06, 4.2036e-13, 4.2036e-13, 4.2036e-13,
        5.5438e-04, 4.2036e-13, 3.7354e-06, 3.7354e-06, 3.7354e-06, 3.7354e-06,
        3.7354e-06, 3.7354e-06, 3.7354e-06, 3.7354e-06, 3.7354e-06, 3.7354e-06,
        3.7354e-06, 3.7354e-06, 1.0154e-05, 2.5828e-18, 7.0207e-18, 1.1135e-02,
        2.5828e-18, 7.0207e-18, 5.6890e-14, 1.8597e-07, 2.2365e-01, 5.1877e-17,
        2.2365e-01, 3.4062e-09, 8.2277e-02, 7.0207e-18, 1.4102e-16, 1.5464e-13,
        3.8332e-16, 5.1877e-17, 6.2387e-11, 2.2365e-01, 3.4062e-09, 6.8416e-08,
        2.2365e-01, 1.1135e-02, 1.4102e-16, 4.2036e-13, 2.0394e-04, 5.0553e-07,
        2.7601e-05, 2.5828e-18, 3.4062e-09, 1.4102e-16])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 89.69% 

Test Accuracy: 89.09% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5111242532730103
distance x is tensor(111.4313, device='cuda:3')
benign distance is  tensor(111.4313, device='cuda:3')
norm1 res is  tensor(486.5498, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7360050082206726
distance x is tensor(98.0657, device='cuda:3')
benign distance is  tensor(98.0657, device='cuda:3')
norm1 res is  tensor(440.4554, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.21061956882476807
distance x is tensor(125.1464, device='cuda:3')
benign distance is  tensor(125.1464, device='cuda:3')
norm1 res is  tensor(519.8037, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8740732073783875
distance x is tensor(95.8536, device='cuda:3')
benign distance is  tensor(95.8536, device='cuda:3')
norm1 res is  tensor(423.3834, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7361222505569458
distance x is tensor(100.7574, device='cuda:3')
benign distance is  tensor(100.7574, device='cuda:3')
norm1 res is  tensor(433.0381, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.1922808587551117
distance x is tensor(104.4779, device='cuda:3')
benign distance is  tensor(104.4779, device='cuda:3')
norm1 res is  tensor(460.6136, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6653925180435181
distance x is tensor(98.0174, device='cuda:3')
benign distance is  tensor(98.0174, device='cuda:3')
norm1 res is  tensor(425.7174, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4679045081138611
distance x is tensor(91.3945, device='cuda:3')
benign distance is  tensor(91.3945, device='cuda:3')
norm1 res is  tensor(409.5613, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.32317107915878296
distance x is tensor(124.5443, device='cuda:3')
benign distance is  tensor(124.5443, device='cuda:3')
norm1 res is  tensor(541.1412, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7425912022590637
distance x is tensor(128.7107, device='cuda:3')
benign distance is  tensor(128.7107, device='cuda:3')
norm1 res is  tensor(565.6855, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.511518120765686
distance x is tensor(109.2721, device='cuda:3')
benign distance is  tensor(109.2721, device='cuda:3')
norm1 res is  tensor(481.2586, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5611451864242554
distance x is tensor(116.5719, device='cuda:3')
benign distance is  tensor(116.5719, device='cuda:3')
norm1 res is  tensor(510.4831, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3977515995502472
distance x is tensor(114.0214, device='cuda:3')
benign distance is  tensor(114.0214, device='cuda:3')
norm1 res is  tensor(509.7791, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.39057308435440063
distance x is tensor(92.3828, device='cuda:3')
benign distance is  tensor(92.3828, device='cuda:3')
norm1 res is  tensor(402.5677, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5571298599243164
distance x is tensor(128.6796, device='cuda:3')
benign distance is  tensor(128.6796, device='cuda:3')
norm1 res is  tensor(562.6044, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4927428364753723
distance x is tensor(100.7135, device='cuda:3')
benign distance is  tensor(100.7135, device='cuda:3')
norm1 res is  tensor(443.0593, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4785575866699219
distance x is tensor(119.2681, device='cuda:3')
benign distance is  tensor(119.2681, device='cuda:3')
norm1 res is  tensor(522.7314, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7429054379463196
distance x is tensor(123.1080, device='cuda:3')
benign distance is  tensor(123.1080, device='cuda:3')
norm1 res is  tensor(545.1039, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.256234735250473
distance x is tensor(108.0791, device='cuda:3')
benign distance is  tensor(108.0791, device='cuda:3')
norm1 res is  tensor(464.1251, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.49000072479248047
distance x is tensor(101.7225, device='cuda:3')
benign distance is  tensor(101.7225, device='cuda:3')
norm1 res is  tensor(449.5671, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.34847503900527954
distance x is tensor(115.1607, device='cuda:3')
benign distance is  tensor(115.1607, device='cuda:3')
norm1 res is  tensor(501.7035, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.573509693145752
distance x is tensor(94.9336, device='cuda:3')
benign distance is  tensor(94.9336, device='cuda:3')
norm1 res is  tensor(412.8851, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.310311496257782
distance x is tensor(87.2462, device='cuda:3')
benign distance is  tensor(87.2462, device='cuda:3')
norm1 res is  tensor(385.8324, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5052083730697632
distance x is tensor(108.8576, device='cuda:3')
benign distance is  tensor(108.8576, device='cuda:3')
norm1 res is  tensor(473.4448, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.6038972735404968
distance x is tensor(101.9658, device='cuda:3')
benign distance is  tensor(101.9658, device='cuda:3')
norm1 res is  tensor(454.0340, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.13724298775196075
distance x is tensor(107.5294, device='cuda:3')
benign distance is  tensor(107.5294, device='cuda:3')
norm1 res is  tensor(483.7629, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6730517148971558
distance x is tensor(78.9200, device='cuda:3')
benign distance is  tensor(78.9200, device='cuda:3')
norm1 res is  tensor(344.0800, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.06192120909690857
distance x is tensor(116.3550, device='cuda:3')
benign distance is  tensor(116.3550, device='cuda:3')
norm1 res is  tensor(511.4030, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5587417483329773
distance x is tensor(99.8783, device='cuda:3')
benign distance is  tensor(99.8783, device='cuda:3')
norm1 res is  tensor(452.0972, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.29844731092453003
distance x is tensor(105.2135, device='cuda:3')
benign distance is  tensor(105.2135, device='cuda:3')
norm1 res is  tensor(451.2341, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.45297813415527344
distance x is tensor(100.2044, device='cuda:3')
benign distance is  tensor(100.2044, device='cuda:3')
norm1 res is  tensor(436.2716, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.4214651584625244
distance x is tensor(124.2534, device='cuda:3')
benign distance is  tensor(124.2534, device='cuda:3')
norm1 res is  tensor(544.8123, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.7234030961990356
distance x is tensor(117.6312, device='cuda:3')
benign distance is  tensor(117.6312, device='cuda:3')
norm1 res is  tensor(512.8417, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.7160788178443909
distance x is tensor(113.7552, device='cuda:3')
benign distance is  tensor(113.7552, device='cuda:3')
norm1 res is  tensor(495.3256, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.038509923964738846
distance x is tensor(110.1377, device='cuda:3')
benign distance is  tensor(110.1377, device='cuda:3')
norm1 res is  tensor(480.4061, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.44363993406295776
distance x is tensor(119.6845, device='cuda:3')
benign distance is  tensor(119.6845, device='cuda:3')
norm1 res is  tensor(511.8238, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.38535603880882263
distance x is tensor(125.8392, device='cuda:3')
benign distance is  tensor(125.8392, device='cuda:3')
norm1 res is  tensor(540.9392, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6100579500198364
distance x is tensor(115.6783, device='cuda:3')
benign distance is  tensor(115.6783, device='cuda:3')
norm1 res is  tensor(504.4264, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7554425597190857
distance x is tensor(117.5602, device='cuda:3')
benign distance is  tensor(117.5602, device='cuda:3')
norm1 res is  tensor(500.2546, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.43591928482055664
distance x is tensor(109.4632, device='cuda:3')
benign distance is  tensor(109.4632, device='cuda:3')
norm1 res is  tensor(491.7794, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(112.4385, device='cuda:3')
compute distance is  tensor(112.4385, device='cuda:3')
compute norm is  tensor(49.9605, device='cuda:3', dtype=torch.float64)
distance x is tensor(94.0586, device='cuda:3')
compute distance is  tensor(94.0586, device='cuda:3')
compute norm is  tensor(49.7898, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.5286, device='cuda:3')
compute distance is  tensor(102.5286, device='cuda:3')
compute norm is  tensor(49.9364, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.9340, device='cuda:3')
compute distance is  tensor(110.9340, device='cuda:3')
compute norm is  tensor(50.0733, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.1453, device='cuda:3')
compute distance is  tensor(101.1453, device='cuda:3')
compute norm is  tensor(49.8197, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.0906, device='cuda:3')
compute distance is  tensor(98.0906, device='cuda:3')
compute norm is  tensor(49.8911, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.8043, device='cuda:3')
compute distance is  tensor(101.8043, device='cuda:3')
compute norm is  tensor(49.9376, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.1022, device='cuda:3')
compute distance is  tensor(114.1022, device='cuda:3')
compute norm is  tensor(50.1107, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.8915, device='cuda:3')
compute distance is  tensor(106.8915, device='cuda:3')
compute norm is  tensor(50.0775, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.7601, device='cuda:3')
compute distance is  tensor(99.7601, device='cuda:3')
compute norm is  tensor(49.8722, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.6512, device='cuda:3')
compute distance is  tensor(120.6512, device='cuda:3')
compute norm is  tensor(50.1252, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.0461, device='cuda:3')
compute distance is  tensor(111.0461, device='cuda:3')
compute norm is  tensor(50.0656, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(120.6512, device='cuda:3')
distance x is tensor(106222.4766, device='cuda:3')
distance x is tensor(106222.4766, device='cuda:3')
________________________________
test distance is  tensor(106222.4766, device='cuda:3')
test distance1 is  tensor(106222.4766, device='cuda:3')
test similarity is  tensor(-0.0994, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139286923812008.12
test entropy is  0.0
________________________________
cal ratio is  0.03302810255881598
distance x is tensor(3508.3323, device='cuda:3')
cal_distance is  tensor(3508.3323, device='cuda:3')
cal ratio is  0.18173621284008842
distance x is tensor(637.5951, device='cuda:3')
cal_distance is  tensor(637.5951, device='cuda:3')
cal ratio is  0.4263039312406122
distance x is tensor(271.8122, device='cuda:3')
cal_distance is  tensor(271.8122, device='cuda:3')
cal ratio is  0.6529160711869586
distance x is tensor(177.4723, device='cuda:3')
cal_distance is  tensor(177.4723, device='cuda:3')
cal ratio is  0.8080282911361633
distance x is tensor(143.4036, device='cuda:3')
cal_distance is  tensor(143.4036, device='cuda:3')
cal ratio is  0.8989008992627843
distance x is tensor(128.9061, device='cuda:3')
cal_distance is  tensor(128.9061, device='cuda:3')
cal ratio is  0.948101913495462
distance x is tensor(122.2164, device='cuda:3')
cal_distance is  tensor(122.2164, device='cuda:3')
cal ratio is  0.9737041952429482
distance x is tensor(119.0028, device='cuda:3')
cal_distance is  tensor(119.0028, device='cuda:3')
distance x is tensor(119.0028, device='cuda:3')
return_distance is  tensor(119.0028, device='cuda:3')
distance x is tensor(118.9928, device='cuda:3')
distance x is tensor(118.9928, device='cuda:3')
________________________________
test distance is  tensor(118.9928, device='cuda:3')
test distance1 is  tensor(118.9928, device='cuda:3')
test similarity is  tensor(0.9618, device='cuda:3')
test acc is  0.10000000015633198
test loss is 272.047460023274
test entropy is  2.589250824031567e-32
________________________________
0
distance x is tensor(118.9928, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  4.4488359710057187e-32
avg test loss is  271.9348518680662
avg accuracy is  0.391500000156341
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9618, device='cuda:3')
compute_distance is  tensor(118.9928, device='cuda:3')
compute_norm is  tensor(49.0476, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(107.4225, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8471141052779867
avg test loss is  1.3455820561472032
avg accuracy is  0.8665166668229893
solo acc is  0.3319833334896734
compute similarity  is  tensor(0.9651, device='cuda:3')
compute_distance is  tensor(107.4225, device='cuda:3')
compute_norm is  tensor(47.7837, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(110.3383, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7865644437926156
avg test loss is  1.4307066372462682
avg accuracy is  0.8670500001563225
solo acc is  0.24815000015633817
compute similarity  is  tensor(0.9644, device='cuda:3')
compute_distance is  tensor(110.3383, device='cuda:3')
compute_norm is  tensor(47.4737, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(112.7613, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7867318234845265
avg test loss is  1.3860264441478989
avg accuracy is  0.8688833334896559
solo acc is  0.24005000015633793
compute similarity  is  tensor(0.9639, device='cuda:3')
compute_distance is  tensor(112.7613, device='cuda:3')
compute_norm is  tensor(47.1911, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.0088, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7831192873815483
avg test loss is  1.3490001622801904
avg accuracy is  0.8710166668229891
solo acc is  0.23670000015633783
compute similarity  is  tensor(0.9634, device='cuda:3')
compute_distance is  tensor(115.0088, device='cuda:3')
compute_norm is  tensor(46.9253, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.1674, device='cuda:3')
distance x is tensor(117.1674, device='cuda:3')
________________________________
test distance is  tensor(117.1674, device='cuda:3')
test distance1 is  tensor(117.1674, device='cuda:3')
test similarity is  tensor(0.9630, device='cuda:3')
test acc is  0.23698333348967107
test loss is 1.3195554470456738
test entropy is  0.7852001677571075
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.3092234134674072
mal norm is  tensor(590.0807, device='cuda:3')
distance x is tensor(117.1740, device='cuda:3')
mal distance is  tensor(117.1740, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 20.12% 

Test Accuracy: 19.13% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7841573357582092
distance x is tensor(150.3480, device='cuda:3')
benign distance is  tensor(150.3480, device='cuda:3')
norm1 res is  tensor(597.4020, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3853187561035156
distance x is tensor(168.1213, device='cuda:3')
benign distance is  tensor(168.1213, device='cuda:3')
norm1 res is  tensor(658.4985, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.14992234110832214
distance x is tensor(167.5123, device='cuda:3')
benign distance is  tensor(167.5123, device='cuda:3')
norm1 res is  tensor(649.1038, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9027724266052246
distance x is tensor(147.0060, device='cuda:3')
benign distance is  tensor(147.0060, device='cuda:3')
norm1 res is  tensor(572.9584, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6296578645706177
distance x is tensor(142.0856, device='cuda:3')
benign distance is  tensor(142.0856, device='cuda:3')
norm1 res is  tensor(552.8239, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9924976229667664
distance x is tensor(158.5899, device='cuda:3')
benign distance is  tensor(158.5899, device='cuda:3')
norm1 res is  tensor(621.2147, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9424541592597961
distance x is tensor(149.9286, device='cuda:3')
benign distance is  tensor(149.9286, device='cuda:3')
norm1 res is  tensor(585.7396, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4363851547241211
distance x is tensor(165.5458, device='cuda:3')
benign distance is  tensor(165.5458, device='cuda:3')
norm1 res is  tensor(643.4109, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(153.3761, device='cuda:3')
compute distance is  tensor(153.3761, device='cuda:3')
compute norm is  tensor(48.4665, device='cuda:3', dtype=torch.float64)
distance x is tensor(166.6112, device='cuda:3')
compute distance is  tensor(166.6112, device='cuda:3')
compute norm is  tensor(48.7888, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.6070, device='cuda:3')
compute distance is  tensor(152.6070, device='cuda:3')
compute norm is  tensor(48.7124, device='cuda:3', dtype=torch.float64)
distance x is tensor(163.5087, device='cuda:3')
compute distance is  tensor(163.5087, device='cuda:3')
compute norm is  tensor(48.7960, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.9465, device='cuda:3')
compute distance is  tensor(159.9465, device='cuda:3')
compute norm is  tensor(48.7001, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.3007, device='cuda:3')
compute distance is  tensor(157.3007, device='cuda:3')
compute norm is  tensor(48.9084, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.2095, device='cuda:3')
compute distance is  tensor(153.2095, device='cuda:3')
compute norm is  tensor(48.4540, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.1263, device='cuda:3')
compute distance is  tensor(146.1263, device='cuda:3')
compute norm is  tensor(48.6118, device='cuda:3', dtype=torch.float64)
distance x is tensor(163.0748, device='cuda:3')
compute distance is  tensor(163.0748, device='cuda:3')
compute norm is  tensor(48.6939, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.5831, device='cuda:3')
compute distance is  tensor(158.5831, device='cuda:3')
compute norm is  tensor(48.6854, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.4691, device='cuda:3')
compute distance is  tensor(151.4691, device='cuda:3')
compute norm is  tensor(48.5412, device='cuda:3', dtype=torch.float64)
distance x is tensor(163.9161, device='cuda:3')
compute distance is  tensor(163.9161, device='cuda:3')
compute norm is  tensor(48.7369, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(166.6112, device='cuda:3')
distance x is tensor(106154.3672, device='cuda:3')
distance x is tensor(106154.3672, device='cuda:3')
________________________________
test distance is  tensor(106154.3672, device='cuda:3')
test distance1 is  tensor(106154.3672, device='cuda:3')
test similarity is  tensor(0.1302, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139277803382919.38
test entropy is  0.0
________________________________
cal ratio is  0.0388248057147133
distance x is tensor(4121.4277, device='cuda:3')
cal_distance is  tensor(4121.4277, device='cuda:3')
cal ratio is  0.19703998489968635
distance x is tensor(812.0901, device='cuda:3')
cal_distance is  tensor(812.0901, device='cuda:3')
cal ratio is  0.4438907741774787
distance x is tensor(360.4821, device='cuda:3')
cal_distance is  tensor(360.4821, device='cuda:3')
cal ratio is  0.6662487038336736
distance x is tensor(240.1724, device='cuda:3')
cal_distance is  tensor(240.1724, device='cuda:3')
cal ratio is  0.816237731902739
distance x is tensor(196.0387, device='cuda:3')
cal_distance is  tensor(196.0387, device='cuda:3')
cal ratio is  0.9034566036726158
distance x is tensor(177.1130, device='cuda:3')
cal_distance is  tensor(177.1130, device='cuda:3')
cal ratio is  0.9505020324533797
distance x is tensor(168.3465, device='cuda:3')
cal_distance is  tensor(168.3465, device='cuda:3')
cal ratio is  0.9749362176915688
distance x is tensor(164.1272, device='cuda:3')
cal_distance is  tensor(164.1272, device='cuda:3')
distance x is tensor(164.1272, device='cuda:3')
return_distance is  tensor(164.1272, device='cuda:3')
distance x is tensor(164.1172, device='cuda:3')
distance x is tensor(164.1172, device='cuda:3')
________________________________
test distance is  tensor(164.1172, device='cuda:3')
test distance1 is  tensor(164.1172, device='cuda:3')
test similarity is  tensor(0.9358, device='cuda:3')
test acc is  0.10000000015633198
test loss is 950.5191241103703
test entropy is  0.0
________________________________
0
distance x is tensor(164.1172, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  950.7414479855536
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9358, device='cuda:3')
compute_distance is  tensor(164.1172, device='cuda:3')
compute_norm is  tensor(50.1345, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(338.1131, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5586993648553453
avg test loss is  2.8524532968809866
avg accuracy is  0.11648333348966529
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6970, device='cuda:3')
compute_distance is  tensor(338.1131, device='cuda:3')
compute_norm is  tensor(68.1917, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(337.6021, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8373065820253734
avg test loss is  3.5839706369554563
avg accuracy is  0.11388333348966528
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6968, device='cuda:3')
compute_distance is  tensor(337.6021, device='cuda:3')
compute_norm is  tensor(68.2460, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(336.1997, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5535744360006694
avg test loss is  2.852144000881008
avg accuracy is  0.11621666682299862
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6969, device='cuda:3')
compute_distance is  tensor(336.1997, device='cuda:3')
compute_norm is  tensor(67.5667, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(335.8125, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8373783770908934
avg test loss is  3.5806033885809403
avg accuracy is  0.11320000015633196
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6967, device='cuda:3')
compute_distance is  tensor(335.8125, device='cuda:3')
compute_norm is  tensor(67.6256, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(334.5019, device='cuda:3')
distance x is tensor(334.5019, device='cuda:3')
________________________________
test distance is  tensor(334.5019, device='cuda:3')
test distance1 is  tensor(334.5019, device='cuda:3')
test similarity is  tensor(0.6969, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8519686803634743
test entropy is  1.55343746617913
________________________________
cal ratio is  0.6916380985480589
distance x is tensor(231.3574, device='cuda:3')
cal_distance is  tensor(231.3574, device='cuda:3')
cal ratio is  0.831642156654191
distance x is tensor(192.4069, device='cuda:3')
cal_distance is  tensor(192.4069, device='cuda:3')
cal ratio is  0.9119433850745632
distance x is tensor(175.4644, device='cuda:3')
cal_distance is  tensor(175.4644, device='cuda:3')
cal ratio is  0.954956819758937
distance x is tensor(167.5610, device='cuda:3')
cal_distance is  tensor(167.5610, device='cuda:3')
cal ratio is  0.977218653100268
distance x is tensor(163.7438, device='cuda:3')
cal_distance is  tensor(163.7438, device='cuda:3')
distance x is tensor(163.7438, device='cuda:3')
return_distance is  tensor(163.7438, device='cuda:3')
distance x is tensor(163.7400, device='cuda:3')
distance x is tensor(163.7400, device='cuda:3')
________________________________
test distance is  tensor(163.7400, device='cuda:3')
test distance1 is  tensor(163.7400, device='cuda:3')
test similarity is  tensor(0.8900, device='cuda:3')
test acc is  0.11730000015633193
test loss is 7.087888494991799
test entropy is  0.9826524971263495
________________________________
0
distance x is tensor(163.7400, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.9818248809781919
avg test loss is  7.102743066450172
avg accuracy is  0.22676666682300411
solo acc is  0.11845000015633193
compute similarity  is  tensor(0.8900, device='cuda:3')
compute_distance is  tensor(163.7400, device='cuda:3')
compute_norm is  tensor(53.5364, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(175.3742, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0584170336026881
avg test loss is  1.7200328436995875
avg accuracy is  0.1732666668230015
solo acc is  0.18510000015633557
compute similarity  is  tensor(0.8881, device='cuda:3')
compute_distance is  tensor(175.3742, device='cuda:3')
compute_norm is  tensor(53.5683, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(176.1305, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6097845826576005
avg test loss is  2.4221774462952035
avg accuracy is  0.12691666682299857
solo acc is  0.1020833334896653
compute similarity  is  tensor(0.8878, device='cuda:3')
compute_distance is  tensor(176.1305, device='cuda:3')
compute_norm is  tensor(53.3889, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(177.7253, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9336526193090086
avg test loss is  1.49689329166148
avg accuracy is  0.15251666682300005
solo acc is  0.2103166668230035
compute similarity  is  tensor(0.8876, device='cuda:3')
compute_distance is  tensor(177.7253, device='cuda:3')
compute_norm is  tensor(53.1088, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(177.7253, device='cuda:3')
distance x is tensor(177.7253, device='cuda:3')
________________________________
test distance is  tensor(177.7253, device='cuda:3')
test distance1 is  tensor(177.7253, device='cuda:3')
test similarity is  tensor(0.8876, device='cuda:3')
test acc is  0.21063333348967017
test loss is 1.4965639317721955
test entropy is  0.9332371699784611
________________________________
cal ratio is  0.9488630624984309
distance x is tensor(168.6395, device='cuda:3')
cal_distance is  tensor(168.6395, device='cuda:3')
cal ratio is  0.9740888425822056
distance x is tensor(164.2699, device='cuda:3')
cal_distance is  tensor(164.2699, device='cuda:3')
distance x is tensor(164.2699, device='cuda:3')
return_distance is  tensor(164.2699, device='cuda:3')
distance x is tensor(164.2673, device='cuda:3')
distance x is tensor(164.2673, device='cuda:3')
________________________________
test distance is  tensor(164.2673, device='cuda:3')
test distance1 is  tensor(164.2673, device='cuda:3')
test similarity is  tensor(0.9016, device='cuda:3')
test acc is  0.1539333334896668
test loss is 1.6368291290329973
test entropy is  0.91018018520463
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 1.5809838771820068
mal norm is  tensor(1009.3104, device='cuda:3')
distance x is tensor(164.2699, device='cuda:3')
mal distance is  tensor(164.2699, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([12., 12.,  0., 12., 19., 17., 12., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 12., 32., 12., 35., 12., 12., 32., 34.,
        35., 12., 35., 12., 35., 15., 12., 12.])
count_res tensor([2.2969e-11, 2.2969e-11, 1.4113e-16, 2.2969e-11, 2.5189e-08, 3.4089e-09,
        2.2969e-11, 2.2969e-11, 3.7384e-06, 3.7384e-06, 3.7384e-06, 3.7384e-06,
        3.7384e-06, 3.7384e-06, 3.7384e-06, 3.7384e-06, 3.7384e-06, 3.7384e-06,
        3.7384e-06, 3.7384e-06, 2.2969e-11, 1.1144e-02, 2.2969e-11, 2.2383e-01,
        2.2969e-11, 2.2969e-11, 1.1144e-02, 8.2343e-02, 2.2383e-01, 2.2969e-11,
        2.2383e-01, 2.2969e-11, 2.2383e-01, 4.6135e-10, 2.2969e-11, 2.2969e-11])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 90.01% 

Test Accuracy: 89.11% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7218741774559021
distance x is tensor(96.3897, device='cuda:3')
benign distance is  tensor(96.3897, device='cuda:3')
norm1 res is  tensor(424.8333, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7335638403892517
distance x is tensor(109.7618, device='cuda:3')
benign distance is  tensor(109.7618, device='cuda:3')
norm1 res is  tensor(490.6130, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.12110515683889389
distance x is tensor(109.6414, device='cuda:3')
benign distance is  tensor(109.6414, device='cuda:3')
norm1 res is  tensor(474.6562, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.586708128452301
distance x is tensor(88.7999, device='cuda:3')
benign distance is  tensor(88.7999, device='cuda:3')
norm1 res is  tensor(379.0091, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7509406805038452
distance x is tensor(96.0182, device='cuda:3')
benign distance is  tensor(96.0182, device='cuda:3')
norm1 res is  tensor(408.8141, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6893528699874878
distance x is tensor(110.1850, device='cuda:3')
benign distance is  tensor(110.1850, device='cuda:3')
norm1 res is  tensor(492.2255, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5393850803375244
distance x is tensor(104.8149, device='cuda:3')
benign distance is  tensor(104.8149, device='cuda:3')
norm1 res is  tensor(452.6216, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6256967186927795
distance x is tensor(87.9996, device='cuda:3')
benign distance is  tensor(87.9996, device='cuda:3')
norm1 res is  tensor(397.9678, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.26979929208755493
distance x is tensor(109.6496, device='cuda:3')
benign distance is  tensor(109.6496, device='cuda:3')
norm1 res is  tensor(477.8227, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9016685485839844
distance x is tensor(114.1196, device='cuda:3')
benign distance is  tensor(114.1196, device='cuda:3')
norm1 res is  tensor(494.4315, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2411293983459473
distance x is tensor(84.0930, device='cuda:3')
benign distance is  tensor(84.0930, device='cuda:3')
norm1 res is  tensor(362.3313, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6599348783493042
distance x is tensor(108.9601, device='cuda:3')
benign distance is  tensor(108.9601, device='cuda:3')
norm1 res is  tensor(483.8848, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4954577088356018
distance x is tensor(93.6166, device='cuda:3')
benign distance is  tensor(93.6166, device='cuda:3')
norm1 res is  tensor(411.8740, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3969436287879944
distance x is tensor(99.1588, device='cuda:3')
benign distance is  tensor(99.1588, device='cuda:3')
norm1 res is  tensor(442.1481, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.701647937297821
distance x is tensor(119.0872, device='cuda:3')
benign distance is  tensor(119.0872, device='cuda:3')
norm1 res is  tensor(521.4929, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0739939212799072
distance x is tensor(106.8044, device='cuda:3')
benign distance is  tensor(106.8044, device='cuda:3')
norm1 res is  tensor(457.2132, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.085126593708992
distance x is tensor(122.0258, device='cuda:3')
benign distance is  tensor(122.0258, device='cuda:3')
norm1 res is  tensor(542.6603, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6680294275283813
distance x is tensor(103.6484, device='cuda:3')
benign distance is  tensor(103.6484, device='cuda:3')
norm1 res is  tensor(448.6911, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.6660270094871521
distance x is tensor(110.0098, device='cuda:3')
benign distance is  tensor(110.0098, device='cuda:3')
norm1 res is  tensor(485.6038, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.13053472340106964
distance x is tensor(116.0161, device='cuda:3')
benign distance is  tensor(116.0161, device='cuda:3')
norm1 res is  tensor(501.4273, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8303958773612976
distance x is tensor(112.3479, device='cuda:3')
benign distance is  tensor(112.3479, device='cuda:3')
norm1 res is  tensor(489.7788, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5246345400810242
distance x is tensor(116.0146, device='cuda:3')
benign distance is  tensor(116.0146, device='cuda:3')
norm1 res is  tensor(519.3348, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.22975483536720276
distance x is tensor(117.6337, device='cuda:3')
benign distance is  tensor(117.6337, device='cuda:3')
norm1 res is  tensor(517.3422, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.2576139569282532
distance x is tensor(108.9484, device='cuda:3')
benign distance is  tensor(108.9484, device='cuda:3')
norm1 res is  tensor(488.3781, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(112.2772, device='cuda:3')
compute distance is  tensor(112.2772, device='cuda:3')
compute norm is  tensor(50.4606, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.4524, device='cuda:3')
compute distance is  tensor(101.4524, device='cuda:3')
compute norm is  tensor(50.2391, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.0169, device='cuda:3')
compute distance is  tensor(101.0169, device='cuda:3')
compute norm is  tensor(50.3565, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.8590, device='cuda:3')
compute distance is  tensor(113.8590, device='cuda:3')
compute norm is  tensor(50.4095, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.6699, device='cuda:3')
compute distance is  tensor(110.6699, device='cuda:3')
compute norm is  tensor(50.4389, device='cuda:3', dtype=torch.float64)
distance x is tensor(96.9632, device='cuda:3')
compute distance is  tensor(96.9632, device='cuda:3')
compute norm is  tensor(50.2597, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.8931, device='cuda:3')
compute distance is  tensor(108.8931, device='cuda:3')
compute norm is  tensor(50.4361, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.5371, device='cuda:3')
compute distance is  tensor(118.5371, device='cuda:3')
compute norm is  tensor(50.6891, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.0705, device='cuda:3')
compute distance is  tensor(110.0705, device='cuda:3')
compute norm is  tensor(50.4855, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.8571, device='cuda:3')
compute distance is  tensor(98.8571, device='cuda:3')
compute norm is  tensor(50.3203, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.8407, device='cuda:3')
compute distance is  tensor(116.8407, device='cuda:3')
compute norm is  tensor(50.5771, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.7744, device='cuda:3')
compute distance is  tensor(99.7744, device='cuda:3')
compute norm is  tensor(50.2424, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(118.5371, device='cuda:3')
distance x is tensor(106225.1719, device='cuda:3')
distance x is tensor(106225.1719, device='cuda:3')
________________________________
test distance is  tensor(106225.1719, device='cuda:3')
test distance1 is  tensor(106225.1719, device='cuda:3')
test similarity is  tensor(-0.1012, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139303976287033.31
test entropy is  0.0
________________________________
cal ratio is  0.03273705422227354
distance x is tensor(3477.5046, device='cuda:3')
cal_distance is  tensor(3477.5046, device='cuda:3')
cal ratio is  0.18093369819669228
distance x is tensor(629.2018, device='cuda:3')
cal_distance is  tensor(629.2018, device='cuda:3')
cal ratio is  0.4253616507604942
distance x is tensor(267.6412, device='cuda:3')
cal_distance is  tensor(267.6412, device='cuda:3')
cal ratio is  0.6521940424106144
distance x is tensor(174.5557, device='cuda:3')
cal_distance is  tensor(174.5557, device='cuda:3')
cal ratio is  0.8075812808485607
distance x is tensor(140.9690, device='cuda:3')
cal_distance is  tensor(140.9690, device='cuda:3')
cal ratio is  0.8986520252491281
distance x is tensor(126.6825, device='cuda:3')
cal_distance is  tensor(126.6825, device='cuda:3')
cal ratio is  0.9479707336656532
distance x is tensor(120.0916, device='cuda:3')
cal_distance is  tensor(120.0916, device='cuda:3')
cal ratio is  0.9736368192997772
distance x is tensor(116.9258, device='cuda:3')
cal_distance is  tensor(116.9258, device='cuda:3')
distance x is tensor(116.9258, device='cuda:3')
return_distance is  tensor(116.9258, device='cuda:3')
distance x is tensor(116.9158, device='cuda:3')
distance x is tensor(116.9158, device='cuda:3')
________________________________
test distance is  tensor(116.9158, device='cuda:3')
test distance1 is  tensor(116.9158, device='cuda:3')
test similarity is  tensor(0.9637, device='cuda:3')
test acc is  0.10000000015633198
test loss is 231.52948975715555
test entropy is  1.7979603995719146e-27
________________________________
0
distance x is tensor(116.9158, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  7.442970072335872e-28
avg test loss is  231.6114698462903
avg accuracy is  0.5664833334896737
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9637, device='cuda:3')
compute_distance is  tensor(116.9158, device='cuda:3')
compute_norm is  tensor(49.4099, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(106.6376, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.777301347967404
avg test loss is  1.4874646842860972
avg accuracy is  0.8681166668229892
solo acc is  0.2680500001563388
compute similarity  is  tensor(0.9665, device='cuda:3')
compute_distance is  tensor(106.6376, device='cuda:3')
compute_norm is  tensor(48.2145, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(109.3878, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7845229577026895
avg test loss is  1.4292111274784307
avg accuracy is  0.8703833334896557
solo acc is  0.2455666668230047
compute similarity  is  tensor(0.9658, device='cuda:3')
compute_distance is  tensor(109.3878, device='cuda:3')
compute_norm is  tensor(47.9035, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(111.7944, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7711655917579431
avg test loss is  1.407838819377712
avg accuracy is  0.8717666668229891
solo acc is  0.22855000015633753
compute similarity  is  tensor(0.9653, device='cuda:3')
compute_distance is  tensor(111.7944, device='cuda:3')
compute_norm is  tensor(47.6202, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(114.0302, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7768802403259888
avg test loss is  1.3560592114035763
avg accuracy is  0.8742500001563223
solo acc is  0.23366666682300438
compute similarity  is  tensor(0.9649, device='cuda:3')
compute_distance is  tensor(114.0302, device='cuda:3')
compute_norm is  tensor(47.3487, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(116.1531, device='cuda:3')
distance x is tensor(116.1531, device='cuda:3')
________________________________
test distance is  tensor(116.1531, device='cuda:3')
test distance1 is  tensor(116.1531, device='cuda:3')
test similarity is  tensor(0.9645, device='cuda:3')
test acc is  0.22293333348967057
test loss is 1.350992160184043
test entropy is  0.7643577702391122
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 1.2230948209762573
mal norm is  tensor(583.1187, device='cuda:3')
distance x is tensor(116.1597, device='cuda:3')
mal distance is  tensor(116.1597, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([12., 22., 12., 23., 21., 13., 14., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 13., 12., 12., 15., 15., 15., 16., 13.])
count_res tensor([1.1014e-05, 2.4260e-01, 1.1014e-05, 6.5945e-01, 8.9247e-02, 2.9939e-05,
        8.1382e-05, 1.1014e-05, 6.0134e-04, 6.0134e-04, 6.0134e-04, 6.0134e-04,
        6.0134e-04, 6.0134e-04, 6.0134e-04, 6.0134e-04, 6.0134e-04, 6.0134e-04,
        6.0134e-04, 6.0134e-04, 2.9939e-05, 1.1014e-05, 1.1014e-05, 2.2122e-04,
        2.2122e-04, 2.2122e-04, 6.0134e-04, 2.9939e-05])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 89.47% 

Test Accuracy: 88.31% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.40045079588890076
distance x is tensor(105.5277, device='cuda:3')
benign distance is  tensor(105.5277, device='cuda:3')
norm1 res is  tensor(463.0352, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2312424182891846
distance x is tensor(107.0900, device='cuda:3')
benign distance is  tensor(107.0900, device='cuda:3')
norm1 res is  tensor(467.3818, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.24273784458637238
distance x is tensor(120.7085, device='cuda:3')
benign distance is  tensor(120.7085, device='cuda:3')
norm1 res is  tensor(516.8794, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8627780675888062
distance x is tensor(54.4807, device='cuda:3')
benign distance is  tensor(54.4807, device='cuda:3')
norm1 res is  tensor(227.2060, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.46578389406204224
distance x is tensor(101.8632, device='cuda:3')
benign distance is  tensor(101.8632, device='cuda:3')
norm1 res is  tensor(428.4261, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6790729761123657
distance x is tensor(132.8554, device='cuda:3')
benign distance is  tensor(132.8554, device='cuda:3')
norm1 res is  tensor(574.6326, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5032888650894165
distance x is tensor(111.3990, device='cuda:3')
benign distance is  tensor(111.3990, device='cuda:3')
norm1 res is  tensor(475.6116, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3728351891040802
distance x is tensor(104.2582, device='cuda:3')
benign distance is  tensor(104.2582, device='cuda:3')
norm1 res is  tensor(460.9976, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.8590177297592163
distance x is tensor(118.5821, device='cuda:3')
benign distance is  tensor(118.5821, device='cuda:3')
norm1 res is  tensor(522.3911, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.1056572198867798
distance x is tensor(125.1882, device='cuda:3')
benign distance is  tensor(125.1882, device='cuda:3')
norm1 res is  tensor(549.7389, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.35551556944847107
distance x is tensor(105.0875, device='cuda:3')
benign distance is  tensor(105.0875, device='cuda:3')
norm1 res is  tensor(449.0053, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.5404266119003296
distance x is tensor(106.7493, device='cuda:3')
benign distance is  tensor(106.7493, device='cuda:3')
norm1 res is  tensor(463.4032, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4200698733329773
distance x is tensor(129.6444, device='cuda:3')
benign distance is  tensor(129.6444, device='cuda:3')
norm1 res is  tensor(548.6981, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9492164850234985
distance x is tensor(107.2473, device='cuda:3')
benign distance is  tensor(107.2473, device='cuda:3')
norm1 res is  tensor(463.6121, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.23335886001586914
distance x is tensor(106.7175, device='cuda:3')
benign distance is  tensor(106.7175, device='cuda:3')
norm1 res is  tensor(466.2990, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5395968556404114
distance x is tensor(118.4618, device='cuda:3')
benign distance is  tensor(118.4618, device='cuda:3')
norm1 res is  tensor(503.1642, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(115.0462, device='cuda:3')
compute distance is  tensor(115.0462, device='cuda:3')
compute norm is  tensor(50.8596, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.3415, device='cuda:3')
compute distance is  tensor(114.3415, device='cuda:3')
compute norm is  tensor(50.9270, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.1909, device='cuda:3')
compute distance is  tensor(134.1909, device='cuda:3')
compute norm is  tensor(51.3629, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.3168, device='cuda:3')
compute distance is  tensor(109.3168, device='cuda:3')
compute norm is  tensor(50.9185, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.1519, device='cuda:3')
compute distance is  tensor(116.1519, device='cuda:3')
compute norm is  tensor(50.8630, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.6134, device='cuda:3')
compute distance is  tensor(125.6134, device='cuda:3')
compute norm is  tensor(51.2129, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.8941, device='cuda:3')
compute distance is  tensor(116.8941, device='cuda:3')
compute norm is  tensor(51.0325, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.9657, device='cuda:3')
compute distance is  tensor(116.9657, device='cuda:3')
compute norm is  tensor(50.9506, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.2305, device='cuda:3')
compute distance is  tensor(128.2305, device='cuda:3')
compute norm is  tensor(51.1805, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.5797, device='cuda:3')
compute distance is  tensor(105.5797, device='cuda:3')
compute norm is  tensor(50.7360, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.8459, device='cuda:3')
compute distance is  tensor(115.8459, device='cuda:3')
compute norm is  tensor(50.9999, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.2267, device='cuda:3')
compute distance is  tensor(112.2267, device='cuda:3')
compute norm is  tensor(50.9233, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(134.1909, device='cuda:3')
distance x is tensor(106225.6172, device='cuda:3')
distance x is tensor(106225.6172, device='cuda:3')
________________________________
test distance is  tensor(106225.6172, device='cuda:3')
test distance1 is  tensor(106225.6172, device='cuda:3')
test similarity is  tensor(-0.0952, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139290885926850.86
test entropy is  0.0
________________________________
cal ratio is  0.03483155897940534
distance x is tensor(3700.0093, device='cuda:3')
cal_distance is  tensor(3700.0093, device='cuda:3')
cal ratio is  0.1866320114854697
distance x is tensor(690.5441, device='cuda:3')
cal_distance is  tensor(690.5441, device='cuda:3')
cal ratio is  0.432008023277477
distance x is tensor(298.3235, device='cuda:3')
cal_distance is  tensor(298.3235, device='cuda:3')
cal ratio is  0.6572700396958232
distance x is tensor(196.0808, device='cuda:3')
cal_distance is  tensor(196.0808, device='cuda:3')
cal ratio is  0.8107183456646334
distance x is tensor(158.9672, device='cuda:3')
cal_distance is  tensor(158.9672, device='cuda:3')
cal ratio is  0.9003963544220588
distance x is tensor(143.1340, device='cuda:3')
cal_distance is  tensor(143.1340, device='cuda:3')
cal ratio is  0.9488904817961697
distance x is tensor(135.8188, device='cuda:3')
cal_distance is  tensor(135.8188, device='cuda:3')
cal ratio is  0.9741091463768436
distance x is tensor(132.3025, device='cuda:3')
cal_distance is  tensor(132.3025, device='cuda:3')
distance x is tensor(132.3025, device='cuda:3')
return_distance is  tensor(132.3025, device='cuda:3')
distance x is tensor(132.2925, device='cuda:3')
distance x is tensor(132.2925, device='cuda:3')
________________________________
test distance is  tensor(132.2925, device='cuda:3')
test distance1 is  tensor(132.2925, device='cuda:3')
test similarity is  tensor(0.9551, device='cuda:3')
test acc is  0.10000000015633198
test loss is 394.28344423989495
test entropy is  1.8987410439244008e-41
________________________________
0
distance x is tensor(132.2925, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3648499144284945e-41
avg test loss is  394.132234195148
avg accuracy is  0.25345000015633834
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9551, device='cuda:3')
compute_distance is  tensor(132.2925, device='cuda:3')
compute_norm is  tensor(50.2035, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(117.6797, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7913740448224773
avg test loss is  1.4699053456788378
avg accuracy is  0.8549333334896564
solo acc is  0.2795500001563391
compute similarity  is  tensor(0.9594, device='cuda:3')
compute_distance is  tensor(117.6797, device='cuda:3')
compute_norm is  tensor(48.9783, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(120.4727, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7710612695862744
avg test loss is  1.4755513247396392
avg accuracy is  0.856500000156323
solo acc is  0.2338833334896711
compute similarity  is  tensor(0.9588, device='cuda:3')
compute_distance is  tensor(120.4727, device='cuda:3')
compute_norm is  tensor(48.6614, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(122.9356, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7695079610418918
avg test loss is  1.4260073705776921
avg accuracy is  0.858400000156323
solo acc is  0.2295166668230042
compute similarity  is  tensor(0.9582, device='cuda:3')
compute_distance is  tensor(122.9356, device='cuda:3')
compute_norm is  tensor(48.3717, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(125.2041, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7832280253804823
avg test loss is  1.3633031899740955
avg accuracy is  0.8603666668229896
solo acc is  0.23543333348967102
compute similarity  is  tensor(0.9578, device='cuda:3')
compute_distance is  tensor(125.2041, device='cuda:3')
compute_norm is  tensor(48.0979, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(127.3595, device='cuda:3')
distance x is tensor(127.3595, device='cuda:3')
________________________________
test distance is  tensor(127.3595, device='cuda:3')
test distance1 is  tensor(127.3595, device='cuda:3')
test similarity is  tensor(0.9574, device='cuda:3')
test acc is  0.23201666682300431
test loss is 1.3359761358197055
test entropy is  0.7832605330420456
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 1.2831405401229858
mal norm is  tensor(645.9397, device='cuda:3')
distance x is tensor(127.3664, device='cuda:3')
mal distance is  tensor(127.3664, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 26., 27., 25., 13., 18., 12., 12.])
count_res tensor([2.0345e-07, 2.0345e-07, 2.0345e-07, 2.0345e-07, 2.0345e-07, 2.0345e-07,
        2.0345e-07, 2.0345e-07, 1.1108e-05, 1.1108e-05, 1.1108e-05, 1.1108e-05,
        1.1108e-05, 1.1108e-05, 1.1108e-05, 1.1108e-05, 1.1108e-05, 1.1108e-05,
        1.1108e-05, 1.1108e-05, 2.0345e-07, 2.4468e-01, 6.6510e-01, 9.0011e-02,
        5.5305e-07, 8.2079e-05, 2.0345e-07, 2.0345e-07])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 89.28% 

Test Accuracy: 88.57% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2950533628463745
distance x is tensor(109.0589, device='cuda:3')
benign distance is  tensor(109.0589, device='cuda:3')
norm1 res is  tensor(473.7585, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6949566006660461
distance x is tensor(121.8361, device='cuda:3')
benign distance is  tensor(121.8361, device='cuda:3')
norm1 res is  tensor(519.8085, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.38568973541259766
distance x is tensor(124.3731, device='cuda:3')
benign distance is  tensor(124.3731, device='cuda:3')
norm1 res is  tensor(541.2659, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9046489000320435
distance x is tensor(111.1260, device='cuda:3')
benign distance is  tensor(111.1260, device='cuda:3')
norm1 res is  tensor(477.4991, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8292771577835083
distance x is tensor(91.6603, device='cuda:3')
benign distance is  tensor(91.6603, device='cuda:3')
norm1 res is  tensor(395.2421, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8680723309516907
distance x is tensor(117.2444, device='cuda:3')
benign distance is  tensor(117.2444, device='cuda:3')
norm1 res is  tensor(509.5281, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5462223291397095
distance x is tensor(99.0446, device='cuda:3')
benign distance is  tensor(99.0446, device='cuda:3')
norm1 res is  tensor(415.5291, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.43972048163414
distance x is tensor(101.9113, device='cuda:3')
benign distance is  tensor(101.9113, device='cuda:3')
norm1 res is  tensor(453.9536, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7168075442314148
distance x is tensor(128.5716, device='cuda:3')
benign distance is  tensor(128.5716, device='cuda:3')
norm1 res is  tensor(552.8054, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5541325211524963
distance x is tensor(107.7072, device='cuda:3')
benign distance is  tensor(107.7072, device='cuda:3')
norm1 res is  tensor(463.4353, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0018337965011597
distance x is tensor(50.9468, device='cuda:3')
benign distance is  tensor(50.9468, device='cuda:3')
norm1 res is  tensor(218.7932, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9119413495063782
distance x is tensor(123.2124, device='cuda:3')
benign distance is  tensor(123.2124, device='cuda:3')
norm1 res is  tensor(532.4881, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.45875149965286255
distance x is tensor(111.1492, device='cuda:3')
benign distance is  tensor(111.1492, device='cuda:3')
norm1 res is  tensor(491.0603, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.0849061906337738
distance x is tensor(109.4918, device='cuda:3')
benign distance is  tensor(109.4918, device='cuda:3')
norm1 res is  tensor(477.3573, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6689556837081909
distance x is tensor(133.5917, device='cuda:3')
benign distance is  tensor(133.5917, device='cuda:3')
norm1 res is  tensor(568.4687, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7546718716621399
distance x is tensor(115.0306, device='cuda:3')
benign distance is  tensor(115.0306, device='cuda:3')
norm1 res is  tensor(521.5595, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(119.9761, device='cuda:3')
compute distance is  tensor(119.9761, device='cuda:3')
compute norm is  tensor(51.0128, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.8743, device='cuda:3')
compute distance is  tensor(106.8743, device='cuda:3')
compute norm is  tensor(50.8655, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.8210, device='cuda:3')
compute distance is  tensor(122.8210, device='cuda:3')
compute norm is  tensor(51.2788, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.3842, device='cuda:3')
compute distance is  tensor(123.3842, device='cuda:3')
compute norm is  tensor(51.0381, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.3121, device='cuda:3')
compute distance is  tensor(112.3121, device='cuda:3')
compute norm is  tensor(50.9702, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.8799, device='cuda:3')
compute distance is  tensor(118.8799, device='cuda:3')
compute norm is  tensor(51.1450, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.8861, device='cuda:3')
compute distance is  tensor(107.8861, device='cuda:3')
compute norm is  tensor(51.0448, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.5508, device='cuda:3')
compute distance is  tensor(129.5508, device='cuda:3')
compute norm is  tensor(51.2762, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.5807, device='cuda:3')
compute distance is  tensor(117.5807, device='cuda:3')
compute norm is  tensor(51.1017, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.9376, device='cuda:3')
compute distance is  tensor(122.9376, device='cuda:3')
compute norm is  tensor(51.1805, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.5085, device='cuda:3')
compute distance is  tensor(114.5085, device='cuda:3')
compute norm is  tensor(50.9566, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.6783, device='cuda:3')
compute distance is  tensor(120.6783, device='cuda:3')
compute norm is  tensor(51.1555, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(129.5508, device='cuda:3')
distance x is tensor(106225.7812, device='cuda:3')
distance x is tensor(106225.7812, device='cuda:3')
________________________________
test distance is  tensor(106225.7812, device='cuda:3')
test distance1 is  tensor(106225.7812, device='cuda:3')
test similarity is  tensor(-0.0974, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139290660561262.81
test entropy is  0.0
________________________________
cal ratio is  0.03422402864560078
distance x is tensor(3635.4795, device='cuda:3')
cal_distance is  tensor(3635.4795, device='cuda:3')
cal ratio is  0.1849972365308253
distance x is tensor(672.5577, device='cuda:3')
cal_distance is  tensor(672.5577, device='cuda:3')
cal ratio is  0.4301117704987669
distance x is tensor(289.2778, device='cuda:3')
cal_distance is  tensor(289.2778, device='cuda:3')
cal ratio is  0.6558258273988954
distance x is tensor(189.7176, device='cuda:3')
cal_distance is  tensor(189.7176, device='cuda:3')
cal ratio is  0.8098270480777655
distance x is tensor(153.6394, device='cuda:3')
cal_distance is  tensor(153.6394, device='cuda:3')
cal ratio is  0.8999010186337232
distance x is tensor(138.2608, device='cuda:3')
cal_distance is  tensor(138.2608, device='cuda:3')
cal ratio is  0.948629408285384
distance x is tensor(131.1585, device='cuda:3')
cal_distance is  tensor(131.1585, device='cuda:3')
cal ratio is  0.9739751217556235
distance x is tensor(127.7452, device='cuda:3')
cal_distance is  tensor(127.7452, device='cuda:3')
distance x is tensor(127.7452, device='cuda:3')
return_distance is  tensor(127.7452, device='cuda:3')
distance x is tensor(127.7353, device='cuda:3')
distance x is tensor(127.7353, device='cuda:3')
________________________________
test distance is  tensor(127.7353, device='cuda:3')
test distance1 is  tensor(127.7353, device='cuda:3')
test similarity is  tensor(0.9582, device='cuda:3')
test acc is  0.10000000015633198
test loss is 346.4902227926356
test entropy is  3.545925110756837e-41
________________________________
0
distance x is tensor(127.7353, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.809366185772405e-38
avg test loss is  346.4746658227591
avg accuracy is  0.32791666682300674
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9582, device='cuda:3')
compute_distance is  tensor(127.7353, device='cuda:3')
compute_norm is  tensor(50.1803, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(115.5844, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7307970283636406
avg test loss is  1.5919136524454618
avg accuracy is  0.852950000156323
solo acc is  0.25126666682300497
compute similarity  is  tensor(0.9618, device='cuda:3')
compute_distance is  tensor(115.5844, device='cuda:3')
compute_norm is  tensor(48.9227, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(118.4135, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7735772433438535
avg test loss is  1.461631635994291
avg accuracy is  0.8539666668229897
solo acc is  0.2454500001563381
compute similarity  is  tensor(0.9610, device='cuda:3')
compute_distance is  tensor(118.4135, device='cuda:3')
compute_norm is  tensor(48.5970, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(120.8487, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7730081161456321
avg test loss is  1.4060307553073745
avg accuracy is  0.8578333334896563
solo acc is  0.23873333348967127
compute similarity  is  tensor(0.9605, device='cuda:3')
compute_distance is  tensor(120.8487, device='cuda:3')
compute_norm is  tensor(48.3030, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(123.1742, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.78306872300756
avg test loss is  1.3450953334506386
avg accuracy is  0.8601000001563228
solo acc is  0.24556666682300476
compute similarity  is  tensor(0.9600, device='cuda:3')
compute_distance is  tensor(123.1742, device='cuda:3')
compute_norm is  tensor(48.0260, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(125.2985, device='cuda:3')
distance x is tensor(125.2985, device='cuda:3')
________________________________
test distance is  tensor(125.2985, device='cuda:3')
test distance1 is  tensor(125.2985, device='cuda:3')
test similarity is  tensor(0.9596, device='cuda:3')
test acc is  0.23215000015633766
test loss is 1.340574316632773
test entropy is  0.773479053969068
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.3920843601226807
mal norm is  tensor(630.3466, device='cuda:3')
distance x is tensor(125.3051, device='cuda:3')
mal distance is  tensor(125.3051, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([12., 12., 12., 12., 15., 12., 12., 13., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 26., 27., 27., 12., 12., 12., 12., 12.])
count_res tensor([1.2918e-07, 1.2918e-07, 1.2918e-07, 1.2918e-07, 2.5946e-06, 1.2918e-07,
        1.2918e-07, 3.5114e-07, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06,
        7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06,
        7.0528e-06, 7.0528e-06, 1.5535e-01, 4.2228e-01, 4.2228e-01, 1.2918e-07,
        1.2918e-07, 1.2918e-07, 1.2918e-07, 1.2918e-07])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 89.49% 

Test Accuracy: 88.63% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6025827527046204
distance x is tensor(112.3135, device='cuda:3')
benign distance is  tensor(112.3135, device='cuda:3')
norm1 res is  tensor(486.6226, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2784877419471741
distance x is tensor(105.7026, device='cuda:3')
benign distance is  tensor(105.7026, device='cuda:3')
norm1 res is  tensor(466.1206, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.03416740521788597
distance x is tensor(132.6972, device='cuda:3')
benign distance is  tensor(132.6972, device='cuda:3')
norm1 res is  tensor(557.6486, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3087884783744812
distance x is tensor(112.1133, device='cuda:3')
benign distance is  tensor(112.1133, device='cuda:3')
norm1 res is  tensor(486.3418, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7117747664451599
distance x is tensor(114.1522, device='cuda:3')
benign distance is  tensor(114.1522, device='cuda:3')
norm1 res is  tensor(487.1711, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6377811431884766
distance x is tensor(118.1552, device='cuda:3')
benign distance is  tensor(118.1552, device='cuda:3')
norm1 res is  tensor(504.5468, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3586205840110779
distance x is tensor(119.7268, device='cuda:3')
benign distance is  tensor(119.7268, device='cuda:3')
norm1 res is  tensor(505.3788, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.48324471712112427
distance x is tensor(112.6181, device='cuda:3')
benign distance is  tensor(112.6181, device='cuda:3')
norm1 res is  tensor(489.7666, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.1933620721101761
distance x is tensor(98.0045, device='cuda:3')
benign distance is  tensor(98.0045, device='cuda:3')
norm1 res is  tensor(439.9446, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.10399911552667618
distance x is tensor(90.8209, device='cuda:3')
benign distance is  tensor(90.8209, device='cuda:3')
norm1 res is  tensor(397.0155, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5339381098747253
distance x is tensor(61.2198, device='cuda:3')
benign distance is  tensor(61.2198, device='cuda:3')
norm1 res is  tensor(267.2091, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.3718952238559723
distance x is tensor(132.9932, device='cuda:3')
benign distance is  tensor(132.9932, device='cuda:3')
norm1 res is  tensor(559.4025, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7165728807449341
distance x is tensor(114.3780, device='cuda:3')
benign distance is  tensor(114.3780, device='cuda:3')
norm1 res is  tensor(512.8798, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.530637264251709
distance x is tensor(123.3388, device='cuda:3')
benign distance is  tensor(123.3388, device='cuda:3')
norm1 res is  tensor(519.7906, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.5925105810165405
distance x is tensor(97.3532, device='cuda:3')
benign distance is  tensor(97.3532, device='cuda:3')
norm1 res is  tensor(418.2840, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.2024308443069458
distance x is tensor(125.7413, device='cuda:3')
benign distance is  tensor(125.7413, device='cuda:3')
norm1 res is  tensor(540.6602, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(115.6210, device='cuda:3')
compute distance is  tensor(115.6210, device='cuda:3')
compute norm is  tensor(50.4944, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.0903, device='cuda:3')
compute distance is  tensor(113.0903, device='cuda:3')
compute norm is  tensor(50.5856, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.7080, device='cuda:3')
compute distance is  tensor(118.7080, device='cuda:3')
compute norm is  tensor(50.7276, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.5798, device='cuda:3')
compute distance is  tensor(117.5798, device='cuda:3')
compute norm is  tensor(50.6483, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.0043, device='cuda:3')
compute distance is  tensor(111.0043, device='cuda:3')
compute norm is  tensor(50.5237, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.8603, device='cuda:3')
compute distance is  tensor(115.8603, device='cuda:3')
compute norm is  tensor(50.7867, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.8018, device='cuda:3')
compute distance is  tensor(113.8018, device='cuda:3')
compute norm is  tensor(50.6594, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.2196, device='cuda:3')
compute distance is  tensor(120.2196, device='cuda:3')
compute norm is  tensor(50.6683, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.0712, device='cuda:3')
compute distance is  tensor(112.0712, device='cuda:3')
compute norm is  tensor(50.8350, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.0593, device='cuda:3')
compute distance is  tensor(118.0593, device='cuda:3')
compute norm is  tensor(50.6973, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.3914, device='cuda:3')
compute distance is  tensor(127.3914, device='cuda:3')
compute norm is  tensor(50.8823, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.4544, device='cuda:3')
compute distance is  tensor(122.4544, device='cuda:3')
compute norm is  tensor(50.8248, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(127.3914, device='cuda:3')
distance x is tensor(106223.7969, device='cuda:3')
distance x is tensor(106223.7969, device='cuda:3')
________________________________
test distance is  tensor(106223.7969, device='cuda:3')
test distance1 is  tensor(106223.7969, device='cuda:3')
test similarity is  tensor(-0.0967, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139275355384991.39
test entropy is  0.0
________________________________
cal ratio is  0.03393792293930048
distance x is tensor(3605.0203, device='cuda:3')
cal_distance is  tensor(3605.0203, device='cuda:3')
cal ratio is  0.18422234958386885
distance x is tensor(664.1295, device='cuda:3')
cal_distance is  tensor(664.1295, device='cuda:3')
cal ratio is  0.4292099607405815
distance x is tensor(285.0538, device='cuda:3')
cal_distance is  tensor(285.0538, device='cuda:3')
cal ratio is  0.655137916142835
distance x is tensor(186.7513, device='cuda:3')
cal_distance is  tensor(186.7513, device='cuda:3')
cal ratio is  0.8094022133865991
distance x is tensor(151.1579, device='cuda:3')
cal_distance is  tensor(151.1579, device='cuda:3')
cal ratio is  0.8996649561817233
distance x is tensor(135.9919, device='cuda:3')
cal_distance is  tensor(135.9919, device='cuda:3')
cal ratio is  0.9485049099918264
distance x is tensor(128.9893, device='cuda:3')
cal_distance is  tensor(128.9893, device='cuda:3')
cal ratio is  0.973911114892754
distance x is tensor(125.6242, device='cuda:3')
cal_distance is  tensor(125.6242, device='cuda:3')
distance x is tensor(125.6242, device='cuda:3')
return_distance is  tensor(125.6242, device='cuda:3')
distance x is tensor(125.6143, device='cuda:3')
distance x is tensor(125.6143, device='cuda:3')
________________________________
test distance is  tensor(125.6143, device='cuda:3')
test distance1 is  tensor(125.6143, device='cuda:3')
test similarity is  tensor(0.9588, device='cuda:3')
test acc is  0.10000000015633198
test loss is 335.1118451669526
test entropy is  7.343373979355524e-36
________________________________
0
distance x is tensor(125.6143, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  5.799984206748194e-36
avg test loss is  335.13132735457754
avg accuracy is  0.3108500001563398
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9588, device='cuda:3')
compute_distance is  tensor(125.6143, device='cuda:3')
compute_norm is  tensor(49.8087, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(112.1309, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8634082313412542
avg test loss is  1.3338157917136577
avg accuracy is  0.8538833334896564
solo acc is  0.3480333334896738
compute similarity  is  tensor(0.9627, device='cuda:3')
compute_distance is  tensor(112.1309, device='cuda:3')
compute_norm is  tensor(48.5192, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.2996, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8230015787361528
avg test loss is  1.376282927578192
avg accuracy is  0.8551833334896564
solo acc is  0.2774833334896723
compute similarity  is  tensor(0.9619, device='cuda:3')
compute_distance is  tensor(115.2996, device='cuda:3')
compute_norm is  tensor(48.1998, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.8877, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7962677463539628
avg test loss is  1.3663011741028157
avg accuracy is  0.8564833334896563
solo acc is  0.25698333348967173
compute similarity  is  tensor(0.9613, device='cuda:3')
compute_distance is  tensor(117.8877, device='cuda:3')
compute_norm is  tensor(47.9121, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(120.2793, device='cuda:3')
exit early
distance x is tensor(120.2793, device='cuda:3')
distance x is tensor(120.2793, device='cuda:3')
________________________________
test distance is  tensor(120.2793, device='cuda:3')
test distance1 is  tensor(120.2793, device='cuda:3')
test similarity is  tensor(0.9608, device='cuda:3')
test acc is  0.23280000015633767
test loss is 1.3661454443865493
test entropy is  0.7804312396532437
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.3304263353347778
mal norm is  tensor(615.4699, device='cuda:3')
distance x is tensor(120.2859, device='cuda:3')
mal distance is  tensor(120.2859, device='cuda:3')
user_PLR len size 52
counter_tensor is  tensor([51., 36., 14., 49., 19., 12., 16., 51., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 51., 23., 15., 12., 46., 49., 14., 48.,
        15., 50., 43., 51., 13., 18., 51., 16., 12., 18., 15., 51., 50., 34.,
        15., 13., 13., 12., 49., 15., 12., 14., 14., 18.])
count_res tensor([1.3891e-01, 4.2493e-08, 1.1853e-17, 1.8800e-02, 1.7592e-15, 1.6042e-18,
        8.7585e-17, 1.3891e-01, 2.3201e-06, 2.3201e-06, 2.3201e-06, 2.3201e-06,
        2.3201e-06, 2.3201e-06, 2.3201e-06, 2.3201e-06, 2.3201e-06, 2.3201e-06,
        2.3201e-06, 2.3201e-06, 1.3891e-01, 9.6049e-14, 3.2221e-17, 1.6042e-18,
        9.3598e-04, 1.8800e-02, 1.1853e-17, 6.9160e-03, 3.2221e-17, 5.1103e-02,
        4.6600e-05, 1.3891e-01, 4.3606e-18, 6.4717e-16, 1.3891e-01, 8.7585e-17,
        1.6042e-18, 6.4717e-16, 3.2221e-17, 1.3891e-01, 5.1103e-02, 5.7509e-09,
        3.2221e-17, 4.3606e-18, 4.3606e-18, 1.6042e-18, 1.8800e-02, 3.2221e-17,
        1.6042e-18, 1.1853e-17, 1.1853e-17, 6.4717e-16])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 89.90% 

Test Accuracy: 89.10% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7785694003105164
distance x is tensor(81.2754, device='cuda:3')
benign distance is  tensor(81.2754, device='cuda:3')
norm1 res is  tensor(359.0531, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.31360429525375366
distance x is tensor(96.9281, device='cuda:3')
benign distance is  tensor(96.9281, device='cuda:3')
norm1 res is  tensor(423.1331, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3219696879386902
distance x is tensor(109.6322, device='cuda:3')
benign distance is  tensor(109.6322, device='cuda:3')
norm1 res is  tensor(477.9824, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3763449788093567
distance x is tensor(90.4389, device='cuda:3')
benign distance is  tensor(90.4389, device='cuda:3')
norm1 res is  tensor(378.9988, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4684731364250183
distance x is tensor(94.0215, device='cuda:3')
benign distance is  tensor(94.0215, device='cuda:3')
norm1 res is  tensor(406.4477, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8298576474189758
distance x is tensor(102.4888, device='cuda:3')
benign distance is  tensor(102.4888, device='cuda:3')
norm1 res is  tensor(456.8235, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.40630435943603516
distance x is tensor(99.6514, device='cuda:3')
benign distance is  tensor(99.6514, device='cuda:3')
norm1 res is  tensor(435.3455, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.372392475605011
distance x is tensor(88.6488, device='cuda:3')
benign distance is  tensor(88.6488, device='cuda:3')
norm1 res is  tensor(391.9696, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.11191217601299286
distance x is tensor(127.5807, device='cuda:3')
benign distance is  tensor(127.5807, device='cuda:3')
norm1 res is  tensor(551.9785, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.396526575088501
distance x is tensor(118.4915, device='cuda:3')
benign distance is  tensor(118.4915, device='cuda:3')
norm1 res is  tensor(512.2050, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7178193926811218
distance x is tensor(97.6924, device='cuda:3')
benign distance is  tensor(97.6924, device='cuda:3')
norm1 res is  tensor(431.9698, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.38261106610298157
distance x is tensor(119.4553, device='cuda:3')
benign distance is  tensor(119.4553, device='cuda:3')
norm1 res is  tensor(524.2319, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.38926228880882263
distance x is tensor(101.3897, device='cuda:3')
benign distance is  tensor(101.3897, device='cuda:3')
norm1 res is  tensor(450.3374, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.31247928738594055
distance x is tensor(90.4312, device='cuda:3')
benign distance is  tensor(90.4312, device='cuda:3')
norm1 res is  tensor(395.8306, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2488294392824173
distance x is tensor(112.9696, device='cuda:3')
benign distance is  tensor(112.9696, device='cuda:3')
norm1 res is  tensor(494.4619, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7251489758491516
distance x is tensor(106.7094, device='cuda:3')
benign distance is  tensor(106.7094, device='cuda:3')
norm1 res is  tensor(469.2065, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.14211371541023254
distance x is tensor(114.9367, device='cuda:3')
benign distance is  tensor(114.9367, device='cuda:3')
norm1 res is  tensor(498.2670, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6221164464950562
distance x is tensor(125.1885, device='cuda:3')
benign distance is  tensor(125.1885, device='cuda:3')
norm1 res is  tensor(553.0135, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.6610920429229736
distance x is tensor(98.8608, device='cuda:3')
benign distance is  tensor(98.8608, device='cuda:3')
norm1 res is  tensor(438.1620, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.6389011144638062
distance x is tensor(110.8160, device='cuda:3')
benign distance is  tensor(110.8160, device='cuda:3')
norm1 res is  tensor(481.6342, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3867490291595459
distance x is tensor(99.9671, device='cuda:3')
benign distance is  tensor(99.9671, device='cuda:3')
norm1 res is  tensor(440.7459, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8343904614448547
distance x is tensor(101.5062, device='cuda:3')
benign distance is  tensor(101.5062, device='cuda:3')
norm1 res is  tensor(453.8783, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.6241859197616577
distance x is tensor(84.7239, device='cuda:3')
benign distance is  tensor(84.7239, device='cuda:3')
norm1 res is  tensor(373.0684, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3051582872867584
distance x is tensor(106.6423, device='cuda:3')
benign distance is  tensor(106.6423, device='cuda:3')
norm1 res is  tensor(468.4926, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.5231194496154785
distance x is tensor(109.2582, device='cuda:3')
benign distance is  tensor(109.2582, device='cuda:3')
norm1 res is  tensor(493.8499, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.5785022974014282
distance x is tensor(100.8843, device='cuda:3')
benign distance is  tensor(100.8843, device='cuda:3')
norm1 res is  tensor(431.2122, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.6696908473968506
distance x is tensor(112.6392, device='cuda:3')
benign distance is  tensor(112.6392, device='cuda:3')
norm1 res is  tensor(493.3905, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4982079565525055
distance x is tensor(98.9548, device='cuda:3')
benign distance is  tensor(98.9548, device='cuda:3')
norm1 res is  tensor(432.1605, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.1211835145950317
distance x is tensor(117.2817, device='cuda:3')
benign distance is  tensor(117.2817, device='cuda:3')
norm1 res is  tensor(508.8457, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5084066987037659
distance x is tensor(109.0723, device='cuda:3')
benign distance is  tensor(109.0723, device='cuda:3')
norm1 res is  tensor(480.3141, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6897149085998535
distance x is tensor(108.6854, device='cuda:3')
benign distance is  tensor(108.6854, device='cuda:3')
norm1 res is  tensor(476.6055, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.26337793469429016
distance x is tensor(121.2747, device='cuda:3')
benign distance is  tensor(121.2747, device='cuda:3')
norm1 res is  tensor(532.1584, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.3119105100631714
distance x is tensor(115.9054, device='cuda:3')
benign distance is  tensor(115.9054, device='cuda:3')
norm1 res is  tensor(509.5811, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.1620890349149704
distance x is tensor(115.4951, device='cuda:3')
benign distance is  tensor(115.4951, device='cuda:3')
norm1 res is  tensor(517.9999, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.14797155559062958
distance x is tensor(102.9566, device='cuda:3')
benign distance is  tensor(102.9566, device='cuda:3')
norm1 res is  tensor(446.1173, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.44451847672462463
distance x is tensor(105.0904, device='cuda:3')
benign distance is  tensor(105.0904, device='cuda:3')
norm1 res is  tensor(455.0955, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.28741854429244995
distance x is tensor(123.3068, device='cuda:3')
benign distance is  tensor(123.3068, device='cuda:3')
norm1 res is  tensor(539.2645, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7471359372138977
distance x is tensor(114.1494, device='cuda:3')
benign distance is  tensor(114.1494, device='cuda:3')
norm1 res is  tensor(499.7648, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.0177733898162842
distance x is tensor(109.0630, device='cuda:3')
benign distance is  tensor(109.0630, device='cuda:3')
norm1 res is  tensor(473.9625, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.8009066581726074
distance x is tensor(117.7249, device='cuda:3')
benign distance is  tensor(117.7249, device='cuda:3')
norm1 res is  tensor(527.8238, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(99.6304, device='cuda:3')
compute distance is  tensor(99.6304, device='cuda:3')
compute norm is  tensor(50.5608, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.6521, device='cuda:3')
compute distance is  tensor(102.6521, device='cuda:3')
compute norm is  tensor(50.6101, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.1660, device='cuda:3')
compute distance is  tensor(119.1660, device='cuda:3')
compute norm is  tensor(51.0083, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.5797, device='cuda:3')
compute distance is  tensor(106.5797, device='cuda:3')
compute norm is  tensor(50.8193, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.7886, device='cuda:3')
compute distance is  tensor(111.7886, device='cuda:3')
compute norm is  tensor(50.7918, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.7109, device='cuda:3')
compute distance is  tensor(103.7109, device='cuda:3')
compute norm is  tensor(50.8384, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.2794, device='cuda:3')
compute distance is  tensor(103.2794, device='cuda:3')
compute norm is  tensor(50.7228, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.0660, device='cuda:3')
compute distance is  tensor(111.0660, device='cuda:3')
compute norm is  tensor(50.7995, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.9766, device='cuda:3')
compute distance is  tensor(110.9766, device='cuda:3')
compute norm is  tensor(50.7801, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.2687, device='cuda:3')
compute distance is  tensor(104.2687, device='cuda:3')
compute norm is  tensor(50.7602, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.0680, device='cuda:3')
compute distance is  tensor(113.0680, device='cuda:3')
compute norm is  tensor(50.9155, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.1512, device='cuda:3')
compute distance is  tensor(113.1512, device='cuda:3')
compute norm is  tensor(50.9090, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(119.1660, device='cuda:3')
distance x is tensor(106226.1094, device='cuda:3')
distance x is tensor(106226.1094, device='cuda:3')
________________________________
test distance is  tensor(106226.1094, device='cuda:3')
test distance1 is  tensor(106226.1094, device='cuda:3')
test similarity is  tensor(-0.1003, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139305000528915.66
test entropy is  0.0
________________________________
cal ratio is  0.03282362737330604
distance x is tensor(3486.7312, device='cuda:3')
cal_distance is  tensor(3486.7312, device='cuda:3')
cal ratio is  0.18117279478549445
distance x is tensor(631.7049, device='cuda:3')
cal_distance is  tensor(631.7049, device='cuda:3')
cal ratio is  0.42564260720848385
distance x is tensor(268.8834, device='cuda:3')
cal_distance is  tensor(268.8834, device='cuda:3')
cal ratio is  0.6524093771262656
distance x is tensor(175.4238, device='cuda:3')
cal_distance is  tensor(175.4238, device='cuda:3')
cal ratio is  0.807714531098809
distance x is tensor(141.6933, device='cuda:3')
cal_distance is  tensor(141.6933, device='cuda:3')
cal ratio is  0.8987263921388013
distance x is tensor(127.3441, device='cuda:3')
cal_distance is  tensor(127.3441, device='cuda:3')
cal ratio is  0.9480098026982035
distance x is tensor(120.7237, device='cuda:3')
cal_distance is  tensor(120.7237, device='cuda:3')
cal ratio is  0.9736569267447148
distance x is tensor(117.5436, device='cuda:3')
cal_distance is  tensor(117.5436, device='cuda:3')
distance x is tensor(117.5436, device='cuda:3')
return_distance is  tensor(117.5436, device='cuda:3')
distance x is tensor(117.5336, device='cuda:3')
distance x is tensor(117.5336, device='cuda:3')
________________________________
test distance is  tensor(117.5336, device='cuda:3')
test distance1 is  tensor(117.5336, device='cuda:3')
test similarity is  tensor(0.9639, device='cuda:3')
test acc is  0.10000000015633198
test loss is 238.14941398116318
test entropy is  6.748479577427948e-29
________________________________
0
distance x is tensor(117.5336, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.4200871771738862e-27
avg test loss is  238.09892835800073
avg accuracy is  0.5147166668230088
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9639, device='cuda:3')
compute_distance is  tensor(117.5336, device='cuda:3')
compute_norm is  tensor(49.8087, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(107.2734, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8501778727274205
avg test loss is  1.300122735279201
avg accuracy is  0.8701833334896558
solo acc is  0.3516666668230071
compute similarity  is  tensor(0.9666, device='cuda:3')
compute_distance is  tensor(107.2734, device='cuda:3')
compute_norm is  tensor(48.5823, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(110.2723, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7943987226181193
avg test loss is  1.3956904767164544
avg accuracy is  0.8691666668229892
solo acc is  0.26045000015633857
compute similarity  is  tensor(0.9659, device='cuda:3')
compute_distance is  tensor(110.2723, device='cuda:3')
compute_norm is  tensor(48.2646, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(112.7058, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7822973140394256
avg test loss is  1.3706191621863766
avg accuracy is  0.8712833334896557
solo acc is  0.2460666668230047
compute similarity  is  tensor(0.9654, device='cuda:3')
compute_distance is  tensor(112.7058, device='cuda:3')
compute_norm is  tensor(47.9776, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(114.9786, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7836469558002089
avg test loss is  1.336789354078297
avg accuracy is  0.8731833334896556
solo acc is  0.24141666682300458
compute similarity  is  tensor(0.9649, device='cuda:3')
compute_distance is  tensor(114.9786, device='cuda:3')
compute_norm is  tensor(47.7058, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.1045, device='cuda:3')
distance x is tensor(117.1045, device='cuda:3')
________________________________
test distance is  tensor(117.1045, device='cuda:3')
test distance1 is  tensor(117.1045, device='cuda:3')
test similarity is  tensor(0.9645, device='cuda:3')
test acc is  0.23428333348967106
test loss is 1.3276563387816902
test entropy is  0.775395943411886
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.3309314250946045
mal norm is  tensor(587.0215, device='cuda:3')
distance x is tensor(117.1111, device='cuda:3')
mal distance is  tensor(117.1111, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 20.02% 

Test Accuracy: 19.34% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8901954889297485
distance x is tensor(140.6080, device='cuda:3')
benign distance is  tensor(140.6080, device='cuda:3')
norm1 res is  tensor(556.9247, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3080980181694031
distance x is tensor(172.3781, device='cuda:3')
benign distance is  tensor(172.3781, device='cuda:3')
norm1 res is  tensor(684.4319, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.17593660950660706
distance x is tensor(152.0382, device='cuda:3')
benign distance is  tensor(152.0382, device='cuda:3')
norm1 res is  tensor(596.8664, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.13378067314624786
distance x is tensor(162.0561, device='cuda:3')
benign distance is  tensor(162.0561, device='cuda:3')
norm1 res is  tensor(629.8049, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.556969404220581
distance x is tensor(166.9862, device='cuda:3')
benign distance is  tensor(166.9862, device='cuda:3')
norm1 res is  tensor(647.8636, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3694673478603363
distance x is tensor(175.6581, device='cuda:3')
benign distance is  tensor(175.6581, device='cuda:3')
norm1 res is  tensor(690.7831, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4638371467590332
distance x is tensor(151.1183, device='cuda:3')
benign distance is  tensor(151.1183, device='cuda:3')
norm1 res is  tensor(586.0197, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6979036927223206
distance x is tensor(161.4537, device='cuda:3')
benign distance is  tensor(161.4537, device='cuda:3')
norm1 res is  tensor(634.5096, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(155.3706, device='cuda:3')
compute distance is  tensor(155.3706, device='cuda:3')
compute norm is  tensor(49.1942, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.8841, device='cuda:3')
compute distance is  tensor(147.8841, device='cuda:3')
compute norm is  tensor(49.0683, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.6289, device='cuda:3')
compute distance is  tensor(167.6289, device='cuda:3')
compute norm is  tensor(49.6478, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.9968, device='cuda:3')
compute distance is  tensor(164.9968, device='cuda:3')
compute norm is  tensor(49.5140, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.9758, device='cuda:3')
compute distance is  tensor(162.9758, device='cuda:3')
compute norm is  tensor(49.5663, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.7314, device='cuda:3')
compute distance is  tensor(152.7314, device='cuda:3')
compute norm is  tensor(49.4292, device='cuda:3', dtype=torch.float64)
distance x is tensor(169.3954, device='cuda:3')
compute distance is  tensor(169.3954, device='cuda:3')
compute norm is  tensor(49.6031, device='cuda:3', dtype=torch.float64)
distance x is tensor(163.8683, device='cuda:3')
compute distance is  tensor(163.8683, device='cuda:3')
compute norm is  tensor(49.6471, device='cuda:3', dtype=torch.float64)
distance x is tensor(163.8341, device='cuda:3')
compute distance is  tensor(163.8341, device='cuda:3')
compute norm is  tensor(49.5006, device='cuda:3', dtype=torch.float64)
distance x is tensor(173.7931, device='cuda:3')
compute distance is  tensor(173.7931, device='cuda:3')
compute norm is  tensor(49.6738, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.6764, device='cuda:3')
compute distance is  tensor(150.6764, device='cuda:3')
compute norm is  tensor(49.1888, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.0814, device='cuda:3')
compute distance is  tensor(158.0814, device='cuda:3')
compute norm is  tensor(49.2842, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(173.7931, device='cuda:3')
distance x is tensor(106156.7969, device='cuda:3')
distance x is tensor(106156.7969, device='cuda:3')
________________________________
test distance is  tensor(106156.7969, device='cuda:3')
test distance1 is  tensor(106156.7969, device='cuda:3')
test similarity is  tensor(0.1249, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139287657189192.6
test entropy is  0.0
________________________________
cal ratio is  0.03965230773254854
distance x is tensor(4209.3672, device='cuda:3')
cal_distance is  tensor(4209.3672, device='cuda:3')
cal ratio is  0.19912874678366227
distance x is tensor(838.2100, device='cuda:3')
cal_distance is  tensor(838.2100, device='cuda:3')
cal ratio is  0.44623738827368054
distance x is tensor(374.0435, device='cuda:3')
cal_distance is  tensor(374.0435, device='cuda:3')
cal ratio is  0.6680074911472018
distance x is tensor(249.8655, device='cuda:3')
cal_distance is  tensor(249.8655, device='cuda:3')
cal ratio is  0.8173145281089829
distance x is tensor(204.2196, device='cuda:3')
cal_distance is  tensor(204.2196, device='cuda:3')
cal ratio is  0.904052511463967
distance x is tensor(184.6257, device='cuda:3')
cal_distance is  tensor(184.6257, device='cuda:3')
cal ratio is  0.950815483737026
distance x is tensor(175.5453, device='cuda:3')
cal_distance is  tensor(175.5453, device='cuda:3')
cal ratio is  0.975096939341855
distance x is tensor(171.1738, device='cuda:3')
cal_distance is  tensor(171.1738, device='cuda:3')
distance x is tensor(171.1738, device='cuda:3')
return_distance is  tensor(171.1738, device='cuda:3')
distance x is tensor(171.1638, device='cuda:3')
distance x is tensor(171.1638, device='cuda:3')
________________________________
test distance is  tensor(171.1638, device='cuda:3')
test distance1 is  tensor(171.1638, device='cuda:3')
test similarity is  tensor(0.9324, device='cuda:3')
test acc is  0.10000000015633198
test loss is 1139.0118967800506
test entropy is  0.0
________________________________
0
distance x is tensor(171.1638, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  1138.9164402032457
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9324, device='cuda:3')
compute_distance is  tensor(171.1638, device='cuda:3')
compute_norm is  tensor(51.0655, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(412.8052, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5613152490241695
avg test loss is  2.850885059533597
avg accuracy is  0.28308333348967246
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6011, device='cuda:3')
compute_distance is  tensor(412.8052, device='cuda:3')
compute_norm is  tensor(76.9825, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(412.0260, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.838917734717001
avg test loss is  3.5830678848315403
avg accuracy is  0.28461666682300585
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6009, device='cuda:3')
compute_distance is  tensor(412.0260, device='cuda:3')
compute_norm is  tensor(76.9990, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(410.3538, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5542960851939756
avg test loss is  2.8512585180908885
avg accuracy is  0.29003333348967264
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6010, device='cuda:3')
compute_distance is  tensor(410.3538, device='cuda:3')
compute_norm is  tensor(76.2778, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(409.6490, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8380561622856523
avg test loss is  3.5798224960563023
avg accuracy is  0.2891666668230059
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6009, device='cuda:3')
compute_distance is  tensor(409.6490, device='cuda:3')
compute_norm is  tensor(76.2984, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(408.0269, device='cuda:3')
distance x is tensor(408.0269, device='cuda:3')
________________________________
test distance is  tensor(408.0269, device='cuda:3')
test distance1 is  tensor(408.0269, device='cuda:3')
test similarity is  tensor(0.6010, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8519569963280325
test entropy is  1.5529761785891518
________________________________
cal ratio is  0.6395846001512073
distance x is tensor(260.9702, device='cuda:3')
cal_distance is  tensor(260.9702, device='cuda:3')
cal ratio is  0.7997365516266436
distance x is tensor(208.7077, device='cuda:3')
cal_distance is  tensor(208.7077, device='cuda:3')
cal ratio is  0.8942792934949925
distance x is tensor(186.6431, device='cuda:3')
cal_distance is  tensor(186.6431, device='cuda:3')
cal ratio is  0.9456630156692167
distance x is tensor(176.5016, device='cuda:3')
cal_distance is  tensor(176.5016, device='cuda:3')
cal ratio is  0.9724517455914472
distance x is tensor(171.6393, device='cuda:3')
cal_distance is  tensor(171.6393, device='cuda:3')
distance x is tensor(171.6393, device='cuda:3')
return_distance is  tensor(171.6393, device='cuda:3')
distance x is tensor(171.6363, device='cuda:3')
distance x is tensor(171.6363, device='cuda:3')
________________________________
test distance is  tensor(171.6363, device='cuda:3')
test distance1 is  tensor(171.6363, device='cuda:3')
test similarity is  tensor(0.8692, device='cuda:3')
test acc is  0.3052666668230063
test loss is 3.4661304063634324
test entropy is  1.2622531280080393
________________________________
0
distance x is tensor(171.6363, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.2632167726945775
avg test loss is  3.4606526879105233
avg accuracy is  0.2841500001563392
solo acc is  0.3051333334896729
compute similarity  is  tensor(0.8692, device='cuda:3')
compute_distance is  tensor(171.6363, device='cuda:3')
compute_norm is  tensor(55.3628, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(178.7550, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8238009225203793
avg test loss is  3.2897459332114343
avg accuracy is  0.2548500001563383
solo acc is  0.10156666682299864
compute similarity  is  tensor(0.8664, device='cuda:3')
compute_distance is  tensor(178.7550, device='cuda:3')
compute_norm is  tensor(55.7683, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(180.3380, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8915448769577531
avg test loss is  1.530138937140833
avg accuracy is  0.19266666682300257
solo acc is  0.21831666682300374
compute similarity  is  tensor(0.8668, device='cuda:3')
compute_distance is  tensor(180.3380, device='cuda:3')
compute_norm is  tensor(55.3481, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(180.3380, device='cuda:3')
distance x is tensor(180.3380, device='cuda:3')
________________________________
test distance is  tensor(180.3380, device='cuda:3')
test distance1 is  tensor(180.3380, device='cuda:3')
test similarity is  tensor(0.8668, device='cuda:3')
test acc is  0.21913333348967043
test loss is 1.530510007445492
test entropy is  0.8916247533455587
________________________________
cal ratio is  0.9620525104477659
distance x is tensor(173.4962, device='cuda:3')
cal_distance is  tensor(173.4962, device='cuda:3')
distance x is tensor(173.4962, device='cuda:3')
return_distance is  tensor(173.4962, device='cuda:3')
distance x is tensor(173.4946, device='cuda:3')
distance x is tensor(173.4946, device='cuda:3')
________________________________
test distance is  tensor(173.4946, device='cuda:3')
test distance1 is  tensor(173.4946, device='cuda:3')
test similarity is  tensor(0.8750, device='cuda:3')
test acc is  0.24638333348967145
test loss is 1.4799406767399834
test entropy is  0.8994470204371633
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.307436227798462
mal norm is  tensor(1181.9388, device='cuda:3')
distance x is tensor(173.4962, device='cuda:3')
mal distance is  tensor(173.4962, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([12., 12.,  0., 21., 12., 13., 22., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 26., 12., 17., 27., 12., 12.])
count_res tensor([2.2210e-07, 2.2210e-07, 1.3646e-12, 1.7997e-03, 2.2210e-07, 6.0372e-07,
        4.8920e-03, 2.2210e-07, 1.2126e-05, 1.2126e-05, 1.2126e-05, 1.2126e-05,
        1.2126e-05, 1.2126e-05, 1.2126e-05, 1.2126e-05, 1.2126e-05, 1.2126e-05,
        1.2126e-05, 1.2126e-05, 2.2210e-07, 2.2210e-07, 2.6709e-01, 2.2210e-07,
        3.2962e-05, 7.2603e-01, 2.2210e-07, 2.2210e-07])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 89.42% 

Test Accuracy: 88.83% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.929253876209259
distance x is tensor(111.2007, device='cuda:3')
benign distance is  tensor(111.2007, device='cuda:3')
norm1 res is  tensor(488.8252, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7186321020126343
distance x is tensor(122.0773, device='cuda:3')
benign distance is  tensor(122.0773, device='cuda:3')
norm1 res is  tensor(536.4120, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.16952188313007355
distance x is tensor(135.5142, device='cuda:3')
benign distance is  tensor(135.5142, device='cuda:3')
norm1 res is  tensor(582.3796, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6335975527763367
distance x is tensor(124.6371, device='cuda:3')
benign distance is  tensor(124.6371, device='cuda:3')
norm1 res is  tensor(556.6406, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.32123205065727234
distance x is tensor(99.9712, device='cuda:3')
benign distance is  tensor(99.9712, device='cuda:3')
norm1 res is  tensor(434.7342, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6907176971435547
distance x is tensor(123.4457, device='cuda:3')
benign distance is  tensor(123.4457, device='cuda:3')
norm1 res is  tensor(543.1953, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.24027559161186218
distance x is tensor(115.7521, device='cuda:3')
benign distance is  tensor(115.7521, device='cuda:3')
norm1 res is  tensor(492.8830, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2829921245574951
distance x is tensor(105.4426, device='cuda:3')
benign distance is  tensor(105.4426, device='cuda:3')
norm1 res is  tensor(470.9166, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.20450325310230255
distance x is tensor(128.0545, device='cuda:3')
benign distance is  tensor(128.0545, device='cuda:3')
norm1 res is  tensor(563.9339, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.23262576758861542
distance x is tensor(127.0279, device='cuda:3')
benign distance is  tensor(127.0279, device='cuda:3')
norm1 res is  tensor(550.2322, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.2096225917339325
distance x is tensor(113.5578, device='cuda:3')
benign distance is  tensor(113.5578, device='cuda:3')
norm1 res is  tensor(491.3633, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6692650318145752
distance x is tensor(124.2640, device='cuda:3')
benign distance is  tensor(124.2640, device='cuda:3')
norm1 res is  tensor(556.7169, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.29979315400123596
distance x is tensor(126.3640, device='cuda:3')
benign distance is  tensor(126.3640, device='cuda:3')
norm1 res is  tensor(554.9662, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.32555440068244934
distance x is tensor(68.4987, device='cuda:3')
benign distance is  tensor(68.4987, device='cuda:3')
norm1 res is  tensor(317.2830, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6338839530944824
distance x is tensor(132.1392, device='cuda:3')
benign distance is  tensor(132.1392, device='cuda:3')
norm1 res is  tensor(577.5240, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1345731019973755
distance x is tensor(124.2325, device='cuda:3')
benign distance is  tensor(124.2325, device='cuda:3')
norm1 res is  tensor(539.3761, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(129.4283, device='cuda:3')
compute distance is  tensor(129.4283, device='cuda:3')
compute norm is  tensor(51.6255, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.3304, device='cuda:3')
compute distance is  tensor(106.3304, device='cuda:3')
compute norm is  tensor(51.2610, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.8126, device='cuda:3')
compute distance is  tensor(118.8126, device='cuda:3')
compute norm is  tensor(51.5641, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.0966, device='cuda:3')
compute distance is  tensor(116.0966, device='cuda:3')
compute norm is  tensor(51.4950, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.1520, device='cuda:3')
compute distance is  tensor(121.1520, device='cuda:3')
compute norm is  tensor(51.4650, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.4357, device='cuda:3')
compute distance is  tensor(123.4357, device='cuda:3')
compute norm is  tensor(51.6499, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.7729, device='cuda:3')
compute distance is  tensor(125.7729, device='cuda:3')
compute norm is  tensor(51.6422, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.0999, device='cuda:3')
compute distance is  tensor(120.0999, device='cuda:3')
compute norm is  tensor(51.5764, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.4151, device='cuda:3')
compute distance is  tensor(120.4151, device='cuda:3')
compute norm is  tensor(51.7039, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.4184, device='cuda:3')
compute distance is  tensor(114.4184, device='cuda:3')
compute norm is  tensor(51.6372, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.8071, device='cuda:3')
compute distance is  tensor(130.8071, device='cuda:3')
compute norm is  tensor(51.8280, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.1179, device='cuda:3')
compute distance is  tensor(107.1179, device='cuda:3')
compute norm is  tensor(51.3811, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(130.8071, device='cuda:3')
distance x is tensor(106228.4609, device='cuda:3')
distance x is tensor(106228.4609, device='cuda:3')
________________________________
test distance is  tensor(106228.4609, device='cuda:3')
test distance1 is  tensor(106228.4609, device='cuda:3')
test similarity is  tensor(-0.0966, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139279727155448.9
test entropy is  0.0
________________________________
cal ratio is  0.034389131408215964
distance x is tensor(3653.1101, device='cuda:3')
cal_distance is  tensor(3653.1101, device='cuda:3')
cal ratio is  0.1854429314397766
distance x is tensor(677.4474, device='cuda:3')
cal_distance is  tensor(677.4474, device='cuda:3')
cal ratio is  0.4306295681172703
distance x is tensor(291.7317, device='cuda:3')
cal_distance is  tensor(291.7317, device='cuda:3')
cal ratio is  0.6562205460614334
distance x is tensor(191.4421, device='cuda:3')
cal_distance is  tensor(191.4421, device='cuda:3')
cal ratio is  0.8100707050947189
distance x is tensor(155.0826, device='cuda:3')
cal_distance is  tensor(155.0826, device='cuda:3')
cal ratio is  0.9000365015151335
distance x is tensor(139.5805, device='cuda:3')
cal_distance is  tensor(139.5805, device='cuda:3')
cal ratio is  0.9487008229805493
distance x is tensor(132.4204, device='cuda:3')
cal_distance is  tensor(132.4204, device='cuda:3')
cal ratio is  0.9740117371971095
distance x is tensor(128.9792, device='cuda:3')
cal_distance is  tensor(128.9792, device='cuda:3')
distance x is tensor(128.9792, device='cuda:3')
return_distance is  tensor(128.9792, device='cuda:3')
distance x is tensor(128.9692, device='cuda:3')
distance x is tensor(128.9692, device='cuda:3')
________________________________
test distance is  tensor(128.9692, device='cuda:3')
test distance1 is  tensor(128.9692, device='cuda:3')
test similarity is  tensor(0.9582, device='cuda:3')
test acc is  0.10000000015633198
test loss is 360.34066863558184
test entropy is  1.2974110699197369e-37
________________________________
0
distance x is tensor(128.9692, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  5.323627779336049e-37
avg test loss is  360.33464902702934
avg accuracy is  0.30808333348967304
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9582, device='cuda:3')
compute_distance is  tensor(128.9692, device='cuda:3')
compute_norm is  tensor(50.7171, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(115.0469, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8270298829083758
avg test loss is  1.4322517807803936
avg accuracy is  0.8632500001563227
solo acc is  0.30178333348967284
compute similarity  is  tensor(0.9622, device='cuda:3')
compute_distance is  tensor(115.0469, device='cuda:3')
compute_norm is  tensor(49.5044, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.8772, device='cuda:3')
exit early
distance x is tensor(117.8772, device='cuda:3')
distance x is tensor(117.8772, device='cuda:3')
________________________________
test distance is  tensor(117.8772, device='cuda:3')
test distance1 is  tensor(117.8772, device='cuda:3')
test similarity is  tensor(0.9616, device='cuda:3')
test acc is  0.2537500001563383
test loss is 1.4369162762088816
test entropy is  0.8014312558718073
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.3956730365753174
mal norm is  tensor(622.4744, device='cuda:3')
distance x is tensor(117.8840, device='cuda:3')
mal distance is  tensor(117.8840, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([16., 12., 12., 12., 12., 12., 17., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 24., 12., 12., 12., 27., 24., 12., 12.])
count_res tensor([1.5186e-05, 2.7813e-07, 2.7813e-07, 2.7813e-07, 2.7813e-07, 2.7813e-07,
        4.1279e-05, 2.7813e-07, 1.5186e-05, 1.5186e-05, 1.5186e-05, 1.5186e-05,
        1.5186e-05, 1.5186e-05, 1.5186e-05, 1.5186e-05, 1.5186e-05, 1.5186e-05,
        1.5186e-05, 1.5186e-05, 4.5268e-02, 2.7813e-07, 2.7813e-07, 2.7813e-07,
        9.0922e-01, 4.5268e-02, 2.7813e-07, 2.7813e-07])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 88.23% 

Test Accuracy: 87.43% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.36763712763786316
distance x is tensor(97.5922, device='cuda:3')
benign distance is  tensor(97.5922, device='cuda:3')
norm1 res is  tensor(431.5707, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9739536046981812
distance x is tensor(118.6899, device='cuda:3')
benign distance is  tensor(118.6899, device='cuda:3')
norm1 res is  tensor(528.3871, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1757839173078537
distance x is tensor(124.4695, device='cuda:3')
benign distance is  tensor(124.4695, device='cuda:3')
norm1 res is  tensor(534.6783, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8361115455627441
distance x is tensor(107.0359, device='cuda:3')
benign distance is  tensor(107.0359, device='cuda:3')
norm1 res is  tensor(454.4844, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5805484652519226
distance x is tensor(119.8694, device='cuda:3')
benign distance is  tensor(119.8694, device='cuda:3')
norm1 res is  tensor(517.0368, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8016057014465332
distance x is tensor(121.2502, device='cuda:3')
benign distance is  tensor(121.2502, device='cuda:3')
norm1 res is  tensor(540.1243, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3568238615989685
distance x is tensor(115.1802, device='cuda:3')
benign distance is  tensor(115.1802, device='cuda:3')
norm1 res is  tensor(492.7622, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.49528560042381287
distance x is tensor(101.5591, device='cuda:3')
benign distance is  tensor(101.5591, device='cuda:3')
norm1 res is  tensor(447.8889, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.54524165391922
distance x is tensor(132.5034, device='cuda:3')
benign distance is  tensor(132.5034, device='cuda:3')
norm1 res is  tensor(567.3277, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.3730847835540771
distance x is tensor(135.4251, device='cuda:3')
benign distance is  tensor(135.4251, device='cuda:3')
norm1 res is  tensor(592.3101, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.39245492219924927
distance x is tensor(120.9560, device='cuda:3')
benign distance is  tensor(120.9560, device='cuda:3')
norm1 res is  tensor(512.5964, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4514366686344147
distance x is tensor(110.8370, device='cuda:3')
benign distance is  tensor(110.8370, device='cuda:3')
norm1 res is  tensor(502.3066, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4719420075416565
distance x is tensor(42.9059, device='cuda:3')
benign distance is  tensor(42.9059, device='cuda:3')
norm1 res is  tensor(187.8260, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.2490063905715942
distance x is tensor(110.3283, device='cuda:3')
benign distance is  tensor(110.3283, device='cuda:3')
norm1 res is  tensor(485.8133, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.21414828300476074
distance x is tensor(97.3585, device='cuda:3')
benign distance is  tensor(97.3585, device='cuda:3')
norm1 res is  tensor(425.4541, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.789729118347168
distance x is tensor(110.8876, device='cuda:3')
benign distance is  tensor(110.8876, device='cuda:3')
norm1 res is  tensor(484.0985, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(117.5404, device='cuda:3')
compute distance is  tensor(117.5404, device='cuda:3')
compute norm is  tensor(51.5092, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.5017, device='cuda:3')
compute distance is  tensor(117.5017, device='cuda:3')
compute norm is  tensor(51.5765, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.2793, device='cuda:3')
compute distance is  tensor(124.2793, device='cuda:3')
compute norm is  tensor(51.8125, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.5221, device='cuda:3')
compute distance is  tensor(117.5221, device='cuda:3')
compute norm is  tensor(51.7152, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.8501, device='cuda:3')
compute distance is  tensor(114.8501, device='cuda:3')
compute norm is  tensor(51.6242, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.5275, device='cuda:3')
compute distance is  tensor(126.5275, device='cuda:3')
compute norm is  tensor(51.8925, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.7694, device='cuda:3')
compute distance is  tensor(115.7694, device='cuda:3')
compute norm is  tensor(51.7045, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.1805, device='cuda:3')
compute distance is  tensor(117.1805, device='cuda:3')
compute norm is  tensor(51.7089, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.7766, device='cuda:3')
compute distance is  tensor(110.7766, device='cuda:3')
compute norm is  tensor(51.5571, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.9564, device='cuda:3')
compute distance is  tensor(122.9564, device='cuda:3')
compute norm is  tensor(51.8226, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.8145, device='cuda:3')
compute distance is  tensor(124.8145, device='cuda:3')
compute norm is  tensor(51.7160, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.1982, device='cuda:3')
compute distance is  tensor(121.1982, device='cuda:3')
compute norm is  tensor(51.8423, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(126.5275, device='cuda:3')
distance x is tensor(106228.9297, device='cuda:3')
distance x is tensor(106228.9297, device='cuda:3')
________________________________
test distance is  tensor(106228.9297, device='cuda:3')
test distance1 is  tensor(106228.9297, device='cuda:3')
test similarity is  tensor(-0.0975, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139287641154252.14
test entropy is  0.0
________________________________
cal ratio is  0.033821835451457415
distance x is tensor(3592.8635, device='cuda:3')
cal_distance is  tensor(3592.8635, device='cuda:3')
cal ratio is  0.18390698482201331
distance x is tensor(660.7567, device='cuda:3')
cal_distance is  tensor(660.7567, device='cuda:3')
cal ratio is  0.42884248212929765
distance x is tensor(283.3634, device='cuda:3')
cal_distance is  tensor(283.3634, device='cuda:3')
cal ratio is  0.6548573088010224
distance x is tensor(185.5644, device='cuda:3')
cal_distance is  tensor(185.5644, device='cuda:3')
cal ratio is  0.8092287083978136
distance x is tensor(150.1650, device='cuda:3')
cal_distance is  tensor(150.1650, device='cuda:3')
cal ratio is  0.8995684902559161
distance x is tensor(135.0842, device='cuda:3')
cal_distance is  tensor(135.0842, device='cuda:3')
cal ratio is  0.9484539714181077
distance x is tensor(128.1214, device='cuda:3')
cal_distance is  tensor(128.1214, device='cuda:3')
cal ratio is  0.9738850466132026
distance x is tensor(124.7757, device='cuda:3')
cal_distance is  tensor(124.7757, device='cuda:3')
distance x is tensor(124.7757, device='cuda:3')
return_distance is  tensor(124.7757, device='cuda:3')
distance x is tensor(124.7656, device='cuda:3')
distance x is tensor(124.7656, device='cuda:3')
________________________________
test distance is  tensor(124.7656, device='cuda:3')
test distance1 is  tensor(124.7656, device='cuda:3')
test similarity is  tensor(0.9610, device='cuda:3')
test acc is  0.10000000015633198
test loss is 324.4421691894531
test entropy is  5.579232587014951e-38
________________________________
0
distance x is tensor(124.7656, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  5.566950263187861e-35
avg test loss is  324.44148114495187
avg accuracy is  0.32073333348967326
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9610, device='cuda:3')
compute_distance is  tensor(124.7656, device='cuda:3')
compute_norm is  tensor(50.7222, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(112.6479, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8182236592906879
avg test loss is  1.4387937512224926
avg accuracy is  0.855500000156323
solo acc is  0.29951666682300615
compute similarity  is  tensor(0.9645, device='cuda:3')
compute_distance is  tensor(112.6479, device='cuda:3')
compute_norm is  tensor(49.4492, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.8411, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7789152874621247
avg test loss is  1.4574419539620374
avg accuracy is  0.8561166668229896
solo acc is  0.2500500001563382
compute similarity  is  tensor(0.9637, device='cuda:3')
compute_distance is  tensor(115.8411, device='cuda:3')
compute_norm is  tensor(49.1282, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(118.6589, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.795681872411069
avg test loss is  1.3774988663984513
avg accuracy is  0.8585500001563229
solo acc is  0.25336666682300507
compute similarity  is  tensor(0.9631, device='cuda:3')
compute_distance is  tensor(118.6589, device='cuda:3')
compute_norm is  tensor(48.8354, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(121.1289, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7832331055644225
avg test loss is  1.3561329473056265
avg accuracy is  0.8589666668229895
solo acc is  0.24293333348967136
compute similarity  is  tensor(0.9626, device='cuda:3')
compute_distance is  tensor(121.1289, device='cuda:3')
compute_norm is  tensor(48.5575, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(123.5052, device='cuda:3')
distance x is tensor(123.5052, device='cuda:3')
________________________________
test distance is  tensor(123.5052, device='cuda:3')
test distance1 is  tensor(123.5052, device='cuda:3')
test similarity is  tensor(0.9621, device='cuda:3')
test acc is  0.22771666682300415
test loss is 1.3539221587974126
test entropy is  0.7693453321197649
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.1835265159606934
mal norm is  tensor(618.6915, device='cuda:3')
distance x is tensor(123.5117, device='cuda:3')
mal distance is  tensor(123.5117, device='cuda:3')
user_PLR len size 44
counter_tensor is  tensor([17., 40.,  1., 43., 43., 14., 15., 42., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 36.,  0., 42., 13., 12., 27., 13.,  0.,
        33., 34., 12., 19., 38.,  0., 13.,  0., 23.,  1., 41.,  0., 20., 27.,
         0., 43.])
count_res tensor([1.3004e-12, 1.2672e-02, 1.4634e-19, 2.5452e-01, 2.5452e-01, 6.4742e-14,
        1.7599e-13, 9.3634e-02, 4.2510e-06, 4.2510e-06, 4.2510e-06, 4.2510e-06,
        4.2510e-06, 4.2510e-06, 4.2510e-06, 4.2510e-06, 4.2510e-06, 4.2510e-06,
        4.2510e-06, 4.2510e-06, 2.3210e-04, 5.3835e-20, 9.3634e-02, 2.3817e-14,
        8.7619e-15, 2.8643e-08, 2.3817e-14, 5.3835e-20, 1.1555e-05, 3.1411e-05,
        8.7619e-15, 9.6086e-12, 1.7150e-03, 5.3835e-20, 2.3817e-14, 5.3835e-20,
        5.2461e-10, 1.4634e-19, 3.4446e-02, 5.3835e-20, 2.6119e-11, 2.8643e-08,
        5.3835e-20, 2.5452e-01])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 89.60% 

Test Accuracy: 88.93% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.36998018622398376
distance x is tensor(101.7957, device='cuda:3')
benign distance is  tensor(101.7957, device='cuda:3')
norm1 res is  tensor(438.7311, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6926741600036621
distance x is tensor(111.4889, device='cuda:3')
benign distance is  tensor(111.4889, device='cuda:3')
norm1 res is  tensor(485.5422, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2538684010505676
distance x is tensor(116.9452, device='cuda:3')
benign distance is  tensor(116.9452, device='cuda:3')
norm1 res is  tensor(502.9149, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0360033512115479
distance x is tensor(90.5032, device='cuda:3')
benign distance is  tensor(90.5032, device='cuda:3')
norm1 res is  tensor(388.0827, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2203643321990967
distance x is tensor(74.7236, device='cuda:3')
benign distance is  tensor(74.7236, device='cuda:3')
norm1 res is  tensor(317.2549, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9280781745910645
distance x is tensor(113.1008, device='cuda:3')
benign distance is  tensor(113.1008, device='cuda:3')
norm1 res is  tensor(497.3062, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.699183464050293
distance x is tensor(115.0377, device='cuda:3')
benign distance is  tensor(115.0377, device='cuda:3')
norm1 res is  tensor(490.2866, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.657560408115387
distance x is tensor(95.7714, device='cuda:3')
benign distance is  tensor(95.7714, device='cuda:3')
norm1 res is  tensor(430.1877, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.375955194234848
distance x is tensor(124.5195, device='cuda:3')
benign distance is  tensor(124.5195, device='cuda:3')
norm1 res is  tensor(527.3781, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.755933403968811
distance x is tensor(111.1405, device='cuda:3')
benign distance is  tensor(111.1405, device='cuda:3')
norm1 res is  tensor(490.0022, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6044763922691345
distance x is tensor(106.2749, device='cuda:3')
benign distance is  tensor(106.2749, device='cuda:3')
norm1 res is  tensor(466.9178, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6357039213180542
distance x is tensor(129.8683, device='cuda:3')
benign distance is  tensor(129.8683, device='cuda:3')
norm1 res is  tensor(566.0509, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8574498295783997
distance x is tensor(117.3171, device='cuda:3')
benign distance is  tensor(117.3171, device='cuda:3')
norm1 res is  tensor(510.3107, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2834293246269226
distance x is tensor(93.1841, device='cuda:3')
benign distance is  tensor(93.1841, device='cuda:3')
norm1 res is  tensor(415.5664, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4628790020942688
distance x is tensor(135.1792, device='cuda:3')
benign distance is  tensor(135.1792, device='cuda:3')
norm1 res is  tensor(593.3774, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7653681039810181
distance x is tensor(96.6614, device='cuda:3')
benign distance is  tensor(96.6614, device='cuda:3')
norm1 res is  tensor(419.7748, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.305614709854126
distance x is tensor(128.4153, device='cuda:3')
benign distance is  tensor(128.4153, device='cuda:3')
norm1 res is  tensor(571.0750, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.2590885162353516
distance x is tensor(106.9657, device='cuda:3')
benign distance is  tensor(106.9657, device='cuda:3')
norm1 res is  tensor(463.5943, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3519558310508728
distance x is tensor(112.4268, device='cuda:3')
benign distance is  tensor(112.4268, device='cuda:3')
norm1 res is  tensor(494.5863, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.9616899490356445
distance x is tensor(114.4673, device='cuda:3')
benign distance is  tensor(114.4673, device='cuda:3')
norm1 res is  tensor(499.3639, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.325198769569397
distance x is tensor(118.9111, device='cuda:3')
benign distance is  tensor(118.9111, device='cuda:3')
norm1 res is  tensor(511.7207, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.034861445426941
distance x is tensor(115.8769, device='cuda:3')
benign distance is  tensor(115.8769, device='cuda:3')
norm1 res is  tensor(515.6288, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.2374337613582611
distance x is tensor(109.1832, device='cuda:3')
benign distance is  tensor(109.1832, device='cuda:3')
norm1 res is  tensor(489.6952, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.24826431274414062
distance x is tensor(113.6430, device='cuda:3')
benign distance is  tensor(113.6430, device='cuda:3')
norm1 res is  tensor(499.5771, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.4163362979888916
distance x is tensor(109.2859, device='cuda:3')
benign distance is  tensor(109.2859, device='cuda:3')
norm1 res is  tensor(486.4293, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.04429234564304352
distance x is tensor(116.0019, device='cuda:3')
benign distance is  tensor(116.0019, device='cuda:3')
norm1 res is  tensor(525.7370, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.44729018211364746
distance x is tensor(80.5712, device='cuda:3')
benign distance is  tensor(80.5712, device='cuda:3')
norm1 res is  tensor(357.0909, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.1468248963356018
distance x is tensor(123.8788, device='cuda:3')
benign distance is  tensor(123.8788, device='cuda:3')
norm1 res is  tensor(542.5615, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8382425308227539
distance x is tensor(110.5681, device='cuda:3')
benign distance is  tensor(110.5681, device='cuda:3')
norm1 res is  tensor(494.7247, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.1105473041534424
distance x is tensor(109.7566, device='cuda:3')
benign distance is  tensor(109.7566, device='cuda:3')
norm1 res is  tensor(462.8385, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.8547536134719849
distance x is tensor(97.3462, device='cuda:3')
benign distance is  tensor(97.3462, device='cuda:3')
norm1 res is  tensor(432.8312, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.35574889183044434
distance x is tensor(113.1827, device='cuda:3')
benign distance is  tensor(113.1827, device='cuda:3')
norm1 res is  tensor(485.6423, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(105.5624, device='cuda:3')
compute distance is  tensor(105.5624, device='cuda:3')
compute norm is  tensor(51.6240, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.2126, device='cuda:3')
compute distance is  tensor(108.2126, device='cuda:3')
compute norm is  tensor(51.6064, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.4911, device='cuda:3')
compute distance is  tensor(116.4911, device='cuda:3')
compute norm is  tensor(51.8473, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.2062, device='cuda:3')
compute distance is  tensor(116.2062, device='cuda:3')
compute norm is  tensor(51.7291, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.6820, device='cuda:3')
compute distance is  tensor(120.6820, device='cuda:3')
compute norm is  tensor(51.7626, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.8927, device='cuda:3')
compute distance is  tensor(113.8927, device='cuda:3')
compute norm is  tensor(51.7264, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.8110, device='cuda:3')
compute distance is  tensor(111.8110, device='cuda:3')
compute norm is  tensor(51.7492, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.2247, device='cuda:3')
compute distance is  tensor(118.2247, device='cuda:3')
compute norm is  tensor(51.8161, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.7533, device='cuda:3')
compute distance is  tensor(111.7533, device='cuda:3')
compute norm is  tensor(51.6960, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.3599, device='cuda:3')
compute distance is  tensor(110.3599, device='cuda:3')
compute norm is  tensor(51.6667, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.1884, device='cuda:3')
compute distance is  tensor(116.1884, device='cuda:3')
compute norm is  tensor(51.7983, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.8947, device='cuda:3')
compute distance is  tensor(114.8947, device='cuda:3')
compute norm is  tensor(51.7962, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(120.6820, device='cuda:3')
distance x is tensor(106229.8516, device='cuda:3')
distance x is tensor(106229.8516, device='cuda:3')
________________________________
test distance is  tensor(106229.8516, device='cuda:3')
test distance1 is  tensor(106229.8516, device='cuda:3')
test similarity is  tensor(-0.0979, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139270787349724.52
test entropy is  0.0
________________________________
cal ratio is  0.033031179522169156
distance x is tensor(3508.9031, device='cuda:3')
cal_distance is  tensor(3508.9031, device='cuda:3')
cal ratio is  0.18174466803969627
distance x is tensor(637.7286, device='cuda:3')
cal_distance is  tensor(637.7286, device='cuda:3')
cal ratio is  0.42631383431173664
distance x is tensor(271.8754, device='cuda:3')
cal_distance is  tensor(271.8754, device='cuda:3')
cal ratio is  0.6529236769335369
distance x is tensor(177.5156, device='cuda:3')
cal_distance is  tensor(177.5156, device='cuda:3')
cal ratio is  0.8080330022767883
distance x is tensor(143.4395, device='cuda:3')
cal_distance is  tensor(143.4395, device='cuda:3')
cal ratio is  0.8989034784023313
distance x is tensor(128.9387, device='cuda:3')
cal_distance is  tensor(128.9387, device='cuda:3')
cal ratio is  0.9481033021836782
distance x is tensor(122.2475, device='cuda:3')
cal_distance is  tensor(122.2475, device='cuda:3')
cal ratio is  0.973704871330444
distance x is tensor(119.0331, device='cuda:3')
cal_distance is  tensor(119.0331, device='cuda:3')
distance x is tensor(119.0331, device='cuda:3')
return_distance is  tensor(119.0331, device='cuda:3')
distance x is tensor(119.0231, device='cuda:3')
distance x is tensor(119.0231, device='cuda:3')
________________________________
test distance is  tensor(119.0231, device='cuda:3')
test distance1 is  tensor(119.0231, device='cuda:3')
test similarity is  tensor(0.9645, device='cuda:3')
test acc is  0.10000000015633198
test loss is 259.4646927725786
test entropy is  2.3856136926329298e-30
________________________________
0
distance x is tensor(119.0231, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.8054463363495284e-29
avg test loss is  259.47875807381894
avg accuracy is  0.4770666668230086
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9645, device='cuda:3')
compute_distance is  tensor(119.0231, device='cuda:3')
compute_norm is  tensor(50.7856, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(109.0041, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7999131356093929
avg test loss is  1.424978890716394
avg accuracy is  0.8709666668229891
solo acc is  0.29140000015633927
compute similarity  is  tensor(0.9671, device='cuda:3')
compute_distance is  tensor(109.0041, device='cuda:3')
compute_norm is  tensor(49.5761, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(111.7895, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7970198307083105
avg test loss is  1.4025211196337173
avg accuracy is  0.8707333334896558
solo acc is  0.25420000015633837
compute similarity  is  tensor(0.9665, device='cuda:3')
compute_distance is  tensor(111.7895, device='cuda:3')
compute_norm is  tensor(49.2581, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(114.1211, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7805955276560428
avg test loss is  1.3934718914377664
avg accuracy is  0.8716833334896555
solo acc is  0.2349333334896711
compute similarity  is  tensor(0.9661, device='cuda:3')
compute_distance is  tensor(114.1211, device='cuda:3')
compute_norm is  tensor(48.9676, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(116.2945, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7751413180884014
avg test loss is  1.3704293521482553
avg accuracy is  0.8736333334896556
solo acc is  0.22881666682300425
compute similarity  is  tensor(0.9657, device='cuda:3')
compute_distance is  tensor(116.2945, device='cuda:3')
compute_norm is  tensor(48.6920, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(118.3456, device='cuda:3')
distance x is tensor(118.3456, device='cuda:3')
________________________________
test distance is  tensor(118.3456, device='cuda:3')
test distance1 is  tensor(118.3456, device='cuda:3')
test similarity is  tensor(0.9653, device='cuda:3')
test acc is  0.23276666682300434
test loss is 1.326096468070931
test entropy is  0.7816041838894012
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2871969938278198
mal norm is  tensor(593.1893, device='cuda:3')
distance x is tensor(118.3521, device='cuda:3')
mal distance is  tensor(118.3521, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 19.63% 

Test Accuracy: 19.23% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.703025221824646
distance x is tensor(156.2541, device='cuda:3')
benign distance is  tensor(156.2541, device='cuda:3')
norm1 res is  tensor(601.3283, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9392321705818176
distance x is tensor(162.5821, device='cuda:3')
benign distance is  tensor(162.5821, device='cuda:3')
norm1 res is  tensor(629.0026, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.02705002762377262
distance x is tensor(167.9455, device='cuda:3')
benign distance is  tensor(167.9455, device='cuda:3')
norm1 res is  tensor(651.7886, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.25680607557296753
distance x is tensor(148.4036, device='cuda:3')
benign distance is  tensor(148.4036, device='cuda:3')
norm1 res is  tensor(572.5834, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8741497993469238
distance x is tensor(150.8927, device='cuda:3')
benign distance is  tensor(150.8927, device='cuda:3')
norm1 res is  tensor(585.8981, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9409528970718384
distance x is tensor(170.8672, device='cuda:3')
benign distance is  tensor(170.8672, device='cuda:3')
norm1 res is  tensor(656.2737, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.26826736330986023
distance x is tensor(165.2625, device='cuda:3')
benign distance is  tensor(165.2625, device='cuda:3')
norm1 res is  tensor(631.6293, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5414987802505493
distance x is tensor(177.3465, device='cuda:3')
benign distance is  tensor(177.3465, device='cuda:3')
norm1 res is  tensor(679.4802, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(165.6641, device='cuda:3')
compute distance is  tensor(165.6641, device='cuda:3')
compute norm is  tensor(50.2094, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.5441, device='cuda:3')
compute distance is  tensor(160.5441, device='cuda:3')
compute norm is  tensor(50.1868, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.1996, device='cuda:3')
compute distance is  tensor(167.1996, device='cuda:3')
compute norm is  tensor(50.4695, device='cuda:3', dtype=torch.float64)
distance x is tensor(176.5763, device='cuda:3')
compute distance is  tensor(176.5763, device='cuda:3')
compute norm is  tensor(50.6239, device='cuda:3', dtype=torch.float64)
distance x is tensor(179.9962, device='cuda:3')
compute distance is  tensor(179.9962, device='cuda:3')
compute norm is  tensor(50.7165, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.4553, device='cuda:3')
compute distance is  tensor(167.4553, device='cuda:3')
compute norm is  tensor(50.6341, device='cuda:3', dtype=torch.float64)
distance x is tensor(172.4734, device='cuda:3')
compute distance is  tensor(172.4734, device='cuda:3')
compute norm is  tensor(50.6223, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.8627, device='cuda:3')
compute distance is  tensor(161.8627, device='cuda:3')
compute norm is  tensor(50.5142, device='cuda:3', dtype=torch.float64)
distance x is tensor(183.9402, device='cuda:3')
compute distance is  tensor(183.9402, device='cuda:3')
compute norm is  tensor(50.7257, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.6658, device='cuda:3')
compute distance is  tensor(167.6658, device='cuda:3')
compute norm is  tensor(50.4104, device='cuda:3', dtype=torch.float64)
distance x is tensor(169.7652, device='cuda:3')
compute distance is  tensor(169.7652, device='cuda:3')
compute norm is  tensor(50.4828, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.0957, device='cuda:3')
compute distance is  tensor(170.0957, device='cuda:3')
compute norm is  tensor(50.5120, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(183.9402, device='cuda:3')
distance x is tensor(106161.3203, device='cuda:3')
distance x is tensor(106161.3203, device='cuda:3')
________________________________
test distance is  tensor(106161.3203, device='cuda:3')
test distance1 is  tensor(106161.3203, device='cuda:3')
test similarity is  tensor(0.1249, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139279780277337.52
test entropy is  0.0
________________________________
cal ratio is  0.040792586829113485
distance x is tensor(4330.6011, device='cuda:3')
cal_distance is  tensor(4330.6011, device='cuda:3')
cal ratio is  0.20197160317906618
distance x is tensor(874.6624, device='cuda:3')
cal_distance is  tensor(874.6624, device='cuda:3')
cal ratio is  0.44941149014329873
distance x is tensor(393.0861, device='cuda:3')
cal_distance is  tensor(393.0861, device='cuda:3')
cal ratio is  0.6703792567056618
distance x is tensor(263.5184, device='cuda:3')
cal_distance is  tensor(263.5184, device='cuda:3')
cal ratio is  0.8187643206122933
distance x is tensor(215.7604, device='cuda:3')
cal_distance is  tensor(215.7604, device='cuda:3')
cal ratio is  0.9048540363705296
distance x is tensor(195.2322, device='cuda:3')
cal_distance is  tensor(195.2322, device='cuda:3')
cal ratio is  0.9512369791736289
distance x is tensor(185.7123, device='cuda:3')
cal_distance is  tensor(185.7123, device='cuda:3')
cal ratio is  0.9753131892486944
distance x is tensor(181.1278, device='cuda:3')
cal_distance is  tensor(181.1278, device='cuda:3')
distance x is tensor(181.1278, device='cuda:3')
return_distance is  tensor(181.1278, device='cuda:3')
distance x is tensor(181.1178, device='cuda:3')
distance x is tensor(181.1178, device='cuda:3')
________________________________
test distance is  tensor(181.1178, device='cuda:3')
test distance1 is  tensor(181.1178, device='cuda:3')
test similarity is  tensor(0.9284, device='cuda:3')
test acc is  0.10000000015633198
test loss is 1259.3389775453093
test entropy is  0.0
________________________________
0
distance x is tensor(181.1178, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  1259.7476558075277
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9284, device='cuda:3')
compute_distance is  tensor(181.1178, device='cuda:3')
compute_norm is  tensor(52.3079, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(643.1898, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5582982301712036
avg test loss is  2.852734355275819
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6836, device='cuda:3')
compute_distance is  tensor(643.1898, device='cuda:3')
compute_norm is  tensor(73.3654, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(641.1365, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8368691205978394
avg test loss is  3.584611946077489
avg accuracy is  0.10005000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6833, device='cuda:3')
compute_distance is  tensor(641.1365, device='cuda:3')
compute_norm is  tensor(73.3852, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(638.1891, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5537229776382446
avg test loss is  2.8520962114273103
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6835, device='cuda:3')
compute_distance is  tensor(638.1891, device='cuda:3')
compute_norm is  tensor(72.6893, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(636.2220, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.837090253829956
avg test loss is  3.581124716221905
avg accuracy is  0.10003333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6833, device='cuda:3')
compute_distance is  tensor(636.2220, device='cuda:3')
compute_norm is  tensor(72.7163, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(633.3524, device='cuda:3')
distance x is tensor(633.3524, device='cuda:3')
________________________________
test distance is  tensor(633.3524, device='cuda:3')
test distance1 is  tensor(633.3524, device='cuda:3')
test similarity is  tensor(0.6835, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.852001504349048
test entropy is  1.553523302078247
________________________________
cal ratio is  0.5281310423556143
distance x is tensor(334.4945, device='cuda:3')
cal_distance is  tensor(334.4945, device='cuda:3')
cal ratio is  0.7267247218016037
distance x is tensor(243.0856, device='cuda:3')
cal_distance is  tensor(243.0856, device='cuda:3')
cal ratio is  0.852481092274088
distance x is tensor(207.2260, device='cuda:3')
cal_distance is  tensor(207.2260, device='cuda:3')
cal ratio is  0.9232987504308601
distance x is tensor(191.3316, device='cuda:3')
cal_distance is  tensor(191.3316, device='cuda:3')
cal ratio is  0.9608841583581713
distance x is tensor(183.8476, device='cuda:3')
cal_distance is  tensor(183.8476, device='cuda:3')
distance x is tensor(183.8476, device='cuda:3')
return_distance is  tensor(183.8476, device='cuda:3')
distance x is tensor(183.8457, device='cuda:3')
distance x is tensor(183.8457, device='cuda:3')
________________________________
test distance is  tensor(183.8457, device='cuda:3')
test distance1 is  tensor(183.8457, device='cuda:3')
test similarity is  tensor(0.9532, device='cuda:3')
test acc is  0.10785000015633196
test loss is 2.466985209155947
test entropy is  1.967040561663825
________________________________
0
distance x is tensor(183.8457, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.9673892232909131
avg test loss is  2.4681496129615477
avg accuracy is  0.2835500001563392
solo acc is  0.10926666682299864
compute similarity  is  tensor(0.9532, device='cuda:3')
compute_distance is  tensor(183.8457, device='cuda:3')
compute_norm is  tensor(51.1675, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(185.8605, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8362322973289977
avg test loss is  2.3276043536820645
avg accuracy is  0.12763333348966524
solo acc is  0.10456666682299863
compute similarity  is  tensor(0.9523, device='cuda:3')
compute_distance is  tensor(185.8605, device='cuda:3')
compute_norm is  tensor(51.1607, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(186.7390, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.044067736818338
avg test loss is  1.3785048355934209
avg accuracy is  0.12998333348966523
solo acc is  0.3633666668230073
compute similarity  is  tensor(0.9523, device='cuda:3')
compute_distance is  tensor(186.7390, device='cuda:3')
compute_norm is  tensor(50.8820, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(186.6881, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.5482291180187705
avg test loss is  2.4157711543254
avg accuracy is  0.10513333348966529
solo acc is  0.10025000015633198
compute similarity  is  tensor(0.9521, device='cuda:3')
compute_distance is  tensor(186.6881, device='cuda:3')
compute_norm is  tensor(50.7055, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(187.4921, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9632750353070972
avg test loss is  1.418637104634283
avg accuracy is  0.12066666682299859
solo acc is  0.2682333334896721
compute similarity  is  tensor(0.9520, device='cuda:3')
compute_distance is  tensor(187.4921, device='cuda:3')
compute_norm is  tensor(50.4421, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(187.4921, device='cuda:3')
distance x is tensor(187.4921, device='cuda:3')
________________________________
test distance is  tensor(187.4921, device='cuda:3')
test distance1 is  tensor(187.4921, device='cuda:3')
test similarity is  tensor(0.9520, device='cuda:3')
test acc is  0.26655000015633873
test loss is 1.4205827391478045
test entropy is  0.9634755952144737
________________________________
cal ratio is  0.9706729260542373
distance x is tensor(181.9945, device='cuda:3')
cal_distance is  tensor(181.9945, device='cuda:3')
distance x is tensor(181.9945, device='cuda:3')
return_distance is  tensor(181.9945, device='cuda:3')
distance x is tensor(181.9935, device='cuda:3')
distance x is tensor(181.9935, device='cuda:3')
________________________________
test distance is  tensor(181.9935, device='cuda:3')
test distance1 is  tensor(181.9935, device='cuda:3')
test similarity is  tensor(0.9546, device='cuda:3')
test acc is  0.250916666823005
test loss is 1.4327817575763793
test entropy is  0.9676705031379708
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2516111135482788
mal norm is  tensor(674.7194, device='cuda:3')
distance x is tensor(181.9945, device='cuda:3')
mal distance is  tensor(181.9945, device='cuda:3')
user_PLR len size 44
counter_tensor is  tensor([17., 17., 17., 17., 17., 17., 17., 17., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 43., 15., 15., 36., 33., 43., 20., 40.,
        42., 26., 20., 40., 42., 14., 12., 21., 18., 43., 16., 43., 13., 22.,
        13., 43.])
count_res tensor([8.7537e-13, 8.7537e-13, 8.7537e-13, 8.7537e-13, 8.7537e-13, 8.7537e-13,
        8.7537e-13, 8.7537e-13, 2.8616e-06, 2.8616e-06, 2.8616e-06, 2.8616e-06,
        2.8616e-06, 2.8616e-06, 2.8616e-06, 2.8616e-06, 2.8616e-06, 2.8616e-06,
        2.8616e-06, 2.8616e-06, 1.7134e-01, 1.1847e-13, 1.1847e-13, 1.5624e-04,
        7.7786e-06, 1.7134e-01, 1.7582e-11, 8.5303e-03, 6.3031e-02, 7.0932e-09,
        1.7582e-11, 8.5303e-03, 6.3031e-02, 4.3582e-14, 5.8982e-15, 4.7794e-11,
        2.3795e-12, 1.7134e-01, 3.2203e-13, 1.7134e-01, 1.6033e-14, 1.2992e-10,
        1.6033e-14, 1.7134e-01])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 89.76% 

Test Accuracy: 89.25% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7743539810180664
distance x is tensor(95.0677, device='cuda:3')
benign distance is  tensor(95.0677, device='cuda:3')
norm1 res is  tensor(431.1638, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0291731357574463
distance x is tensor(104.3182, device='cuda:3')
benign distance is  tensor(104.3182, device='cuda:3')
norm1 res is  tensor(460.2608, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1922398805618286
distance x is tensor(120.5313, device='cuda:3')
benign distance is  tensor(120.5313, device='cuda:3')
norm1 res is  tensor(532.7759, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4876604974269867
distance x is tensor(99.4581, device='cuda:3')
benign distance is  tensor(99.4581, device='cuda:3')
norm1 res is  tensor(428.0845, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0411500930786133
distance x is tensor(91.2163, device='cuda:3')
benign distance is  tensor(91.2163, device='cuda:3')
norm1 res is  tensor(391.6815, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5591210722923279
distance x is tensor(103.7516, device='cuda:3')
benign distance is  tensor(103.7516, device='cuda:3')
norm1 res is  tensor(456.2914, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4885905683040619
distance x is tensor(107.0205, device='cuda:3')
benign distance is  tensor(107.0205, device='cuda:3')
norm1 res is  tensor(459.3852, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8483373522758484
distance x is tensor(85.6655, device='cuda:3')
benign distance is  tensor(85.6655, device='cuda:3')
norm1 res is  tensor(386.8168, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5018961429595947
distance x is tensor(120.5404, device='cuda:3')
benign distance is  tensor(120.5404, device='cuda:3')
norm1 res is  tensor(520.7732, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7714978456497192
distance x is tensor(111.8579, device='cuda:3')
benign distance is  tensor(111.8579, device='cuda:3')
norm1 res is  tensor(484.0568, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6778713464736938
distance x is tensor(102.0785, device='cuda:3')
benign distance is  tensor(102.0785, device='cuda:3')
norm1 res is  tensor(449.1147, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.1519148349761963
distance x is tensor(99.3787, device='cuda:3')
benign distance is  tensor(99.3787, device='cuda:3')
norm1 res is  tensor(439.6729, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5262775421142578
distance x is tensor(99.0829, device='cuda:3')
benign distance is  tensor(99.0829, device='cuda:3')
norm1 res is  tensor(441.9415, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.16511668264865875
distance x is tensor(88.5467, device='cuda:3')
benign distance is  tensor(88.5467, device='cuda:3')
norm1 res is  tensor(393.2715, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.30684080719947815
distance x is tensor(113.8077, device='cuda:3')
benign distance is  tensor(113.8077, device='cuda:3')
norm1 res is  tensor(500.4195, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0803070068359375
distance x is tensor(88.8210, device='cuda:3')
benign distance is  tensor(88.8210, device='cuda:3')
norm1 res is  tensor(382.7317, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.28474295139312744
distance x is tensor(109.1259, device='cuda:3')
benign distance is  tensor(109.1259, device='cuda:3')
norm1 res is  tensor(482.2153, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.3701961040496826
distance x is tensor(123.7304, device='cuda:3')
benign distance is  tensor(123.7304, device='cuda:3')
norm1 res is  tensor(550.5606, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.8313058018684387
distance x is tensor(113.6430, device='cuda:3')
benign distance is  tensor(113.6430, device='cuda:3')
norm1 res is  tensor(483.6083, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.45995330810546875
distance x is tensor(99.1661, device='cuda:3')
benign distance is  tensor(99.1661, device='cuda:3')
norm1 res is  tensor(439.8604, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.27399176359176636
distance x is tensor(77.4951, device='cuda:3')
benign distance is  tensor(77.4951, device='cuda:3')
norm1 res is  tensor(344.6227, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6022554636001587
distance x is tensor(103.1560, device='cuda:3')
benign distance is  tensor(103.1560, device='cuda:3')
norm1 res is  tensor(453.8045, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3749658167362213
distance x is tensor(92.2677, device='cuda:3')
benign distance is  tensor(92.2677, device='cuda:3')
norm1 res is  tensor(401.6817, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.182599663734436
distance x is tensor(111.7614, device='cuda:3')
benign distance is  tensor(111.7614, device='cuda:3')
norm1 res is  tensor(473.1293, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.10688171535730362
distance x is tensor(95.2545, device='cuda:3')
benign distance is  tensor(95.2545, device='cuda:3')
norm1 res is  tensor(431.5605, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.5163390040397644
distance x is tensor(110.8422, device='cuda:3')
benign distance is  tensor(110.8422, device='cuda:3')
norm1 res is  tensor(477.1965, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.131903737783432
distance x is tensor(116.5737, device='cuda:3')
benign distance is  tensor(116.5737, device='cuda:3')
norm1 res is  tensor(506.0287, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.31443026661872864
distance x is tensor(123.7155, device='cuda:3')
benign distance is  tensor(123.7155, device='cuda:3')
norm1 res is  tensor(545.3397, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6412761211395264
distance x is tensor(123.8263, device='cuda:3')
benign distance is  tensor(123.8263, device='cuda:3')
norm1 res is  tensor(542.6161, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7964986562728882
distance x is tensor(116.7429, device='cuda:3')
benign distance is  tensor(116.7429, device='cuda:3')
norm1 res is  tensor(521.8113, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.0754663944244385
distance x is tensor(131.7321, device='cuda:3')
benign distance is  tensor(131.7321, device='cuda:3')
norm1 res is  tensor(569.5216, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5488494634628296
distance x is tensor(110.0389, device='cuda:3')
benign distance is  tensor(110.0389, device='cuda:3')
norm1 res is  tensor(486.4191, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(111.6855, device='cuda:3')
compute distance is  tensor(111.6855, device='cuda:3')
compute norm is  tensor(51.6292, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.7082, device='cuda:3')
compute distance is  tensor(100.7082, device='cuda:3')
compute norm is  tensor(51.4502, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.6153, device='cuda:3')
compute distance is  tensor(111.6153, device='cuda:3')
compute norm is  tensor(51.7771, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.1653, device='cuda:3')
compute distance is  tensor(110.1653, device='cuda:3')
compute norm is  tensor(51.5859, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.5823, device='cuda:3')
compute distance is  tensor(108.5823, device='cuda:3')
compute norm is  tensor(51.6060, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.5294, device='cuda:3')
compute distance is  tensor(111.5294, device='cuda:3')
compute norm is  tensor(51.6750, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.7542, device='cuda:3')
compute distance is  tensor(103.7542, device='cuda:3')
compute norm is  tensor(51.7022, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.5295, device='cuda:3')
compute distance is  tensor(105.5295, device='cuda:3')
compute norm is  tensor(51.6050, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.1212, device='cuda:3')
compute distance is  tensor(113.1212, device='cuda:3')
compute norm is  tensor(51.5989, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.3428, device='cuda:3')
compute distance is  tensor(109.3428, device='cuda:3')
compute norm is  tensor(51.5851, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.6256, device='cuda:3')
compute distance is  tensor(111.6256, device='cuda:3')
compute norm is  tensor(51.7522, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.0460, device='cuda:3')
compute distance is  tensor(110.0460, device='cuda:3')
compute norm is  tensor(51.6810, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(113.1212, device='cuda:3')
distance x is tensor(106230.2109, device='cuda:3')
distance x is tensor(106230.2109, device='cuda:3')
________________________________
test distance is  tensor(106230.2109, device='cuda:3')
test distance1 is  tensor(106230.2109, device='cuda:3')
test similarity is  tensor(-0.0990, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139266137816179.72
test entropy is  0.0
________________________________
cal ratio is  0.03197967339055265
distance x is tensor(3397.2131, device='cuda:3')
cal_distance is  tensor(3397.2131, device='cuda:3')
cal ratio is  0.17882847001395352
distance x is tensor(607.5225, device='cuda:3')
cal_distance is  tensor(607.5225, device='cuda:3')
cal ratio is  0.42287972319043143
distance x is tensor(256.9119, device='cuda:3')
cal_distance is  tensor(256.9119, device='cuda:3')
cal ratio is  0.6502883417755745
distance x is tensor(167.0686, device='cuda:3')
cal_distance is  tensor(167.0686, device='cuda:3')
cal ratio is  0.8064003110687994
distance x is tensor(134.7251, device='cuda:3')
cal_distance is  tensor(134.7251, device='cuda:3')
cal ratio is  0.8979946536975494
distance x is tensor(120.9829, device='cuda:3')
cal_distance is  tensor(120.9829, device='cuda:3')
cal ratio is  0.9476238121525443
distance x is tensor(114.6466, device='cuda:3')
cal_distance is  tensor(114.6466, device='cuda:3')
cal ratio is  0.9734585386424423
distance x is tensor(111.6038, device='cuda:3')
cal_distance is  tensor(111.6038, device='cuda:3')
distance x is tensor(111.6038, device='cuda:3')
return_distance is  tensor(111.6038, device='cuda:3')
distance x is tensor(111.5938, device='cuda:3')
distance x is tensor(111.5938, device='cuda:3')
________________________________
test distance is  tensor(111.5938, device='cuda:3')
test distance1 is  tensor(111.5938, device='cuda:3')
test similarity is  tensor(0.9686, device='cuda:3')
test acc is  0.10000000015633198
test loss is 190.61800872542457
test entropy is  4.1766698253810164e-23
________________________________
0
distance x is tensor(111.5938, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.5298381949493124e-25
avg test loss is  190.65267095179445
avg accuracy is  0.6392166668230013
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9686, device='cuda:3')
compute_distance is  tensor(111.5938, device='cuda:3')
compute_norm is  tensor(50.6364, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(104.4736, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8416747211901618
avg test loss is  1.354718360311187
avg accuracy is  0.8657166668229893
solo acc is  0.32645000015634
compute similarity  is  tensor(0.9705, device='cuda:3')
compute_distance is  tensor(104.4736, device='cuda:3')
compute_norm is  tensor(49.4260, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(107.5012, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8060164010601003
avg test loss is  1.39081799431142
avg accuracy is  0.8682000001563225
solo acc is  0.2602166668230052
compute similarity  is  tensor(0.9699, device='cuda:3')
compute_distance is  tensor(107.5012, device='cuda:3')
compute_norm is  tensor(49.1056, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(110.0632, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7811463913683698
avg test loss is  1.3848422876299062
avg accuracy is  0.8697000001563225
solo acc is  0.243200000156338
compute similarity  is  tensor(0.9694, device='cuda:3')
compute_distance is  tensor(110.0632, device='cuda:3')
compute_norm is  tensor(48.8148, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(112.3156, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7938043705817225
avg test loss is  1.317043884476619
avg accuracy is  0.8713833334896557
solo acc is  0.25361666682300504
compute similarity  is  tensor(0.9689, device='cuda:3')
compute_distance is  tensor(112.3156, device='cuda:3')
compute_norm is  tensor(48.5416, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(114.5255, device='cuda:3')
distance x is tensor(114.5255, device='cuda:3')
________________________________
test distance is  tensor(114.5255, device='cuda:3')
test distance1 is  tensor(114.5255, device='cuda:3')
test similarity is  tensor(0.9685, device='cuda:3')
test acc is  0.2283333334896709
test loss is 1.3426797166307851
test entropy is  0.7691860179275846
________________________________
cal ratio is  0.973973094054514
distance x is tensor(111.5511, device='cuda:3')
cal_distance is  tensor(111.5511, device='cuda:3')
distance x is tensor(111.5511, device='cuda:3')
return_distance is  tensor(111.5511, device='cuda:3')
distance x is tensor(111.5447, device='cuda:3')
distance x is tensor(111.5447, device='cuda:3')
________________________________
test distance is  tensor(111.5447, device='cuda:3')
test distance1 is  tensor(111.5447, device='cuda:3')
test similarity is  tensor(0.9702, device='cuda:3')
test acc is  0.29598333348967276
test loss is 1.2381676263900707
test entropy is  0.7959194598294524
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.1134002208709717
mal norm is  tensor(549.8146, device='cuda:3')
distance x is tensor(111.5511, device='cuda:3')
mal distance is  tensor(111.5511, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 26.97% 

Test Accuracy: 26.04% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9957006573677063
distance x is tensor(156.5569, device='cuda:3')
benign distance is  tensor(156.5569, device='cuda:3')
norm1 res is  tensor(613.0646, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9909858703613281
distance x is tensor(164.4193, device='cuda:3')
benign distance is  tensor(164.4193, device='cuda:3')
norm1 res is  tensor(640.1670, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.43621912598609924
distance x is tensor(155.4085, device='cuda:3')
benign distance is  tensor(155.4085, device='cuda:3')
norm1 res is  tensor(614.5232, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8653114438056946
distance x is tensor(165.7809, device='cuda:3')
benign distance is  tensor(165.7809, device='cuda:3')
norm1 res is  tensor(641.8889, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0772942304611206
distance x is tensor(153.6733, device='cuda:3')
benign distance is  tensor(153.6733, device='cuda:3')
norm1 res is  tensor(597.5925, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8584033846855164
distance x is tensor(171.9011, device='cuda:3')
benign distance is  tensor(171.9011, device='cuda:3')
norm1 res is  tensor(658.5498, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7513031959533691
distance x is tensor(152.1109, device='cuda:3')
benign distance is  tensor(152.1109, device='cuda:3')
norm1 res is  tensor(595.2460, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.44945067167282104
distance x is tensor(156.1876, device='cuda:3')
benign distance is  tensor(156.1876, device='cuda:3')
norm1 res is  tensor(614.5187, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(158.5503, device='cuda:3')
compute distance is  tensor(158.5503, device='cuda:3')
compute norm is  tensor(50.1112, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.4970, device='cuda:3')
compute distance is  tensor(148.4970, device='cuda:3')
compute norm is  tensor(49.8948, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.2466, device='cuda:3')
compute distance is  tensor(155.2466, device='cuda:3')
compute norm is  tensor(50.2286, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.8348, device='cuda:3')
compute distance is  tensor(156.8348, device='cuda:3')
compute norm is  tensor(50.0539, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.8638, device='cuda:3')
compute distance is  tensor(164.8638, device='cuda:3')
compute norm is  tensor(50.3516, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.8904, device='cuda:3')
compute distance is  tensor(164.8904, device='cuda:3')
compute norm is  tensor(50.4426, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.2571, device='cuda:3')
compute distance is  tensor(153.2571, device='cuda:3')
compute norm is  tensor(50.0381, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.0837, device='cuda:3')
compute distance is  tensor(164.0837, device='cuda:3')
compute norm is  tensor(50.3161, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.1514, device='cuda:3')
compute distance is  tensor(152.1514, device='cuda:3')
compute norm is  tensor(50.0421, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.3342, device='cuda:3')
compute distance is  tensor(162.3342, device='cuda:3')
compute norm is  tensor(50.1465, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.5257, device='cuda:3')
compute distance is  tensor(149.5257, device='cuda:3')
compute norm is  tensor(50.0032, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.1622, device='cuda:3')
compute distance is  tensor(160.1622, device='cuda:3')
compute norm is  tensor(50.3434, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(164.8904, device='cuda:3')
distance x is tensor(106165.0938, device='cuda:3')
distance x is tensor(106165.0938, device='cuda:3')
________________________________
test distance is  tensor(106165.0938, device='cuda:3')
test distance1 is  tensor(106165.0938, device='cuda:3')
test similarity is  tensor(0.1058, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139288290090885.73
test entropy is  0.0
________________________________
cal ratio is  0.03862183822580527
distance x is tensor(4100.2969, device='cuda:3')
cal_distance is  tensor(4100.2969, device='cuda:3')
cal ratio is  0.19652426121811498
distance x is tensor(805.8118, device='cuda:3')
cal_distance is  tensor(805.8118, device='cuda:3')
cal ratio is  0.4433094756290666
distance x is tensor(357.2268, device='cuda:3')
cal_distance is  tensor(357.2268, device='cuda:3')
cal ratio is  0.6658122789967502
distance x is tensor(237.8477, device='cuda:3')
cal_distance is  tensor(237.8477, device='cuda:3')
cal ratio is  0.8159702400818325
distance x is tensor(194.0776, device='cuda:3')
cal_distance is  tensor(194.0776, device='cuda:3')
cal ratio is  0.9033086109356112
distance x is tensor(175.3124, device='cuda:3')
cal_distance is  tensor(175.3124, device='cuda:3')
cal ratio is  0.9504241579084717
distance x is tensor(166.6214, device='cuda:3')
cal_distance is  tensor(166.6214, device='cuda:3')
cal ratio is  0.9748962313133612
distance x is tensor(162.4387, device='cuda:3')
cal_distance is  tensor(162.4387, device='cuda:3')
distance x is tensor(162.4387, device='cuda:3')
return_distance is  tensor(162.4387, device='cuda:3')
distance x is tensor(162.4287, device='cuda:3')
distance x is tensor(162.4287, device='cuda:3')
________________________________
test distance is  tensor(162.4287, device='cuda:3')
test distance1 is  tensor(162.4287, device='cuda:3')
test similarity is  tensor(0.9392, device='cuda:3')
test acc is  0.10000000015633198
test loss is 840.7893544016108
test entropy is  0.0
________________________________
0
distance x is tensor(162.4287, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  840.8863831217101
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9392, device='cuda:3')
compute_distance is  tensor(162.4287, device='cuda:3')
compute_norm is  tensor(51.4205, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(226.0913, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5591195357887984
avg test loss is  2.8503069648864683
avg accuracy is  0.10511666682299864
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.9151, device='cuda:3')
compute_distance is  tensor(226.0913, device='cuda:3')
compute_norm is  tensor(54.0503, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(226.3348, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8366228946998938
avg test loss is  3.5838077650395537
avg accuracy is  0.1050833334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9142, device='cuda:3')
compute_distance is  tensor(226.3348, device='cuda:3')
compute_norm is  tensor(54.1572, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(225.5415, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5532377175430754
avg test loss is  2.850180946941823
avg accuracy is  0.10590000015633197
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.9150, device='cuda:3')
compute_distance is  tensor(225.5415, device='cuda:3')
compute_norm is  tensor(53.5599, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(225.8750, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8358513268707658
avg test loss is  3.5811557340215265
avg accuracy is  0.10516666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9141, device='cuda:3')
compute_distance is  tensor(225.8750, device='cuda:3')
compute_norm is  tensor(53.6689, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(225.2080, device='cuda:3')
distance x is tensor(225.2080, device='cuda:3')
________________________________
test distance is  tensor(225.2080, device='cuda:3')
test distance1 is  tensor(225.2080, device='cuda:3')
test similarity is  tensor(0.9149, device='cuda:3')
test acc is  0.1009833334896653
test loss is 2.8398863753276085
test entropy is  1.5512260503606248
________________________________
cal ratio is  0.8385556608718552
distance x is tensor(188.8540, device='cuda:3')
cal_distance is  tensor(188.8540, device='cuda:3')
cal ratio is  0.9157157613928568
distance x is tensor(172.9368, device='cuda:3')
cal_distance is  tensor(172.9368, device='cuda:3')
cal ratio is  0.9569297693999308
distance x is tensor(165.4885, device='cuda:3')
cal_distance is  tensor(165.4885, device='cuda:3')
cal ratio is  0.9782275622529405
distance x is tensor(161.8855, device='cuda:3')
cal_distance is  tensor(161.8855, device='cuda:3')
distance x is tensor(161.8855, device='cuda:3')
return_distance is  tensor(161.8855, device='cuda:3')
distance x is tensor(161.8804, device='cuda:3')
distance x is tensor(161.8804, device='cuda:3')
________________________________
test distance is  tensor(161.8804, device='cuda:3')
test distance1 is  tensor(161.8804, device='cuda:3')
test similarity is  tensor(0.9528, device='cuda:3')
test acc is  0.10300000015633197
test loss is 2.492190057534907
test entropy is  2.0455017781206792
________________________________
0
distance x is tensor(161.8804, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.0455194454965815
avg test loss is  2.4916639795689695
avg accuracy is  0.12698333348966526
solo acc is  0.10330000015633196
compute similarity  is  tensor(0.9528, device='cuda:3')
compute_distance is  tensor(161.8804, device='cuda:3')
compute_norm is  tensor(50.7508, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(163.4137, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8318767727438067
avg test loss is  3.5415097825816955
avg accuracy is  0.1121666668229986
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9510, device='cuda:3')
compute_distance is  tensor(163.4137, device='cuda:3')
compute_norm is  tensor(51.0585, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(166.6046, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.3418396712620375
avg test loss is  2.33172106412428
avg accuracy is  0.19215000015633601
solo acc is  0.13001666682299856
compute similarity  is  tensor(0.9517, device='cuda:3')
compute_distance is  tensor(166.6046, device='cuda:3')
compute_norm is  tensor(50.5630, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(168.0647, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.753357935498264
avg test loss is  2.993648468558468
avg accuracy is  0.12180000015633193
solo acc is  0.1012833334896653
compute similarity  is  tensor(0.9509, device='cuda:3')
compute_distance is  tensor(168.0647, device='cuda:3')
compute_norm is  tensor(50.5751, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(170.0389, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.1469776368598694
avg test loss is  1.9677338914068014
avg accuracy is  0.21261666682300365
solo acc is  0.1600666668230007
compute similarity  is  tensor(0.9514, device='cuda:3')
compute_distance is  tensor(170.0389, device='cuda:3')
compute_norm is  tensor(50.1441, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(170.7807, device='cuda:3')
distance x is tensor(170.7807, device='cuda:3')
________________________________
test distance is  tensor(170.7807, device='cuda:3')
test distance1 is  tensor(170.7807, device='cuda:3')
test similarity is  tensor(0.9510, device='cuda:3')
test acc is  0.1023833334896653
test loss is 2.6827544027300023
test entropy is  0.6714460257528179
________________________________
cal ratio is  0.9629515265899486
distance x is tensor(164.4577, device='cuda:3')
cal_distance is  tensor(164.4577, device='cuda:3')
distance x is tensor(164.4577, device='cuda:3')
return_distance is  tensor(164.4577, device='cuda:3')
distance x is tensor(164.4534, device='cuda:3')
distance x is tensor(164.4534, device='cuda:3')
________________________________
test distance is  tensor(164.4534, device='cuda:3')
test distance1 is  tensor(164.4534, device='cuda:3')
test similarity is  tensor(0.9544, device='cuda:3')
test acc is  0.10166666682299863
test loss is 2.527633626832128
test entropy is  0.7840444555541853
________________________________
0
distance x is tensor(164.4534, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.7852724524322094
avg test loss is  2.528604058822843
avg accuracy is  0.18996666682300253
solo acc is  0.10190000015633197
compute similarity  is  tensor(0.9544, device='cuda:3')
compute_distance is  tensor(164.4534, device='cuda:3')
compute_norm is  tensor(49.8559, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(166.3496, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0213707049391163
avg test loss is  1.7112079766005086
avg accuracy is  0.2234833334896707
solo acc is  0.215550000156337
compute similarity  is  tensor(0.9542, device='cuda:3')
compute_distance is  tensor(166.3496, device='cuda:3')
compute_norm is  tensor(49.5395, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(167.0579, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.622072113221134
avg test loss is  2.4630322931671955
avg accuracy is  0.20080000015633645
solo acc is  0.1018833334896653
compute similarity  is  tensor(0.9539, device='cuda:3')
compute_distance is  tensor(167.0579, device='cuda:3')
compute_norm is  tensor(49.3814, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(168.4726, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9638496922023261
avg test loss is  1.514345442054114
avg accuracy is  0.23251666682300445
solo acc is  0.23995000015633797
compute similarity  is  tensor(0.9537, device='cuda:3')
compute_distance is  tensor(168.4726, device='cuda:3')
compute_norm is  tensor(49.1020, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(168.4769, device='cuda:3')
________________________________
test distance is  tensor(168.4769, device='cuda:3')
test similarity is  tensor(0.9537, device='cuda:3')
test acc is  0.23326666682300448
test loss is 1.5110919062516837
test entropy is  0.9639662135638662
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2497539520263672
mal norm is  tensor(670.1819, device='cuda:3')
distance x is tensor(168.4769, device='cuda:3')
mal distance is  tensor(168.4769, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([12., 12., 12., 12., 12., 15., 16., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 35., 33., 14., 24., 14., 12., 32., 35.,
        12., 18., 13., 12., 28., 34., 12., 35.])
count_res tensor([2.8873e-11, 2.8873e-11, 2.8873e-11, 2.8873e-11, 2.8873e-11, 5.7993e-10,
        1.5764e-09, 2.8873e-11, 4.6992e-06, 4.6992e-06, 4.6992e-06, 4.6992e-06,
        4.6992e-06, 4.6992e-06, 4.6992e-06, 4.6992e-06, 4.6992e-06, 4.6992e-06,
        4.6992e-06, 4.6992e-06, 2.8136e-01, 3.8078e-02, 2.1334e-10, 4.6992e-06,
        2.1334e-10, 2.8873e-11, 1.4008e-02, 2.8136e-01, 2.8873e-11, 1.1648e-08,
        7.8485e-11, 2.8873e-11, 2.5657e-04, 1.0351e-01, 2.8873e-11, 2.8136e-01])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 89.73% 

Test Accuracy: 89.10% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7479962706565857
distance x is tensor(115.7911, device='cuda:3')
benign distance is  tensor(115.7911, device='cuda:3')
norm1 res is  tensor(513.0402, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3254311680793762
distance x is tensor(113.0990, device='cuda:3')
benign distance is  tensor(113.0990, device='cuda:3')
norm1 res is  tensor(506.1744, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1783277541399002
distance x is tensor(119.2497, device='cuda:3')
benign distance is  tensor(119.2497, device='cuda:3')
norm1 res is  tensor(518.4172, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3795905113220215
distance x is tensor(96.1236, device='cuda:3')
benign distance is  tensor(96.1236, device='cuda:3')
norm1 res is  tensor(413.9055, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4643217623233795
distance x is tensor(89.5459, device='cuda:3')
benign distance is  tensor(89.5459, device='cuda:3')
norm1 res is  tensor(388.1982, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9282984733581543
distance x is tensor(120.9431, device='cuda:3')
benign distance is  tensor(120.9431, device='cuda:3')
norm1 res is  tensor(535.0371, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6791790127754211
distance x is tensor(110.6748, device='cuda:3')
benign distance is  tensor(110.6748, device='cuda:3')
norm1 res is  tensor(490.9642, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.14437825977802277
distance x is tensor(102.5061, device='cuda:3')
benign distance is  tensor(102.5061, device='cuda:3')
norm1 res is  tensor(455.2588, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4714498519897461
distance x is tensor(121.9477, device='cuda:3')
benign distance is  tensor(121.9477, device='cuda:3')
norm1 res is  tensor(535.0817, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3996744155883789
distance x is tensor(111.3681, device='cuda:3')
benign distance is  tensor(111.3681, device='cuda:3')
norm1 res is  tensor(495.0974, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5010766386985779
distance x is tensor(105.4918, device='cuda:3')
benign distance is  tensor(105.4918, device='cuda:3')
norm1 res is  tensor(468.8514, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7191841006278992
distance x is tensor(115.9642, device='cuda:3')
benign distance is  tensor(115.9642, device='cuda:3')
norm1 res is  tensor(513.0353, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.35942646861076355
distance x is tensor(110.0363, device='cuda:3')
benign distance is  tensor(110.0363, device='cuda:3')
norm1 res is  tensor(491.1290, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6518138647079468
distance x is tensor(94.4309, device='cuda:3')
benign distance is  tensor(94.4309, device='cuda:3')
norm1 res is  tensor(426.7914, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3858826756477356
distance x is tensor(112.7161, device='cuda:3')
benign distance is  tensor(112.7161, device='cuda:3')
norm1 res is  tensor(515.7336, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9912541508674622
distance x is tensor(77.4794, device='cuda:3')
benign distance is  tensor(77.4794, device='cuda:3')
norm1 res is  tensor(341.6001, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.5631516575813293
distance x is tensor(96.9274, device='cuda:3')
benign distance is  tensor(96.9274, device='cuda:3')
norm1 res is  tensor(440.6073, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.8491390347480774
distance x is tensor(95.4588, device='cuda:3')
benign distance is  tensor(95.4588, device='cuda:3')
norm1 res is  tensor(414.1072, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.42379164695739746
distance x is tensor(113.8486, device='cuda:3')
benign distance is  tensor(113.8486, device='cuda:3')
norm1 res is  tensor(496.1859, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.8770536184310913
distance x is tensor(109.5193, device='cuda:3')
benign distance is  tensor(109.5193, device='cuda:3')
norm1 res is  tensor(477.9606, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.1205912828445435
distance x is tensor(112.4717, device='cuda:3')
benign distance is  tensor(112.4717, device='cuda:3')
norm1 res is  tensor(481.8621, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6663205027580261
distance x is tensor(125.0427, device='cuda:3')
benign distance is  tensor(125.0427, device='cuda:3')
norm1 res is  tensor(556.8259, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6571331024169922
distance x is tensor(116.1645, device='cuda:3')
benign distance is  tensor(116.1645, device='cuda:3')
norm1 res is  tensor(524.5148, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.7820172309875488
distance x is tensor(109.8014, device='cuda:3')
benign distance is  tensor(109.8014, device='cuda:3')
norm1 res is  tensor(484.5414, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(110.0372, device='cuda:3')
compute distance is  tensor(110.0372, device='cuda:3')
compute norm is  tensor(52.0964, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.0300, device='cuda:3')
compute distance is  tensor(105.0300, device='cuda:3')
compute norm is  tensor(52.0524, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.0807, device='cuda:3')
compute distance is  tensor(108.0807, device='cuda:3')
compute norm is  tensor(52.2437, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.2655, device='cuda:3')
compute distance is  tensor(105.2655, device='cuda:3')
compute norm is  tensor(52.0623, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.5494, device='cuda:3')
compute distance is  tensor(126.5494, device='cuda:3')
compute norm is  tensor(52.3730, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.4666, device='cuda:3')
compute distance is  tensor(105.4666, device='cuda:3')
compute norm is  tensor(52.1056, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.8763, device='cuda:3')
compute distance is  tensor(116.8763, device='cuda:3')
compute norm is  tensor(52.2241, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.2591, device='cuda:3')
compute distance is  tensor(111.2591, device='cuda:3')
compute norm is  tensor(52.1039, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.3033, device='cuda:3')
compute distance is  tensor(118.3033, device='cuda:3')
compute norm is  tensor(52.2255, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.4384, device='cuda:3')
compute distance is  tensor(123.4384, device='cuda:3')
compute norm is  tensor(52.3905, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.5426, device='cuda:3')
compute distance is  tensor(124.5426, device='cuda:3')
compute norm is  tensor(52.3796, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.1541, device='cuda:3')
compute distance is  tensor(113.1541, device='cuda:3')
compute norm is  tensor(52.2439, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(126.5494, device='cuda:3')
distance x is tensor(106232.5938, device='cuda:3')
distance x is tensor(106232.5938, device='cuda:3')
________________________________
test distance is  tensor(106232.5938, device='cuda:3')
test distance1 is  tensor(106232.5938, device='cuda:3')
test similarity is  tensor(-0.0971, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139285862179112.94
test entropy is  0.0
________________________________
cal ratio is  0.03382417912064577
distance x is tensor(3593.2358, device='cuda:3')
cal_distance is  tensor(3593.2358, device='cuda:3')
cal ratio is  0.18391336569879516
distance x is tensor(660.8481, device='cuda:3')
cal_distance is  tensor(660.8481, device='cuda:3')
cal ratio is  0.42884992388755405
distance x is tensor(283.4076, device='cuda:3')
cal_distance is  tensor(283.4076, device='cuda:3')
cal ratio is  0.654862968892788
distance x is tensor(185.5949, device='cuda:3')
cal_distance is  tensor(185.5949, device='cuda:3')
cal ratio is  0.809232245356843
distance x is tensor(150.1903, device='cuda:3')
cal_distance is  tensor(150.1903, device='cuda:3')
cal ratio is  0.8995704629477118
distance x is tensor(135.1073, device='cuda:3')
cal_distance is  tensor(135.1073, device='cuda:3')
cal ratio is  0.9484551785249603
distance x is tensor(128.1434, device='cuda:3')
cal_distance is  tensor(128.1434, device='cuda:3')
cal ratio is  0.973885605016583
distance x is tensor(124.7972, device='cuda:3')
cal_distance is  tensor(124.7972, device='cuda:3')
distance x is tensor(124.7972, device='cuda:3')
return_distance is  tensor(124.7972, device='cuda:3')
distance x is tensor(124.7872, device='cuda:3')
distance x is tensor(124.7872, device='cuda:3')
________________________________
test distance is  tensor(124.7872, device='cuda:3')
test distance1 is  tensor(124.7872, device='cuda:3')
test similarity is  tensor(0.9618, device='cuda:3')
test acc is  0.10000000015633198
test loss is 314.920249011725
test entropy is  3.308025813919797e-35
________________________________
0
distance x is tensor(124.7872, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.791736007669766e-35
avg test loss is  315.02336826609144
avg accuracy is  0.343966666823007
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9618, device='cuda:3')
compute_distance is  tensor(124.7872, device='cuda:3')
compute_norm is  tensor(51.3207, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(110.8280, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8037846955790449
avg test loss is  1.4392744090511347
avg accuracy is  0.8688500001563225
solo acc is  0.2930833334896727
compute similarity  is  tensor(0.9653, device='cuda:3')
compute_distance is  tensor(110.8280, device='cuda:3')
compute_norm is  tensor(50.0901, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(113.8552, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7859931267273705
avg test loss is  1.4289722882354183
avg accuracy is  0.8702500001563224
solo acc is  0.2545500001563384
compute similarity  is  tensor(0.9647, device='cuda:3')
compute_distance is  tensor(113.8552, device='cuda:3')
compute_norm is  tensor(49.7701, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(116.6172, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7752205221764823
avg test loss is  1.4030673000604106
avg accuracy is  0.871916666822989
solo acc is  0.24021666682300455
compute similarity  is  tensor(0.9641, device='cuda:3')
compute_distance is  tensor(116.6172, device='cuda:3')
compute_norm is  tensor(49.4756, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(119.0933, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7826165337044039
avg test loss is  1.3455344391530002
avg accuracy is  0.8731666668229889
solo acc is  0.24711666682300482
compute similarity  is  tensor(0.9636, device='cuda:3')
compute_distance is  tensor(119.0933, device='cuda:3')
compute_norm is  tensor(49.1964, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(121.5162, device='cuda:3')
distance x is tensor(121.5162, device='cuda:3')
________________________________
test distance is  tensor(121.5162, device='cuda:3')
test distance1 is  tensor(121.5162, device='cuda:3')
test similarity is  tensor(0.9632, device='cuda:3')
test acc is  0.22636666682300416
test loss is 1.3609059064118847
test entropy is  0.7600590927260262
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.3159754276275635
mal norm is  tensor(616.4156, device='cuda:3')
distance x is tensor(121.5230, device='cuda:3')
mal distance is  tensor(121.5230, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([12., 12., 12., 29., 17., 34., 14., 13., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 12., 12., 35., 12., 32., 14., 13., 12.,
        12., 12., 12., 30., 31., 34., 28., 12.])
count_res tensor([5.6565e-11, 5.6565e-11, 5.6565e-11, 1.3663e-03, 8.3949e-09, 2.0278e-01,
        4.1796e-10, 1.5376e-10, 9.2061e-06, 9.2061e-06, 9.2061e-06, 9.2061e-06,
        9.2061e-06, 9.2061e-06, 9.2061e-06, 9.2061e-06, 9.2061e-06, 9.2061e-06,
        9.2061e-06, 9.2061e-06, 5.6565e-11, 5.6565e-11, 5.5121e-01, 5.6565e-11,
        2.7443e-02, 4.1796e-10, 1.5376e-10, 5.6565e-11, 5.6565e-11, 5.6565e-11,
        5.6565e-11, 3.7140e-03, 1.0096e-02, 2.0278e-01, 5.0264e-04, 5.6565e-11])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 89.27% 

Test Accuracy: 89.15% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5556453466415405
distance x is tensor(103.7757, device='cuda:3')
benign distance is  tensor(103.7757, device='cuda:3')
norm1 res is  tensor(462.4162, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8315219879150391
distance x is tensor(116.2969, device='cuda:3')
benign distance is  tensor(116.2969, device='cuda:3')
norm1 res is  tensor(522.0444, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2643398642539978
distance x is tensor(132.9204, device='cuda:3')
benign distance is  tensor(132.9204, device='cuda:3')
norm1 res is  tensor(578.5425, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7384599447250366
distance x is tensor(87.1908, device='cuda:3')
benign distance is  tensor(87.1908, device='cuda:3')
norm1 res is  tensor(369.2954, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5164480209350586
distance x is tensor(91.7867, device='cuda:3')
benign distance is  tensor(91.7867, device='cuda:3')
norm1 res is  tensor(394.4024, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5701224207878113
distance x is tensor(99.2948, device='cuda:3')
benign distance is  tensor(99.2948, device='cuda:3')
norm1 res is  tensor(439.8616, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.24925275146961212
distance x is tensor(114.5009, device='cuda:3')
benign distance is  tensor(114.5009, device='cuda:3')
norm1 res is  tensor(484.4204, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8335675001144409
distance x is tensor(94.9332, device='cuda:3')
benign distance is  tensor(94.9332, device='cuda:3')
norm1 res is  tensor(413.5132, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.7290723919868469
distance x is tensor(123.0574, device='cuda:3')
benign distance is  tensor(123.0574, device='cuda:3')
norm1 res is  tensor(541.9902, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.11655855178833
distance x is tensor(127.5360, device='cuda:3')
benign distance is  tensor(127.5360, device='cuda:3')
norm1 res is  tensor(566.9008, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.21828095614910126
distance x is tensor(119.9240, device='cuda:3')
benign distance is  tensor(119.9240, device='cuda:3')
norm1 res is  tensor(525.6249, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.517443835735321
distance x is tensor(100.3303, device='cuda:3')
benign distance is  tensor(100.3303, device='cuda:3')
norm1 res is  tensor(440.0516, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.24692273139953613
distance x is tensor(92.8214, device='cuda:3')
benign distance is  tensor(92.8214, device='cuda:3')
norm1 res is  tensor(395.5533, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9795126914978027
distance x is tensor(92.6297, device='cuda:3')
benign distance is  tensor(92.6297, device='cuda:3')
norm1 res is  tensor(410.1320, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.05762047693133354
distance x is tensor(102.8045, device='cuda:3')
benign distance is  tensor(102.8045, device='cuda:3')
norm1 res is  tensor(438.1988, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7983502149581909
distance x is tensor(119.5932, device='cuda:3')
benign distance is  tensor(119.5932, device='cuda:3')
norm1 res is  tensor(515.8333, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.5111886262893677
distance x is tensor(112.7255, device='cuda:3')
benign distance is  tensor(112.7255, device='cuda:3')
norm1 res is  tensor(497.9969, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.2560143768787384
distance x is tensor(116.3792, device='cuda:3')
benign distance is  tensor(116.3792, device='cuda:3')
norm1 res is  tensor(533.5988, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.8654066324234009
distance x is tensor(37.3896, device='cuda:3')
benign distance is  tensor(37.3896, device='cuda:3')
norm1 res is  tensor(158.2288, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.15943586826324463
distance x is tensor(132.7092, device='cuda:3')
benign distance is  tensor(132.7092, device='cuda:3')
norm1 res is  tensor(580.3004, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.2649599313735962
distance x is tensor(116.3831, device='cuda:3')
benign distance is  tensor(116.3831, device='cuda:3')
norm1 res is  tensor(506.0166, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.35979318618774414
distance x is tensor(115.5346, device='cuda:3')
benign distance is  tensor(115.5346, device='cuda:3')
norm1 res is  tensor(498.3250, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.8275560140609741
distance x is tensor(108.5995, device='cuda:3')
benign distance is  tensor(108.5995, device='cuda:3')
norm1 res is  tensor(481.2638, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.5497639179229736
distance x is tensor(122.2871, device='cuda:3')
benign distance is  tensor(122.2871, device='cuda:3')
norm1 res is  tensor(508.8784, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(120.2210, device='cuda:3')
compute distance is  tensor(120.2210, device='cuda:3')
compute norm is  tensor(52.1652, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.6106, device='cuda:3')
compute distance is  tensor(110.6106, device='cuda:3')
compute norm is  tensor(52.0545, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.0400, device='cuda:3')
compute distance is  tensor(114.0400, device='cuda:3')
compute norm is  tensor(52.2906, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.9201, device='cuda:3')
compute distance is  tensor(113.9201, device='cuda:3')
compute norm is  tensor(52.2545, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.3853, device='cuda:3')
compute distance is  tensor(115.3853, device='cuda:3')
compute norm is  tensor(52.3172, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.7590, device='cuda:3')
compute distance is  tensor(119.7590, device='cuda:3')
compute norm is  tensor(52.3751, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.4012, device='cuda:3')
compute distance is  tensor(114.4012, device='cuda:3')
compute norm is  tensor(52.3185, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.8880, device='cuda:3')
compute distance is  tensor(111.8880, device='cuda:3')
compute norm is  tensor(52.2269, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.4244, device='cuda:3')
compute distance is  tensor(119.4244, device='cuda:3')
compute norm is  tensor(52.3555, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.1297, device='cuda:3')
compute distance is  tensor(117.1297, device='cuda:3')
compute norm is  tensor(52.2144, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.5335, device='cuda:3')
compute distance is  tensor(122.5335, device='cuda:3')
compute norm is  tensor(52.3944, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.0616, device='cuda:3')
compute distance is  tensor(111.0616, device='cuda:3')
compute norm is  tensor(52.1807, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(122.5335, device='cuda:3')
distance x is tensor(106233.1797, device='cuda:3')
distance x is tensor(106233.1797, device='cuda:3')
________________________________
test distance is  tensor(106233.1797, device='cuda:3')
test distance1 is  tensor(106233.1797, device='cuda:3')
test similarity is  tensor(-0.0976, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139310131548884.88
test entropy is  0.0
________________________________
cal ratio is  0.033283068376103495
distance x is tensor(3535.7717, device='cuda:3')
cal_distance is  tensor(3535.7717, device='cuda:3')
cal ratio is  0.18243633731636213
distance x is tensor(645.0573, device='cuda:3')
cal_distance is  tensor(645.0573, device='cuda:3')
cal ratio is  0.4271243174109002
distance x is tensor(275.5226, device='cuda:3')
cal_distance is  tensor(275.5226, device='cuda:3')
cal ratio is  0.6535440688706734
distance x is tensor(180.0679, device='cuda:3')
cal_distance is  tensor(180.0679, device='cuda:3')
cal ratio is  0.8084168148306718
distance x is tensor(145.5709, device='cuda:3')
cal_distance is  tensor(145.5709, device='cuda:3')
cal ratio is  0.8991170436900084
distance x is tensor(130.8858, device='cuda:3')
cal_distance is  tensor(130.8858, device='cuda:3')
cal ratio is  0.9482158999161198
distance x is tensor(124.1082, device='cuda:3')
cal_distance is  tensor(124.1082, device='cuda:3')
cal ratio is  0.973762748558906
distance x is tensor(120.8521, device='cuda:3')
cal_distance is  tensor(120.8521, device='cuda:3')
distance x is tensor(120.8521, device='cuda:3')
return_distance is  tensor(120.8521, device='cuda:3')
distance x is tensor(120.8421, device='cuda:3')
distance x is tensor(120.8421, device='cuda:3')
________________________________
test distance is  tensor(120.8421, device='cuda:3')
test distance1 is  tensor(120.8421, device='cuda:3')
test similarity is  tensor(0.9642, device='cuda:3')
test acc is  0.10000000015633198
test loss is 284.83654568800284
test entropy is  8.601376405320382e-34
________________________________
0
distance x is tensor(120.8421, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.2347234717057164e-34
avg test loss is  284.7853066092615
avg accuracy is  0.41078333348967455
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9642, device='cuda:3')
compute_distance is  tensor(120.8421, device='cuda:3')
compute_norm is  tensor(51.3076, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(109.6904, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8209472036819214
avg test loss is  1.4447483870266342
avg accuracy is  0.857300000156323
solo acc is  0.2988666668230061
compute similarity  is  tensor(0.9671, device='cuda:3')
compute_distance is  tensor(109.6904, device='cuda:3')
compute_norm is  tensor(50.0397, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(112.9912, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7889048548014179
avg test loss is  1.475010372555332
avg accuracy is  0.857850000156323
solo acc is  0.24053333348967126
compute similarity  is  tensor(0.9664, device='cuda:3')
compute_distance is  tensor(112.9912, device='cuda:3')
compute_norm is  tensor(49.7117, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.6985, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7823870680860873
avg test loss is  1.4231177928096959
avg accuracy is  0.8596666668229895
solo acc is  0.23343333348967102
compute similarity  is  tensor(0.9659, device='cuda:3')
compute_distance is  tensor(115.6985, device='cuda:3')
compute_norm is  tensor(49.4131, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(118.0597, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7980501079228896
avg test loss is  1.3468708680001402
avg accuracy is  0.8629166668229894
solo acc is  0.24663333348967148
compute similarity  is  tensor(0.9654, device='cuda:3')
compute_distance is  tensor(118.0597, device='cuda:3')
compute_norm is  tensor(49.1302, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(120.3328, device='cuda:3')
distance x is tensor(120.3328, device='cuda:3')
________________________________
test distance is  tensor(120.3328, device='cuda:3')
test distance1 is  tensor(120.3328, device='cuda:3')
test similarity is  tensor(0.9650, device='cuda:3')
test acc is  0.22963333348967088
test loss is 1.3382224548600121
test entropy is  0.7890673132339266
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.1658153533935547
mal norm is  tensor(602.2635, device='cuda:3')
distance x is tensor(120.3392, device='cuda:3')
mal distance is  tensor(120.3392, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([27., 12., 26., 12., 12., 16., 27., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 12., 12., 12., 12., 12., 12.])
count_res tensor([4.2228e-01, 1.2918e-07, 1.5535e-01, 1.2918e-07, 1.2918e-07, 7.0528e-06,
        4.2228e-01, 1.2918e-07, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06,
        7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06,
        7.0528e-06, 7.0528e-06, 1.2918e-07, 1.2918e-07, 1.2918e-07, 1.2918e-07,
        1.2918e-07, 1.2918e-07, 1.2918e-07, 1.2918e-07])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 89.56% 

Test Accuracy: 88.95% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.09000184386968613
distance x is tensor(94.5334, device='cuda:3')
benign distance is  tensor(94.5334, device='cuda:3')
norm1 res is  tensor(399.3575, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.519450306892395
distance x is tensor(110.0152, device='cuda:3')
benign distance is  tensor(110.0152, device='cuda:3')
norm1 res is  tensor(489.2951, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.16752491891384125
distance x is tensor(108.4023, device='cuda:3')
benign distance is  tensor(108.4023, device='cuda:3')
norm1 res is  tensor(480.4736, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.42916640639305115
distance x is tensor(109.8546, device='cuda:3')
benign distance is  tensor(109.8546, device='cuda:3')
norm1 res is  tensor(470.7733, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5606611967086792
distance x is tensor(88.8199, device='cuda:3')
benign distance is  tensor(88.8199, device='cuda:3')
norm1 res is  tensor(369.6379, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5605279803276062
distance x is tensor(108.2153, device='cuda:3')
benign distance is  tensor(108.2153, device='cuda:3')
norm1 res is  tensor(464.6891, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.27061811089515686
distance x is tensor(72.8803, device='cuda:3')
benign distance is  tensor(72.8803, device='cuda:3')
norm1 res is  tensor(303.7313, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1958966702222824
distance x is tensor(90.8820, device='cuda:3')
benign distance is  tensor(90.8820, device='cuda:3')
norm1 res is  tensor(400.2242, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3258088231086731
distance x is tensor(126.4761, device='cuda:3')
benign distance is  tensor(126.4761, device='cuda:3')
norm1 res is  tensor(559.3386, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.09984467923641205
distance x is tensor(126.9259, device='cuda:3')
benign distance is  tensor(126.9259, device='cuda:3')
norm1 res is  tensor(547.1854, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4241710603237152
distance x is tensor(101.4921, device='cuda:3')
benign distance is  tensor(101.4921, device='cuda:3')
norm1 res is  tensor(445.9868, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0687389373779297
distance x is tensor(127.7819, device='cuda:3')
benign distance is  tensor(127.7819, device='cuda:3')
norm1 res is  tensor(558.7015, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4908333718776703
distance x is tensor(113.9484, device='cuda:3')
benign distance is  tensor(113.9484, device='cuda:3')
norm1 res is  tensor(501.5607, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.12415460497140884
distance x is tensor(110.1927, device='cuda:3')
benign distance is  tensor(110.1927, device='cuda:3')
norm1 res is  tensor(486.8846, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.35585540533065796
distance x is tensor(128.6162, device='cuda:3')
benign distance is  tensor(128.6162, device='cuda:3')
norm1 res is  tensor(557.7466, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1422207355499268
distance x is tensor(112.5258, device='cuda:3')
benign distance is  tensor(112.5258, device='cuda:3')
norm1 res is  tensor(485.6432, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(116.3831, device='cuda:3')
compute distance is  tensor(116.3831, device='cuda:3')
compute norm is  tensor(52.7078, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.1009, device='cuda:3')
compute distance is  tensor(114.1009, device='cuda:3')
compute norm is  tensor(52.6910, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.7485, device='cuda:3')
compute distance is  tensor(112.7485, device='cuda:3')
compute norm is  tensor(52.8494, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.1202, device='cuda:3')
compute distance is  tensor(115.1202, device='cuda:3')
compute norm is  tensor(52.7510, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.8964, device='cuda:3')
compute distance is  tensor(127.8964, device='cuda:3')
compute norm is  tensor(52.8713, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.8945, device='cuda:3')
compute distance is  tensor(124.8945, device='cuda:3')
compute norm is  tensor(53.0703, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.9274, device='cuda:3')
compute distance is  tensor(110.9274, device='cuda:3')
compute norm is  tensor(52.8020, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.9721, device='cuda:3')
compute distance is  tensor(133.9721, device='cuda:3')
compute norm is  tensor(53.0823, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.3272, device='cuda:3')
compute distance is  tensor(120.3272, device='cuda:3')
compute norm is  tensor(52.8359, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.6830, device='cuda:3')
compute distance is  tensor(115.6830, device='cuda:3')
compute norm is  tensor(52.8641, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.9774, device='cuda:3')
compute distance is  tensor(126.9774, device='cuda:3')
compute norm is  tensor(53.0582, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.0250, device='cuda:3')
compute distance is  tensor(118.0250, device='cuda:3')
compute norm is  tensor(52.8262, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(133.9721, device='cuda:3')
distance x is tensor(106237.3984, device='cuda:3')
distance x is tensor(106237.3984, device='cuda:3')
________________________________
test distance is  tensor(106237.3984, device='cuda:3')
test distance1 is  tensor(106237.3984, device='cuda:3')
test similarity is  tensor(-0.0979, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139297687943224.77
test entropy is  0.0
________________________________
cal ratio is  0.03480122520370414
distance x is tensor(3697.1965, device='cuda:3')
cal_distance is  tensor(3697.1965, device='cuda:3')
cal ratio is  0.1865507409928261
distance x is tensor(689.7188, device='cuda:3')
cal_distance is  tensor(689.7188, device='cuda:3')
cal ratio is  0.4319139327098827
distance x is tensor(297.9021, device='cuda:3')
cal_distance is  tensor(297.9021, device='cuda:3')
cal ratio is  0.6571983791707897
distance x is tensor(195.7825, device='cuda:3')
cal_distance is  tensor(195.7825, device='cuda:3')
cal ratio is  0.8106742136155233
distance x is tensor(158.7168, device='cuda:3')
cal_distance is  tensor(158.7168, device='cuda:3')
cal ratio is  0.9003717498720637
distance x is tensor(142.9046, device='cuda:3')
cal_distance is  tensor(142.9046, device='cuda:3')
cal ratio is  0.9488775112700294
distance x is tensor(135.5992, device='cuda:3')
cal_distance is  tensor(135.5992, device='cuda:3')
cal ratio is  0.9741024470528914
distance x is tensor(132.0877, device='cuda:3')
cal_distance is  tensor(132.0877, device='cuda:3')
distance x is tensor(132.0877, device='cuda:3')
return_distance is  tensor(132.0877, device='cuda:3')
distance x is tensor(132.0776, device='cuda:3')
distance x is tensor(132.0776, device='cuda:3')
________________________________
test distance is  tensor(132.0776, device='cuda:3')
test distance1 is  tensor(132.0776, device='cuda:3')
test similarity is  tensor(0.9585, device='cuda:3')
test acc is  0.10000000015633198
test loss is 365.6932190201684
test entropy is  3.052649526686615e-43
________________________________
0
distance x is tensor(132.0776, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  6.398481168110698e-43
avg test loss is  365.6724453013081
avg accuracy is  0.2714833334896722
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9585, device='cuda:3')
compute_distance is  tensor(132.0776, device='cuda:3')
compute_norm is  tensor(51.9854, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(117.4642, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8123573780949436
avg test loss is  1.4398082984027578
avg accuracy is  0.8436000001563234
solo acc is  0.30183333348967295
compute similarity  is  tensor(0.9624, device='cuda:3')
compute_distance is  tensor(117.4642, device='cuda:3')
compute_norm is  tensor(50.7237, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(120.4395, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8000517221910359
avg test loss is  1.433162916189572
avg accuracy is  0.8450833334896567
solo acc is  0.2574000001563384
compute similarity  is  tensor(0.9617, device='cuda:3')
compute_distance is  tensor(120.4395, device='cuda:3')
compute_norm is  tensor(50.3905, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(122.9937, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.803364367818019
avg test loss is  1.3780462834626628
avg accuracy is  0.84911666682299
solo acc is  0.251566666823005
compute similarity  is  tensor(0.9612, device='cuda:3')
compute_distance is  tensor(122.9937, device='cuda:3')
compute_norm is  tensor(50.0906, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(125.2248, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7750827532841452
avg test loss is  1.3879285569129975
avg accuracy is  0.8500833334896565
solo acc is  0.2361333334896711
compute similarity  is  tensor(0.9607, device='cuda:3')
compute_distance is  tensor(125.2248, device='cuda:3')
compute_norm is  tensor(49.8076, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(127.3469, device='cuda:3')
distance x is tensor(127.3469, device='cuda:3')
________________________________
test distance is  tensor(127.3469, device='cuda:3')
test distance1 is  tensor(127.3469, device='cuda:3')
test similarity is  tensor(0.9603, device='cuda:3')
test acc is  0.2367166668230045
test loss is 1.3385920332057644
test entropy is  0.7869236867056727
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.2857403755187988
mal norm is  tensor(648.7470, device='cuda:3')
distance x is tensor(127.3536, device='cuda:3')
mal distance is  tensor(127.3536, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 19.49% 

Test Accuracy: 19.28% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.254417359828949
distance x is tensor(151.2410, device='cuda:3')
benign distance is  tensor(151.2410, device='cuda:3')
norm1 res is  tensor(584.8909, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1693602800369263
distance x is tensor(183.1718, device='cuda:3')
benign distance is  tensor(183.1718, device='cuda:3')
norm1 res is  tensor(701.7402, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6437731981277466
distance x is tensor(175.9936, device='cuda:3')
benign distance is  tensor(175.9936, device='cuda:3')
norm1 res is  tensor(680.1996, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7520056962966919
distance x is tensor(158.0429, device='cuda:3')
benign distance is  tensor(158.0429, device='cuda:3')
norm1 res is  tensor(615.4796, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.45057663321495056
distance x is tensor(161.0861, device='cuda:3')
benign distance is  tensor(161.0861, device='cuda:3')
norm1 res is  tensor(609.6718, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5940015316009521
distance x is tensor(185.8304, device='cuda:3')
benign distance is  tensor(185.8304, device='cuda:3')
norm1 res is  tensor(727.4014, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4231281876564026
distance x is tensor(164.9988, device='cuda:3')
benign distance is  tensor(164.9988, device='cuda:3')
norm1 res is  tensor(622.3920, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8557853698730469
distance x is tensor(177.2856, device='cuda:3')
benign distance is  tensor(177.2856, device='cuda:3')
norm1 res is  tensor(689.3843, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(158.6315, device='cuda:3')
compute distance is  tensor(158.6315, device='cuda:3')
compute norm is  tensor(51.0641, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.4933, device='cuda:3')
compute distance is  tensor(165.4933, device='cuda:3')
compute norm is  tensor(51.4478, device='cuda:3', dtype=torch.float64)
distance x is tensor(177.9004, device='cuda:3')
compute distance is  tensor(177.9004, device='cuda:3')
compute norm is  tensor(51.7224, device='cuda:3', dtype=torch.float64)
distance x is tensor(173.9801, device='cuda:3')
compute distance is  tensor(173.9801, device='cuda:3')
compute norm is  tensor(51.5683, device='cuda:3', dtype=torch.float64)
distance x is tensor(175.3107, device='cuda:3')
compute distance is  tensor(175.3107, device='cuda:3')
compute norm is  tensor(51.8058, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.4136, device='cuda:3')
compute distance is  tensor(161.4136, device='cuda:3')
compute norm is  tensor(51.5433, device='cuda:3', dtype=torch.float64)
distance x is tensor(184.8507, device='cuda:3')
compute distance is  tensor(184.8507, device='cuda:3')
compute norm is  tensor(51.7274, device='cuda:3', dtype=torch.float64)
distance x is tensor(177.3163, device='cuda:3')
compute distance is  tensor(177.3163, device='cuda:3')
compute norm is  tensor(51.7394, device='cuda:3', dtype=torch.float64)
distance x is tensor(173.6645, device='cuda:3')
compute distance is  tensor(173.6645, device='cuda:3')
compute norm is  tensor(51.7353, device='cuda:3', dtype=torch.float64)
distance x is tensor(175.1569, device='cuda:3')
compute distance is  tensor(175.1569, device='cuda:3')
compute norm is  tensor(51.6045, device='cuda:3', dtype=torch.float64)
distance x is tensor(173.9017, device='cuda:3')
compute distance is  tensor(173.9017, device='cuda:3')
compute norm is  tensor(51.7682, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.7905, device='cuda:3')
compute distance is  tensor(161.7905, device='cuda:3')
compute norm is  tensor(51.3640, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(184.8507, device='cuda:3')
distance x is tensor(106161.7578, device='cuda:3')
distance x is tensor(106161.7578, device='cuda:3')
________________________________
test distance is  tensor(106161.7578, device='cuda:3')
test distance1 is  tensor(106161.7578, device='cuda:3')
test similarity is  tensor(0.1434, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139277913847829.83
test entropy is  0.0
________________________________
cal ratio is  0.040893338412381935
distance x is tensor(4341.3145, device='cuda:3')
cal_distance is  tensor(4341.3145, device='cuda:3')
cal ratio is  0.20222088323351325
distance x is tensor(877.9084, device='cuda:3')
cal_distance is  tensor(877.9084, device='cuda:3')
cal ratio is  0.44968873432724327
distance x is tensor(394.7883, device='cuda:3')
cal_distance is  tensor(394.7883, device='cuda:3')
cal ratio is  0.6705859775957624
distance x is tensor(264.7411, device='cuda:3')
cal_distance is  tensor(264.7411, device='cuda:3')
cal ratio is  0.8188906131875328
distance x is tensor(216.7950, device='cuda:3')
cal_distance is  tensor(216.7950, device='cuda:3')
cal ratio is  0.9049238134029283
distance x is tensor(196.1834, device='cuda:3')
cal_distance is  tensor(196.1834, device='cuda:3')
cal ratio is  0.9512736273574479
distance x is tensor(186.6243, device='cuda:3')
cal_distance is  tensor(186.6243, device='cuda:3')
cal ratio is  0.9753320002539131
distance x is tensor(182.0208, device='cuda:3')
cal_distance is  tensor(182.0208, device='cuda:3')
distance x is tensor(182.0208, device='cuda:3')
return_distance is  tensor(182.0208, device='cuda:3')
distance x is tensor(182.0108, device='cuda:3')
distance x is tensor(182.0108, device='cuda:3')
________________________________
test distance is  tensor(182.0108, device='cuda:3')
test distance1 is  tensor(182.0108, device='cuda:3')
test similarity is  tensor(0.9323, device='cuda:3')
test acc is  0.10000000015633198
test loss is 1084.633535356664
test entropy is  0.0
________________________________
0
distance x is tensor(182.0108, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  1084.708838619403
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9323, device='cuda:3')
compute_distance is  tensor(182.0108, device='cuda:3')
compute_norm is  tensor(53.5493, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(527.5318, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.559761881828308
avg test loss is  2.852153532286443
avg accuracy is  0.12990000015633194
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5539, device='cuda:3')
compute_distance is  tensor(527.5318, device='cuda:3')
compute_norm is  tensor(86.8945, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(526.0786, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8372949361801147
avg test loss is  3.5847262873578427
avg accuracy is  0.07393333348966542
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5539, device='cuda:3')
compute_distance is  tensor(526.0786, device='cuda:3')
compute_norm is  tensor(86.8532, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(523.7428, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5541555881500244
avg test loss is  2.8517397014316974
avg accuracy is  0.1289666668229986
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5539, device='cuda:3')
compute_distance is  tensor(523.7428, device='cuda:3')
compute_norm is  tensor(86.0965, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(522.3772, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8373233675956726
avg test loss is  3.5808977574936107
avg accuracy is  0.07211666682299878
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5539, device='cuda:3')
compute_distance is  tensor(522.3772, device='cuda:3')
compute_norm is  tensor(86.0606, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(520.1142, device='cuda:3')
distance x is tensor(520.1142, device='cuda:3')
________________________________
test distance is  tensor(520.1142, device='cuda:3')
test distance1 is  tensor(520.1142, device='cuda:3')
test similarity is  tensor(0.5539, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.851819562505303
test entropy is  1.5537346601486206
________________________________
cal ratio is  0.5842345837173932
distance x is tensor(303.8707, device='cuda:3')
cal_distance is  tensor(303.8707, device='cuda:3')
cal ratio is  0.764349927779545
distance x is tensor(232.2638, device='cuda:3')
cal_distance is  tensor(232.2638, device='cuda:3')
cal ratio is  0.8742705383915386
distance x is tensor(203.0616, device='cuda:3')
cal_distance is  tensor(203.0616, device='cuda:3')
cal ratio is  0.9350239086536718
distance x is tensor(189.8675, device='cuda:3')
cal_distance is  tensor(189.8675, device='cuda:3')
cal ratio is  0.9669661842260125
distance x is tensor(183.5955, device='cuda:3')
cal_distance is  tensor(183.5955, device='cuda:3')
distance x is tensor(183.5955, device='cuda:3')
return_distance is  tensor(183.5955, device='cuda:3')
distance x is tensor(183.5930, device='cuda:3')
distance x is tensor(183.5930, device='cuda:3')
________________________________
test distance is  tensor(183.5930, device='cuda:3')
test distance1 is  tensor(183.5930, device='cuda:3')
test similarity is  tensor(0.8777, device='cuda:3')
test acc is  0.1441000001563327
test loss is 2.931671213239495
test entropy is  1.7916500131204438
________________________________
0
distance x is tensor(183.5930, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.790318553000371
avg test loss is  2.931988248692901
avg accuracy is  0.11310000015633195
solo acc is  0.144583333489666
compute similarity  is  tensor(0.8777, device='cuda:3')
compute_distance is  tensor(183.5930, device='cuda:3')
compute_norm is  tensor(57.6767, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(187.2941, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7183522556000935
avg test loss is  2.902426263416754
avg accuracy is  0.14093333348966572
solo acc is  0.10180000015633196
compute similarity  is  tensor(0.8769, device='cuda:3')
compute_distance is  tensor(187.2941, device='cuda:3')
compute_norm is  tensor(57.6100, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(190.1699, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0524624059957737
avg test loss is  1.7498789898622265
avg accuracy is  0.1442000001563327
solo acc is  0.16296666682300084
compute similarity  is  tensor(0.8763, device='cuda:3')
compute_distance is  tensor(190.1699, device='cuda:3')
compute_norm is  tensor(57.3487, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(190.7317, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6284666652999708
avg test loss is  2.4767607433963685
avg accuracy is  0.13001666682299856
solo acc is  0.10101666682299863
compute similarity  is  tensor(0.8761, device='cuda:3')
compute_distance is  tensor(190.7317, device='cuda:3')
compute_norm is  tensor(57.1244, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(192.1368, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9508037954759496
avg test loss is  1.5526293870736796
avg accuracy is  0.13693333348966524
solo acc is  0.21055000015633676
compute similarity  is  tensor(0.8757, device='cuda:3')
compute_distance is  tensor(192.1368, device='cuda:3')
compute_norm is  tensor(56.8318, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(192.1368, device='cuda:3')
distance x is tensor(192.1368, device='cuda:3')
________________________________
test distance is  tensor(192.1368, device='cuda:3')
test distance1 is  tensor(192.1368, device='cuda:3')
test similarity is  tensor(0.8757, device='cuda:3')
test acc is  0.21363333348967023
test loss is 1.5506067934320933
test entropy is  0.9506648845001578
________________________________
cal ratio is  0.9612389192574989
distance x is tensor(184.6909, device='cuda:3')
cal_distance is  tensor(184.6909, device='cuda:3')
distance x is tensor(184.6909, device='cuda:3')
return_distance is  tensor(184.6909, device='cuda:3')
distance x is tensor(184.6893, device='cuda:3')
distance x is tensor(184.6893, device='cuda:3')
________________________________
test distance is  tensor(184.6893, device='cuda:3')
test distance1 is  tensor(184.6893, device='cuda:3')
test similarity is  tensor(0.8836, device='cuda:3')
test acc is  0.18008333348966862
test loss is 1.606398791265386
test entropy is  0.9424011266943234
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.3596322536468506
mal norm is  tensor(1183.1272, device='cuda:3')
distance x is tensor(184.6909, device='cuda:3')
mal distance is  tensor(184.6909, device='cuda:3')
user_PLR len size 52
counter_tensor is  tensor([26., 25., 27., 26., 46., 46., 27., 27., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 43., 51., 36., 48., 20., 33., 33., 13.,
        20., 42., 12., 14., 25., 22., 39., 48., 50., 48., 49., 46., 19., 47.,
        16., 42., 19., 22., 50., 12., 33., 20., 15., 19.])
count_res tensor([6.7425e-12, 2.4804e-12, 1.8328e-11, 6.7425e-12, 3.2712e-03, 3.2712e-03,
        1.8328e-11, 1.8328e-11, 8.1085e-06, 8.1085e-06, 8.1085e-06, 8.1085e-06,
        8.1085e-06, 8.1085e-06, 8.1085e-06, 8.1085e-06, 8.1085e-06, 8.1085e-06,
        8.1085e-06, 8.1085e-06, 1.6286e-04, 4.8549e-01, 1.4851e-07, 2.4171e-02,
        1.6713e-14, 7.3940e-09, 7.3940e-09, 1.5240e-17, 1.6713e-14, 5.9914e-05,
        5.6065e-18, 4.1427e-17, 2.4804e-12, 1.2349e-13, 2.9830e-06, 2.4171e-02,
        1.7860e-01, 2.4171e-02, 6.5704e-02, 3.2712e-03, 6.1483e-15, 8.8921e-03,
        3.0611e-16, 5.9914e-05, 6.1483e-15, 1.2349e-13, 1.7860e-01, 5.6065e-18,
        7.3940e-09, 1.6713e-14, 1.1261e-16, 6.1483e-15])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 89.45% 

Test Accuracy: 88.95% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3305900990962982
distance x is tensor(85.9235, device='cuda:3')
benign distance is  tensor(85.9235, device='cuda:3')
norm1 res is  tensor(378.8521, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5752862691879272
distance x is tensor(95.5936, device='cuda:3')
benign distance is  tensor(95.5936, device='cuda:3')
norm1 res is  tensor(430.1436, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.20808419585227966
distance x is tensor(113.8923, device='cuda:3')
benign distance is  tensor(113.8923, device='cuda:3')
norm1 res is  tensor(483.9850, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5581899881362915
distance x is tensor(91.5916, device='cuda:3')
benign distance is  tensor(91.5916, device='cuda:3')
norm1 res is  tensor(390.1837, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4271763265132904
distance x is tensor(86.9913, device='cuda:3')
benign distance is  tensor(86.9913, device='cuda:3')
norm1 res is  tensor(363.5103, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6924976706504822
distance x is tensor(109.6023, device='cuda:3')
benign distance is  tensor(109.6023, device='cuda:3')
norm1 res is  tensor(470.5253, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.28042730689048767
distance x is tensor(95.9378, device='cuda:3')
benign distance is  tensor(95.9378, device='cuda:3')
norm1 res is  tensor(410.1859, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7718072533607483
distance x is tensor(103.5149, device='cuda:3')
benign distance is  tensor(103.5149, device='cuda:3')
norm1 res is  tensor(453.8791, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3420169949531555
distance x is tensor(116.7240, device='cuda:3')
benign distance is  tensor(116.7240, device='cuda:3')
norm1 res is  tensor(512.3659, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8715158700942993
distance x is tensor(113.4852, device='cuda:3')
benign distance is  tensor(113.4852, device='cuda:3')
norm1 res is  tensor(498.9749, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.46636873483657837
distance x is tensor(100.4110, device='cuda:3')
benign distance is  tensor(100.4110, device='cuda:3')
norm1 res is  tensor(437.5807, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0566327571868896
distance x is tensor(127.3713, device='cuda:3')
benign distance is  tensor(127.3713, device='cuda:3')
norm1 res is  tensor(550.6784, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.1936003565788269
distance x is tensor(107.2125, device='cuda:3')
benign distance is  tensor(107.2125, device='cuda:3')
norm1 res is  tensor(479.3510, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4828644394874573
distance x is tensor(104.7861, device='cuda:3')
benign distance is  tensor(104.7861, device='cuda:3')
norm1 res is  tensor(463.0857, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3229246139526367
distance x is tensor(116.3928, device='cuda:3')
benign distance is  tensor(116.3928, device='cuda:3')
norm1 res is  tensor(512.9240, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8934234380722046
distance x is tensor(99.5300, device='cuda:3')
benign distance is  tensor(99.5300, device='cuda:3')
norm1 res is  tensor(430.1890, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.540319561958313
distance x is tensor(95.2792, device='cuda:3')
benign distance is  tensor(95.2792, device='cuda:3')
norm1 res is  tensor(417.4030, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.3423755168914795
distance x is tensor(123.9192, device='cuda:3')
benign distance is  tensor(123.9192, device='cuda:3')
norm1 res is  tensor(539.9971, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.42550578713417053
distance x is tensor(98.4412, device='cuda:3')
benign distance is  tensor(98.4412, device='cuda:3')
norm1 res is  tensor(431.5031, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2936181128025055
distance x is tensor(99.9487, device='cuda:3')
benign distance is  tensor(99.9487, device='cuda:3')
norm1 res is  tensor(439.1844, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5526430010795593
distance x is tensor(93.7697, device='cuda:3')
benign distance is  tensor(93.7697, device='cuda:3')
norm1 res is  tensor(406.8676, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7189660668373108
distance x is tensor(92.2624, device='cuda:3')
benign distance is  tensor(92.2624, device='cuda:3')
norm1 res is  tensor(406.4298, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.482931524515152
distance x is tensor(91.6542, device='cuda:3')
benign distance is  tensor(91.6542, device='cuda:3')
norm1 res is  tensor(399.7755, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.40100163221359253
distance x is tensor(116.4561, device='cuda:3')
benign distance is  tensor(116.4561, device='cuda:3')
norm1 res is  tensor(497.2150, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3768286108970642
distance x is tensor(112.1965, device='cuda:3')
benign distance is  tensor(112.1965, device='cuda:3')
norm1 res is  tensor(502.8658, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.165525197982788
distance x is tensor(99.3109, device='cuda:3')
benign distance is  tensor(99.3109, device='cuda:3')
norm1 res is  tensor(437.6892, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.635805070400238
distance x is tensor(118.3749, device='cuda:3')
benign distance is  tensor(118.3749, device='cuda:3')
norm1 res is  tensor(512.7664, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.28452008962631226
distance x is tensor(117.0853, device='cuda:3')
benign distance is  tensor(117.0853, device='cuda:3')
norm1 res is  tensor(503.7456, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7054693102836609
distance x is tensor(102.0708, device='cuda:3')
benign distance is  tensor(102.0708, device='cuda:3')
norm1 res is  tensor(441.2911, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5754410624504089
distance x is tensor(116.8825, device='cuda:3')
benign distance is  tensor(116.8825, device='cuda:3')
norm1 res is  tensor(512.7372, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.32911911606788635
distance x is tensor(108.3903, device='cuda:3')
benign distance is  tensor(108.3903, device='cuda:3')
norm1 res is  tensor(468.7599, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.21305179595947266
distance x is tensor(116.9811, device='cuda:3')
benign distance is  tensor(116.9811, device='cuda:3')
norm1 res is  tensor(517.0350, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.029325831681489944
distance x is tensor(114.3902, device='cuda:3')
benign distance is  tensor(114.3902, device='cuda:3')
norm1 res is  tensor(509.9749, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.6661801934242249
distance x is tensor(68.3655, device='cuda:3')
benign distance is  tensor(68.3655, device='cuda:3')
norm1 res is  tensor(302.7790, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.062320105731487274
distance x is tensor(108.5561, device='cuda:3')
benign distance is  tensor(108.5561, device='cuda:3')
norm1 res is  tensor(472.9733, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.47410035133361816
distance x is tensor(119.0371, device='cuda:3')
benign distance is  tensor(119.0371, device='cuda:3')
norm1 res is  tensor(514.4303, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5744940638542175
distance x is tensor(109.4027, device='cuda:3')
benign distance is  tensor(109.4027, device='cuda:3')
norm1 res is  tensor(478.5135, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.982225239276886
distance x is tensor(112.7050, device='cuda:3')
benign distance is  tensor(112.7050, device='cuda:3')
norm1 res is  tensor(485.5799, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.5257395505905151
distance x is tensor(106.5208, device='cuda:3')
benign distance is  tensor(106.5208, device='cuda:3')
norm1 res is  tensor(466.9690, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7072514295578003
distance x is tensor(107.3264, device='cuda:3')
benign distance is  tensor(107.3264, device='cuda:3')
norm1 res is  tensor(478.9041, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(106.9504, device='cuda:3')
compute distance is  tensor(106.9504, device='cuda:3')
compute norm is  tensor(52.2535, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.7654, device='cuda:3')
compute distance is  tensor(106.7654, device='cuda:3')
compute norm is  tensor(52.1610, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.5342, device='cuda:3')
compute distance is  tensor(109.5342, device='cuda:3')
compute norm is  tensor(52.4374, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.6033, device='cuda:3')
compute distance is  tensor(104.6033, device='cuda:3')
compute norm is  tensor(52.3494, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.1680, device='cuda:3')
compute distance is  tensor(101.1680, device='cuda:3')
compute norm is  tensor(52.2504, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.7437, device='cuda:3')
compute distance is  tensor(116.7437, device='cuda:3')
compute norm is  tensor(52.4928, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.1713, device='cuda:3')
compute distance is  tensor(113.1713, device='cuda:3')
compute norm is  tensor(52.4587, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.4919, device='cuda:3')
compute distance is  tensor(113.4919, device='cuda:3')
compute norm is  tensor(52.4073, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.0259, device='cuda:3')
compute distance is  tensor(113.0259, device='cuda:3')
compute norm is  tensor(52.3831, device='cuda:3', dtype=torch.float64)
distance x is tensor(93.9718, device='cuda:3')
compute distance is  tensor(93.9718, device='cuda:3')
compute norm is  tensor(52.1703, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.8650, device='cuda:3')
compute distance is  tensor(109.8650, device='cuda:3')
compute norm is  tensor(52.3797, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.8538, device='cuda:3')
compute distance is  tensor(100.8538, device='cuda:3')
compute norm is  tensor(52.2599, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(116.7437, device='cuda:3')
distance x is tensor(106236.6875, device='cuda:3')
distance x is tensor(106236.6875, device='cuda:3')
________________________________
test distance is  tensor(106236.6875, device='cuda:3')
test distance1 is  tensor(106236.6875, device='cuda:3')
test similarity is  tensor(-0.0992, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139262192058228.27
test entropy is  0.0
________________________________
cal ratio is  0.03248668957742372
distance x is tensor(3451.2834, device='cuda:3')
cal_distance is  tensor(3451.2834, device='cuda:3')
cal ratio is  0.1802405104731708
distance x is tensor(622.0652, device='cuda:3')
cal_distance is  tensor(622.0652, device='cuda:3')
cal ratio is  0.42454603293004983
distance x is tensor(264.0982, device='cuda:3')
cal_distance is  tensor(264.0982, device='cuda:3')
cal ratio is  0.6515683895732252
distance x is tensor(172.0798, device='cuda:3')
cal_distance is  tensor(172.0798, device='cuda:3')
cal ratio is  0.8071936669669755
distance x is tensor(138.9027, device='cuda:3')
cal_distance is  tensor(138.9027, device='cuda:3')
cal ratio is  0.8984363742456433
distance x is tensor(124.7958, device='cuda:3')
cal_distance is  tensor(124.7958, device='cuda:3')
cal ratio is  0.9478568687455509
distance x is tensor(118.2888, device='cuda:3')
cal_distance is  tensor(118.2888, device='cuda:3')
cal ratio is  0.973578346606893
distance x is tensor(115.1636, device='cuda:3')
cal_distance is  tensor(115.1636, device='cuda:3')
distance x is tensor(115.1636, device='cuda:3')
return_distance is  tensor(115.1636, device='cuda:3')
distance x is tensor(115.1535, device='cuda:3')
distance x is tensor(115.1535, device='cuda:3')
________________________________
test distance is  tensor(115.1535, device='cuda:3')
test distance1 is  tensor(115.1535, device='cuda:3')
test similarity is  tensor(0.9676, device='cuda:3')
test acc is  0.10000000015633198
test loss is 212.49195259923874
test entropy is  6.444787839716667e-26
________________________________
0
distance x is tensor(115.1535, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  7.277479519647225e-27
avg test loss is  212.51739178232546
avg accuracy is  0.5170833334896755
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9676, device='cuda:3')
compute_distance is  tensor(115.1535, device='cuda:3')
compute_norm is  tensor(51.3901, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(106.4705, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8428112553126776
avg test loss is  1.3730480831696281
avg accuracy is  0.8793833334896554
solo acc is  0.3249166668230067
compute similarity  is  tensor(0.9698, device='cuda:3')
compute_distance is  tensor(106.4705, device='cuda:3')
compute_norm is  tensor(50.1350, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(109.4792, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8001105299255232
avg test loss is  1.4280983846324848
avg accuracy is  0.8800500001563222
solo acc is  0.25420000015633837
compute similarity  is  tensor(0.9692, device='cuda:3')
compute_distance is  tensor(109.4792, device='cuda:3')
compute_norm is  tensor(49.8108, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(111.9685, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8033847261085185
avg test loss is  1.355747549772771
avg accuracy is  0.8817500001563219
solo acc is  0.26183333348967197
compute similarity  is  tensor(0.9687, device='cuda:3')
compute_distance is  tensor(111.9685, device='cuda:3')
compute_norm is  tensor(49.5160, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(114.3300, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7984118220140176
avg test loss is  1.3263521011450143
avg accuracy is  0.8826166668229887
solo acc is  0.25623333348967176
compute similarity  is  tensor(0.9682, device='cuda:3')
compute_distance is  tensor(114.3300, device='cuda:3')
compute_norm is  tensor(49.2365, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(116.5715, device='cuda:3')
distance x is tensor(116.5715, device='cuda:3')
________________________________
test distance is  tensor(116.5715, device='cuda:3')
test distance1 is  tensor(116.5715, device='cuda:3')
test similarity is  tensor(0.9678, device='cuda:3')
test acc is  0.25716666682300515
test loss is 1.291415573627964
test entropy is  0.7994442497616383
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.1016252040863037
mal norm is  tensor(579.6354, device='cuda:3')
distance x is tensor(116.5781, device='cuda:3')
mal distance is  tensor(116.5781, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 22.02% 

Test Accuracy: 20.92% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5829681158065796
distance x is tensor(160.8175, device='cuda:3')
benign distance is  tensor(160.8175, device='cuda:3')
norm1 res is  tensor(630.9788, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9108069539070129
distance x is tensor(165.0401, device='cuda:3')
benign distance is  tensor(165.0401, device='cuda:3')
norm1 res is  tensor(652.6557, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.0680030882358551
distance x is tensor(164.9738, device='cuda:3')
benign distance is  tensor(164.9738, device='cuda:3')
norm1 res is  tensor(647.0241, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.680785059928894
distance x is tensor(145.9548, device='cuda:3')
benign distance is  tensor(145.9548, device='cuda:3')
norm1 res is  tensor(569.4801, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.47503042221069336
distance x is tensor(148.1176, device='cuda:3')
benign distance is  tensor(148.1176, device='cuda:3')
norm1 res is  tensor(574.0157, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5955459475517273
distance x is tensor(170.4004, device='cuda:3')
benign distance is  tensor(170.4004, device='cuda:3')
norm1 res is  tensor(673.1508, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.13832400739192963
distance x is tensor(145.8772, device='cuda:3')
benign distance is  tensor(145.8772, device='cuda:3')
norm1 res is  tensor(574.7650, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8627916574478149
distance x is tensor(161.2956, device='cuda:3')
benign distance is  tensor(161.2956, device='cuda:3')
norm1 res is  tensor(643.2522, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(144.8006, device='cuda:3')
compute distance is  tensor(144.8006, device='cuda:3')
compute norm is  tensor(50.5735, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.7127, device='cuda:3')
compute distance is  tensor(158.7127, device='cuda:3')
compute norm is  tensor(50.8526, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.6669, device='cuda:3')
compute distance is  tensor(153.6669, device='cuda:3')
compute norm is  tensor(50.8520, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.9640, device='cuda:3')
compute distance is  tensor(150.9640, device='cuda:3')
compute norm is  tensor(50.7508, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.1085, device='cuda:3')
compute distance is  tensor(151.1085, device='cuda:3')
compute norm is  tensor(50.8266, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.9685, device='cuda:3')
compute distance is  tensor(162.9685, device='cuda:3')
compute norm is  tensor(50.9404, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.0716, device='cuda:3')
compute distance is  tensor(156.0716, device='cuda:3')
compute norm is  tensor(50.7707, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.5101, device='cuda:3')
compute distance is  tensor(167.5101, device='cuda:3')
compute norm is  tensor(51.0071, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.7449, device='cuda:3')
compute distance is  tensor(148.7449, device='cuda:3')
compute norm is  tensor(50.7325, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.9807, device='cuda:3')
compute distance is  tensor(154.9807, device='cuda:3')
compute norm is  tensor(50.7746, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.0097, device='cuda:3')
compute distance is  tensor(165.0097, device='cuda:3')
compute norm is  tensor(50.9418, device='cuda:3', dtype=torch.float64)
distance x is tensor(174.6284, device='cuda:3')
compute distance is  tensor(174.6284, device='cuda:3')
compute norm is  tensor(51.1355, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(174.6284, device='cuda:3')
distance x is tensor(106169.3750, device='cuda:3')
distance x is tensor(106169.3750, device='cuda:3')
________________________________
test distance is  tensor(106169.3750, device='cuda:3')
test distance1 is  tensor(106169.3750, device='cuda:3')
test similarity is  tensor(0.1150, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139279323062429.2
test entropy is  0.0
________________________________
cal ratio is  0.03974512882139235
distance x is tensor(4219.7212, device='cuda:3')
cal_distance is  tensor(4219.7212, device='cuda:3')
cal ratio is  0.1993616709693186
distance x is tensor(841.2546, device='cuda:3')
cal_distance is  tensor(841.2546, device='cuda:3')
cal ratio is  0.4464983020722954
distance x is tensor(375.6216, device='cuda:3')
cal_distance is  tensor(375.6216, device='cuda:3')
cal ratio is  0.668202759461541
distance x is tensor(250.9931, device='cuda:3')
cal_distance is  tensor(250.9931, device='cuda:3')
cal ratio is  0.8174339717482889
distance x is tensor(205.1712, device='cuda:3')
cal_distance is  tensor(205.1712, device='cuda:3')
cal ratio is  0.9041185514609592
distance x is tensor(185.4995, device='cuda:3')
cal_distance is  tensor(185.4995, device='cuda:3')
cal ratio is  0.9508502216633526
distance x is tensor(176.3825, device='cuda:3')
cal_distance is  tensor(176.3825, device='cuda:3')
cal ratio is  0.9751147858835726
distance x is tensor(171.9933, device='cuda:3')
cal_distance is  tensor(171.9933, device='cuda:3')
distance x is tensor(171.9933, device='cuda:3')
return_distance is  tensor(171.9933, device='cuda:3')
distance x is tensor(171.9833, device='cuda:3')
distance x is tensor(171.9833, device='cuda:3')
________________________________
test distance is  tensor(171.9833, device='cuda:3')
test distance1 is  tensor(171.9833, device='cuda:3')
test similarity is  tensor(0.9353, device='cuda:3')
test acc is  0.10000000015633198
test loss is 867.3707182341293
test entropy is  0.0
________________________________
0
distance x is tensor(171.9833, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  867.3171751107742
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9353, device='cuda:3')
compute_distance is  tensor(171.9833, device='cuda:3')
compute_norm is  tensor(52.4116, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(233.1141, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5596285752141907
avg test loss is  2.85100463661812
avg accuracy is  0.10108333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9100, device='cuda:3')
compute_distance is  tensor(233.1141, device='cuda:3')
compute_norm is  tensor(55.2931, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(233.3196, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.836967201438794
avg test loss is  3.584376470620698
avg accuracy is  0.10510000015633195
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9091, device='cuda:3')
compute_distance is  tensor(233.3196, device='cuda:3')
compute_norm is  tensor(55.3959, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(232.5531, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5542660269147552
avg test loss is  2.85152865803318
avg accuracy is  0.10133333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9099, device='cuda:3')
compute_distance is  tensor(232.5531, device='cuda:3')
compute_norm is  tensor(54.7908, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(232.8710, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8366197767669458
avg test loss is  3.5817419077033428
avg accuracy is  0.1042333334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9090, device='cuda:3')
compute_distance is  tensor(232.8710, device='cuda:3')
compute_norm is  tensor(54.8975, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(232.1918, device='cuda:3')
distance x is tensor(232.1918, device='cuda:3')
________________________________
test distance is  tensor(232.1918, device='cuda:3')
test distance1 is  tensor(232.1918, device='cuda:3')
test similarity is  tensor(0.9099, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8517007454117733
test entropy is  1.5538294315338135
________________________________
cal ratio is  0.8498848714416506
distance x is tensor(197.3411, device='cuda:3')
cal_distance is  tensor(197.3411, device='cuda:3')
cal ratio is  0.9218808742271383
distance x is tensor(181.9251, device='cuda:3')
cal_distance is  tensor(181.9251, device='cuda:3')
cal ratio is  0.9601458048116552
distance x is tensor(174.6748, device='cuda:3')
cal_distance is  tensor(174.6748, device='cuda:3')
cal ratio is  0.9798699650324272
distance x is tensor(171.1586, device='cuda:3')
cal_distance is  tensor(171.1586, device='cuda:3')
distance x is tensor(171.1586, device='cuda:3')
return_distance is  tensor(171.1586, device='cuda:3')
distance x is tensor(171.1535, device='cuda:3')
distance x is tensor(171.1535, device='cuda:3')
________________________________
test distance is  tensor(171.1535, device='cuda:3')
test distance1 is  tensor(171.1535, device='cuda:3')
test similarity is  tensor(0.9474, device='cuda:3')
test acc is  0.10003333348966531
test loss is 2.490555015708338
test entropy is  2.074833698364209
________________________________
0
distance x is tensor(171.1535, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.074854396045335
avg test loss is  2.490540879875866
avg accuracy is  0.10901666682299864
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9474, device='cuda:3')
compute_distance is  tensor(171.1535, device='cuda:3')
compute_norm is  tensor(51.8693, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(172.5141, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8483085528111407
avg test loss is  3.567891932753866
avg accuracy is  0.10565000015633196
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9454, device='cuda:3')
compute_distance is  tensor(172.5141, device='cuda:3')
compute_norm is  tensor(52.1949, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(172.1447, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5552940522429786
avg test loss is  2.845672040097495
avg accuracy is  0.1154166668229986
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9463, device='cuda:3')
compute_distance is  tensor(172.1447, device='cuda:3')
compute_norm is  tensor(51.6194, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(172.9181, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8474776932933946
avg test loss is  3.525835982009546
avg accuracy is  0.11076666682299861
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9452, device='cuda:3')
compute_distance is  tensor(172.9181, device='cuda:3')
compute_norm is  tensor(51.7357, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(174.2294, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.418509917853992
avg test loss is  2.534564719271304
avg accuracy is  0.1393500001563322
solo acc is  0.10010000015633198
compute similarity  is  tensor(0.9457, device='cuda:3')
compute_distance is  tensor(174.2294, device='cuda:3')
compute_norm is  tensor(51.2260, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(175.2199, device='cuda:3')
distance x is tensor(175.2199, device='cuda:3')
________________________________
test distance is  tensor(175.2199, device='cuda:3')
test distance1 is  tensor(175.2199, device='cuda:3')
test similarity is  tensor(0.9448, device='cuda:3')
test acc is  0.10003333348966531
test loss is 3.203680492921679
test entropy is  0.8024227924184251
________________________________
cal ratio is  0.9783444750073955
distance x is tensor(171.4302, device='cuda:3')
cal_distance is  tensor(171.4302, device='cuda:3')
distance x is tensor(171.4302, device='cuda:3')
return_distance is  tensor(171.4302, device='cuda:3')
distance x is tensor(171.4254, device='cuda:3')
distance x is tensor(171.4254, device='cuda:3')
________________________________
test distance is  tensor(171.4254, device='cuda:3')
test distance1 is  tensor(171.4254, device='cuda:3')
test similarity is  tensor(0.9470, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.1364103070200127
test entropy is  0.8595753254920944
________________________________
0
distance x is tensor(171.4254, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8594871849647717
avg test loss is  3.1375882483240383
avg accuracy is  0.11228333348966528
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9470, device='cuda:3')
compute_distance is  tensor(171.4254, device='cuda:3')
compute_norm is  tensor(51.1152, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(173.1756, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.3605153573347306
avg test loss is  2.3945072499165403
avg accuracy is  0.13528333348966523
solo acc is  0.10455000015633195
compute similarity  is  tensor(0.9470, device='cuda:3')
compute_distance is  tensor(173.1756, device='cuda:3')
compute_norm is  tensor(50.7612, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(174.1372, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7707263591574199
avg test loss is  3.0949098214920143
avg accuracy is  0.11350000015633194
solo acc is  0.10010000015633198
compute similarity  is  tensor(0.9462, device='cuda:3')
compute_distance is  tensor(174.1372, device='cuda:3')
compute_norm is  tensor(50.7475, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(176.3687, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.23797181496488
avg test loss is  2.2543765755096223
avg accuracy is  0.12401666682299858
solo acc is  0.10618333348966529
compute similarity  is  tensor(0.9460, device='cuda:3')
compute_distance is  tensor(176.3687, device='cuda:3')
compute_norm is  tensor(50.3959, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(177.2459, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7121486949132704
avg test loss is  2.950823276281865
avg accuracy is  0.11373333348966527
solo acc is  0.10013333348966531
compute similarity  is  tensor(0.9455, device='cuda:3')
compute_distance is  tensor(177.2459, device='cuda:3')
compute_norm is  tensor(50.2805, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(178.6432, device='cuda:3')
________________________________
test distance is  tensor(178.6432, device='cuda:3')
test similarity is  tensor(0.9456, device='cuda:3')
test acc is  0.11453333348966527
test loss is 2.0349077047315487
test entropy is  1.304386969949645
________________________________
final entropy
distance x is tensor(178.6387, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.304345355359222
avg test loss is  2.032670931521255
avg accuracy is  0.11431666682299861
solo acc is  0.11406666682299861
compute similarity  is  tensor(0.9456, device='cuda:3')
compute_distance is  tensor(178.6387, device='cuda:3')
compute_norm is  tensor(49.9324, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 2.7893662452697754
mal norm is  tensor(739.4398, device='cuda:3')
distance x is tensor(179.4003, device='cuda:3')
mal distance is  tensor(179.4003, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([19., 19., 19., 19., 19., 22., 19., 19., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 34., 12., 32., 14., 31., 18., 31., 32.,
        16., 32., 19., 18., 16., 35., 16., 17.])
count_res tensor([7.2413e-08, 7.2413e-08, 7.2413e-08, 7.2413e-08, 7.2413e-08, 1.4545e-06,
        7.2413e-08, 7.2413e-08, 1.0747e-05, 1.0747e-05, 1.0747e-05, 1.0747e-05,
        1.0747e-05, 1.0747e-05, 1.0747e-05, 1.0747e-05, 1.0747e-05, 1.0747e-05,
        1.0747e-05, 1.0747e-05, 2.3672e-01, 6.6032e-11, 3.2036e-02, 4.8791e-10,
        1.1786e-02, 2.6639e-08, 1.1786e-02, 3.2036e-02, 3.6052e-09, 3.2036e-02,
        7.2413e-08, 2.6639e-08, 3.6052e-09, 6.4347e-01, 3.6052e-09, 9.8000e-09])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 89.43% 

Test Accuracy: 88.76% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 89.43%
|----0th round Training Accuracy : 21.07%
|----1th round Training Accuracy : 88.94%
|----2th round Training Accuracy : 88.57%
|----3th round Training Accuracy : 88.21%
|----4th round Training Accuracy : 87.77%
|----5th round Training Accuracy : 89.15%
|----6th round Training Accuracy : 19.98%
|----7th round Training Accuracy : 89.17%
|----8th round Training Accuracy : 86.67%
|----9th round Training Accuracy : 89.36%
|----10th round Training Accuracy : 20.97%
|----11th round Training Accuracy : 89.52%
|----12th round Training Accuracy : 22.63%
|----13th round Training Accuracy : 89.00%
|----14th round Training Accuracy : 89.26%
|----15th round Training Accuracy : 89.62%
|----16th round Training Accuracy : 20.64%
|----17th round Training Accuracy : 89.55%
|----18th round Training Accuracy : 20.30%
|----19th round Training Accuracy : 89.86%
|----20th round Training Accuracy : 88.98%
|----21th round Training Accuracy : 89.12%
|----22th round Training Accuracy : 18.89%
|----23th round Training Accuracy : 89.63%
|----24th round Training Accuracy : 89.40%
|----25th round Training Accuracy : 89.12%
|----26th round Training Accuracy : 89.62%
|----27th round Training Accuracy : 89.76%
|----28th round Training Accuracy : 19.92%
|----29th round Training Accuracy : 89.69%
|----30th round Training Accuracy : 20.12%
|----31th round Training Accuracy : 90.01%
|----32th round Training Accuracy : 89.47%
|----33th round Training Accuracy : 89.28%
|----34th round Training Accuracy : 89.49%
|----35th round Training Accuracy : 89.90%
|----36th round Training Accuracy : 20.02%
|----37th round Training Accuracy : 89.42%
|----38th round Training Accuracy : 88.23%
|----39th round Training Accuracy : 89.60%
|----40th round Training Accuracy : 19.63%
|----41th round Training Accuracy : 89.76%
|----42th round Training Accuracy : 26.97%
|----43th round Training Accuracy : 89.73%
|----44th round Training Accuracy : 89.27%
|----45th round Training Accuracy : 89.56%
|----46th round Training Accuracy : 19.49%
|----47th round Training Accuracy : 89.45%
|----48th round Training Accuracy : 22.02%
|----49th round Training Accuracy : 89.43%
|----Final Test Accuracy: 88.76%
|----0th round Final Test Accuracy : 20.09%
|----1th round Final Test Accuracy : 87.89%
|----2th round Final Test Accuracy : 88.28%
|----3th round Final Test Accuracy : 87.78%
|----4th round Final Test Accuracy : 87.32%
|----5th round Final Test Accuracy : 88.46%
|----6th round Final Test Accuracy : 19.14%
|----7th round Final Test Accuracy : 88.63%
|----8th round Final Test Accuracy : 86.25%
|----9th round Final Test Accuracy : 88.68%
|----10th round Final Test Accuracy : 19.74%
|----11th round Final Test Accuracy : 88.91%
|----12th round Final Test Accuracy : 21.47%
|----13th round Final Test Accuracy : 87.95%
|----14th round Final Test Accuracy : 88.33%
|----15th round Final Test Accuracy : 88.89%
|----16th round Final Test Accuracy : 19.82%
|----17th round Final Test Accuracy : 88.65%
|----18th round Final Test Accuracy : 19.22%
|----19th round Final Test Accuracy : 89.42%
|----20th round Final Test Accuracy : 87.82%
|----21th round Final Test Accuracy : 88.53%
|----22th round Final Test Accuracy : 18.38%
|----23th round Final Test Accuracy : 88.91%
|----24th round Final Test Accuracy : 88.71%
|----25th round Final Test Accuracy : 88.22%
|----26th round Final Test Accuracy : 88.64%
|----27th round Final Test Accuracy : 88.84%
|----28th round Final Test Accuracy : 19.09%
|----29th round Final Test Accuracy : 89.09%
|----30th round Final Test Accuracy : 19.13%
|----31th round Final Test Accuracy : 89.11%
|----32th round Final Test Accuracy : 88.31%
|----33th round Final Test Accuracy : 88.57%
|----34th round Final Test Accuracy : 88.63%
|----35th round Final Test Accuracy : 89.10%
|----36th round Final Test Accuracy : 19.34%
|----37th round Final Test Accuracy : 88.83%
|----38th round Final Test Accuracy : 87.43%
|----39th round Final Test Accuracy : 88.93%
|----40th round Final Test Accuracy : 19.23%
|----41th round Final Test Accuracy : 89.25%
|----42th round Final Test Accuracy : 26.04%
|----43th round Final Test Accuracy : 89.10%
|----44th round Final Test Accuracy : 89.15%
|----45th round Final Test Accuracy : 88.95%
|----46th round Final Test Accuracy : 19.28%
|----47th round Final Test Accuracy : 88.95%
|----48th round Final Test Accuracy : 20.92%
|----49th round Final Test Accuracy : 88.76%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 18831.9640
