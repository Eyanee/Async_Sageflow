
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5997522473335266
distance x is tensor(85.7130, device='cuda:3')
benign distance is  tensor(85.7130, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2276671677827835
distance x is tensor(94.8223, device='cuda:3')
benign distance is  tensor(94.8223, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.17100894451141357
distance x is tensor(95.3084, device='cuda:3')
benign distance is  tensor(95.3084, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6883465051651001
distance x is tensor(85.0761, device='cuda:3')
benign distance is  tensor(85.0761, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8487021327018738
distance x is tensor(78.1148, device='cuda:3')
benign distance is  tensor(78.1148, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.44680285453796387
distance x is tensor(90.0352, device='cuda:3')
benign distance is  tensor(90.0352, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.40305739641189575
distance x is tensor(89.2530, device='cuda:3')
benign distance is  tensor(89.2530, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6519477367401123
distance x is tensor(102.1636, device='cuda:3')
benign distance is  tensor(102.1636, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2507088780403137
distance x is tensor(120.5129, device='cuda:3')
benign distance is  tensor(120.5129, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.15376293659210205
distance x is tensor(110.3650, device='cuda:3')
benign distance is  tensor(110.3650, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.16475088894367218
distance x is tensor(101.9323, device='cuda:3')
benign distance is  tensor(101.9323, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8493295907974243
distance x is tensor(107.9448, device='cuda:3')
benign distance is  tensor(107.9448, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.30860066413879395
distance x is tensor(111.3143, device='cuda:3')
benign distance is  tensor(111.3143, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2283872663974762
distance x is tensor(120.6328, device='cuda:3')
benign distance is  tensor(120.6328, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6164648532867432
distance x is tensor(103.9661, device='cuda:3')
benign distance is  tensor(103.9661, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.44158416986465454
distance x is tensor(113.1053, device='cuda:3')
benign distance is  tensor(113.1053, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.38735151290893555
distance x is tensor(104.5902, device='cuda:3')
benign distance is  tensor(104.5902, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5166155695915222
distance x is tensor(116.1273, device='cuda:3')
benign distance is  tensor(116.1273, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5387791395187378
distance x is tensor(104.2808, device='cuda:3')
benign distance is  tensor(104.2808, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2520013451576233
distance x is tensor(103.1304, device='cuda:3')
benign distance is  tensor(103.1304, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.05685653164982796
distance x is tensor(113.0034, device='cuda:3')
benign distance is  tensor(113.0034, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8572278022766113
distance x is tensor(114.0807, device='cuda:3')
benign distance is  tensor(114.0807, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.09658809006214142
distance x is tensor(108.2856, device='cuda:3')
benign distance is  tensor(108.2856, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.38423293828964233
distance x is tensor(105.7304, device='cuda:3')
benign distance is  tensor(105.7304, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.35481828451156616
distance x is tensor(113.7581, device='cuda:3')
benign distance is  tensor(113.7581, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5303424596786499
distance x is tensor(106.3413, device='cuda:3')
benign distance is  tensor(106.3413, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.7707762718200684
distance x is tensor(112.4144, device='cuda:3')
benign distance is  tensor(112.4144, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.43938493728637695
distance x is tensor(113.6218, device='cuda:3')
benign distance is  tensor(113.6218, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6387007832527161
distance x is tensor(109.3025, device='cuda:3')
benign distance is  tensor(109.3025, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6123859286308289
distance x is tensor(114.2384, device='cuda:3')
benign distance is  tensor(114.2384, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.1766022890806198
distance x is tensor(103.6485, device='cuda:3')
benign distance is  tensor(103.6485, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.5803341269493103
distance x is tensor(101.6161, device='cuda:3')
benign distance is  tensor(101.6161, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.43347564339637756
distance x is tensor(106.2538, device='cuda:3')
benign distance is  tensor(106.2538, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.16963690519332886
distance x is tensor(102.8972, device='cuda:3')
benign distance is  tensor(102.8972, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.46160632371902466
distance x is tensor(117.7623, device='cuda:3')
benign distance is  tensor(117.7623, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.1903669536113739
distance x is tensor(97.5109, device='cuda:3')
benign distance is  tensor(97.5109, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.2958393692970276
distance x is tensor(110.1420, device='cuda:3')
benign distance is  tensor(110.1420, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.3888867497444153
distance x is tensor(106.0115, device='cuda:3')
benign distance is  tensor(106.0115, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.5269743204116821
distance x is tensor(104.7054, device='cuda:3')
benign distance is  tensor(104.7054, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.19444529712200165
distance x is tensor(104.3128, device='cuda:3')
benign distance is  tensor(104.3128, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.14444708824157715
distance x is tensor(102.3417, device='cuda:3')
benign distance is  tensor(102.3417, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.2132575958967209
distance x is tensor(102.9718, device='cuda:3')
benign distance is  tensor(102.9718, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.05373646691441536
distance x is tensor(107.3718, device='cuda:3')
benign distance is  tensor(107.3718, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.04184538871049881
distance x is tensor(106.9906, device='cuda:3')
benign distance is  tensor(106.9906, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5370989441871643
distance x is tensor(109.8574, device='cuda:3')
benign distance is  tensor(109.8574, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.45724302530288696
distance x is tensor(111.8675, device='cuda:3')
benign distance is  tensor(111.8675, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6731928586959839
distance x is tensor(105.7694, device='cuda:3')
benign distance is  tensor(105.7694, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.26431041955947876
distance x is tensor(112.2632, device='cuda:3')
benign distance is  tensor(112.2632, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 17., 15.,  8.,  8.,  8.,
         8.,  8.,  8.,  9., 13., 11.])
count_res tensor([5.5521e-03, 5.5521e-03, 5.5521e-03, 5.5521e-03, 5.5521e-03, 5.5521e-03,
        5.5521e-03, 5.5521e-03, 2.0425e-03, 8.2400e-01, 1.1152e-01, 1.0169e-04,
        1.0169e-04, 1.0169e-04, 1.0169e-04, 1.0169e-04, 1.0169e-04, 2.7642e-04,
        1.5092e-02, 2.0425e-03])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 87.78% 

Test Accuracy: 86.82% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2928805649280548
distance x is tensor(75.5121, device='cuda:3')
benign distance is  tensor(75.5121, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.74266517162323
distance x is tensor(97.2597, device='cuda:3')
benign distance is  tensor(97.2597, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.10611458122730255
distance x is tensor(97.6656, device='cuda:3')
benign distance is  tensor(97.6656, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.27652353048324585
distance x is tensor(81.4325, device='cuda:3')
benign distance is  tensor(81.4325, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3208593428134918
distance x is tensor(70.0980, device='cuda:3')
benign distance is  tensor(70.0980, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0172494649887085
distance x is tensor(87.5449, device='cuda:3')
benign distance is  tensor(87.5449, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.36890077590942383
distance x is tensor(79.1969, device='cuda:3')
benign distance is  tensor(79.1969, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3272189497947693
distance x is tensor(86.1428, device='cuda:3')
benign distance is  tensor(86.1428, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 18., 16., 12., 22., 16., 12.,  0., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 14., 16., 17., 15., 12., 17., 15., 15.])
count_res tensor([4.2342e-05, 1.7082e-02, 2.3118e-03, 4.2342e-05, 9.3264e-01, 2.3118e-03,
        4.2342e-05, 2.6016e-10, 2.3118e-03, 2.3118e-03, 2.3118e-03, 2.3118e-03,
        2.3118e-03, 2.3118e-03, 2.3118e-03, 2.3118e-03, 2.3118e-03, 2.3118e-03,
        2.3118e-03, 2.3118e-03, 3.1287e-04, 2.3118e-03, 6.2841e-03, 8.5046e-04,
        4.2342e-05, 6.2841e-03, 8.5046e-04, 8.5046e-04])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 87.83% 

Test Accuracy: 87.13% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4996902346611023
distance x is tensor(94.4872, device='cuda:3')
benign distance is  tensor(94.4872, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4568386971950531
distance x is tensor(93.8631, device='cuda:3')
benign distance is  tensor(93.8631, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4335813522338867
distance x is tensor(109.6684, device='cuda:3')
benign distance is  tensor(109.6684, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.223679780960083
distance x is tensor(114.2784, device='cuda:3')
benign distance is  tensor(114.2784, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6451970338821411
distance x is tensor(74.2240, device='cuda:3')
benign distance is  tensor(74.2240, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.44600123167037964
distance x is tensor(111.8129, device='cuda:3')
benign distance is  tensor(111.8129, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6058023571968079
distance x is tensor(104.9036, device='cuda:3')
benign distance is  tensor(104.9036, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.39969104528427124
distance x is tensor(111.0948, device='cuda:3')
benign distance is  tensor(111.0948, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.09797897189855576
distance x is tensor(130.2411, device='cuda:3')
benign distance is  tensor(130.2411, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3244906961917877
distance x is tensor(119.4660, device='cuda:3')
benign distance is  tensor(119.4660, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.24150939285755157
distance x is tensor(118.9508, device='cuda:3')
benign distance is  tensor(118.9508, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.400488942861557
distance x is tensor(111.3094, device='cuda:3')
benign distance is  tensor(111.3094, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.28518804907798767
distance x is tensor(115.7890, device='cuda:3')
benign distance is  tensor(115.7890, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7681211233139038
distance x is tensor(128.5652, device='cuda:3')
benign distance is  tensor(128.5652, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4950277805328369
distance x is tensor(120.9433, device='cuda:3')
benign distance is  tensor(120.9433, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.1708017587661743
distance x is tensor(125.3300, device='cuda:3')
benign distance is  tensor(125.3300, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([14., 16., 15., 14., 19., 13., 13.,  0., 16., 16., 15., 15., 15., 15.,
        15., 15., 15., 15., 15., 15., 17., 27., 14., 13., 15., 13., 15., 23.])
count_res tensor([2.2185e-06, 1.6393e-05, 6.0306e-06, 2.2185e-06, 3.2926e-04, 8.1616e-07,
        8.1616e-07, 1.8448e-12, 1.6393e-05, 1.6393e-05, 6.0306e-06, 6.0306e-06,
        6.0306e-06, 6.0306e-06, 6.0306e-06, 6.0306e-06, 6.0306e-06, 6.0306e-06,
        6.0306e-06, 6.0306e-06, 4.4561e-05, 9.8151e-01, 2.2185e-06, 8.1616e-07,
        6.0306e-06, 8.1616e-07, 6.0306e-06, 1.7977e-02])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 87.63% 

Test Accuracy: 86.57% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2638916075229645
distance x is tensor(111.7060, device='cuda:3')
benign distance is  tensor(111.7060, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6226478815078735
distance x is tensor(121.2138, device='cuda:3')
benign distance is  tensor(121.2138, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.209640771150589
distance x is tensor(134.7802, device='cuda:3')
benign distance is  tensor(134.7802, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8747327923774719
distance x is tensor(119.7737, device='cuda:3')
benign distance is  tensor(119.7737, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.17870312929153442
distance x is tensor(104.4931, device='cuda:3')
benign distance is  tensor(104.4931, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5275329351425171
distance x is tensor(120.8880, device='cuda:3')
benign distance is  tensor(120.8880, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7199235558509827
distance x is tensor(115.5176, device='cuda:3')
benign distance is  tensor(115.5176, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.30756181478500366
distance x is tensor(114.7206, device='cuda:3')
benign distance is  tensor(114.7206, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5243831872940063
distance x is tensor(133.4347, device='cuda:3')
benign distance is  tensor(133.4347, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.2853296995162964
distance x is tensor(65.2289, device='cuda:3')
benign distance is  tensor(65.2289, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.46592092514038086
distance x is tensor(115.5305, device='cuda:3')
benign distance is  tensor(115.5305, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.08481016755104065
distance x is tensor(124.5575, device='cuda:3')
benign distance is  tensor(124.5575, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.4686427116394043
distance x is tensor(126.8475, device='cuda:3')
benign distance is  tensor(126.8475, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6608806848526001
distance x is tensor(121.0013, device='cuda:3')
benign distance is  tensor(121.0013, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5546160936355591
distance x is tensor(137.2614, device='cuda:3')
benign distance is  tensor(137.2614, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5802072882652283
distance x is tensor(122.0036, device='cuda:3')
benign distance is  tensor(122.0036, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([23., 28.,  0., 15., 14., 14., 12., 25., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 23., 21.,  0.,  0., 13., 12., 12., 19.,
        17., 34., 33., 24.,  0., 34., 18., 12.])
count_res tensor([7.0438e-06, 1.0454e-03, 7.2283e-16, 2.3629e-09, 8.6928e-10, 8.6928e-10,
        1.1764e-10, 5.2047e-05, 1.9147e-05, 1.9147e-05, 1.9147e-05, 1.9147e-05,
        1.9147e-05, 1.9147e-05, 1.9147e-05, 1.9147e-05, 1.9147e-05, 1.9147e-05,
        1.9147e-05, 1.9147e-05, 7.0438e-06, 9.5328e-07, 7.2283e-16, 7.2283e-16,
        3.1979e-10, 1.1764e-10, 1.1764e-10, 1.2901e-07, 1.7460e-08, 4.2174e-01,
        1.5515e-01, 1.9147e-05, 7.2283e-16, 4.2174e-01, 4.7461e-08, 1.1764e-10])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 88.86% 

Test Accuracy: 88.07% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4249153137207031
distance x is tensor(86.6774, device='cuda:3')
benign distance is  tensor(86.6774, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5636862516403198
distance x is tensor(98.6286, device='cuda:3')
benign distance is  tensor(98.6286, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.026375139132142067
distance x is tensor(115.3949, device='cuda:3')
benign distance is  tensor(115.3949, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5853195190429688
distance x is tensor(101.9422, device='cuda:3')
benign distance is  tensor(101.9422, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5074354410171509
distance x is tensor(53.1092, device='cuda:3')
benign distance is  tensor(53.1092, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.25289085507392883
distance x is tensor(106.0198, device='cuda:3')
benign distance is  tensor(106.0198, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2300063669681549
distance x is tensor(105.6406, device='cuda:3')
benign distance is  tensor(105.6406, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4196639657020569
distance x is tensor(98.3722, device='cuda:3')
benign distance is  tensor(98.3722, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.19618649780750275
distance x is tensor(120.5930, device='cuda:3')
benign distance is  tensor(120.5930, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4319092631340027
distance x is tensor(88.2590, device='cuda:3')
benign distance is  tensor(88.2590, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5821958780288696
distance x is tensor(100.0543, device='cuda:3')
benign distance is  tensor(100.0543, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6225613355636597
distance x is tensor(108.8323, device='cuda:3')
benign distance is  tensor(108.8323, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4575827717781067
distance x is tensor(106.6248, device='cuda:3')
benign distance is  tensor(106.6248, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.180378720164299
distance x is tensor(94.9925, device='cuda:3')
benign distance is  tensor(94.9925, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5641971826553345
distance x is tensor(112.3769, device='cuda:3')
benign distance is  tensor(112.3769, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5639768242835999
distance x is tensor(113.2352, device='cuda:3')
benign distance is  tensor(113.2352, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.051550816744565964
distance x is tensor(114.7349, device='cuda:3')
benign distance is  tensor(114.7349, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.1818234771490097
distance x is tensor(102.1227, device='cuda:3')
benign distance is  tensor(102.1227, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.4804704189300537
distance x is tensor(116.5014, device='cuda:3')
benign distance is  tensor(116.5014, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5571781396865845
distance x is tensor(121.4486, device='cuda:3')
benign distance is  tensor(121.4486, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5273972749710083
distance x is tensor(106.9407, device='cuda:3')
benign distance is  tensor(106.9407, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.16896109282970428
distance x is tensor(114.2307, device='cuda:3')
benign distance is  tensor(114.2307, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.325986385345459
distance x is tensor(106.8060, device='cuda:3')
benign distance is  tensor(106.8060, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.2676410973072052
distance x is tensor(112.7076, device='cuda:3')
benign distance is  tensor(112.7076, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 12., 25., 25., 14., 19., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12.,  0., 25., 12., 12., 12., 12., 12.])
count_res tensor([7.5244e-07, 7.5244e-07, 3.3289e-01, 3.3289e-01, 5.5598e-06, 8.2515e-04,
        7.5244e-07, 7.5244e-07, 4.1082e-05, 4.1082e-05, 4.1082e-05, 4.1082e-05,
        4.1082e-05, 4.1082e-05, 4.1082e-05, 4.1082e-05, 4.1082e-05, 4.1082e-05,
        4.1082e-05, 4.1082e-05, 7.5244e-07, 4.6232e-12, 3.3289e-01, 7.5244e-07,
        7.5244e-07, 7.5244e-07, 7.5244e-07, 7.5244e-07])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 88.82% 

Test Accuracy: 88.43% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6000996232032776
distance x is tensor(89.1779, device='cuda:3')
benign distance is  tensor(89.1779, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9013048410415649
distance x is tensor(102.4405, device='cuda:3')
benign distance is  tensor(102.4405, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.02636295184493065
distance x is tensor(97.1804, device='cuda:3')
benign distance is  tensor(97.1804, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5785676836967468
distance x is tensor(74.5617, device='cuda:3')
benign distance is  tensor(74.5617, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5770596861839294
distance x is tensor(85.2602, device='cuda:3')
benign distance is  tensor(85.2602, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3460710644721985
distance x is tensor(101.8811, device='cuda:3')
benign distance is  tensor(101.8811, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.16341547667980194
distance x is tensor(101.0834, device='cuda:3')
benign distance is  tensor(101.0834, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.338047593832016
distance x is tensor(99.7429, device='cuda:3')
benign distance is  tensor(99.7429, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.4799047112464905
distance x is tensor(112.3041, device='cuda:3')
benign distance is  tensor(112.3041, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.11281032860279083
distance x is tensor(109.4100, device='cuda:3')
benign distance is  tensor(109.4100, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.8129370808601379
distance x is tensor(98.9679, device='cuda:3')
benign distance is  tensor(98.9679, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.02619234099984169
distance x is tensor(109.1023, device='cuda:3')
benign distance is  tensor(109.1023, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.48100581765174866
distance x is tensor(113.9119, device='cuda:3')
benign distance is  tensor(113.9119, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.5751953125
distance x is tensor(111.9525, device='cuda:3')
benign distance is  tensor(111.9525, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.3129069209098816
distance x is tensor(110.9708, device='cuda:3')
benign distance is  tensor(110.9708, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.14068470895290375
distance x is tensor(110.8041, device='cuda:3')
benign distance is  tensor(110.8041, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 44
counter_tensor is  tensor([20., 20.,  1., 20., 38., 42.,  8., 22., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 14., 15., 10., 31., 14., 31., 14.,  1.,
         5., 19., 25., 43., 37., 26., 34., 21., 22., 31., 17., 14., 39., 41.,
        16.,  8.])
count_res tensor([6.7023e-11, 6.7023e-11, 3.7552e-19, 6.7023e-11, 4.4008e-03, 2.4027e-01,
        4.1181e-16, 4.9524e-10, 1.0908e-05, 1.0908e-05, 1.0908e-05, 1.0908e-05,
        1.0908e-05, 1.0908e-05, 1.0908e-05, 1.0908e-05, 1.0908e-05, 1.0908e-05,
        1.0908e-05, 1.0908e-05, 1.6613e-13, 4.5160e-13, 3.0429e-15, 4.0130e-06,
        1.6613e-13, 4.0130e-06, 1.6613e-13, 3.7552e-19, 2.0503e-17, 2.4657e-11,
        9.9472e-09, 6.5313e-01, 1.6189e-03, 2.7039e-08, 8.0603e-05, 1.8219e-10,
        4.9524e-10, 4.0130e-06, 3.3369e-12, 1.6613e-13, 1.1962e-02, 8.8391e-02,
        1.2276e-12, 4.1181e-16])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 88.49% 

Test Accuracy: 87.82% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6612651348114014
distance x is tensor(111.2407, device='cuda:3')
benign distance is  tensor(111.2407, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.43961089849472046
distance x is tensor(115.9145, device='cuda:3')
benign distance is  tensor(115.9145, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.013388261198997498
distance x is tensor(108.9652, device='cuda:3')
benign distance is  tensor(108.9652, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.26168277859687805
distance x is tensor(100.4644, device='cuda:3')
benign distance is  tensor(100.4644, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7365251779556274
distance x is tensor(98.0070, device='cuda:3')
benign distance is  tensor(98.0070, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3431248366832733
distance x is tensor(112.9308, device='cuda:3')
benign distance is  tensor(112.9308, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.26951056718826294
distance x is tensor(113.4049, device='cuda:3')
benign distance is  tensor(113.4049, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.28260210156440735
distance x is tensor(110.7624, device='cuda:3')
benign distance is  tensor(110.7624, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5334545969963074
distance x is tensor(120.5257, device='cuda:3')
benign distance is  tensor(120.5257, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6711570024490356
distance x is tensor(125.7485, device='cuda:3')
benign distance is  tensor(125.7485, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.18544381856918335
distance x is tensor(121.4028, device='cuda:3')
benign distance is  tensor(121.4028, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5103265047073364
distance x is tensor(113.4682, device='cuda:3')
benign distance is  tensor(113.4682, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9926268458366394
distance x is tensor(113.8092, device='cuda:3')
benign distance is  tensor(113.8092, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.28103968501091003
distance x is tensor(121.9355, device='cuda:3')
benign distance is  tensor(121.9355, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5151658058166504
distance x is tensor(119.1361, device='cuda:3')
benign distance is  tensor(119.1361, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8186017870903015
distance x is tensor(136.2447, device='cuda:3')
benign distance is  tensor(136.2447, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.23707203567028046
distance x is tensor(118.5812, device='cuda:3')
benign distance is  tensor(118.5812, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9543696641921997
distance x is tensor(120.5818, device='cuda:3')
benign distance is  tensor(120.5818, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.24822115898132324
distance x is tensor(115.6144, device='cuda:3')
benign distance is  tensor(115.6144, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.6662153005599976
distance x is tensor(75.6984, device='cuda:3')
benign distance is  tensor(75.6984, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.11627473682165146
distance x is tensor(127.9786, device='cuda:3')
benign distance is  tensor(127.9786, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.44339513778686523
distance x is tensor(112.9721, device='cuda:3')
benign distance is  tensor(112.9721, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4934656023979187
distance x is tensor(128.2803, device='cuda:3')
benign distance is  tensor(128.2803, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.39246127009391785
distance x is tensor(125.5933, device='cuda:3')
benign distance is  tensor(125.5933, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.05241284519433975
distance x is tensor(120.4680, device='cuda:3')
benign distance is  tensor(120.4680, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.6523053050041199
distance x is tensor(122.2804, device='cuda:3')
benign distance is  tensor(122.2804, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.25994569063186646
distance x is tensor(120.2678, device='cuda:3')
benign distance is  tensor(120.2678, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.09195573627948761
distance x is tensor(122.3376, device='cuda:3')
benign distance is  tensor(122.3376, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6106566786766052
distance x is tensor(133.8637, device='cuda:3')
benign distance is  tensor(133.8637, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8154908418655396
distance x is tensor(118.9810, device='cuda:3')
benign distance is  tensor(118.9810, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.44282230734825134
distance x is tensor(120.3196, device='cuda:3')
benign distance is  tensor(120.3196, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.8194109201431274
distance x is tensor(115.7420, device='cuda:3')
benign distance is  tensor(115.7420, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([13., 14., 14., 15., 15., 15., 13., 14., 11., 14., 12.,  5.,  7.,  7.,
         8.,  7.,  8.,  8., 11.,  9.])
count_res tensor([2.7991e-02, 7.6089e-02, 7.6089e-02, 2.0683e-01, 2.0683e-01, 2.0683e-01,
        2.7991e-02, 7.6089e-02, 3.7882e-03, 7.6089e-02, 1.0297e-02, 9.3901e-06,
        6.9384e-05, 6.9384e-05, 1.8861e-04, 6.9384e-05, 1.8861e-04, 1.8861e-04,
        3.7882e-03, 5.1268e-04])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 89.33% 

Test Accuracy: 88.74% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.34183114767074585
distance x is tensor(95.0946, device='cuda:3')
benign distance is  tensor(95.0946, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7625490427017212
distance x is tensor(107.1747, device='cuda:3')
benign distance is  tensor(107.1747, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.12153180688619614
distance x is tensor(110.7421, device='cuda:3')
benign distance is  tensor(110.7421, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.573655903339386
distance x is tensor(96.6903, device='cuda:3')
benign distance is  tensor(96.6903, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.46857085824012756
distance x is tensor(75.7023, device='cuda:3')
benign distance is  tensor(75.7023, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7349585890769958
distance x is tensor(88.8240, device='cuda:3')
benign distance is  tensor(88.8240, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.38023313879966736
distance x is tensor(107.8983, device='cuda:3')
benign distance is  tensor(107.8983, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.12937910854816437
distance x is tensor(104.9485, device='cuda:3')
benign distance is  tensor(104.9485, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([16., 17.,  4., 19., 17., 17., 18., 18., 15., 18., 18., 20., 19., 18.,
        20., 20., 20., 20., 20., 20., 19., 15., 35., 20., 16., 29., 12., 35.,
        28., 23., 17., 15., 16., 35., 15., 18.])
count_res tensor([1.8655e-09, 5.0709e-09, 1.1462e-14, 3.7469e-08, 5.0709e-09, 5.0709e-09,
        1.3784e-08, 1.3784e-08, 6.8627e-10, 1.3784e-08, 1.3784e-08, 1.0185e-07,
        3.7469e-08, 1.3784e-08, 1.0185e-07, 1.0185e-07, 1.0185e-07, 1.0185e-07,
        1.0185e-07, 1.0185e-07, 3.7469e-08, 6.8627e-10, 3.3296e-01, 1.0185e-07,
        1.8655e-09, 8.2532e-04, 3.4168e-11, 3.3296e-01, 3.0362e-04, 2.0458e-06,
        5.0709e-09, 6.8627e-10, 1.8655e-09, 3.3296e-01, 6.8627e-10, 1.3784e-08])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 89.05% 

Test Accuracy: 88.48% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9084666967391968
distance x is tensor(101.1170, device='cuda:3')
benign distance is  tensor(101.1170, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.34052547812461853
distance x is tensor(104.3116, device='cuda:3')
benign distance is  tensor(104.3116, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2386513501405716
distance x is tensor(110.4479, device='cuda:3')
benign distance is  tensor(110.4479, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.19230684638023376
distance x is tensor(94.9124, device='cuda:3')
benign distance is  tensor(94.9124, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3589364290237427
distance x is tensor(75.8329, device='cuda:3')
benign distance is  tensor(75.8329, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5670677423477173
distance x is tensor(106.3898, device='cuda:3')
benign distance is  tensor(106.3898, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2719585597515106
distance x is tensor(104.8253, device='cuda:3')
benign distance is  tensor(104.8253, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2920275330543518
distance x is tensor(106.3817, device='cuda:3')
benign distance is  tensor(106.3817, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.30499300360679626
distance x is tensor(115.0111, device='cuda:3')
benign distance is  tensor(115.0111, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5280164480209351
distance x is tensor(105.8600, device='cuda:3')
benign distance is  tensor(105.8600, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4418680667877197
distance x is tensor(107.9172, device='cuda:3')
benign distance is  tensor(107.9172, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.46445029973983765
distance x is tensor(119.7553, device='cuda:3')
benign distance is  tensor(119.7553, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6129358410835266
distance x is tensor(110.1646, device='cuda:3')
benign distance is  tensor(110.1646, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.09474316984415054
distance x is tensor(86.8858, device='cuda:3')
benign distance is  tensor(86.8858, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8466159701347351
distance x is tensor(113.0790, device='cuda:3')
benign distance is  tensor(113.0790, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.2870616316795349
distance x is tensor(111.3795, device='cuda:3')
benign distance is  tensor(111.3795, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.2850959300994873
distance x is tensor(120.3137, device='cuda:3')
benign distance is  tensor(120.3137, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.38518768548965454
distance x is tensor(112.0002, device='cuda:3')
benign distance is  tensor(112.0002, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3018030822277069
distance x is tensor(95.6423, device='cuda:3')
benign distance is  tensor(95.6423, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.42461448907852173
distance x is tensor(121.3374, device='cuda:3')
benign distance is  tensor(121.3374, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7731953859329224
distance x is tensor(108.1359, device='cuda:3')
benign distance is  tensor(108.1359, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5280705094337463
distance x is tensor(119.4645, device='cuda:3')
benign distance is  tensor(119.4645, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.208735853433609
distance x is tensor(112.7495, device='cuda:3')
benign distance is  tensor(112.7495, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.21394360065460205
distance x is tensor(93.1165, device='cuda:3')
benign distance is  tensor(93.1165, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([17., 12., 12., 14., 12., 13., 12., 22., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 14.,  0., 12., 25., 12., 27., 12.])
count_res tensor([3.9743e-05, 2.6779e-07, 2.6779e-07, 1.9787e-06, 2.6779e-07, 7.2793e-07,
        2.6779e-07, 5.8984e-03, 1.4621e-05, 1.4621e-05, 1.4621e-05, 1.4621e-05,
        1.4621e-05, 1.4621e-05, 1.4621e-05, 1.4621e-05, 1.4621e-05, 1.4621e-05,
        1.4621e-05, 1.4621e-05, 2.6779e-07, 1.9787e-06, 1.6454e-12, 2.6779e-07,
        1.1847e-01, 2.6779e-07, 8.7541e-01, 2.6779e-07])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 86.57% 

Test Accuracy: 86.05% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4585789740085602
distance x is tensor(117.5798, device='cuda:3')
benign distance is  tensor(117.5798, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5366194844245911
distance x is tensor(119.9209, device='cuda:3')
benign distance is  tensor(119.9209, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9677169919013977
distance x is tensor(112.4975, device='cuda:3')
benign distance is  tensor(112.4975, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.671666145324707
distance x is tensor(116.5692, device='cuda:3')
benign distance is  tensor(116.5692, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2016521692276001
distance x is tensor(103.1317, device='cuda:3')
benign distance is  tensor(103.1317, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5768177509307861
distance x is tensor(106.1527, device='cuda:3')
benign distance is  tensor(106.1527, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5057147145271301
distance x is tensor(126.4324, device='cuda:3')
benign distance is  tensor(126.4324, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4607974886894226
distance x is tensor(120.2155, device='cuda:3')
benign distance is  tensor(120.2155, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.36840516328811646
distance x is tensor(123.7657, device='cuda:3')
benign distance is  tensor(123.7657, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6322347521781921
distance x is tensor(114.4834, device='cuda:3')
benign distance is  tensor(114.4834, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3030986487865448
distance x is tensor(121.9314, device='cuda:3')
benign distance is  tensor(121.9314, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.44265374541282654
distance x is tensor(86.5212, device='cuda:3')
benign distance is  tensor(86.5212, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.42395511269569397
distance x is tensor(123.7303, device='cuda:3')
benign distance is  tensor(123.7303, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.734033465385437
distance x is tensor(121.7736, device='cuda:3')
benign distance is  tensor(121.7736, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4529259204864502
distance x is tensor(81.4073, device='cuda:3')
benign distance is  tensor(81.4073, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.1208107471466064
distance x is tensor(132.2041, device='cuda:3')
benign distance is  tensor(132.2041, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([17., 13.,  1.,  1., 35., 10.,  1., 34., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 15., 27., 19., 12., 35., 15., 13., 13.,
        20.,  3., 13.,  2., 35., 34., 12., 30.])
count_res tensor([4.0689e-09, 7.4524e-11, 4.5789e-16, 4.5789e-16, 2.6716e-01, 3.7103e-12,
        4.5789e-16, 9.8284e-02, 4.4621e-06, 4.4621e-06, 4.4621e-06, 4.4621e-06,
        4.4621e-06, 4.4621e-06, 4.4621e-06, 4.4621e-06, 4.4621e-06, 4.4621e-06,
        4.4621e-06, 4.4621e-06, 5.5066e-10, 8.9623e-05, 3.0065e-08, 2.7416e-11,
        2.6716e-01, 5.5066e-10, 7.4524e-11, 7.4524e-11, 8.1726e-08, 3.3834e-15,
        7.4524e-11, 1.2447e-15, 2.6716e-01, 9.8284e-02, 2.7416e-11, 1.8001e-03])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 89.37% 

Test Accuracy: 88.89% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.537070631980896
distance x is tensor(85.8640, device='cuda:3')
benign distance is  tensor(85.8640, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5659653544425964
distance x is tensor(98.8035, device='cuda:3')
benign distance is  tensor(98.8035, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.10992288589477539
distance x is tensor(102.2706, device='cuda:3')
benign distance is  tensor(102.2706, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5308327078819275
distance x is tensor(93.3795, device='cuda:3')
benign distance is  tensor(93.3795, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.11070223152637482
distance x is tensor(61.7551, device='cuda:3')
benign distance is  tensor(61.7551, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7245069742202759
distance x is tensor(91.5545, device='cuda:3')
benign distance is  tensor(91.5545, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3055817782878876
distance x is tensor(99.1421, device='cuda:3')
benign distance is  tensor(99.1421, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.18900878727436066
distance x is tensor(95.1409, device='cuda:3')
benign distance is  tensor(95.1409, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3809038996696472
distance x is tensor(120.7416, device='cuda:3')
benign distance is  tensor(120.7416, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7194606065750122
distance x is tensor(111.4245, device='cuda:3')
benign distance is  tensor(111.4245, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.20461106300354004
distance x is tensor(92.7463, device='cuda:3')
benign distance is  tensor(92.7463, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5051057934761047
distance x is tensor(112.0065, device='cuda:3')
benign distance is  tensor(112.0065, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.49092406034469604
distance x is tensor(98.3088, device='cuda:3')
benign distance is  tensor(98.3088, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3667442798614502
distance x is tensor(93.9677, device='cuda:3')
benign distance is  tensor(93.9677, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.28184986114501953
distance x is tensor(113.2635, device='cuda:3')
benign distance is  tensor(113.2635, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7337714433670044
distance x is tensor(112.9207, device='cuda:3')
benign distance is  tensor(112.9207, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.558560848236084
distance x is tensor(111.0501, device='cuda:3')
benign distance is  tensor(111.0501, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.36043885350227356
distance x is tensor(111.9394, device='cuda:3')
benign distance is  tensor(111.9394, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.12912151217460632
distance x is tensor(111.2221, device='cuda:3')
benign distance is  tensor(111.2221, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.04156181961297989
distance x is tensor(105.5268, device='cuda:3')
benign distance is  tensor(105.5268, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6356303691864014
distance x is tensor(113.3385, device='cuda:3')
benign distance is  tensor(113.3385, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.3385303020477295
distance x is tensor(102.9215, device='cuda:3')
benign distance is  tensor(102.9215, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.28597909212112427
distance x is tensor(101.4978, device='cuda:3')
benign distance is  tensor(101.4978, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.2625773549079895
distance x is tensor(104.7760, device='cuda:3')
benign distance is  tensor(104.7760, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 12., 16., 16.,  8.,  8.,  8.,
         8.,  8.,  8.,  9., 11., 12.])
count_res tensor([8.3526e-03, 8.3526e-03, 8.3526e-03, 8.3526e-03, 8.3526e-03, 8.3526e-03,
        8.3526e-03, 8.3526e-03, 8.3526e-03, 4.5603e-01, 4.5603e-01, 1.5298e-04,
        1.5298e-04, 1.5298e-04, 1.5298e-04, 1.5298e-04, 1.5298e-04, 4.1585e-04,
        3.0727e-03, 8.3526e-03])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 87.89% 

Test Accuracy: 87.32% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3186314105987549
distance x is tensor(85.4084, device='cuda:3')
benign distance is  tensor(85.4084, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.23636654019355774
distance x is tensor(92.4937, device='cuda:3')
benign distance is  tensor(92.4937, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.16077789664268494
distance x is tensor(103.9193, device='cuda:3')
benign distance is  tensor(103.9193, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5171793699264526
distance x is tensor(85.6347, device='cuda:3')
benign distance is  tensor(85.6347, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2899629473686218
distance x is tensor(49.2111, device='cuda:3')
benign distance is  tensor(49.2111, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.41834741830825806
distance x is tensor(90.6022, device='cuda:3')
benign distance is  tensor(90.6022, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2637145221233368
distance x is tensor(96.3414, device='cuda:3')
benign distance is  tensor(96.3414, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1491146981716156
distance x is tensor(86.8397, device='cuda:3')
benign distance is  tensor(86.8397, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 52
counter_tensor is  tensor([16., 42., 26., 16., 25., 15., 21., 39., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 42., 20., 12., 46., 11., 20., 20., 32.,
        20., 35., 17., 15., 21., 51., 46., 50., 14., 51., 17., 48., 51., 22.,
        42.,  3., 19., 21., 17., 18., 25., 19., 16., 39.])
count_res tensor([1.8373e-16, 3.5961e-05, 4.0469e-12, 1.8373e-16, 1.4888e-12, 6.7591e-17,
        2.7268e-14, 1.7904e-06, 4.8669e-06, 4.8669e-06, 4.8669e-06, 4.8669e-06,
        4.8669e-06, 4.8669e-06, 4.8669e-06, 4.8669e-06, 4.8669e-06, 4.8669e-06,
        4.8669e-06, 4.8669e-06, 3.5961e-05, 1.0031e-14, 3.3651e-18, 1.9634e-03,
        1.2380e-18, 1.0031e-14, 1.0031e-14, 1.6326e-09, 1.0031e-14, 3.2793e-08,
        4.9943e-16, 6.7591e-17, 2.7268e-14, 2.9140e-01, 1.9634e-03, 1.0720e-01,
        2.4865e-17, 2.9140e-01, 4.9943e-16, 1.4508e-02, 2.9140e-01, 7.4122e-14,
        3.5961e-05, 4.1529e-22, 3.6903e-15, 2.7268e-14, 4.9943e-16, 1.3576e-15,
        1.4888e-12, 3.6903e-15, 1.8373e-16, 1.7904e-06])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 89.50% 

Test Accuracy: 88.76% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.30170392990112305
distance x is tensor(97.4360, device='cuda:3')
benign distance is  tensor(97.4360, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8654538989067078
distance x is tensor(102.5577, device='cuda:3')
benign distance is  tensor(102.5577, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.06208081170916557
distance x is tensor(107.6490, device='cuda:3')
benign distance is  tensor(107.6490, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3294856548309326
distance x is tensor(105.3263, device='cuda:3')
benign distance is  tensor(105.3263, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6256610155105591
distance x is tensor(69.7087, device='cuda:3')
benign distance is  tensor(69.7087, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4955422282218933
distance x is tensor(95.6882, device='cuda:3')
benign distance is  tensor(95.6882, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.226117804646492
distance x is tensor(99.8230, device='cuda:3')
benign distance is  tensor(99.8230, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.41035953164100647
distance x is tensor(101.1158, device='cuda:3')
benign distance is  tensor(101.1158, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6177059412002563
distance x is tensor(121.0418, device='cuda:3')
benign distance is  tensor(121.0418, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6517313122749329
distance x is tensor(110.6024, device='cuda:3')
benign distance is  tensor(110.6024, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7754697799682617
distance x is tensor(110.0463, device='cuda:3')
benign distance is  tensor(110.0463, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7434837222099304
distance x is tensor(116.5951, device='cuda:3')
benign distance is  tensor(116.5951, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5413320660591125
distance x is tensor(101.9656, device='cuda:3')
benign distance is  tensor(101.9656, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.17023050785064697
distance x is tensor(100.8289, device='cuda:3')
benign distance is  tensor(100.8289, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.34723514318466187
distance x is tensor(107.8805, device='cuda:3')
benign distance is  tensor(107.8805, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0085593461990356
distance x is tensor(122.0135, device='cuda:3')
benign distance is  tensor(122.0135, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2869793772697449
distance x is tensor(116.5067, device='cuda:3')
benign distance is  tensor(116.5067, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6984559893608093
distance x is tensor(92.0606, device='cuda:3')
benign distance is  tensor(92.0606, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.10740021616220474
distance x is tensor(103.9464, device='cuda:3')
benign distance is  tensor(103.9464, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.43449535965919495
distance x is tensor(88.9425, device='cuda:3')
benign distance is  tensor(88.9425, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5484253168106079
distance x is tensor(91.7326, device='cuda:3')
benign distance is  tensor(91.7326, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9482884407043457
distance x is tensor(109.8700, device='cuda:3')
benign distance is  tensor(109.8700, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.14461246132850647
distance x is tensor(93.3752, device='cuda:3')
benign distance is  tensor(93.3752, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4124264121055603
distance x is tensor(108.8859, device='cuda:3')
benign distance is  tensor(108.8859, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.33495911955833435
distance x is tensor(116.8822, device='cuda:3')
benign distance is  tensor(116.8822, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7285420298576355
distance x is tensor(104.6644, device='cuda:3')
benign distance is  tensor(104.6644, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3982877731323242
distance x is tensor(116.8739, device='cuda:3')
benign distance is  tensor(116.8739, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.2108805626630783
distance x is tensor(121.4146, device='cuda:3')
benign distance is  tensor(121.4146, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9024809002876282
distance x is tensor(116.8856, device='cuda:3')
benign distance is  tensor(116.8856, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7105189561843872
distance x is tensor(97.2891, device='cuda:3')
benign distance is  tensor(97.2891, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.39901483058929443
distance x is tensor(112.3409, device='cuda:3')
benign distance is  tensor(112.3409, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6138817071914673
distance x is tensor(108.9510, device='cuda:3')
benign distance is  tensor(108.9510, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.43983426690101624
distance x is tensor(121.9834, device='cuda:3')
benign distance is  tensor(121.9834, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.4613622725009918
distance x is tensor(108.4063, device='cuda:3')
benign distance is  tensor(108.4063, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.33076250553131104
distance x is tensor(107.4168, device='cuda:3')
benign distance is  tensor(107.4168, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.47876062989234924
distance x is tensor(108.3712, device='cuda:3')
benign distance is  tensor(108.3712, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7997134327888489
distance x is tensor(110.9063, device='cuda:3')
benign distance is  tensor(110.9063, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.45141467452049255
distance x is tensor(111.8522, device='cuda:3')
benign distance is  tensor(111.8522, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6646219491958618
distance x is tensor(114.2701, device='cuda:3')
benign distance is  tensor(114.2701, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.8806493878364563
distance x is tensor(115.5998, device='cuda:3')
benign distance is  tensor(115.5998, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 17., 16.,  8.,  8.,  8.,
         8.,  8.,  8., 11.,  9., 12.])
count_res tensor([4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03,
        4.6969e-03, 4.6969e-03, 1.7279e-03, 6.9708e-01, 2.5644e-01, 8.6027e-05,
        8.6027e-05, 8.6027e-05, 8.6027e-05, 8.6027e-05, 8.6027e-05, 1.7279e-03,
        2.3384e-04, 4.6969e-03])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 87.76% 

Test Accuracy: 87.16% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6142021417617798
distance x is tensor(90.2265, device='cuda:3')
benign distance is  tensor(90.2265, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.32576271891593933
distance x is tensor(91.6664, device='cuda:3')
benign distance is  tensor(91.6664, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3545394539833069
distance x is tensor(113.4247, device='cuda:3')
benign distance is  tensor(113.4247, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.38179484009742737
distance x is tensor(88.2135, device='cuda:3')
benign distance is  tensor(88.2135, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4771285653114319
distance x is tensor(74.3272, device='cuda:3')
benign distance is  tensor(74.3272, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8456939458847046
distance x is tensor(93.6049, device='cuda:3')
benign distance is  tensor(93.6049, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4347595274448395
distance x is tensor(99.1108, device='cuda:3')
benign distance is  tensor(99.1108, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.49581289291381836
distance x is tensor(96.3845, device='cuda:3')
benign distance is  tensor(96.3845, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([17., 13.,  1., 12., 22., 16., 16., 22., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 14., 15., 21., 12., 13., 13., 16.])
count_res tensor([2.7917e-03, 5.1132e-05, 3.1417e-10, 1.8810e-05, 4.1433e-01, 1.0270e-03,
        1.0270e-03, 4.1433e-01, 1.0270e-03, 1.0270e-03, 1.0270e-03, 1.0270e-03,
        1.0270e-03, 1.0270e-03, 1.0270e-03, 1.0270e-03, 1.0270e-03, 1.0270e-03,
        1.0270e-03, 1.0270e-03, 1.8810e-05, 1.3899e-04, 3.7782e-04, 1.5242e-01,
        1.8810e-05, 5.1132e-05, 5.1132e-05, 1.0270e-03])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 89.31% 

Test Accuracy: 88.35% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5941637754440308
distance x is tensor(92.0734, device='cuda:3')
benign distance is  tensor(92.0734, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7838994264602661
distance x is tensor(111.4934, device='cuda:3')
benign distance is  tensor(111.4934, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.09585195034742355
distance x is tensor(113.0194, device='cuda:3')
benign distance is  tensor(113.0194, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.23664510250091553
distance x is tensor(107.5015, device='cuda:3')
benign distance is  tensor(107.5015, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5354389548301697
distance x is tensor(65.1145, device='cuda:3')
benign distance is  tensor(65.1145, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7307356595993042
distance x is tensor(99.8859, device='cuda:3')
benign distance is  tensor(99.8859, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2729600965976715
distance x is tensor(113.8961, device='cuda:3')
benign distance is  tensor(113.8961, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.17365224659442902
distance x is tensor(74.9319, device='cuda:3')
benign distance is  tensor(74.9319, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5222967863082886
distance x is tensor(120.1470, device='cuda:3')
benign distance is  tensor(120.1470, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.31929606199264526
distance x is tensor(112.3035, device='cuda:3')
benign distance is  tensor(112.3035, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9381698369979858
distance x is tensor(103.3674, device='cuda:3')
benign distance is  tensor(103.3674, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3318920135498047
distance x is tensor(114.3032, device='cuda:3')
benign distance is  tensor(114.3032, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4317854344844818
distance x is tensor(116.4768, device='cuda:3')
benign distance is  tensor(116.4768, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.7637990713119507
distance x is tensor(103.4701, device='cuda:3')
benign distance is  tensor(103.4701, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4169803559780121
distance x is tensor(115.4325, device='cuda:3')
benign distance is  tensor(115.4325, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5280873775482178
distance x is tensor(113.4232, device='cuda:3')
benign distance is  tensor(113.4232, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([ 4.,  2., 15., 18., 17., 22., 22., 26., 21., 23., 23., 23., 23., 23.,
        23., 23., 23., 23., 22., 23., 20., 20., 30., 14., 23., 30., 23., 21.,
         1., 17., 27., 15., 16., 11., 14., 29.])
count_res tensor([2.0868e-12, 2.8242e-13, 1.2495e-07, 2.5096e-06, 9.2323e-07, 1.3702e-04,
        1.3702e-04, 7.4810e-03, 5.0407e-05, 3.7246e-04, 3.7246e-04, 3.7246e-04,
        3.7246e-04, 3.7246e-04, 3.7246e-04, 3.7246e-04, 3.7246e-04, 3.7246e-04,
        1.3702e-04, 3.7246e-04, 1.8544e-05, 1.8544e-05, 4.0845e-01, 4.5965e-08,
        3.7246e-04, 4.0845e-01, 3.7246e-04, 5.0407e-05, 1.0390e-13, 9.2323e-07,
        2.0336e-02, 1.2495e-07, 3.3964e-07, 2.2885e-09, 4.5965e-08, 1.5026e-01])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 89.00% 

Test Accuracy: 88.60% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6899682283401489
distance x is tensor(94.2477, device='cuda:3')
benign distance is  tensor(94.2477, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8820322751998901
distance x is tensor(111.2352, device='cuda:3')
benign distance is  tensor(111.2352, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.25051194429397583
distance x is tensor(102.7535, device='cuda:3')
benign distance is  tensor(102.7535, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5936886072158813
distance x is tensor(91.4101, device='cuda:3')
benign distance is  tensor(91.4101, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4656382203102112
distance x is tensor(72.0184, device='cuda:3')
benign distance is  tensor(72.0184, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7479346990585327
distance x is tensor(98.4580, device='cuda:3')
benign distance is  tensor(98.4580, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.49369296431541443
distance x is tensor(100.5680, device='cuda:3')
benign distance is  tensor(100.5680, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.37007826566696167
distance x is tensor(95.7008, device='cuda:3')
benign distance is  tensor(95.7008, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3253156542778015
distance x is tensor(121.2958, device='cuda:3')
benign distance is  tensor(121.2958, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5519453287124634
distance x is tensor(109.8981, device='cuda:3')
benign distance is  tensor(109.8981, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.37109655141830444
distance x is tensor(111.6366, device='cuda:3')
benign distance is  tensor(111.6366, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.32914596796035767
distance x is tensor(97.1031, device='cuda:3')
benign distance is  tensor(97.1031, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.32143402099609375
distance x is tensor(126.2038, device='cuda:3')
benign distance is  tensor(126.2038, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6052895784378052
distance x is tensor(110.8104, device='cuda:3')
benign distance is  tensor(110.8104, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.42645463347435
distance x is tensor(92.1670, device='cuda:3')
benign distance is  tensor(92.1670, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6600255370140076
distance x is tensor(107.1128, device='cuda:3')
benign distance is  tensor(107.1128, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7435576319694519
distance x is tensor(118.2599, device='cuda:3')
benign distance is  tensor(118.2599, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.23478436470031738
distance x is tensor(113.2695, device='cuda:3')
benign distance is  tensor(113.2695, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.3430790305137634
distance x is tensor(86.7906, device='cuda:3')
benign distance is  tensor(86.7906, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.11589004844427109
distance x is tensor(115.0151, device='cuda:3')
benign distance is  tensor(115.0151, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5105794072151184
distance x is tensor(108.1170, device='cuda:3')
benign distance is  tensor(108.1170, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.5419963002204895
distance x is tensor(99.1979, device='cuda:3')
benign distance is  tensor(99.1979, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.35374322533607483
distance x is tensor(109.7632, device='cuda:3')
benign distance is  tensor(109.7632, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.18132659792900085
distance x is tensor(120.0053, device='cuda:3')
benign distance is  tensor(120.0053, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([13., 20., 14., 21., 25.,  5., 32., 32., 23., 22., 23., 23., 23., 23.,
        24., 24., 24., 23., 23., 23., 20., 12., 14.,  1., 17., 15.,  9., 26.,
        13., 21., 22., 21., 32., 33.,  8.,  3.])
count_res tensor([9.7886e-10, 1.0734e-06, 2.6608e-09, 2.9179e-06, 1.5931e-04, 3.2837e-13,
        1.7471e-01, 1.7471e-01, 2.1561e-05, 7.9318e-06, 2.1561e-05, 2.1561e-05,
        2.1561e-05, 2.1561e-05, 5.8608e-05, 5.8608e-05, 5.8608e-05, 2.1561e-05,
        2.1561e-05, 2.1561e-05, 1.0734e-06, 3.6010e-10, 2.6608e-09, 6.0143e-15,
        5.3444e-08, 7.2328e-09, 1.7928e-11, 4.3306e-04, 9.7886e-10, 2.9179e-06,
        7.9318e-06, 2.9179e-06, 1.7471e-01, 4.7491e-01, 6.5955e-12, 4.4440e-14])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 89.24% 

Test Accuracy: 88.26% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3039548993110657
distance x is tensor(93.0735, device='cuda:3')
benign distance is  tensor(93.0735, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6553046107292175
distance x is tensor(104.1684, device='cuda:3')
benign distance is  tensor(104.1684, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.13524998724460602
distance x is tensor(108.9616, device='cuda:3')
benign distance is  tensor(108.9616, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4689437747001648
distance x is tensor(101.8613, device='cuda:3')
benign distance is  tensor(101.8613, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.43638190627098083
distance x is tensor(67.6408, device='cuda:3')
benign distance is  tensor(67.6408, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7477262020111084
distance x is tensor(113.5226, device='cuda:3')
benign distance is  tensor(113.5226, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.27637937664985657
distance x is tensor(109.0035, device='cuda:3')
benign distance is  tensor(109.0035, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2530686557292938
distance x is tensor(74.3590, device='cuda:3')
benign distance is  tensor(74.3590, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3958570957183838
distance x is tensor(122.1707, device='cuda:3')
benign distance is  tensor(122.1707, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.2817690968513489
distance x is tensor(121.4279, device='cuda:3')
benign distance is  tensor(121.4279, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.26518064737319946
distance x is tensor(115.7587, device='cuda:3')
benign distance is  tensor(115.7587, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.71244215965271
distance x is tensor(117.0236, device='cuda:3')
benign distance is  tensor(117.0236, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.29170483350753784
distance x is tensor(91.5370, device='cuda:3')
benign distance is  tensor(91.5370, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1517273634672165
distance x is tensor(77.2648, device='cuda:3')
benign distance is  tensor(77.2648, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9016172289848328
distance x is tensor(108.4063, device='cuda:3')
benign distance is  tensor(108.4063, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.47070980072021484
distance x is tensor(122.5212, device='cuda:3')
benign distance is  tensor(122.5212, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.12251176685094833
distance x is tensor(123.7002, device='cuda:3')
benign distance is  tensor(123.7002, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.3413006663322449
distance x is tensor(108.6353, device='cuda:3')
benign distance is  tensor(108.6353, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.30018720030784607
distance x is tensor(110.0537, device='cuda:3')
benign distance is  tensor(110.0537, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4067109525203705
distance x is tensor(120.4190, device='cuda:3')
benign distance is  tensor(120.4190, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.680148720741272
distance x is tensor(121.3337, device='cuda:3')
benign distance is  tensor(121.3337, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.2026156187057495
distance x is tensor(122.1096, device='cuda:3')
benign distance is  tensor(122.1096, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.3678520619869232
distance x is tensor(119.0302, device='cuda:3')
benign distance is  tensor(119.0302, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6100529432296753
distance x is tensor(123.3811, device='cuda:3')
benign distance is  tensor(123.3811, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 13., 13., 12., 13., 13., 12., 16., 14.,  7.,  7.,  8.,
         8.,  8.,  8.,  9., 11., 12.])
count_res tensor([1.2600e-02, 1.2600e-02, 1.2600e-02, 3.4251e-02, 3.4251e-02, 1.2600e-02,
        3.4251e-02, 3.4251e-02, 1.2600e-02, 6.8794e-01, 9.3103e-02, 8.4899e-05,
        8.4899e-05, 2.3078e-04, 2.3078e-04, 2.3078e-04, 2.3078e-04, 6.2732e-04,
        4.6353e-03, 1.2600e-02])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 88.15% 

Test Accuracy: 87.33% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.35565099120140076
distance x is tensor(92.0500, device='cuda:3')
benign distance is  tensor(92.0500, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4338925778865814
distance x is tensor(94.5551, device='cuda:3')
benign distance is  tensor(94.5551, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.0822511613368988
distance x is tensor(103.7466, device='cuda:3')
benign distance is  tensor(103.7466, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.22774282097816467
distance x is tensor(88.3907, device='cuda:3')
benign distance is  tensor(88.3907, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6478171944618225
distance x is tensor(70.2340, device='cuda:3')
benign distance is  tensor(70.2340, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.713047206401825
distance x is tensor(94.3722, device='cuda:3')
benign distance is  tensor(94.3722, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.15844745934009552
distance x is tensor(88.7921, device='cuda:3')
benign distance is  tensor(88.7921, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6756550669670105
distance x is tensor(83.7316, device='cuda:3')
benign distance is  tensor(83.7316, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 44
counter_tensor is  tensor([ 3., 22.,  3., 12., 35., 14., 38.,  1., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 21., 12., 43., 12., 14., 28., 15., 17.,
         7., 12., 32., 39., 43., 31.,  4., 13., 15., 42., 15., 14., 29., 42.,
        12., 13.])
count_res tensor([1.5385e-18, 2.7459e-10, 1.5385e-18, 1.2467e-14, 1.2148e-04, 9.2116e-14,
        2.4401e-03, 2.0821e-19, 6.0483e-06, 6.0483e-06, 6.0483e-06, 6.0483e-06,
        6.0483e-06, 6.0483e-06, 6.0483e-06, 6.0483e-06, 6.0483e-06, 6.0483e-06,
        6.0483e-06, 6.0483e-06, 1.0102e-10, 1.2467e-14, 3.6214e-01, 1.2467e-14,
        9.2116e-14, 1.1078e-07, 2.5040e-13, 1.8502e-12, 8.3999e-17, 1.2467e-14,
        6.0483e-06, 6.6328e-03, 3.6214e-01, 2.2251e-06, 4.1821e-18, 3.3888e-14,
        2.5040e-13, 1.3322e-01, 2.5040e-13, 9.2116e-14, 3.0113e-07, 1.3322e-01,
        1.2467e-14, 3.3888e-14])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 89.05% 

Test Accuracy: 88.12% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5311882495880127
distance x is tensor(92.3281, device='cuda:3')
benign distance is  tensor(92.3281, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.35529595613479614
distance x is tensor(105.4937, device='cuda:3')
benign distance is  tensor(105.4937, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.21473780274391174
distance x is tensor(107.1846, device='cuda:3')
benign distance is  tensor(107.1846, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6215661764144897
distance x is tensor(94.2980, device='cuda:3')
benign distance is  tensor(94.2980, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5911790132522583
distance x is tensor(74.3696, device='cuda:3')
benign distance is  tensor(74.3696, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1616151332855225
distance x is tensor(95.1755, device='cuda:3')
benign distance is  tensor(95.1755, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2629203796386719
distance x is tensor(107.3458, device='cuda:3')
benign distance is  tensor(107.3458, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3716886043548584
distance x is tensor(89.8979, device='cuda:3')
benign distance is  tensor(89.8979, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4016413688659668
distance x is tensor(119.4558, device='cuda:3')
benign distance is  tensor(119.4558, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4332737922668457
distance x is tensor(110.9626, device='cuda:3')
benign distance is  tensor(110.9626, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5553584694862366
distance x is tensor(106.9508, device='cuda:3')
benign distance is  tensor(106.9508, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5225009918212891
distance x is tensor(104.6995, device='cuda:3')
benign distance is  tensor(104.6995, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4767259657382965
distance x is tensor(93.9906, device='cuda:3')
benign distance is  tensor(93.9906, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.08831118792295456
distance x is tensor(95.1127, device='cuda:3')
benign distance is  tensor(95.1127, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7782477736473083
distance x is tensor(107.7882, device='cuda:3')
benign distance is  tensor(107.7882, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6506573557853699
distance x is tensor(118.0210, device='cuda:3')
benign distance is  tensor(118.0210, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2804127037525177
distance x is tensor(112.5069, device='cuda:3')
benign distance is  tensor(112.5069, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.7135387659072876
distance x is tensor(108.0053, device='cuda:3')
benign distance is  tensor(108.0053, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.14656588435173035
distance x is tensor(99.2588, device='cuda:3')
benign distance is  tensor(99.2588, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.6022461652755737
distance x is tensor(94.1870, device='cuda:3')
benign distance is  tensor(94.1870, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.39029139280319214
distance x is tensor(77.1190, device='cuda:3')
benign distance is  tensor(77.1190, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7942051291465759
distance x is tensor(105.5306, device='cuda:3')
benign distance is  tensor(105.5306, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.12316375970840454
distance x is tensor(99.5999, device='cuda:3')
benign distance is  tensor(99.5999, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.27557292580604553
distance x is tensor(108.3050, device='cuda:3')
benign distance is  tensor(108.3050, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.08735071122646332
distance x is tensor(113.2147, device='cuda:3')
benign distance is  tensor(113.2147, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.7000369429588318
distance x is tensor(103.2901, device='cuda:3')
benign distance is  tensor(103.2901, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.25480684638023376
distance x is tensor(87.5732, device='cuda:3')
benign distance is  tensor(87.5732, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.2933048605918884
distance x is tensor(110.9230, device='cuda:3')
benign distance is  tensor(110.9230, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5023729801177979
distance x is tensor(105.3455, device='cuda:3')
benign distance is  tensor(105.3455, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.0628799200057983
distance x is tensor(124.7200, device='cuda:3')
benign distance is  tensor(124.7200, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.9142013788223267
distance x is tensor(114.5164, device='cuda:3')
benign distance is  tensor(114.5164, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.16947641968727112
distance x is tensor(113.0312, device='cuda:3')
benign distance is  tensor(113.0312, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 17., 16.,  8.,  8.,  8.,
         8.,  9., 10., 11.,  8., 10.])
count_res tensor([4.7134e-03, 4.7134e-03, 4.7134e-03, 4.7134e-03, 4.7134e-03, 4.7134e-03,
        4.7134e-03, 4.7134e-03, 1.7340e-03, 6.9954e-01, 2.5735e-01, 8.6330e-05,
        8.6330e-05, 8.6330e-05, 8.6330e-05, 2.3467e-04, 6.3790e-04, 1.7340e-03,
        8.6330e-05, 6.3790e-04])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 87.88% 

Test Accuracy: 86.70% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4288305342197418
distance x is tensor(87.5001, device='cuda:3')
benign distance is  tensor(87.5001, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9899536371231079
distance x is tensor(91.3440, device='cuda:3')
benign distance is  tensor(91.3440, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.08783601224422455
distance x is tensor(98.7370, device='cuda:3')
benign distance is  tensor(98.7370, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6571587324142456
distance x is tensor(92.0553, device='cuda:3')
benign distance is  tensor(92.0553, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.668501079082489
distance x is tensor(83.9252, device='cuda:3')
benign distance is  tensor(83.9252, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4571548104286194
distance x is tensor(94.5093, device='cuda:3')
benign distance is  tensor(94.5093, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.06363411247730255
distance x is tensor(100.2933, device='cuda:3')
benign distance is  tensor(100.2933, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.29485663771629333
distance x is tensor(89.4713, device='cuda:3')
benign distance is  tensor(89.4713, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 44
counter_tensor is  tensor([28., 24., 11., 14., 12., 15., 39., 18., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 40.,  2., 36., 35., 15.,  7., 28., 17.,
        21.,  1., 16., 37., 43., 19.,  9., 42., 42.,  1., 21., 16., 22., 30.,
        12., 28.])
count_res tensor([1.6921e-07, 3.0992e-09, 7.0053e-15, 1.4071e-13, 1.9042e-14, 3.8248e-13,
        1.0132e-02, 7.6823e-12, 9.2387e-06, 9.2387e-06, 9.2387e-06, 9.2387e-06,
        9.2387e-06, 9.2387e-06, 9.2387e-06, 9.2387e-06, 9.2387e-06, 9.2387e-06,
        9.2387e-06, 9.2387e-06, 2.7540e-02, 8.6453e-19, 5.0442e-04, 1.8556e-04,
        3.8248e-13, 1.2831e-16, 1.6921e-07, 2.8261e-12, 1.5430e-10, 3.1804e-19,
        1.0397e-12, 1.3711e-03, 5.5316e-01, 2.0883e-11, 9.4807e-16, 2.0350e-01,
        2.0350e-01, 3.1804e-19, 1.5430e-10, 1.0397e-12, 4.1944e-10, 1.2503e-06,
        1.9042e-14, 1.6921e-07])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 88.47% 

Test Accuracy: 87.90% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.50072181224823
distance x is tensor(90.5812, device='cuda:3')
benign distance is  tensor(90.5812, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5706878900527954
distance x is tensor(109.8332, device='cuda:3')
benign distance is  tensor(109.8332, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.06787081807851791
distance x is tensor(113.4457, device='cuda:3')
benign distance is  tensor(113.4457, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6655145883560181
distance x is tensor(97.4930, device='cuda:3')
benign distance is  tensor(97.4930, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5913989543914795
distance x is tensor(79.8332, device='cuda:3')
benign distance is  tensor(79.8332, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9449822306632996
distance x is tensor(104.8532, device='cuda:3')
benign distance is  tensor(104.8532, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.24735483527183533
distance x is tensor(99.5265, device='cuda:3')
benign distance is  tensor(99.5265, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7780696153640747
distance x is tensor(104.4112, device='cuda:3')
benign distance is  tensor(104.4112, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6136299967765808
distance x is tensor(116.8431, device='cuda:3')
benign distance is  tensor(116.8431, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.46107786893844604
distance x is tensor(117.6744, device='cuda:3')
benign distance is  tensor(117.6744, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5108989477157593
distance x is tensor(107.6425, device='cuda:3')
benign distance is  tensor(107.6425, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9107009768486023
distance x is tensor(121.4412, device='cuda:3')
benign distance is  tensor(121.4412, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.745656430721283
distance x is tensor(92.0743, device='cuda:3')
benign distance is  tensor(92.0743, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.15313521027565002
distance x is tensor(96.7389, device='cuda:3')
benign distance is  tensor(96.7389, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9064467549324036
distance x is tensor(123.8219, device='cuda:3')
benign distance is  tensor(123.8219, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9492179751396179
distance x is tensor(118.5152, device='cuda:3')
benign distance is  tensor(118.5152, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3469999432563782
distance x is tensor(127.4218, device='cuda:3')
benign distance is  tensor(127.4218, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6618805527687073
distance x is tensor(113.4173, device='cuda:3')
benign distance is  tensor(113.4173, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.24366240203380585
distance x is tensor(112.0937, device='cuda:3')
benign distance is  tensor(112.0937, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.073624849319458
distance x is tensor(109.7299, device='cuda:3')
benign distance is  tensor(109.7299, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6620639562606812
distance x is tensor(72.4857, device='cuda:3')
benign distance is  tensor(72.4857, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.2309720814228058
distance x is tensor(108.0409, device='cuda:3')
benign distance is  tensor(108.0409, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.46760544180870056
distance x is tensor(114.3194, device='cuda:3')
benign distance is  tensor(114.3194, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.5995231866836548
distance x is tensor(108.8645, device='cuda:3')
benign distance is  tensor(108.8645, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.5701555013656616
distance x is tensor(111.9951, device='cuda:3')
benign distance is  tensor(111.9951, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.1719326376914978
distance x is tensor(126.3437, device='cuda:3')
benign distance is  tensor(126.3437, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5998601913452148
distance x is tensor(108.9713, device='cuda:3')
benign distance is  tensor(108.9713, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.1502235382795334
distance x is tensor(117.1498, device='cuda:3')
benign distance is  tensor(117.1498, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.0095717906951904
distance x is tensor(108.4513, device='cuda:3')
benign distance is  tensor(108.4513, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.6675683259963989
distance x is tensor(100.8651, device='cuda:3')
benign distance is  tensor(100.8651, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7176004648208618
distance x is tensor(106.1089, device='cuda:3')
benign distance is  tensor(106.1089, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.3476824164390564
distance x is tensor(101.6333, device='cuda:3')
benign distance is  tensor(101.6333, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 17.,  0., 12., 12., 12., 16., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 21., 12., 12., 12., 12., 12., 12., 27.])
count_res tensor([1.5274e-07, 2.2669e-05, 9.3848e-13, 1.5274e-07, 1.5274e-07, 1.5274e-07,
        8.3394e-06, 4.9931e-01, 8.3394e-06, 8.3394e-06, 8.3394e-06, 8.3394e-06,
        8.3394e-06, 8.3394e-06, 8.3394e-06, 8.3394e-06, 8.3394e-06, 8.3394e-06,
        8.3394e-06, 8.3394e-06, 1.2377e-03, 1.5274e-07, 1.5274e-07, 1.5274e-07,
        1.5274e-07, 1.5274e-07, 1.5274e-07, 4.9931e-01])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 88.93% 

Test Accuracy: 88.57% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4315006136894226
distance x is tensor(120.5618, device='cuda:3')
benign distance is  tensor(120.5618, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6401627659797668
distance x is tensor(114.3903, device='cuda:3')
benign distance is  tensor(114.3903, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.15847767889499664
distance x is tensor(124.0626, device='cuda:3')
benign distance is  tensor(124.0626, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4781460762023926
distance x is tensor(104.7423, device='cuda:3')
benign distance is  tensor(104.7423, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5012377500534058
distance x is tensor(92.4825, device='cuda:3')
benign distance is  tensor(92.4825, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7262125015258789
distance x is tensor(104.3504, device='cuda:3')
benign distance is  tensor(104.3504, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9096214175224304
distance x is tensor(101.7950, device='cuda:3')
benign distance is  tensor(101.7950, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.276001513004303
distance x is tensor(82.0868, device='cuda:3')
benign distance is  tensor(82.0868, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.564155638217926
distance x is tensor(120.3585, device='cuda:3')
benign distance is  tensor(120.3585, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.907701849937439
distance x is tensor(120.8493, device='cuda:3')
benign distance is  tensor(120.8493, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2708614766597748
distance x is tensor(108.5584, device='cuda:3')
benign distance is  tensor(108.5584, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.20595557987689972
distance x is tensor(111.8810, device='cuda:3')
benign distance is  tensor(111.8810, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.2716171145439148
distance x is tensor(105.6264, device='cuda:3')
benign distance is  tensor(105.6264, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8859285116195679
distance x is tensor(110.1454, device='cuda:3')
benign distance is  tensor(110.1454, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5285378694534302
distance x is tensor(111.4489, device='cuda:3')
benign distance is  tensor(111.4489, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.55440354347229
distance x is tensor(77.7225, device='cuda:3')
benign distance is  tensor(77.7225, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12.,  2., 10., 25., 12., 12., 26., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 27., 17., 13., 12., 12., 12.])
count_res tensor([2.0346e-07, 9.2373e-12, 2.7536e-08, 9.0016e-02, 2.0346e-07, 2.0346e-07,
        2.4469e-01, 2.0346e-07, 1.1109e-05, 1.1109e-05, 1.1109e-05, 1.1109e-05,
        1.1109e-05, 1.1109e-05, 1.1109e-05, 1.1109e-05, 1.1109e-05, 1.1109e-05,
        1.1109e-05, 1.1109e-05, 2.0346e-07, 2.0346e-07, 6.6513e-01, 3.0197e-05,
        5.5308e-07, 2.0346e-07, 2.0346e-07, 2.0346e-07])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 88.72% 

Test Accuracy: 87.90% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6928828954696655
distance x is tensor(103.5092, device='cuda:3')
benign distance is  tensor(103.5092, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0948164463043213
distance x is tensor(110.2219, device='cuda:3')
benign distance is  tensor(110.2219, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.23795995116233826
distance x is tensor(113.0307, device='cuda:3')
benign distance is  tensor(113.0307, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5704140067100525
distance x is tensor(101.8872, device='cuda:3')
benign distance is  tensor(101.8872, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.22178404033184052
distance x is tensor(94.2431, device='cuda:3')
benign distance is  tensor(94.2431, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4085143506526947
distance x is tensor(106.6981, device='cuda:3')
benign distance is  tensor(106.6981, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6961585283279419
distance x is tensor(88.2143, device='cuda:3')
benign distance is  tensor(88.2143, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6456331610679626
distance x is tensor(86.7955, device='cuda:3')
benign distance is  tensor(86.7955, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.45137661695480347
distance x is tensor(109.7082, device='cuda:3')
benign distance is  tensor(109.7082, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3996557295322418
distance x is tensor(120.5798, device='cuda:3')
benign distance is  tensor(120.5798, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6646438837051392
distance x is tensor(64.7328, device='cuda:3')
benign distance is  tensor(64.7328, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4555625319480896
distance x is tensor(117.6089, device='cuda:3')
benign distance is  tensor(117.6089, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.42233601212501526
distance x is tensor(107.1387, device='cuda:3')
benign distance is  tensor(107.1387, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.13485956192016602
distance x is tensor(100.9832, device='cuda:3')
benign distance is  tensor(100.9832, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5097143650054932
distance x is tensor(111.4100, device='cuda:3')
benign distance is  tensor(111.4100, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.86650151014328
distance x is tensor(122.2926, device='cuda:3')
benign distance is  tensor(122.2926, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 19., 17., 16.,  8.,  8.,  8.,
         8.,  8.,  8.,  1., 11., 12.])
count_res tensor([7.6387e-04, 7.6387e-04, 7.6387e-04, 7.6387e-04, 7.6387e-04, 7.6387e-04,
        7.6387e-04, 7.6387e-04, 8.3769e-01, 1.1337e-01, 4.1706e-02, 1.3991e-05,
        1.3991e-05, 1.3991e-05, 1.3991e-05, 1.3991e-05, 1.3991e-05, 1.2758e-08,
        2.8101e-04, 7.6387e-04])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 87.19% 

Test Accuracy: 86.46% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6405288577079773
distance x is tensor(91.8989, device='cuda:3')
benign distance is  tensor(91.8989, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3101667165756226
distance x is tensor(102.6752, device='cuda:3')
benign distance is  tensor(102.6752, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.14647693932056427
distance x is tensor(112.3422, device='cuda:3')
benign distance is  tensor(112.3422, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.48845356702804565
distance x is tensor(94.7372, device='cuda:3')
benign distance is  tensor(94.7372, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1877119541168213
distance x is tensor(75.4001, device='cuda:3')
benign distance is  tensor(75.4001, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6216880083084106
distance x is tensor(96.1681, device='cuda:3')
benign distance is  tensor(96.1681, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.16661019623279572
distance x is tensor(85.7993, device='cuda:3')
benign distance is  tensor(85.7993, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.10166702419519424
distance x is tensor(82.3982, device='cuda:3')
benign distance is  tensor(82.3982, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 52
counter_tensor is  tensor([26., 42.,  4.,  3., 41., 16., 20., 25., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 46., 18., 24.,  2., 40., 15., 39., 14.,
        24.,  1., 22., 36., 30., 21., 15., 48., 40.,  5., 12., 36., 26., 48.,
         2.,  6., 24., 37., 34., 43., 41., 51.,  1., 19.])
count_res tensor([1.2544e-11, 1.1147e-04, 3.4992e-21, 1.2873e-21, 4.1008e-05, 5.6951e-16,
        3.1094e-14, 4.6148e-12, 1.5086e-05, 1.5086e-05, 1.5086e-05, 1.5086e-05,
        1.5086e-05, 1.5086e-05, 1.5086e-05, 1.5086e-05, 1.5086e-05, 1.5086e-05,
        1.5086e-05, 1.5086e-05, 6.0861e-03, 4.2082e-15, 1.6977e-12, 4.7357e-22,
        1.5086e-05, 2.0951e-16, 5.5498e-06, 7.7075e-17, 1.6977e-12, 1.7422e-22,
        2.2976e-13, 2.7631e-07, 6.8490e-10, 8.4524e-14, 2.0951e-16, 4.4971e-02,
        1.5086e-05, 9.5119e-21, 1.0431e-17, 2.7631e-07, 1.2544e-11, 4.4971e-02,
        4.7357e-22, 2.5856e-20, 1.6977e-12, 7.5109e-07, 3.7394e-08, 3.0301e-04,
        4.1008e-05, 9.0326e-01, 1.7422e-22, 1.1439e-14])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 88.34% 

Test Accuracy: 87.66% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6815778613090515
distance x is tensor(128.4706, device='cuda:3')
benign distance is  tensor(128.4706, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3126010596752167
distance x is tensor(121.8510, device='cuda:3')
benign distance is  tensor(121.8510, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.11861996352672577
distance x is tensor(131.2729, device='cuda:3')
benign distance is  tensor(131.2729, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.19485600292682648
distance x is tensor(115.0029, device='cuda:3')
benign distance is  tensor(115.0029, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.26782190799713135
distance x is tensor(109.1337, device='cuda:3')
benign distance is  tensor(109.1337, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6353543400764465
distance x is tensor(122.8514, device='cuda:3')
benign distance is  tensor(122.8514, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.22574779391288757
distance x is tensor(119.9038, device='cuda:3')
benign distance is  tensor(119.9038, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5622485280036926
distance x is tensor(112.5781, device='cuda:3')
benign distance is  tensor(112.5781, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.312039315700531
distance x is tensor(133.3954, device='cuda:3')
benign distance is  tensor(133.3954, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.44405603408813477
distance x is tensor(119.1262, device='cuda:3')
benign distance is  tensor(119.1262, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.26255324482917786
distance x is tensor(91.7772, device='cuda:3')
benign distance is  tensor(91.7772, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.09964919090271
distance x is tensor(135.7230, device='cuda:3')
benign distance is  tensor(135.7230, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.46848592162132263
distance x is tensor(112.9790, device='cuda:3')
benign distance is  tensor(112.9790, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.20539620518684387
distance x is tensor(38.6198, device='cuda:3')
benign distance is  tensor(38.6198, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5944849252700806
distance x is tensor(128.2434, device='cuda:3')
benign distance is  tensor(128.2434, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.47108617424964905
distance x is tensor(130.7497, device='cuda:3')
benign distance is  tensor(130.7497, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.22392217814922333
distance x is tensor(136.4102, device='cuda:3')
benign distance is  tensor(136.4102, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5720853209495544
distance x is tensor(135.0303, device='cuda:3')
benign distance is  tensor(135.0303, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2144664078950882
distance x is tensor(123.7642, device='cuda:3')
benign distance is  tensor(123.7642, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.32098716497421265
distance x is tensor(127.0764, device='cuda:3')
benign distance is  tensor(127.0764, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.03271013870835304
distance x is tensor(129.1960, device='cuda:3')
benign distance is  tensor(129.1960, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4728558659553528
distance x is tensor(136.7581, device='cuda:3')
benign distance is  tensor(136.7581, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.7305580973625183
distance x is tensor(129.9093, device='cuda:3')
benign distance is  tensor(129.9093, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.46151918172836304
distance x is tensor(129.6177, device='cuda:3')
benign distance is  tensor(129.6177, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.16658543050289154
distance x is tensor(140.5472, device='cuda:3')
benign distance is  tensor(140.5472, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5408974885940552
distance x is tensor(123.0623, device='cuda:3')
benign distance is  tensor(123.0623, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.40100130438804626
distance x is tensor(128.5306, device='cuda:3')
benign distance is  tensor(128.5306, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.534439742565155
distance x is tensor(134.8921, device='cuda:3')
benign distance is  tensor(134.8921, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.0435457229614258
distance x is tensor(112.7367, device='cuda:3')
benign distance is  tensor(112.7367, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4260551333427429
distance x is tensor(126.0056, device='cuda:3')
benign distance is  tensor(126.0056, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5088059306144714
distance x is tensor(132.9246, device='cuda:3')
benign distance is  tensor(132.9246, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.5707152485847473
distance x is tensor(121.4423, device='cuda:3')
benign distance is  tensor(121.4423, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.3773530423641205
distance x is tensor(127.6061, device='cuda:3')
benign distance is  tensor(127.6061, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.7510096430778503
distance x is tensor(127.5520, device='cuda:3')
benign distance is  tensor(127.5520, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.17292961478233337
distance x is tensor(125.4108, device='cuda:3')
benign distance is  tensor(125.4108, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.14810310304164886
distance x is tensor(123.8888, device='cuda:3')
benign distance is  tensor(123.8888, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.20771102607250214
distance x is tensor(133.0370, device='cuda:3')
benign distance is  tensor(133.0370, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.4826887249946594
distance x is tensor(129.2243, device='cuda:3')
benign distance is  tensor(129.2243, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.1151725053787231
distance x is tensor(115.7668, device='cuda:3')
benign distance is  tensor(115.7668, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.3450864851474762
distance x is tensor(125.6606, device='cuda:3')
benign distance is  tensor(125.6606, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 12., 12., 12., 26., 21., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 19.,  0., 12., 12., 27., 12., 20., 12.])
count_res tensor([2.2299e-07, 2.2299e-07, 2.2299e-07, 2.2299e-07, 2.6817e-01, 1.8069e-03,
        2.2299e-07, 2.2299e-07, 1.2175e-05, 1.2175e-05, 1.2175e-05, 1.2175e-05,
        1.2175e-05, 1.2175e-05, 1.2175e-05, 1.2175e-05, 1.2175e-05, 1.2175e-05,
        1.2175e-05, 1.2175e-05, 2.4454e-04, 1.3701e-12, 2.2299e-07, 2.2299e-07,
        7.2896e-01, 2.2299e-07, 6.6473e-04, 2.2299e-07])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 88.46% 

Test Accuracy: 88.01% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.48052993416786194
distance x is tensor(100.7836, device='cuda:3')
benign distance is  tensor(100.7836, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0967175960540771
distance x is tensor(112.2290, device='cuda:3')
benign distance is  tensor(112.2290, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.40149831771850586
distance x is tensor(122.2603, device='cuda:3')
benign distance is  tensor(122.2603, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9475275874137878
distance x is tensor(96.4080, device='cuda:3')
benign distance is  tensor(96.4080, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.11243319511413574
distance x is tensor(74.7143, device='cuda:3')
benign distance is  tensor(74.7143, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8046184778213501
distance x is tensor(107.0995, device='cuda:3')
benign distance is  tensor(107.0995, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6310189366340637
distance x is tensor(104.0763, device='cuda:3')
benign distance is  tensor(104.0763, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.39121681451797485
distance x is tensor(105.6800, device='cuda:3')
benign distance is  tensor(105.6800, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3951718807220459
distance x is tensor(132.1370, device='cuda:3')
benign distance is  tensor(132.1370, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.15339580178260803
distance x is tensor(121.2658, device='cuda:3')
benign distance is  tensor(121.2658, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7349591851234436
distance x is tensor(123.8739, device='cuda:3')
benign distance is  tensor(123.8739, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.019464220851659775
distance x is tensor(117.2388, device='cuda:3')
benign distance is  tensor(117.2388, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.0399367809295654
distance x is tensor(64.3298, device='cuda:3')
benign distance is  tensor(64.3298, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.46096691489219666
distance x is tensor(123.9156, device='cuda:3')
benign distance is  tensor(123.9156, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.0793389081954956
distance x is tensor(110.2674, device='cuda:3')
benign distance is  tensor(110.2674, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.25786980986595154
distance x is tensor(112.4089, device='cuda:3')
benign distance is  tensor(112.4089, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([13., 12.,  0., 12., 24., 12., 12., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 17., 12., 12., 27., 12., 12.])
count_res tensor([4.0562e-07, 1.4922e-07, 9.1683e-13, 1.4922e-07, 2.4286e-02, 1.4922e-07,
        1.4922e-07, 4.8780e-01, 8.1470e-06, 8.1470e-06, 8.1470e-06, 8.1470e-06,
        8.1470e-06, 8.1470e-06, 8.1470e-06, 8.1470e-06, 8.1470e-06, 8.1470e-06,
        8.1470e-06, 8.1470e-06, 1.4922e-07, 1.4922e-07, 2.2146e-05, 1.4922e-07,
        1.4922e-07, 4.8780e-01, 1.4922e-07, 1.4922e-07])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 89.13% 

Test Accuracy: 88.69% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.47945237159729004
distance x is tensor(129.6519, device='cuda:3')
benign distance is  tensor(129.6519, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.869458794593811
distance x is tensor(122.9314, device='cuda:3')
benign distance is  tensor(122.9314, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.14214737713336945
distance x is tensor(126.4442, device='cuda:3')
benign distance is  tensor(126.4442, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.33076706528663635
distance x is tensor(118.0307, device='cuda:3')
benign distance is  tensor(118.0307, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9216855764389038
distance x is tensor(90.1644, device='cuda:3')
benign distance is  tensor(90.1644, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3666122853755951
distance x is tensor(110.0166, device='cuda:3')
benign distance is  tensor(110.0166, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.07963617891073227
distance x is tensor(110.3822, device='cuda:3')
benign distance is  tensor(110.3822, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5427917838096619
distance x is tensor(60.0162, device='cuda:3')
benign distance is  tensor(60.0162, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.44414377212524414
distance x is tensor(134.2249, device='cuda:3')
benign distance is  tensor(134.2249, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5944061279296875
distance x is tensor(131.9922, device='cuda:3')
benign distance is  tensor(131.9922, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3690536320209503
distance x is tensor(97.7335, device='cuda:3')
benign distance is  tensor(97.7335, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.807869553565979
distance x is tensor(132.1232, device='cuda:3')
benign distance is  tensor(132.1232, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.2960700988769531
distance x is tensor(116.2933, device='cuda:3')
benign distance is  tensor(116.2933, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3965928256511688
distance x is tensor(72.8688, device='cuda:3')
benign distance is  tensor(72.8688, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6542757749557495
distance x is tensor(130.7921, device='cuda:3')
benign distance is  tensor(130.7921, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6110427975654602
distance x is tensor(136.0874, device='cuda:3')
benign distance is  tensor(136.0874, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 12., 12., 15., 12., 12., 27., 26., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 12., 12.,  1., 12., 13., 12., 12.])
count_res tensor([1.2918e-07, 1.2918e-07, 1.2918e-07, 2.5946e-06, 1.2918e-07, 1.2918e-07,
        4.2228e-01, 1.5535e-01, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06,
        7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06,
        7.0528e-06, 7.0528e-06, 4.2228e-01, 1.2918e-07, 1.2918e-07, 2.1575e-12,
        1.2918e-07, 3.5114e-07, 1.2918e-07, 1.2918e-07])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 89.25% 

Test Accuracy: 88.53% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.11607973277568817
distance x is tensor(108.3488, device='cuda:3')
benign distance is  tensor(108.3488, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4888894557952881
distance x is tensor(115.4791, device='cuda:3')
benign distance is  tensor(115.4791, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.23035526275634766
distance x is tensor(120.8644, device='cuda:3')
benign distance is  tensor(120.8644, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.36742711067199707
distance x is tensor(103.9873, device='cuda:3')
benign distance is  tensor(103.9873, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4006975591182709
distance x is tensor(85.4570, device='cuda:3')
benign distance is  tensor(85.4570, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.36202308535575867
distance x is tensor(115.8011, device='cuda:3')
benign distance is  tensor(115.8011, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.10543353855609894
distance x is tensor(70.0451, device='cuda:3')
benign distance is  tensor(70.0451, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3536801338195801
distance x is tensor(80.2139, device='cuda:3')
benign distance is  tensor(80.2139, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4612957537174225
distance x is tensor(82.7260, device='cuda:3')
benign distance is  tensor(82.7260, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4404504895210266
distance x is tensor(116.0229, device='cuda:3')
benign distance is  tensor(116.0229, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.16037499904632568
distance x is tensor(124.3042, device='cuda:3')
benign distance is  tensor(124.3042, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.6321398019790649
distance x is tensor(104.4594, device='cuda:3')
benign distance is  tensor(104.4594, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.18332724273204803
distance x is tensor(121.2448, device='cuda:3')
benign distance is  tensor(121.2448, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8197335004806519
distance x is tensor(113.6818, device='cuda:3')
benign distance is  tensor(113.6818, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3864303231239319
distance x is tensor(118.0070, device='cuda:3')
benign distance is  tensor(118.0070, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8747595548629761
distance x is tensor(113.5735, device='cuda:3')
benign distance is  tensor(113.5735, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([14.,  2., 14., 13., 35., 15., 15., 26., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 14., 20., 32., 30., 15., 12., 14., 34.,
        15., 12., 13., 22.,  4., 35.,  2., 19.])
count_res tensor([3.1272e-10, 1.9214e-15, 3.1272e-10, 1.1504e-10, 4.1242e-01, 8.5005e-10,
        8.5005e-10, 5.0896e-05, 6.8881e-06, 6.8881e-06, 6.8881e-06, 6.8881e-06,
        6.8881e-06, 6.8881e-06, 6.8881e-06, 6.8881e-06, 6.8881e-06, 6.8881e-06,
        6.8881e-06, 6.8881e-06, 3.1272e-10, 1.2616e-07, 2.0533e-02, 2.7788e-03,
        8.5005e-10, 4.2322e-11, 3.1272e-10, 1.5172e-01, 8.5005e-10, 4.2322e-11,
        1.1504e-10, 9.3220e-07, 1.4197e-14, 4.1242e-01, 1.9214e-15, 4.6411e-08])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 89.49% 

Test Accuracy: 88.58% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5902367830276489
distance x is tensor(108.5821, device='cuda:3')
benign distance is  tensor(108.5821, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3288523554801941
distance x is tensor(123.2391, device='cuda:3')
benign distance is  tensor(123.2391, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2760675549507141
distance x is tensor(125.9516, device='cuda:3')
benign distance is  tensor(125.9516, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.1590396612882614
distance x is tensor(101.5404, device='cuda:3')
benign distance is  tensor(101.5404, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4586881697177887
distance x is tensor(64.7785, device='cuda:3')
benign distance is  tensor(64.7785, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5957788825035095
distance x is tensor(109.0137, device='cuda:3')
benign distance is  tensor(109.0137, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6658961772918701
distance x is tensor(97.8897, device='cuda:3')
benign distance is  tensor(97.8897, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1123332604765892
distance x is tensor(81.0823, device='cuda:3')
benign distance is  tensor(81.0823, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4408494830131531
distance x is tensor(127.3526, device='cuda:3')
benign distance is  tensor(127.3526, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3318879008293152
distance x is tensor(124.1384, device='cuda:3')
benign distance is  tensor(124.1384, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.47860345244407654
distance x is tensor(117.2542, device='cuda:3')
benign distance is  tensor(117.2542, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4888484477996826
distance x is tensor(133.5405, device='cuda:3')
benign distance is  tensor(133.5405, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.48078426718711853
distance x is tensor(124.1376, device='cuda:3')
benign distance is  tensor(124.1376, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.26023176312446594
distance x is tensor(43.7536, device='cuda:3')
benign distance is  tensor(43.7536, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5319745540618896
distance x is tensor(126.9598, device='cuda:3')
benign distance is  tensor(126.9598, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8277884721755981
distance x is tensor(134.0810, device='cuda:3')
benign distance is  tensor(134.0810, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.045802611857652664
distance x is tensor(128.8442, device='cuda:3')
benign distance is  tensor(128.8442, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6359148025512695
distance x is tensor(132.4342, device='cuda:3')
benign distance is  tensor(132.4342, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.6101506352424622
distance x is tensor(141.3877, device='cuda:3')
benign distance is  tensor(141.3877, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.7683006525039673
distance x is tensor(142.7698, device='cuda:3')
benign distance is  tensor(142.7698, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7323080897331238
distance x is tensor(114.5501, device='cuda:3')
benign distance is  tensor(114.5501, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.44928377866744995
distance x is tensor(126.4841, device='cuda:3')
benign distance is  tensor(126.4841, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.2378867119550705
distance x is tensor(130.1914, device='cuda:3')
benign distance is  tensor(130.1914, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.5727735161781311
distance x is tensor(108.0712, device='cuda:3')
benign distance is  tensor(108.0712, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 17., 16.,  8.,  8.,  8.,
         8.,  8.,  9.,  8., 11., 12.])
count_res tensor([4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03,
        4.6969e-03, 4.6969e-03, 1.7279e-03, 6.9708e-01, 2.5644e-01, 8.6027e-05,
        8.6027e-05, 8.6027e-05, 8.6027e-05, 8.6027e-05, 2.3384e-04, 8.6027e-05,
        1.7279e-03, 4.6969e-03])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 88.10% 

Test Accuracy: 87.37% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3766579031944275
distance x is tensor(107.4844, device='cuda:3')
benign distance is  tensor(107.4844, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.19555217027664185
distance x is tensor(108.1946, device='cuda:3')
benign distance is  tensor(108.1946, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.21771463751792908
distance x is tensor(118.7738, device='cuda:3')
benign distance is  tensor(118.7738, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7106824517250061
distance x is tensor(103.5416, device='cuda:3')
benign distance is  tensor(103.5416, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.21378159523010254
distance x is tensor(58.3868, device='cuda:3')
benign distance is  tensor(58.3868, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4655863344669342
distance x is tensor(101.8783, device='cuda:3')
benign distance is  tensor(101.8783, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5462006330490112
distance x is tensor(91.5670, device='cuda:3')
benign distance is  tensor(91.5670, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5020860433578491
distance x is tensor(73.6140, device='cuda:3')
benign distance is  tensor(73.6140, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 52
counter_tensor is  tensor([50., 22.,  1.,  0., 51., 16., 49.,  0., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40.,  0.,  2., 13., 12., 13., 47.,  7., 50.,
         3., 23., 12., 13., 50., 44., 12., 51., 47., 12.,  0., 12., 51., 51.,
         0., 51., 12., 22., 18., 51., 32., 51.,  1.,  0.])
count_res tensor([4.4448e-02, 3.0733e-14, 2.3303e-23, 8.5728e-24, 1.2082e-01, 7.6179e-17,
        1.6351e-02, 8.5728e-24, 2.0179e-06, 2.0179e-06, 2.0179e-06, 2.0179e-06,
        2.0179e-06, 2.0179e-06, 2.0179e-06, 2.0179e-06, 2.0179e-06, 2.0179e-06,
        2.0179e-06, 2.0179e-06, 8.5728e-24, 6.3345e-23, 3.7927e-18, 1.3953e-18,
        3.7927e-18, 2.2129e-03, 9.4012e-21, 4.4448e-02, 1.7219e-22, 8.3540e-14,
        1.3953e-18, 3.7927e-18, 4.4448e-02, 1.1017e-04, 1.3953e-18, 1.2082e-01,
        2.2129e-03, 1.3953e-18, 8.5728e-24, 1.3953e-18, 1.2082e-01, 1.2082e-01,
        8.5728e-24, 1.2082e-01, 1.3953e-18, 3.0733e-14, 5.6289e-16, 1.2082e-01,
        6.7693e-10, 1.2082e-01, 2.3303e-23, 8.5728e-24])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 89.62% 

Test Accuracy: 89.11% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.24915914237499237
distance x is tensor(88.4690, device='cuda:3')
benign distance is  tensor(88.4690, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8412380218505859
distance x is tensor(107.8867, device='cuda:3')
benign distance is  tensor(107.8867, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1326017677783966
distance x is tensor(120.8644, device='cuda:3')
benign distance is  tensor(120.8644, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.40236878395080566
distance x is tensor(102.6010, device='cuda:3')
benign distance is  tensor(102.6010, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6590255498886108
distance x is tensor(58.9789, device='cuda:3')
benign distance is  tensor(58.9789, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7412468194961548
distance x is tensor(100.3798, device='cuda:3')
benign distance is  tensor(100.3798, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3374505043029785
distance x is tensor(75.1102, device='cuda:3')
benign distance is  tensor(75.1102, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.47565048933029175
distance x is tensor(75.9318, device='cuda:3')
benign distance is  tensor(75.9318, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4147799015045166
distance x is tensor(127.3728, device='cuda:3')
benign distance is  tensor(127.3728, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6154455542564392
distance x is tensor(109.8590, device='cuda:3')
benign distance is  tensor(109.8590, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5269379615783691
distance x is tensor(103.7956, device='cuda:3')
benign distance is  tensor(103.7956, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.851142406463623
distance x is tensor(109.2366, device='cuda:3')
benign distance is  tensor(109.2366, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4709579050540924
distance x is tensor(98.0433, device='cuda:3')
benign distance is  tensor(98.0433, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3200678527355194
distance x is tensor(46.9018, device='cuda:3')
benign distance is  tensor(46.9018, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.8454501032829285
distance x is tensor(119.4174, device='cuda:3')
benign distance is  tensor(119.4174, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8662117123603821
distance x is tensor(132.0684, device='cuda:3')
benign distance is  tensor(132.0684, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4417409300804138
distance x is tensor(110.2074, device='cuda:3')
benign distance is  tensor(110.2074, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.1195180416107178
distance x is tensor(111.4998, device='cuda:3')
benign distance is  tensor(111.4998, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.6966348886489868
distance x is tensor(121.1076, device='cuda:3')
benign distance is  tensor(121.1076, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.12913325428962708
distance x is tensor(91.0405, device='cuda:3')
benign distance is  tensor(91.0405, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.201628640294075
distance x is tensor(108.6886, device='cuda:3')
benign distance is  tensor(108.6886, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.3063199520111084
distance x is tensor(104.2385, device='cuda:3')
benign distance is  tensor(104.2385, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5965560674667358
distance x is tensor(99.8455, device='cuda:3')
benign distance is  tensor(99.8455, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4294511675834656
distance x is tensor(111.2427, device='cuda:3')
benign distance is  tensor(111.2427, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.2822287678718567
distance x is tensor(116.9361, device='cuda:3')
benign distance is  tensor(116.9361, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.03801354020833969
distance x is tensor(134.4242, device='cuda:3')
benign distance is  tensor(134.4242, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5820013880729675
distance x is tensor(118.7914, device='cuda:3')
benign distance is  tensor(118.7914, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.2255595475435257
distance x is tensor(116.5873, device='cuda:3')
benign distance is  tensor(116.5873, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.22515878081321716
distance x is tensor(102.8165, device='cuda:3')
benign distance is  tensor(102.8165, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.7828820943832397
distance x is tensor(110.6522, device='cuda:3')
benign distance is  tensor(110.6522, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.34773749113082886
distance x is tensor(106.7941, device='cuda:3')
benign distance is  tensor(106.7941, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.417719304561615
distance x is tensor(103.1415, device='cuda:3')
benign distance is  tensor(103.1415, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.10352683067321777
distance x is tensor(117.3206, device='cuda:3')
benign distance is  tensor(117.3206, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.36805960536003113
distance x is tensor(110.3214, device='cuda:3')
benign distance is  tensor(110.3214, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.03919460251927376
distance x is tensor(113.5043, device='cuda:3')
benign distance is  tensor(113.5043, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.48612457513809204
distance x is tensor(112.8964, device='cuda:3')
benign distance is  tensor(112.8964, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5984684228897095
distance x is tensor(110.5319, device='cuda:3')
benign distance is  tensor(110.5319, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7235504388809204
distance x is tensor(114.6774, device='cuda:3')
benign distance is  tensor(114.6774, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.0774986743927002
distance x is tensor(115.5138, device='cuda:3')
benign distance is  tensor(115.5138, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.558982253074646
distance x is tensor(123.9198, device='cuda:3')
benign distance is  tensor(123.9198, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 17., 15.,  8.,  8.,  8.,
         8.,  8.,  8.,  9., 11., 13.])
count_res tensor([5.5521e-03, 5.5521e-03, 5.5521e-03, 5.5521e-03, 5.5521e-03, 5.5521e-03,
        5.5521e-03, 5.5521e-03, 2.0425e-03, 8.2400e-01, 1.1152e-01, 1.0169e-04,
        1.0169e-04, 1.0169e-04, 1.0169e-04, 1.0169e-04, 1.0169e-04, 2.7642e-04,
        2.0425e-03, 1.5092e-02])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 89.01% 

Test Accuracy: 87.96% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3458848297595978
distance x is tensor(88.2922, device='cuda:3')
benign distance is  tensor(88.2922, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5122424364089966
distance x is tensor(101.7575, device='cuda:3')
benign distance is  tensor(101.7575, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.015160071663558483
distance x is tensor(99.6379, device='cuda:3')
benign distance is  tensor(99.6379, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5069639682769775
distance x is tensor(91.2177, device='cuda:3')
benign distance is  tensor(91.2177, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2771865427494049
distance x is tensor(57.6633, device='cuda:3')
benign distance is  tensor(57.6633, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8833538293838501
distance x is tensor(95.2215, device='cuda:3')
benign distance is  tensor(95.2215, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.39048799872398376
distance x is tensor(71.1959, device='cuda:3')
benign distance is  tensor(71.1959, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4669601321220398
distance x is tensor(68.3526, device='cuda:3')
benign distance is  tensor(68.3526, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([27.,  0., 32., 12., 12., 12., 33., 14., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 14., 35.,  2., 22., 14., 12.,  0., 21.,
        12., 12., 14., 34., 12., 34.,  1., 15.])
count_res tensor([1.7459e-04, 3.2815e-16, 2.5912e-02, 5.3408e-11, 5.3408e-11, 5.3408e-11,
        7.0435e-02, 3.9463e-10, 8.6924e-06, 8.6924e-06, 8.6924e-06, 8.6924e-06,
        8.6924e-06, 8.6924e-06, 8.6924e-06, 8.6924e-06, 8.6924e-06, 8.6924e-06,
        8.6924e-06, 8.6924e-06, 3.9463e-10, 5.2045e-01, 2.4247e-15, 1.1764e-06,
        3.9463e-10, 5.3408e-11, 3.2815e-16, 4.3277e-07, 5.3408e-11, 5.3408e-11,
        3.9463e-10, 1.9146e-01, 5.3408e-11, 1.9146e-01, 8.9200e-16, 1.0727e-09])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 88.79% 

Test Accuracy: 88.20% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.34030959010124207
distance x is tensor(105.4450, device='cuda:3')
benign distance is  tensor(105.4450, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6200798749923706
distance x is tensor(112.6276, device='cuda:3')
benign distance is  tensor(112.6276, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1234656348824501
distance x is tensor(112.0344, device='cuda:3')
benign distance is  tensor(112.0344, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4397338926792145
distance x is tensor(104.3749, device='cuda:3')
benign distance is  tensor(104.3749, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6482453346252441
distance x is tensor(81.6144, device='cuda:3')
benign distance is  tensor(81.6144, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3759129047393799
distance x is tensor(116.5160, device='cuda:3')
benign distance is  tensor(116.5160, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.31160855293273926
distance x is tensor(95.3541, device='cuda:3')
benign distance is  tensor(95.3541, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.48441776633262634
distance x is tensor(81.5401, device='cuda:3')
benign distance is  tensor(81.5401, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.13976402580738068
distance x is tensor(130.0227, device='cuda:3')
benign distance is  tensor(130.0227, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8410152196884155
distance x is tensor(121.5652, device='cuda:3')
benign distance is  tensor(121.5652, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6289660334587097
distance x is tensor(105.7692, device='cuda:3')
benign distance is  tensor(105.7692, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5777369737625122
distance x is tensor(119.6187, device='cuda:3')
benign distance is  tensor(119.6187, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6168636083602905
distance x is tensor(106.7140, device='cuda:3')
benign distance is  tensor(106.7140, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.25150877237319946
distance x is tensor(61.2990, device='cuda:3')
benign distance is  tensor(61.2990, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0429449081420898
distance x is tensor(133.6894, device='cuda:3')
benign distance is  tensor(133.6894, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8682209253311157
distance x is tensor(134.2243, device='cuda:3')
benign distance is  tensor(134.2243, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.0767742320895195
distance x is tensor(131.7766, device='cuda:3')
benign distance is  tensor(131.7766, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.41083472967147827
distance x is tensor(77.2895, device='cuda:3')
benign distance is  tensor(77.2895, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.44771480560302734
distance x is tensor(119.8464, device='cuda:3')
benign distance is  tensor(119.8464, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.6350904107093811
distance x is tensor(131.9139, device='cuda:3')
benign distance is  tensor(131.9139, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.96778804063797
distance x is tensor(110.3355, device='cuda:3')
benign distance is  tensor(110.3355, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.35963231325149536
distance x is tensor(116.5515, device='cuda:3')
benign distance is  tensor(116.5515, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6163056492805481
distance x is tensor(127.2439, device='cuda:3')
benign distance is  tensor(127.2439, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.11887805163860321
distance x is tensor(108.9917, device='cuda:3')
benign distance is  tensor(108.9917, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([ 0., 12., 12., 12., 23., 12., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 19., 12., 12., 27., 12., 27., 12.])
count_res tensor([9.3099e-13, 1.5152e-07, 1.5152e-07, 1.5152e-07, 9.0723e-03, 1.5152e-07,
        1.5152e-07, 1.5152e-07, 8.2729e-06, 8.2729e-06, 8.2729e-06, 8.2729e-06,
        8.2729e-06, 8.2729e-06, 8.2729e-06, 8.2729e-06, 8.2729e-06, 8.2729e-06,
        8.2729e-06, 8.2729e-06, 1.5152e-07, 1.6616e-04, 1.5152e-07, 1.5152e-07,
        4.9533e-01, 1.5152e-07, 4.9533e-01, 1.5152e-07])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 88.85% 

Test Accuracy: 88.35% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2048420011997223
distance x is tensor(106.6851, device='cuda:3')
benign distance is  tensor(106.6851, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8098636865615845
distance x is tensor(128.4326, device='cuda:3')
benign distance is  tensor(128.4326, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.0395527109503746
distance x is tensor(127.9566, device='cuda:3')
benign distance is  tensor(127.9566, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8108965158462524
distance x is tensor(109.5958, device='cuda:3')
benign distance is  tensor(109.5958, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.772598922252655
distance x is tensor(83.2861, device='cuda:3')
benign distance is  tensor(83.2861, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.698877215385437
distance x is tensor(115.6960, device='cuda:3')
benign distance is  tensor(115.6960, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.27459317445755005
distance x is tensor(89.8455, device='cuda:3')
benign distance is  tensor(89.8455, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4431440234184265
distance x is tensor(98.3623, device='cuda:3')
benign distance is  tensor(98.3623, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2949492633342743
distance x is tensor(119.7250, device='cuda:3')
benign distance is  tensor(119.7250, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9085075259208679
distance x is tensor(119.3459, device='cuda:3')
benign distance is  tensor(119.3459, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.6748399138450623
distance x is tensor(122.0452, device='cuda:3')
benign distance is  tensor(122.0452, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4691465497016907
distance x is tensor(115.1717, device='cuda:3')
benign distance is  tensor(115.1717, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.39680811762809753
distance x is tensor(78.3434, device='cuda:3')
benign distance is  tensor(78.3434, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.31500688195228577
distance x is tensor(124.7174, device='cuda:3')
benign distance is  tensor(124.7174, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.08155752718448639
distance x is tensor(84.4778, device='cuda:3')
benign distance is  tensor(84.4778, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.0665438175201416
distance x is tensor(131.2285, device='cuda:3')
benign distance is  tensor(131.2285, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12.,  0., 12., 12., 12., 15., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 12., 12., 12., 27., 27., 27.])
count_res tensor([1.0196e-07, 6.2647e-13, 1.0196e-07, 1.0196e-07, 1.0196e-07, 2.0479e-06,
        1.0196e-07, 1.0196e-07, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06,
        5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06,
        5.5668e-06, 5.5668e-06, 1.0196e-07, 1.0196e-07, 1.0196e-07, 1.0196e-07,
        1.0196e-07, 3.3331e-01, 3.3331e-01, 3.3331e-01])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 89.20% 

Test Accuracy: 88.25% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.546660840511322
distance x is tensor(102.6758, device='cuda:3')
benign distance is  tensor(102.6758, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0511152744293213
distance x is tensor(106.7597, device='cuda:3')
benign distance is  tensor(106.7597, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1943749189376831
distance x is tensor(128.0479, device='cuda:3')
benign distance is  tensor(128.0479, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6693769693374634
distance x is tensor(104.8999, device='cuda:3')
benign distance is  tensor(104.8999, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6368177533149719
distance x is tensor(64.0134, device='cuda:3')
benign distance is  tensor(64.0134, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6154152750968933
distance x is tensor(105.5558, device='cuda:3')
benign distance is  tensor(105.5558, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4000856876373291
distance x is tensor(92.1767, device='cuda:3')
benign distance is  tensor(92.1767, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.12220741808414459
distance x is tensor(98.4283, device='cuda:3')
benign distance is  tensor(98.4283, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3329619765281677
distance x is tensor(121.6340, device='cuda:3')
benign distance is  tensor(121.6340, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5614901781082153
distance x is tensor(120.9670, device='cuda:3')
benign distance is  tensor(120.9670, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4084497392177582
distance x is tensor(108.4652, device='cuda:3')
benign distance is  tensor(108.4652, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5548576712608337
distance x is tensor(112.3126, device='cuda:3')
benign distance is  tensor(112.3126, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8327469825744629
distance x is tensor(122.8107, device='cuda:3')
benign distance is  tensor(122.8107, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.35593563318252563
distance x is tensor(64.2627, device='cuda:3')
benign distance is  tensor(64.2627, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.2477818727493286
distance x is tensor(116.7330, device='cuda:3')
benign distance is  tensor(116.7330, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7459503412246704
distance x is tensor(107.4114, device='cuda:3')
benign distance is  tensor(107.4114, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([22., 12., 12., 12., 27., 12.,  1., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 12., 12., 19., 27., 12., 12.])
count_res tensor([3.3568e-03, 1.5240e-07, 1.5240e-07, 1.5240e-07, 4.9819e-01, 1.5240e-07,
        2.5453e-12, 1.5240e-07, 8.3206e-06, 8.3206e-06, 8.3206e-06, 8.3206e-06,
        8.3206e-06, 8.3206e-06, 8.3206e-06, 8.3206e-06, 8.3206e-06, 8.3206e-06,
        8.3206e-06, 8.3206e-06, 1.5240e-07, 1.5240e-07, 1.5240e-07, 1.5240e-07,
        1.6712e-04, 4.9819e-01, 1.5240e-07, 1.5240e-07])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 89.52% 

Test Accuracy: 88.76% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.321594774723053
distance x is tensor(116.4765, device='cuda:3')
benign distance is  tensor(116.4765, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4698750078678131
distance x is tensor(128.7957, device='cuda:3')
benign distance is  tensor(128.7957, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.31970885396003723
distance x is tensor(135.3303, device='cuda:3')
benign distance is  tensor(135.3303, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9145153164863586
distance x is tensor(113.0065, device='cuda:3')
benign distance is  tensor(113.0065, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5992655158042908
distance x is tensor(36.6671, device='cuda:3')
benign distance is  tensor(36.6671, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1031341552734375
distance x is tensor(120.9667, device='cuda:3')
benign distance is  tensor(120.9667, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2456912249326706
distance x is tensor(99.0484, device='cuda:3')
benign distance is  tensor(99.0484, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5273402333259583
distance x is tensor(88.1722, device='cuda:3')
benign distance is  tensor(88.1722, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.46550408005714417
distance x is tensor(130.1498, device='cuda:3')
benign distance is  tensor(130.1498, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.24458575248718262
distance x is tensor(122.8679, device='cuda:3')
benign distance is  tensor(122.8679, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.8217830657958984
distance x is tensor(124.4766, device='cuda:3')
benign distance is  tensor(124.4766, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.040728066116571426
distance x is tensor(124.2115, device='cuda:3')
benign distance is  tensor(124.2115, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4647517800331116
distance x is tensor(111.0021, device='cuda:3')
benign distance is  tensor(111.0021, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.8506849408149719
distance x is tensor(90.5266, device='cuda:3')
benign distance is  tensor(90.5266, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.5602995157241821
distance x is tensor(124.0264, device='cuda:3')
benign distance is  tensor(124.0264, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.12873730063438416
distance x is tensor(121.0570, device='cuda:3')
benign distance is  tensor(121.0570, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 52
counter_tensor is  tensor([51., 39.,  0., 15., 37., 14., 51., 37., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 12., 51., 49., 47.,  0., 12., 13., 50.,
        14., 38., 45.,  0., 50., 17.,  2., 13., 15., 30.,  0., 12.,  0., 45.,
        49., 14., 15., 15., 14., 14., 15., 50., 14.,  3.])
count_res tensor([2.2739e-01, 1.3971e-06, 1.6134e-23, 5.2743e-17, 1.8908e-07, 1.9403e-17,
        2.2739e-01, 1.8908e-07, 3.7977e-06, 3.7977e-06, 3.7977e-06, 3.7977e-06,
        3.7977e-06, 3.7977e-06, 3.7977e-06, 3.7977e-06, 3.7977e-06, 3.7977e-06,
        3.7977e-06, 3.7977e-06, 2.6259e-18, 2.2739e-01, 3.0773e-02, 4.1647e-03,
        1.6134e-23, 2.6259e-18, 7.1380e-18, 8.3651e-02, 1.9403e-17, 5.1397e-07,
        5.6364e-04, 1.6134e-23, 8.3651e-02, 3.8972e-16, 1.1922e-22, 7.1380e-18,
        5.2743e-17, 1.7242e-10, 1.6134e-23, 2.6259e-18, 1.6134e-23, 5.6364e-04,
        3.0773e-02, 1.9403e-17, 5.2743e-17, 5.2743e-17, 1.9403e-17, 1.9403e-17,
        5.2743e-17, 8.3651e-02, 1.9403e-17, 3.2406e-22])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 89.77% 

Test Accuracy: 89.00% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4281686842441559
distance x is tensor(74.0032, device='cuda:3')
benign distance is  tensor(74.0032, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6886638402938843
distance x is tensor(121.2268, device='cuda:3')
benign distance is  tensor(121.2268, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.05254553630948067
distance x is tensor(129.9305, device='cuda:3')
benign distance is  tensor(129.9305, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5891339778900146
distance x is tensor(95.3735, device='cuda:3')
benign distance is  tensor(95.3735, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.38106757402420044
distance x is tensor(65.1732, device='cuda:3')
benign distance is  tensor(65.1732, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4997658133506775
distance x is tensor(111.7120, device='cuda:3')
benign distance is  tensor(111.7120, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7780751585960388
distance x is tensor(65.4606, device='cuda:3')
benign distance is  tensor(65.4606, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3448140025138855
distance x is tensor(73.8487, device='cuda:3')
benign distance is  tensor(73.8487, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.41770046949386597
distance x is tensor(116.3901, device='cuda:3')
benign distance is  tensor(116.3901, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.48282551765441895
distance x is tensor(104.1362, device='cuda:3')
benign distance is  tensor(104.1362, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.234948992729187
distance x is tensor(96.2765, device='cuda:3')
benign distance is  tensor(96.2765, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.44615188241004944
distance x is tensor(110.5700, device='cuda:3')
benign distance is  tensor(110.5700, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5469867587089539
distance x is tensor(106.0432, device='cuda:3')
benign distance is  tensor(106.0432, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3765918016433716
distance x is tensor(51.3611, device='cuda:3')
benign distance is  tensor(51.3611, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7389771342277527
distance x is tensor(112.3165, device='cuda:3')
benign distance is  tensor(112.3165, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.37025320529937744
distance x is tensor(111.9786, device='cuda:3')
benign distance is  tensor(111.9786, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.21542687714099884
distance x is tensor(115.4879, device='cuda:3')
benign distance is  tensor(115.4879, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.775916576385498
distance x is tensor(108.0796, device='cuda:3')
benign distance is  tensor(108.0796, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.416553258895874
distance x is tensor(108.8622, device='cuda:3')
benign distance is  tensor(108.8622, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.14518481492996216
distance x is tensor(101.6816, device='cuda:3')
benign distance is  tensor(101.6816, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3243834972381592
distance x is tensor(105.6542, device='cuda:3')
benign distance is  tensor(105.6542, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8196280598640442
distance x is tensor(116.3108, device='cuda:3')
benign distance is  tensor(116.3108, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.695299506187439
distance x is tensor(109.2407, device='cuda:3')
benign distance is  tensor(109.2407, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3368280827999115
distance x is tensor(107.7027, device='cuda:3')
benign distance is  tensor(107.7027, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.5614594221115112
distance x is tensor(123.7200, device='cuda:3')
benign distance is  tensor(123.7200, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.798587441444397
distance x is tensor(100.0486, device='cuda:3')
benign distance is  tensor(100.0486, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.37940287590026855
distance x is tensor(116.8830, device='cuda:3')
benign distance is  tensor(116.8830, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4965950846672058
distance x is tensor(131.6310, device='cuda:3')
benign distance is  tensor(131.6310, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5787737965583801
distance x is tensor(88.6269, device='cuda:3')
benign distance is  tensor(88.6269, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6290184259414673
distance x is tensor(113.8326, device='cuda:3')
benign distance is  tensor(113.8326, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5579259991645813
distance x is tensor(123.6377, device='cuda:3')
benign distance is  tensor(123.6377, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.5822871327400208
distance x is tensor(112.2822, device='cuda:3')
benign distance is  tensor(112.2822, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.3227798342704773
distance x is tensor(115.7784, device='cuda:3')
benign distance is  tensor(115.7784, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.3676355481147766
distance x is tensor(88.7027, device='cuda:3')
benign distance is  tensor(88.7027, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.09520703554153442
distance x is tensor(102.8233, device='cuda:3')
benign distance is  tensor(102.8233, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.16753104329109192
distance x is tensor(114.5301, device='cuda:3')
benign distance is  tensor(114.5301, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.6776193380355835
distance x is tensor(119.0087, device='cuda:3')
benign distance is  tensor(119.0087, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.66816645860672
distance x is tensor(117.2986, device='cuda:3')
benign distance is  tensor(117.2986, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8402841687202454
distance x is tensor(117.3090, device='cuda:3')
benign distance is  tensor(117.3090, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.275977224111557
distance x is tensor(107.3217, device='cuda:3')
benign distance is  tensor(107.3217, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 19.,  9., 16.,  8.,  8.,  8.,
        10.,  9., 11.,  8.,  8., 10.])
count_res tensor([8.6202e-04, 8.6202e-04, 8.6202e-04, 8.6202e-04, 8.6202e-04, 8.6202e-04,
        8.6202e-04, 8.6202e-04, 9.4532e-01, 4.2918e-05, 4.7065e-02, 1.5789e-05,
        1.5789e-05, 1.5789e-05, 1.1666e-04, 4.2918e-05, 3.1712e-04, 1.5789e-05,
        1.5789e-05, 1.1666e-04])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 89.14% 

Test Accuracy: 88.50% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.42866039276123047
distance x is tensor(64.2716, device='cuda:3')
benign distance is  tensor(64.2716, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4437893033027649
distance x is tensor(104.5759, device='cuda:3')
benign distance is  tensor(104.5759, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.461573988199234
distance x is tensor(110.4266, device='cuda:3')
benign distance is  tensor(110.4266, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5848061442375183
distance x is tensor(99.5340, device='cuda:3')
benign distance is  tensor(99.5340, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7527046203613281
distance x is tensor(51.7809, device='cuda:3')
benign distance is  tensor(51.7809, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5716407895088196
distance x is tensor(102.4123, device='cuda:3')
benign distance is  tensor(102.4123, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7667326331138611
distance x is tensor(63.9981, device='cuda:3')
benign distance is  tensor(63.9981, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.43387550115585327
distance x is tensor(87.4928, device='cuda:3')
benign distance is  tensor(87.4928, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([23., 12., 27., 17., 14., 12., 22., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 12., 12.,  0., 13., 12., 16.])
count_res tensor([1.7863e-02, 2.9835e-07, 9.7530e-01, 4.4279e-05, 2.2045e-06, 2.9835e-07,
        6.5715e-03, 2.9835e-07, 1.6289e-05, 1.6289e-05, 1.6289e-05, 1.6289e-05,
        1.6289e-05, 1.6289e-05, 1.6289e-05, 1.6289e-05, 1.6289e-05, 1.6289e-05,
        1.6289e-05, 1.6289e-05, 2.9835e-07, 2.9835e-07, 2.9835e-07, 2.9835e-07,
        1.8331e-12, 8.1099e-07, 2.9835e-07, 1.6289e-05])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 87.97% 

Test Accuracy: 87.22% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.47516027092933655
distance x is tensor(107.0237, device='cuda:3')
benign distance is  tensor(107.0237, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.24687185883522034
distance x is tensor(127.6013, device='cuda:3')
benign distance is  tensor(127.6013, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4721556603908539
distance x is tensor(60.3571, device='cuda:3')
benign distance is  tensor(60.3571, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6359037756919861
distance x is tensor(112.9142, device='cuda:3')
benign distance is  tensor(112.9142, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.05473620817065239
distance x is tensor(83.4848, device='cuda:3')
benign distance is  tensor(83.4848, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.33168745040893555
distance x is tensor(124.8587, device='cuda:3')
benign distance is  tensor(124.8587, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3470917344093323
distance x is tensor(97.5809, device='cuda:3')
benign distance is  tensor(97.5809, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.0313558466732502
distance x is tensor(118.8536, device='cuda:3')
benign distance is  tensor(118.8536, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.37510648369789124
distance x is tensor(136.2596, device='cuda:3')
benign distance is  tensor(136.2596, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.36615949869155884
distance x is tensor(123.0555, device='cuda:3')
benign distance is  tensor(123.0555, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.40150946378707886
distance x is tensor(116.9521, device='cuda:3')
benign distance is  tensor(116.9521, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.056011684238910675
distance x is tensor(123.8190, device='cuda:3')
benign distance is  tensor(123.8190, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.38628703355789185
distance x is tensor(119.0141, device='cuda:3')
benign distance is  tensor(119.0141, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1240847259759903
distance x is tensor(87.1260, device='cuda:3')
benign distance is  tensor(87.1260, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4850277304649353
distance x is tensor(121.4260, device='cuda:3')
benign distance is  tensor(121.4260, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6022807359695435
distance x is tensor(137.7569, device='cuda:3')
benign distance is  tensor(137.7569, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12., 11., 13., 23., 13., 13., 26.,  3., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 13., 13., 12., 17., 27., 12., 12., 12.])
count_res tensor([2.2064e-07, 8.1168e-08, 5.9976e-07, 1.3210e-02, 5.9976e-07, 5.9976e-07,
        2.6534e-01, 2.7229e-11, 1.2046e-05, 1.2046e-05, 1.2046e-05, 1.2046e-05,
        1.2046e-05, 1.2046e-05, 1.2046e-05, 1.2046e-05, 1.2046e-05, 1.2046e-05,
        1.2046e-05, 1.2046e-05, 5.9976e-07, 5.9976e-07, 2.2064e-07, 3.2746e-05,
        7.2127e-01, 2.2064e-07, 2.2064e-07, 2.2064e-07])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 88.62% 

Test Accuracy: 87.88% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0612820386886597
distance x is tensor(114.2950, device='cuda:3')
benign distance is  tensor(114.2950, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6576201319694519
distance x is tensor(125.6291, device='cuda:3')
benign distance is  tensor(125.6291, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.08849400281906128
distance x is tensor(108.2787, device='cuda:3')
benign distance is  tensor(108.2787, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8517690896987915
distance x is tensor(114.1081, device='cuda:3')
benign distance is  tensor(114.1081, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.44859448075294495
distance x is tensor(90.4977, device='cuda:3')
benign distance is  tensor(90.4977, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7504470944404602
distance x is tensor(113.7745, device='cuda:3')
benign distance is  tensor(113.7745, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5279865264892578
distance x is tensor(59.0989, device='cuda:3')
benign distance is  tensor(59.0989, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3554787039756775
distance x is tensor(104.6414, device='cuda:3')
benign distance is  tensor(104.6414, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.0573948509991169
distance x is tensor(128.2668, device='cuda:3')
benign distance is  tensor(128.2668, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.46455422043800354
distance x is tensor(127.7973, device='cuda:3')
benign distance is  tensor(127.7973, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.34979748725891113
distance x is tensor(123.8950, device='cuda:3')
benign distance is  tensor(123.8950, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.6854277849197388
distance x is tensor(120.1948, device='cuda:3')
benign distance is  tensor(120.1948, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.08197871595621109
distance x is tensor(67.8676, device='cuda:3')
benign distance is  tensor(67.8676, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.45460161566734314
distance x is tensor(119.3450, device='cuda:3')
benign distance is  tensor(119.3450, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3053794503211975
distance x is tensor(123.0422, device='cuda:3')
benign distance is  tensor(123.0422, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3565061390399933
distance x is tensor(118.5875, device='cuda:3')
benign distance is  tensor(118.5875, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 44
counter_tensor is  tensor([ 2., 18., 24., 13., 42., 12.,  1.,  0., 31., 32., 32., 32., 32., 31.,
        32., 32., 32., 32., 32., 32., 43.,  5., 39.,  7., 10., 29.,  0., 43.,
        12., 14., 43., 41., 40., 11., 35., 13., 33., 13., 13., 13., 13., 40.,
        12., 13.])
count_res tensor([4.3154e-19, 3.8347e-12, 1.5470e-09, 2.5838e-14, 1.0158e-01, 9.5052e-15,
        1.5875e-19, 5.8402e-20, 1.6965e-06, 4.6116e-06, 4.6116e-06, 4.6116e-06,
        4.6116e-06, 1.6965e-06, 4.6116e-06, 4.6116e-06, 4.6116e-06, 4.6116e-06,
        4.6116e-06, 4.6116e-06, 2.7612e-01, 8.6676e-18, 5.0572e-03, 6.4046e-17,
        1.2864e-15, 2.2960e-07, 5.8402e-20, 2.7612e-01, 9.5052e-15, 7.0235e-14,
        2.7612e-01, 3.7368e-02, 1.3747e-02, 3.4968e-15, 9.2627e-05, 2.5838e-14,
        1.2536e-05, 2.5838e-14, 2.5838e-14, 2.5838e-14, 2.5838e-14, 1.3747e-02,
        9.5052e-15, 2.5838e-14])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 89.71% 

Test Accuracy: 89.05% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4201856553554535
distance x is tensor(88.7205, device='cuda:3')
benign distance is  tensor(88.7205, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4758661687374115
distance x is tensor(106.8483, device='cuda:3')
benign distance is  tensor(106.8483, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.33674156665802
distance x is tensor(103.9138, device='cuda:3')
benign distance is  tensor(103.9138, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5385473370552063
distance x is tensor(104.5747, device='cuda:3')
benign distance is  tensor(104.5747, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3748500347137451
distance x is tensor(51.5557, device='cuda:3')
benign distance is  tensor(51.5557, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8765331506729126
distance x is tensor(103.2150, device='cuda:3')
benign distance is  tensor(103.2150, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6334797143936157
distance x is tensor(82.5186, device='cuda:3')
benign distance is  tensor(82.5186, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5002208948135376
distance x is tensor(90.9277, device='cuda:3')
benign distance is  tensor(90.9277, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.23585155606269836
distance x is tensor(106.0301, device='cuda:3')
benign distance is  tensor(106.0301, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7147606015205383
distance x is tensor(115.7273, device='cuda:3')
benign distance is  tensor(115.7273, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4613734185695648
distance x is tensor(100.1040, device='cuda:3')
benign distance is  tensor(100.1040, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.41445890069007874
distance x is tensor(109.9492, device='cuda:3')
benign distance is  tensor(109.9492, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.861363410949707
distance x is tensor(107.2902, device='cuda:3')
benign distance is  tensor(107.2902, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.10601802915334702
distance x is tensor(62.8094, device='cuda:3')
benign distance is  tensor(62.8094, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.49462756514549255
distance x is tensor(116.0130, device='cuda:3')
benign distance is  tensor(116.0130, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6112216711044312
distance x is tensor(121.6498, device='cuda:3')
benign distance is  tensor(121.6498, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.1476118117570877
distance x is tensor(128.8496, device='cuda:3')
benign distance is  tensor(128.8496, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6095549464225769
distance x is tensor(96.0916, device='cuda:3')
benign distance is  tensor(96.0916, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3390848934650421
distance x is tensor(96.0164, device='cuda:3')
benign distance is  tensor(96.0164, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.25805097818374634
distance x is tensor(118.5706, device='cuda:3')
benign distance is  tensor(118.5706, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8482444882392883
distance x is tensor(93.6277, device='cuda:3')
benign distance is  tensor(93.6277, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8118902444839478
distance x is tensor(108.7120, device='cuda:3')
benign distance is  tensor(108.7120, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.3838437497615814
distance x is tensor(121.3656, device='cuda:3')
benign distance is  tensor(121.3656, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.17451056838035583
distance x is tensor(112.4737, device='cuda:3')
benign distance is  tensor(112.4737, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.2202036827802658
distance x is tensor(101.1196, device='cuda:3')
benign distance is  tensor(101.1196, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.2976948320865631
distance x is tensor(126.8927, device='cuda:3')
benign distance is  tensor(126.8927, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5593428611755371
distance x is tensor(114.4393, device='cuda:3')
benign distance is  tensor(114.4393, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.6613714694976807
distance x is tensor(114.2130, device='cuda:3')
benign distance is  tensor(114.2130, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.3810320496559143
distance x is tensor(98.6644, device='cuda:3')
benign distance is  tensor(98.6644, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.4681210517883301
distance x is tensor(86.3482, device='cuda:3')
benign distance is  tensor(86.3482, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.6450027823448181
distance x is tensor(114.6335, device='cuda:3')
benign distance is  tensor(114.6335, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.29100272059440613
distance x is tensor(85.9524, device='cuda:3')
benign distance is  tensor(85.9524, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 17., 15.,  8.,  8.,  8.,
         8.,  8.,  8.,  9., 11., 13.])
count_res tensor([5.5521e-03, 5.5521e-03, 5.5521e-03, 5.5521e-03, 5.5521e-03, 5.5521e-03,
        5.5521e-03, 5.5521e-03, 2.0425e-03, 8.2400e-01, 1.1152e-01, 1.0169e-04,
        1.0169e-04, 1.0169e-04, 1.0169e-04, 1.0169e-04, 1.0169e-04, 2.7642e-04,
        2.0425e-03, 1.5092e-02])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 88.51% 

Test Accuracy: 87.30% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.24268755316734314
distance x is tensor(86.9093, device='cuda:3')
benign distance is  tensor(86.9093, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4256812632083893
distance x is tensor(101.2680, device='cuda:3')
benign distance is  tensor(101.2680, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1572798192501068
distance x is tensor(109.0914, device='cuda:3')
benign distance is  tensor(109.0914, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8046374320983887
distance x is tensor(102.5075, device='cuda:3')
benign distance is  tensor(102.5075, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.33582910895347595
distance x is tensor(54.0203, device='cuda:3')
benign distance is  tensor(54.0203, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.19744515419006348
distance x is tensor(100.0643, device='cuda:3')
benign distance is  tensor(100.0643, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.11964301764965057
distance x is tensor(80.0057, device='cuda:3')
benign distance is  tensor(80.0057, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.23326440155506134
distance x is tensor(77.6251, device='cuda:3')
benign distance is  tensor(77.6251, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 44
counter_tensor is  tensor([39., 12., 12., 17., 39., 43., 43., 31., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 12., 40., 43., 43., 12., 19., 42., 12.,
        22., 12., 12., 12., 12., 43.,  0., 12., 43., 27., 12., 12., 13., 12.,
        12., 12.])
count_res tensor([2.8377e-03, 5.3334e-15, 5.3334e-15, 7.9155e-13, 2.8377e-03, 1.5493e-01,
        1.5493e-01, 9.5193e-07, 2.5876e-06, 2.5876e-06, 2.5876e-06, 2.5876e-06,
        2.5876e-06, 2.5876e-06, 2.5876e-06, 2.5876e-06, 2.5876e-06, 2.5876e-06,
        2.5876e-06, 2.5876e-06, 5.3334e-15, 7.7135e-03, 1.5493e-01, 1.5493e-01,
        5.3334e-15, 5.8488e-12, 5.6996e-02, 5.3334e-15, 1.1748e-10, 5.3334e-15,
        5.3334e-15, 5.3334e-15, 5.3334e-15, 1.5493e-01, 3.2770e-20, 5.3334e-15,
        1.5493e-01, 1.7435e-08, 5.3334e-15, 5.3334e-15, 1.4498e-14, 5.3334e-15,
        5.3334e-15, 5.3334e-15])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 89.55% 

Test Accuracy: 88.77% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4524475932121277
distance x is tensor(92.9879, device='cuda:3')
benign distance is  tensor(92.9879, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5946716666221619
distance x is tensor(111.7684, device='cuda:3')
benign distance is  tensor(111.7684, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.03029649890959263
distance x is tensor(109.3759, device='cuda:3')
benign distance is  tensor(109.3759, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6960129737854004
distance x is tensor(110.4336, device='cuda:3')
benign distance is  tensor(110.4336, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.1342473030090332
distance x is tensor(46.9167, device='cuda:3')
benign distance is  tensor(46.9167, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.34286776185035706
distance x is tensor(90.8292, device='cuda:3')
benign distance is  tensor(90.8292, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.07416468113660812
distance x is tensor(68.8077, device='cuda:3')
benign distance is  tensor(68.8077, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.37063854932785034
distance x is tensor(81.0294, device='cuda:3')
benign distance is  tensor(81.0294, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2730112671852112
distance x is tensor(114.1657, device='cuda:3')
benign distance is  tensor(114.1657, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3471807837486267
distance x is tensor(116.7619, device='cuda:3')
benign distance is  tensor(116.7619, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.41971534490585327
distance x is tensor(95.0502, device='cuda:3')
benign distance is  tensor(95.0502, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.524693489074707
distance x is tensor(107.1252, device='cuda:3')
benign distance is  tensor(107.1252, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6721531748771667
distance x is tensor(100.7553, device='cuda:3')
benign distance is  tensor(100.7553, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2141076624393463
distance x is tensor(54.2725, device='cuda:3')
benign distance is  tensor(54.2725, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5291134119033813
distance x is tensor(109.1736, device='cuda:3')
benign distance is  tensor(109.1736, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5536554455757141
distance x is tensor(108.0586, device='cuda:3')
benign distance is  tensor(108.0586, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.1606910526752472
distance x is tensor(101.9917, device='cuda:3')
benign distance is  tensor(101.9917, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6556539535522461
distance x is tensor(109.9531, device='cuda:3')
benign distance is  tensor(109.9531, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.28345704078674316
distance x is tensor(117.5891, device='cuda:3')
benign distance is  tensor(117.5891, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.13490264117717743
distance x is tensor(107.9330, device='cuda:3')
benign distance is  tensor(107.9330, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.25597527623176575
distance x is tensor(96.1387, device='cuda:3')
benign distance is  tensor(96.1387, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0778205394744873
distance x is tensor(97.7405, device='cuda:3')
benign distance is  tensor(97.7405, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.415959894657135
distance x is tensor(115.2480, device='cuda:3')
benign distance is  tensor(115.2480, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4921208322048187
distance x is tensor(119.6637, device='cuda:3')
benign distance is  tensor(119.6637, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.29774153232574463
distance x is tensor(117.2485, device='cuda:3')
benign distance is  tensor(117.2485, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.3748992085456848
distance x is tensor(109.3014, device='cuda:3')
benign distance is  tensor(109.3014, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.07167334854602814
distance x is tensor(100.1653, device='cuda:3')
benign distance is  tensor(100.1653, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.29165780544281006
distance x is tensor(103.7602, device='cuda:3')
benign distance is  tensor(103.7602, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.18560343980789185
distance x is tensor(111.0919, device='cuda:3')
benign distance is  tensor(111.0919, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.2909998893737793
distance x is tensor(120.6140, device='cuda:3')
benign distance is  tensor(120.6140, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.5502229332923889
distance x is tensor(107.4183, device='cuda:3')
benign distance is  tensor(107.4183, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.2608868479728699
distance x is tensor(112.9092, device='cuda:3')
benign distance is  tensor(112.9092, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 17., 16.,  8.,  8.,  8.,
         8.,  8.,  8.,  9., 12., 11.])
count_res tensor([4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03,
        4.6969e-03, 4.6969e-03, 1.7279e-03, 6.9708e-01, 2.5644e-01, 8.6027e-05,
        8.6027e-05, 8.6027e-05, 8.6027e-05, 8.6027e-05, 8.6027e-05, 2.3384e-04,
        4.6969e-03, 1.7279e-03])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 88.36% 

Test Accuracy: 87.77% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.22954614460468292
distance x is tensor(81.1463, device='cuda:3')
benign distance is  tensor(81.1463, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7756959199905396
distance x is tensor(101.7484, device='cuda:3')
benign distance is  tensor(101.7484, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4309256076812744
distance x is tensor(110.8541, device='cuda:3')
benign distance is  tensor(110.8541, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.33250656723976135
distance x is tensor(90.5473, device='cuda:3')
benign distance is  tensor(90.5473, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5328116416931152
distance x is tensor(53.9205, device='cuda:3')
benign distance is  tensor(53.9205, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.12599113583564758
distance x is tensor(84.7454, device='cuda:3')
benign distance is  tensor(84.7454, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.17863833904266357
distance x is tensor(53.9940, device='cuda:3')
benign distance is  tensor(53.9940, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.35669422149658203
distance x is tensor(76.2121, device='cuda:3')
benign distance is  tensor(76.2121, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([35., 12., 12., 12., 35.,  0., 35., 32., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 12., 13., 12., 20., 13., 12.,  0.,  1.,
        13., 32., 35., 14., 12., 32.,  0., 15.])
count_res tensor([2.4099e-01, 2.4730e-11, 2.4730e-11, 2.4730e-11, 2.4099e-01, 1.5195e-16,
        2.4099e-01, 1.1998e-02, 4.0249e-06, 4.0249e-06, 4.0249e-06, 4.0249e-06,
        4.0249e-06, 4.0249e-06, 4.0249e-06, 4.0249e-06, 4.0249e-06, 4.0249e-06,
        4.0249e-06, 4.0249e-06, 2.4730e-11, 6.7223e-11, 2.4730e-11, 7.3719e-08,
        6.7223e-11, 2.4730e-11, 1.5195e-16, 4.1303e-16, 6.7223e-11, 1.1998e-02,
        2.4099e-01, 1.8273e-10, 2.4730e-11, 1.1998e-02, 1.5195e-16, 4.9672e-10])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 90.03% 

Test Accuracy: 88.90% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.18529480695724487
distance x is tensor(89.5493, device='cuda:3')
benign distance is  tensor(89.5493, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.49007898569107056
distance x is tensor(109.4425, device='cuda:3')
benign distance is  tensor(109.4425, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1105516329407692
distance x is tensor(124.8243, device='cuda:3')
benign distance is  tensor(124.8243, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.17752107977867126
distance x is tensor(105.0115, device='cuda:3')
benign distance is  tensor(105.0115, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2972390353679657
distance x is tensor(43.1775, device='cuda:3')
benign distance is  tensor(43.1775, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.42718344926834106
distance x is tensor(98.3895, device='cuda:3')
benign distance is  tensor(98.3895, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9074817895889282
distance x is tensor(54.0643, device='cuda:3')
benign distance is  tensor(54.0643, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.42588376998901367
distance x is tensor(81.3351, device='cuda:3')
benign distance is  tensor(81.3351, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.02579438127577305
distance x is tensor(110.3928, device='cuda:3')
benign distance is  tensor(110.3928, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.24313147366046906
distance x is tensor(127.7754, device='cuda:3')
benign distance is  tensor(127.7754, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.31958240270614624
distance x is tensor(86.1754, device='cuda:3')
benign distance is  tensor(86.1754, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7881512641906738
distance x is tensor(116.2776, device='cuda:3')
benign distance is  tensor(116.2776, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.15870995819568634
distance x is tensor(111.7641, device='cuda:3')
benign distance is  tensor(111.7641, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5349586606025696
distance x is tensor(85.3888, device='cuda:3')
benign distance is  tensor(85.3888, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3443492352962494
distance x is tensor(121.0257, device='cuda:3')
benign distance is  tensor(121.0257, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0040501356124878
distance x is tensor(115.1510, device='cuda:3')
benign distance is  tensor(115.1510, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.21138301491737366
distance x is tensor(130.5802, device='cuda:3')
benign distance is  tensor(130.5802, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7689141631126404
distance x is tensor(108.2747, device='cuda:3')
benign distance is  tensor(108.2747, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.15723128616809845
distance x is tensor(118.3336, device='cuda:3')
benign distance is  tensor(118.3336, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5439790487289429
distance x is tensor(119.1555, device='cuda:3')
benign distance is  tensor(119.1555, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9588731527328491
distance x is tensor(101.2169, device='cuda:3')
benign distance is  tensor(101.2169, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6103982925415039
distance x is tensor(133.1024, device='cuda:3')
benign distance is  tensor(133.1024, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.29500260949134827
distance x is tensor(121.1666, device='cuda:3')
benign distance is  tensor(121.1666, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6841753125190735
distance x is tensor(119.4101, device='cuda:3')
benign distance is  tensor(119.4101, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([ 1., 12., 35., 12., 35., 35.,  8., 30., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 22., 12., 13.,  0., 12., 12.,  5., 12.,
        34., 12.,  0., 35., 35., 12.,  0., 12.])
count_res tensor([3.1888e-16, 1.9093e-11, 1.8605e-01, 1.9093e-11, 1.8605e-01, 1.8605e-01,
        3.4969e-13, 1.2536e-03, 3.1074e-06, 3.1074e-06, 3.1074e-06, 3.1074e-06,
        3.1074e-06, 3.1074e-06, 3.1074e-06, 3.1074e-06, 3.1074e-06, 3.1074e-06,
        3.1074e-06, 3.1074e-06, 4.2054e-07, 1.9093e-11, 5.1899e-11, 1.1731e-16,
        1.9093e-11, 1.9093e-11, 1.7410e-14, 1.9093e-11, 6.8445e-02, 1.9093e-11,
        1.1731e-16, 1.8605e-01, 1.8605e-01, 1.9093e-11, 1.1731e-16, 1.9093e-11])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 89.93% 

Test Accuracy: 89.07% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.22841885685920715
distance x is tensor(84.7970, device='cuda:3')
benign distance is  tensor(84.7970, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.40265196561813354
distance x is tensor(119.5843, device='cuda:3')
benign distance is  tensor(119.5843, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.09180097281932831
distance x is tensor(102.3831, device='cuda:3')
benign distance is  tensor(102.3831, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6283847093582153
distance x is tensor(122.2002, device='cuda:3')
benign distance is  tensor(122.2002, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2942563593387604
distance x is tensor(39.8192, device='cuda:3')
benign distance is  tensor(39.8192, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.24090448021888733
distance x is tensor(95.4456, device='cuda:3')
benign distance is  tensor(95.4456, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.10456681251525879
distance x is tensor(61.0295, device='cuda:3')
benign distance is  tensor(61.0295, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3010851740837097
distance x is tensor(88.8078, device='cuda:3')
benign distance is  tensor(88.8078, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.365364670753479
distance x is tensor(122.3251, device='cuda:3')
benign distance is  tensor(122.3251, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6548246145248413
distance x is tensor(123.7647, device='cuda:3')
benign distance is  tensor(123.7647, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.031094739213585854
distance x is tensor(118.6948, device='cuda:3')
benign distance is  tensor(118.6948, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.1551627814769745
distance x is tensor(105.8995, device='cuda:3')
benign distance is  tensor(105.8995, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.03378264233469963
distance x is tensor(82.9818, device='cuda:3')
benign distance is  tensor(82.9818, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4280359148979187
distance x is tensor(101.2457, device='cuda:3')
benign distance is  tensor(101.2457, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2298734188079834
distance x is tensor(121.3723, device='cuda:3')
benign distance is  tensor(121.3723, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5361076593399048
distance x is tensor(115.6389, device='cuda:3')
benign distance is  tensor(115.6389, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.4835866391658783
distance x is tensor(114.9010, device='cuda:3')
benign distance is  tensor(114.9010, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.1427062302827835
distance x is tensor(124.0426, device='cuda:3')
benign distance is  tensor(124.0426, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.4516127109527588
distance x is tensor(127.5689, device='cuda:3')
benign distance is  tensor(127.5689, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.3586900532245636
distance x is tensor(124.2045, device='cuda:3')
benign distance is  tensor(124.2045, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.3534972071647644
distance x is tensor(103.0657, device='cuda:3')
benign distance is  tensor(103.0657, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.47129106521606445
distance x is tensor(104.6146, device='cuda:3')
benign distance is  tensor(104.6146, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.5371266603469849
distance x is tensor(107.6400, device='cuda:3')
benign distance is  tensor(107.6400, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.14025942981243134
distance x is tensor(116.6703, device='cuda:3')
benign distance is  tensor(116.6703, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 28
counter_tensor is  tensor([12.,  0., 12., 12., 13., 12., 26., 27., 15., 16., 16., 16., 15., 15.,
        16., 16., 16., 16., 16., 16., 13., 12., 13., 27., 12., 12., 12., 16.])
count_res tensor([1.2918e-07, 7.9370e-13, 1.2918e-07, 1.2918e-07, 3.5114e-07, 1.2918e-07,
        1.5535e-01, 4.2228e-01, 2.5946e-06, 7.0529e-06, 7.0529e-06, 7.0529e-06,
        2.5946e-06, 2.5946e-06, 7.0529e-06, 7.0529e-06, 7.0529e-06, 7.0529e-06,
        7.0529e-06, 7.0529e-06, 3.5114e-07, 1.2918e-07, 3.5114e-07, 4.2228e-01,
        1.2918e-07, 1.2918e-07, 1.2918e-07, 7.0529e-06])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 89.05% 

Test Accuracy: 88.17% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.456226646900177
distance x is tensor(95.9456, device='cuda:3')
benign distance is  tensor(95.9456, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7384682893753052
distance x is tensor(120.1275, device='cuda:3')
benign distance is  tensor(120.1275, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.04498722404241562
distance x is tensor(118.3215, device='cuda:3')
benign distance is  tensor(118.3215, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4215218126773834
distance x is tensor(112.4618, device='cuda:3')
benign distance is  tensor(112.4618, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.39321720600128174
distance x is tensor(54.5138, device='cuda:3')
benign distance is  tensor(54.5138, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4678695797920227
distance x is tensor(102.6015, device='cuda:3')
benign distance is  tensor(102.6015, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.03998241573572159
distance x is tensor(76.1173, device='cuda:3')
benign distance is  tensor(76.1173, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4840542674064636
distance x is tensor(60.3627, device='cuda:3')
benign distance is  tensor(60.3627, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4781421720981598
distance x is tensor(121.6057, device='cuda:3')
benign distance is  tensor(121.6057, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7031667828559875
distance x is tensor(130.9285, device='cuda:3')
benign distance is  tensor(130.9285, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3787297308444977
distance x is tensor(109.5661, device='cuda:3')
benign distance is  tensor(109.5661, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9774230718612671
distance x is tensor(89.7597, device='cuda:3')
benign distance is  tensor(89.7597, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5027837157249451
distance x is tensor(115.2965, device='cuda:3')
benign distance is  tensor(115.2965, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.36629611253738403
distance x is tensor(91.6692, device='cuda:3')
benign distance is  tensor(91.6692, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6622661352157593
distance x is tensor(121.2848, device='cuda:3')
benign distance is  tensor(121.2848, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8087823987007141
distance x is tensor(130.8895, device='cuda:3')
benign distance is  tensor(130.8895, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 17., 16.,  8.,  8.,  8.,
         8.,  8.,  8.,  9., 11., 12.])
count_res tensor([4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03, 4.6969e-03,
        4.6969e-03, 4.6969e-03, 1.7279e-03, 6.9708e-01, 2.5644e-01, 8.6027e-05,
        8.6027e-05, 8.6027e-05, 8.6027e-05, 8.6027e-05, 8.6027e-05, 2.3384e-04,
        1.7279e-03, 4.6969e-03])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 87.77% 

Test Accuracy: 87.08% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2740195691585541
distance x is tensor(89.2366, device='cuda:3')
benign distance is  tensor(89.2366, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5510765314102173
distance x is tensor(107.6418, device='cuda:3')
benign distance is  tensor(107.6418, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.022335072979331017
distance x is tensor(114.9926, device='cuda:3')
benign distance is  tensor(114.9926, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.13410747051239014
distance x is tensor(102.6258, device='cuda:3')
benign distance is  tensor(102.6258, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.341694712638855
distance x is tensor(64.5099, device='cuda:3')
benign distance is  tensor(64.5099, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7458709478378296
distance x is tensor(100.4598, device='cuda:3')
benign distance is  tensor(100.4598, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.18447016179561615
distance x is tensor(71.3251, device='cuda:3')
benign distance is  tensor(71.3251, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.11934062093496323
distance x is tensor(67.8154, device='cuda:3')
benign distance is  tensor(67.8154, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 52
counter_tensor is  tensor([51., 14., 50., 43., 42.,  1., 48., 46., 40., 39., 39., 39., 39., 39.,
        39., 39., 39., 39., 39., 39.,  0., 13., 39., 43., 38., 15., 21., 13.,
        39., 33.,  2., 51.,  2.,  1., 49.,  1., 14., 14.,  0.,  1., 48., 50.,
        13., 20., 14.,  6., 51., 26., 40., 16., 13., 14.])
count_res tensor([2.5136e-01, 2.1449e-17, 9.2471e-02, 8.4323e-05, 3.1021e-05, 4.8482e-23,
        1.2515e-02, 1.6937e-03, 4.1982e-06, 1.5444e-06, 1.5444e-06, 1.5444e-06,
        1.5444e-06, 1.5444e-06, 1.5444e-06, 1.5444e-06, 1.5444e-06, 1.5444e-06,
        1.5444e-06, 1.5444e-06, 1.7835e-23, 7.8906e-18, 1.5444e-06, 8.4323e-05,
        5.6816e-07, 5.8304e-17, 2.3522e-14, 7.8906e-18, 1.5444e-06, 3.8282e-09,
        1.3179e-22, 2.5136e-01, 1.3179e-22, 4.8482e-23, 3.4018e-02, 4.8482e-23,
        2.1449e-17, 2.1449e-17, 1.7835e-23, 4.8482e-23, 1.2515e-02, 9.2471e-02,
        7.8906e-18, 8.6531e-15, 2.1449e-17, 7.1953e-21, 2.5136e-01, 3.4909e-12,
        4.1982e-06, 1.5849e-16, 7.8906e-18, 2.1449e-17])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 89.87% 

Test Accuracy: 88.87% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.260578453540802
distance x is tensor(63.1018, device='cuda:3')
benign distance is  tensor(63.1018, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7224215269088745
distance x is tensor(117.1378, device='cuda:3')
benign distance is  tensor(117.1378, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.09541131556034088
distance x is tensor(108.2838, device='cuda:3')
benign distance is  tensor(108.2838, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5972628593444824
distance x is tensor(122.0684, device='cuda:3')
benign distance is  tensor(122.0684, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4700066149234772
distance x is tensor(69.1068, device='cuda:3')
benign distance is  tensor(69.1068, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5462522506713867
distance x is tensor(97.2613, device='cuda:3')
benign distance is  tensor(97.2613, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.11624711751937866
distance x is tensor(74.2027, device='cuda:3')
benign distance is  tensor(74.2027, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.10869989544153214
distance x is tensor(72.6924, device='cuda:3')
benign distance is  tensor(72.6924, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.27065664529800415
distance x is tensor(105.0834, device='cuda:3')
benign distance is  tensor(105.0834, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8408254384994507
distance x is tensor(121.2799, device='cuda:3')
benign distance is  tensor(121.2799, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8242786526679993
distance x is tensor(74.4200, device='cuda:3')
benign distance is  tensor(74.4200, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7643404603004456
distance x is tensor(100.3786, device='cuda:3')
benign distance is  tensor(100.3786, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4083646237850189
distance x is tensor(102.1557, device='cuda:3')
benign distance is  tensor(102.1557, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.07918714731931686
distance x is tensor(70.3428, device='cuda:3')
benign distance is  tensor(70.3428, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4814230799674988
distance x is tensor(121.8567, device='cuda:3')
benign distance is  tensor(121.8567, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5406456589698792
distance x is tensor(122.8244, device='cuda:3')
benign distance is  tensor(122.8244, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3408280313014984
distance x is tensor(116.7283, device='cuda:3')
benign distance is  tensor(116.7283, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8010749816894531
distance x is tensor(121.1824, device='cuda:3')
benign distance is  tensor(121.1824, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.017486149445176125
distance x is tensor(113.2892, device='cuda:3')
benign distance is  tensor(113.2892, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.31820347905158997
distance x is tensor(101.4378, device='cuda:3')
benign distance is  tensor(101.4378, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.24894635379314423
distance x is tensor(113.7399, device='cuda:3')
benign distance is  tensor(113.7399, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4869135916233063
distance x is tensor(102.1613, device='cuda:3')
benign distance is  tensor(102.1613, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.386111319065094
distance x is tensor(107.4604, device='cuda:3')
benign distance is  tensor(107.4604, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6144279837608337
distance x is tensor(130.1174, device='cuda:3')
benign distance is  tensor(130.1174, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.17373187839984894
distance x is tensor(133.3779, device='cuda:3')
benign distance is  tensor(133.3779, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6766654253005981
distance x is tensor(112.1714, device='cuda:3')
benign distance is  tensor(112.1714, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.4282630980014801
distance x is tensor(119.8229, device='cuda:3')
benign distance is  tensor(119.8229, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.387911319732666
distance x is tensor(105.0300, device='cuda:3')
benign distance is  tensor(105.0300, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5640244483947754
distance x is tensor(102.6286, device='cuda:3')
benign distance is  tensor(102.6286, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.24590817093849182
distance x is tensor(115.9684, device='cuda:3')
benign distance is  tensor(115.9684, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.28803128004074097
distance x is tensor(122.7107, device='cuda:3')
benign distance is  tensor(122.7107, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.28446465730667114
distance x is tensor(111.3752, device='cuda:3')
benign distance is  tensor(111.3752, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.1539570838212967
distance x is tensor(127.9838, device='cuda:3')
benign distance is  tensor(127.9838, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.2632138729095459
distance x is tensor(103.6202, device='cuda:3')
benign distance is  tensor(103.6202, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.27815407514572144
distance x is tensor(107.8692, device='cuda:3')
benign distance is  tensor(107.8692, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.11949052661657333
distance x is tensor(111.4693, device='cuda:3')
benign distance is  tensor(111.4693, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.3688580393791199
distance x is tensor(116.4954, device='cuda:3')
benign distance is  tensor(116.4954, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.20543615520000458
distance x is tensor(121.1481, device='cuda:3')
benign distance is  tensor(121.1481, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7914461493492126
distance x is tensor(122.7187, device='cuda:3')
benign distance is  tensor(122.7187, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.3462831377983093
distance x is tensor(121.9104, device='cuda:3')
benign distance is  tensor(121.9104, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 11., 18., 15.,  8.,  8.,  8.,
         8.,  8.,  8., 10.,  9., 13.])
count_res tensor([2.2994e-03, 2.2994e-03, 2.2994e-03, 2.2994e-03, 2.2994e-03, 2.2994e-03,
        2.2994e-03, 2.2994e-03, 8.4590e-04, 9.2765e-01, 4.6185e-02, 4.2115e-05,
        4.2115e-05, 4.2115e-05, 4.2115e-05, 4.2115e-05, 4.2115e-05, 3.1119e-04,
        1.1448e-04, 6.2504e-03])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 88.75% 

Test Accuracy: 88.04% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.45615968108177185
distance x is tensor(59.2636, device='cuda:3')
benign distance is  tensor(59.2636, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4461168646812439
distance x is tensor(116.5885, device='cuda:3')
benign distance is  tensor(116.5885, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.25267696380615234
distance x is tensor(103.1612, device='cuda:3')
benign distance is  tensor(103.1612, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.40426769852638245
distance x is tensor(97.3368, device='cuda:3')
benign distance is  tensor(97.3368, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2746420204639435
distance x is tensor(59.5742, device='cuda:3')
benign distance is  tensor(59.5742, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.38750186562538147
distance x is tensor(96.1437, device='cuda:3')
benign distance is  tensor(96.1437, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.07858909666538239
distance x is tensor(64.9934, device='cuda:3')
benign distance is  tensor(64.9934, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.37582486867904663
distance x is tensor(74.7383, device='cuda:3')
benign distance is  tensor(74.7383, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
mal_vec shape is  torch.Size([12, 215370])
user_PLR len size 36
counter_tensor is  tensor([35.,  0.,  0., 12., 28.,  1., 34., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 32., 12., 15., 12., 12., 30., 14.,  0.,
        26., 15., 35., 34., 35., 12.,  0., 13.])
count_res tensor([2.6361e-01, 1.6621e-16, 1.6621e-16, 2.7051e-11, 2.4038e-04, 4.5180e-16,
        9.6976e-02, 2.7051e-11, 4.4027e-06, 4.4027e-06, 4.4027e-06, 4.4027e-06,
        4.4027e-06, 4.4027e-06, 4.4027e-06, 4.4027e-06, 4.4027e-06, 4.4027e-06,
        4.4027e-06, 4.4027e-06, 1.3124e-02, 2.7051e-11, 5.4334e-10, 2.7051e-11,
        2.7051e-11, 1.7762e-03, 1.9988e-10, 1.6621e-16, 3.2532e-05, 5.4334e-10,
        2.6361e-01, 9.6976e-02, 2.6361e-01, 2.7051e-11, 1.6621e-16, 7.3532e-11])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 89.52% 

Test Accuracy: 88.74% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 89.52%
|----0th round Training Accuracy : 87.78%
|----1th round Training Accuracy : 87.83%
|----2th round Training Accuracy : 87.63%
|----3th round Training Accuracy : 88.86%
|----4th round Training Accuracy : 88.82%
|----5th round Training Accuracy : 88.49%
|----6th round Training Accuracy : 89.33%
|----7th round Training Accuracy : 89.05%
|----8th round Training Accuracy : 86.57%
|----9th round Training Accuracy : 89.37%
|----10th round Training Accuracy : 87.89%
|----11th round Training Accuracy : 89.50%
|----12th round Training Accuracy : 87.76%
|----13th round Training Accuracy : 89.31%
|----14th round Training Accuracy : 89.00%
|----15th round Training Accuracy : 89.24%
|----16th round Training Accuracy : 88.15%
|----17th round Training Accuracy : 89.05%
|----18th round Training Accuracy : 87.88%
|----19th round Training Accuracy : 88.47%
|----20th round Training Accuracy : 88.93%
|----21th round Training Accuracy : 88.72%
|----22th round Training Accuracy : 87.19%
|----23th round Training Accuracy : 88.34%
|----24th round Training Accuracy : 88.46%
|----25th round Training Accuracy : 89.13%
|----26th round Training Accuracy : 89.25%
|----27th round Training Accuracy : 89.49%
|----28th round Training Accuracy : 88.10%
|----29th round Training Accuracy : 89.62%
|----30th round Training Accuracy : 89.01%
|----31th round Training Accuracy : 88.79%
|----32th round Training Accuracy : 88.85%
|----33th round Training Accuracy : 89.20%
|----34th round Training Accuracy : 89.52%
|----35th round Training Accuracy : 89.77%
|----36th round Training Accuracy : 89.14%
|----37th round Training Accuracy : 87.97%
|----38th round Training Accuracy : 88.62%
|----39th round Training Accuracy : 89.71%
|----40th round Training Accuracy : 88.51%
|----41th round Training Accuracy : 89.55%
|----42th round Training Accuracy : 88.36%
|----43th round Training Accuracy : 90.03%
|----44th round Training Accuracy : 89.93%
|----45th round Training Accuracy : 89.05%
|----46th round Training Accuracy : 87.77%
|----47th round Training Accuracy : 89.87%
|----48th round Training Accuracy : 88.75%
|----49th round Training Accuracy : 89.52%
|----Final Test Accuracy: 88.74%
|----0th round Final Test Accuracy : 86.82%
|----1th round Final Test Accuracy : 87.13%
|----2th round Final Test Accuracy : 86.57%
|----3th round Final Test Accuracy : 88.07%
|----4th round Final Test Accuracy : 88.43%
|----5th round Final Test Accuracy : 87.82%
|----6th round Final Test Accuracy : 88.74%
|----7th round Final Test Accuracy : 88.48%
|----8th round Final Test Accuracy : 86.05%
|----9th round Final Test Accuracy : 88.89%
|----10th round Final Test Accuracy : 87.32%
|----11th round Final Test Accuracy : 88.76%
|----12th round Final Test Accuracy : 87.16%
|----13th round Final Test Accuracy : 88.35%
|----14th round Final Test Accuracy : 88.60%
|----15th round Final Test Accuracy : 88.26%
|----16th round Final Test Accuracy : 87.33%
|----17th round Final Test Accuracy : 88.12%
|----18th round Final Test Accuracy : 86.70%
|----19th round Final Test Accuracy : 87.90%
|----20th round Final Test Accuracy : 88.57%
|----21th round Final Test Accuracy : 87.90%
|----22th round Final Test Accuracy : 86.46%
|----23th round Final Test Accuracy : 87.66%
|----24th round Final Test Accuracy : 88.01%
|----25th round Final Test Accuracy : 88.69%
|----26th round Final Test Accuracy : 88.53%
|----27th round Final Test Accuracy : 88.58%
|----28th round Final Test Accuracy : 87.37%
|----29th round Final Test Accuracy : 89.11%
|----30th round Final Test Accuracy : 87.96%
|----31th round Final Test Accuracy : 88.20%
|----32th round Final Test Accuracy : 88.35%
|----33th round Final Test Accuracy : 88.25%
|----34th round Final Test Accuracy : 88.76%
|----35th round Final Test Accuracy : 89.00%
|----36th round Final Test Accuracy : 88.50%
|----37th round Final Test Accuracy : 87.22%
|----38th round Final Test Accuracy : 87.88%
|----39th round Final Test Accuracy : 89.05%
|----40th round Final Test Accuracy : 87.30%
|----41th round Final Test Accuracy : 88.77%
|----42th round Final Test Accuracy : 87.77%
|----43th round Final Test Accuracy : 88.90%
|----44th round Final Test Accuracy : 89.07%
|----45th round Final Test Accuracy : 88.17%
|----46th round Final Test Accuracy : 87.08%
|----47th round Final Test Accuracy : 88.87%
|----48th round Final Test Accuracy : 88.04%
|----49th round Final Test Accuracy : 88.74%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 3036.8673
