
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.35055822134017944
distance x is tensor(81.7130, device='cuda:3')
benign distance is  tensor(81.7130, device='cuda:3')
norm1 res is  tensor(356.1540, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.34459012746810913
distance x is tensor(90.9958, device='cuda:3')
benign distance is  tensor(90.9958, device='cuda:3')
norm1 res is  tensor(402.6352, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3231925070285797
distance x is tensor(96.5502, device='cuda:3')
benign distance is  tensor(96.5502, device='cuda:3')
norm1 res is  tensor(425.6285, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8656023144721985
distance x is tensor(79.6586, device='cuda:3')
benign distance is  tensor(79.6586, device='cuda:3')
norm1 res is  tensor(345.7509, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6857162714004517
distance x is tensor(80.7608, device='cuda:3')
benign distance is  tensor(80.7608, device='cuda:3')
norm1 res is  tensor(341.0505, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4392668306827545
distance x is tensor(90.8143, device='cuda:3')
benign distance is  tensor(90.8143, device='cuda:3')
norm1 res is  tensor(397.5224, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.43666553497314453
distance x is tensor(87.1900, device='cuda:3')
benign distance is  tensor(87.1900, device='cuda:3')
norm1 res is  tensor(377.8205, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7641573548316956
distance x is tensor(103.6932, device='cuda:3')
benign distance is  tensor(103.6932, device='cuda:3')
norm1 res is  tensor(448.2617, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.1973300725221634
distance x is tensor(120.3716, device='cuda:3')
benign distance is  tensor(120.3716, device='cuda:3')
norm1 res is  tensor(528.8832, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.1460554301738739
distance x is tensor(111.3837, device='cuda:3')
benign distance is  tensor(111.3837, device='cuda:3')
norm1 res is  tensor(487.0681, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.3066951334476471
distance x is tensor(100.6201, device='cuda:3')
benign distance is  tensor(100.6201, device='cuda:3')
norm1 res is  tensor(447.5541, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7091162800788879
distance x is tensor(113.5023, device='cuda:3')
benign distance is  tensor(113.5023, device='cuda:3')
norm1 res is  tensor(493.1585, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.37574413418769836
distance x is tensor(105.9827, device='cuda:3')
benign distance is  tensor(105.9827, device='cuda:3')
norm1 res is  tensor(468.2524, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.39498475193977356
distance x is tensor(122.6066, device='cuda:3')
benign distance is  tensor(122.6066, device='cuda:3')
norm1 res is  tensor(531.7949, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4100024104118347
distance x is tensor(113.0915, device='cuda:3')
benign distance is  tensor(113.0915, device='cuda:3')
norm1 res is  tensor(500.9843, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5575159192085266
distance x is tensor(116.6924, device='cuda:3')
benign distance is  tensor(116.6924, device='cuda:3')
norm1 res is  tensor(504.8437, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.33649247884750366
distance x is tensor(102.9382, device='cuda:3')
benign distance is  tensor(102.9382, device='cuda:3')
norm1 res is  tensor(446.3928, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6183849573135376
distance x is tensor(118.2977, device='cuda:3')
benign distance is  tensor(118.2977, device='cuda:3')
norm1 res is  tensor(531.0541, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5133102536201477
distance x is tensor(102.6415, device='cuda:3')
benign distance is  tensor(102.6415, device='cuda:3')
norm1 res is  tensor(457.1485, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.30913683772087097
distance x is tensor(103.5380, device='cuda:3')
benign distance is  tensor(103.5380, device='cuda:3')
norm1 res is  tensor(460.9387, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.039142221212387085
distance x is tensor(108.7672, device='cuda:3')
benign distance is  tensor(108.7672, device='cuda:3')
norm1 res is  tensor(484.6080, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6621812582015991
distance x is tensor(106.0584, device='cuda:3')
benign distance is  tensor(106.0584, device='cuda:3')
norm1 res is  tensor(461.9897, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.17936423420906067
distance x is tensor(109.1720, device='cuda:3')
benign distance is  tensor(109.1720, device='cuda:3')
norm1 res is  tensor(490.3672, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6898472309112549
distance x is tensor(106.0281, device='cuda:3')
benign distance is  tensor(106.0281, device='cuda:3')
norm1 res is  tensor(452.7038, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.31472572684288025
distance x is tensor(114.9425, device='cuda:3')
benign distance is  tensor(114.9425, device='cuda:3')
norm1 res is  tensor(508.0908, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.617751955986023
distance x is tensor(104.1587, device='cuda:3')
benign distance is  tensor(104.1587, device='cuda:3')
norm1 res is  tensor(438.8574, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9079133868217468
distance x is tensor(113.2736, device='cuda:3')
benign distance is  tensor(113.2736, device='cuda:3')
norm1 res is  tensor(498.4702, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.31218740344047546
distance x is tensor(110.5858, device='cuda:3')
benign distance is  tensor(110.5858, device='cuda:3')
norm1 res is  tensor(484.5209, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5691336393356323
distance x is tensor(107.0423, device='cuda:3')
benign distance is  tensor(107.0423, device='cuda:3')
norm1 res is  tensor(460.9522, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6002243161201477
distance x is tensor(111.5286, device='cuda:3')
benign distance is  tensor(111.5286, device='cuda:3')
norm1 res is  tensor(483.5036, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.513704240322113
distance x is tensor(109.1744, device='cuda:3')
benign distance is  tensor(109.1744, device='cuda:3')
norm1 res is  tensor(481.1700, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.8319224119186401
distance x is tensor(102.1642, device='cuda:3')
benign distance is  tensor(102.1642, device='cuda:3')
norm1 res is  tensor(466.4102, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.4142328202724457
distance x is tensor(107.9031, device='cuda:3')
benign distance is  tensor(107.9031, device='cuda:3')
norm1 res is  tensor(478.1560, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.15479125082492828
distance x is tensor(102.9284, device='cuda:3')
benign distance is  tensor(102.9284, device='cuda:3')
norm1 res is  tensor(462.8100, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.7542461156845093
distance x is tensor(115.5654, device='cuda:3')
benign distance is  tensor(115.5654, device='cuda:3')
norm1 res is  tensor(511.9174, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.30540624260902405
distance x is tensor(102.7107, device='cuda:3')
benign distance is  tensor(102.7107, device='cuda:3')
norm1 res is  tensor(450.4174, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.3565989136695862
distance x is tensor(110.0921, device='cuda:3')
benign distance is  tensor(110.0921, device='cuda:3')
norm1 res is  tensor(494.8175, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.3856702446937561
distance x is tensor(110.5153, device='cuda:3')
benign distance is  tensor(110.5153, device='cuda:3')
norm1 res is  tensor(470.4398, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.6225301027297974
distance x is tensor(104.0700, device='cuda:3')
benign distance is  tensor(104.0700, device='cuda:3')
norm1 res is  tensor(463.5610, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.14682021737098694
distance x is tensor(100.8147, device='cuda:3')
benign distance is  tensor(100.8147, device='cuda:3')
norm1 res is  tensor(442.8467, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.16903069615364075
distance x is tensor(105.3574, device='cuda:3')
benign distance is  tensor(105.3574, device='cuda:3')
norm1 res is  tensor(471.4412, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.2891627550125122
distance x is tensor(103.7125, device='cuda:3')
benign distance is  tensor(103.7125, device='cuda:3')
norm1 res is  tensor(443.8998, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.036227334290742874
distance x is tensor(108.7683, device='cuda:3')
benign distance is  tensor(108.7683, device='cuda:3')
norm1 res is  tensor(470.6365, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.021230051293969154
distance x is tensor(105.7413, device='cuda:3')
benign distance is  tensor(105.7413, device='cuda:3')
norm1 res is  tensor(459.9777, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.4266078472137451
distance x is tensor(109.7806, device='cuda:3')
benign distance is  tensor(109.7806, device='cuda:3')
norm1 res is  tensor(482.4571, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.3228694796562195
distance x is tensor(109.1052, device='cuda:3')
benign distance is  tensor(109.1052, device='cuda:3')
norm1 res is  tensor(478.4094, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.5504863858222961
distance x is tensor(107.1140, device='cuda:3')
benign distance is  tensor(107.1140, device='cuda:3')
norm1 res is  tensor(465.9333, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.30105382204055786
distance x is tensor(112.2436, device='cuda:3')
benign distance is  tensor(112.2436, device='cuda:3')
norm1 res is  tensor(496.0851, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(90.0218, device='cuda:3')
compute distance is  tensor(90.0218, device='cuda:3')
compute norm is  tensor(44.9679, device='cuda:3', dtype=torch.float64)
distance x is tensor(80.2553, device='cuda:3')
compute distance is  tensor(80.2553, device='cuda:3')
compute norm is  tensor(44.8963, device='cuda:3', dtype=torch.float64)
distance x is tensor(87.5835, device='cuda:3')
compute distance is  tensor(87.5835, device='cuda:3')
compute norm is  tensor(45.1364, device='cuda:3', dtype=torch.float64)
distance x is tensor(86.5896, device='cuda:3')
compute distance is  tensor(86.5896, device='cuda:3')
compute norm is  tensor(45.0070, device='cuda:3', dtype=torch.float64)
distance x is tensor(87.6327, device='cuda:3')
compute distance is  tensor(87.6327, device='cuda:3')
compute norm is  tensor(44.9531, device='cuda:3', dtype=torch.float64)
distance x is tensor(92.3980, device='cuda:3')
compute distance is  tensor(92.3980, device='cuda:3')
compute norm is  tensor(45.1772, device='cuda:3', dtype=torch.float64)
distance x is tensor(91.1319, device='cuda:3')
compute distance is  tensor(91.1319, device='cuda:3')
compute norm is  tensor(45.1265, device='cuda:3', dtype=torch.float64)
distance x is tensor(92.8962, device='cuda:3')
compute distance is  tensor(92.8962, device='cuda:3')
compute norm is  tensor(45.0886, device='cuda:3', dtype=torch.float64)
distance x is tensor(94.2958, device='cuda:3')
compute distance is  tensor(94.2958, device='cuda:3')
compute norm is  tensor(45.1614, device='cuda:3', dtype=torch.float64)
distance x is tensor(86.0235, device='cuda:3')
compute distance is  tensor(86.0235, device='cuda:3')
compute norm is  tensor(45.0997, device='cuda:3', dtype=torch.float64)
distance x is tensor(91.4754, device='cuda:3')
compute distance is  tensor(91.4754, device='cuda:3')
compute norm is  tensor(45.1426, device='cuda:3', dtype=torch.float64)
distance x is tensor(87.1507, device='cuda:3')
compute distance is  tensor(87.1507, device='cuda:3')
compute norm is  tensor(45.0305, device='cuda:3', dtype=torch.float64)
batch acc is 0.10215000015633194
mal_rand_acc is 0.10000000049999999
mal_rand loss is 125589944008704.0
len of model dicts is  12
distance x is tensor(90.0218, device='cuda:3')
compute distance is  tensor(90.0218, device='cuda:3')
compute norm is  tensor(44.9679, device='cuda:3', dtype=torch.float64)
distance x is tensor(80.2553, device='cuda:3')
compute distance is  tensor(80.2553, device='cuda:3')
compute norm is  tensor(44.8963, device='cuda:3', dtype=torch.float64)
distance x is tensor(87.5835, device='cuda:3')
compute distance is  tensor(87.5835, device='cuda:3')
compute norm is  tensor(45.1364, device='cuda:3', dtype=torch.float64)
distance x is tensor(86.5896, device='cuda:3')
compute distance is  tensor(86.5896, device='cuda:3')
compute norm is  tensor(45.0070, device='cuda:3', dtype=torch.float64)
distance x is tensor(87.6327, device='cuda:3')
compute distance is  tensor(87.6327, device='cuda:3')
compute norm is  tensor(44.9531, device='cuda:3', dtype=torch.float64)
distance x is tensor(92.3980, device='cuda:3')
compute distance is  tensor(92.3980, device='cuda:3')
compute norm is  tensor(45.1772, device='cuda:3', dtype=torch.float64)
distance x is tensor(91.1319, device='cuda:3')
compute distance is  tensor(91.1319, device='cuda:3')
compute norm is  tensor(45.1265, device='cuda:3', dtype=torch.float64)
distance x is tensor(92.8962, device='cuda:3')
compute distance is  tensor(92.8962, device='cuda:3')
compute norm is  tensor(45.0886, device='cuda:3', dtype=torch.float64)
distance x is tensor(94.2958, device='cuda:3')
compute distance is  tensor(94.2958, device='cuda:3')
compute norm is  tensor(45.1614, device='cuda:3', dtype=torch.float64)
distance x is tensor(86.0235, device='cuda:3')
compute distance is  tensor(86.0235, device='cuda:3')
compute norm is  tensor(45.0997, device='cuda:3', dtype=torch.float64)
distance x is tensor(91.4754, device='cuda:3')
compute distance is  tensor(91.4754, device='cuda:3')
compute norm is  tensor(45.1426, device='cuda:3', dtype=torch.float64)
distance x is tensor(87.1507, device='cuda:3')
compute distance is  tensor(87.1507, device='cuda:3')
compute norm is  tensor(45.0305, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(94.2958, device='cuda:3')
distance x is tensor(106202.3281, device='cuda:3')
distance x is tensor(106202.3281, device='cuda:3')
________________________________
test distance is  tensor(106202.3281, device='cuda:3')
test distance1 is  tensor(106202.3281, device='cuda:3')
test similarity is  tensor(-0.1071, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139294963568386.73
test entropy is  0.0
________________________________
cal ratio is  0.029201499903682246
distance x is tensor(3101.2732, device='cuda:3')
cal_distance is  tensor(3101.2732, device='cuda:3')
cal ratio is  0.17088430254655484
distance x is tensor(529.9630, device='cuda:3')
cal_distance is  tensor(529.9630, device='cuda:3')
cal ratio is  0.4133799661234807
distance x is tensor(219.0790, device='cuda:3')
cal_distance is  tensor(219.0790, device='cuda:3')
cal ratio is  0.6429419479531462
distance x is tensor(140.8569, device='cuda:3')
cal_distance is  tensor(140.8569, device='cuda:3')
cal ratio is  0.8018314646634556
distance x is tensor(112.9445, device='cuda:3')
cal_distance is  tensor(112.9445, device='cuda:3')
cal ratio is  0.8954463606621204
distance x is tensor(101.1363, device='cuda:3')
cal_distance is  tensor(101.1363, device='cuda:3')
cal ratio is  0.9462778362604255
distance x is tensor(95.7033, device='cuda:3')
cal_distance is  tensor(95.7033, device='cuda:3')
cal ratio is  0.9727666863187014
distance x is tensor(93.0971, device='cuda:3')
cal_distance is  tensor(93.0971, device='cuda:3')
distance x is tensor(93.0971, device='cuda:3')
return_distance is  tensor(93.0971, device='cuda:3')
distance x is tensor(93.0871, device='cuda:3')
distance x is tensor(93.0871, device='cuda:3')
________________________________
test distance is  tensor(93.0871, device='cuda:3')
test distance1 is  tensor(93.0871, device='cuda:3')
test similarity is  tensor(0.9706, device='cuda:3')
test acc is  0.10000000015633198
test loss is 101.46407514136992
test entropy is  6.008462080646879e-12
________________________________
0
distance x is tensor(93.0871, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.5959827881114014e-09
avg test loss is  101.47395391403231
avg accuracy is  0.7796166668229931
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9706, device='cuda:3')
compute_distance is  tensor(93.0871, device='cuda:3')
compute_norm is  tensor(43.7911, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(86.7567, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8577099630573412
avg test loss is  1.2307064292400376
avg accuracy is  0.8763000001563225
solo acc is  0.37608333348967415
compute similarity  is  tensor(0.9723, device='cuda:3')
compute_distance is  tensor(86.7567, device='cuda:3')
compute_norm is  tensor(42.7438, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(89.7495, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7903814767596564
avg test loss is  1.3679804208436246
avg accuracy is  0.8758500001563224
solo acc is  0.26200000015633856
compute similarity  is  tensor(0.9717, device='cuda:3')
compute_distance is  tensor(89.7495, device='cuda:3')
compute_norm is  tensor(42.4625, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(92.2938, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7946407408602456
avg test loss is  1.3177935644380574
avg accuracy is  0.8779833334896557
solo acc is  0.2616833334896719
compute similarity  is  tensor(0.9711, device='cuda:3')
compute_distance is  tensor(92.2938, device='cuda:3')
compute_norm is  tensor(42.2082, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(94.5792, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7919694403849685
avg test loss is  1.293372591103572
avg accuracy is  0.878316666822989
solo acc is  0.25571666682300503
compute similarity  is  tensor(0.9707, device='cuda:3')
compute_distance is  tensor(94.5792, device='cuda:3')
compute_norm is  tensor(41.9681, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(96.7840, device='cuda:3')
distance x is tensor(96.7840, device='cuda:3')
________________________________
test distance is  tensor(96.7840, device='cuda:3')
test distance1 is  tensor(96.7840, device='cuda:3')
test similarity is  tensor(0.9703, device='cuda:3')
test acc is  0.24546666682300472
test loss is 1.2890148432905486
test entropy is  0.7825722951116338
________________________________
cal ratio is  0.9673202827896212
distance x is tensor(93.6278, device='cuda:3')
cal_distance is  tensor(93.6278, device='cuda:3')
distance x is tensor(93.6278, device='cuda:3')
return_distance is  tensor(93.6278, device='cuda:3')
distance x is tensor(93.6211, device='cuda:3')
distance x is tensor(93.6211, device='cuda:3')
________________________________
test distance is  tensor(93.6211, device='cuda:3')
test distance1 is  tensor(93.6211, device='cuda:3')
test similarity is  tensor(0.9722, device='cuda:3')
test acc is  0.39455000015634106
test loss is 1.108129274044464
test entropy is  0.8341226746786886
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.0207197666168213
mal norm is  tensor(459.3633, device='cuda:3')
distance x is tensor(93.6278, device='cuda:3')
mal distance is  tensor(93.6278, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([19., 19., 19., 19., 19., 19., 19., 19., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0669,
        0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669,
        0.0669, 0.0669])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 82.73% 

Test Accuracy: 81.59% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.840154767036438
distance x is tensor(109.5543, device='cuda:3')
benign distance is  tensor(109.5543, device='cuda:3')
norm1 res is  tensor(448.9058, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5029846429824829
distance x is tensor(115.0371, device='cuda:3')
benign distance is  tensor(115.0371, device='cuda:3')
norm1 res is  tensor(470.7923, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4638180136680603
distance x is tensor(122.3227, device='cuda:3')
benign distance is  tensor(122.3227, device='cuda:3')
norm1 res is  tensor(509.6242, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7516164183616638
distance x is tensor(112.3256, device='cuda:3')
benign distance is  tensor(112.3256, device='cuda:3')
norm1 res is  tensor(458.6833, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.038651466369629
distance x is tensor(113.5900, device='cuda:3')
benign distance is  tensor(113.5900, device='cuda:3')
norm1 res is  tensor(457.4367, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8774949312210083
distance x is tensor(121.3107, device='cuda:3')
benign distance is  tensor(121.3107, device='cuda:3')
norm1 res is  tensor(498.8235, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2633008360862732
distance x is tensor(115.2832, device='cuda:3')
benign distance is  tensor(115.2832, device='cuda:3')
norm1 res is  tensor(464.8561, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5161124467849731
distance x is tensor(120.3798, device='cuda:3')
benign distance is  tensor(120.3798, device='cuda:3')
norm1 res is  tensor(492.4735, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(121.6123, device='cuda:3')
compute distance is  tensor(121.6123, device='cuda:3')
compute norm is  tensor(43.7850, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.5471, device='cuda:3')
compute distance is  tensor(111.5471, device='cuda:3')
compute norm is  tensor(43.6295, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.0903, device='cuda:3')
compute distance is  tensor(129.0903, device='cuda:3')
compute norm is  tensor(44.1497, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.3602, device='cuda:3')
compute distance is  tensor(119.3602, device='cuda:3')
compute norm is  tensor(43.9181, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.3622, device='cuda:3')
compute distance is  tensor(120.3622, device='cuda:3')
compute norm is  tensor(43.8446, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.5345, device='cuda:3')
compute distance is  tensor(113.5345, device='cuda:3')
compute norm is  tensor(43.8554, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.9116, device='cuda:3')
compute distance is  tensor(135.9116, device='cuda:3')
compute norm is  tensor(44.3293, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.2715, device='cuda:3')
compute distance is  tensor(125.2715, device='cuda:3')
compute norm is  tensor(43.9912, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.3760, device='cuda:3')
compute distance is  tensor(131.3760, device='cuda:3')
compute norm is  tensor(44.0572, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.7588, device='cuda:3')
compute distance is  tensor(116.7588, device='cuda:3')
compute norm is  tensor(43.7855, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.2159, device='cuda:3')
compute distance is  tensor(121.2159, device='cuda:3')
compute norm is  tensor(44.0322, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.9520, device='cuda:3')
compute distance is  tensor(121.9520, device='cuda:3')
compute norm is  tensor(43.9097, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(135.9116, device='cuda:3')
distance x is tensor(106156.6562, device='cuda:3')
distance x is tensor(106156.6562, device='cuda:3')
________________________________
test distance is  tensor(106156.6562, device='cuda:3')
test distance1 is  tensor(106156.6562, device='cuda:3')
test similarity is  tensor(0.0524, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139266955526598.14
test entropy is  0.0
________________________________
cal ratio is  0.03506555835606143
distance x is tensor(3722.4478, device='cuda:3')
cal_distance is  tensor(3722.4478, device='cuda:3')
cal ratio is  0.1872578652603958
distance x is tensor(697.0616, device='cuda:3')
cal_distance is  tensor(697.0616, device='cuda:3')
cal ratio is  0.432731769248829
distance x is tensor(301.6436, device='cuda:3')
cal_distance is  tensor(301.6436, device='cuda:3')
cal ratio is  0.6578203742491547
distance x is tensor(198.4290, device='cuda:3')
cal_distance is  tensor(198.4290, device='cuda:3')
cal ratio is  0.8110577644003536
distance x is tensor(160.9383, device='cuda:3')
cal_distance is  tensor(160.9383, device='cuda:3')
cal ratio is  0.9005848398460462
distance x is tensor(144.9391, device='cuda:3')
cal_distance is  tensor(144.9391, device='cuda:3')
cal ratio is  0.9489897456966745
distance x is tensor(137.5460, device='cuda:3')
cal_distance is  tensor(137.5460, device='cuda:3')
cal ratio is  0.9741600949909023
distance x is tensor(133.9920, device='cuda:3')
cal_distance is  tensor(133.9920, device='cuda:3')
distance x is tensor(133.9920, device='cuda:3')
return_distance is  tensor(133.9920, device='cuda:3')
distance x is tensor(133.9820, device='cuda:3')
distance x is tensor(133.9820, device='cuda:3')
________________________________
test distance is  tensor(133.9820, device='cuda:3')
test distance1 is  tensor(133.9820, device='cuda:3')
test similarity is  tensor(0.9420, device='cuda:3')
test acc is  0.10000000015633198
test loss is 603.9534055144547
test entropy is  0.0
________________________________
0
distance x is tensor(133.9820, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  604.0638423830208
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9420, device='cuda:3')
compute_distance is  tensor(133.9820, device='cuda:3')
compute_norm is  tensor(44.2496, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(129.6885, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8563880545498211
avg test loss is  1.4737883276268364
avg accuracy is  0.36690000015634067
solo acc is  0.2663166668230054
compute similarity  is  tensor(0.9457, device='cuda:3')
compute_distance is  tensor(129.6885, device='cuda:3')
compute_norm is  tensor(44.0259, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(129.6885, device='cuda:3')
distance x is tensor(129.6885, device='cuda:3')
________________________________
test distance is  tensor(129.6885, device='cuda:3')
test distance1 is  tensor(129.6885, device='cuda:3')
test similarity is  tensor(0.9457, device='cuda:3')
test acc is  0.2679500001563388
test loss is 1.4680231611357568
test entropy is  0.8573395414138908
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.297844409942627
mal norm is  tensor(653.5054, device='cuda:3')
distance x is tensor(129.6959, device='cuda:3')
mal distance is  tensor(129.6959, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([27., 27., 27., 27., 27., 27., 27., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 27., 27., 27., 27., 27., 27., 27.])
count_res tensor([6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 89.65% 

Test Accuracy: 88.94% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6843143701553345
distance x is tensor(89.6256, device='cuda:3')
benign distance is  tensor(89.6256, device='cuda:3')
norm1 res is  tensor(401.3455, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9868487119674683
distance x is tensor(93.2797, device='cuda:3')
benign distance is  tensor(93.2797, device='cuda:3')
norm1 res is  tensor(412.8838, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.38790661096572876
distance x is tensor(101.3112, device='cuda:3')
benign distance is  tensor(101.3112, device='cuda:3')
norm1 res is  tensor(425.6469, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6528366208076477
distance x is tensor(98.3325, device='cuda:3')
benign distance is  tensor(98.3325, device='cuda:3')
norm1 res is  tensor(423.8414, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0326898097991943
distance x is tensor(96.4675, device='cuda:3')
benign distance is  tensor(96.4675, device='cuda:3')
norm1 res is  tensor(412.3691, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8861284255981445
distance x is tensor(97.2395, device='cuda:3')
benign distance is  tensor(97.2395, device='cuda:3')
norm1 res is  tensor(423.6586, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5583178997039795
distance x is tensor(93.5306, device='cuda:3')
benign distance is  tensor(93.5306, device='cuda:3')
norm1 res is  tensor(401.0020, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.22117707133293152
distance x is tensor(95.2590, device='cuda:3')
benign distance is  tensor(95.2590, device='cuda:3')
norm1 res is  tensor(422.3411, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.22415265440940857
distance x is tensor(113.1810, device='cuda:3')
benign distance is  tensor(113.1810, device='cuda:3')
norm1 res is  tensor(491.5374, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6732856035232544
distance x is tensor(114.4120, device='cuda:3')
benign distance is  tensor(114.4120, device='cuda:3')
norm1 res is  tensor(497.1172, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.667235791683197
distance x is tensor(105.0895, device='cuda:3')
benign distance is  tensor(105.0895, device='cuda:3')
norm1 res is  tensor(461.9806, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8246415853500366
distance x is tensor(111.9230, device='cuda:3')
benign distance is  tensor(111.9230, device='cuda:3')
norm1 res is  tensor(478.5402, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0797721147537231
distance x is tensor(113.7554, device='cuda:3')
benign distance is  tensor(113.7554, device='cuda:3')
norm1 res is  tensor(500.2305, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.29520750045776367
distance x is tensor(114.0137, device='cuda:3')
benign distance is  tensor(114.0137, device='cuda:3')
norm1 res is  tensor(490.9898, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5723228454589844
distance x is tensor(110.2718, device='cuda:3')
benign distance is  tensor(110.2718, device='cuda:3')
norm1 res is  tensor(487.9553, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.36565789580345154
distance x is tensor(114.7488, device='cuda:3')
benign distance is  tensor(114.7488, device='cuda:3')
norm1 res is  tensor(502.6062, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(106.2174, device='cuda:3')
compute distance is  tensor(106.2174, device='cuda:3')
compute norm is  tensor(44.8783, device='cuda:3', dtype=torch.float64)
distance x is tensor(85.7671, device='cuda:3')
compute distance is  tensor(85.7671, device='cuda:3')
compute norm is  tensor(44.5628, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.2139, device='cuda:3')
compute distance is  tensor(106.2139, device='cuda:3')
compute norm is  tensor(44.9520, device='cuda:3', dtype=torch.float64)
distance x is tensor(94.8259, device='cuda:3')
compute distance is  tensor(94.8259, device='cuda:3')
compute norm is  tensor(44.7648, device='cuda:3', dtype=torch.float64)
distance x is tensor(97.5694, device='cuda:3')
compute distance is  tensor(97.5694, device='cuda:3')
compute norm is  tensor(44.7814, device='cuda:3', dtype=torch.float64)
distance x is tensor(92.8165, device='cuda:3')
compute distance is  tensor(92.8165, device='cuda:3')
compute norm is  tensor(44.6970, device='cuda:3', dtype=torch.float64)
distance x is tensor(92.1314, device='cuda:3')
compute distance is  tensor(92.1314, device='cuda:3')
compute norm is  tensor(44.6791, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.3133, device='cuda:3')
compute distance is  tensor(103.3133, device='cuda:3')
compute norm is  tensor(44.9075, device='cuda:3', dtype=torch.float64)
distance x is tensor(96.8334, device='cuda:3')
compute distance is  tensor(96.8334, device='cuda:3')
compute norm is  tensor(44.7816, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.0787, device='cuda:3')
compute distance is  tensor(104.0787, device='cuda:3')
compute norm is  tensor(44.8506, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.9122, device='cuda:3')
compute distance is  tensor(100.9122, device='cuda:3')
compute norm is  tensor(44.9282, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.0999, device='cuda:3')
compute distance is  tensor(98.0999, device='cuda:3')
compute norm is  tensor(44.7583, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(106.2174, device='cuda:3')
distance x is tensor(106183.8828, device='cuda:3')
distance x is tensor(106183.8828, device='cuda:3')
________________________________
test distance is  tensor(106183.8828, device='cuda:3')
test distance1 is  tensor(106183.8828, device='cuda:3')
test similarity is  tensor(-0.0424, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139290220060968.94
test entropy is  0.0
________________________________
cal ratio is  0.030995208115235342
distance x is tensor(3291.1968, device='cuda:3')
cal_distance is  tensor(3291.1968, device='cuda:3')
cal ratio is  0.17605441110139408
distance x is tensor(579.4338, device='cuda:3')
cal_distance is  tensor(579.4338, device='cuda:3')
cal ratio is  0.41958692443369056
distance x is tensor(243.1257, device='cuda:3')
cal_distance is  tensor(243.1257, device='cuda:3')
cal ratio is  0.6477514562262858
distance x is tensor(157.4868, device='cuda:3')
cal_distance is  tensor(157.4868, device='cuda:3')
cal ratio is  0.8048255140445176
distance x is tensor(126.7504, device='cuda:3')
cal_distance is  tensor(126.7504, device='cuda:3')
cal ratio is  0.8971172281991391
distance x is tensor(113.7105, device='cuda:3')
cal_distance is  tensor(113.7105, device='cuda:3')
cal ratio is  0.947160548824435
distance x is tensor(107.7023, device='cuda:3')
cal_distance is  tensor(107.7023, device='cuda:3')
cal ratio is  0.973220554822576
distance x is tensor(104.8183, device='cuda:3')
cal_distance is  tensor(104.8183, device='cuda:3')
distance x is tensor(104.8183, device='cuda:3')
return_distance is  tensor(104.8183, device='cuda:3')
distance x is tensor(104.8084, device='cuda:3')
distance x is tensor(104.8084, device='cuda:3')
________________________________
test distance is  tensor(104.8084, device='cuda:3')
test distance1 is  tensor(104.8084, device='cuda:3')
test similarity is  tensor(0.9632, device='cuda:3')
test acc is  0.10000000015633198
test loss is 172.20516507406987
test entropy is  4.2318087419254737e-22
________________________________
0
distance x is tensor(104.8084, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.8279480213954244e-22
avg test loss is  172.21559813281874
avg accuracy is  0.4823333334896753
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9632, device='cuda:3')
compute_distance is  tensor(104.8084, device='cuda:3')
compute_norm is  tensor(44.1647, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(94.0844, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7834832959973228
avg test loss is  1.300062173846434
avg accuracy is  0.8797833334896555
solo acc is  0.3086666668230063
compute similarity  is  tensor(0.9657, device='cuda:3')
compute_distance is  tensor(94.0844, device='cuda:3')
compute_norm is  tensor(43.2256, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(95.9082, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7893294095357598
avg test loss is  1.294442706779122
avg accuracy is  0.8804333334896555
solo acc is  0.2704166668230054
compute similarity  is  tensor(0.9653, device='cuda:3')
compute_distance is  tensor(95.9082, device='cuda:3')
compute_norm is  tensor(42.9558, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(97.5788, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7816520188408874
avg test loss is  1.2878297847598346
avg accuracy is  0.8811333334896555
solo acc is  0.2550000001563384
compute similarity  is  tensor(0.9649, device='cuda:3')
compute_distance is  tensor(97.5788, device='cuda:3')
compute_norm is  tensor(42.7072, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(99.2322, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7786506120202892
avg test loss is  1.2668075170725392
avg accuracy is  0.8833166668229887
solo acc is  0.2531333334896717
compute similarity  is  tensor(0.9646, device='cuda:3')
compute_distance is  tensor(99.2322, device='cuda:3')
compute_norm is  tensor(42.4688, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(100.9076, device='cuda:3')
distance x is tensor(100.9076, device='cuda:3')
________________________________
test distance is  tensor(100.9076, device='cuda:3')
test distance1 is  tensor(100.9076, device='cuda:3')
test similarity is  tensor(0.9643, device='cuda:3')
test acc is  0.26098333348967184
test loss is 1.2316495445110143
test entropy is  0.7870037312319538
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.0697726011276245
mal norm is  tensor(515.1238, device='cuda:3')
distance x is tensor(100.9144, device='cuda:3')
mal distance is  tensor(100.9144, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([27., 27., 27., 27., 27., 27., 27., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 27., 27., 27., 27., 27., 27., 27.])
count_res tensor([6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 89.77% 

Test Accuracy: 89.01% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5200070142745972
distance x is tensor(93.2201, device='cuda:3')
benign distance is  tensor(93.2201, device='cuda:3')
norm1 res is  tensor(398.6483, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8392731547355652
distance x is tensor(92.1304, device='cuda:3')
benign distance is  tensor(92.1304, device='cuda:3')
norm1 res is  tensor(410.1788, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.07097090035676956
distance x is tensor(100.8553, device='cuda:3')
benign distance is  tensor(100.8553, device='cuda:3')
norm1 res is  tensor(436.1685, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3506123423576355
distance x is tensor(91.5235, device='cuda:3')
benign distance is  tensor(91.5235, device='cuda:3')
norm1 res is  tensor(395.0218, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9498909711837769
distance x is tensor(87.6487, device='cuda:3')
benign distance is  tensor(87.6487, device='cuda:3')
norm1 res is  tensor(378.9749, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4148988127708435
distance x is tensor(99.2872, device='cuda:3')
benign distance is  tensor(99.2872, device='cuda:3')
norm1 res is  tensor(434.5428, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.322089821100235
distance x is tensor(100.7677, device='cuda:3')
benign distance is  tensor(100.7677, device='cuda:3')
norm1 res is  tensor(425.3616, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.09410913288593292
distance x is tensor(101.6649, device='cuda:3')
benign distance is  tensor(101.6649, device='cuda:3')
norm1 res is  tensor(441.6838, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2766363322734833
distance x is tensor(111.5609, device='cuda:3')
benign distance is  tensor(111.5609, device='cuda:3')
norm1 res is  tensor(502.8294, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.0580459833145142
distance x is tensor(121.4511, device='cuda:3')
benign distance is  tensor(121.4511, device='cuda:3')
norm1 res is  tensor(529.6942, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3241855800151825
distance x is tensor(110.2904, device='cuda:3')
benign distance is  tensor(110.2904, device='cuda:3')
norm1 res is  tensor(489.7569, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.11419578641653061
distance x is tensor(118.6493, device='cuda:3')
benign distance is  tensor(118.6493, device='cuda:3')
norm1 res is  tensor(521.5350, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.05048670619726181
distance x is tensor(115.4879, device='cuda:3')
benign distance is  tensor(115.4879, device='cuda:3')
norm1 res is  tensor(514.2095, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8385860323905945
distance x is tensor(109.6573, device='cuda:3')
benign distance is  tensor(109.6573, device='cuda:3')
norm1 res is  tensor(479.4103, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3129662573337555
distance x is tensor(117.3043, device='cuda:3')
benign distance is  tensor(117.3043, device='cuda:3')
norm1 res is  tensor(539.6605, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3181551396846771
distance x is tensor(112.0155, device='cuda:3')
benign distance is  tensor(112.0155, device='cuda:3')
norm1 res is  tensor(484.3683, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(95.6355, device='cuda:3')
compute distance is  tensor(95.6355, device='cuda:3')
compute norm is  tensor(45.2950, device='cuda:3', dtype=torch.float64)
distance x is tensor(94.0190, device='cuda:3')
compute distance is  tensor(94.0190, device='cuda:3')
compute norm is  tensor(45.3510, device='cuda:3', dtype=torch.float64)
distance x is tensor(96.6625, device='cuda:3')
compute distance is  tensor(96.6625, device='cuda:3')
compute norm is  tensor(45.5037, device='cuda:3', dtype=torch.float64)
distance x is tensor(90.4520, device='cuda:3')
compute distance is  tensor(90.4520, device='cuda:3')
compute norm is  tensor(45.2686, device='cuda:3', dtype=torch.float64)
distance x is tensor(97.1460, device='cuda:3')
compute distance is  tensor(97.1460, device='cuda:3')
compute norm is  tensor(45.2691, device='cuda:3', dtype=torch.float64)
distance x is tensor(96.9601, device='cuda:3')
compute distance is  tensor(96.9601, device='cuda:3')
compute norm is  tensor(45.4241, device='cuda:3', dtype=torch.float64)
distance x is tensor(89.7336, device='cuda:3')
compute distance is  tensor(89.7336, device='cuda:3')
compute norm is  tensor(45.3801, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.2341, device='cuda:3')
compute distance is  tensor(108.2341, device='cuda:3')
compute norm is  tensor(45.5517, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.6585, device='cuda:3')
compute distance is  tensor(99.6585, device='cuda:3')
compute norm is  tensor(45.3314, device='cuda:3', dtype=torch.float64)
distance x is tensor(92.8754, device='cuda:3')
compute distance is  tensor(92.8754, device='cuda:3')
compute norm is  tensor(45.3450, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.6598, device='cuda:3')
compute distance is  tensor(98.6598, device='cuda:3')
compute norm is  tensor(45.5005, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.6589, device='cuda:3')
compute distance is  tensor(103.6589, device='cuda:3')
compute norm is  tensor(45.5523, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(108.2341, device='cuda:3')
distance x is tensor(106191.6797, device='cuda:3')
distance x is tensor(106191.6797, device='cuda:3')
________________________________
test distance is  tensor(106191.6797, device='cuda:3')
test distance1 is  tensor(106191.6797, device='cuda:3')
test similarity is  tensor(-0.0743, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139271506650502.83
test entropy is  0.0
________________________________
cal ratio is  0.03128693123245866
distance x is tensor(3322.4167, device='cuda:3')
cal_distance is  tensor(3322.4167, device='cuda:3')
cal ratio is  0.17688098642493308
distance x is tensor(587.6765, device='cuda:3')
cal_distance is  tensor(587.6765, device='cuda:3')
cal ratio is  0.42057074544796924
distance x is tensor(247.1624, device='cuda:3')
cal_distance is  tensor(247.1624, device='cuda:3')
cal ratio is  0.648510452376714
distance x is tensor(160.2892, device='cuda:3')
cal_distance is  tensor(160.2892, device='cuda:3')
cal ratio is  0.8052970858406194
distance x is tensor(129.0814, device='cuda:3')
cal_distance is  tensor(129.0814, device='cuda:3')
cal ratio is  0.8973800515536022
distance x is tensor(115.8356, device='cuda:3')
cal_distance is  tensor(115.8356, device='cuda:3')
cal ratio is  0.9472992736377305
distance x is tensor(109.7312, device='cuda:3')
cal_distance is  tensor(109.7312, device='cuda:3')
cal ratio is  0.9732918119814341
distance x is tensor(106.8007, device='cuda:3')
cal_distance is  tensor(106.8007, device='cuda:3')
distance x is tensor(106.8007, device='cuda:3')
return_distance is  tensor(106.8007, device='cuda:3')
distance x is tensor(106.7907, device='cuda:3')
distance x is tensor(106.7907, device='cuda:3')
________________________________
test distance is  tensor(106.7907, device='cuda:3')
test distance1 is  tensor(106.7907, device='cuda:3')
test similarity is  tensor(0.9624, device='cuda:3')
test acc is  0.10000000015633198
test loss is 200.06890573074568
test entropy is  4.2076801598889376e-26
________________________________
0
distance x is tensor(106.7907, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  4.5076900318418034e-27
avg test loss is  200.188941760358
avg accuracy is  0.48680000015634195
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9624, device='cuda:3')
compute_distance is  tensor(106.7907, device='cuda:3')
compute_norm is  tensor(44.5381, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(96.1388, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7750784639102309
avg test loss is  1.3548093035277018
avg accuracy is  0.8746000001563223
solo acc is  0.30480000015633957
compute similarity  is  tensor(0.9652, device='cuda:3')
compute_distance is  tensor(96.1388, device='cuda:3')
compute_norm is  tensor(43.4953, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(98.6229, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7583245802154419
avg test loss is  1.3996089113546586
avg accuracy is  0.8752000001563224
solo acc is  0.2372666668230045
compute similarity  is  tensor(0.9645, device='cuda:3')
compute_distance is  tensor(98.6229, device='cuda:3')
compute_norm is  tensor(43.2109, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(100.5973, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7808516702926489
avg test loss is  1.307224216809405
avg accuracy is  0.8754500001563223
solo acc is  0.2569000001563384
compute similarity  is  tensor(0.9641, device='cuda:3')
compute_distance is  tensor(100.5973, device='cuda:3')
compute_norm is  tensor(42.9528, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(102.4856, device='cuda:3')
exit early
distance x is tensor(102.4856, device='cuda:3')
distance x is tensor(102.4856, device='cuda:3')
________________________________
test distance is  tensor(102.4856, device='cuda:3')
test distance1 is  tensor(102.4856, device='cuda:3')
test similarity is  tensor(0.9637, device='cuda:3')
test acc is  0.2376333334896711
test loss is 1.312632160908632
test entropy is  0.7700045403005726
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2083141803741455
mal norm is  tensor(526.6248, device='cuda:3')
distance x is tensor(102.4922, device='cuda:3')
mal distance is  tensor(102.4922, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([35., 35., 35., 35., 35., 35., 35., 35., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 35., 35., 35., 35., 35., 35., 35., 35.,
        35., 35., 35., 35., 35., 35., 35., 35.])
count_res tensor([4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07,
        6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07,
        6.9590e-07, 6.9590e-07, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 89.88% 

Test Accuracy: 88.95% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4619739055633545
distance x is tensor(79.0250, device='cuda:3')
benign distance is  tensor(79.0250, device='cuda:3')
norm1 res is  tensor(361.4048, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9397205114364624
distance x is tensor(79.0338, device='cuda:3')
benign distance is  tensor(79.0338, device='cuda:3')
norm1 res is  tensor(357.5309, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.17260807752609253
distance x is tensor(102.7417, device='cuda:3')
benign distance is  tensor(102.7417, device='cuda:3')
norm1 res is  tensor(452.2182, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5113462805747986
distance x is tensor(91.3106, device='cuda:3')
benign distance is  tensor(91.3106, device='cuda:3')
norm1 res is  tensor(391.8348, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8173470497131348
distance x is tensor(79.5326, device='cuda:3')
benign distance is  tensor(79.5326, device='cuda:3')
norm1 res is  tensor(345.0310, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7423602938652039
distance x is tensor(89.5544, device='cuda:3')
benign distance is  tensor(89.5544, device='cuda:3')
norm1 res is  tensor(399.6337, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3649694323539734
distance x is tensor(86.5528, device='cuda:3')
benign distance is  tensor(86.5528, device='cuda:3')
norm1 res is  tensor(372.6249, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.24295762181282043
distance x is tensor(93.9610, device='cuda:3')
benign distance is  tensor(93.9610, device='cuda:3')
norm1 res is  tensor(415.6870, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.28170284628868103
distance x is tensor(116.0434, device='cuda:3')
benign distance is  tensor(116.0434, device='cuda:3')
norm1 res is  tensor(516.0377, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6938391923904419
distance x is tensor(115.4343, device='cuda:3')
benign distance is  tensor(115.4343, device='cuda:3')
norm1 res is  tensor(521.3894, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.06331111490726471
distance x is tensor(112.6367, device='cuda:3')
benign distance is  tensor(112.6367, device='cuda:3')
norm1 res is  tensor(486.0777, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8935219049453735
distance x is tensor(111.3301, device='cuda:3')
benign distance is  tensor(111.3301, device='cuda:3')
norm1 res is  tensor(498.6345, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8232733011245728
distance x is tensor(105.4685, device='cuda:3')
benign distance is  tensor(105.4685, device='cuda:3')
norm1 res is  tensor(466.2784, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.17537853121757507
distance x is tensor(111.5701, device='cuda:3')
benign distance is  tensor(111.5701, device='cuda:3')
norm1 res is  tensor(503.5719, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9317046403884888
distance x is tensor(104.2316, device='cuda:3')
benign distance is  tensor(104.2316, device='cuda:3')
norm1 res is  tensor(471.4278, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.565708339214325
distance x is tensor(117.8352, device='cuda:3')
benign distance is  tensor(117.8352, device='cuda:3')
norm1 res is  tensor(518.0896, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3808686137199402
distance x is tensor(123.6949, device='cuda:3')
benign distance is  tensor(123.6949, device='cuda:3')
norm1 res is  tensor(537.1115, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.36921265721321106
distance x is tensor(105.0997, device='cuda:3')
benign distance is  tensor(105.0997, device='cuda:3')
norm1 res is  tensor(462.1484, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.2886955440044403
distance x is tensor(114.9584, device='cuda:3')
benign distance is  tensor(114.9584, device='cuda:3')
norm1 res is  tensor(498.8628, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4106455445289612
distance x is tensor(115.3007, device='cuda:3')
benign distance is  tensor(115.3007, device='cuda:3')
norm1 res is  tensor(515.6851, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6972485780715942
distance x is tensor(106.2750, device='cuda:3')
benign distance is  tensor(106.2750, device='cuda:3')
norm1 res is  tensor(478.8161, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6123993992805481
distance x is tensor(114.5881, device='cuda:3')
benign distance is  tensor(114.5881, device='cuda:3')
norm1 res is  tensor(517.2639, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.8139870762825012
distance x is tensor(107.4164, device='cuda:3')
benign distance is  tensor(107.4164, device='cuda:3')
norm1 res is  tensor(488.8319, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.15221138298511505
distance x is tensor(109.8660, device='cuda:3')
benign distance is  tensor(109.8660, device='cuda:3')
norm1 res is  tensor(502.8319, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(106.4325, device='cuda:3')
compute distance is  tensor(106.4325, device='cuda:3')
compute norm is  tensor(45.5736, device='cuda:3', dtype=torch.float64)
distance x is tensor(91.2675, device='cuda:3')
compute distance is  tensor(91.2675, device='cuda:3')
compute norm is  tensor(45.3901, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.8050, device='cuda:3')
compute distance is  tensor(100.8050, device='cuda:3')
compute norm is  tensor(45.6141, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.8905, device='cuda:3')
compute distance is  tensor(95.8905, device='cuda:3')
compute norm is  tensor(45.4606, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.5694, device='cuda:3')
compute distance is  tensor(112.5694, device='cuda:3')
compute norm is  tensor(45.7766, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.8281, device='cuda:3')
compute distance is  tensor(104.8281, device='cuda:3')
compute norm is  tensor(45.7854, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.4854, device='cuda:3')
compute distance is  tensor(104.4854, device='cuda:3')
compute norm is  tensor(45.6393, device='cuda:3', dtype=torch.float64)
distance x is tensor(93.5473, device='cuda:3')
compute distance is  tensor(93.5473, device='cuda:3')
compute norm is  tensor(45.3954, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.5730, device='cuda:3')
compute distance is  tensor(109.5730, device='cuda:3')
compute norm is  tensor(45.7499, device='cuda:3', dtype=torch.float64)
distance x is tensor(91.5309, device='cuda:3')
compute distance is  tensor(91.5309, device='cuda:3')
compute norm is  tensor(45.4690, device='cuda:3', dtype=torch.float64)
distance x is tensor(96.4131, device='cuda:3')
compute distance is  tensor(96.4131, device='cuda:3')
compute norm is  tensor(45.5977, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.9434, device='cuda:3')
compute distance is  tensor(98.9434, device='cuda:3')
compute norm is  tensor(45.4702, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(112.5694, device='cuda:3')
distance x is tensor(106192.2500, device='cuda:3')
distance x is tensor(106192.2500, device='cuda:3')
________________________________
test distance is  tensor(106192.2500, device='cuda:3')
test distance1 is  tensor(106192.2500, device='cuda:3')
test similarity is  tensor(-0.0751, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139302029691766.45
test entropy is  0.0
________________________________
cal ratio is  0.031907279127999615
distance x is tensor(3388.3113, device='cuda:3')
cal_distance is  tensor(3388.3113, device='cuda:3')
cal ratio is  0.17862593746656724
distance x is tensor(605.2444, device='cuda:3')
cal_distance is  tensor(605.2444, device='cuda:3')
cal ratio is  0.4226401896995078
distance x is tensor(255.8035, device='cuda:3')
cal_distance is  tensor(255.8035, device='cuda:3')
cal ratio is  0.650104158804189
distance x is tensor(166.3007, device='cuda:3')
cal_distance is  tensor(166.3007, device='cuda:3')
cal ratio is  0.806286119672196
distance x is tensor(134.0869, device='cuda:3')
cal_distance is  tensor(134.0869, device='cuda:3')
cal ratio is  0.8979311277474475
distance x is tensor(120.4013, device='cuda:3')
cal_distance is  tensor(120.4013, device='cuda:3')
cal ratio is  0.9475902245675522
distance x is tensor(114.0914, device='cuda:3')
cal_distance is  tensor(114.0914, device='cuda:3')
cal ratio is  0.973441308603444
distance x is tensor(111.0614, device='cuda:3')
cal_distance is  tensor(111.0614, device='cuda:3')
distance x is tensor(111.0614, device='cuda:3')
return_distance is  tensor(111.0614, device='cuda:3')
distance x is tensor(111.0515, device='cuda:3')
distance x is tensor(111.0515, device='cuda:3')
________________________________
test distance is  tensor(111.0515, device='cuda:3')
test distance1 is  tensor(111.0515, device='cuda:3')
test similarity is  tensor(0.9596, device='cuda:3')
test acc is  0.10000000015633198
test loss is 227.75600415455506
test entropy is  2.9538166910905258e-27
________________________________
0
distance x is tensor(111.0515, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.650164126465389e-28
avg test loss is  227.7939810681699
avg accuracy is  0.40845000015634114
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9596, device='cuda:3')
compute_distance is  tensor(111.0515, device='cuda:3')
compute_norm is  tensor(44.7265, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(99.0818, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7932556856161496
avg test loss is  1.328684086293808
avg accuracy is  0.8756833334896557
solo acc is  0.30580000015633957
compute similarity  is  tensor(0.9629, device='cuda:3')
compute_distance is  tensor(99.0818, device='cuda:3')
compute_norm is  tensor(43.6649, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(101.2925, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7803915669796055
avg test loss is  1.353700429645937
avg accuracy is  0.8772666668229889
solo acc is  0.252216666823005
compute similarity  is  tensor(0.9624, device='cuda:3')
compute_distance is  tensor(101.2925, device='cuda:3')
compute_norm is  tensor(43.3834, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(103.1778, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7863629837788498
avg test loss is  1.3088393114777261
avg accuracy is  0.8776666668229889
solo acc is  0.25310000015633827
compute similarity  is  tensor(0.9619, device='cuda:3')
compute_distance is  tensor(103.1778, device='cuda:3')
compute_norm is  tensor(43.1272, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(104.9810, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.782465525908765
avg test loss is  1.2805697834695071
avg accuracy is  0.8781666668229889
solo acc is  0.2529500001563383
compute similarity  is  tensor(0.9615, device='cuda:3')
compute_distance is  tensor(104.9810, device='cuda:3')
compute_norm is  tensor(42.8822, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(106.7329, device='cuda:3')
distance x is tensor(106.7329, device='cuda:3')
________________________________
test distance is  tensor(106.7329, device='cuda:3')
test distance1 is  tensor(106.7329, device='cuda:3')
test similarity is  tensor(0.9612, device='cuda:3')
test acc is  0.22305000015633727
test loss is 1.3143225112703563
test entropy is  0.7618097924728637
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.1458286046981812
mal norm is  tensor(545.2034, device='cuda:3')
distance x is tensor(106.7395, device='cuda:3')
mal distance is  tensor(106.7395, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([27., 27., 27., 27., 27., 27., 27., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 27., 27., 27., 27., 27., 27., 27.])
count_res tensor([6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 89.82% 

Test Accuracy: 89.27% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.30325600504875183
distance x is tensor(89.4557, device='cuda:3')
benign distance is  tensor(89.4557, device='cuda:3')
norm1 res is  tensor(402.3374, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6497131586074829
distance x is tensor(87.7759, device='cuda:3')
benign distance is  tensor(87.7759, device='cuda:3')
norm1 res is  tensor(389.9429, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.29503604769706726
distance x is tensor(106.4527, device='cuda:3')
benign distance is  tensor(106.4527, device='cuda:3')
norm1 res is  tensor(470.5365, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.599278450012207
distance x is tensor(80.3621, device='cuda:3')
benign distance is  tensor(80.3621, device='cuda:3')
norm1 res is  tensor(360.4462, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8054324984550476
distance x is tensor(68.3903, device='cuda:3')
benign distance is  tensor(68.3903, device='cuda:3')
norm1 res is  tensor(297.6412, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.2866925597190857
distance x is tensor(93.0896, device='cuda:3')
benign distance is  tensor(93.0896, device='cuda:3')
norm1 res is  tensor(411.2148, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5133737325668335
distance x is tensor(82.9021, device='cuda:3')
benign distance is  tensor(82.9021, device='cuda:3')
norm1 res is  tensor(358.3517, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6009005308151245
distance x is tensor(92.5699, device='cuda:3')
benign distance is  tensor(92.5699, device='cuda:3')
norm1 res is  tensor(399.8029, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.44796624779701233
distance x is tensor(111.3862, device='cuda:3')
benign distance is  tensor(111.3862, device='cuda:3')
norm1 res is  tensor(502.3626, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.16104893386363983
distance x is tensor(112.4684, device='cuda:3')
benign distance is  tensor(112.4684, device='cuda:3')
norm1 res is  tensor(502.3109, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.43115749955177307
distance x is tensor(118.9779, device='cuda:3')
benign distance is  tensor(118.9779, device='cuda:3')
norm1 res is  tensor(531.9714, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.3652782142162323
distance x is tensor(101.5525, device='cuda:3')
benign distance is  tensor(101.5525, device='cuda:3')
norm1 res is  tensor(449.8449, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6022039651870728
distance x is tensor(115.0872, device='cuda:3')
benign distance is  tensor(115.0872, device='cuda:3')
norm1 res is  tensor(513.7105, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.38199347257614136
distance x is tensor(120.7733, device='cuda:3')
benign distance is  tensor(120.7733, device='cuda:3')
norm1 res is  tensor(531.2875, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.533637285232544
distance x is tensor(99.5466, device='cuda:3')
benign distance is  tensor(99.5466, device='cuda:3')
norm1 res is  tensor(444.2629, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.08244602382183075
distance x is tensor(101.0194, device='cuda:3')
benign distance is  tensor(101.0194, device='cuda:3')
norm1 res is  tensor(446.9864, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(104.3398, device='cuda:3')
compute distance is  tensor(104.3398, device='cuda:3')
compute norm is  tensor(45.7419, device='cuda:3', dtype=torch.float64)
distance x is tensor(79.1562, device='cuda:3')
compute distance is  tensor(79.1562, device='cuda:3')
compute norm is  tensor(45.4202, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.1524, device='cuda:3')
compute distance is  tensor(102.1524, device='cuda:3')
compute norm is  tensor(45.8421, device='cuda:3', dtype=torch.float64)
distance x is tensor(97.0961, device='cuda:3')
compute distance is  tensor(97.0961, device='cuda:3')
compute norm is  tensor(45.6350, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.7835, device='cuda:3')
compute distance is  tensor(103.7835, device='cuda:3')
compute norm is  tensor(45.7803, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.9283, device='cuda:3')
compute distance is  tensor(102.9283, device='cuda:3')
compute norm is  tensor(45.9529, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.9712, device='cuda:3')
compute distance is  tensor(99.9712, device='cuda:3')
compute norm is  tensor(45.7896, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.1350, device='cuda:3')
compute distance is  tensor(100.1350, device='cuda:3')
compute norm is  tensor(45.8335, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.8050, device='cuda:3')
compute distance is  tensor(109.8050, device='cuda:3')
compute norm is  tensor(45.9703, device='cuda:3', dtype=torch.float64)
distance x is tensor(91.1772, device='cuda:3')
compute distance is  tensor(91.1772, device='cuda:3')
compute norm is  tensor(45.6109, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.4603, device='cuda:3')
compute distance is  tensor(104.4603, device='cuda:3')
compute norm is  tensor(45.9262, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.8072, device='cuda:3')
compute distance is  tensor(108.8072, device='cuda:3')
compute norm is  tensor(45.9125, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(109.8050, device='cuda:3')
distance x is tensor(106195.7500, device='cuda:3')
distance x is tensor(106195.7500, device='cuda:3')
________________________________
test distance is  tensor(106195.7500, device='cuda:3')
test distance1 is  tensor(106195.7500, device='cuda:3')
test similarity is  tensor(-0.0880, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139298548660909.58
test entropy is  0.0
________________________________
cal ratio is  0.03151254831388146
distance x is tensor(3346.5042, device='cuda:3')
cal_distance is  tensor(3346.5042, device='cuda:3')
cal ratio is  0.17751759760472202
distance x is tensor(594.0674, device='cuda:3')
cal_distance is  tensor(594.0674, device='cuda:3')
cal ratio is  0.4213269617880551
distance x is tensor(250.2995, device='cuda:3')
cal_distance is  tensor(250.2995, device='cuda:3')
cal ratio is  0.6490932608649373
distance x is tensor(162.4695, device='cuda:3')
cal_distance is  tensor(162.4695, device='cuda:3')
cal ratio is  0.8056588967637422
distance x is tensor(130.8960, device='cuda:3')
cal_distance is  tensor(130.8960, device='cuda:3')
cal ratio is  0.8975816705995453
distance x is tensor(117.4903, device='cuda:3')
cal_distance is  tensor(117.4903, device='cuda:3')
cal ratio is  0.9474058038873003
distance x is tensor(111.3113, device='cuda:3')
cal_distance is  tensor(111.3113, device='cuda:3')
cal ratio is  0.9733465085310935
distance x is tensor(108.3446, device='cuda:3')
cal_distance is  tensor(108.3446, device='cuda:3')
distance x is tensor(108.3446, device='cuda:3')
return_distance is  tensor(108.3446, device='cuda:3')
distance x is tensor(108.3347, device='cuda:3')
distance x is tensor(108.3347, device='cuda:3')
________________________________
test distance is  tensor(108.3347, device='cuda:3')
test distance1 is  tensor(108.3347, device='cuda:3')
test similarity is  tensor(0.9617, device='cuda:3')
test acc is  0.10000000015633198
test loss is 220.13410233942938
test entropy is  5.026003493318968e-29
________________________________
0
distance x is tensor(108.3347, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  3.888671031403225e-26
avg test loss is  220.15283427614648
avg accuracy is  0.49673333348967535
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9617, device='cuda:3')
compute_distance is  tensor(108.3347, device='cuda:3')
compute_norm is  tensor(44.7958, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(97.0488, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8013801725307254
avg test loss is  1.3300185393549995
avg accuracy is  0.8771000001563224
solo acc is  0.3156666668230065
compute similarity  is  tensor(0.9649, device='cuda:3')
compute_distance is  tensor(97.0488, device='cuda:3')
compute_norm is  tensor(43.6566, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(99.6011, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7986871859412203
avg test loss is  1.324169482249441
avg accuracy is  0.877866666822989
solo acc is  0.27336666682300553
compute similarity  is  tensor(0.9643, device='cuda:3')
compute_distance is  tensor(99.6011, device='cuda:3')
compute_norm is  tensor(43.3729, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(101.7174, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7671627904306343
avg test loss is  1.3597662457779272
avg accuracy is  0.8784000001563222
solo acc is  0.2362833334896711
compute similarity  is  tensor(0.9638, device='cuda:3')
compute_distance is  tensor(101.7174, device='cuda:3')
compute_norm is  tensor(43.1143, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(103.7064, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7918595296106359
avg test loss is  1.27797187092716
avg accuracy is  0.8798333334896555
solo acc is  0.2572666668230051
compute similarity  is  tensor(0.9633, device='cuda:3')
compute_distance is  tensor(103.7064, device='cuda:3')
compute_norm is  tensor(42.8697, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(105.6358, device='cuda:3')
distance x is tensor(105.6358, device='cuda:3')
________________________________
test distance is  tensor(105.6358, device='cuda:3')
test distance1 is  tensor(105.6358, device='cuda:3')
test similarity is  tensor(0.9629, device='cuda:3')
test acc is  0.23376666682300432
test loss is 1.3031037619500272
test entropy is  0.770047923839931
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.0739030838012695
mal norm is  tensor(535.5115, device='cuda:3')
distance x is tensor(105.6421, device='cuda:3')
mal distance is  tensor(105.6421, device='cuda:3')
user_PLR len size 44
counter_tensor is  tensor([43., 43., 43., 43., 43., 43., 43., 43., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 43., 43., 43., 43., 43., 43., 43., 43.,
        43., 43., 43., 43., 43., 43., 43., 43., 43., 43., 43., 43., 43., 43.,
        43., 43.])
count_res tensor([3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02, 5.2192e-07, 5.2192e-07, 5.2192e-07, 5.2192e-07,
        5.2192e-07, 5.2192e-07, 5.2192e-07, 5.2192e-07, 5.2192e-07, 5.2192e-07,
        5.2192e-07, 5.2192e-07, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 89.83% 

Test Accuracy: 89.24% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5694794654846191
distance x is tensor(68.6641, device='cuda:3')
benign distance is  tensor(68.6641, device='cuda:3')
norm1 res is  tensor(306.8771, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5390412211418152
distance x is tensor(103.6191, device='cuda:3')
benign distance is  tensor(103.6191, device='cuda:3')
norm1 res is  tensor(461.0944, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4568466246128082
distance x is tensor(98.9820, device='cuda:3')
benign distance is  tensor(98.9820, device='cuda:3')
norm1 res is  tensor(434.7292, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.380950391292572
distance x is tensor(99.2116, device='cuda:3')
benign distance is  tensor(99.2116, device='cuda:3')
norm1 res is  tensor(425.7064, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.22526684403419495
distance x is tensor(63.7073, device='cuda:3')
benign distance is  tensor(63.7073, device='cuda:3')
norm1 res is  tensor(279.5606, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.748073399066925
distance x is tensor(92.7466, device='cuda:3')
benign distance is  tensor(92.7466, device='cuda:3')
norm1 res is  tensor(416.9109, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2877682149410248
distance x is tensor(91.2071, device='cuda:3')
benign distance is  tensor(91.2071, device='cuda:3')
norm1 res is  tensor(398.4378, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5480976104736328
distance x is tensor(88.0499, device='cuda:3')
benign distance is  tensor(88.0499, device='cuda:3')
norm1 res is  tensor(396.2307, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2929597795009613
distance x is tensor(115.9681, device='cuda:3')
benign distance is  tensor(115.9681, device='cuda:3')
norm1 res is  tensor(506.2531, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.26627427339553833
distance x is tensor(109.9700, device='cuda:3')
benign distance is  tensor(109.9700, device='cuda:3')
norm1 res is  tensor(488.3873, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.46519917249679565
distance x is tensor(111.5245, device='cuda:3')
benign distance is  tensor(111.5245, device='cuda:3')
norm1 res is  tensor(490.2492, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6870576739311218
distance x is tensor(107.4553, device='cuda:3')
benign distance is  tensor(107.4553, device='cuda:3')
norm1 res is  tensor(472.7959, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.389870285987854
distance x is tensor(109.5361, device='cuda:3')
benign distance is  tensor(109.5361, device='cuda:3')
norm1 res is  tensor(490.7996, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1495334804058075
distance x is tensor(112.1679, device='cuda:3')
benign distance is  tensor(112.1679, device='cuda:3')
norm1 res is  tensor(505.4688, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2041667401790619
distance x is tensor(112.2697, device='cuda:3')
benign distance is  tensor(112.2697, device='cuda:3')
norm1 res is  tensor(510.1985, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0670512914657593
distance x is tensor(107.0480, device='cuda:3')
benign distance is  tensor(107.0480, device='cuda:3')
norm1 res is  tensor(474.0119, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.152574360370636
distance x is tensor(107.8446, device='cuda:3')
benign distance is  tensor(107.8446, device='cuda:3')
norm1 res is  tensor(472.8440, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.957104504108429
distance x is tensor(124.7929, device='cuda:3')
benign distance is  tensor(124.7929, device='cuda:3')
norm1 res is  tensor(561.2155, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.31595826148986816
distance x is tensor(102.6160, device='cuda:3')
benign distance is  tensor(102.6160, device='cuda:3')
norm1 res is  tensor(453.7093, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.17758949100971222
distance x is tensor(108.0621, device='cuda:3')
benign distance is  tensor(108.0621, device='cuda:3')
norm1 res is  tensor(484.1956, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5389320850372314
distance x is tensor(106.2261, device='cuda:3')
benign distance is  tensor(106.2261, device='cuda:3')
norm1 res is  tensor(473.1947, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.1072907447814941
distance x is tensor(102.4854, device='cuda:3')
benign distance is  tensor(102.4854, device='cuda:3')
norm1 res is  tensor(459.1366, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.47389617562294006
distance x is tensor(103.6345, device='cuda:3')
benign distance is  tensor(103.6345, device='cuda:3')
norm1 res is  tensor(467.8949, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4174349308013916
distance x is tensor(113.2499, device='cuda:3')
benign distance is  tensor(113.2499, device='cuda:3')
norm1 res is  tensor(486.0497, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.2714231312274933
distance x is tensor(102.9175, device='cuda:3')
benign distance is  tensor(102.9175, device='cuda:3')
norm1 res is  tensor(473.6064, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.7604138255119324
distance x is tensor(110.2340, device='cuda:3')
benign distance is  tensor(110.2340, device='cuda:3')
norm1 res is  tensor(483.7970, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.045820850878953934
distance x is tensor(103.0655, device='cuda:3')
benign distance is  tensor(103.0655, device='cuda:3')
norm1 res is  tensor(460.1567, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.2403428554534912
distance x is tensor(102.8445, device='cuda:3')
benign distance is  tensor(102.8445, device='cuda:3')
norm1 res is  tensor(454.1652, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5020907521247864
distance x is tensor(106.2912, device='cuda:3')
benign distance is  tensor(106.2912, device='cuda:3')
norm1 res is  tensor(482.1307, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.3569232225418091
distance x is tensor(113.5975, device='cuda:3')
benign distance is  tensor(113.5975, device='cuda:3')
norm1 res is  tensor(509.2258, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.2532507181167603
distance x is tensor(118.7403, device='cuda:3')
benign distance is  tensor(118.7403, device='cuda:3')
norm1 res is  tensor(525.7544, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.17845073342323303
distance x is tensor(115.7719, device='cuda:3')
benign distance is  tensor(115.7719, device='cuda:3')
norm1 res is  tensor(516.1683, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(88.4801, device='cuda:3')
compute distance is  tensor(88.4801, device='cuda:3')
compute norm is  tensor(45.6696, device='cuda:3', dtype=torch.float64)
distance x is tensor(88.1224, device='cuda:3')
compute distance is  tensor(88.1224, device='cuda:3')
compute norm is  tensor(45.6130, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.8313, device='cuda:3')
compute distance is  tensor(103.8313, device='cuda:3')
compute norm is  tensor(46.0102, device='cuda:3', dtype=torch.float64)
distance x is tensor(90.9761, device='cuda:3')
compute distance is  tensor(90.9761, device='cuda:3')
compute norm is  tensor(45.6868, device='cuda:3', dtype=torch.float64)
distance x is tensor(91.9522, device='cuda:3')
compute distance is  tensor(91.9522, device='cuda:3')
compute norm is  tensor(45.6802, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.1913, device='cuda:3')
compute distance is  tensor(112.1913, device='cuda:3')
compute norm is  tensor(46.1522, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.4782, device='cuda:3')
compute distance is  tensor(95.4782, device='cuda:3')
compute norm is  tensor(45.8577, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.6190, device='cuda:3')
compute distance is  tensor(104.6190, device='cuda:3')
compute norm is  tensor(46.0013, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.9894, device='cuda:3')
compute distance is  tensor(98.9894, device='cuda:3')
compute norm is  tensor(45.8123, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.6568, device='cuda:3')
compute distance is  tensor(95.6568, device='cuda:3')
compute norm is  tensor(45.8730, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.0419, device='cuda:3')
compute distance is  tensor(105.0419, device='cuda:3')
compute norm is  tensor(45.9967, device='cuda:3', dtype=torch.float64)
distance x is tensor(89.7851, device='cuda:3')
compute distance is  tensor(89.7851, device='cuda:3')
compute norm is  tensor(45.7316, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(112.1913, device='cuda:3')
distance x is tensor(106195.4844, device='cuda:3')
distance x is tensor(106195.4844, device='cuda:3')
________________________________
test distance is  tensor(106195.4844, device='cuda:3')
test distance1 is  tensor(106195.4844, device='cuda:3')
test similarity is  tensor(-0.0856, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139276296778190.88
test entropy is  0.0
________________________________
cal ratio is  0.03185317249167078
distance x is tensor(3382.6682, device='cuda:3')
cal_distance is  tensor(3382.6682, device='cuda:3')
cal ratio is  0.178474441009757
distance x is tensor(603.7239, device='cuda:3')
cal_distance is  tensor(603.7239, device='cuda:3')
cal ratio is  0.42246092471027047
distance x is tensor(255.0527, device='cuda:3')
cal_distance is  tensor(255.0527, device='cuda:3')
cal ratio is  0.6499662075061775
distance x is tensor(165.7774, device='cuda:3')
cal_distance is  tensor(165.7774, device='cuda:3')
cal ratio is  0.8062005631423342
distance x is tensor(133.6508, device='cuda:3')
cal_distance is  tensor(133.6508, device='cuda:3')
cal ratio is  0.8978834404886544
distance x is tensor(120.0033, device='cuda:3')
cal_distance is  tensor(120.0033, device='cuda:3')
cal ratio is  0.9475651539215046
distance x is tensor(113.7113, device='cuda:3')
cal_distance is  tensor(113.7113, device='cuda:3')
cal ratio is  0.9734284005757772
distance x is tensor(110.6899, device='cuda:3')
cal_distance is  tensor(110.6899, device='cuda:3')
distance x is tensor(110.6899, device='cuda:3')
return_distance is  tensor(110.6899, device='cuda:3')
distance x is tensor(110.6800, device='cuda:3')
distance x is tensor(110.6800, device='cuda:3')
________________________________
test distance is  tensor(110.6800, device='cuda:3')
test distance1 is  tensor(110.6800, device='cuda:3')
test similarity is  tensor(0.9602, device='cuda:3')
test acc is  0.10000000015633198
test loss is 231.05509024744094
test entropy is  4.441309731110927e-27
________________________________
0
distance x is tensor(110.6800, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  7.890908960449215e-29
avg test loss is  231.07531648810738
avg accuracy is  0.42965000015634147
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9602, device='cuda:3')
compute_distance is  tensor(110.6800, device='cuda:3')
compute_norm is  tensor(44.9150, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(98.5598, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8307175614050964
avg test loss is  1.2562995544120448
avg accuracy is  0.8740000001563224
solo acc is  0.34861666682300707
compute similarity  is  tensor(0.9636, device='cuda:3')
compute_distance is  tensor(98.5598, device='cuda:3')
compute_norm is  tensor(43.7996, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(101.0103, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8002479522467167
avg test loss is  1.3121066057224517
avg accuracy is  0.8742833334896558
solo acc is  0.2778333334896723
compute similarity  is  tensor(0.9630, device='cuda:3')
compute_distance is  tensor(101.0103, device='cuda:3')
compute_norm is  tensor(43.5181, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(103.1166, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7736213646972103
avg test loss is  1.3390780314961985
avg accuracy is  0.876266666822989
solo acc is  0.24476666682300469
compute similarity  is  tensor(0.9625, device='cuda:3')
compute_distance is  tensor(103.1166, device='cuda:3')
compute_norm is  tensor(43.2598, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(105.0930, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7715335112772008
avg test loss is  1.3176443931390482
avg accuracy is  0.8777833334896555
solo acc is  0.23868333348967113
compute similarity  is  tensor(0.9620, device='cuda:3')
compute_distance is  tensor(105.0930, device='cuda:3')
compute_norm is  tensor(43.0156, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(106.9623, device='cuda:3')
distance x is tensor(106.9623, device='cuda:3')
________________________________
test distance is  tensor(106.9623, device='cuda:3')
test distance1 is  tensor(106.9623, device='cuda:3')
test similarity is  tensor(0.9616, device='cuda:3')
test acc is  0.2460833334896714
test loss is 1.272156780081263
test entropy is  0.7782805121656674
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.1920201778411865
mal norm is  tensor(545.2802, device='cuda:3')
distance x is tensor(106.9688, device='cuda:3')
mal distance is  tensor(106.9688, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([19., 19., 19., 19., 19., 19., 19., 19., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0669,
        0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669,
        0.0669, 0.0669])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 77.38% 

Test Accuracy: 76.18% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5867312550544739
distance x is tensor(132.2923, device='cuda:3')
benign distance is  tensor(132.2923, device='cuda:3')
norm1 res is  tensor(548.3602, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.46805277466773987
distance x is tensor(129.2702, device='cuda:3')
benign distance is  tensor(129.2702, device='cuda:3')
norm1 res is  tensor(528.4797, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.12845221161842346
distance x is tensor(131.1819, device='cuda:3')
benign distance is  tensor(131.1819, device='cuda:3')
norm1 res is  tensor(527.9625, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.746878445148468
distance x is tensor(122.0569, device='cuda:3')
benign distance is  tensor(122.0569, device='cuda:3')
norm1 res is  tensor(484.9149, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4422460198402405
distance x is tensor(128.8928, device='cuda:3')
benign distance is  tensor(128.8928, device='cuda:3')
norm1 res is  tensor(510.1758, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6034203171730042
distance x is tensor(127.2178, device='cuda:3')
benign distance is  tensor(127.2178, device='cuda:3')
norm1 res is  tensor(519.1903, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.22167053818702698
distance x is tensor(129.6637, device='cuda:3')
benign distance is  tensor(129.6637, device='cuda:3')
norm1 res is  tensor(514.8867, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3298736810684204
distance x is tensor(122.9480, device='cuda:3')
benign distance is  tensor(122.9480, device='cuda:3')
norm1 res is  tensor(499.5720, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(134.6217, device='cuda:3')
compute distance is  tensor(134.6217, device='cuda:3')
compute norm is  tensor(44.7584, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.6552, device='cuda:3')
compute distance is  tensor(114.6552, device='cuda:3')
compute norm is  tensor(44.4382, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.9426, device='cuda:3')
compute distance is  tensor(142.9426, device='cuda:3')
compute norm is  tensor(45.0721, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.0464, device='cuda:3')
compute distance is  tensor(131.0464, device='cuda:3')
compute norm is  tensor(44.8617, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.7062, device='cuda:3')
compute distance is  tensor(143.7062, device='cuda:3')
compute norm is  tensor(44.9250, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.0856, device='cuda:3')
compute distance is  tensor(120.0856, device='cuda:3')
compute norm is  tensor(44.7090, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.4944, device='cuda:3')
compute distance is  tensor(136.4944, device='cuda:3')
compute norm is  tensor(44.8779, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.8588, device='cuda:3')
compute distance is  tensor(128.8588, device='cuda:3')
compute norm is  tensor(44.8482, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.4578, device='cuda:3')
compute distance is  tensor(133.4578, device='cuda:3')
compute norm is  tensor(44.7710, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.9904, device='cuda:3')
compute distance is  tensor(140.9904, device='cuda:3')
compute norm is  tensor(45.1451, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.0586, device='cuda:3')
compute distance is  tensor(132.0586, device='cuda:3')
compute norm is  tensor(44.9448, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.6474, device='cuda:3')
compute distance is  tensor(136.6474, device='cuda:3')
compute norm is  tensor(44.9246, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(143.7062, device='cuda:3')
distance x is tensor(106144.7500, device='cuda:3')
distance x is tensor(106144.7500, device='cuda:3')
________________________________
test distance is  tensor(106144.7500, device='cuda:3')
test distance1 is  tensor(106144.7500, device='cuda:3')
test similarity is  tensor(0.1041, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139278324487183.28
test entropy is  0.0
________________________________
cal ratio is  0.03605907652729264
distance x is tensor(3827.4875, device='cuda:3')
cal_distance is  tensor(3827.4875, device='cuda:3')
cal ratio is  0.189892133324304
distance x is tensor(726.8138, device='cuda:3')
cal_distance is  tensor(726.8138, device='cuda:3')
cal ratio is  0.4357649377537533
distance x is tensor(316.7228, device='cuda:3')
cal_distance is  tensor(316.7228, device='cuda:3')
cal ratio is  0.660122017147763
distance x is tensor(209.0774, device='cuda:3')
cal_distance is  tensor(209.0774, device='cuda:3')
cal ratio is  0.812475602722672
distance x is tensor(169.8712, device='cuda:3')
cal_distance is  tensor(169.8712, device='cuda:3')
cal ratio is  0.9013717932024463
distance x is tensor(153.1176, device='cuda:3')
cal_distance is  tensor(153.1176, device='cuda:3')
cal ratio is  0.9494044545434379
distance x is tensor(145.3708, device='cuda:3')
cal_distance is  tensor(145.3708, device='cuda:3')
cal ratio is  0.9743729690814431
distance x is tensor(141.6455, device='cuda:3')
cal_distance is  tensor(141.6455, device='cuda:3')
distance x is tensor(141.6455, device='cuda:3')
return_distance is  tensor(141.6455, device='cuda:3')
distance x is tensor(141.6356, device='cuda:3')
distance x is tensor(141.6356, device='cuda:3')
________________________________
test distance is  tensor(141.6356, device='cuda:3')
test distance1 is  tensor(141.6356, device='cuda:3')
test similarity is  tensor(0.9407, device='cuda:3')
test acc is  0.10000000015633198
test loss is 630.5220388318938
test entropy is  0.0
________________________________
0
distance x is tensor(141.6356, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  630.5602017465685
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9407, device='cuda:3')
compute_distance is  tensor(141.6356, device='cuda:3')
compute_norm is  tensor(45.7874, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(151.7946, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.4737534782271395
avg test loss is  2.531696338897575
avg accuracy is  0.24856666682300482
solo acc is  0.12236666682299857
compute similarity  is  tensor(0.9336, device='cuda:3')
compute_distance is  tensor(151.7946, device='cuda:3')
compute_norm is  tensor(46.5976, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(153.2306, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7613104478890962
avg test loss is  3.1684580629568364
avg accuracy is  0.1655000001563344
solo acc is  0.1009333334896653
compute similarity  is  tensor(0.9328, device='cuda:3')
compute_distance is  tensor(153.2306, device='cuda:3')
compute_norm is  tensor(46.6800, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(156.2241, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0843345821539223
avg test loss is  1.8149595442357094
avg accuracy is  0.24038333348967128
solo acc is  0.20846666682300344
compute similarity  is  tensor(0.9339, device='cuda:3')
compute_distance is  tensor(156.2241, device='cuda:3')
compute_norm is  tensor(46.2283, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(157.1868, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6261283745135325
avg test loss is  2.5722687310501455
avg accuracy is  0.1738166668230016
solo acc is  0.10210000015633197
compute similarity  is  tensor(0.9336, device='cuda:3')
compute_distance is  tensor(157.1868, device='cuda:3')
compute_norm is  tensor(46.0840, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(158.7659, device='cuda:3')
distance x is tensor(158.7659, device='cuda:3')
________________________________
test distance is  tensor(158.7659, device='cuda:3')
test distance1 is  tensor(158.7659, device='cuda:3')
test similarity is  tensor(0.9339, device='cuda:3')
test acc is  0.24555000015633807
test loss is 1.6111114796544952
test entropy is  0.9555751748684881
________________________________
cal ratio is  0.9323633824233384
distance x is tensor(148.0337, device='cuda:3')
cal_distance is  tensor(148.0337, device='cuda:3')
cal ratio is  0.9655696268963745
distance x is tensor(142.9370, device='cuda:3')
cal_distance is  tensor(142.9370, device='cuda:3')
distance x is tensor(142.9370, device='cuda:3')
return_distance is  tensor(142.9370, device='cuda:3')
distance x is tensor(142.9306, device='cuda:3')
distance x is tensor(142.9306, device='cuda:3')
________________________________
test distance is  tensor(142.9306, device='cuda:3')
test distance1 is  tensor(142.9306, device='cuda:3')
test similarity is  tensor(0.9453, device='cuda:3')
test acc is  0.14065000015633233
test loss is 1.7218608477476562
test entropy is  1.0832717181650051
________________________________
0
distance x is tensor(142.9306, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0829394982059373
avg test loss is  1.7229836780125145
avg accuracy is  0.340916666823007
solo acc is  0.14031666682299895
compute similarity  is  tensor(0.9453, device='cuda:3')
compute_distance is  tensor(142.9306, device='cuda:3')
compute_norm is  tensor(45.2174, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(144.0764, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.5993205292392642
avg test loss is  2.3835127976403307
avg accuracy is  0.23853333348967126
solo acc is  0.10220000015633197
compute similarity  is  tensor(0.9448, device='cuda:3')
compute_distance is  tensor(144.0764, device='cuda:3')
compute_norm is  tensor(45.0769, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(144.9024, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9074212115710732
avg test loss is  1.4722819156738232
avg accuracy is  0.3694166668230074
solo acc is  0.2675333334896721
compute similarity  is  tensor(0.9447, device='cuda:3')
compute_distance is  tensor(144.9024, device='cuda:3')
compute_norm is  tensor(44.8170, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(144.9024, device='cuda:3')
distance x is tensor(144.9024, device='cuda:3')
________________________________
test distance is  tensor(144.9024, device='cuda:3')
test distance1 is  tensor(144.9024, device='cuda:3')
test similarity is  tensor(0.9447, device='cuda:3')
test acc is  0.2685000001563388
test loss is 1.4717652557501153
test entropy is  0.9057840438031438
________________________________
cal ratio is  0.9759465772149848
distance x is tensor(141.4232, device='cuda:3')
cal_distance is  tensor(141.4232, device='cuda:3')
distance x is tensor(141.4232, device='cuda:3')
return_distance is  tensor(141.4232, device='cuda:3')
distance x is tensor(141.4169, device='cuda:3')
distance x is tensor(141.4169, device='cuda:3')
________________________________
test distance is  tensor(141.4169, device='cuda:3')
test distance1 is  tensor(141.4169, device='cuda:3')
test similarity is  tensor(0.9472, device='cuda:3')
test acc is  0.23161666682300436
test loss is 1.4940274298063982
test entropy is  0.9339354824918166
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.3852049112319946
mal norm is  tensor(650.6848, device='cuda:3')
distance x is tensor(141.4232, device='cuda:3')
mal distance is  tensor(141.4232, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([35., 35., 35., 35., 35., 35., 35., 35., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 35., 35., 35., 35., 35., 35., 35., 35.,
        35., 35., 35., 35., 35., 35., 35., 35.])
count_res tensor([4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07,
        6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07,
        6.9590e-07, 6.9590e-07, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 90.17% 

Test Accuracy: 89.19% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.25877484679222107
distance x is tensor(84.9225, device='cuda:3')
benign distance is  tensor(84.9225, device='cuda:3')
norm1 res is  tensor(378.1270, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8483555912971497
distance x is tensor(116.0461, device='cuda:3')
benign distance is  tensor(116.0461, device='cuda:3')
norm1 res is  tensor(500.6642, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.10334882885217667
distance x is tensor(91.4413, device='cuda:3')
benign distance is  tensor(91.4413, device='cuda:3')
norm1 res is  tensor(396.8276, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5844073295593262
distance x is tensor(91.1964, device='cuda:3')
benign distance is  tensor(91.1964, device='cuda:3')
norm1 res is  tensor(398.9816, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6574469804763794
distance x is tensor(80.5980, device='cuda:3')
benign distance is  tensor(80.5980, device='cuda:3')
norm1 res is  tensor(338.1652, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8958386182785034
distance x is tensor(92.2457, device='cuda:3')
benign distance is  tensor(92.2457, device='cuda:3')
norm1 res is  tensor(394.9865, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.12238912284374237
distance x is tensor(84.6879, device='cuda:3')
benign distance is  tensor(84.6879, device='cuda:3')
norm1 res is  tensor(362.8807, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1796882152557373
distance x is tensor(84.2015, device='cuda:3')
benign distance is  tensor(84.2015, device='cuda:3')
norm1 res is  tensor(370.0268, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.24259349703788757
distance x is tensor(111.7605, device='cuda:3')
benign distance is  tensor(111.7605, device='cuda:3')
norm1 res is  tensor(494.0217, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4593362808227539
distance x is tensor(111.4483, device='cuda:3')
benign distance is  tensor(111.4483, device='cuda:3')
norm1 res is  tensor(482.0676, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7600964903831482
distance x is tensor(108.8007, device='cuda:3')
benign distance is  tensor(108.8007, device='cuda:3')
norm1 res is  tensor(461.1555, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7697244882583618
distance x is tensor(109.2040, device='cuda:3')
benign distance is  tensor(109.2040, device='cuda:3')
norm1 res is  tensor(477.6557, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3271827697753906
distance x is tensor(104.0313, device='cuda:3')
benign distance is  tensor(104.0313, device='cuda:3')
norm1 res is  tensor(461.3398, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.28220438957214355
distance x is tensor(116.7377, device='cuda:3')
benign distance is  tensor(116.7377, device='cuda:3')
norm1 res is  tensor(506.2282, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.07418902218341827
distance x is tensor(109.4582, device='cuda:3')
benign distance is  tensor(109.4582, device='cuda:3')
norm1 res is  tensor(483.8966, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.617644727230072
distance x is tensor(115.1286, device='cuda:3')
benign distance is  tensor(115.1286, device='cuda:3')
norm1 res is  tensor(515.3425, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3076501786708832
distance x is tensor(109.8351, device='cuda:3')
benign distance is  tensor(109.8351, device='cuda:3')
norm1 res is  tensor(474.0055, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6522436141967773
distance x is tensor(105.2308, device='cuda:3')
benign distance is  tensor(105.2308, device='cuda:3')
norm1 res is  tensor(437.9984, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.23063406348228455
distance x is tensor(110.0672, device='cuda:3')
benign distance is  tensor(110.0672, device='cuda:3')
norm1 res is  tensor(481.3105, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.16200557351112366
distance x is tensor(118.3743, device='cuda:3')
benign distance is  tensor(118.3743, device='cuda:3')
norm1 res is  tensor(507.8995, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.280938744544983
distance x is tensor(109.7901, device='cuda:3')
benign distance is  tensor(109.7901, device='cuda:3')
norm1 res is  tensor(473.1519, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6643304824829102
distance x is tensor(110.7040, device='cuda:3')
benign distance is  tensor(110.7040, device='cuda:3')
norm1 res is  tensor(493.4422, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.18372058868408203
distance x is tensor(110.9594, device='cuda:3')
benign distance is  tensor(110.9594, device='cuda:3')
norm1 res is  tensor(485.3130, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.22361385822296143
distance x is tensor(115.4192, device='cuda:3')
benign distance is  tensor(115.4192, device='cuda:3')
norm1 res is  tensor(514.8350, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(98.1103, device='cuda:3')
compute distance is  tensor(98.1103, device='cuda:3')
compute norm is  tensor(45.5333, device='cuda:3', dtype=torch.float64)
distance x is tensor(89.5707, device='cuda:3')
compute distance is  tensor(89.5707, device='cuda:3')
compute norm is  tensor(45.4208, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.0916, device='cuda:3')
compute distance is  tensor(107.0916, device='cuda:3')
compute norm is  tensor(45.9065, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.7440, device='cuda:3')
compute distance is  tensor(105.7440, device='cuda:3')
compute norm is  tensor(45.7446, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.2572, device='cuda:3')
compute distance is  tensor(105.2572, device='cuda:3')
compute norm is  tensor(45.7658, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.7553, device='cuda:3')
compute distance is  tensor(104.7553, device='cuda:3')
compute norm is  tensor(45.8056, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.7995, device='cuda:3')
compute distance is  tensor(98.7995, device='cuda:3')
compute norm is  tensor(45.6721, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.8247, device='cuda:3')
compute distance is  tensor(99.8247, device='cuda:3')
compute norm is  tensor(45.6517, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.3098, device='cuda:3')
compute distance is  tensor(114.3098, device='cuda:3')
compute norm is  tensor(45.7690, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.7442, device='cuda:3')
compute distance is  tensor(103.7442, device='cuda:3')
compute norm is  tensor(45.8152, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.2956, device='cuda:3')
compute distance is  tensor(103.2956, device='cuda:3')
compute norm is  tensor(45.7685, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.6450, device='cuda:3')
compute distance is  tensor(101.6450, device='cuda:3')
compute norm is  tensor(45.6263, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(114.3098, device='cuda:3')
distance x is tensor(106184.9375, device='cuda:3')
distance x is tensor(106184.9375, device='cuda:3')
________________________________
test distance is  tensor(106184.9375, device='cuda:3')
test distance1 is  tensor(106184.9375, device='cuda:3')
test similarity is  tensor(-0.0346, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139291408301031.98
test entropy is  0.0
________________________________
cal ratio is  0.03215410584016659
distance x is tensor(3414.2871, device='cuda:3')
cal_distance is  tensor(3414.2871, device='cuda:3')
cal ratio is  0.1793155202582987
distance x is tensor(612.2387, device='cuda:3')
cal_distance is  tensor(612.2387, device='cuda:3')
cal ratio is  0.4234552369854548
distance x is tensor(259.2586, device='cuda:3')
cal_distance is  tensor(259.2586, device='cuda:3')
cal ratio is  0.6507307576057824
distance x is tensor(168.7093, device='cuda:3')
cal_distance is  tensor(168.7093, device='cuda:3')
cal ratio is  0.8066746663814774
distance x is tensor(136.0945, device='cuda:3')
cal_distance is  tensor(136.0945, device='cuda:3')
cal ratio is  0.8981475374238479
distance x is tensor(122.2334, device='cuda:3')
cal_distance is  tensor(122.2334, device='cuda:3')
cal ratio is  0.9477044537416554
distance x is tensor(115.8414, device='cuda:3')
cal_distance is  tensor(115.8414, device='cuda:3')
cal ratio is  0.9735000541390167
distance x is tensor(112.7718, device='cuda:3')
cal_distance is  tensor(112.7718, device='cuda:3')
distance x is tensor(112.7718, device='cuda:3')
return_distance is  tensor(112.7718, device='cuda:3')
distance x is tensor(112.7619, device='cuda:3')
distance x is tensor(112.7619, device='cuda:3')
________________________________
test distance is  tensor(112.7619, device='cuda:3')
test distance1 is  tensor(112.7619, device='cuda:3')
test similarity is  tensor(0.9593, device='cuda:3')
test acc is  0.10000000015633198
test loss is 211.34237449662263
test entropy is  4.827366526602308e-25
________________________________
0
distance x is tensor(112.7619, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.224928209205185e-25
avg test loss is  211.32180449398342
avg accuracy is  0.3401500001563402
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9593, device='cuda:3')
compute_distance is  tensor(112.7619, device='cuda:3')
compute_norm is  tensor(45.1972, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(100.2913, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7429750121351498
avg test loss is  1.4323737536157881
avg accuracy is  0.8772166668229889
solo acc is  0.2611166668230053
compute similarity  is  tensor(0.9623, device='cuda:3')
compute_distance is  tensor(100.2913, device='cuda:3')
compute_norm is  tensor(44.2990, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(102.1578, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7743534255129442
avg test loss is  1.3444053075079725
avg accuracy is  0.8807833334896554
solo acc is  0.2554833334896717
compute similarity  is  tensor(0.9618, device='cuda:3')
compute_distance is  tensor(102.1578, device='cuda:3')
compute_norm is  tensor(44.0158, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(103.9389, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7697105358150214
avg test loss is  1.3250792632733326
avg accuracy is  0.881800000156322
solo acc is  0.24016666682300455
compute similarity  is  tensor(0.9614, device='cuda:3')
compute_distance is  tensor(103.9389, device='cuda:3')
compute_norm is  tensor(43.7562, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(105.6314, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7739330793875875
avg test loss is  1.2766400012634456
avg accuracy is  0.8818333334896553
solo acc is  0.25228333348967164
compute similarity  is  tensor(0.9610, device='cuda:3')
compute_distance is  tensor(105.6314, device='cuda:3')
compute_norm is  tensor(43.5089, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(107.2594, device='cuda:3')
distance x is tensor(107.2594, device='cuda:3')
________________________________
test distance is  tensor(107.2594, device='cuda:3')
test distance1 is  tensor(107.2594, device='cuda:3')
test similarity is  tensor(0.9607, device='cuda:3')
test acc is  0.25031666682300485
test loss is 1.2489162706362922
test entropy is  0.7803884714142855
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.0471172332763672
mal norm is  tensor(551.3611, device='cuda:3')
distance x is tensor(107.2666, device='cuda:3')
mal distance is  tensor(107.2666, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([27., 27., 27., 27., 27., 27., 27., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 27., 27., 27., 27., 27., 27., 27.])
count_res tensor([6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 90.22% 

Test Accuracy: 89.42% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.45159921050071716
distance x is tensor(79.6867, device='cuda:3')
benign distance is  tensor(79.6867, device='cuda:3')
norm1 res is  tensor(363.1769, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.33748048543930054
distance x is tensor(102.7466, device='cuda:3')
benign distance is  tensor(102.7466, device='cuda:3')
norm1 res is  tensor(461.3270, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.11257048696279526
distance x is tensor(98.3841, device='cuda:3')
benign distance is  tensor(98.3841, device='cuda:3')
norm1 res is  tensor(423.8193, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3647170066833496
distance x is tensor(83.2533, device='cuda:3')
benign distance is  tensor(83.2533, device='cuda:3')
norm1 res is  tensor(365.6298, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.11850905418395996
distance x is tensor(71.3690, device='cuda:3')
benign distance is  tensor(71.3690, device='cuda:3')
norm1 res is  tensor(315.8583, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.619060754776001
distance x is tensor(88.0447, device='cuda:3')
benign distance is  tensor(88.0447, device='cuda:3')
norm1 res is  tensor(386.2472, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.059833694249391556
distance x is tensor(89.0370, device='cuda:3')
benign distance is  tensor(89.0370, device='cuda:3')
norm1 res is  tensor(388.0431, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.11975058168172836
distance x is tensor(91.1138, device='cuda:3')
benign distance is  tensor(91.1138, device='cuda:3')
norm1 res is  tensor(404.4477, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.37273773550987244
distance x is tensor(120.1107, device='cuda:3')
benign distance is  tensor(120.1107, device='cuda:3')
norm1 res is  tensor(527.5419, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6391191482543945
distance x is tensor(119.7660, device='cuda:3')
benign distance is  tensor(119.7660, device='cuda:3')
norm1 res is  tensor(526.7278, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3167394995689392
distance x is tensor(100.3230, device='cuda:3')
benign distance is  tensor(100.3230, device='cuda:3')
norm1 res is  tensor(447.7067, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.25116127729415894
distance x is tensor(107.3191, device='cuda:3')
benign distance is  tensor(107.3191, device='cuda:3')
norm1 res is  tensor(477.0008, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.2644580602645874
distance x is tensor(113.3506, device='cuda:3')
benign distance is  tensor(113.3506, device='cuda:3')
norm1 res is  tensor(499.9572, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7818366289138794
distance x is tensor(98.2207, device='cuda:3')
benign distance is  tensor(98.2207, device='cuda:3')
norm1 res is  tensor(441.5629, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.26598042249679565
distance x is tensor(109.0625, device='cuda:3')
benign distance is  tensor(109.0625, device='cuda:3')
norm1 res is  tensor(492.7520, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.387042373418808
distance x is tensor(117.1514, device='cuda:3')
benign distance is  tensor(117.1514, device='cuda:3')
norm1 res is  tensor(524.5256, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(97.2700, device='cuda:3')
compute distance is  tensor(97.2700, device='cuda:3')
compute norm is  tensor(46.0039, device='cuda:3', dtype=torch.float64)
distance x is tensor(89.7062, device='cuda:3')
compute distance is  tensor(89.7062, device='cuda:3')
compute norm is  tensor(45.8888, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.3974, device='cuda:3')
compute distance is  tensor(101.3974, device='cuda:3')
compute norm is  tensor(46.1999, device='cuda:3', dtype=torch.float64)
distance x is tensor(93.1247, device='cuda:3')
compute distance is  tensor(93.1247, device='cuda:3')
compute norm is  tensor(45.9679, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.8494, device='cuda:3')
compute distance is  tensor(101.8494, device='cuda:3')
compute norm is  tensor(46.1348, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.0576, device='cuda:3')
compute distance is  tensor(104.0576, device='cuda:3')
compute norm is  tensor(46.3322, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.6929, device='cuda:3')
compute distance is  tensor(99.6929, device='cuda:3')
compute norm is  tensor(46.1539, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.9996, device='cuda:3')
compute distance is  tensor(111.9996, device='cuda:3')
compute norm is  tensor(46.3755, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.8679, device='cuda:3')
compute distance is  tensor(110.8679, device='cuda:3')
compute norm is  tensor(46.3687, device='cuda:3', dtype=torch.float64)
distance x is tensor(90.5501, device='cuda:3')
compute distance is  tensor(90.5501, device='cuda:3')
compute norm is  tensor(46.0593, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.1077, device='cuda:3')
compute distance is  tensor(108.1077, device='cuda:3')
compute norm is  tensor(46.3569, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.0123, device='cuda:3')
compute distance is  tensor(98.0123, device='cuda:3')
compute norm is  tensor(46.0621, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(111.9996, device='cuda:3')
distance x is tensor(106191.3203, device='cuda:3')
distance x is tensor(106191.3203, device='cuda:3')
________________________________
test distance is  tensor(106191.3203, device='cuda:3')
test distance1 is  tensor(106191.3203, device='cuda:3')
test similarity is  tensor(-0.0626, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139273165466434.05
test entropy is  0.0
________________________________
cal ratio is  0.03182656595747537
distance x is tensor(3379.7104, device='cuda:3')
cal_distance is  tensor(3379.7104, device='cuda:3')
cal ratio is  0.17839987289623044
distance x is tensor(602.9440, device='cuda:3')
cal_distance is  tensor(602.9440, device='cuda:3')
cal ratio is  0.42237265287200415
distance x is tensor(254.6699, device='cuda:3')
cal_distance is  tensor(254.6699, device='cuda:3')
cal ratio is  0.649898365942334
distance x is tensor(165.5113, device='cuda:3')
cal_distance is  tensor(165.5113, device='cuda:3')
cal ratio is  0.8061584915601391
distance x is tensor(133.4293, device='cuda:3')
cal_distance is  tensor(133.4293, device='cuda:3')
cal ratio is  0.8978600422041982
distance x is tensor(119.8014, device='cuda:3')
cal_distance is  tensor(119.8014, device='cuda:3')
cal ratio is  0.9475526485561295
distance x is tensor(113.5184, device='cuda:3')
cal_distance is  tensor(113.5184, device='cuda:3')
cal ratio is  0.9734220200068586
distance x is tensor(110.5014, device='cuda:3')
cal_distance is  tensor(110.5014, device='cuda:3')
distance x is tensor(110.5014, device='cuda:3')
return_distance is  tensor(110.5014, device='cuda:3')
distance x is tensor(110.4915, device='cuda:3')
distance x is tensor(110.4915, device='cuda:3')
________________________________
test distance is  tensor(110.4915, device='cuda:3')
test distance1 is  tensor(110.4915, device='cuda:3')
test similarity is  tensor(0.9613, device='cuda:3')
test acc is  0.10000000015633198
test loss is 220.00707654810662
test entropy is  7.573316068328437e-27
________________________________
0
distance x is tensor(110.4915, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  5.343038335611176e-27
avg test loss is  220.0155974593498
avg accuracy is  0.41081666682300794
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9613, device='cuda:3')
compute_distance is  tensor(110.4915, device='cuda:3')
compute_norm is  tensor(45.4370, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(98.4987, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8098930391802717
avg test loss is  1.257318430872106
avg accuracy is  0.8766833334896555
solo acc is  0.3523666668230071
compute similarity  is  tensor(0.9641, device='cuda:3')
compute_distance is  tensor(98.4987, device='cuda:3')
compute_norm is  tensor(44.4086, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(100.6567, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.784766891490676
avg test loss is  1.3214504390255983
avg accuracy is  0.8787500001563222
solo acc is  0.2722166668230055
compute similarity  is  tensor(0.9636, device='cuda:3')
compute_distance is  tensor(100.6567, device='cuda:3')
compute_norm is  tensor(44.1209, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(102.6103, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7803832831413253
avg test loss is  1.2941878801469864
avg accuracy is  0.8794666668229889
solo acc is  0.2634833334896719
compute similarity  is  tensor(0.9631, device='cuda:3')
compute_distance is  tensor(102.6103, device='cuda:3')
compute_norm is  tensor(43.8582, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(104.5165, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.764007945558918
avg test loss is  1.3105243882263646
avg accuracy is  0.8806500001563221
solo acc is  0.2369500001563378
compute similarity  is  tensor(0.9627, device='cuda:3')
compute_distance is  tensor(104.5165, device='cuda:3')
compute_norm is  tensor(43.6086, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(106.3469, device='cuda:3')
distance x is tensor(106.3469, device='cuda:3')
________________________________
test distance is  tensor(106.3469, device='cuda:3')
test distance1 is  tensor(106.3469, device='cuda:3')
test similarity is  tensor(0.9623, device='cuda:3')
test acc is  0.23871666682300446
test loss is 1.2817711051084848
test entropy is  0.7658011678820734
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.1531046628952026
mal norm is  tensor(544.5687, device='cuda:3')
distance x is tensor(106.3536, device='cuda:3')
mal distance is  tensor(106.3536, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([35., 35., 35., 35., 35., 35., 35., 35., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 35., 35., 35., 35., 35., 35., 35., 35.,
        35., 35., 35., 35., 35., 35., 35., 35.])
count_res tensor([4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07,
        6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07,
        6.9590e-07, 6.9590e-07, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 90.08% 

Test Accuracy: 89.34% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1013845205307007
distance x is tensor(72.7935, device='cuda:3')
benign distance is  tensor(72.7935, device='cuda:3')
norm1 res is  tensor(326.0692, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6112880706787109
distance x is tensor(91.1155, device='cuda:3')
benign distance is  tensor(91.1155, device='cuda:3')
norm1 res is  tensor(403.1865, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.17169804871082306
distance x is tensor(98.3443, device='cuda:3')
benign distance is  tensor(98.3443, device='cuda:3')
norm1 res is  tensor(434.1835, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7864915728569031
distance x is tensor(90.8704, device='cuda:3')
benign distance is  tensor(90.8704, device='cuda:3')
norm1 res is  tensor(399.4175, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.1499524861574173
distance x is tensor(97.1422, device='cuda:3')
benign distance is  tensor(97.1422, device='cuda:3')
norm1 res is  tensor(424.3033, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8532983064651489
distance x is tensor(95.4290, device='cuda:3')
benign distance is  tensor(95.4290, device='cuda:3')
norm1 res is  tensor(412.7573, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.18206503987312317
distance x is tensor(95.5373, device='cuda:3')
benign distance is  tensor(95.5373, device='cuda:3')
norm1 res is  tensor(422.5090, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.22122570872306824
distance x is tensor(98.3645, device='cuda:3')
benign distance is  tensor(98.3645, device='cuda:3')
norm1 res is  tensor(426.1591, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2532780170440674
distance x is tensor(108.2546, device='cuda:3')
benign distance is  tensor(108.2546, device='cuda:3')
norm1 res is  tensor(484.4674, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6314966678619385
distance x is tensor(124.3604, device='cuda:3')
benign distance is  tensor(124.3604, device='cuda:3')
norm1 res is  tensor(547.8114, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7388176918029785
distance x is tensor(118.1100, device='cuda:3')
benign distance is  tensor(118.1100, device='cuda:3')
norm1 res is  tensor(530.2052, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0381799936294556
distance x is tensor(113.5765, device='cuda:3')
benign distance is  tensor(113.5765, device='cuda:3')
norm1 res is  tensor(499.5295, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.43271246552467346
distance x is tensor(106.3940, device='cuda:3')
benign distance is  tensor(106.3940, device='cuda:3')
norm1 res is  tensor(472.8666, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.13811859488487244
distance x is tensor(108.0573, device='cuda:3')
benign distance is  tensor(108.0573, device='cuda:3')
norm1 res is  tensor(476.2133, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7362655401229858
distance x is tensor(115.1445, device='cuda:3')
benign distance is  tensor(115.1445, device='cuda:3')
norm1 res is  tensor(511.7090, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4269374907016754
distance x is tensor(105.5952, device='cuda:3')
benign distance is  tensor(105.5952, device='cuda:3')
norm1 res is  tensor(467.0879, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.4384627938270569
distance x is tensor(114.5138, device='cuda:3')
benign distance is  tensor(114.5138, device='cuda:3')
norm1 res is  tensor(519.2570, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.021709617227315903
distance x is tensor(115.2799, device='cuda:3')
benign distance is  tensor(115.2799, device='cuda:3')
norm1 res is  tensor(517.4191, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.33186760544776917
distance x is tensor(107.6722, device='cuda:3')
benign distance is  tensor(107.6722, device='cuda:3')
norm1 res is  tensor(496.9676, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.281017005443573
distance x is tensor(110.8372, device='cuda:3')
benign distance is  tensor(110.8372, device='cuda:3')
norm1 res is  tensor(478.7960, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.1448773890733719
distance x is tensor(106.8281, device='cuda:3')
benign distance is  tensor(106.8281, device='cuda:3')
norm1 res is  tensor(490.3645, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.185353398323059
distance x is tensor(108.8286, device='cuda:3')
benign distance is  tensor(108.8286, device='cuda:3')
norm1 res is  tensor(482.0793, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.4574991762638092
distance x is tensor(102.7239, device='cuda:3')
benign distance is  tensor(102.7239, device='cuda:3')
norm1 res is  tensor(463.8374, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.28979137539863586
distance x is tensor(108.2302, device='cuda:3')
benign distance is  tensor(108.2302, device='cuda:3')
norm1 res is  tensor(469.3213, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(95.5075, device='cuda:3')
compute distance is  tensor(95.5075, device='cuda:3')
compute norm is  tensor(46.0561, device='cuda:3', dtype=torch.float64)
distance x is tensor(96.7965, device='cuda:3')
compute distance is  tensor(96.7965, device='cuda:3')
compute norm is  tensor(46.1962, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.0704, device='cuda:3')
compute distance is  tensor(107.0704, device='cuda:3')
compute norm is  tensor(46.4227, device='cuda:3', dtype=torch.float64)
distance x is tensor(91.8111, device='cuda:3')
compute distance is  tensor(91.8111, device='cuda:3')
compute norm is  tensor(46.0478, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.6343, device='cuda:3')
compute distance is  tensor(99.6343, device='cuda:3')
compute norm is  tensor(46.1401, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.1052, device='cuda:3')
compute distance is  tensor(101.1052, device='cuda:3')
compute norm is  tensor(46.3249, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.1357, device='cuda:3')
compute distance is  tensor(103.1357, device='cuda:3')
compute norm is  tensor(46.3747, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.8747, device='cuda:3')
compute distance is  tensor(116.8747, device='cuda:3')
compute norm is  tensor(46.5941, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.7733, device='cuda:3')
compute distance is  tensor(105.7733, device='cuda:3')
compute norm is  tensor(46.3617, device='cuda:3', dtype=torch.float64)
distance x is tensor(91.7009, device='cuda:3')
compute distance is  tensor(91.7009, device='cuda:3')
compute norm is  tensor(46.0644, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.8993, device='cuda:3')
compute distance is  tensor(101.8993, device='cuda:3')
compute norm is  tensor(46.3263, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.7971, device='cuda:3')
compute distance is  tensor(102.7971, device='cuda:3')
compute norm is  tensor(46.2782, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(116.8747, device='cuda:3')
distance x is tensor(106192.5625, device='cuda:3')
distance x is tensor(106192.5625, device='cuda:3')
________________________________
test distance is  tensor(106192.5625, device='cuda:3')
test distance1 is  tensor(106192.5625, device='cuda:3')
test similarity is  tensor(-0.0653, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139275370176843.88
test entropy is  0.0
________________________________
cal ratio is  0.03251166922667367
distance x is tensor(3452.5024, device='cuda:3')
cal_distance is  tensor(3452.5024, device='cuda:3')
cal ratio is  0.1803097934040446
distance x is tensor(622.5240, device='cuda:3')
cal_distance is  tensor(622.5240, device='cuda:3')
cal ratio is  0.4246276348788578
distance x is tensor(264.3438, device='cuda:3')
cal_distance is  tensor(264.3438, device='cuda:3')
cal ratio is  0.6516310060470549
distance x is tensor(172.2563, device='cuda:3')
cal_distance is  tensor(172.2563, device='cuda:3')
cal ratio is  0.807232635290607
distance x is tensor(139.0519, device='cuda:3')
cal_distance is  tensor(139.0519, device='cuda:3')
cal ratio is  0.8984581328170683
distance x is tensor(124.9328, device='cuda:3')
cal_distance is  tensor(124.9328, device='cuda:3')
cal ratio is  0.9478684038151299
distance x is tensor(118.4202, device='cuda:3')
cal_distance is  tensor(118.4202, device='cuda:3')
cal ratio is  0.9735841969740876
distance x is tensor(115.2921, device='cuda:3')
cal_distance is  tensor(115.2921, device='cuda:3')
distance x is tensor(115.2921, device='cuda:3')
return_distance is  tensor(115.2921, device='cuda:3')
distance x is tensor(115.2822, device='cuda:3')
distance x is tensor(115.2822, device='cuda:3')
________________________________
test distance is  tensor(115.2822, device='cuda:3')
test distance1 is  tensor(115.2822, device='cuda:3')
test similarity is  tensor(0.9580, device='cuda:3')
test acc is  0.10000000015633198
test loss is 254.14556665156186
test entropy is  9.229994676669148e-30
________________________________
0
distance x is tensor(115.2822, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.9110951794216752e-29
avg test loss is  254.2307121748609
avg accuracy is  0.33933333348967354
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9580, device='cuda:3')
compute_distance is  tensor(115.2822, device='cuda:3')
compute_norm is  tensor(45.5647, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(101.8158, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8019083242045283
avg test loss is  1.2829380229210803
avg accuracy is  0.8802333334896555
solo acc is  0.3360000001563402
compute similarity  is  tensor(0.9615, device='cuda:3')
compute_distance is  tensor(101.8158, device='cuda:3')
compute_norm is  tensor(44.5494, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(103.9587, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.797260335259346
avg test loss is  1.3032485775983156
avg accuracy is  0.8801500001563222
solo acc is  0.27721666682300566
compute similarity  is  tensor(0.9610, device='cuda:3')
compute_distance is  tensor(103.9587, device='cuda:3')
compute_norm is  tensor(44.2620, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(105.8227, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7671454933914803
avg test loss is  1.332430580340977
avg accuracy is  0.8814833334896555
solo acc is  0.24500000015633805
compute similarity  is  tensor(0.9605, device='cuda:3')
compute_distance is  tensor(105.8227, device='cuda:3')
compute_norm is  tensor(44.0008, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(107.6370, device='cuda:3')
exit early
distance x is tensor(107.6370, device='cuda:3')
distance x is tensor(107.6370, device='cuda:3')
________________________________
test distance is  tensor(107.6370, device='cuda:3')
test distance1 is  tensor(107.6370, device='cuda:3')
test similarity is  tensor(0.9602, device='cuda:3')
test acc is  0.22555000015633742
test loss is 1.3312183761520426
test entropy is  0.7574593590647936
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2780321836471558
mal norm is  tensor(561.5424, device='cuda:3')
distance x is tensor(107.6439, device='cuda:3')
mal distance is  tensor(107.6439, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([19., 19., 19., 19., 19., 19., 19., 19., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0669,
        0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669,
        0.0669, 0.0669])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 78.27% 

Test Accuracy: 77.27% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4880548119544983
distance x is tensor(152.2153, device='cuda:3')
benign distance is  tensor(152.2153, device='cuda:3')
norm1 res is  tensor(613.8658, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5569858551025391
distance x is tensor(145.1276, device='cuda:3')
benign distance is  tensor(145.1276, device='cuda:3')
norm1 res is  tensor(583.9189, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.16382822394371033
distance x is tensor(134.9043, device='cuda:3')
benign distance is  tensor(134.9043, device='cuda:3')
norm1 res is  tensor(549.6345, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3474801480770111
distance x is tensor(147.2068, device='cuda:3')
benign distance is  tensor(147.2068, device='cuda:3')
norm1 res is  tensor(582.0860, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.008313536643982
distance x is tensor(130.5298, device='cuda:3')
benign distance is  tensor(130.5298, device='cuda:3')
norm1 res is  tensor(524.3337, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.678727924823761
distance x is tensor(141.9251, device='cuda:3')
benign distance is  tensor(141.9251, device='cuda:3')
norm1 res is  tensor(572.9126, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5368005037307739
distance x is tensor(135.6911, device='cuda:3')
benign distance is  tensor(135.6911, device='cuda:3')
norm1 res is  tensor(544.4307, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6393824815750122
distance x is tensor(141.5796, device='cuda:3')
benign distance is  tensor(141.5796, device='cuda:3')
norm1 res is  tensor(568.5735, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(140.9736, device='cuda:3')
compute distance is  tensor(140.9736, device='cuda:3')
compute norm is  tensor(45.7022, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.7247, device='cuda:3')
compute distance is  tensor(144.7247, device='cuda:3')
compute norm is  tensor(45.8176, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.0626, device='cuda:3')
compute distance is  tensor(139.0626, device='cuda:3')
compute norm is  tensor(45.8741, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.0886, device='cuda:3')
compute distance is  tensor(140.0886, device='cuda:3')
compute norm is  tensor(45.7586, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.6948, device='cuda:3')
compute distance is  tensor(145.6948, device='cuda:3')
compute norm is  tensor(45.9517, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.3961, device='cuda:3')
compute distance is  tensor(139.3961, device='cuda:3')
compute norm is  tensor(45.7897, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.2718, device='cuda:3')
compute distance is  tensor(144.2718, device='cuda:3')
compute norm is  tensor(45.8934, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.2113, device='cuda:3')
compute distance is  tensor(142.2113, device='cuda:3')
compute norm is  tensor(45.8473, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.6299, device='cuda:3')
compute distance is  tensor(148.6299, device='cuda:3')
compute norm is  tensor(45.9431, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.8125, device='cuda:3')
compute distance is  tensor(132.8125, device='cuda:3')
compute norm is  tensor(45.6785, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.6882, device='cuda:3')
compute distance is  tensor(158.6882, device='cuda:3')
compute norm is  tensor(46.0472, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.0999, device='cuda:3')
compute distance is  tensor(132.0999, device='cuda:3')
compute norm is  tensor(45.6575, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(158.6882, device='cuda:3')
distance x is tensor(106139.1641, device='cuda:3')
distance x is tensor(106139.1641, device='cuda:3')
________________________________
test distance is  tensor(106139.1641, device='cuda:3')
test distance1 is  tensor(106139.1641, device='cuda:3')
test similarity is  tensor(0.1322, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139282328339375.22
test entropy is  0.0
________________________________
cal ratio is  0.03789313911117402
distance x is tensor(4021.9514, device='cuda:3')
cal_distance is  tensor(4021.9514, device='cuda:3')
cal ratio is  0.19466147626581182
distance x is tensor(782.9230, device='cuda:3')
cal_distance is  tensor(782.9230, device='cuda:3')
cal ratio is  0.44120344033864783
distance x is tensor(345.4311, device='cuda:3')
cal_distance is  tensor(345.4311, device='cuda:3')
cal ratio is  0.6642287697369461
distance x is tensor(229.4470, device='cuda:3')
cal_distance is  tensor(229.4470, device='cuda:3')
cal ratio is  0.814999350214038
distance x is tensor(187.0001, device='cuda:3')
cal_distance is  tensor(187.0001, device='cuda:3')
cal ratio is  0.9027708361140342
distance x is tensor(168.8187, device='cuda:3')
cal_distance is  tensor(168.8187, device='cuda:3')
cal ratio is  0.95014124435171
distance x is tensor(160.4018, device='cuda:3')
cal_distance is  tensor(160.4018, device='cuda:3')
cal ratio is  0.9747511274649711
distance x is tensor(156.3520, device='cuda:3')
cal_distance is  tensor(156.3520, device='cuda:3')
distance x is tensor(156.3520, device='cuda:3')
return_distance is  tensor(156.3520, device='cuda:3')
distance x is tensor(156.3421, device='cuda:3')
distance x is tensor(156.3421, device='cuda:3')
________________________________
test distance is  tensor(156.3421, device='cuda:3')
test distance1 is  tensor(156.3421, device='cuda:3')
test similarity is  tensor(0.9337, device='cuda:3')
test acc is  0.10000000015633198
test loss is 810.7751042542935
test entropy is  0.0
________________________________
0
distance x is tensor(156.3421, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  810.7683969591218
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9337, device='cuda:3')
compute_distance is  tensor(156.3421, device='cuda:3')
compute_norm is  tensor(47.3346, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(170.0660, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5613485553117195
avg test loss is  2.8459619982664517
avg accuracy is  0.28806666682300597
solo acc is  0.10041666682299864
compute similarity  is  tensor(0.9227, device='cuda:3')
compute_distance is  tensor(170.0660, device='cuda:3')
compute_norm is  tensor(48.2896, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(170.7187, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8396010989827642
avg test loss is  3.5793018747748597
avg accuracy is  0.21366666682300364
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.9213, device='cuda:3')
compute_distance is  tensor(170.7187, device='cuda:3')
compute_norm is  tensor(48.4569, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(170.0246, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.552630209338182
avg test loss is  2.847937100731742
avg accuracy is  0.29145000015633943
solo acc is  0.10021666682299865
compute similarity  is  tensor(0.9225, device='cuda:3')
compute_distance is  tensor(170.0246, device='cuda:3')
compute_norm is  tensor(47.8558, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(170.7121, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8384590717012694
avg test loss is  3.5764508181289316
avg accuracy is  0.21871666682300392
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9212, device='cuda:3')
compute_distance is  tensor(170.7121, device='cuda:3')
compute_norm is  tensor(48.0216, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(170.0908, device='cuda:3')
distance x is tensor(170.0908, device='cuda:3')
________________________________
test distance is  tensor(170.0908, device='cuda:3')
test distance1 is  tensor(170.0908, device='cuda:3')
test similarity is  tensor(0.9224, device='cuda:3')
test acc is  0.10045000015633197
test loss is 2.8446024013226476
test entropy is  1.551703770785952
________________________________
cal ratio is  0.9465815590381379
distance x is tensor(161.0121, device='cuda:3')
cal_distance is  tensor(161.0121, device='cuda:3')
cal ratio is  0.972902171863567
distance x is tensor(156.6491, device='cuda:3')
cal_distance is  tensor(156.6491, device='cuda:3')
distance x is tensor(156.6491, device='cuda:3')
return_distance is  tensor(156.6491, device='cuda:3')
distance x is tensor(156.6416, device='cuda:3')
distance x is tensor(156.6416, device='cuda:3')
________________________________
test distance is  tensor(156.6416, device='cuda:3')
test distance1 is  tensor(156.6416, device='cuda:3')
test similarity is  tensor(0.9329, device='cuda:3')
test acc is  0.10181666682299864
test loss is 2.70135454811267
test entropy is  1.7325872049402835
________________________________
0
distance x is tensor(156.6416, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.7323477011499628
avg test loss is  2.7018206452509994
avg accuracy is  0.339116666823007
solo acc is  0.10171666682299864
compute similarity  is  tensor(0.9329, device='cuda:3')
compute_distance is  tensor(156.6416, device='cuda:3')
compute_norm is  tensor(46.8788, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(157.8505, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8427261645351646
avg test loss is  3.5660627361045463
avg accuracy is  0.2740166668230056
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9310, device='cuda:3')
compute_distance is  tensor(157.8505, device='cuda:3')
compute_norm is  tensor(47.1317, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(157.5108, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5448148870773153
avg test loss is  2.819803050331978
avg accuracy is  0.3545333334896739
solo acc is  0.10446666682299864
compute similarity  is  tensor(0.9324, device='cuda:3')
compute_distance is  tensor(157.5108, device='cuda:3')
compute_norm is  tensor(46.5554, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(158.6165, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.834311365318705
avg test loss is  3.5540278476438543
avg accuracy is  0.2857500001563392
solo acc is  0.10013333348966531
compute similarity  is  tensor(0.9310, device='cuda:3')
compute_distance is  tensor(158.6165, device='cuda:3')
compute_norm is  tensor(46.7195, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(158.7877, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.5245002783946138
avg test loss is  2.7046954659764957
avg accuracy is  0.366733333489674
solo acc is  0.10820000015633195
compute similarity  is  tensor(0.9324, device='cuda:3')
compute_distance is  tensor(158.7877, device='cuda:3')
compute_norm is  tensor(46.1849, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(160.1192, device='cuda:3')
distance x is tensor(160.1192, device='cuda:3')
________________________________
test distance is  tensor(160.1192, device='cuda:3')
test distance1 is  tensor(160.1192, device='cuda:3')
test similarity is  tensor(0.9310, device='cuda:3')
test acc is  0.10025000015633198
test loss is 3.409108024924549
test entropy is  0.8191864883848853
________________________________
cal ratio is  0.9756110413583424
distance x is tensor(156.2209, device='cuda:3')
cal_distance is  tensor(156.2209, device='cuda:3')
distance x is tensor(156.2209, device='cuda:3')
return_distance is  tensor(156.2209, device='cuda:3')
distance x is tensor(156.2140, device='cuda:3')
distance x is tensor(156.2140, device='cuda:3')
________________________________
test distance is  tensor(156.2140, device='cuda:3')
test distance1 is  tensor(156.2140, device='cuda:3')
test similarity is  tensor(0.9340, device='cuda:3')
test acc is  0.10040000015633196
test loss is 3.310294741760693
test entropy is  0.8920897402361766
________________________________
0
distance x is tensor(156.2140, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8922392064447342
avg test loss is  3.3072648602508026
avg accuracy is  0.31713333348967315
solo acc is  0.10028333348966531
compute similarity  is  tensor(0.9340, device='cuda:3')
compute_distance is  tensor(156.2140, device='cuda:3')
compute_norm is  tensor(46.1951, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(157.8928, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.3725964612543964
avg test loss is  2.365895603003024
avg accuracy is  0.4039833334896745
solo acc is  0.11431666682299861
compute similarity  is  tensor(0.9355, device='cuda:3')
compute_distance is  tensor(157.8928, device='cuda:3')
compute_norm is  tensor(45.7109, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(159.2359, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7894042039603821
avg test loss is  3.044463769459267
avg accuracy is  0.35073333348967384
solo acc is  0.1006333334896653
compute similarity  is  tensor(0.9342, device='cuda:3')
compute_distance is  tensor(159.2359, device='cuda:3')
compute_norm is  tensor(45.7883, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(161.0082, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.2871598450105581
avg test loss is  2.151223271132024
avg accuracy is  0.4317333334896748
solo acc is  0.13323333348966523
compute similarity  is  tensor(0.9350, device='cuda:3')
compute_distance is  tensor(161.0082, device='cuda:3')
compute_norm is  tensor(45.4524, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(162.1414, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.750574869578327
avg test loss is  2.876626020047202
avg accuracy is  0.3522500001563405
solo acc is  0.1009333334896653
compute similarity  is  tensor(0.9340, device='cuda:3')
compute_distance is  tensor(162.1414, device='cuda:3')
compute_norm is  tensor(45.4711, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(162.9746, device='cuda:3')
________________________________
test distance is  tensor(162.9746, device='cuda:3')
test similarity is  tensor(0.9349, device='cuda:3')
test acc is  0.451683333489675
test loss is 2.054942328919734
test entropy is  1.2241258290784953
________________________________
final entropy
distance x is tensor(162.9682, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.2254144897593109
avg test loss is  2.056450415394708
avg accuracy is  0.451183333489675
solo acc is  0.13816666682299875
compute similarity  is  tensor(0.9349, device='cuda:3')
compute_distance is  tensor(162.9682, device='cuda:3')
compute_norm is  tensor(45.1397, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 2.447889566421509
mal norm is  tensor(730.5335, device='cuda:3')
distance x is tensor(163.9699, device='cuda:3')
mal distance is  tensor(163.9699, device='cuda:3')
user_PLR len size 52
counter_tensor is  tensor([51., 51., 51., 51., 51., 51., 51., 51., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 51., 51., 51., 51., 51., 51., 51., 51.,
        51., 51., 51., 51., 51., 51., 51., 51., 51., 51., 51., 51., 51., 51.,
        51., 51., 51., 51., 51., 51., 51., 51., 51., 51.])
count_res tensor([2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 4.1754e-07, 4.1754e-07, 4.1754e-07, 4.1754e-07,
        4.1754e-07, 4.1754e-07, 4.1754e-07, 4.1754e-07, 4.1754e-07, 4.1754e-07,
        4.1754e-07, 4.1754e-07, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 90.14% 

Test Accuracy: 89.47% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8253043293952942
distance x is tensor(75.4327, device='cuda:3')
benign distance is  tensor(75.4327, device='cuda:3')
norm1 res is  tensor(328.5076, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7941718101501465
distance x is tensor(78.8004, device='cuda:3')
benign distance is  tensor(78.8004, device='cuda:3')
norm1 res is  tensor(352.4999, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.327838271856308
distance x is tensor(111.1790, device='cuda:3')
benign distance is  tensor(111.1790, device='cuda:3')
norm1 res is  tensor(483.7737, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.47525033354759216
distance x is tensor(83.7232, device='cuda:3')
benign distance is  tensor(83.7232, device='cuda:3')
norm1 res is  tensor(364.7013, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3461623787879944
distance x is tensor(78.9732, device='cuda:3')
benign distance is  tensor(78.9732, device='cuda:3')
norm1 res is  tensor(329.9729, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5593010187149048
distance x is tensor(93.9594, device='cuda:3')
benign distance is  tensor(93.9594, device='cuda:3')
norm1 res is  tensor(411.9431, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3329404890537262
distance x is tensor(89.4232, device='cuda:3')
benign distance is  tensor(89.4232, device='cuda:3')
norm1 res is  tensor(392.6718, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2281971275806427
distance x is tensor(93.0031, device='cuda:3')
benign distance is  tensor(93.0031, device='cuda:3')
norm1 res is  tensor(409.2824, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5890122652053833
distance x is tensor(111.9185, device='cuda:3')
benign distance is  tensor(111.9185, device='cuda:3')
norm1 res is  tensor(487.5997, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6314589381217957
distance x is tensor(108.7353, device='cuda:3')
benign distance is  tensor(108.7353, device='cuda:3')
norm1 res is  tensor(472.4692, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4067147672176361
distance x is tensor(99.6481, device='cuda:3')
benign distance is  tensor(99.6481, device='cuda:3')
norm1 res is  tensor(436.3308, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.34049874544143677
distance x is tensor(109.4710, device='cuda:3')
benign distance is  tensor(109.4710, device='cuda:3')
norm1 res is  tensor(473.0464, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4049011170864105
distance x is tensor(101.5821, device='cuda:3')
benign distance is  tensor(101.5821, device='cuda:3')
norm1 res is  tensor(447.3098, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1855027973651886
distance x is tensor(113.9411, device='cuda:3')
benign distance is  tensor(113.9411, device='cuda:3')
norm1 res is  tensor(490.2800, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.23708339035511017
distance x is tensor(122.1145, device='cuda:3')
benign distance is  tensor(122.1145, device='cuda:3')
norm1 res is  tensor(537.8307, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6949502825737
distance x is tensor(113.3850, device='cuda:3')
benign distance is  tensor(113.3850, device='cuda:3')
norm1 res is  tensor(493.6524, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4341888427734375
distance x is tensor(113.6707, device='cuda:3')
benign distance is  tensor(113.6707, device='cuda:3')
norm1 res is  tensor(502.2201, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9243582487106323
distance x is tensor(124.6188, device='cuda:3')
benign distance is  tensor(124.6188, device='cuda:3')
norm1 res is  tensor(542.1354, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.10312040895223618
distance x is tensor(99.1882, device='cuda:3')
benign distance is  tensor(99.1882, device='cuda:3')
norm1 res is  tensor(447.0669, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.14873629808425903
distance x is tensor(113.3644, device='cuda:3')
benign distance is  tensor(113.3644, device='cuda:3')
norm1 res is  tensor(506.0916, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.33013156056404114
distance x is tensor(108.5857, device='cuda:3')
benign distance is  tensor(108.5857, device='cuda:3')
norm1 res is  tensor(479.1159, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.1037616729736328
distance x is tensor(102.4967, device='cuda:3')
benign distance is  tensor(102.4967, device='cuda:3')
norm1 res is  tensor(449.7042, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5233123302459717
distance x is tensor(116.4016, device='cuda:3')
benign distance is  tensor(116.4016, device='cuda:3')
norm1 res is  tensor(514.5227, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3084663450717926
distance x is tensor(107.3826, device='cuda:3')
benign distance is  tensor(107.3826, device='cuda:3')
norm1 res is  tensor(472.2386, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.2614070773124695
distance x is tensor(121.6663, device='cuda:3')
benign distance is  tensor(121.6663, device='cuda:3')
norm1 res is  tensor(528.4583, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.44187131524086
distance x is tensor(100.3608, device='cuda:3')
benign distance is  tensor(100.3608, device='cuda:3')
norm1 res is  tensor(429.0593, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.0400757789611816
distance x is tensor(111.0072, device='cuda:3')
benign distance is  tensor(111.0072, device='cuda:3')
norm1 res is  tensor(497.4811, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.2037644386291504
distance x is tensor(119.1864, device='cuda:3')
benign distance is  tensor(119.1864, device='cuda:3')
norm1 res is  tensor(518.3328, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6017709970474243
distance x is tensor(100.5107, device='cuda:3')
benign distance is  tensor(100.5107, device='cuda:3')
norm1 res is  tensor(438.0144, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.48433059453964233
distance x is tensor(110.9620, device='cuda:3')
benign distance is  tensor(110.9620, device='cuda:3')
norm1 res is  tensor(489.3476, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.22495631873607635
distance x is tensor(104.6128, device='cuda:3')
benign distance is  tensor(104.6128, device='cuda:3')
norm1 res is  tensor(468.5154, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.13155324757099152
distance x is tensor(104.4644, device='cuda:3')
benign distance is  tensor(104.4644, device='cuda:3')
norm1 res is  tensor(468.1793, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.5784858465194702
distance x is tensor(116.5651, device='cuda:3')
benign distance is  tensor(116.5651, device='cuda:3')
norm1 res is  tensor(511.9179, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.41919416189193726
distance x is tensor(103.0374, device='cuda:3')
benign distance is  tensor(103.0374, device='cuda:3')
norm1 res is  tensor(444.4734, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.10141752660274506
distance x is tensor(108.1038, device='cuda:3')
benign distance is  tensor(108.1038, device='cuda:3')
norm1 res is  tensor(487.3534, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.45156654715538025
distance x is tensor(113.1406, device='cuda:3')
benign distance is  tensor(113.1406, device='cuda:3')
norm1 res is  tensor(484.0561, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5012637376785278
distance x is tensor(100.8004, device='cuda:3')
benign distance is  tensor(100.8004, device='cuda:3')
norm1 res is  tensor(446.4174, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.9384293556213379
distance x is tensor(113.3642, device='cuda:3')
benign distance is  tensor(113.3642, device='cuda:3')
norm1 res is  tensor(496.3513, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.0214465856552124
distance x is tensor(108.4296, device='cuda:3')
benign distance is  tensor(108.4296, device='cuda:3')
norm1 res is  tensor(452.9906, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.29227274656295776
distance x is tensor(110.7789, device='cuda:3')
benign distance is  tensor(110.7789, device='cuda:3')
norm1 res is  tensor(497.4414, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(98.3996, device='cuda:3')
compute distance is  tensor(98.3996, device='cuda:3')
compute norm is  tensor(46.0407, device='cuda:3', dtype=torch.float64)
distance x is tensor(87.9639, device='cuda:3')
compute distance is  tensor(87.9639, device='cuda:3')
compute norm is  tensor(45.8208, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.3066, device='cuda:3')
compute distance is  tensor(109.3066, device='cuda:3')
compute norm is  tensor(46.3772, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.4534, device='cuda:3')
compute distance is  tensor(98.4534, device='cuda:3')
compute norm is  tensor(46.0246, device='cuda:3', dtype=torch.float64)
distance x is tensor(96.1586, device='cuda:3')
compute distance is  tensor(96.1586, device='cuda:3')
compute norm is  tensor(46.0185, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.9222, device='cuda:3')
compute distance is  tensor(99.9222, device='cuda:3')
compute norm is  tensor(46.1699, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.4908, device='cuda:3')
compute distance is  tensor(101.4908, device='cuda:3')
compute norm is  tensor(46.1734, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.1915, device='cuda:3')
compute distance is  tensor(110.1915, device='cuda:3')
compute norm is  tensor(46.2243, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.9048, device='cuda:3')
compute distance is  tensor(103.9048, device='cuda:3')
compute norm is  tensor(46.2310, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.3792, device='cuda:3')
compute distance is  tensor(98.3792, device='cuda:3')
compute norm is  tensor(46.1688, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.8672, device='cuda:3')
compute distance is  tensor(107.8672, device='cuda:3')
compute norm is  tensor(46.2788, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.3832, device='cuda:3')
compute distance is  tensor(107.3832, device='cuda:3')
compute norm is  tensor(46.2944, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(110.1915, device='cuda:3')
distance x is tensor(106187.3750, device='cuda:3')
distance x is tensor(106187.3750, device='cuda:3')
________________________________
test distance is  tensor(106187.3750, device='cuda:3')
test distance1 is  tensor(106187.3750, device='cuda:3')
test similarity is  tensor(-0.0367, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139292196087908.44
test entropy is  0.0
________________________________
cal ratio is  0.03156920974737614
distance x is tensor(3352.2568, device='cuda:3')
cal_distance is  tensor(3352.2568, device='cuda:3')
cal ratio is  0.1776771189092154
distance x is tensor(595.6234, device='cuda:3')
cal_distance is  tensor(595.6234, device='cuda:3')
cal ratio is  0.42151621555267627
distance x is tensor(251.0678, device='cuda:3')
cal_distance is  tensor(251.0678, device='cuda:3')
cal ratio is  0.6492391126907435
distance x is tensor(163.0048, device='cuda:3')
cal_distance is  tensor(163.0048, device='cuda:3')
cal ratio is  0.8057494129151547
distance x is tensor(131.3420, device='cuda:3')
cal_distance is  tensor(131.3420, device='cuda:3')
cal ratio is  0.8976319885693691
distance x is tensor(117.8973, device='cuda:3')
cal_distance is  tensor(117.8973, device='cuda:3')
cal ratio is  0.9474323288422668
distance x is tensor(111.7000, device='cuda:3')
cal_distance is  tensor(111.7000, device='cuda:3')
cal ratio is  0.9733602409992733
distance x is tensor(108.7244, device='cuda:3')
cal_distance is  tensor(108.7244, device='cuda:3')
distance x is tensor(108.7244, device='cuda:3')
return_distance is  tensor(108.7244, device='cuda:3')
distance x is tensor(108.7146, device='cuda:3')
distance x is tensor(108.7146, device='cuda:3')
________________________________
test distance is  tensor(108.7146, device='cuda:3')
test distance1 is  tensor(108.7146, device='cuda:3')
test similarity is  tensor(0.9628, device='cuda:3')
test acc is  0.10000000015633198
test loss is 184.11783975629663
test entropy is  1.2401299372159082e-23
________________________________
0
distance x is tensor(108.7146, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.7233294455820618e-23
avg test loss is  184.04775704910506
avg accuracy is  0.4371166668230082
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9628, device='cuda:3')
compute_distance is  tensor(108.7146, device='cuda:3')
compute_norm is  tensor(45.5994, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(98.1748, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7946445894902194
avg test loss is  1.281633605835026
avg accuracy is  0.8803833334896555
solo acc is  0.3299500001563401
compute similarity  is  tensor(0.9651, device='cuda:3')
compute_distance is  tensor(98.1748, device='cuda:3')
compute_norm is  tensor(44.6752, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(100.1236, device='cuda:3')
exit early
distance x is tensor(100.1236, device='cuda:3')
distance x is tensor(100.1236, device='cuda:3')
________________________________
test distance is  tensor(100.1236, device='cuda:3')
test distance1 is  tensor(100.1236, device='cuda:3')
test similarity is  tensor(0.9646, device='cuda:3')
test acc is  0.2847833334896725
test loss is 1.2848168460290823
test entropy is  0.7969959829407715
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.330320954322815
mal norm is  tensor(531.4998, device='cuda:3')
distance x is tensor(100.1307, device='cuda:3')
mal distance is  tensor(100.1307, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([19., 19., 19., 19., 19., 19., 19., 19., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0669,
        0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669,
        0.0669, 0.0669])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 79.89% 

Test Accuracy: 78.94% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.35731416940689087
distance x is tensor(137.6415, device='cuda:3')
benign distance is  tensor(137.6415, device='cuda:3')
norm1 res is  tensor(566.4026, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5672776699066162
distance x is tensor(152.9333, device='cuda:3')
benign distance is  tensor(152.9333, device='cuda:3')
norm1 res is  tensor(611.9460, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.06469785422086716
distance x is tensor(148.0362, device='cuda:3')
benign distance is  tensor(148.0362, device='cuda:3')
norm1 res is  tensor(604.7215, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4851752817630768
distance x is tensor(132.2381, device='cuda:3')
benign distance is  tensor(132.2381, device='cuda:3')
norm1 res is  tensor(522.3454, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8206948041915894
distance x is tensor(141.5614, device='cuda:3')
benign distance is  tensor(141.5614, device='cuda:3')
norm1 res is  tensor(555.7462, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3516383171081543
distance x is tensor(146.2351, device='cuda:3')
benign distance is  tensor(146.2351, device='cuda:3')
norm1 res is  tensor(588.0551, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.44396743178367615
distance x is tensor(139.9617, device='cuda:3')
benign distance is  tensor(139.9617, device='cuda:3')
norm1 res is  tensor(564.1045, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5476130247116089
distance x is tensor(125.6129, device='cuda:3')
benign distance is  tensor(125.6129, device='cuda:3')
norm1 res is  tensor(506.0051, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(133.8134, device='cuda:3')
compute distance is  tensor(133.8134, device='cuda:3')
compute norm is  tensor(46.0334, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.7905, device='cuda:3')
compute distance is  tensor(127.7905, device='cuda:3')
compute norm is  tensor(45.9564, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.5390, device='cuda:3')
compute distance is  tensor(148.5390, device='cuda:3')
compute norm is  tensor(46.5424, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.8235, device='cuda:3')
compute distance is  tensor(130.8235, device='cuda:3')
compute norm is  tensor(45.9936, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.3646, device='cuda:3')
compute distance is  tensor(157.3646, device='cuda:3')
compute norm is  tensor(46.7635, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.8746, device='cuda:3')
compute distance is  tensor(144.8746, device='cuda:3')
compute norm is  tensor(46.3919, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.9970, device='cuda:3')
compute distance is  tensor(131.9970, device='cuda:3')
compute norm is  tensor(45.9861, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.9156, device='cuda:3')
compute distance is  tensor(142.9156, device='cuda:3')
compute norm is  tensor(46.2631, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.7068, device='cuda:3')
compute distance is  tensor(151.7068, device='cuda:3')
compute norm is  tensor(46.5262, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.5547, device='cuda:3')
compute distance is  tensor(134.5547, device='cuda:3')
compute norm is  tensor(46.0342, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.8113, device='cuda:3')
compute distance is  tensor(154.8113, device='cuda:3')
compute norm is  tensor(46.5151, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.6633, device='cuda:3')
compute distance is  tensor(148.6633, device='cuda:3')
compute norm is  tensor(46.3702, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(157.3646, device='cuda:3')
distance x is tensor(106131.5547, device='cuda:3')
distance x is tensor(106131.5547, device='cuda:3')
________________________________
test distance is  tensor(106131.5547, device='cuda:3')
test distance1 is  tensor(106131.5547, device='cuda:3')
test similarity is  tensor(0.1544, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139282659850366.64
test entropy is  0.0
________________________________
cal ratio is  0.0377361253102682
distance x is tensor(4004.9990, device='cuda:3')
cal_distance is  tensor(4004.9990, device='cuda:3')
cal ratio is  0.19425774837195978
distance x is tensor(778.0061, device='cuda:3')
cal_distance is  tensor(778.0061, device='cuda:3')
cal ratio is  0.4407456866890118
distance x is tensor(342.9056, device='cuda:3')
cal_distance is  tensor(342.9056, device='cuda:3')
cal ratio is  0.6638841047160051
distance x is tensor(227.6513, device='cuda:3')
cal_distance is  tensor(227.6513, device='cuda:3')
cal ratio is  0.8147877996296526
distance x is tensor(185.4884, device='cuda:3')
cal_distance is  tensor(185.4884, device='cuda:3')
cal ratio is  0.9026537110601834
distance x is tensor(167.4323, device='cuda:3')
cal_distance is  tensor(167.4323, device='cuda:3')
cal ratio is  0.9500795481906191
distance x is tensor(159.0742, device='cuda:3')
cal_distance is  tensor(159.0742, device='cuda:3')
cal ratio is  0.9747194730474631
distance x is tensor(155.0529, device='cuda:3')
cal_distance is  tensor(155.0529, device='cuda:3')
distance x is tensor(155.0529, device='cuda:3')
return_distance is  tensor(155.0529, device='cuda:3')
distance x is tensor(155.0430, device='cuda:3')
distance x is tensor(155.0430, device='cuda:3')
________________________________
test distance is  tensor(155.0430, device='cuda:3')
test distance1 is  tensor(155.0430, device='cuda:3')
test similarity is  tensor(0.9374, device='cuda:3')
test acc is  0.10000000015633198
test loss is 838.7867261158632
test entropy is  0.0
________________________________
0
distance x is tensor(155.0430, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  838.5681352107001
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9374, device='cuda:3')
compute_distance is  tensor(155.0430, device='cuda:3')
compute_norm is  tensor(47.9868, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(207.5638, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5623698195160578
avg test loss is  2.8493439843659716
avg accuracy is  0.12975000015633192
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9079, device='cuda:3')
compute_distance is  tensor(207.5638, device='cuda:3')
compute_norm is  tensor(50.7839, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(207.6881, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.840088692491751
avg test loss is  3.580539387172219
avg accuracy is  0.06561666682299881
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9067, device='cuda:3')
compute_distance is  tensor(207.6881, device='cuda:3')
compute_norm is  tensor(50.9367, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(206.7637, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5531981033302829
avg test loss is  2.851783135552396
avg accuracy is  0.13228333348966523
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9077, device='cuda:3')
compute_distance is  tensor(206.7637, device='cuda:3')
compute_norm is  tensor(50.3271, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(206.9969, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8395550186191795
avg test loss is  3.577484567536474
avg accuracy is  0.06291666682299882
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9065, device='cuda:3')
compute_distance is  tensor(206.9969, device='cuda:3')
compute_norm is  tensor(50.4792, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(206.1802, device='cuda:3')
distance x is tensor(206.1802, device='cuda:3')
________________________________
test distance is  tensor(206.1802, device='cuda:3')
test distance1 is  tensor(206.1802, device='cuda:3')
test similarity is  tensor(0.9076, device='cuda:3')
test acc is  0.10003333348966531
test loss is 2.8516429736415967
test entropy is  1.552905144467791
________________________________
cal ratio is  0.8561622102381464
distance x is tensor(176.5289, device='cuda:3')
cal_distance is  tensor(176.5289, device='cuda:3')
cal ratio is  0.9252767799462978
distance x is tensor(163.3383, device='cuda:3')
cal_distance is  tensor(163.3383, device='cuda:3')
cal ratio is  0.9619124914352056
distance x is tensor(157.1173, device='cuda:3')
cal_distance is  tensor(157.1173, device='cuda:3')
distance x is tensor(157.1173, device='cuda:3')
return_distance is  tensor(157.1173, device='cuda:3')
distance x is tensor(157.1117, device='cuda:3')
distance x is tensor(157.1117, device='cuda:3')
________________________________
test distance is  tensor(157.1117, device='cuda:3')
test distance1 is  tensor(157.1117, device='cuda:3')
test similarity is  tensor(0.9424, device='cuda:3')
test acc is  0.1007333334896653
test loss is 2.489797234026862
test entropy is  2.063814599630929
________________________________
0
distance x is tensor(157.1117, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.0638856694642413
avg test loss is  2.4897255010442185
avg accuracy is  0.2150000001563371
solo acc is  0.1008333334896653
compute similarity  is  tensor(0.9424, device='cuda:3')
compute_distance is  tensor(157.1117, device='cuda:3')
compute_norm is  tensor(47.6560, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(158.6583, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8526514788299228
avg test loss is  3.5597502079599703
avg accuracy is  0.148650000156333
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9398, device='cuda:3')
compute_distance is  tensor(158.6583, device='cuda:3')
compute_norm is  tensor(48.0394, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(158.2293, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.530052056063467
avg test loss is  2.7577955641472007
avg accuracy is  0.25736666682300524
solo acc is  0.10160000015633197
compute similarity  is  tensor(0.9412, device='cuda:3')
compute_distance is  tensor(158.2293, device='cuda:3')
compute_norm is  tensor(47.4907, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(159.3011, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8437322121439204
avg test loss is  3.4451740077817874
avg accuracy is  0.18620000015633564
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.9400, device='cuda:3')
compute_distance is  tensor(159.3011, device='cuda:3')
compute_norm is  tensor(47.5948, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(160.7895, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.4394161344082879
avg test loss is  2.4820645155428824
avg accuracy is  0.28153333348967247
solo acc is  0.11730000015633193
compute similarity  is  tensor(0.9413, device='cuda:3')
compute_distance is  tensor(160.7895, device='cuda:3')
compute_norm is  tensor(47.1705, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(162.0629, device='cuda:3')
distance x is tensor(162.0629, device='cuda:3')
________________________________
test distance is  tensor(162.0629, device='cuda:3')
test distance1 is  tensor(162.0629, device='cuda:3')
test similarity is  tensor(0.9399, device='cuda:3')
test acc is  0.10050000015633198
test loss is 3.1975129723294713
test entropy is  0.801853867227843
________________________________
cal ratio is  0.9656902061223518
distance x is tensor(156.5071, device='cuda:3')
cal_distance is  tensor(156.5071, device='cuda:3')
distance x is tensor(156.5071, device='cuda:3')
return_distance is  tensor(156.5071, device='cuda:3')
distance x is tensor(156.5025, device='cuda:3')
distance x is tensor(156.5025, device='cuda:3')
________________________________
test distance is  tensor(156.5025, device='cuda:3')
test distance1 is  tensor(156.5025, device='cuda:3')
test similarity is  tensor(0.9437, device='cuda:3')
test acc is  0.10070000015633197
test loss is 3.0758520324092937
test entropy is  0.9000207584168611
________________________________
0
distance x is tensor(156.5025, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8996998358891208
avg test loss is  3.0727776995599907
avg accuracy is  0.28501666682300586
solo acc is  0.10068333348966531
compute similarity  is  tensor(0.9437, device='cuda:3')
compute_distance is  tensor(156.5025, device='cuda:3')
compute_norm is  tensor(47.0535, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(158.6305, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.2396784930595204
avg test loss is  2.0339769728656516
avg accuracy is  0.34045000015634036
solo acc is  0.16870000015633457
compute similarity  is  tensor(0.9448, device='cuda:3')
compute_distance is  tensor(158.6305, device='cuda:3')
compute_norm is  tensor(46.7344, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(160.0121, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7004699956760732
avg test loss is  2.7548805742121454
avg accuracy is  0.3146666668230065
solo acc is  0.10220000015633197
compute similarity  is  tensor(0.9439, device='cuda:3')
compute_distance is  tensor(160.0121, device='cuda:3')
compute_norm is  tensor(46.7121, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(162.1837, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0447293067537646
avg test loss is  1.6617857324543284
avg accuracy is  0.4047666668230078
solo acc is  0.2316500001563377
compute similarity  is  tensor(0.9445, device='cuda:3')
compute_distance is  tensor(162.1837, device='cuda:3')
compute_norm is  tensor(46.4118, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(163.1212, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6288190150438849
avg test loss is  2.457667055160506
avg accuracy is  0.3450333334896737
solo acc is  0.1039333334896653
compute similarity  is  tensor(0.9438, device='cuda:3')
compute_distance is  tensor(163.1212, device='cuda:3')
compute_norm is  tensor(46.3008, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(164.5575, device='cuda:3')
________________________________
test distance is  tensor(164.5575, device='cuda:3')
test similarity is  tensor(0.9441, device='cuda:3')
test acc is  0.42106666682300803
test loss is 1.5399404274883555
test entropy is  0.9800279711736545
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 1.592992901802063
mal norm is  tensor(680.3655, device='cuda:3')
distance x is tensor(164.5575, device='cuda:3')
mal distance is  tensor(164.5575, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([27., 27., 27., 27., 27., 27., 27., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 27., 27., 27., 27., 27., 27., 27.])
count_res tensor([6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 89.97% 

Test Accuracy: 89.28% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9169625043869019
distance x is tensor(86.2080, device='cuda:3')
benign distance is  tensor(86.2080, device='cuda:3')
norm1 res is  tensor(377.0183, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7180449962615967
distance x is tensor(95.8016, device='cuda:3')
benign distance is  tensor(95.8016, device='cuda:3')
norm1 res is  tensor(406.7765, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.18059484660625458
distance x is tensor(102.1002, device='cuda:3')
benign distance is  tensor(102.1002, device='cuda:3')
norm1 res is  tensor(432.9055, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3877076208591461
distance x is tensor(93.9558, device='cuda:3')
benign distance is  tensor(93.9558, device='cuda:3')
norm1 res is  tensor(387.4356, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4061525762081146
distance x is tensor(71.8177, device='cuda:3')
benign distance is  tensor(71.8177, device='cuda:3')
norm1 res is  tensor(310.2751, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6440526843070984
distance x is tensor(106.1185, device='cuda:3')
benign distance is  tensor(106.1185, device='cuda:3')
norm1 res is  tensor(450.0047, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.31424885988235474
distance x is tensor(99.0821, device='cuda:3')
benign distance is  tensor(99.0821, device='cuda:3')
norm1 res is  tensor(418.7434, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1437865048646927
distance x is tensor(88.5818, device='cuda:3')
benign distance is  tensor(88.5818, device='cuda:3')
norm1 res is  tensor(388.1330, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6085354089736938
distance x is tensor(121.5566, device='cuda:3')
benign distance is  tensor(121.5566, device='cuda:3')
norm1 res is  tensor(522.4193, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7686665654182434
distance x is tensor(113.0079, device='cuda:3')
benign distance is  tensor(113.0079, device='cuda:3')
norm1 res is  tensor(479.9906, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.103074312210083
distance x is tensor(100.6346, device='cuda:3')
benign distance is  tensor(100.6346, device='cuda:3')
norm1 res is  tensor(432.1305, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.4962759017944336
distance x is tensor(118.3234, device='cuda:3')
benign distance is  tensor(118.3234, device='cuda:3')
norm1 res is  tensor(502.0433, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.30925217270851135
distance x is tensor(108.7656, device='cuda:3')
benign distance is  tensor(108.7656, device='cuda:3')
norm1 res is  tensor(477.0615, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4386014938354492
distance x is tensor(127.3479, device='cuda:3')
benign distance is  tensor(127.3479, device='cuda:3')
norm1 res is  tensor(547.3738, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3059771955013275
distance x is tensor(104.8011, device='cuda:3')
benign distance is  tensor(104.8011, device='cuda:3')
norm1 res is  tensor(454.9375, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6368441581726074
distance x is tensor(109.7497, device='cuda:3')
benign distance is  tensor(109.7497, device='cuda:3')
norm1 res is  tensor(482.0826, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(107.0950, device='cuda:3')
compute distance is  tensor(107.0950, device='cuda:3')
compute norm is  tensor(46.3415, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.6972, device='cuda:3')
compute distance is  tensor(104.6972, device='cuda:3')
compute norm is  tensor(46.3616, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.7060, device='cuda:3')
compute distance is  tensor(118.7060, device='cuda:3')
compute norm is  tensor(46.7028, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.7128, device='cuda:3')
compute distance is  tensor(108.7128, device='cuda:3')
compute norm is  tensor(46.3651, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.0096, device='cuda:3')
compute distance is  tensor(119.0096, device='cuda:3')
compute norm is  tensor(46.6481, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.4560, device='cuda:3')
compute distance is  tensor(118.4560, device='cuda:3')
compute norm is  tensor(46.7085, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.0353, device='cuda:3')
compute distance is  tensor(109.0353, device='cuda:3')
compute norm is  tensor(46.5416, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.3114, device='cuda:3')
compute distance is  tensor(110.3114, device='cuda:3')
compute norm is  tensor(46.4744, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.9097, device='cuda:3')
compute distance is  tensor(112.9097, device='cuda:3')
compute norm is  tensor(46.3940, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.6050, device='cuda:3')
compute distance is  tensor(99.6050, device='cuda:3')
compute norm is  tensor(46.3689, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.2774, device='cuda:3')
compute distance is  tensor(114.2774, device='cuda:3')
compute norm is  tensor(46.5824, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.9053, device='cuda:3')
compute distance is  tensor(111.9053, device='cuda:3')
compute norm is  tensor(46.5263, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(119.0096, device='cuda:3')
distance x is tensor(106174.3516, device='cuda:3')
distance x is tensor(106174.3516, device='cuda:3')
________________________________
test distance is  tensor(106174.3516, device='cuda:3')
test distance1 is  tensor(106174.3516, device='cuda:3')
test similarity is  tensor(0.0310, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139303183107480.3
test entropy is  0.0
________________________________
cal ratio is  0.03281007283393034
distance x is tensor(3483.5935, device='cuda:3')
cal_distance is  tensor(3483.5935, device='cuda:3')
cal ratio is  0.18113536878982214
distance x is tensor(631.0062, device='cuda:3')
cal_distance is  tensor(631.0062, device='cuda:3')
cal ratio is  0.4255986101803078
distance x is tensor(268.5581, device='cuda:3')
cal_distance is  tensor(268.5581, device='cuda:3')
cal ratio is  0.6523757926609379
distance x is tensor(175.2026, device='cuda:3')
cal_distance is  tensor(175.2026, device='cuda:3')
cal ratio is  0.8076938007885018
distance x is tensor(141.5110, device='cuda:3')
cal_distance is  tensor(141.5110, device='cuda:3')
cal ratio is  0.8987148951331687
distance x is tensor(127.1785, device='cuda:3')
cal_distance is  tensor(127.1785, device='cuda:3')
cal ratio is  0.9480037945050742
distance x is tensor(120.5660, device='cuda:3')
cal_distance is  tensor(120.5660, device='cuda:3')
cal ratio is  0.9736537813092356
distance x is tensor(117.3897, device='cuda:3')
cal_distance is  tensor(117.3897, device='cuda:3')
distance x is tensor(117.3897, device='cuda:3')
return_distance is  tensor(117.3897, device='cuda:3')
distance x is tensor(117.3798, device='cuda:3')
distance x is tensor(117.3798, device='cuda:3')
________________________________
test distance is  tensor(117.3798, device='cuda:3')
test distance1 is  tensor(117.3798, device='cuda:3')
test similarity is  tensor(0.9591, device='cuda:3')
test acc is  0.10000000015633198
test loss is 187.16208969148747
test entropy is  2.120530845766318e-21
________________________________
0
distance x is tensor(117.3798, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.1016630532274744e-22
avg test loss is  187.1788539439122
avg accuracy is  0.4443500001563416
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9591, device='cuda:3')
compute_distance is  tensor(117.3798, device='cuda:3')
compute_norm is  tensor(46.5562, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(105.3423, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8207738904048131
avg test loss is  1.2469372248598762
avg accuracy is  0.8810333334896555
solo acc is  0.358533333489674
compute similarity  is  tensor(0.9618, device='cuda:3')
compute_distance is  tensor(105.3423, device='cuda:3')
compute_norm is  tensor(45.8344, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(106.9993, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7873279254700838
avg test loss is  1.3153258980845592
avg accuracy is  0.881050000156322
solo acc is  0.2753166668230056
compute similarity  is  tensor(0.9613, device='cuda:3')
compute_distance is  tensor(106.9993, device='cuda:3')
compute_norm is  tensor(45.5493, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(108.5188, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7895344716907818
avg test loss is  1.2832515559979338
avg accuracy is  0.8835333334896553
solo acc is  0.26705000015633873
compute similarity  is  tensor(0.9609, device='cuda:3')
compute_distance is  tensor(108.5188, device='cuda:3')
compute_norm is  tensor(45.2846, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(109.9488, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.787228865409965
avg test loss is  1.2628758068659158
avg accuracy is  0.8847333334896552
solo acc is  0.2575833334896718
compute similarity  is  tensor(0.9606, device='cuda:3')
compute_distance is  tensor(109.9488, device='cuda:3')
compute_norm is  tensor(45.0324, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(111.3967, device='cuda:3')
distance x is tensor(111.3967, device='cuda:3')
________________________________
test distance is  tensor(111.3967, device='cuda:3')
test distance1 is  tensor(111.3967, device='cuda:3')
test similarity is  tensor(0.9603, device='cuda:3')
test acc is  0.2575833334896717
test loss is 1.243768948418245
test entropy is  0.7849602284970314
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 0.9847432374954224
mal norm is  tensor(570.1591, device='cuda:3')
distance x is tensor(111.4043, device='cuda:3')
mal distance is  tensor(111.4043, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([35., 35., 35., 35., 35., 35., 35., 35., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 35., 35., 35., 35., 35., 35., 35., 35.,
        35., 35., 35., 35., 35., 35., 35., 35.])
count_res tensor([4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07,
        6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07,
        6.9590e-07, 6.9590e-07, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 90.21% 

Test Accuracy: 89.68% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3264741003513336
distance x is tensor(72.4944, device='cuda:3')
benign distance is  tensor(72.4944, device='cuda:3')
norm1 res is  tensor(323.6044, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.40427765250205994
distance x is tensor(87.9472, device='cuda:3')
benign distance is  tensor(87.9472, device='cuda:3')
norm1 res is  tensor(385.6200, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.12867814302444458
distance x is tensor(97.7586, device='cuda:3')
benign distance is  tensor(97.7586, device='cuda:3')
norm1 res is  tensor(431.8947, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.36450302600860596
distance x is tensor(81.2780, device='cuda:3')
benign distance is  tensor(81.2780, device='cuda:3')
norm1 res is  tensor(348.0939, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4137105345726013
distance x is tensor(66.0001, device='cuda:3')
benign distance is  tensor(66.0001, device='cuda:3')
norm1 res is  tensor(277.3230, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5676997900009155
distance x is tensor(93.9378, device='cuda:3')
benign distance is  tensor(93.9378, device='cuda:3')
norm1 res is  tensor(401.5343, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3207203149795532
distance x is tensor(81.2750, device='cuda:3')
benign distance is  tensor(81.2750, device='cuda:3')
norm1 res is  tensor(347.5995, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.19551610946655273
distance x is tensor(93.9862, device='cuda:3')
benign distance is  tensor(93.9862, device='cuda:3')
norm1 res is  tensor(416.8672, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.32546374201774597
distance x is tensor(112.5734, device='cuda:3')
benign distance is  tensor(112.5734, device='cuda:3')
norm1 res is  tensor(484.7936, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6328696012496948
distance x is tensor(117.0179, device='cuda:3')
benign distance is  tensor(117.0179, device='cuda:3')
norm1 res is  tensor(525.1429, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2907562553882599
distance x is tensor(104.1861, device='cuda:3')
benign distance is  tensor(104.1861, device='cuda:3')
norm1 res is  tensor(446.2231, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.1640358418226242
distance x is tensor(115.6574, device='cuda:3')
benign distance is  tensor(115.6574, device='cuda:3')
norm1 res is  tensor(498.9016, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.12173585593700409
distance x is tensor(108.6943, device='cuda:3')
benign distance is  tensor(108.6943, device='cuda:3')
norm1 res is  tensor(475.4586, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4252919554710388
distance x is tensor(102.2656, device='cuda:3')
benign distance is  tensor(102.2656, device='cuda:3')
norm1 res is  tensor(449.7038, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.295558363199234
distance x is tensor(117.6280, device='cuda:3')
benign distance is  tensor(117.6280, device='cuda:3')
norm1 res is  tensor(520.0517, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.47267311811447144
distance x is tensor(112.2716, device='cuda:3')
benign distance is  tensor(112.2716, device='cuda:3')
norm1 res is  tensor(476.5431, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.21175198256969452
distance x is tensor(112.7278, device='cuda:3')
benign distance is  tensor(112.7278, device='cuda:3')
norm1 res is  tensor(492.5063, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.07971422374248505
distance x is tensor(119.4757, device='cuda:3')
benign distance is  tensor(119.4757, device='cuda:3')
norm1 res is  tensor(523.9561, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.49200305342674255
distance x is tensor(104.8502, device='cuda:3')
benign distance is  tensor(104.8502, device='cuda:3')
norm1 res is  tensor(465.5376, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.4003501534461975
distance x is tensor(106.8427, device='cuda:3')
benign distance is  tensor(106.8427, device='cuda:3')
norm1 res is  tensor(467.4200, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.19318869709968567
distance x is tensor(112.4482, device='cuda:3')
benign distance is  tensor(112.4482, device='cuda:3')
norm1 res is  tensor(486.6780, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.4151419699192047
distance x is tensor(98.5336, device='cuda:3')
benign distance is  tensor(98.5336, device='cuda:3')
norm1 res is  tensor(434.2036, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.24014243483543396
distance x is tensor(100.8710, device='cuda:3')
benign distance is  tensor(100.8710, device='cuda:3')
norm1 res is  tensor(439.8209, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.12414141744375229
distance x is tensor(115.3412, device='cuda:3')
benign distance is  tensor(115.3412, device='cuda:3')
norm1 res is  tensor(502.0839, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(105.2637, device='cuda:3')
compute distance is  tensor(105.2637, device='cuda:3')
compute norm is  tensor(46.5328, device='cuda:3', dtype=torch.float64)
distance x is tensor(88.4762, device='cuda:3')
compute distance is  tensor(88.4762, device='cuda:3')
compute norm is  tensor(46.3173, device='cuda:3', dtype=torch.float64)
distance x is tensor(96.8680, device='cuda:3')
compute distance is  tensor(96.8680, device='cuda:3')
compute norm is  tensor(46.5581, device='cuda:3', dtype=torch.float64)
distance x is tensor(93.2668, device='cuda:3')
compute distance is  tensor(93.2668, device='cuda:3')
compute norm is  tensor(46.3439, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.1394, device='cuda:3')
compute distance is  tensor(112.1394, device='cuda:3')
compute norm is  tensor(46.8150, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.0213, device='cuda:3')
compute distance is  tensor(95.0213, device='cuda:3')
compute norm is  tensor(46.5651, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.9923, device='cuda:3')
compute distance is  tensor(99.9923, device='cuda:3')
compute norm is  tensor(46.5692, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.6249, device='cuda:3')
compute distance is  tensor(98.6249, device='cuda:3')
compute norm is  tensor(46.5358, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.9000, device='cuda:3')
compute distance is  tensor(98.9000, device='cuda:3')
compute norm is  tensor(46.4356, device='cuda:3', dtype=torch.float64)
distance x is tensor(94.9195, device='cuda:3')
compute distance is  tensor(94.9195, device='cuda:3')
compute norm is  tensor(46.4908, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.0957, device='cuda:3')
compute distance is  tensor(109.0957, device='cuda:3')
compute norm is  tensor(46.7688, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.6585, device='cuda:3')
compute distance is  tensor(107.6585, device='cuda:3')
compute norm is  tensor(46.6837, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(112.1394, device='cuda:3')
distance x is tensor(106187.0234, device='cuda:3')
distance x is tensor(106187.0234, device='cuda:3')
________________________________
test distance is  tensor(106187.0234, device='cuda:3')
test distance1 is  tensor(106187.0234, device='cuda:3')
test similarity is  tensor(-0.0310, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139261756190449.27
test entropy is  0.0
________________________________
cal ratio is  0.03184707324783896
distance x is tensor(3381.7515, device='cuda:3')
cal_distance is  tensor(3381.7515, device='cuda:3')
cal ratio is  0.17845734061721283
distance x is tensor(603.5024, device='cuda:3')
cal_distance is  tensor(603.5024, device='cuda:3')
cal ratio is  0.42244071749102335
distance x is tensor(254.9469, device='cuda:3')
cal_distance is  tensor(254.9469, device='cuda:3')
cal ratio is  0.6499507065201691
distance x is tensor(165.7046, device='cuda:3')
cal_distance is  tensor(165.7046, device='cuda:3')
cal ratio is  0.8061909774053474
distance x is tensor(133.5905, device='cuda:3')
cal_distance is  tensor(133.5905, device='cuda:3')
cal ratio is  0.897878148831902
distance x is tensor(119.9486, device='cuda:3')
cal_distance is  tensor(119.9486, device='cuda:3')
cal ratio is  0.9475622239352427
distance x is tensor(113.6590, device='cuda:3')
cal_distance is  tensor(113.6590, device='cuda:3')
cal ratio is  0.9734269009988232
distance x is tensor(110.6389, device='cuda:3')
cal_distance is  tensor(110.6389, device='cuda:3')
distance x is tensor(110.6389, device='cuda:3')
return_distance is  tensor(110.6389, device='cuda:3')
distance x is tensor(110.6290, device='cuda:3')
distance x is tensor(110.6290, device='cuda:3')
________________________________
test distance is  tensor(110.6290, device='cuda:3')
test distance1 is  tensor(110.6290, device='cuda:3')
test similarity is  tensor(0.9624, device='cuda:3')
test acc is  0.10000000015633198
test loss is 191.9448326127107
test entropy is  1.510620555532155e-23
________________________________
0
distance x is tensor(110.6290, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.8917338179651736e-23
avg test loss is  191.8550098638799
avg accuracy is  0.45698333348967507
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9624, device='cuda:3')
compute_distance is  tensor(110.6290, device='cuda:3')
compute_norm is  tensor(46.1341, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(99.7088, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7900713032750941
avg test loss is  1.3082899927838778
avg accuracy is  0.8859833334896552
solo acc is  0.32001666682300656
compute similarity  is  tensor(0.9648, device='cuda:3')
compute_distance is  tensor(99.7088, device='cuda:3')
compute_norm is  tensor(45.1908, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(101.6490, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7993690275561327
avg test loss is  1.2677268279132559
avg accuracy is  0.8873500001563219
solo acc is  0.2969833334896728
compute similarity  is  tensor(0.9643, device='cuda:3')
compute_distance is  tensor(101.6490, device='cuda:3')
compute_norm is  tensor(44.9007, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(103.3859, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7719418672737537
avg test loss is  1.3032282897150085
avg accuracy is  0.8881000001563217
solo acc is  0.2524333334896716
compute similarity  is  tensor(0.9639, device='cuda:3')
compute_distance is  tensor(103.3859, device='cuda:3')
compute_norm is  tensor(44.6366, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(105.1123, device='cuda:3')
exit early
distance x is tensor(105.1123, device='cuda:3')
distance x is tensor(105.1123, device='cuda:3')
________________________________
test distance is  tensor(105.1123, device='cuda:3')
test distance1 is  tensor(105.1123, device='cuda:3')
test similarity is  tensor(0.9635, device='cuda:3')
test acc is  0.23568333348967105
test loss is 1.3047123880528693
test entropy is  0.7631471010286417
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2281490564346313
mal norm is  tensor(542.8629, device='cuda:3')
distance x is tensor(105.1192, device='cuda:3')
mal distance is  tensor(105.1192, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([35., 35., 35., 35., 35., 35., 35., 35., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 35., 35., 35., 35., 35., 35., 35., 35.,
        35., 35., 35., 35., 35., 35., 35., 35.])
count_res tensor([4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07,
        6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07,
        6.9590e-07, 6.9590e-07, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 90.33% 

Test Accuracy: 89.56% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5183538198471069
distance x is tensor(77.9664, device='cuda:3')
benign distance is  tensor(77.9664, device='cuda:3')
norm1 res is  tensor(353.7563, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5749590396881104
distance x is tensor(90.8325, device='cuda:3')
benign distance is  tensor(90.8325, device='cuda:3')
norm1 res is  tensor(411.6844, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3429822623729706
distance x is tensor(100.4334, device='cuda:3')
benign distance is  tensor(100.4334, device='cuda:3')
norm1 res is  tensor(438.6285, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3758336305618286
distance x is tensor(80.7851, device='cuda:3')
benign distance is  tensor(80.7851, device='cuda:3')
norm1 res is  tensor(347.9356, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8839198350906372
distance x is tensor(77.8340, device='cuda:3')
benign distance is  tensor(77.8340, device='cuda:3')
norm1 res is  tensor(337.2521, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.41611915826797485
distance x is tensor(93.7133, device='cuda:3')
benign distance is  tensor(93.7133, device='cuda:3')
norm1 res is  tensor(410.2519, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.25083035230636597
distance x is tensor(80.5941, device='cuda:3')
benign distance is  tensor(80.5941, device='cuda:3')
norm1 res is  tensor(346.5351, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.39125847816467285
distance x is tensor(87.1309, device='cuda:3')
benign distance is  tensor(87.1309, device='cuda:3')
norm1 res is  tensor(391.8044, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.39882051944732666
distance x is tensor(103.7558, device='cuda:3')
benign distance is  tensor(103.7558, device='cuda:3')
norm1 res is  tensor(465.5528, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.3764485716819763
distance x is tensor(119.5323, device='cuda:3')
benign distance is  tensor(119.5323, device='cuda:3')
norm1 res is  tensor(515.0764, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4572434425354004
distance x is tensor(102.4085, device='cuda:3')
benign distance is  tensor(102.4085, device='cuda:3')
norm1 res is  tensor(442.6941, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4026643633842468
distance x is tensor(110.1815, device='cuda:3')
benign distance is  tensor(110.1815, device='cuda:3')
norm1 res is  tensor(480.1408, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7844191789627075
distance x is tensor(108.1802, device='cuda:3')
benign distance is  tensor(108.1802, device='cuda:3')
norm1 res is  tensor(491.7424, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.2071141004562378
distance x is tensor(118.2981, device='cuda:3')
benign distance is  tensor(118.2981, device='cuda:3')
norm1 res is  tensor(513.6860, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.920117974281311
distance x is tensor(107.5784, device='cuda:3')
benign distance is  tensor(107.5784, device='cuda:3')
norm1 res is  tensor(482.0210, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0129247903823853
distance x is tensor(110.8087, device='cuda:3')
benign distance is  tensor(110.8087, device='cuda:3')
norm1 res is  tensor(485.3637, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.27924585342407227
distance x is tensor(128.6686, device='cuda:3')
benign distance is  tensor(128.6686, device='cuda:3')
norm1 res is  tensor(569.4837, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.3905503451824188
distance x is tensor(105.1051, device='cuda:3')
benign distance is  tensor(105.1051, device='cuda:3')
norm1 res is  tensor(447.5806, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.318769633769989
distance x is tensor(113.3529, device='cuda:3')
benign distance is  tensor(113.3529, device='cuda:3')
norm1 res is  tensor(494.5666, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4216488301753998
distance x is tensor(107.5970, device='cuda:3')
benign distance is  tensor(107.5970, device='cuda:3')
norm1 res is  tensor(469.3808, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8033255338668823
distance x is tensor(99.5912, device='cuda:3')
benign distance is  tensor(99.5912, device='cuda:3')
norm1 res is  tensor(438.6302, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.17078538239002228
distance x is tensor(108.0122, device='cuda:3')
benign distance is  tensor(108.0122, device='cuda:3')
norm1 res is  tensor(476.4679, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.4625619351863861
distance x is tensor(104.8867, device='cuda:3')
benign distance is  tensor(104.8867, device='cuda:3')
norm1 res is  tensor(469.3769, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.44437456130981445
distance x is tensor(114.0029, device='cuda:3')
benign distance is  tensor(114.0029, device='cuda:3')
norm1 res is  tensor(513.9194, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(96.4435, device='cuda:3')
compute distance is  tensor(96.4435, device='cuda:3')
compute norm is  tensor(46.6278, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.5065, device='cuda:3')
compute distance is  tensor(104.5065, device='cuda:3')
compute norm is  tensor(46.8286, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.5456, device='cuda:3')
compute distance is  tensor(114.5456, device='cuda:3')
compute norm is  tensor(46.9882, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.1116, device='cuda:3')
compute distance is  tensor(95.1116, device='cuda:3')
compute norm is  tensor(46.5782, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.6863, device='cuda:3')
compute distance is  tensor(104.6863, device='cuda:3')
compute norm is  tensor(46.7325, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.2165, device='cuda:3')
compute distance is  tensor(113.2165, device='cuda:3')
compute norm is  tensor(46.9915, device='cuda:3', dtype=torch.float64)
distance x is tensor(93.9869, device='cuda:3')
compute distance is  tensor(93.9869, device='cuda:3')
compute norm is  tensor(46.5613, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.3217, device='cuda:3')
compute distance is  tensor(101.3217, device='cuda:3')
compute norm is  tensor(46.7035, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.5159, device='cuda:3')
compute distance is  tensor(112.5159, device='cuda:3')
compute norm is  tensor(46.8487, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.7536, device='cuda:3')
compute distance is  tensor(101.7536, device='cuda:3')
compute norm is  tensor(46.8731, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.3746, device='cuda:3')
compute distance is  tensor(107.3746, device='cuda:3')
compute norm is  tensor(46.9187, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.7632, device='cuda:3')
compute distance is  tensor(108.7632, device='cuda:3')
compute norm is  tensor(46.7820, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(114.5456, device='cuda:3')
distance x is tensor(106185.5625, device='cuda:3')
distance x is tensor(106185.5625, device='cuda:3')
________________________________
test distance is  tensor(106185.5625, device='cuda:3')
test distance1 is  tensor(106185.5625, device='cuda:3')
test similarity is  tensor(-0.0203, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139284372181681.94
test entropy is  0.0
________________________________
cal ratio is  0.032187149788255646
distance x is tensor(3417.8162, device='cuda:3')
cal_distance is  tensor(3417.8162, device='cuda:3')
cal ratio is  0.17940763662164866
distance x is tensor(613.1863, device='cuda:3')
cal_distance is  tensor(613.1863, device='cuda:3')
cal ratio is  0.4235639953083101
distance x is tensor(259.7265, device='cuda:3')
cal_distance is  tensor(259.7265, device='cuda:3')
cal ratio is  0.6508143450231766
distance x is tensor(169.0355, device='cuda:3')
cal_distance is  tensor(169.0355, device='cuda:3')
cal ratio is  0.8067265388900376
distance x is tensor(136.3664, device='cuda:3')
cal_distance is  tensor(136.3664, device='cuda:3')
cal ratio is  0.898176313751472
distance x is tensor(122.4816, device='cuda:3')
cal_distance is  tensor(122.4816, device='cuda:3')
cal ratio is  0.9477196148021798
distance x is tensor(116.0785, device='cuda:3')
cal_distance is  tensor(116.0785, device='cuda:3')
cal ratio is  0.9735078160467386
distance x is tensor(113.0034, device='cuda:3')
cal_distance is  tensor(113.0034, device='cuda:3')
distance x is tensor(113.0034, device='cuda:3')
return_distance is  tensor(113.0034, device='cuda:3')
distance x is tensor(112.9935, device='cuda:3')
distance x is tensor(112.9935, device='cuda:3')
________________________________
test distance is  tensor(112.9935, device='cuda:3')
test distance1 is  tensor(112.9935, device='cuda:3')
test similarity is  tensor(0.9613, device='cuda:3')
test acc is  0.10000000015633198
test loss is 190.61382544218606
test entropy is  6.986075208667833e-23
________________________________
0
distance x is tensor(112.9935, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.1205481209501672e-23
avg test loss is  190.60721335990596
avg accuracy is  0.4806000001563419
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9613, device='cuda:3')
compute_distance is  tensor(112.9935, device='cuda:3')
compute_norm is  tensor(46.4451, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(102.0707, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7906976820055102
avg test loss is  1.31401216157718
avg accuracy is  0.8866833334896552
solo acc is  0.3172000001563398
compute similarity  is  tensor(0.9638, device='cuda:3')
compute_distance is  tensor(102.0707, device='cuda:3')
compute_norm is  tensor(45.5582, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(103.9288, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.746303095555763
avg test loss is  1.408235785168117
avg accuracy is  0.8883500001563218
solo acc is  0.2307166668230043
compute similarity  is  tensor(0.9633, device='cuda:3')
compute_distance is  tensor(103.9288, device='cuda:3')
compute_norm is  tensor(45.2650, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(105.4771, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7626253270518297
avg test loss is  1.322658525474036
avg accuracy is  0.8894000001563218
solo acc is  0.24873333348967155
compute similarity  is  tensor(0.9629, device='cuda:3')
compute_distance is  tensor(105.4771, device='cuda:3')
compute_norm is  tensor(44.9989, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(107.0619, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7799909295939179
avg test loss is  1.2634940078771952
avg accuracy is  0.8907666668229883
solo acc is  0.25953333348967184
compute similarity  is  tensor(0.9626, device='cuda:3')
compute_distance is  tensor(107.0619, device='cuda:3')
compute_norm is  tensor(44.7455, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(108.6057, device='cuda:3')
distance x is tensor(108.6057, device='cuda:3')
________________________________
test distance is  tensor(108.6057, device='cuda:3')
test distance1 is  tensor(108.6057, device='cuda:3')
test similarity is  tensor(0.9623, device='cuda:3')
test acc is  0.2686833334896721
test loss is 1.217916327816591
test entropy is  0.7926303287431884
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.097734808921814
mal norm is  tensor(554.4109, device='cuda:3')
distance x is tensor(108.6127, device='cuda:3')
mal distance is  tensor(108.6127, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([19., 19., 19., 19., 19., 19., 19., 19., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0669,
        0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669,
        0.0669, 0.0669])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 83.03% 

Test Accuracy: 82.04% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2830010652542114
distance x is tensor(119.3296, device='cuda:3')
benign distance is  tensor(119.3296, device='cuda:3')
norm1 res is  tensor(485.7125, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8401098251342773
distance x is tensor(134.7374, device='cuda:3')
benign distance is  tensor(134.7374, device='cuda:3')
norm1 res is  tensor(550.4710, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1471802294254303
distance x is tensor(131.9111, device='cuda:3')
benign distance is  tensor(131.9111, device='cuda:3')
norm1 res is  tensor(543.1016, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7242131233215332
distance x is tensor(144.6662, device='cuda:3')
benign distance is  tensor(144.6662, device='cuda:3')
norm1 res is  tensor(574.0562, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5563617944717407
distance x is tensor(129.5218, device='cuda:3')
benign distance is  tensor(129.5218, device='cuda:3')
norm1 res is  tensor(513.5586, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5080152750015259
distance x is tensor(149.9490, device='cuda:3')
benign distance is  tensor(149.9490, device='cuda:3')
norm1 res is  tensor(601.6985, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2364959716796875
distance x is tensor(122.3534, device='cuda:3')
benign distance is  tensor(122.3534, device='cuda:3')
norm1 res is  tensor(495.4815, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2865118384361267
distance x is tensor(139.7198, device='cuda:3')
benign distance is  tensor(139.7198, device='cuda:3')
norm1 res is  tensor(562.8896, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(129.7819, device='cuda:3')
compute distance is  tensor(129.7819, device='cuda:3')
compute norm is  tensor(46.3152, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.3471, device='cuda:3')
compute distance is  tensor(137.3471, device='cuda:3')
compute norm is  tensor(46.4236, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.0332, device='cuda:3')
compute distance is  tensor(148.0332, device='cuda:3')
compute norm is  tensor(46.8142, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.7283, device='cuda:3')
compute distance is  tensor(144.7283, device='cuda:3')
compute norm is  tensor(46.6558, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.9157, device='cuda:3')
compute distance is  tensor(157.9157, device='cuda:3')
compute norm is  tensor(46.7693, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.0490, device='cuda:3')
compute distance is  tensor(156.0490, device='cuda:3')
compute norm is  tensor(47.0375, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.6967, device='cuda:3')
compute distance is  tensor(134.6967, device='cuda:3')
compute norm is  tensor(46.3913, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.7402, device='cuda:3')
compute distance is  tensor(136.7402, device='cuda:3')
compute norm is  tensor(46.5917, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.5218, device='cuda:3')
compute distance is  tensor(146.5218, device='cuda:3')
compute norm is  tensor(46.5972, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.4722, device='cuda:3')
compute distance is  tensor(147.4722, device='cuda:3')
compute norm is  tensor(46.7304, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.5951, device='cuda:3')
compute distance is  tensor(155.5951, device='cuda:3')
compute norm is  tensor(46.9010, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.2234, device='cuda:3')
compute distance is  tensor(140.2234, device='cuda:3')
compute norm is  tensor(46.5179, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(157.9157, device='cuda:3')
distance x is tensor(106129.7812, device='cuda:3')
distance x is tensor(106129.7812, device='cuda:3')
________________________________
test distance is  tensor(106129.7812, device='cuda:3')
test distance1 is  tensor(106129.7812, device='cuda:3')
test similarity is  tensor(0.1729, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139296192168564.81
test entropy is  0.0
________________________________
cal ratio is  0.03780246819028212
distance x is tensor(4011.9727, device='cuda:3')
cal_distance is  tensor(4011.9727, device='cuda:3')
cal ratio is  0.19442844171370569
distance x is tensor(780.0456, device='cuda:3')
cal_distance is  tensor(780.0456, device='cuda:3')
cal ratio is  0.44093927986629294
distance x is tensor(343.9555, device='cuda:3')
cal_distance is  tensor(343.9555, device='cuda:3')
cal ratio is  0.6640298974594595
distance x is tensor(228.3984, device='cuda:3')
cal_distance is  tensor(228.3984, device='cuda:3')
cal ratio is  0.8148773017478627
distance x is tensor(186.1176, device='cuda:3')
cal_distance is  tensor(186.1176, device='cuda:3')
cal ratio is  0.9027033024074069
distance x is tensor(168.0095, device='cuda:3')
cal_distance is  tensor(168.0095, device='cuda:3')
cal ratio is  0.9501056369976026
distance x is tensor(159.6270, device='cuda:3')
cal_distance is  tensor(159.6270, device='cuda:3')
cal ratio is  0.9747328338036056
distance x is tensor(155.5938, device='cuda:3')
cal_distance is  tensor(155.5938, device='cuda:3')
distance x is tensor(155.5938, device='cuda:3')
return_distance is  tensor(155.5938, device='cuda:3')
distance x is tensor(155.5839, device='cuda:3')
distance x is tensor(155.5839, device='cuda:3')
________________________________
test distance is  tensor(155.5839, device='cuda:3')
test distance1 is  tensor(155.5839, device='cuda:3')
test similarity is  tensor(0.9388, device='cuda:3')
test acc is  0.10000000015633198
test loss is 711.8693563953392
test entropy is  0.0
________________________________
0
distance x is tensor(155.5839, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  711.929042791761
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9388, device='cuda:3')
compute_distance is  tensor(155.5839, device='cuda:3')
compute_norm is  tensor(48.3312, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(257.7383, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5594960681156818
avg test loss is  2.851509795005896
avg accuracy is  0.10023333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8956, device='cuda:3')
compute_distance is  tensor(257.7383, device='cuda:3')
compute_norm is  tensor(52.4930, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(257.5725, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8380638779099308
avg test loss is  3.5826877475039027
avg accuracy is  0.1009833334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8947, device='cuda:3')
compute_distance is  tensor(257.5725, device='cuda:3')
compute_norm is  tensor(52.6220, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(256.4188, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5536768338573512
avg test loss is  2.8520989003720314
avg accuracy is  0.09956666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8955, device='cuda:3')
compute_distance is  tensor(256.4188, device='cuda:3')
compute_norm is  tensor(52.0131, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(256.3303, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8381094190993035
avg test loss is  3.579618600131606
avg accuracy is  0.1008333334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8946, device='cuda:3')
compute_distance is  tensor(256.3303, device='cuda:3')
compute_norm is  tensor(52.1473, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(255.2379, device='cuda:3')
distance x is tensor(255.2379, device='cuda:3')
________________________________
test distance is  tensor(255.2379, device='cuda:3')
test distance1 is  tensor(255.2379, device='cuda:3')
test similarity is  tensor(0.8954, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8519648283021026
test entropy is  1.5535523365301365
________________________________
cal ratio is  0.7708435590959284
distance x is tensor(196.7521, device='cuda:3')
cal_distance is  tensor(196.7521, device='cuda:3')
cal ratio is  0.8779687600611876
distance x is tensor(172.7425, device='cuda:3')
cal_distance is  tensor(172.7425, device='cuda:3')
cal ratio is  0.9369991490747991
distance x is tensor(161.8597, device='cuda:3')
cal_distance is  tensor(161.8597, device='cuda:3')
cal ratio is  0.9679868142549117
distance x is tensor(156.6781, device='cuda:3')
cal_distance is  tensor(156.6781, device='cuda:3')
distance x is tensor(156.6781, device='cuda:3')
return_distance is  tensor(156.6781, device='cuda:3')
distance x is tensor(156.6740, device='cuda:3')
distance x is tensor(156.6740, device='cuda:3')
________________________________
test distance is  tensor(156.6740, device='cuda:3')
test distance1 is  tensor(156.6740, device='cuda:3')
test similarity is  tensor(0.9552, device='cuda:3')
test acc is  0.10020000015633199
test loss is 2.4604521837315834
test entropy is  2.132776002385723
________________________________
0
distance x is tensor(156.6740, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.1327725648880005
avg test loss is  2.4604459045284086
avg accuracy is  0.1234166668229986
solo acc is  0.10018333348966532
compute similarity  is  tensor(0.9552, device='cuda:3')
compute_distance is  tensor(156.6740, device='cuda:3')
compute_norm is  tensor(47.4738, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(158.0849, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8530427589218246
avg test loss is  3.563020881305117
avg accuracy is  0.1155666668229986
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9527, device='cuda:3')
compute_distance is  tensor(158.0849, device='cuda:3')
compute_norm is  tensor(47.8908, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(157.3889, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5528147037603708
avg test loss is  2.848146651599453
avg accuracy is  0.14591666682299953
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.9537, device='cuda:3')
compute_distance is  tensor(157.3889, device='cuda:3')
compute_norm is  tensor(47.3225, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(157.9737, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8345854403748949
avg test loss is  3.57910139270937
avg accuracy is  0.11786666682299861
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9525, device='cuda:3')
compute_distance is  tensor(157.9737, device='cuda:3')
compute_norm is  tensor(47.4632, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(158.4065, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.3502804691603443
avg test loss is  2.415108975316924
avg accuracy is  0.15146666682299992
solo acc is  0.12896666682299857
compute similarity  is  tensor(0.9539, device='cuda:3')
compute_distance is  tensor(158.4065, device='cuda:3')
compute_norm is  tensor(46.9649, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(159.7639, device='cuda:3')
distance x is tensor(159.7639, device='cuda:3')
________________________________
test distance is  tensor(159.7639, device='cuda:3')
test distance1 is  tensor(159.7639, device='cuda:3')
test similarity is  tensor(0.9531, device='cuda:3')
test acc is  0.10086666682299864
test loss is 2.9669295935742634
test entropy is  0.74201888062044
________________________________
cal ratio is  0.9743151574785899
distance x is tensor(155.6639, device='cuda:3')
cal_distance is  tensor(155.6639, device='cuda:3')
distance x is tensor(155.6639, device='cuda:3')
return_distance is  tensor(155.6639, device='cuda:3')
distance x is tensor(155.6604, device='cuda:3')
distance x is tensor(155.6604, device='cuda:3')
________________________________
test distance is  tensor(155.6604, device='cuda:3')
test distance1 is  tensor(155.6604, device='cuda:3')
test similarity is  tensor(0.9553, device='cuda:3')
test acc is  0.10075000015633197
test loss is 2.8941199868472656
test entropy is  0.8046093546251244
________________________________
0
distance x is tensor(155.6604, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.804414981336736
avg test loss is  2.8908113861388998
avg accuracy is  0.1288500001563319
solo acc is  0.10076666682299863
compute similarity  is  tensor(0.9553, device='cuda:3')
compute_distance is  tensor(155.6604, device='cuda:3')
compute_norm is  tensor(46.8273, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(158.2681, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0481277713770552
avg test loss is  1.913149011287608
avg accuracy is  0.16973333348966796
solo acc is  0.18340000015633548
compute similarity  is  tensor(0.9555, device='cuda:3')
compute_distance is  tensor(158.2681, device='cuda:3')
compute_norm is  tensor(46.4462, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(159.1211, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.630057654464677
avg test loss is  2.6264002063889493
avg accuracy is  0.13883333348966548
solo acc is  0.10110000015633197
compute similarity  is  tensor(0.9550, device='cuda:3')
compute_distance is  tensor(159.1211, device='cuda:3')
compute_norm is  tensor(46.3201, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(160.9127, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9973235561776517
avg test loss is  1.689553413563954
avg accuracy is  0.17885000015633526
solo acc is  0.20311666682300314
compute similarity  is  tensor(0.9548, device='cuda:3')
compute_distance is  tensor(160.9127, device='cuda:3')
compute_norm is  tensor(46.0026, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(160.9159, device='cuda:3')
________________________________
test distance is  tensor(160.9159, device='cuda:3')
test similarity is  tensor(0.9548, device='cuda:3')
test acc is  0.1782333334896685
test loss is 1.6900986140724947
test entropy is  0.9995661287038311
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.3284118175506592
mal norm is  tensor(614.9759, device='cuda:3')
distance x is tensor(160.9159, device='cuda:3')
mal distance is  tensor(160.9159, device='cuda:3')
user_PLR len size 44
counter_tensor is  tensor([43., 43., 43., 43., 43., 43., 43., 43., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 43., 43., 43., 43., 43., 43., 43., 43.,
        43., 43., 43., 43., 43., 43., 43., 43., 43., 43., 43., 43., 43., 43.,
        43., 43.])
count_res tensor([3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02, 5.2192e-07, 5.2192e-07, 5.2192e-07, 5.2192e-07,
        5.2192e-07, 5.2192e-07, 5.2192e-07, 5.2192e-07, 5.2192e-07, 5.2192e-07,
        5.2192e-07, 5.2192e-07, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 90.37% 

Test Accuracy: 89.63% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.45993027091026306
distance x is tensor(71.7920, device='cuda:3')
benign distance is  tensor(71.7920, device='cuda:3')
norm1 res is  tensor(325.9532, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.45420899987220764
distance x is tensor(98.2782, device='cuda:3')
benign distance is  tensor(98.2782, device='cuda:3')
norm1 res is  tensor(416.9476, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.06623697280883789
distance x is tensor(102.9547, device='cuda:3')
benign distance is  tensor(102.9547, device='cuda:3')
norm1 res is  tensor(449.6277, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5272136926651001
distance x is tensor(95.5603, device='cuda:3')
benign distance is  tensor(95.5603, device='cuda:3')
norm1 res is  tensor(417.5196, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4137032628059387
distance x is tensor(84.8087, device='cuda:3')
benign distance is  tensor(84.8087, device='cuda:3')
norm1 res is  tensor(362.3568, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5230532288551331
distance x is tensor(93.6022, device='cuda:3')
benign distance is  tensor(93.6022, device='cuda:3')
norm1 res is  tensor(404.5479, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.169287770986557
distance x is tensor(86.2724, device='cuda:3')
benign distance is  tensor(86.2724, device='cuda:3')
norm1 res is  tensor(365.2318, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.17128516733646393
distance x is tensor(94.3260, device='cuda:3')
benign distance is  tensor(94.3260, device='cuda:3')
norm1 res is  tensor(415.5190, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.31953635811805725
distance x is tensor(115.4806, device='cuda:3')
benign distance is  tensor(115.4806, device='cuda:3')
norm1 res is  tensor(497.4730, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.28479117155075073
distance x is tensor(119.1612, device='cuda:3')
benign distance is  tensor(119.1612, device='cuda:3')
norm1 res is  tensor(526.1708, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7371852993965149
distance x is tensor(100.0232, device='cuda:3')
benign distance is  tensor(100.0232, device='cuda:3')
norm1 res is  tensor(441.5700, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9016782641410828
distance x is tensor(111.9488, device='cuda:3')
benign distance is  tensor(111.9488, device='cuda:3')
norm1 res is  tensor(491.2596, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6749189496040344
distance x is tensor(104.9666, device='cuda:3')
benign distance is  tensor(104.9666, device='cuda:3')
norm1 res is  tensor(455.5302, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.06645159423351288
distance x is tensor(108.7046, device='cuda:3')
benign distance is  tensor(108.7046, device='cuda:3')
norm1 res is  tensor(469.1970, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.460050493478775
distance x is tensor(110.4496, device='cuda:3')
benign distance is  tensor(110.4496, device='cuda:3')
norm1 res is  tensor(494.9072, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9890537261962891
distance x is tensor(123.0892, device='cuda:3')
benign distance is  tensor(123.0892, device='cuda:3')
norm1 res is  tensor(530.2798, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5276190042495728
distance x is tensor(120.7756, device='cuda:3')
benign distance is  tensor(120.7756, device='cuda:3')
norm1 res is  tensor(526.0500, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5182250738143921
distance x is tensor(122.3315, device='cuda:3')
benign distance is  tensor(122.3315, device='cuda:3')
norm1 res is  tensor(533.7578, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2676503658294678
distance x is tensor(103.6389, device='cuda:3')
benign distance is  tensor(103.6389, device='cuda:3')
norm1 res is  tensor(455.6532, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2211715430021286
distance x is tensor(106.6545, device='cuda:3')
benign distance is  tensor(106.6545, device='cuda:3')
norm1 res is  tensor(464.4526, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.05467033386230469
distance x is tensor(113.5103, device='cuda:3')
benign distance is  tensor(113.5103, device='cuda:3')
norm1 res is  tensor(493.0336, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8300378918647766
distance x is tensor(115.5128, device='cuda:3')
benign distance is  tensor(115.5128, device='cuda:3')
norm1 res is  tensor(489.9281, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3646973967552185
distance x is tensor(108.6283, device='cuda:3')
benign distance is  tensor(108.6283, device='cuda:3')
norm1 res is  tensor(481.3091, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5241649746894836
distance x is tensor(110.5096, device='cuda:3')
benign distance is  tensor(110.5096, device='cuda:3')
norm1 res is  tensor(466.2544, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.12230255454778671
distance x is tensor(112.0041, device='cuda:3')
benign distance is  tensor(112.0041, device='cuda:3')
norm1 res is  tensor(491.4676, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.2682850956916809
distance x is tensor(110.3628, device='cuda:3')
benign distance is  tensor(110.3628, device='cuda:3')
norm1 res is  tensor(468.9629, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.7334528565406799
distance x is tensor(112.5834, device='cuda:3')
benign distance is  tensor(112.5834, device='cuda:3')
norm1 res is  tensor(497.8029, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.44947633147239685
distance x is tensor(119.5617, device='cuda:3')
benign distance is  tensor(119.5617, device='cuda:3')
norm1 res is  tensor(513.0758, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.27305176854133606
distance x is tensor(101.3243, device='cuda:3')
benign distance is  tensor(101.3243, device='cuda:3')
norm1 res is  tensor(448.1937, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6509519219398499
distance x is tensor(108.7198, device='cuda:3')
benign distance is  tensor(108.7198, device='cuda:3')
norm1 res is  tensor(475.7811, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.41372770071029663
distance x is tensor(126.1938, device='cuda:3')
benign distance is  tensor(126.1938, device='cuda:3')
norm1 res is  tensor(539.8694, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.46476730704307556
distance x is tensor(118.2281, device='cuda:3')
benign distance is  tensor(118.2281, device='cuda:3')
norm1 res is  tensor(520.6446, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(99.5812, device='cuda:3')
compute distance is  tensor(99.5812, device='cuda:3')
compute norm is  tensor(46.5132, device='cuda:3', dtype=torch.float64)
distance x is tensor(94.0374, device='cuda:3')
compute distance is  tensor(94.0374, device='cuda:3')
compute norm is  tensor(46.5554, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.0014, device='cuda:3')
compute distance is  tensor(123.0014, device='cuda:3')
compute norm is  tensor(47.1967, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.0558, device='cuda:3')
compute distance is  tensor(117.0558, device='cuda:3')
compute norm is  tensor(46.9019, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.5695, device='cuda:3')
compute distance is  tensor(111.5695, device='cuda:3')
compute norm is  tensor(46.8469, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.2369, device='cuda:3')
compute distance is  tensor(112.2369, device='cuda:3')
compute norm is  tensor(46.8163, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.1383, device='cuda:3')
compute distance is  tensor(99.1383, device='cuda:3')
compute norm is  tensor(46.6256, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.2173, device='cuda:3')
compute distance is  tensor(112.2173, device='cuda:3')
compute norm is  tensor(46.8694, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.6639, device='cuda:3')
compute distance is  tensor(113.6639, device='cuda:3')
compute norm is  tensor(46.7601, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.0352, device='cuda:3')
compute distance is  tensor(102.0352, device='cuda:3')
compute norm is  tensor(46.7274, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.1896, device='cuda:3')
compute distance is  tensor(111.1896, device='cuda:3')
compute norm is  tensor(46.8585, device='cuda:3', dtype=torch.float64)
distance x is tensor(97.7156, device='cuda:3')
compute distance is  tensor(97.7156, device='cuda:3')
compute norm is  tensor(46.5982, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(123.0014, device='cuda:3')
distance x is tensor(106180.1094, device='cuda:3')
distance x is tensor(106180.1094, device='cuda:3')
________________________________
test distance is  tensor(106180.1094, device='cuda:3')
test distance1 is  tensor(106180.1094, device='cuda:3')
test similarity is  tensor(0.0051, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139294425132435.92
test entropy is  0.0
________________________________
cal ratio is  0.03335489673436183
distance x is tensor(3541.6316, device='cuda:3')
cal_distance is  tensor(3541.6316, device='cuda:3')
cal ratio is  0.18263309677509199
distance x is tensor(646.8232, device='cuda:3')
cal_distance is  tensor(646.8232, device='cuda:3')
cal ratio is  0.42735460662998914
distance x is tensor(276.4257, device='cuda:3')
cal_distance is  tensor(276.4257, device='cuda:3')
cal ratio is  0.6537202773531083
distance x is tensor(180.7068, device='cuda:3')
cal_distance is  tensor(180.7068, device='cuda:3')
cal ratio is  0.8085258554601473
distance x is tensor(146.1071, device='cuda:3')
cal_distance is  tensor(146.1071, device='cuda:3')
cal ratio is  0.8991777165228606
distance x is tensor(131.3768, device='cuda:3')
cal_distance is  tensor(131.3768, device='cuda:3')
cal ratio is  0.9482479561281592
distance x is tensor(124.5780, device='cuda:3')
cal_distance is  tensor(124.5780, device='cuda:3')
cal ratio is  0.973779208696441
distance x is tensor(121.3116, device='cuda:3')
cal_distance is  tensor(121.3116, device='cuda:3')
distance x is tensor(121.3116, device='cuda:3')
return_distance is  tensor(121.3116, device='cuda:3')
distance x is tensor(121.3017, device='cuda:3')
distance x is tensor(121.3017, device='cuda:3')
________________________________
test distance is  tensor(121.3017, device='cuda:3')
test distance1 is  tensor(121.3017, device='cuda:3')
test similarity is  tensor(0.9563, device='cuda:3')
test acc is  0.10000000015633198
test loss is 227.53739722603675
test entropy is  1.0378635165001395e-25
________________________________
0
distance x is tensor(121.3017, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.1118212396142717e-25
avg test loss is  227.48880714139958
avg accuracy is  0.3336166668230068
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9563, device='cuda:3')
compute_distance is  tensor(121.3017, device='cuda:3')
compute_norm is  tensor(46.7561, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(107.8520, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8182189379419599
avg test loss is  1.2726409842591804
avg accuracy is  0.880750000156322
solo acc is  0.34375000015634033
compute similarity  is  tensor(0.9597, device='cuda:3')
compute_distance is  tensor(107.8520, device='cuda:3')
compute_norm is  tensor(45.9866, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(109.4475, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8062991441439972
avg test loss is  1.266660918432004
avg accuracy is  0.8832166668229887
solo acc is  0.30246666682300627
compute similarity  is  tensor(0.9593, device='cuda:3')
compute_distance is  tensor(109.4475, device='cuda:3')
compute_norm is  tensor(45.6975, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(110.9363, device='cuda:3')
exit early
distance x is tensor(110.9363, device='cuda:3')
distance x is tensor(110.9363, device='cuda:3')
________________________________
test distance is  tensor(110.9363, device='cuda:3')
test distance1 is  tensor(110.9363, device='cuda:3')
test similarity is  tensor(0.9589, device='cuda:3')
test acc is  0.2803166668230057
test loss is 1.2678332750095742
test entropy is  0.7923365298237628
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2060054540634155
mal norm is  tensor(585.2850, device='cuda:3')
distance x is tensor(110.9438, device='cuda:3')
mal distance is  tensor(110.9438, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([19., 19., 19., 19., 19., 19., 19., 19., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0669,
        0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669,
        0.0669, 0.0669])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 80.14% 

Test Accuracy: 79.19% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7287005186080933
distance x is tensor(138.8933, device='cuda:3')
benign distance is  tensor(138.8933, device='cuda:3')
norm1 res is  tensor(567.5470, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.37006810307502747
distance x is tensor(144.0575, device='cuda:3')
benign distance is  tensor(144.0575, device='cuda:3')
norm1 res is  tensor(569.8822, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5553907752037048
distance x is tensor(150.5356, device='cuda:3')
benign distance is  tensor(150.5356, device='cuda:3')
norm1 res is  tensor(592.3713, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4774681031703949
distance x is tensor(145.6965, device='cuda:3')
benign distance is  tensor(145.6965, device='cuda:3')
norm1 res is  tensor(585.9768, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7437330484390259
distance x is tensor(150.2871, device='cuda:3')
benign distance is  tensor(150.2871, device='cuda:3')
norm1 res is  tensor(594.5886, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6070855259895325
distance x is tensor(153.4042, device='cuda:3')
benign distance is  tensor(153.4042, device='cuda:3')
norm1 res is  tensor(613.7292, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7386628985404968
distance x is tensor(136.7996, device='cuda:3')
benign distance is  tensor(136.7996, device='cuda:3')
norm1 res is  tensor(544.5079, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4352831244468689
distance x is tensor(150.9477, device='cuda:3')
benign distance is  tensor(150.9477, device='cuda:3')
norm1 res is  tensor(600.5948, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(137.2106, device='cuda:3')
compute distance is  tensor(137.2106, device='cuda:3')
compute norm is  tensor(47.0822, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.9003, device='cuda:3')
compute distance is  tensor(127.9003, device='cuda:3')
compute norm is  tensor(46.9094, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.3075, device='cuda:3')
compute distance is  tensor(138.3075, device='cuda:3')
compute norm is  tensor(47.2198, device='cuda:3', dtype=torch.float64)
distance x is tensor(163.2608, device='cuda:3')
compute distance is  tensor(163.2608, device='cuda:3')
compute norm is  tensor(47.7327, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.3391, device='cuda:3')
compute distance is  tensor(155.3391, device='cuda:3')
compute norm is  tensor(47.4949, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.6881, device='cuda:3')
compute distance is  tensor(147.6881, device='cuda:3')
compute norm is  tensor(47.3707, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.3409, device='cuda:3')
compute distance is  tensor(138.3409, device='cuda:3')
compute norm is  tensor(47.3594, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.1436, device='cuda:3')
compute distance is  tensor(142.1436, device='cuda:3')
compute norm is  tensor(47.3581, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.1558, device='cuda:3')
compute distance is  tensor(153.1558, device='cuda:3')
compute norm is  tensor(47.3280, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.9198, device='cuda:3')
compute distance is  tensor(158.9198, device='cuda:3')
compute norm is  tensor(47.5370, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.9982, device='cuda:3')
compute distance is  tensor(138.9982, device='cuda:3')
compute norm is  tensor(47.2724, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.8354, device='cuda:3')
compute distance is  tensor(146.8354, device='cuda:3')
compute norm is  tensor(47.2719, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(163.2608, device='cuda:3')
distance x is tensor(106119.6484, device='cuda:3')
distance x is tensor(106119.6484, device='cuda:3')
________________________________
test distance is  tensor(106119.6484, device='cuda:3')
test distance1 is  tensor(106119.6484, device='cuda:3')
test similarity is  tensor(0.2113, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139305464531620.84
test entropy is  0.0
________________________________
cal ratio is  0.03843873923569977
distance x is tensor(4079.1108, device='cuda:3')
cal_distance is  tensor(4079.1108, device='cuda:3')
cal ratio is  0.1960578724537269
distance x is tensor(799.7457, device='cuda:3')
cal_distance is  tensor(799.7457, device='cuda:3')
cal ratio is  0.44278315444871647
distance x is tensor(354.1166, device='cuda:3')
cal_distance is  tensor(354.1166, device='cuda:3')
cal ratio is  0.6654169700309748
distance x is tensor(235.6369, device='cuda:3')
cal_distance is  tensor(235.6369, device='cuda:3')
cal ratio is  0.8157280645475483
distance x is tensor(192.2166, device='cuda:3')
cal_distance is  tensor(192.2166, device='cuda:3')
cal ratio is  0.9031744111611868
distance x is tensor(173.6055, device='cuda:3')
cal_distance is  tensor(173.6055, device='cuda:3')
cal ratio is  0.9503536557659763
distance x is tensor(164.9869, device='cuda:3')
cal_distance is  tensor(164.9869, device='cuda:3')
cal ratio is  0.9748600601370214
distance x is tensor(160.8393, device='cuda:3')
cal_distance is  tensor(160.8393, device='cuda:3')
distance x is tensor(160.8393, device='cuda:3')
return_distance is  tensor(160.8393, device='cuda:3')
distance x is tensor(160.8294, device='cuda:3')
distance x is tensor(160.8294, device='cuda:3')
________________________________
test distance is  tensor(160.8294, device='cuda:3')
test distance1 is  tensor(160.8294, device='cuda:3')
test similarity is  tensor(0.9397, device='cuda:3')
test acc is  0.10000000015633198
test loss is 757.402617822578
test entropy is  0.0
________________________________
0
distance x is tensor(160.8294, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  757.1912707753781
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9397, device='cuda:3')
compute_distance is  tensor(160.8294, device='cuda:3')
compute_norm is  tensor(49.5514, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(227.5947, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5592768044868257
avg test loss is  2.851384093003995
avg accuracy is  0.12298333348966525
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9083, device='cuda:3')
compute_distance is  tensor(227.5947, device='cuda:3')
compute_norm is  tensor(53.2350, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(227.5191, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8382507189631716
avg test loss is  3.5825937655943036
avg accuracy is  0.08988333348966535
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9073, device='cuda:3')
compute_distance is  tensor(227.5191, device='cuda:3')
compute_norm is  tensor(53.3620, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(226.4242, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5529630223571111
avg test loss is  2.8519485268765674
avg accuracy is  0.12430000015633193
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9081, device='cuda:3')
compute_distance is  tensor(226.4242, device='cuda:3')
compute_norm is  tensor(52.7502, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(226.4373, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8377418351580085
avg test loss is  3.5798311698665497
avg accuracy is  0.09261666682299868
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9072, device='cuda:3')
compute_distance is  tensor(226.4373, device='cuda:3')
compute_norm is  tensor(52.8806, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(225.4086, device='cuda:3')
distance x is tensor(225.4086, device='cuda:3')
________________________________
test distance is  tensor(225.4086, device='cuda:3')
test distance1 is  tensor(225.4086, device='cuda:3')
test similarity is  tensor(0.9081, device='cuda:3')
test acc is  0.10005000015633199
test loss is 2.8496069254905683
test entropy is  1.5540042820769842
________________________________
cal ratio is  0.834030187830609
distance x is tensor(188.0027, device='cuda:3')
cal_distance is  tensor(188.0027, device='cuda:3')
cal ratio is  0.9132402692725948
distance x is tensor(171.6918, device='cuda:3')
cal_distance is  tensor(171.6918, device='cuda:3')
cal ratio is  0.95563538890603
distance x is tensor(164.0749, device='cuda:3')
cal_distance is  tensor(164.0749, device='cuda:3')
cal ratio is  0.9775657001840766
distance x is tensor(160.3941, device='cuda:3')
cal_distance is  tensor(160.3941, device='cuda:3')
distance x is tensor(160.3941, device='cuda:3')
return_distance is  tensor(160.3941, device='cuda:3')
distance x is tensor(160.3885, device='cuda:3')
distance x is tensor(160.3885, device='cuda:3')
________________________________
test distance is  tensor(160.3885, device='cuda:3')
test distance1 is  tensor(160.3885, device='cuda:3')
test similarity is  tensor(0.9487, device='cuda:3')
test acc is  0.10140000015633197
test loss is 2.4697361373698024
test entropy is  2.087110333859539
________________________________
0
distance x is tensor(160.3885, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.0870403150505603
avg test loss is  2.4699824954400946
avg accuracy is  0.24798333348967158
solo acc is  0.10155000015633196
compute similarity  is  tensor(0.9487, device='cuda:3')
compute_distance is  tensor(160.3885, device='cuda:3')
compute_norm is  tensor(49.2155, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(161.9079, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8513169805251205
avg test loss is  3.560584543356255
avg accuracy is  0.19768333348966954
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9463, device='cuda:3')
compute_distance is  tensor(161.9079, device='cuda:3')
compute_norm is  tensor(49.5957, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(161.3458, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.5316162937993942
avg test loss is  2.7229972818512906
avg accuracy is  0.34030000015634027
solo acc is  0.10645000015633195
compute similarity  is  tensor(0.9475, device='cuda:3')
compute_distance is  tensor(161.3458, device='cuda:3')
compute_norm is  tensor(49.0783, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(162.3186, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8124797675909519
avg test loss is  3.455869886158372
avg accuracy is  0.2736833334896723
solo acc is  0.10010000015633198
compute similarity  is  tensor(0.9465, device='cuda:3')
compute_distance is  tensor(162.3186, device='cuda:3')
compute_norm is  tensor(49.1631, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(165.4649, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.178783964246575
avg test loss is  1.9121697106595232
avg accuracy is  0.4056833334896745
solo acc is  0.17370000015633488
compute similarity  is  tensor(0.9477, device='cuda:3')
compute_distance is  tensor(165.4649, device='cuda:3')
compute_norm is  tensor(48.8112, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(166.7092, device='cuda:3')
distance x is tensor(166.7092, device='cuda:3')
________________________________
test distance is  tensor(166.7092, device='cuda:3')
test distance1 is  tensor(166.7092, device='cuda:3')
test similarity is  tensor(0.9473, device='cuda:3')
test acc is  0.10240000015633197
test loss is 2.6658012673798908
test entropy is  0.654836775397441
________________________________
cal ratio is  0.9698112898062661
distance x is tensor(161.6809, device='cuda:3')
cal_distance is  tensor(161.6809, device='cuda:3')
distance x is tensor(161.6809, device='cuda:3')
return_distance is  tensor(161.6809, device='cuda:3')
distance x is tensor(161.6764, device='cuda:3')
distance x is tensor(161.6764, device='cuda:3')
________________________________
test distance is  tensor(161.6764, device='cuda:3')
test distance1 is  tensor(161.6764, device='cuda:3')
test similarity is  tensor(0.9501, device='cuda:3')
test acc is  0.10285000015633197
test loss is 2.5627225238377096
test entropy is  0.7274641532506516
________________________________
0
distance x is tensor(161.6764, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.7277995726701293
avg test loss is  2.561323633326142
avg accuracy is  0.3648500001563406
solo acc is  0.10280000015633196
compute similarity  is  tensor(0.9501, device='cuda:3')
compute_distance is  tensor(161.6764, device='cuda:3')
compute_norm is  tensor(48.4920, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(163.6530, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.021664313606616
avg test loss is  1.6024301138513886
avg accuracy is  0.5091500001563422
solo acc is  0.2344500001563377
compute similarity  is  tensor(0.9503, device='cuda:3')
compute_distance is  tensor(163.6530, device='cuda:3')
compute_norm is  tensor(48.1853, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(164.2121, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6117885431119883
avg test loss is  2.425712490132623
avg accuracy is  0.40740000015634115
solo acc is  0.10216666682299863
compute similarity  is  tensor(0.9500, device='cuda:3')
compute_distance is  tensor(164.2121, device='cuda:3')
compute_norm is  tensor(48.0208, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(164.8508, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9680198707433143
avg test loss is  1.4724200285319835
avg accuracy is  0.5284666668230089
solo acc is  0.2574500001563384
compute similarity  is  tensor(0.9502, device='cuda:3')
compute_distance is  tensor(164.8508, device='cuda:3')
compute_norm is  tensor(47.7312, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(164.8551, device='cuda:3')
________________________________
test distance is  tensor(164.8551, device='cuda:3')
test similarity is  tensor(0.9502, device='cuda:3')
test acc is  0.5306166668230089
test loss is 1.4705251377782842
test entropy is  0.9675595943353323
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.289412260055542
mal norm is  tensor(670.6604, device='cuda:3')
distance x is tensor(164.8551, device='cuda:3')
mal distance is  tensor(164.8551, device='cuda:3')
user_PLR len size 44
counter_tensor is  tensor([43., 43., 43., 43., 43., 43., 43., 43., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 43., 43., 43., 43., 43., 43., 43., 43.,
        43., 43., 43., 43., 43., 43., 43., 43., 43., 43., 43., 43., 43., 43.,
        43., 43.])
count_res tensor([3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02, 5.2192e-07, 5.2192e-07, 5.2192e-07, 5.2192e-07,
        5.2192e-07, 5.2192e-07, 5.2192e-07, 5.2192e-07, 5.2192e-07, 5.2192e-07,
        5.2192e-07, 5.2192e-07, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 90.24% 

Test Accuracy: 89.33% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.21593554317951202
distance x is tensor(80.2444, device='cuda:3')
benign distance is  tensor(80.2444, device='cuda:3')
norm1 res is  tensor(350.8988, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5197555422782898
distance x is tensor(91.3380, device='cuda:3')
benign distance is  tensor(91.3380, device='cuda:3')
norm1 res is  tensor(399.6200, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.16944082081317902
distance x is tensor(106.9069, device='cuda:3')
benign distance is  tensor(106.9069, device='cuda:3')
norm1 res is  tensor(453.7729, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.23921558260917664
distance x is tensor(86.9584, device='cuda:3')
benign distance is  tensor(86.9584, device='cuda:3')
norm1 res is  tensor(371.6746, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5125715732574463
distance x is tensor(74.4450, device='cuda:3')
benign distance is  tensor(74.4450, device='cuda:3')
norm1 res is  tensor(313.6534, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.47660064697265625
distance x is tensor(87.9562, device='cuda:3')
benign distance is  tensor(87.9562, device='cuda:3')
norm1 res is  tensor(375.3764, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.36063045263290405
distance x is tensor(79.9731, device='cuda:3')
benign distance is  tensor(79.9731, device='cuda:3')
norm1 res is  tensor(343.6133, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.15608260035514832
distance x is tensor(101.2613, device='cuda:3')
benign distance is  tensor(101.2613, device='cuda:3')
norm1 res is  tensor(438.8196, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.36095643043518066
distance x is tensor(108.6368, device='cuda:3')
benign distance is  tensor(108.6368, device='cuda:3')
norm1 res is  tensor(468.8611, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8799718618392944
distance x is tensor(126.2392, device='cuda:3')
benign distance is  tensor(126.2392, device='cuda:3')
norm1 res is  tensor(540.9168, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.4143660068511963
distance x is tensor(98.1008, device='cuda:3')
benign distance is  tensor(98.1008, device='cuda:3')
norm1 res is  tensor(419.8599, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5917381048202515
distance x is tensor(111.6518, device='cuda:3')
benign distance is  tensor(111.6518, device='cuda:3')
norm1 res is  tensor(492.7727, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.579090416431427
distance x is tensor(108.5101, device='cuda:3')
benign distance is  tensor(108.5101, device='cuda:3')
norm1 res is  tensor(472.1560, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.35289549827575684
distance x is tensor(108.4779, device='cuda:3')
benign distance is  tensor(108.4779, device='cuda:3')
norm1 res is  tensor(477.8600, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6889998912811279
distance x is tensor(113.2354, device='cuda:3')
benign distance is  tensor(113.2354, device='cuda:3')
norm1 res is  tensor(497.9056, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5583499073982239
distance x is tensor(109.4575, device='cuda:3')
benign distance is  tensor(109.4575, device='cuda:3')
norm1 res is  tensor(469.0170, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.24762968719005585
distance x is tensor(117.2376, device='cuda:3')
benign distance is  tensor(117.2376, device='cuda:3')
norm1 res is  tensor(514.6776, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.1778571605682373
distance x is tensor(101.2031, device='cuda:3')
benign distance is  tensor(101.2031, device='cuda:3')
norm1 res is  tensor(428.2046, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.8746280670166016
distance x is tensor(119.6547, device='cuda:3')
benign distance is  tensor(119.6547, device='cuda:3')
norm1 res is  tensor(512.3267, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4578475058078766
distance x is tensor(116.1014, device='cuda:3')
benign distance is  tensor(116.1014, device='cuda:3')
norm1 res is  tensor(500.8577, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9177616238594055
distance x is tensor(118.6809, device='cuda:3')
benign distance is  tensor(118.6809, device='cuda:3')
norm1 res is  tensor(511.4525, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.37963467836380005
distance x is tensor(108.4935, device='cuda:3')
benign distance is  tensor(108.4935, device='cuda:3')
norm1 res is  tensor(479.3472, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.37633633613586426
distance x is tensor(110.4128, device='cuda:3')
benign distance is  tensor(110.4128, device='cuda:3')
norm1 res is  tensor(489.2668, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.4354141354560852
distance x is tensor(119.7428, device='cuda:3')
benign distance is  tensor(119.7428, device='cuda:3')
norm1 res is  tensor(529.0328, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.5789796113967896
distance x is tensor(124.9651, device='cuda:3')
benign distance is  tensor(124.9651, device='cuda:3')
norm1 res is  tensor(546.7773, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.10878177732229233
distance x is tensor(114.0653, device='cuda:3')
benign distance is  tensor(114.0653, device='cuda:3')
norm1 res is  tensor(496.8559, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6033666729927063
distance x is tensor(108.2414, device='cuda:3')
benign distance is  tensor(108.2414, device='cuda:3')
norm1 res is  tensor(473.5057, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.034505851566791534
distance x is tensor(124.1990, device='cuda:3')
benign distance is  tensor(124.1990, device='cuda:3')
norm1 res is  tensor(532.8972, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.32641834020614624
distance x is tensor(106.5110, device='cuda:3')
benign distance is  tensor(106.5110, device='cuda:3')
norm1 res is  tensor(462.6680, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.6808457970619202
distance x is tensor(110.4467, device='cuda:3')
benign distance is  tensor(110.4467, device='cuda:3')
norm1 res is  tensor(472.6324, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7447468638420105
distance x is tensor(111.0384, device='cuda:3')
benign distance is  tensor(111.0384, device='cuda:3')
norm1 res is  tensor(476.6718, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.14824029803276062
distance x is tensor(106.5908, device='cuda:3')
benign distance is  tensor(106.5908, device='cuda:3')
norm1 res is  tensor(474.1911, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(104.4470, device='cuda:3')
compute distance is  tensor(104.4470, device='cuda:3')
compute norm is  tensor(46.8643, device='cuda:3', dtype=torch.float64)
distance x is tensor(93.5500, device='cuda:3')
compute distance is  tensor(93.5500, device='cuda:3')
compute norm is  tensor(46.8625, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.6341, device='cuda:3')
compute distance is  tensor(106.6341, device='cuda:3')
compute norm is  tensor(47.1453, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.8723, device='cuda:3')
compute distance is  tensor(104.8723, device='cuda:3')
compute norm is  tensor(46.9746, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.8038, device='cuda:3')
compute distance is  tensor(111.8038, device='cuda:3')
compute norm is  tensor(47.1964, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.1918, device='cuda:3')
compute distance is  tensor(102.1918, device='cuda:3')
compute norm is  tensor(47.0751, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.2404, device='cuda:3')
compute distance is  tensor(107.2404, device='cuda:3')
compute norm is  tensor(47.1280, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.3908, device='cuda:3')
compute distance is  tensor(123.3908, device='cuda:3')
compute norm is  tensor(47.3174, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.5221, device='cuda:3')
compute distance is  tensor(113.5221, device='cuda:3')
compute norm is  tensor(47.1253, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.9208, device='cuda:3')
compute distance is  tensor(95.9208, device='cuda:3')
compute norm is  tensor(46.9629, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.0068, device='cuda:3')
compute distance is  tensor(109.0068, device='cuda:3')
compute norm is  tensor(47.1399, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.3493, device='cuda:3')
compute distance is  tensor(115.3493, device='cuda:3')
compute norm is  tensor(47.2500, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(123.3908, device='cuda:3')
distance x is tensor(106178.0312, device='cuda:3')
distance x is tensor(106178.0312, device='cuda:3')
________________________________
test distance is  tensor(106178.0312, device='cuda:3')
test distance1 is  tensor(106178.0312, device='cuda:3')
test similarity is  tensor(0.0231, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139276474548713.08
test entropy is  0.0
________________________________
cal ratio is  0.033407971814271124
distance x is tensor(3547.1975, device='cuda:3')
cal_distance is  tensor(3547.1975, device='cuda:3')
cal ratio is  0.18277834728940767
distance x is tensor(648.3549, device='cuda:3')
cal_distance is  tensor(648.3549, device='cuda:3')
cal ratio is  0.4275245223624723
distance x is tensor(277.1905, device='cuda:3')
cal_distance is  tensor(277.1905, device='cuda:3')
cal ratio is  0.6538502575910067
distance x is tensor(181.2428, device='cuda:3')
cal_distance is  tensor(181.2428, device='cuda:3')
cal ratio is  0.8086062104080546
distance x is tensor(146.5550, device='cuda:3')
cal_distance is  tensor(146.5550, device='cuda:3')
cal ratio is  0.8992224386290353
distance x is tensor(131.7861, device='cuda:3')
cal_distance is  tensor(131.7861, device='cuda:3')
cal ratio is  0.9482715297319587
distance x is tensor(124.9692, device='cuda:3')
cal_distance is  tensor(124.9692, device='cuda:3')
cal ratio is  0.9737912890846339
distance x is tensor(121.6941, device='cuda:3')
cal_distance is  tensor(121.6941, device='cuda:3')
distance x is tensor(121.6941, device='cuda:3')
return_distance is  tensor(121.6941, device='cuda:3')
distance x is tensor(121.6842, device='cuda:3')
distance x is tensor(121.6842, device='cuda:3')
________________________________
test distance is  tensor(121.6842, device='cuda:3')
test distance1 is  tensor(121.6842, device='cuda:3')
test similarity is  tensor(0.9571, device='cuda:3')
test acc is  0.10000000015633198
test loss is 217.06886106055936
test entropy is  2.9447415664137113e-23
________________________________
0
distance x is tensor(121.6842, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  3.084880726525377e-25
avg test loss is  216.99652532321304
avg accuracy is  0.3274000001563401
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9571, device='cuda:3')
compute_distance is  tensor(121.6842, device='cuda:3')
compute_norm is  tensor(47.2157, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(109.2248, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8203529838178711
avg test loss is  1.2586725547369608
avg accuracy is  0.882600000156322
solo acc is  0.35118333348967384
compute similarity  is  tensor(0.9602, device='cuda:3')
compute_distance is  tensor(109.2248, device='cuda:3')
compute_norm is  tensor(46.4819, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(110.9352, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7846842558780459
avg test loss is  1.3339641916472267
avg accuracy is  0.8830333334896553
solo acc is  0.2735166668230055
compute similarity  is  tensor(0.9597, device='cuda:3')
compute_distance is  tensor(110.9352, device='cuda:3')
compute_norm is  tensor(46.1924, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(112.4653, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7842330261588351
avg test loss is  1.29811454283149
avg accuracy is  0.8827833334896553
solo acc is  0.2663833334896721
compute similarity  is  tensor(0.9593, device='cuda:3')
compute_distance is  tensor(112.4653, device='cuda:3')
compute_norm is  tensor(45.9238, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(113.9347, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7833933626283714
avg test loss is  1.2716346944191816
avg accuracy is  0.8860166668229885
solo acc is  0.2595333334896718
compute similarity  is  tensor(0.9589, device='cuda:3')
compute_distance is  tensor(113.9347, device='cuda:3')
compute_norm is  tensor(45.6684, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.3301, device='cuda:3')
distance x is tensor(115.3301, device='cuda:3')
________________________________
test distance is  tensor(115.3301, device='cuda:3')
test distance1 is  tensor(115.3301, device='cuda:3')
test similarity is  tensor(0.9586, device='cuda:3')
test acc is  0.2552166668230051
test loss is 1.2498069065593198
test entropy is  0.7814146045174426
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.0596007108688354
mal norm is  tensor(589.3400, device='cuda:3')
distance x is tensor(115.3377, device='cuda:3')
mal distance is  tensor(115.3377, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([27., 27., 27., 27., 27., 27., 27., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 27., 27., 27., 27., 27., 27., 27.])
count_res tensor([6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 90.41% 

Test Accuracy: 89.77% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6095849871635437
distance x is tensor(81.4757, device='cuda:3')
benign distance is  tensor(81.4757, device='cuda:3')
norm1 res is  tensor(370.3178, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4268697202205658
distance x is tensor(95.6469, device='cuda:3')
benign distance is  tensor(95.6469, device='cuda:3')
norm1 res is  tensor(420.0109, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.018066056072711945
distance x is tensor(108.5875, device='cuda:3')
benign distance is  tensor(108.5875, device='cuda:3')
norm1 res is  tensor(457.5540, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5377561450004578
distance x is tensor(90.8525, device='cuda:3')
benign distance is  tensor(90.8525, device='cuda:3')
norm1 res is  tensor(391.1782, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8830605745315552
distance x is tensor(77.2168, device='cuda:3')
benign distance is  tensor(77.2168, device='cuda:3')
norm1 res is  tensor(334.0640, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.537307620048523
distance x is tensor(76.3961, device='cuda:3')
benign distance is  tensor(76.3961, device='cuda:3')
norm1 res is  tensor(328.7622, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.19044996798038483
distance x is tensor(78.0192, device='cuda:3')
benign distance is  tensor(78.0192, device='cuda:3')
norm1 res is  tensor(338.2701, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.06298936158418655
distance x is tensor(92.7417, device='cuda:3')
benign distance is  tensor(92.7417, device='cuda:3')
norm1 res is  tensor(407.0410, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.519016444683075
distance x is tensor(111.7358, device='cuda:3')
benign distance is  tensor(111.7358, device='cuda:3')
norm1 res is  tensor(488.1894, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7321333885192871
distance x is tensor(136.9174, device='cuda:3')
benign distance is  tensor(136.9174, device='cuda:3')
norm1 res is  tensor(593.0865, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.374775767326355
distance x is tensor(105.7625, device='cuda:3')
benign distance is  tensor(105.7625, device='cuda:3')
norm1 res is  tensor(462.3969, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.09307707101106644
distance x is tensor(117.3484, device='cuda:3')
benign distance is  tensor(117.3484, device='cuda:3')
norm1 res is  tensor(525.6030, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.24186447262763977
distance x is tensor(121.3924, device='cuda:3')
benign distance is  tensor(121.3924, device='cuda:3')
norm1 res is  tensor(534.2465, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0307860374450684
distance x is tensor(104.3495, device='cuda:3')
benign distance is  tensor(104.3495, device='cuda:3')
norm1 res is  tensor(456.2346, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.7357228994369507
distance x is tensor(113.7680, device='cuda:3')
benign distance is  tensor(113.7680, device='cuda:3')
norm1 res is  tensor(496.6137, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5036004185676575
distance x is tensor(114.2164, device='cuda:3')
benign distance is  tensor(114.2164, device='cuda:3')
norm1 res is  tensor(488.7365, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(107.5921, device='cuda:3')
compute distance is  tensor(107.5921, device='cuda:3')
compute norm is  tensor(47.2055, device='cuda:3', dtype=torch.float64)
distance x is tensor(92.4788, device='cuda:3')
compute distance is  tensor(92.4788, device='cuda:3')
compute norm is  tensor(46.9731, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.4083, device='cuda:3')
compute distance is  tensor(106.4083, device='cuda:3')
compute norm is  tensor(47.4625, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.3293, device='cuda:3')
compute distance is  tensor(98.3293, device='cuda:3')
compute norm is  tensor(47.1732, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.4880, device='cuda:3')
compute distance is  tensor(108.4880, device='cuda:3')
compute norm is  tensor(47.2632, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.5568, device='cuda:3')
compute distance is  tensor(116.5568, device='cuda:3')
compute norm is  tensor(47.4721, device='cuda:3', dtype=torch.float64)
distance x is tensor(97.3404, device='cuda:3')
compute distance is  tensor(97.3404, device='cuda:3')
compute norm is  tensor(47.1496, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.8406, device='cuda:3')
compute distance is  tensor(102.8406, device='cuda:3')
compute norm is  tensor(47.2236, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.2740, device='cuda:3')
compute distance is  tensor(124.2740, device='cuda:3')
compute norm is  tensor(47.6370, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.2418, device='cuda:3')
compute distance is  tensor(101.2418, device='cuda:3')
compute norm is  tensor(47.2669, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.4357, device='cuda:3')
compute distance is  tensor(108.4357, device='cuda:3')
compute norm is  tensor(47.4412, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.2743, device='cuda:3')
compute distance is  tensor(98.2743, device='cuda:3')
compute norm is  tensor(47.1418, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(124.2740, device='cuda:3')
distance x is tensor(106181.3906, device='cuda:3')
distance x is tensor(106181.3906, device='cuda:3')
________________________________
test distance is  tensor(106181.3906, device='cuda:3')
test distance1 is  tensor(106181.3906, device='cuda:3')
test similarity is  tensor(0.0054, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139272122229452.14
test entropy is  0.0
________________________________
cal ratio is  0.033526793001808775
distance x is tensor(3559.9268, device='cuda:3')
cal_distance is  tensor(3559.9268, device='cuda:3')
cal ratio is  0.1831030910164629
distance x is tensor(651.8376, device='cuda:3')
cal_distance is  tensor(651.8376, device='cuda:3')
cal ratio is  0.42790415298281265
distance x is tensor(278.9269, device='cuda:3')
cal_distance is  tensor(278.9269, device='cuda:3')
cal ratio is  0.6541404856243507
distance x is tensor(182.4591, device='cuda:3')
cal_distance is  tensor(182.4591, device='cuda:3')
cal ratio is  0.8087857589304154
distance x is tensor(147.5713, device='cuda:3')
cal_distance is  tensor(147.5713, device='cuda:3')
cal ratio is  0.8993222197950465
distance x is tensor(132.7146, device='cuda:3')
cal_distance is  tensor(132.7146, device='cuda:3')
cal ratio is  0.9483242286525532
distance x is tensor(125.8568, device='cuda:3')
cal_distance is  tensor(125.8568, device='cuda:3')
cal ratio is  0.9738183591913786
distance x is tensor(122.5617, device='cuda:3')
cal_distance is  tensor(122.5617, device='cuda:3')
distance x is tensor(122.5617, device='cuda:3')
return_distance is  tensor(122.5617, device='cuda:3')
distance x is tensor(122.5519, device='cuda:3')
distance x is tensor(122.5519, device='cuda:3')
________________________________
test distance is  tensor(122.5519, device='cuda:3')
test distance1 is  tensor(122.5519, device='cuda:3')
test similarity is  tensor(0.9565, device='cuda:3')
test acc is  0.10000000015633198
test loss is 232.34476854857098
test entropy is  9.498053997726106e-26
________________________________
0
distance x is tensor(122.5519, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.6133550626683413e-25
avg test loss is  232.34631918640787
avg accuracy is  0.3523500001563405
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9565, device='cuda:3')
compute_distance is  tensor(122.5519, device='cuda:3')
compute_norm is  tensor(47.3611, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(109.2729, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8314802374666942
avg test loss is  1.218347550137465
avg accuracy is  0.8842833334896553
solo acc is  0.37880000015634085
compute similarity  is  tensor(0.9600, device='cuda:3')
compute_distance is  tensor(109.2729, device='cuda:3')
compute_norm is  tensor(46.5836, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(111.3034, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.795246689939804
avg test loss is  1.3005411075884854
avg accuracy is  0.8854833334896552
solo acc is  0.29401666682300603
compute similarity  is  tensor(0.9594, device='cuda:3')
compute_distance is  tensor(111.3034, device='cuda:3')
compute_norm is  tensor(46.2896, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(113.0462, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7864411440231144
avg test loss is  1.2921642654740226
avg accuracy is  0.8859500001563219
solo acc is  0.2721333334896722
compute similarity  is  tensor(0.9590, device='cuda:3')
compute_distance is  tensor(113.0462, device='cuda:3')
compute_norm is  tensor(46.0190, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(114.6953, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7789385493503196
avg test loss is  1.2787907878473115
avg accuracy is  0.8871000001563217
solo acc is  0.25543333348967173
compute similarity  is  tensor(0.9586, device='cuda:3')
compute_distance is  tensor(114.6953, device='cuda:3')
compute_norm is  tensor(45.7615, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(116.2655, device='cuda:3')
distance x is tensor(116.2655, device='cuda:3')
________________________________
test distance is  tensor(116.2655, device='cuda:3')
test distance1 is  tensor(116.2655, device='cuda:3')
test similarity is  tensor(0.9582, device='cuda:3')
test acc is  0.2583000001563384
test loss is 1.2507734100447534
test entropy is  0.781530223167273
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.0357606410980225
mal norm is  tensor(593.8031, device='cuda:3')
distance x is tensor(116.2727, device='cuda:3')
mal distance is  tensor(116.2727, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([27., 27., 27., 27., 27., 27., 27., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 27., 27., 27., 27., 27., 27., 27.])
count_res tensor([6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 90.38% 

Test Accuracy: 89.53% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5095486640930176
distance x is tensor(74.8023, device='cuda:3')
benign distance is  tensor(74.8023, device='cuda:3')
norm1 res is  tensor(329.5293, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.626494288444519
distance x is tensor(82.9589, device='cuda:3')
benign distance is  tensor(82.9589, device='cuda:3')
norm1 res is  tensor(366.5230, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.13341745734214783
distance x is tensor(107.2991, device='cuda:3')
benign distance is  tensor(107.2991, device='cuda:3')
norm1 res is  tensor(444.3863, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.42396411299705505
distance x is tensor(75.4473, device='cuda:3')
benign distance is  tensor(75.4473, device='cuda:3')
norm1 res is  tensor(334.5229, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7309199571609497
distance x is tensor(70.2638, device='cuda:3')
benign distance is  tensor(70.2638, device='cuda:3')
norm1 res is  tensor(294.5552, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3924981653690338
distance x is tensor(100.7557, device='cuda:3')
benign distance is  tensor(100.7557, device='cuda:3')
norm1 res is  tensor(421.8687, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4602310061454773
distance x is tensor(80.8287, device='cuda:3')
benign distance is  tensor(80.8287, device='cuda:3')
norm1 res is  tensor(348.2712, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5023700594902039
distance x is tensor(85.8715, device='cuda:3')
benign distance is  tensor(85.8715, device='cuda:3')
norm1 res is  tensor(380.1890, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5937903523445129
distance x is tensor(114.7020, device='cuda:3')
benign distance is  tensor(114.7020, device='cuda:3')
norm1 res is  tensor(494.9663, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.662244439125061
distance x is tensor(115.6848, device='cuda:3')
benign distance is  tensor(115.6848, device='cuda:3')
norm1 res is  tensor(509.1406, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7151092290878296
distance x is tensor(113.1926, device='cuda:3')
benign distance is  tensor(113.1926, device='cuda:3')
norm1 res is  tensor(494.2123, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8744314312934875
distance x is tensor(117.1341, device='cuda:3')
benign distance is  tensor(117.1341, device='cuda:3')
norm1 res is  tensor(515.9147, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5033429265022278
distance x is tensor(100.1947, device='cuda:3')
benign distance is  tensor(100.1947, device='cuda:3')
norm1 res is  tensor(435.6476, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.35392826795578003
distance x is tensor(106.7856, device='cuda:3')
benign distance is  tensor(106.7856, device='cuda:3')
norm1 res is  tensor(475.8283, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7726222276687622
distance x is tensor(127.5301, device='cuda:3')
benign distance is  tensor(127.5301, device='cuda:3')
norm1 res is  tensor(558.5906, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.33160385489463806
distance x is tensor(113.7122, device='cuda:3')
benign distance is  tensor(113.7122, device='cuda:3')
norm1 res is  tensor(492.5448, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(98.1055, device='cuda:3')
compute distance is  tensor(98.1055, device='cuda:3')
compute norm is  tensor(47.3645, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.7187, device='cuda:3')
compute distance is  tensor(104.7187, device='cuda:3')
compute norm is  tensor(47.5916, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.9764, device='cuda:3')
compute distance is  tensor(105.9764, device='cuda:3')
compute norm is  tensor(47.5852, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.7261, device='cuda:3')
compute distance is  tensor(98.7261, device='cuda:3')
compute norm is  tensor(47.4556, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.3482, device='cuda:3')
compute distance is  tensor(107.3482, device='cuda:3')
compute norm is  tensor(47.5729, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.8713, device='cuda:3')
compute distance is  tensor(100.8713, device='cuda:3')
compute norm is  tensor(47.4933, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.3787, device='cuda:3')
compute distance is  tensor(99.3787, device='cuda:3')
compute norm is  tensor(47.5534, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.3175, device='cuda:3')
compute distance is  tensor(115.3175, device='cuda:3')
compute norm is  tensor(47.7983, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.9515, device='cuda:3')
compute distance is  tensor(112.9515, device='cuda:3')
compute norm is  tensor(47.8049, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.6261, device='cuda:3')
compute distance is  tensor(104.6261, device='cuda:3')
compute norm is  tensor(47.6232, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.2380, device='cuda:3')
compute distance is  tensor(99.2380, device='cuda:3')
compute norm is  tensor(47.4714, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.2096, device='cuda:3')
compute distance is  tensor(118.2096, device='cuda:3')
compute norm is  tensor(47.7653, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(118.2096, device='cuda:3')
distance x is tensor(106181.0938, device='cuda:3')
distance x is tensor(106181.0938, device='cuda:3')
________________________________
test distance is  tensor(106181.0938, device='cuda:3')
test distance1 is  tensor(106181.0938, device='cuda:3')
test similarity is  tensor(0.0070, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139285760854029.1
test entropy is  0.0
________________________________
cal ratio is  0.03269858271513184
distance x is tensor(3471.9763, device='cuda:3')
cal_distance is  tensor(3471.9763, device='cuda:3')
cal ratio is  0.18082736234587318
distance x is tensor(627.8323, device='cuda:3')
cal_distance is  tensor(627.8323, device='cuda:3')
cal ratio is  0.4252366431163689
distance x is tensor(266.9801, device='cuda:3')
cal_distance is  tensor(266.9801, device='cuda:3')
cal ratio is  0.6520982762524836
distance x is tensor(174.0990, device='cuda:3')
cal_distance is  tensor(174.0990, device='cuda:3')
cal ratio is  0.80752194906231
distance x is tensor(140.5898, device='cuda:3')
cal_distance is  tensor(140.5898, device='cuda:3')
cal ratio is  0.898619091649676
distance x is tensor(126.3372, device='cuda:3')
cal_distance is  tensor(126.3372, device='cuda:3')
cal ratio is  0.9479533422955538
distance x is tensor(119.7620, device='cuda:3')
cal_distance is  tensor(119.7620, device='cuda:3')
cal ratio is  0.9736278531268658
distance x is tensor(116.6038, device='cuda:3')
cal_distance is  tensor(116.6038, device='cuda:3')
distance x is tensor(116.6038, device='cuda:3')
return_distance is  tensor(116.6038, device='cuda:3')
distance x is tensor(116.5939, device='cuda:3')
distance x is tensor(116.5939, device='cuda:3')
________________________________
test distance is  tensor(116.5939, device='cuda:3')
test distance1 is  tensor(116.5939, device='cuda:3')
test similarity is  tensor(0.9610, device='cuda:3')
test acc is  0.10000000015633198
test loss is 187.87320644159053
test entropy is  1.5588126617032966e-21
________________________________
0
distance x is tensor(116.5939, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  7.284837520060566e-22
avg test loss is  187.85850700589893
avg accuracy is  0.5260833334896756
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9610, device='cuda:3')
compute_distance is  tensor(116.5939, device='cuda:3')
compute_norm is  tensor(47.5672, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(105.5476, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8084786492370085
avg test loss is  1.2767056907926286
avg accuracy is  0.8865500001563219
solo acc is  0.3464833334896737
compute similarity  is  tensor(0.9635, device='cuda:3')
compute_distance is  tensor(105.5476, device='cuda:3')
compute_norm is  tensor(46.7676, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(107.4774, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7892314125734098
avg test loss is  1.314320382723676
avg accuracy is  0.8858666668229885
solo acc is  0.28375000015633906
compute similarity  is  tensor(0.9630, device='cuda:3')
compute_distance is  tensor(107.4774, device='cuda:3')
compute_norm is  tensor(46.4706, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(109.2326, device='cuda:3')
exit early
distance x is tensor(109.2326, device='cuda:3')
distance x is tensor(109.2326, device='cuda:3')
________________________________
test distance is  tensor(109.2326, device='cuda:3')
test distance1 is  tensor(109.2326, device='cuda:3')
test similarity is  tensor(0.9626, device='cuda:3')
test acc is  0.2555500001563384
test loss is 1.3170214932102131
test entropy is  0.7733177928400955
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.434615969657898
mal norm is  tensor(568.4534, device='cuda:3')
distance x is tensor(109.2397, device='cuda:3')
mal distance is  tensor(109.2397, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([19., 19., 19., 19., 19., 19., 19., 19., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0669,
        0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669,
        0.0669, 0.0669])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 78.79% 

Test Accuracy: 77.63% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8083391189575195
distance x is tensor(128.4309, device='cuda:3')
benign distance is  tensor(128.4309, device='cuda:3')
norm1 res is  tensor(517.7792, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9144060015678406
distance x is tensor(137.6717, device='cuda:3')
benign distance is  tensor(137.6717, device='cuda:3')
norm1 res is  tensor(549.8215, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8203532099723816
distance x is tensor(146.5417, device='cuda:3')
benign distance is  tensor(146.5417, device='cuda:3')
norm1 res is  tensor(586.8029, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4230448305606842
distance x is tensor(146.6037, device='cuda:3')
benign distance is  tensor(146.6037, device='cuda:3')
norm1 res is  tensor(595.3426, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.30460113286972046
distance x is tensor(142.1008, device='cuda:3')
benign distance is  tensor(142.1008, device='cuda:3')
norm1 res is  tensor(558.6782, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0388529300689697
distance x is tensor(135.6841, device='cuda:3')
benign distance is  tensor(135.6841, device='cuda:3')
norm1 res is  tensor(554.9371, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5561177134513855
distance x is tensor(140.8048, device='cuda:3')
benign distance is  tensor(140.8048, device='cuda:3')
norm1 res is  tensor(564.6418, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.49719172716140747
distance x is tensor(140.8912, device='cuda:3')
benign distance is  tensor(140.8912, device='cuda:3')
norm1 res is  tensor(573.8132, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(142.4371, device='cuda:3')
compute distance is  tensor(142.4371, device='cuda:3')
compute norm is  tensor(47.8761, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.2694, device='cuda:3')
compute distance is  tensor(137.2694, device='cuda:3')
compute norm is  tensor(47.8217, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.9748, device='cuda:3')
compute distance is  tensor(150.9748, device='cuda:3')
compute norm is  tensor(48.2042, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.2193, device='cuda:3')
compute distance is  tensor(150.2193, device='cuda:3')
compute norm is  tensor(48.2322, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.1144, device='cuda:3')
compute distance is  tensor(152.1144, device='cuda:3')
compute norm is  tensor(48.0989, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.0606, device='cuda:3')
compute distance is  tensor(141.0606, device='cuda:3')
compute norm is  tensor(48.0471, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.5717, device='cuda:3')
compute distance is  tensor(152.5717, device='cuda:3')
compute norm is  tensor(48.1132, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.6569, device='cuda:3')
compute distance is  tensor(146.6569, device='cuda:3')
compute norm is  tensor(47.9614, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.4845, device='cuda:3')
compute distance is  tensor(165.4845, device='cuda:3')
compute norm is  tensor(48.4428, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.9904, device='cuda:3')
compute distance is  tensor(145.9904, device='cuda:3')
compute norm is  tensor(48.0100, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.1847, device='cuda:3')
compute distance is  tensor(151.1847, device='cuda:3')
compute norm is  tensor(48.0518, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.6614, device='cuda:3')
compute distance is  tensor(145.6614, device='cuda:3')
compute norm is  tensor(48.0633, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(165.4845, device='cuda:3')
distance x is tensor(106122.8359, device='cuda:3')
distance x is tensor(106122.8359, device='cuda:3')
________________________________
test distance is  tensor(106122.8359, device='cuda:3')
test distance1 is  tensor(106122.8359, device='cuda:3')
test similarity is  tensor(0.2023, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139293530162758.95
test entropy is  0.0
________________________________
cal ratio is  0.03869905411802313
distance x is tensor(4106.8584, device='cuda:3')
cal_distance is  tensor(4106.8584, device='cuda:3')
cal ratio is  0.19672063391815853
distance x is tensor(807.9077, device='cuda:3')
cal_distance is  tensor(807.9077, device='cuda:3')
cal ratio is  0.4435309095841658
distance x is tensor(358.3348, device='cuda:3')
cal_distance is  tensor(358.3348, device='cuda:3')
cal ratio is  0.6659786015218173
distance x is tensor(238.6450, device='cuda:3')
cal_distance is  tensor(238.6450, device='cuda:3')
cal ratio is  0.8160722389139659
distance x is tensor(194.7525, device='cuda:3')
cal_distance is  tensor(194.7525, device='cuda:3')
cal ratio is  0.9033650734528784
distance x is tensor(175.9330, device='cuda:3')
cal_distance is  tensor(175.9330, device='cuda:3')
cal ratio is  0.9504539111946774
distance x is tensor(167.2165, device='cuda:3')
cal_distance is  tensor(167.2165, device='cuda:3')
cal ratio is  0.9749115566829816
distance x is tensor(163.0214, device='cuda:3')
cal_distance is  tensor(163.0214, device='cuda:3')
distance x is tensor(163.0214, device='cuda:3')
return_distance is  tensor(163.0214, device='cuda:3')
distance x is tensor(163.0116, device='cuda:3')
distance x is tensor(163.0116, device='cuda:3')
________________________________
test distance is  tensor(163.0116, device='cuda:3')
test distance1 is  tensor(163.0116, device='cuda:3')
test similarity is  tensor(0.9395, device='cuda:3')
test acc is  0.10000000015633198
test loss is 774.7765456079674
test entropy is  0.0
________________________________
0
distance x is tensor(163.0116, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  774.7315596395464
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9395, device='cuda:3')
compute_distance is  tensor(163.0116, device='cuda:3')
compute_norm is  tensor(50.3189, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(213.8879, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5581131388129457
avg test loss is  2.8512343707115155
avg accuracy is  0.1412500001563324
solo acc is  0.10011666682299865
compute similarity  is  tensor(0.9152, device='cuda:3')
compute_distance is  tensor(213.8879, device='cuda:3')
compute_norm is  tensor(53.2361, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(213.9716, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8363873540465512
avg test loss is  3.584513909781157
avg accuracy is  0.1388166668229988
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9142, device='cuda:3')
compute_distance is  tensor(213.9716, device='cuda:3')
compute_norm is  tensor(53.3537, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(212.9791, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5517580520623782
avg test loss is  2.8485175190703957
avg accuracy is  0.14488333348966612
solo acc is  0.10046666682299864
compute similarity  is  tensor(0.9150, device='cuda:3')
compute_distance is  tensor(212.9791, device='cuda:3')
compute_norm is  tensor(52.7509, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(213.1216, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8362345530915616
avg test loss is  3.5802823638102645
avg accuracy is  0.13991666682299891
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9141, device='cuda:3')
compute_distance is  tensor(213.1216, device='cuda:3')
compute_norm is  tensor(52.8713, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(212.2285, device='cuda:3')
distance x is tensor(212.2285, device='cuda:3')
________________________________
test distance is  tensor(212.2285, device='cuda:3')
test distance1 is  tensor(212.2285, device='cuda:3')
test similarity is  tensor(0.9150, device='cuda:3')
test acc is  0.10185000015633197
test loss is 2.8363052095685686
test entropy is  1.5528204120806794
________________________________
cal ratio is  0.8653720910550896
distance x is tensor(183.6619, device='cuda:3')
cal_distance is  tensor(183.6619, device='cuda:3')
cal ratio is  0.9302403748872142
distance x is tensor(170.8499, device='cuda:3')
cal_distance is  tensor(170.8499, device='cuda:3')
cal ratio is  0.9644891958926864
distance x is tensor(164.7830, device='cuda:3')
cal_distance is  tensor(164.7830, device='cuda:3')
distance x is tensor(164.7830, device='cuda:3')
return_distance is  tensor(164.7830, device='cuda:3')
distance x is tensor(164.7774, device='cuda:3')
distance x is tensor(164.7774, device='cuda:3')
________________________________
test distance is  tensor(164.7774, device='cuda:3')
test distance1 is  tensor(164.7774, device='cuda:3')
test similarity is  tensor(0.9449, device='cuda:3')
test acc is  0.1047333334896653
test loss is 2.517577943008846
test entropy is  1.987419702478055
________________________________
0
distance x is tensor(164.7774, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.9873178730895524
avg test loss is  2.518605334926516
avg accuracy is  0.2607666668230053
solo acc is  0.10463333348966529
compute similarity  is  tensor(0.9449, device='cuda:3')
compute_distance is  tensor(164.7774, device='cuda:3')
compute_norm is  tensor(50.0931, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(166.1188, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8454804240640547
avg test loss is  3.5624261161665927
avg accuracy is  0.216650000156337
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9430, device='cuda:3')
compute_distance is  tensor(166.1188, device='cuda:3')
compute_norm is  tensor(50.4109, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(167.1266, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.4341415372738706
avg test loss is  2.513701378409542
avg accuracy is  0.34181666682300704
solo acc is  0.1195166668229986
compute similarity  is  tensor(0.9442, device='cuda:3')
compute_distance is  tensor(167.1266, device='cuda:3')
compute_norm is  tensor(49.8920, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(168.4143, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7830878887603532
avg test loss is  3.1735084341533146
avg accuracy is  0.2577500001563385
solo acc is  0.10060000015633198
compute similarity  is  tensor(0.9433, device='cuda:3')
compute_distance is  tensor(168.4143, device='cuda:3')
compute_norm is  tensor(49.9505, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(170.5753, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.2109891248664368
avg test loss is  1.945499053896109
avg accuracy is  0.39051666682300773
solo acc is  0.180566666823002
compute similarity  is  tensor(0.9443, device='cuda:3')
compute_distance is  tensor(170.5753, device='cuda:3')
compute_norm is  tensor(49.5747, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(171.5145, device='cuda:3')
distance x is tensor(171.5145, device='cuda:3')
________________________________
test distance is  tensor(171.5145, device='cuda:3')
test distance1 is  tensor(171.5145, device='cuda:3')
test similarity is  tensor(0.9437, device='cuda:3')
test acc is  0.10106666682299864
test loss is 2.731880359049799
test entropy is  0.6936635850970425
________________________________
cal ratio is  0.9626187458481598
distance x is tensor(165.1076, device='cuda:3')
cal_distance is  tensor(165.1076, device='cuda:3')
distance x is tensor(165.1076, device='cuda:3')
return_distance is  tensor(165.1076, device='cuda:3')
distance x is tensor(165.1030, device='cuda:3')
distance x is tensor(165.1030, device='cuda:3')
________________________________
test distance is  tensor(165.1030, device='cuda:3')
test distance1 is  tensor(165.1030, device='cuda:3')
test similarity is  tensor(0.9474, device='cuda:3')
test acc is  0.1012833334896653
test loss is 2.614218287122275
test entropy is  0.7790628299275949
________________________________
0
distance x is tensor(165.1030, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.7792272331363865
avg test loss is  2.6159412311846766
avg accuracy is  0.32321666682300665
solo acc is  0.10111666682299864
compute similarity  is  tensor(0.9474, device='cuda:3')
compute_distance is  tensor(165.1030, device='cuda:3')
compute_norm is  tensor(49.2479, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(167.3102, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0607947989313333
avg test loss is  1.7667231269990966
avg accuracy is  0.42841666682300816
solo acc is  0.1844333334896689
compute similarity  is  tensor(0.9475, device='cuda:3')
compute_distance is  tensor(167.3102, device='cuda:3')
compute_norm is  tensor(48.9231, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(168.0331, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6389508140620901
avg test loss is  2.506298635051703
avg accuracy is  0.33046666682300674
solo acc is  0.1014833334896653
compute similarity  is  tensor(0.9471, device='cuda:3')
compute_distance is  tensor(168.0331, device='cuda:3')
compute_norm is  tensor(48.7761, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(169.3545, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.022488153120602
avg test loss is  1.6368424597579534
avg accuracy is  0.4328666668230082
solo acc is  0.20185000015633642
compute similarity  is  tensor(0.9473, device='cuda:3')
compute_distance is  tensor(169.3545, device='cuda:3')
compute_norm is  tensor(48.4551, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(169.9973, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6147210028634142
avg test loss is  2.420651648852871
avg accuracy is  0.33345000015634013
solo acc is  0.1011333334896653
compute similarity  is  tensor(0.9469, device='cuda:3')
compute_distance is  tensor(169.9973, device='cuda:3')
compute_norm is  tensor(48.2947, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(171.1870, device='cuda:3')
________________________________
test distance is  tensor(171.1870, device='cuda:3')
test similarity is  tensor(0.9470, device='cuda:3')
test acc is  0.4311666668230082
test loss is 1.5738127548049
test entropy is  0.9900635641648062
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.3424131870269775
mal norm is  tensor(698.8159, device='cuda:3')
distance x is tensor(171.1870, device='cuda:3')
mal distance is  tensor(171.1870, device='cuda:3')
user_PLR len size 52
counter_tensor is  tensor([51., 51., 51., 51., 51., 51., 51., 51., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 51., 51., 51., 51., 51., 51., 51., 51.,
        51., 51., 51., 51., 51., 51., 51., 51., 51., 51., 51., 51., 51., 51.,
        51., 51., 51., 51., 51., 51., 51., 51., 51., 51.])
count_res tensor([2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 4.1754e-07, 4.1754e-07, 4.1754e-07, 4.1754e-07,
        4.1754e-07, 4.1754e-07, 4.1754e-07, 4.1754e-07, 4.1754e-07, 4.1754e-07,
        4.1754e-07, 4.1754e-07, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 90.47% 

Test Accuracy: 89.56% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.20807358622550964
distance x is tensor(68.3933, device='cuda:3')
benign distance is  tensor(68.3933, device='cuda:3')
norm1 res is  tensor(303.7167, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7713419198989868
distance x is tensor(97.0519, device='cuda:3')
benign distance is  tensor(97.0519, device='cuda:3')
norm1 res is  tensor(433.7350, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.16429483890533447
distance x is tensor(100.1637, device='cuda:3')
benign distance is  tensor(100.1637, device='cuda:3')
norm1 res is  tensor(422.8450, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3111456036567688
distance x is tensor(87.7431, device='cuda:3')
benign distance is  tensor(87.7431, device='cuda:3')
norm1 res is  tensor(375.3756, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.679369330406189
distance x is tensor(74.9922, device='cuda:3')
benign distance is  tensor(74.9922, device='cuda:3')
norm1 res is  tensor(315.6309, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.06889808177948
distance x is tensor(85.8552, device='cuda:3')
benign distance is  tensor(85.8552, device='cuda:3')
norm1 res is  tensor(369.0630, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5167602896690369
distance x is tensor(81.8389, device='cuda:3')
benign distance is  tensor(81.8389, device='cuda:3')
norm1 res is  tensor(349.9235, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3217385709285736
distance x is tensor(84.8696, device='cuda:3')
benign distance is  tensor(84.8696, device='cuda:3')
norm1 res is  tensor(375.4438, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5112253427505493
distance x is tensor(109.3739, device='cuda:3')
benign distance is  tensor(109.3739, device='cuda:3')
norm1 res is  tensor(468.5026, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5051757097244263
distance x is tensor(108.8928, device='cuda:3')
benign distance is  tensor(108.8928, device='cuda:3')
norm1 res is  tensor(471.3713, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7813261151313782
distance x is tensor(105.1190, device='cuda:3')
benign distance is  tensor(105.1190, device='cuda:3')
norm1 res is  tensor(459.1832, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3933331072330475
distance x is tensor(104.7693, device='cuda:3')
benign distance is  tensor(104.7693, device='cuda:3')
norm1 res is  tensor(447.4231, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5401800870895386
distance x is tensor(112.9980, device='cuda:3')
benign distance is  tensor(112.9980, device='cuda:3')
norm1 res is  tensor(493.2440, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3953574597835541
distance x is tensor(118.1389, device='cuda:3')
benign distance is  tensor(118.1389, device='cuda:3')
norm1 res is  tensor(509.7988, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4709095060825348
distance x is tensor(108.5506, device='cuda:3')
benign distance is  tensor(108.5506, device='cuda:3')
norm1 res is  tensor(477.5865, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7725055813789368
distance x is tensor(115.6010, device='cuda:3')
benign distance is  tensor(115.6010, device='cuda:3')
norm1 res is  tensor(500.0118, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4641464352607727
distance x is tensor(107.9890, device='cuda:3')
benign distance is  tensor(107.9890, device='cuda:3')
norm1 res is  tensor(468.8712, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8891515731811523
distance x is tensor(118.6024, device='cuda:3')
benign distance is  tensor(118.6024, device='cuda:3')
norm1 res is  tensor(512.5241, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.0769946351647377
distance x is tensor(99.2107, device='cuda:3')
benign distance is  tensor(99.2107, device='cuda:3')
norm1 res is  tensor(428.5410, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.28462937474250793
distance x is tensor(101.0450, device='cuda:3')
benign distance is  tensor(101.0450, device='cuda:3')
norm1 res is  tensor(452.8520, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5231560468673706
distance x is tensor(107.1303, device='cuda:3')
benign distance is  tensor(107.1303, device='cuda:3')
norm1 res is  tensor(462.6299, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.018373966217041
distance x is tensor(108.6571, device='cuda:3')
benign distance is  tensor(108.6571, device='cuda:3')
norm1 res is  tensor(459.0855, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.0572778694331646
distance x is tensor(109.3524, device='cuda:3')
benign distance is  tensor(109.3524, device='cuda:3')
norm1 res is  tensor(473.8835, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.40057769417762756
distance x is tensor(104.0563, device='cuda:3')
benign distance is  tensor(104.0563, device='cuda:3')
norm1 res is  tensor(440.7055, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.49324852228164673
distance x is tensor(113.8076, device='cuda:3')
benign distance is  tensor(113.8076, device='cuda:3')
norm1 res is  tensor(500.0463, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9312639236450195
distance x is tensor(106.0382, device='cuda:3')
benign distance is  tensor(106.0382, device='cuda:3')
norm1 res is  tensor(446.2607, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.6808723211288452
distance x is tensor(106.1180, device='cuda:3')
benign distance is  tensor(106.1180, device='cuda:3')
norm1 res is  tensor(459.4706, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.590582549571991
distance x is tensor(113.9993, device='cuda:3')
benign distance is  tensor(113.9993, device='cuda:3')
norm1 res is  tensor(491.6238, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.892697811126709
distance x is tensor(106.6244, device='cuda:3')
benign distance is  tensor(106.6244, device='cuda:3')
norm1 res is  tensor(466.6664, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.7358475923538208
distance x is tensor(108.2343, device='cuda:3')
benign distance is  tensor(108.2343, device='cuda:3')
norm1 res is  tensor(487.2754, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.38704022765159607
distance x is tensor(114.2360, device='cuda:3')
benign distance is  tensor(114.2360, device='cuda:3')
norm1 res is  tensor(497.6537, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.5986104011535645
distance x is tensor(110.6490, device='cuda:3')
benign distance is  tensor(110.6490, device='cuda:3')
norm1 res is  tensor(488.8713, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.03783774375915527
distance x is tensor(110.6538, device='cuda:3')
benign distance is  tensor(110.6538, device='cuda:3')
norm1 res is  tensor(475.7872, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.22905878722667694
distance x is tensor(105.4883, device='cuda:3')
benign distance is  tensor(105.4883, device='cuda:3')
norm1 res is  tensor(451.8882, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.14714226126670837
distance x is tensor(101.3043, device='cuda:3')
benign distance is  tensor(101.3043, device='cuda:3')
norm1 res is  tensor(444.6237, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.327014297246933
distance x is tensor(112.3171, device='cuda:3')
benign distance is  tensor(112.3171, device='cuda:3')
norm1 res is  tensor(478.2480, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.31621575355529785
distance x is tensor(104.7786, device='cuda:3')
benign distance is  tensor(104.7786, device='cuda:3')
norm1 res is  tensor(455.2381, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.4217601716518402
distance x is tensor(123.7811, device='cuda:3')
benign distance is  tensor(123.7811, device='cuda:3')
norm1 res is  tensor(530.5469, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.8402363061904907
distance x is tensor(106.5066, device='cuda:3')
benign distance is  tensor(106.5066, device='cuda:3')
norm1 res is  tensor(455.5298, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6319069862365723
distance x is tensor(114.1097, device='cuda:3')
benign distance is  tensor(114.1097, device='cuda:3')
norm1 res is  tensor(511.6328, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(104.4626, device='cuda:3')
compute distance is  tensor(104.4626, device='cuda:3')
compute norm is  tensor(47.5019, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.1911, device='cuda:3')
compute distance is  tensor(104.1911, device='cuda:3')
compute norm is  tensor(47.5774, device='cuda:3', dtype=torch.float64)
distance x is tensor(94.7842, device='cuda:3')
compute distance is  tensor(94.7842, device='cuda:3')
compute norm is  tensor(47.4847, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.4339, device='cuda:3')
compute distance is  tensor(107.4339, device='cuda:3')
compute norm is  tensor(47.5757, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.3414, device='cuda:3')
compute distance is  tensor(102.3414, device='cuda:3')
compute norm is  tensor(47.4881, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.1325, device='cuda:3')
compute distance is  tensor(101.1325, device='cuda:3')
compute norm is  tensor(47.4483, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.9348, device='cuda:3')
compute distance is  tensor(98.9348, device='cuda:3')
compute norm is  tensor(47.5695, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.2211, device='cuda:3')
compute distance is  tensor(98.2211, device='cuda:3')
compute norm is  tensor(47.3836, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.2113, device='cuda:3')
compute distance is  tensor(104.2113, device='cuda:3')
compute norm is  tensor(47.4697, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.8482, device='cuda:3')
compute distance is  tensor(103.8482, device='cuda:3')
compute norm is  tensor(47.5342, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.6319, device='cuda:3')
compute distance is  tensor(113.6319, device='cuda:3')
compute norm is  tensor(47.7659, device='cuda:3', dtype=torch.float64)
distance x is tensor(93.9269, device='cuda:3')
compute distance is  tensor(93.9269, device='cuda:3')
compute norm is  tensor(47.4119, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(113.6319, device='cuda:3')
distance x is tensor(106178.2188, device='cuda:3')
distance x is tensor(106178.2188, device='cuda:3')
________________________________
test distance is  tensor(106178.2188, device='cuda:3')
test distance1 is  tensor(106178.2188, device='cuda:3')
test similarity is  tensor(0.0306, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139297735726095.28
test entropy is  0.0
________________________________
cal ratio is  0.032059626210216935
distance x is tensor(3404.0393, device='cuda:3')
cal_distance is  tensor(3404.0393, device='cuda:3')
cal ratio is  0.17905187540755926
distance x is tensor(609.5037, device='cuda:3')
cal_distance is  tensor(609.5037, device='cuda:3')
cal ratio is  0.42314381100496246
distance x is tensor(257.9106, device='cuda:3')
cal_distance is  tensor(257.9106, device='cuda:3')
cal ratio is  0.6504914592212291
distance x is tensor(167.7704, device='cuda:3')
cal_distance is  tensor(167.7704, device='cuda:3')
cal ratio is  0.8065263039478914
distance x is tensor(135.3122, device='cuda:3')
cal_distance is  tensor(135.3122, device='cuda:3')
cal ratio is  0.8980648362005031
distance x is tensor(121.5196, device='cuda:3')
cal_distance is  tensor(121.5196, device='cuda:3')
cal ratio is  0.9476608114863948
distance x is tensor(115.1597, device='cuda:3')
cal_distance is  tensor(115.1597, device='cuda:3')
cal ratio is  0.9734776207017426
distance x is tensor(112.1055, device='cuda:3')
cal_distance is  tensor(112.1055, device='cuda:3')
distance x is tensor(112.1055, device='cuda:3')
return_distance is  tensor(112.1055, device='cuda:3')
distance x is tensor(112.0956, device='cuda:3')
distance x is tensor(112.0956, device='cuda:3')
________________________________
test distance is  tensor(112.0956, device='cuda:3')
test distance1 is  tensor(112.0956, device='cuda:3')
test similarity is  tensor(0.9642, device='cuda:3')
test acc is  0.10000000015633198
test loss is 134.50048996492237
test entropy is  6.8659503043250375e-18
________________________________
0
distance x is tensor(112.0956, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  6.6719513364287216e-18
avg test loss is  134.45820051571454
avg accuracy is  0.6538833334896669
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9642, device='cuda:3')
compute_distance is  tensor(112.0956, device='cuda:3')
compute_norm is  tensor(47.6048, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(102.9814, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8098479857576936
avg test loss is  1.2540859266130655
avg accuracy is  0.8889666668229884
solo acc is  0.3500000001563404
compute similarity  is  tensor(0.9660, device='cuda:3')
compute_distance is  tensor(102.9814, device='cuda:3')
compute_norm is  tensor(46.8760, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(104.7130, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.780501619076678
avg test loss is  1.3077825773626501
avg accuracy is  0.8897833334896551
solo acc is  0.27728333348967227
compute similarity  is  tensor(0.9655, device='cuda:3')
compute_distance is  tensor(104.7130, device='cuda:3')
compute_norm is  tensor(46.5829, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(106.2133, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7867467784678249
avg test loss is  1.265641371260828
avg accuracy is  0.8908500001563217
solo acc is  0.2749833334896722
compute similarity  is  tensor(0.9651, device='cuda:3')
compute_distance is  tensor(106.2133, device='cuda:3')
compute_norm is  tensor(46.3143, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(107.6545, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7745328093134264
avg test loss is  1.2721554450134733
avg accuracy is  0.892883333489655
solo acc is  0.2538833334896716
compute similarity  is  tensor(0.9648, device='cuda:3')
compute_distance is  tensor(107.6545, device='cuda:3')
compute_norm is  tensor(46.0575, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(109.1197, device='cuda:3')
distance x is tensor(109.1197, device='cuda:3')
________________________________
test distance is  tensor(109.1197, device='cuda:3')
test distance1 is  tensor(109.1197, device='cuda:3')
test similarity is  tensor(0.9645, device='cuda:3')
test acc is  0.25700000015633845
test loss is 1.2402672425134857
test entropy is  0.7759956399769162
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.0476990938186646
mal norm is  tensor(551.3126, device='cuda:3')
distance x is tensor(109.1272, device='cuda:3')
mal distance is  tensor(109.1272, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([27., 27., 27., 27., 27., 27., 27., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 27., 27., 27., 27., 27., 27., 27.])
count_res tensor([6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 90.34% 

Test Accuracy: 89.39% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4339107573032379
distance x is tensor(76.4255, device='cuda:3')
benign distance is  tensor(76.4255, device='cuda:3')
norm1 res is  tensor(341.0583, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5112260580062866
distance x is tensor(91.7451, device='cuda:3')
benign distance is  tensor(91.7451, device='cuda:3')
norm1 res is  tensor(407.6543, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.028024425730109215
distance x is tensor(109.7472, device='cuda:3')
benign distance is  tensor(109.7472, device='cuda:3')
norm1 res is  tensor(472.5907, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4010797142982483
distance x is tensor(88.5139, device='cuda:3')
benign distance is  tensor(88.5139, device='cuda:3')
norm1 res is  tensor(381.0141, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3372907340526581
distance x is tensor(81.6546, device='cuda:3')
benign distance is  tensor(81.6546, device='cuda:3')
norm1 res is  tensor(345.0102, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.1745954304933548
distance x is tensor(83.1315, device='cuda:3')
benign distance is  tensor(83.1315, device='cuda:3')
norm1 res is  tensor(360.4906, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4266039729118347
distance x is tensor(88.8914, device='cuda:3')
benign distance is  tensor(88.8914, device='cuda:3')
norm1 res is  tensor(379.2930, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.35741549730300903
distance x is tensor(96.8186, device='cuda:3')
benign distance is  tensor(96.8186, device='cuda:3')
norm1 res is  tensor(424.6640, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3889041841030121
distance x is tensor(129.9315, device='cuda:3')
benign distance is  tensor(129.9315, device='cuda:3')
norm1 res is  tensor(565.3277, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.31882235407829285
distance x is tensor(113.8558, device='cuda:3')
benign distance is  tensor(113.8558, device='cuda:3')
norm1 res is  tensor(510.3831, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.07922615110874176
distance x is tensor(109.9433, device='cuda:3')
benign distance is  tensor(109.9433, device='cuda:3')
norm1 res is  tensor(492.5723, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.12065055221319199
distance x is tensor(108.4348, device='cuda:3')
benign distance is  tensor(108.4348, device='cuda:3')
norm1 res is  tensor(474.5564, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4353361129760742
distance x is tensor(103.0012, device='cuda:3')
benign distance is  tensor(103.0012, device='cuda:3')
norm1 res is  tensor(448.1847, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.3601352274417877
distance x is tensor(109.4394, device='cuda:3')
benign distance is  tensor(109.4394, device='cuda:3')
norm1 res is  tensor(468.3373, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.5718212127685547
distance x is tensor(103.1166, device='cuda:3')
benign distance is  tensor(103.1166, device='cuda:3')
norm1 res is  tensor(438.0055, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.2599579393863678
distance x is tensor(98.0231, device='cuda:3')
benign distance is  tensor(98.0231, device='cuda:3')
norm1 res is  tensor(429.6071, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(104.4675, device='cuda:3')
compute distance is  tensor(104.4675, device='cuda:3')
compute norm is  tensor(47.5457, device='cuda:3', dtype=torch.float64)
distance x is tensor(94.9378, device='cuda:3')
compute distance is  tensor(94.9378, device='cuda:3')
compute norm is  tensor(47.4868, device='cuda:3', dtype=torch.float64)
distance x is tensor(93.0251, device='cuda:3')
compute distance is  tensor(93.0251, device='cuda:3')
compute norm is  tensor(47.5274, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.8106, device='cuda:3')
compute distance is  tensor(98.8106, device='cuda:3')
compute norm is  tensor(47.5984, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.9383, device='cuda:3')
compute distance is  tensor(101.9383, device='cuda:3')
compute norm is  tensor(47.5410, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.1752, device='cuda:3')
compute distance is  tensor(100.1752, device='cuda:3')
compute norm is  tensor(47.5778, device='cuda:3', dtype=torch.float64)
distance x is tensor(97.3629, device='cuda:3')
compute distance is  tensor(97.3629, device='cuda:3')
compute norm is  tensor(47.5896, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.2116, device='cuda:3')
compute distance is  tensor(115.2116, device='cuda:3')
compute norm is  tensor(47.8204, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.2890, device='cuda:3')
compute distance is  tensor(104.2890, device='cuda:3')
compute norm is  tensor(47.5593, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.4681, device='cuda:3')
compute distance is  tensor(105.4681, device='cuda:3')
compute norm is  tensor(47.8383, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.3872, device='cuda:3')
compute distance is  tensor(111.3872, device='cuda:3')
compute norm is  tensor(47.9071, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.9497, device='cuda:3')
compute distance is  tensor(100.9497, device='cuda:3')
compute norm is  tensor(47.5914, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(115.2116, device='cuda:3')
distance x is tensor(106180.6406, device='cuda:3')
distance x is tensor(106180.6406, device='cuda:3')
________________________________
test distance is  tensor(106180.6406, device='cuda:3')
test distance1 is  tensor(106180.6406, device='cuda:3')
test similarity is  tensor(0.0179, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139286964735537.12
test entropy is  0.0
________________________________
cal ratio is  0.03228134104388929
distance x is tensor(3427.6587, device='cuda:3')
cal_distance is  tensor(3427.6587, device='cuda:3')
cal ratio is  0.17966995296218202
distance x is tensor(615.8514, device='cuda:3')
cal_distance is  tensor(615.8514, device='cuda:3')
cal ratio is  0.42387350885375874
distance x is tensor(261.0459, device='cuda:3')
cal_distance is  tensor(261.0459, device='cuda:3')
cal ratio is  0.6510521398988728
distance x is tensor(169.9563, device='cuda:3')
cal_distance is  tensor(169.9563, device='cuda:3')
cal ratio is  0.8068739067383444
distance x is tensor(137.1342, device='cuda:3')
cal_distance is  tensor(137.1342, device='cuda:3')
cal ratio is  0.898258367430469
distance x is tensor(123.1825, device='cuda:3')
cal_distance is  tensor(123.1825, device='cuda:3')
cal ratio is  0.947762922153109
distance x is tensor(116.7481, device='cuda:3')
cal_distance is  tensor(116.7481, device='cuda:3')
cal ratio is  0.973530160587093
distance x is tensor(113.6579, device='cuda:3')
cal_distance is  tensor(113.6579, device='cuda:3')
distance x is tensor(113.6579, device='cuda:3')
return_distance is  tensor(113.6579, device='cuda:3')
distance x is tensor(113.6480, device='cuda:3')
distance x is tensor(113.6480, device='cuda:3')
________________________________
test distance is  tensor(113.6480, device='cuda:3')
test distance1 is  tensor(113.6480, device='cuda:3')
test similarity is  tensor(0.9632, device='cuda:3')
test acc is  0.10000000015633198
test loss is 153.9999257964112
test entropy is  7.953879962830744e-19
________________________________
0
distance x is tensor(113.6480, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3443215854444701e-18
avg test loss is  153.962086081759
avg accuracy is  0.6267666668230023
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9632, device='cuda:3')
compute_distance is  tensor(113.6480, device='cuda:3')
compute_norm is  tensor(47.6768, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(103.5742, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8091272900480706
avg test loss is  1.2612407882330514
avg accuracy is  0.8916500001563217
solo acc is  0.3473000001563404
compute similarity  is  tensor(0.9653, device='cuda:3')
compute_distance is  tensor(103.5742, device='cuda:3')
compute_norm is  tensor(46.8868, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(105.4482, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7851067140285395
avg test loss is  1.3080062307655684
avg accuracy is  0.890533333489655
solo acc is  0.2788166668230057
compute similarity  is  tensor(0.9648, device='cuda:3')
compute_distance is  tensor(105.4482, device='cuda:3')
compute_norm is  tensor(46.5903, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(107.0405, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7845805239702847
avg test loss is  1.2800381311348505
avg accuracy is  0.8929000001563216
solo acc is  0.26911666682300545
compute similarity  is  tensor(0.9644, device='cuda:3')
compute_distance is  tensor(107.0405, device='cuda:3')
compute_norm is  tensor(46.3184, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(108.5705, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7807952507472495
avg test loss is  1.265220996286315
avg accuracy is  0.8949000001563215
solo acc is  0.25753333348967183
compute similarity  is  tensor(0.9641, device='cuda:3')
compute_distance is  tensor(108.5705, device='cuda:3')
compute_norm is  tensor(46.0600, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(110.0754, device='cuda:3')
distance x is tensor(110.0754, device='cuda:3')
________________________________
test distance is  tensor(110.0754, device='cuda:3')
test distance1 is  tensor(110.0754, device='cuda:3')
test similarity is  tensor(0.9638, device='cuda:3')
test acc is  0.25470000015633837
test loss is 1.2462961781762047
test entropy is  0.7778868783257409
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.133651614189148
mal norm is  tensor(557.2382, device='cuda:3')
distance x is tensor(110.0825, device='cuda:3')
mal distance is  tensor(110.0825, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([27., 27., 27., 27., 27., 27., 27., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 27., 27., 27., 27., 27., 27., 27.])
count_res tensor([6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 90.59% 

Test Accuracy: 89.59% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3317115008831024
distance x is tensor(88.5370, device='cuda:3')
benign distance is  tensor(88.5370, device='cuda:3')
norm1 res is  tensor(389.0973, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7638112306594849
distance x is tensor(82.7969, device='cuda:3')
benign distance is  tensor(82.7969, device='cuda:3')
norm1 res is  tensor(377.3279, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.20247873663902283
distance x is tensor(94.0991, device='cuda:3')
benign distance is  tensor(94.0991, device='cuda:3')
norm1 res is  tensor(410.1938, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.34186720848083496
distance x is tensor(78.3107, device='cuda:3')
benign distance is  tensor(78.3107, device='cuda:3')
norm1 res is  tensor(339.6745, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7334359288215637
distance x is tensor(87.7332, device='cuda:3')
benign distance is  tensor(87.7332, device='cuda:3')
norm1 res is  tensor(381.8363, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4498138427734375
distance x is tensor(88.0434, device='cuda:3')
benign distance is  tensor(88.0434, device='cuda:3')
norm1 res is  tensor(374.6659, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3809058368206024
distance x is tensor(75.3341, device='cuda:3')
benign distance is  tensor(75.3341, device='cuda:3')
norm1 res is  tensor(320.4587, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5970504879951477
distance x is tensor(90.0361, device='cuda:3')
benign distance is  tensor(90.0361, device='cuda:3')
norm1 res is  tensor(397.8407, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5817747116088867
distance x is tensor(122.2228, device='cuda:3')
benign distance is  tensor(122.2228, device='cuda:3')
norm1 res is  tensor(531.1600, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4960900843143463
distance x is tensor(103.5858, device='cuda:3')
benign distance is  tensor(103.5858, device='cuda:3')
norm1 res is  tensor(451.5101, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.12344889342784882
distance x is tensor(97.9614, device='cuda:3')
benign distance is  tensor(97.9614, device='cuda:3')
norm1 res is  tensor(425.4617, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7061747908592224
distance x is tensor(103.5218, device='cuda:3')
benign distance is  tensor(103.5218, device='cuda:3')
norm1 res is  tensor(450.8740, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.47488969564437866
distance x is tensor(103.0223, device='cuda:3')
benign distance is  tensor(103.0223, device='cuda:3')
norm1 res is  tensor(454.9363, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.40704917907714844
distance x is tensor(107.4064, device='cuda:3')
benign distance is  tensor(107.4064, device='cuda:3')
norm1 res is  tensor(473.8968, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.38646116852760315
distance x is tensor(112.1707, device='cuda:3')
benign distance is  tensor(112.1707, device='cuda:3')
norm1 res is  tensor(502.4628, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6067209243774414
distance x is tensor(114.9531, device='cuda:3')
benign distance is  tensor(114.9531, device='cuda:3')
norm1 res is  tensor(494.8552, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(100.5537, device='cuda:3')
compute distance is  tensor(100.5537, device='cuda:3')
compute norm is  tensor(47.8983, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.2393, device='cuda:3')
compute distance is  tensor(103.2393, device='cuda:3')
compute norm is  tensor(47.9925, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.3244, device='cuda:3')
compute distance is  tensor(101.3244, device='cuda:3')
compute norm is  tensor(48.0855, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.8302, device='cuda:3')
compute distance is  tensor(101.8302, device='cuda:3')
compute norm is  tensor(47.9322, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.7816, device='cuda:3')
compute distance is  tensor(108.7816, device='cuda:3')
compute norm is  tensor(48.0258, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.1286, device='cuda:3')
compute distance is  tensor(113.1286, device='cuda:3')
compute norm is  tensor(48.1606, device='cuda:3', dtype=torch.float64)
distance x is tensor(96.8791, device='cuda:3')
compute distance is  tensor(96.8791, device='cuda:3')
compute norm is  tensor(47.9934, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.6393, device='cuda:3')
compute distance is  tensor(112.6393, device='cuda:3')
compute norm is  tensor(48.1378, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.1765, device='cuda:3')
compute distance is  tensor(114.1765, device='cuda:3')
compute norm is  tensor(48.2430, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.9209, device='cuda:3')
compute distance is  tensor(109.9209, device='cuda:3')
compute norm is  tensor(48.2337, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.0046, device='cuda:3')
compute distance is  tensor(109.0046, device='cuda:3')
compute norm is  tensor(48.1715, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.4707, device='cuda:3')
compute distance is  tensor(124.4707, device='cuda:3')
compute norm is  tensor(48.3999, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(124.4707, device='cuda:3')
distance x is tensor(106181.1250, device='cuda:3')
distance x is tensor(106181.1250, device='cuda:3')
________________________________
test distance is  tensor(106181.1250, device='cuda:3')
test distance1 is  tensor(106181.1250, device='cuda:3')
test similarity is  tensor(0.0170, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139308676152226.11
test entropy is  0.0
________________________________
cal ratio is  0.03355336252711828
distance x is tensor(3562.7393, device='cuda:3')
cal_distance is  tensor(3562.7393, device='cuda:3')
cal ratio is  0.18317562733865966
distance x is tensor(652.6110, device='cuda:3')
cal_distance is  tensor(652.6110, device='cuda:3')
cal ratio is  0.4279888931609155
distance x is tensor(279.3131, device='cuda:3')
cal_distance is  tensor(279.3131, device='cuda:3')
cal ratio is  0.6542053059740185
distance x is tensor(182.7298, device='cuda:3')
cal_distance is  tensor(182.7298, device='cuda:3')
cal ratio is  0.8088257829427179
distance x is tensor(147.7976, device='cuda:3')
cal_distance is  tensor(147.7976, device='cuda:3')
cal ratio is  0.8993444661437455
distance x is tensor(132.9214, device='cuda:3')
cal_distance is  tensor(132.9214, device='cuda:3')
cal ratio is  0.9483359994889935
distance x is tensor(126.0544, device='cuda:3')
cal_distance is  tensor(126.0544, device='cuda:3')
cal ratio is  0.9738243844656291
distance x is tensor(122.7550, device='cuda:3')
cal_distance is  tensor(122.7550, device='cuda:3')
distance x is tensor(122.7550, device='cuda:3')
return_distance is  tensor(122.7550, device='cuda:3')
distance x is tensor(122.7451, device='cuda:3')
distance x is tensor(122.7451, device='cuda:3')
________________________________
test distance is  tensor(122.7451, device='cuda:3')
test distance1 is  tensor(122.7451, device='cuda:3')
test similarity is  tensor(0.9581, device='cuda:3')
test acc is  0.10000000015633198
test loss is 202.93660332653315
test entropy is  8.098291078684246e-23
________________________________
0
distance x is tensor(122.7451, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.4293358648341062e-22
avg test loss is  202.90087669388825
avg accuracy is  0.5525333334896751
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9581, device='cuda:3')
compute_distance is  tensor(122.7451, device='cuda:3')
compute_norm is  tensor(48.2366, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(110.6852, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8186926289535026
avg test loss is  1.2490030260863842
avg accuracy is  0.8903666668229883
solo acc is  0.3624000001563406
compute similarity  is  tensor(0.9613, device='cuda:3')
compute_distance is  tensor(110.6852, device='cuda:3')
compute_norm is  tensor(47.4812, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(112.5662, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7889430277001883
avg test loss is  1.3175557809216636
avg accuracy is  0.8916000001563217
solo acc is  0.2819333334896724
compute similarity  is  tensor(0.9608, device='cuda:3')
compute_distance is  tensor(112.5662, device='cuda:3')
compute_norm is  tensor(47.1846, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(114.2519, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7727442128317696
avg test loss is  1.329240365577405
avg accuracy is  0.8917000001563216
solo acc is  0.2512833334896716
compute similarity  is  tensor(0.9604, device='cuda:3')
compute_distance is  tensor(114.2519, device='cuda:3')
compute_norm is  tensor(46.9095, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.8379, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7819281836816752
avg test loss is  1.2737910584218974
avg accuracy is  0.8936166668229882
solo acc is  0.26170000015633854
compute similarity  is  tensor(0.9600, device='cuda:3')
compute_distance is  tensor(115.8379, device='cuda:3')
compute_norm is  tensor(46.6466, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.4138, device='cuda:3')
distance x is tensor(117.4138, device='cuda:3')
________________________________
test distance is  tensor(117.4138, device='cuda:3')
test distance1 is  tensor(117.4138, device='cuda:3')
test similarity is  tensor(0.9596, device='cuda:3')
test acc is  0.24488333348967142
test loss is 1.2719953735627092
test entropy is  0.774407163230595
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.262157917022705
mal norm is  tensor(595.2858, device='cuda:3')
distance x is tensor(117.4208, device='cuda:3')
mal distance is  tensor(117.4208, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([27., 27., 27., 27., 27., 27., 27., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 27., 27., 27., 27., 27., 27., 27.])
count_res tensor([6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 90.41% 

Test Accuracy: 89.61% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5993396639823914
distance x is tensor(93.9357, device='cuda:3')
benign distance is  tensor(93.9357, device='cuda:3')
norm1 res is  tensor(401.3222, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.36188268661499023
distance x is tensor(102.7250, device='cuda:3')
benign distance is  tensor(102.7250, device='cuda:3')
norm1 res is  tensor(453.0201, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.08143336325883865
distance x is tensor(94.7329, device='cuda:3')
benign distance is  tensor(94.7329, device='cuda:3')
norm1 res is  tensor(416.8728, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5542598366737366
distance x is tensor(82.2485, device='cuda:3')
benign distance is  tensor(82.2485, device='cuda:3')
norm1 res is  tensor(360.4603, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5418201684951782
distance x is tensor(81.1829, device='cuda:3')
benign distance is  tensor(81.1829, device='cuda:3')
norm1 res is  tensor(345.7545, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5236231684684753
distance x is tensor(95.1535, device='cuda:3')
benign distance is  tensor(95.1535, device='cuda:3')
norm1 res is  tensor(406.4679, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.0934087261557579
distance x is tensor(88.3014, device='cuda:3')
benign distance is  tensor(88.3014, device='cuda:3')
norm1 res is  tensor(376.3555, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.30402830243110657
distance x is tensor(83.4168, device='cuda:3')
benign distance is  tensor(83.4168, device='cuda:3')
norm1 res is  tensor(367.5135, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.08633717149496078
distance x is tensor(107.2789, device='cuda:3')
benign distance is  tensor(107.2789, device='cuda:3')
norm1 res is  tensor(470.9502, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5190540552139282
distance x is tensor(120.2346, device='cuda:3')
benign distance is  tensor(120.2346, device='cuda:3')
norm1 res is  tensor(537.5129, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3300660252571106
distance x is tensor(113.0958, device='cuda:3')
benign distance is  tensor(113.0958, device='cuda:3')
norm1 res is  tensor(505.9334, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.14076167345046997
distance x is tensor(106.3123, device='cuda:3')
benign distance is  tensor(106.3123, device='cuda:3')
norm1 res is  tensor(470.7920, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.21157944202423096
distance x is tensor(107.2068, device='cuda:3')
benign distance is  tensor(107.2068, device='cuda:3')
norm1 res is  tensor(475.0507, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5314491391181946
distance x is tensor(99.0609, device='cuda:3')
benign distance is  tensor(99.0609, device='cuda:3')
norm1 res is  tensor(426.7203, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.01801961101591587
distance x is tensor(119.9183, device='cuda:3')
benign distance is  tensor(119.9183, device='cuda:3')
norm1 res is  tensor(518.9481, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.0644339770078659
distance x is tensor(109.4026, device='cuda:3')
benign distance is  tensor(109.4026, device='cuda:3')
norm1 res is  tensor(473.8077, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(110.6344, device='cuda:3')
compute distance is  tensor(110.6344, device='cuda:3')
compute norm is  tensor(48.1960, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.7605, device='cuda:3')
compute distance is  tensor(95.7605, device='cuda:3')
compute norm is  tensor(48.0328, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.1511, device='cuda:3')
compute distance is  tensor(121.1511, device='cuda:3')
compute norm is  tensor(48.5661, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.2682, device='cuda:3')
compute distance is  tensor(100.2682, device='cuda:3')
compute norm is  tensor(48.1212, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.4448, device='cuda:3')
compute distance is  tensor(117.4448, device='cuda:3')
compute norm is  tensor(48.3804, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.8444, device='cuda:3')
compute distance is  tensor(106.8444, device='cuda:3')
compute norm is  tensor(48.1558, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.0607, device='cuda:3')
compute distance is  tensor(104.0607, device='cuda:3')
compute norm is  tensor(48.2500, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.9737, device='cuda:3')
compute distance is  tensor(114.9737, device='cuda:3')
compute norm is  tensor(48.3448, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.0107, device='cuda:3')
compute distance is  tensor(111.0107, device='cuda:3')
compute norm is  tensor(48.2566, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.5610, device='cuda:3')
compute distance is  tensor(115.5610, device='cuda:3')
compute norm is  tensor(48.2471, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.4109, device='cuda:3')
compute distance is  tensor(105.4109, device='cuda:3')
compute norm is  tensor(48.2335, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.7180, device='cuda:3')
compute distance is  tensor(106.7180, device='cuda:3')
compute norm is  tensor(48.2023, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(121.1511, device='cuda:3')
distance x is tensor(106180.9453, device='cuda:3')
distance x is tensor(106180.9453, device='cuda:3')
________________________________
test distance is  tensor(106180.9453, device='cuda:3')
test distance1 is  tensor(106180.9453, device='cuda:3')
test similarity is  tensor(0.0181, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139295703474018.8
test entropy is  0.0
________________________________
cal ratio is  0.03310292960306606
distance x is tensor(3514.9058, device='cuda:3')
cal_distance is  tensor(3514.9058, device='cuda:3')
cal ratio is  0.18194195919082656
distance x is tensor(639.5128, device='cuda:3')
cal_distance is  tensor(639.5128, device='cuda:3')
cal ratio is  0.42654523212987466
distance x is tensor(272.7840, device='cuda:3')
cal_distance is  tensor(272.7840, device='cuda:3')
cal ratio is  0.653100885475372
distance x is tensor(178.1572, device='cuda:3')
cal_distance is  tensor(178.1572, device='cuda:3')
cal ratio is  0.8081425905341497
distance x is tensor(143.9774, device='cuda:3')
cal_distance is  tensor(143.9774, device='cuda:3')
cal ratio is  0.8989645158784216
distance x is tensor(129.4311, device='cuda:3')
cal_distance is  tensor(129.4311, device='cuda:3')
cal ratio is  0.9481355735174141
distance x is tensor(122.7185, device='cuda:3')
cal_distance is  tensor(122.7185, device='cuda:3')
cal ratio is  0.9737214794193526
distance x is tensor(119.4938, device='cuda:3')
cal_distance is  tensor(119.4938, device='cuda:3')
distance x is tensor(119.4938, device='cuda:3')
return_distance is  tensor(119.4938, device='cuda:3')
distance x is tensor(119.4839, device='cuda:3')
distance x is tensor(119.4839, device='cuda:3')
________________________________
test distance is  tensor(119.4839, device='cuda:3')
test distance1 is  tensor(119.4839, device='cuda:3')
test similarity is  tensor(0.9604, device='cuda:3')
test acc is  0.10000000015633198
test loss is 183.63569092903055
test entropy is  6.508670749322519e-21
________________________________
0
distance x is tensor(119.4839, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  3.513198488121329e-22
avg test loss is  183.68572176544905
avg accuracy is  0.5798500001563393
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9604, device='cuda:3')
compute_distance is  tensor(119.4839, device='cuda:3')
compute_norm is  tensor(48.3029, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(108.4419, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8076670507886516
avg test loss is  1.28591941249396
avg accuracy is  0.8878500001563218
solo acc is  0.3389833334896736
compute similarity  is  tensor(0.9632, device='cuda:3')
compute_distance is  tensor(108.4419, device='cuda:3')
compute_norm is  tensor(47.5499, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(110.3835, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7887236303103758
avg test loss is  1.3322773920828854
avg accuracy is  0.8905166668229884
solo acc is  0.2706166668230055
compute similarity  is  tensor(0.9627, device='cuda:3')
compute_distance is  tensor(110.3835, device='cuda:3')
compute_norm is  tensor(47.2557, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(112.1076, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.791633887013901
avg test loss is  1.2794380583234433
avg accuracy is  0.891483333489655
solo acc is  0.2738333334896722
compute similarity  is  tensor(0.9622, device='cuda:3')
compute_distance is  tensor(112.1076, device='cuda:3')
compute_norm is  tensor(46.9834, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(113.7642, device='cuda:3')
exit early
distance x is tensor(113.7642, device='cuda:3')
distance x is tensor(113.7642, device='cuda:3')
________________________________
test distance is  tensor(113.7642, device='cuda:3')
test distance1 is  tensor(113.7642, device='cuda:3')
test similarity is  tensor(0.9618, device='cuda:3')
test acc is  0.25763333348967177
test loss is 1.2771174021875427
test entropy is  0.7790034908348563
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.1840014457702637
mal norm is  tensor(581.6454, device='cuda:3')
distance x is tensor(113.7710, device='cuda:3')
mal distance is  tensor(113.7710, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([35., 35., 35., 35., 35., 35., 35., 35., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 35., 35., 35., 35., 35., 35., 35., 35.,
        35., 35., 35., 35., 35., 35., 35., 35.])
count_res tensor([4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07,
        6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07,
        6.9590e-07, 6.9590e-07, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 90.56% 

Test Accuracy: 89.57% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7916275262832642
distance x is tensor(70.8684, device='cuda:3')
benign distance is  tensor(70.8684, device='cuda:3')
norm1 res is  tensor(317.3237, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4803277552127838
distance x is tensor(87.5862, device='cuda:3')
benign distance is  tensor(87.5862, device='cuda:3')
norm1 res is  tensor(385.1305, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.16842901706695557
distance x is tensor(109.7496, device='cuda:3')
benign distance is  tensor(109.7496, device='cuda:3')
norm1 res is  tensor(471.2766, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.34391868114471436
distance x is tensor(95.9700, device='cuda:3')
benign distance is  tensor(95.9700, device='cuda:3')
norm1 res is  tensor(412.3193, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.40262192487716675
distance x is tensor(67.5975, device='cuda:3')
benign distance is  tensor(67.5975, device='cuda:3')
norm1 res is  tensor(290.4301, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.49564871191978455
distance x is tensor(96.9684, device='cuda:3')
benign distance is  tensor(96.9684, device='cuda:3')
norm1 res is  tensor(424.3829, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3673722445964813
distance x is tensor(81.0930, device='cuda:3')
benign distance is  tensor(81.0930, device='cuda:3')
norm1 res is  tensor(353.1129, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2429896593093872
distance x is tensor(88.9302, device='cuda:3')
benign distance is  tensor(88.9302, device='cuda:3')
norm1 res is  tensor(388.4043, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.059234511107206345
distance x is tensor(104.3075, device='cuda:3')
benign distance is  tensor(104.3075, device='cuda:3')
norm1 res is  tensor(455.8686, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5388935804367065
distance x is tensor(110.2480, device='cuda:3')
benign distance is  tensor(110.2480, device='cuda:3')
norm1 res is  tensor(486.4482, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.507038950920105
distance x is tensor(96.6010, device='cuda:3')
benign distance is  tensor(96.6010, device='cuda:3')
norm1 res is  tensor(425.0384, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6751799583435059
distance x is tensor(110.4709, device='cuda:3')
benign distance is  tensor(110.4709, device='cuda:3')
norm1 res is  tensor(481.9615, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7377476096153259
distance x is tensor(104.9148, device='cuda:3')
benign distance is  tensor(104.9148, device='cuda:3')
norm1 res is  tensor(466.2836, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.23801851272583008
distance x is tensor(112.2037, device='cuda:3')
benign distance is  tensor(112.2037, device='cuda:3')
norm1 res is  tensor(500.5310, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.43478304147720337
distance x is tensor(94.9554, device='cuda:3')
benign distance is  tensor(94.9554, device='cuda:3')
norm1 res is  tensor(419.3218, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6177878975868225
distance x is tensor(104.7899, device='cuda:3')
benign distance is  tensor(104.7899, device='cuda:3')
norm1 res is  tensor(453.4518, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.37453562021255493
distance x is tensor(114.6214, device='cuda:3')
benign distance is  tensor(114.6214, device='cuda:3')
norm1 res is  tensor(491.7768, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9115357398986816
distance x is tensor(96.4990, device='cuda:3')
benign distance is  tensor(96.4990, device='cuda:3')
norm1 res is  tensor(413.0138, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5532790422439575
distance x is tensor(105.7302, device='cuda:3')
benign distance is  tensor(105.7302, device='cuda:3')
norm1 res is  tensor(455.8886, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5071675181388855
distance x is tensor(109.0183, device='cuda:3')
benign distance is  tensor(109.0183, device='cuda:3')
norm1 res is  tensor(474.3341, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9356924295425415
distance x is tensor(109.6809, device='cuda:3')
benign distance is  tensor(109.6809, device='cuda:3')
norm1 res is  tensor(476.0371, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.3095444142818451
distance x is tensor(111.6865, device='cuda:3')
benign distance is  tensor(111.6865, device='cuda:3')
norm1 res is  tensor(490.6386, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5178263187408447
distance x is tensor(100.3359, device='cuda:3')
benign distance is  tensor(100.3359, device='cuda:3')
norm1 res is  tensor(448.9678, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.38379043340682983
distance x is tensor(117.0003, device='cuda:3')
benign distance is  tensor(117.0003, device='cuda:3')
norm1 res is  tensor(528.2524, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(100.7108, device='cuda:3')
compute distance is  tensor(100.7108, device='cuda:3')
compute norm is  tensor(48.1754, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.4499, device='cuda:3')
compute distance is  tensor(105.4499, device='cuda:3')
compute norm is  tensor(48.2883, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.8454, device='cuda:3')
compute distance is  tensor(105.8454, device='cuda:3')
compute norm is  tensor(48.4136, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.2326, device='cuda:3')
compute distance is  tensor(106.2326, device='cuda:3')
compute norm is  tensor(48.3405, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.1936, device='cuda:3')
compute distance is  tensor(111.1936, device='cuda:3')
compute norm is  tensor(48.3955, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.4525, device='cuda:3')
compute distance is  tensor(106.4525, device='cuda:3')
compute norm is  tensor(48.3977, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.3029, device='cuda:3')
compute distance is  tensor(100.3029, device='cuda:3')
compute norm is  tensor(48.3154, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.6476, device='cuda:3')
compute distance is  tensor(103.6476, device='cuda:3')
compute norm is  tensor(48.3605, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.7489, device='cuda:3')
compute distance is  tensor(117.7489, device='cuda:3')
compute norm is  tensor(48.5279, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.3743, device='cuda:3')
compute distance is  tensor(108.3743, device='cuda:3')
compute norm is  tensor(48.3661, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.0490, device='cuda:3')
compute distance is  tensor(113.0490, device='cuda:3')
compute norm is  tensor(48.4675, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.5193, device='cuda:3')
compute distance is  tensor(105.5193, device='cuda:3')
compute norm is  tensor(48.2487, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(117.7489, device='cuda:3')
distance x is tensor(106182.2188, device='cuda:3')
distance x is tensor(106182.2188, device='cuda:3')
________________________________
test distance is  tensor(106182.2188, device='cuda:3')
test distance1 is  tensor(106182.2188, device='cuda:3')
test similarity is  tensor(0.0155, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139291304006845.95
test entropy is  0.0
________________________________
cal ratio is  0.032634622556758745
distance x is tensor(3465.2212, device='cuda:3')
cal_distance is  tensor(3465.2212, device='cuda:3')
cal ratio is  0.18065043254265867
distance x is tensor(625.9979, device='cuda:3')
cal_distance is  tensor(625.9979, device='cuda:3')
cal ratio is  0.4250285071531369
distance x is tensor(266.0697, device='cuda:3')
cal_distance is  tensor(266.0697, device='cuda:3')
cal ratio is  0.65193868594811
distance x is tensor(173.4629, device='cuda:3')
cal_distance is  tensor(173.4629, device='cuda:3')
cal ratio is  0.8074231239608163
distance x is tensor(140.0589, device='cuda:3')
cal_distance is  tensor(140.0589, device='cuda:3')
cal ratio is  0.8985641146930112
distance x is tensor(125.8524, device='cuda:3')
cal_distance is  tensor(125.8524, device='cuda:3')
cal ratio is  0.9479243257751128
distance x is tensor(119.2989, device='cuda:3')
cal_distance is  tensor(119.2989, device='cuda:3')
cal ratio is  0.9736129779168947
distance x is tensor(116.1510, device='cuda:3')
cal_distance is  tensor(116.1510, device='cuda:3')
distance x is tensor(116.1510, device='cuda:3')
return_distance is  tensor(116.1510, device='cuda:3')
distance x is tensor(116.1412, device='cuda:3')
distance x is tensor(116.1412, device='cuda:3')
________________________________
test distance is  tensor(116.1412, device='cuda:3')
test distance1 is  tensor(116.1412, device='cuda:3')
test similarity is  tensor(0.9626, device='cuda:3')
test acc is  0.10000000015633198
test loss is 164.41615889169006
test entropy is  6.229721086789324e-21
________________________________
0
distance x is tensor(116.1412, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.9148696192173441e-19
avg test loss is  164.40830110334383
avg accuracy is  0.6353166668230017
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9626, device='cuda:3')
compute_distance is  tensor(116.1412, device='cuda:3')
compute_norm is  tensor(48.3601, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(105.5222, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8317309944614418
avg test loss is  1.2217109237017154
avg accuracy is  0.891183333489655
solo acc is  0.37153333348967416
compute similarity  is  tensor(0.9650, device='cuda:3')
compute_distance is  tensor(105.5222, device='cuda:3')
compute_norm is  tensor(47.5866, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(107.5075, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7924868366611537
avg test loss is  1.3053428965336733
avg accuracy is  0.8916666668229883
solo acc is  0.2863000001563392
compute similarity  is  tensor(0.9645, device='cuda:3')
compute_distance is  tensor(107.5075, device='cuda:3')
compute_norm is  tensor(47.2851, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(109.1871, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7785446716905403
avg test loss is  1.2982559674330103
avg accuracy is  0.8920666668229882
solo acc is  0.26878333348967215
compute similarity  is  tensor(0.9641, device='cuda:3')
compute_distance is  tensor(109.1871, device='cuda:3')
compute_norm is  tensor(47.0065, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(110.8833, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7816629445374902
avg test loss is  1.2610834687630506
avg accuracy is  0.8943166668229882
solo acc is  0.2679666668230054
compute similarity  is  tensor(0.9637, device='cuda:3')
compute_distance is  tensor(110.8833, device='cuda:3')
compute_norm is  tensor(46.7432, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(112.5134, device='cuda:3')
distance x is tensor(112.5134, device='cuda:3')
________________________________
test distance is  tensor(112.5134, device='cuda:3')
test distance1 is  tensor(112.5134, device='cuda:3')
test similarity is  tensor(0.9633, device='cuda:3')
test acc is  0.2515500001563383
test loss is 1.2629361208567995
test entropy is  0.77158160479084
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.1622843742370605
mal norm is  tensor(569.1223, device='cuda:3')
distance x is tensor(112.5203, device='cuda:3')
mal distance is  tensor(112.5203, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([19., 19., 19., 19., 19., 19., 19., 19., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0669,
        0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669,
        0.0669, 0.0669])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 81.43% 

Test Accuracy: 80.41% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7525240182876587
distance x is tensor(132.3972, device='cuda:3')
benign distance is  tensor(132.3972, device='cuda:3')
norm1 res is  tensor(541.1262, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4769596457481384
distance x is tensor(131.2546, device='cuda:3')
benign distance is  tensor(131.2546, device='cuda:3')
norm1 res is  tensor(546.4359, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.09397267550230026
distance x is tensor(138.1450, device='cuda:3')
benign distance is  tensor(138.1450, device='cuda:3')
norm1 res is  tensor(578.0607, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.579210638999939
distance x is tensor(139.8278, device='cuda:3')
benign distance is  tensor(139.8278, device='cuda:3')
norm1 res is  tensor(564.1234, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9274650812149048
distance x is tensor(133.2348, device='cuda:3')
benign distance is  tensor(133.2348, device='cuda:3')
norm1 res is  tensor(538.0764, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8270574808120728
distance x is tensor(127.2584, device='cuda:3')
benign distance is  tensor(127.2584, device='cuda:3')
norm1 res is  tensor(524.6036, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.30804628133773804
distance x is tensor(134.6629, device='cuda:3')
benign distance is  tensor(134.6629, device='cuda:3')
norm1 res is  tensor(544.7357, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5466784238815308
distance x is tensor(144.5139, device='cuda:3')
benign distance is  tensor(144.5139, device='cuda:3')
norm1 res is  tensor(593.5097, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(142.2080, device='cuda:3')
compute distance is  tensor(142.2080, device='cuda:3')
compute norm is  tensor(48.3675, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.4423, device='cuda:3')
compute distance is  tensor(128.4423, device='cuda:3')
compute norm is  tensor(48.1500, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.8559, device='cuda:3')
compute distance is  tensor(140.8559, device='cuda:3')
compute norm is  tensor(48.3273, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.9925, device='cuda:3')
compute distance is  tensor(147.9925, device='cuda:3')
compute norm is  tensor(48.4942, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.0455, device='cuda:3')
compute distance is  tensor(149.0455, device='cuda:3')
compute norm is  tensor(48.5903, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.6437, device='cuda:3')
compute distance is  tensor(152.6437, device='cuda:3')
compute norm is  tensor(48.8332, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.8000, device='cuda:3')
compute distance is  tensor(146.8000, device='cuda:3')
compute norm is  tensor(48.4080, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.7294, device='cuda:3')
compute distance is  tensor(138.7294, device='cuda:3')
compute norm is  tensor(48.3196, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.7119, device='cuda:3')
compute distance is  tensor(153.7119, device='cuda:3')
compute norm is  tensor(48.4957, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.4089, device='cuda:3')
compute distance is  tensor(138.4089, device='cuda:3')
compute norm is  tensor(48.2565, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.8780, device='cuda:3')
compute distance is  tensor(142.8780, device='cuda:3')
compute norm is  tensor(48.4319, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.0045, device='cuda:3')
compute distance is  tensor(134.0045, device='cuda:3')
compute norm is  tensor(48.1294, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(153.7119, device='cuda:3')
distance x is tensor(106124.6562, device='cuda:3')
distance x is tensor(106124.6562, device='cuda:3')
________________________________
test distance is  tensor(106124.6562, device='cuda:3')
test distance1 is  tensor(106124.6562, device='cuda:3')
test similarity is  tensor(0.2061, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139268246799873.1
test entropy is  0.0
________________________________
cal ratio is  0.03729680270980865
distance x is tensor(3958.1157, device='cuda:3')
cal_distance is  tensor(3958.1157, device='cuda:3')
cal ratio is  0.19312366870927428
distance x is tensor(764.4099, device='cuda:3')
cal_distance is  tensor(764.4099, device='cuda:3')
cal ratio is  0.4394572389537253
distance x is tensor(335.9282, device='cuda:3')
cal_distance is  tensor(335.9282, device='cuda:3')
cal ratio is  0.6629129599931749
distance x is tensor(222.6929, device='cuda:3')
cal_distance is  tensor(222.6929, device='cuda:3')
cal ratio is  0.8141915587703793
distance x is tensor(181.3156, device='cuda:3')
cal_distance is  tensor(181.3156, device='cuda:3')
cal ratio is  0.902323339058038
distance x is tensor(163.6058, device='cuda:3')
cal_distance is  tensor(163.6058, device='cuda:3')
cal ratio is  0.9499056446751063
distance x is tensor(155.4103, device='cuda:3')
cal_distance is  tensor(155.4103, device='cuda:3')
cal ratio is  0.9746301421435528
distance x is tensor(151.4677, device='cuda:3')
cal_distance is  tensor(151.4677, device='cuda:3')
distance x is tensor(151.4677, device='cuda:3')
return_distance is  tensor(151.4677, device='cuda:3')
distance x is tensor(151.4578, device='cuda:3')
distance x is tensor(151.4578, device='cuda:3')
________________________________
test distance is  tensor(151.4578, device='cuda:3')
test distance1 is  tensor(151.4578, device='cuda:3')
test similarity is  tensor(0.9477, device='cuda:3')
test acc is  0.10000000015633198
test loss is 517.6933498423236
test entropy is  0.0
________________________________
0
distance x is tensor(151.4578, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  517.615254123582
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9477, device='cuda:3')
compute_distance is  tensor(151.4578, device='cuda:3')
compute_norm is  tensor(50.2889, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(155.9375, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.512666341084153
avg test loss is  2.6697480228664014
avg accuracy is  0.3340500001563402
solo acc is  0.10845000015633195
compute similarity  is  tensor(0.9430, device='cuda:3')
compute_distance is  tensor(155.9375, device='cuda:3')
compute_norm is  tensor(51.1036, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(157.0479, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8360751358939132
avg test loss is  3.374257890908703
avg accuracy is  0.2338000001563377
solo acc is  0.1004833334896653
compute similarity  is  tensor(0.9421, device='cuda:3')
compute_distance is  tensor(157.0479, device='cuda:3')
compute_norm is  tensor(51.1951, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(157.7989, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.4034242613483339
avg test loss is  2.420921015078579
avg accuracy is  0.33351666682300685
solo acc is  0.11735000015633194
compute similarity  is  tensor(0.9432, device='cuda:3')
compute_distance is  tensor(157.7989, device='cuda:3')
compute_norm is  tensor(50.7895, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(159.2131, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7801313518461134
avg test loss is  3.0625764741572237
avg accuracy is  0.22971666682300426
solo acc is  0.10115000015633197
compute similarity  is  tensor(0.9424, device='cuda:3')
compute_distance is  tensor(159.2131, device='cuda:3')
compute_norm is  tensor(50.8280, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(161.2660, device='cuda:3')
distance x is tensor(161.2660, device='cuda:3')
________________________________
test distance is  tensor(161.2660, device='cuda:3')
test distance1 is  tensor(161.2660, device='cuda:3')
test similarity is  tensor(0.9430, device='cuda:3')
test acc is  0.144133333489666
test loss is 2.0788224738543986
test entropy is  1.2699948672546761
________________________________
cal ratio is  0.956771829463722
distance x is tensor(154.3013, device='cuda:3')
cal_distance is  tensor(154.3013, device='cuda:3')
cal ratio is  0.9781262616767912
distance x is tensor(150.9263, device='cuda:3')
cal_distance is  tensor(150.9263, device='cuda:3')
distance x is tensor(150.9263, device='cuda:3')
return_distance is  tensor(150.9263, device='cuda:3')
distance x is tensor(150.9195, device='cuda:3')
distance x is tensor(150.9195, device='cuda:3')
________________________________
test distance is  tensor(150.9195, device='cuda:3')
test distance1 is  tensor(150.9195, device='cuda:3')
test similarity is  tensor(0.9492, device='cuda:3')
test acc is  0.12640000015633193
test loss is 2.057296661044489
test entropy is  1.3611550850908893
________________________________
0
distance x is tensor(150.9195, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.361766188256522
avg test loss is  2.0575179814784
avg accuracy is  0.37318333348967414
solo acc is  0.12648333348966523
compute similarity  is  tensor(0.9492, device='cuda:3')
compute_distance is  tensor(150.9195, device='cuda:3')
compute_norm is  tensor(50.0837, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(152.4868, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7382532601544598
avg test loss is  2.8080235920481083
avg accuracy is  0.2693500001563388
solo acc is  0.10165000015633197
compute similarity  is  tensor(0.9484, device='cuda:3')
compute_distance is  tensor(152.4868, device='cuda:3')
compute_norm is  tensor(50.0777, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(154.2108, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.1806906682850202
avg test loss is  1.9265492531790662
avg accuracy is  0.3603166668230072
solo acc is  0.15116666682299998
compute similarity  is  tensor(0.9486, device='cuda:3')
compute_distance is  tensor(154.2108, device='cuda:3')
compute_norm is  tensor(49.7918, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(155.1412, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.687362688246058
avg test loss is  2.6820140441597653
avg accuracy is  0.28235000015633915
solo acc is  0.1021333334896653
compute similarity  is  tensor(0.9480, device='cuda:3')
compute_distance is  tensor(155.1412, device='cuda:3')
compute_norm is  tensor(49.6852, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(156.2034, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0947573296169737
avg test loss is  1.7709552510969166
avg accuracy is  0.36155000015634065
solo acc is  0.18191666682300212
compute similarity  is  tensor(0.9482, device='cuda:3')
compute_distance is  tensor(156.2034, device='cuda:3')
compute_norm is  tensor(49.3842, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(156.7451, device='cuda:3')
distance x is tensor(156.7451, device='cuda:3')
________________________________
test distance is  tensor(156.7451, device='cuda:3')
test distance1 is  tensor(156.7451, device='cuda:3')
test similarity is  tensor(0.9479, device='cuda:3')
test acc is  0.10548333348966529
test loss is 2.527458399343592
test entropy is  0.6448016499659655
________________________________
cal ratio is  0.9704714210459984
distance x is tensor(152.1232, device='cuda:3')
cal_distance is  tensor(152.1232, device='cuda:3')
distance x is tensor(152.1232, device='cuda:3')
return_distance is  tensor(152.1232, device='cuda:3')
distance x is tensor(152.1165, device='cuda:3')
distance x is tensor(152.1165, device='cuda:3')
________________________________
test distance is  tensor(152.1165, device='cuda:3')
test distance1 is  tensor(152.1165, device='cuda:3')
test similarity is  tensor(0.9506, device='cuda:3')
test acc is  0.10391666682299863
test loss is 2.440107879862348
test entropy is  0.7127562928428528
________________________________
0
distance x is tensor(152.1165, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.7122993054293366
avg test loss is  2.440275217678501
avg accuracy is  0.31668333348967315
solo acc is  0.1037833334896653
compute similarity  is  tensor(0.9506, device='cuda:3')
compute_distance is  tensor(152.1165, device='cuda:3')
compute_norm is  tensor(49.0869, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(152.8128, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9942717745360027
avg test loss is  1.5337851973993184
avg accuracy is  0.4065833334896745
solo acc is  0.23265000015633772
compute similarity  is  tensor(0.9507, device='cuda:3')
compute_distance is  tensor(152.8128, device='cuda:3')
compute_norm is  tensor(48.8228, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(152.8194, device='cuda:3')
________________________________
test distance is  tensor(152.8194, device='cuda:3')
test similarity is  tensor(0.9507, device='cuda:3')
test acc is  0.40690000015634126
test loss is 1.5322349318054949
test entropy is  0.9929405094972298
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.4921871423721313
mal norm is  tensor(694.7213, device='cuda:3')
distance x is tensor(152.8194, device='cuda:3')
mal distance is  tensor(152.8194, device='cuda:3')
user_PLR len size 52
counter_tensor is  tensor([51., 51., 51., 51., 51., 51., 51., 51., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 51., 51., 51., 51., 51., 51., 51., 51.,
        51., 51., 51., 51., 51., 51., 51., 51., 51., 51., 51., 51., 51., 51.,
        51., 51., 51., 51., 51., 51., 51., 51., 51., 51.])
count_res tensor([2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 4.1754e-07, 4.1754e-07, 4.1754e-07, 4.1754e-07,
        4.1754e-07, 4.1754e-07, 4.1754e-07, 4.1754e-07, 4.1754e-07, 4.1754e-07,
        4.1754e-07, 4.1754e-07, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 90.55% 

Test Accuracy: 89.63% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3982296586036682
distance x is tensor(78.6886, device='cuda:3')
benign distance is  tensor(78.6886, device='cuda:3')
norm1 res is  tensor(336.1617, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8043062090873718
distance x is tensor(92.9303, device='cuda:3')
benign distance is  tensor(92.9303, device='cuda:3')
norm1 res is  tensor(410.3854, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.19527903199195862
distance x is tensor(97.4112, device='cuda:3')
benign distance is  tensor(97.4112, device='cuda:3')
norm1 res is  tensor(412.6281, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4161890149116516
distance x is tensor(75.8636, device='cuda:3')
benign distance is  tensor(75.8636, device='cuda:3')
norm1 res is  tensor(323.9712, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4772941470146179
distance x is tensor(68.8837, device='cuda:3')
benign distance is  tensor(68.8837, device='cuda:3')
norm1 res is  tensor(297.3819, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8276170492172241
distance x is tensor(88.3532, device='cuda:3')
benign distance is  tensor(88.3532, device='cuda:3')
norm1 res is  tensor(382.2006, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.27538836002349854
distance x is tensor(76.4298, device='cuda:3')
benign distance is  tensor(76.4298, device='cuda:3')
norm1 res is  tensor(330.1824, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.39613059163093567
distance x is tensor(82.1422, device='cuda:3')
benign distance is  tensor(82.1422, device='cuda:3')
norm1 res is  tensor(360.8453, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.43934425711631775
distance x is tensor(103.0634, device='cuda:3')
benign distance is  tensor(103.0634, device='cuda:3')
norm1 res is  tensor(445.5376, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.519265353679657
distance x is tensor(107.5080, device='cuda:3')
benign distance is  tensor(107.5080, device='cuda:3')
norm1 res is  tensor(464.4172, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5348606109619141
distance x is tensor(94.9509, device='cuda:3')
benign distance is  tensor(94.9509, device='cuda:3')
norm1 res is  tensor(420.1281, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.42490649223327637
distance x is tensor(106.6388, device='cuda:3')
benign distance is  tensor(106.6388, device='cuda:3')
norm1 res is  tensor(460.7387, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6291602253913879
distance x is tensor(100.4281, device='cuda:3')
benign distance is  tensor(100.4281, device='cuda:3')
norm1 res is  tensor(438.8033, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.18369020521640778
distance x is tensor(117.0473, device='cuda:3')
benign distance is  tensor(117.0473, device='cuda:3')
norm1 res is  tensor(508.2687, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.44564637541770935
distance x is tensor(93.7444, device='cuda:3')
benign distance is  tensor(93.7444, device='cuda:3')
norm1 res is  tensor(416.5009, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4295279085636139
distance x is tensor(97.3674, device='cuda:3')
benign distance is  tensor(97.3674, device='cuda:3')
norm1 res is  tensor(424.7767, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4052782952785492
distance x is tensor(117.2953, device='cuda:3')
benign distance is  tensor(117.2953, device='cuda:3')
norm1 res is  tensor(511.2194, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6320691108703613
distance x is tensor(140.5479, device='cuda:3')
benign distance is  tensor(140.5479, device='cuda:3')
norm1 res is  tensor(612.1866, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.1731034815311432
distance x is tensor(104.8602, device='cuda:3')
benign distance is  tensor(104.8602, device='cuda:3')
norm1 res is  tensor(457.3803, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3642900884151459
distance x is tensor(120.7777, device='cuda:3')
benign distance is  tensor(120.7777, device='cuda:3')
norm1 res is  tensor(525.4595, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3776775300502777
distance x is tensor(113.3289, device='cuda:3')
benign distance is  tensor(113.3289, device='cuda:3')
norm1 res is  tensor(493.0872, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8822323083877563
distance x is tensor(103.9088, device='cuda:3')
benign distance is  tensor(103.9088, device='cuda:3')
norm1 res is  tensor(446.0252, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.34546345472335815
distance x is tensor(118.7051, device='cuda:3')
benign distance is  tensor(118.7051, device='cuda:3')
norm1 res is  tensor(527.2540, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7595267295837402
distance x is tensor(110.1846, device='cuda:3')
benign distance is  tensor(110.1846, device='cuda:3')
norm1 res is  tensor(468.1146, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.28930559754371643
distance x is tensor(109.4331, device='cuda:3')
benign distance is  tensor(109.4331, device='cuda:3')
norm1 res is  tensor(477.9925, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.04456315189599991
distance x is tensor(105.3119, device='cuda:3')
benign distance is  tensor(105.3119, device='cuda:3')
norm1 res is  tensor(464.2356, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.4090611934661865
distance x is tensor(106.7905, device='cuda:3')
benign distance is  tensor(106.7905, device='cuda:3')
norm1 res is  tensor(471.9521, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.1322437822818756
distance x is tensor(114.3660, device='cuda:3')
benign distance is  tensor(114.3660, device='cuda:3')
norm1 res is  tensor(500.5024, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.1572454869747162
distance x is tensor(103.7955, device='cuda:3')
benign distance is  tensor(103.7955, device='cuda:3')
norm1 res is  tensor(457.1468, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.18913498520851135
distance x is tensor(110.5604, device='cuda:3')
benign distance is  tensor(110.5604, device='cuda:3')
norm1 res is  tensor(479.0472, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.4053680896759033
distance x is tensor(107.2916, device='cuda:3')
benign distance is  tensor(107.2916, device='cuda:3')
norm1 res is  tensor(465.0825, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.12246856838464737
distance x is tensor(110.7399, device='cuda:3')
benign distance is  tensor(110.7399, device='cuda:3')
norm1 res is  tensor(477.7659, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.07056893408298492
distance x is tensor(108.1685, device='cuda:3')
benign distance is  tensor(108.1685, device='cuda:3')
norm1 res is  tensor(475.8510, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.2750219404697418
distance x is tensor(99.1872, device='cuda:3')
benign distance is  tensor(99.1872, device='cuda:3')
norm1 res is  tensor(428.6153, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.08570802211761475
distance x is tensor(103.9521, device='cuda:3')
benign distance is  tensor(103.9521, device='cuda:3')
norm1 res is  tensor(448.1631, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.19024589657783508
distance x is tensor(108.4360, device='cuda:3')
benign distance is  tensor(108.4360, device='cuda:3')
norm1 res is  tensor(470.1769, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7310062050819397
distance x is tensor(112.1487, device='cuda:3')
benign distance is  tensor(112.1487, device='cuda:3')
norm1 res is  tensor(482.4606, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5935884714126587
distance x is tensor(113.4906, device='cuda:3')
benign distance is  tensor(113.4906, device='cuda:3')
norm1 res is  tensor(488.8064, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6534981727600098
distance x is tensor(106.7688, device='cuda:3')
benign distance is  tensor(106.7688, device='cuda:3')
norm1 res is  tensor(458.9128, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.29128068685531616
distance x is tensor(116.0314, device='cuda:3')
benign distance is  tensor(116.0314, device='cuda:3')
norm1 res is  tensor(509.6205, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(103.2100, device='cuda:3')
compute distance is  tensor(103.2100, device='cuda:3')
compute norm is  tensor(48.1320, device='cuda:3', dtype=torch.float64)
distance x is tensor(100.8512, device='cuda:3')
compute distance is  tensor(100.8512, device='cuda:3')
compute norm is  tensor(48.1824, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.0682, device='cuda:3')
compute distance is  tensor(115.0682, device='cuda:3')
compute norm is  tensor(48.4750, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.2302, device='cuda:3')
compute distance is  tensor(104.2302, device='cuda:3')
compute norm is  tensor(48.2631, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.3940, device='cuda:3')
compute distance is  tensor(106.3940, device='cuda:3')
compute norm is  tensor(48.2392, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.1277, device='cuda:3')
compute distance is  tensor(112.1277, device='cuda:3')
compute norm is  tensor(48.4339, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.0975, device='cuda:3')
compute distance is  tensor(102.0975, device='cuda:3')
compute norm is  tensor(48.2351, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.2132, device='cuda:3')
compute distance is  tensor(107.2132, device='cuda:3')
compute norm is  tensor(48.3010, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.4603, device='cuda:3')
compute distance is  tensor(106.4603, device='cuda:3')
compute norm is  tensor(48.2307, device='cuda:3', dtype=torch.float64)
distance x is tensor(99.6629, device='cuda:3')
compute distance is  tensor(99.6629, device='cuda:3')
compute norm is  tensor(48.2032, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.8458, device='cuda:3')
compute distance is  tensor(107.8458, device='cuda:3')
compute norm is  tensor(48.3398, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.2971, device='cuda:3')
compute distance is  tensor(123.2971, device='cuda:3')
compute norm is  tensor(48.5306, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(123.2971, device='cuda:3')
distance x is tensor(106176.7656, device='cuda:3')
distance x is tensor(106176.7656, device='cuda:3')
________________________________
test distance is  tensor(106176.7656, device='cuda:3')
test distance1 is  tensor(106176.7656, device='cuda:3')
test similarity is  tensor(0.0429, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139287787302047.39
test entropy is  0.0
________________________________
cal ratio is  0.03339548977035024
distance x is tensor(3545.8308, device='cuda:3')
cal_distance is  tensor(3545.8308, device='cuda:3')
cal ratio is  0.18274417705349
distance x is tensor(647.9839, device='cuda:3')
cal_distance is  tensor(647.9839, device='cuda:3')
cal ratio is  0.4274845689434093
distance x is tensor(277.0060, device='cuda:3')
cal_distance is  tensor(277.0060, device='cuda:3')
cal ratio is  0.6538196583045947
distance x is tensor(181.1137, device='cuda:3')
cal_distance is  tensor(181.1137, device='cuda:3')
cal ratio is  0.8085873082443388
distance x is tensor(146.4472, device='cuda:3')
cal_distance is  tensor(146.4472, device='cuda:3')
cal ratio is  0.8992119347043117
distance x is tensor(131.6876, device='cuda:3')
cal_distance is  tensor(131.6876, device='cuda:3')
cal ratio is  0.9482660061360078
distance x is tensor(124.8751, device='cuda:3')
cal_distance is  tensor(124.8751, device='cuda:3')
cal ratio is  0.9737884380089605
distance x is tensor(121.6021, device='cuda:3')
cal_distance is  tensor(121.6021, device='cuda:3')
distance x is tensor(121.6021, device='cuda:3')
return_distance is  tensor(121.6021, device='cuda:3')
distance x is tensor(121.5922, device='cuda:3')
distance x is tensor(121.5922, device='cuda:3')
________________________________
test distance is  tensor(121.5922, device='cuda:3')
test distance1 is  tensor(121.5922, device='cuda:3')
test similarity is  tensor(0.9598, device='cuda:3')
test acc is  0.10000000015633198
test loss is 170.83563105536422
test entropy is  5.650976485903186e-20
________________________________
0
distance x is tensor(121.5922, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.2413586287600514e-19
avg test loss is  170.81790275004371
avg accuracy is  0.5873500001563386
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9598, device='cuda:3')
compute_distance is  tensor(121.5922, device='cuda:3')
compute_norm is  tensor(48.6065, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(110.8359, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8129997829765653
avg test loss is  1.2461883496246866
avg accuracy is  0.8900500001563216
solo acc is  0.35193333348967376
compute similarity  is  tensor(0.9625, device='cuda:3')
compute_distance is  tensor(110.8359, device='cuda:3')
compute_norm is  tensor(47.9121, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(112.3108, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7880339303504683
avg test loss is  1.3039166598177667
avg accuracy is  0.8925166668229884
solo acc is  0.27965000015633906
compute similarity  is  tensor(0.9621, device='cuda:3')
compute_distance is  tensor(112.3108, device='cuda:3')
compute_norm is  tensor(47.6211, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(113.7369, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.782153215489662
avg test loss is  1.2857324140412467
avg accuracy is  0.8932000001563215
solo acc is  0.2637500001563386
compute similarity  is  tensor(0.9617, device='cuda:3')
compute_distance is  tensor(113.7369, device='cuda:3')
compute_norm is  tensor(47.3500, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.1590, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.783632100200348
avg test loss is  1.2532920781483274
avg accuracy is  0.8952166668229881
solo acc is  0.26506666682300534
compute similarity  is  tensor(0.9614, device='cuda:3')
compute_distance is  tensor(115.1590, device='cuda:3')
compute_norm is  tensor(47.0908, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(116.5665, device='cuda:3')
distance x is tensor(116.5665, device='cuda:3')
________________________________
test distance is  tensor(116.5665, device='cuda:3')
test distance1 is  tensor(116.5665, device='cuda:3')
test similarity is  tensor(0.9611, device='cuda:3')
test acc is  0.2512166668230049
test loss is 1.2555234570747245
test entropy is  0.7743625727924965
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.1674025058746338
mal norm is  tensor(589.8139, device='cuda:3')
distance x is tensor(116.5737, device='cuda:3')
mal distance is  tensor(116.5737, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([19., 19., 19., 19., 19., 19., 19., 19., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0669,
        0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669,
        0.0669, 0.0669])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 81.35% 

Test Accuracy: 80.12% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5959137678146362
distance x is tensor(137.1987, device='cuda:3')
benign distance is  tensor(137.1987, device='cuda:3')
norm1 res is  tensor(556.5744, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9848864674568176
distance x is tensor(151.0026, device='cuda:3')
benign distance is  tensor(151.0026, device='cuda:3')
norm1 res is  tensor(616.7954, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.19250397384166718
distance x is tensor(147.6002, device='cuda:3')
benign distance is  tensor(147.6002, device='cuda:3')
norm1 res is  tensor(589.6774, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.12080748379230499
distance x is tensor(140.5818, device='cuda:3')
benign distance is  tensor(140.5818, device='cuda:3')
norm1 res is  tensor(555.1223, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8001083135604858
distance x is tensor(116.2940, device='cuda:3')
benign distance is  tensor(116.2940, device='cuda:3')
norm1 res is  tensor(462.2047, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.45010653138160706
distance x is tensor(134.6012, device='cuda:3')
benign distance is  tensor(134.6012, device='cuda:3')
norm1 res is  tensor(554.2794, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4335978627204895
distance x is tensor(136.9664, device='cuda:3')
benign distance is  tensor(136.9664, device='cuda:3')
norm1 res is  tensor(546.9777, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7368507385253906
distance x is tensor(133.4276, device='cuda:3')
benign distance is  tensor(133.4276, device='cuda:3')
norm1 res is  tensor(552.3372, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(140.2450, device='cuda:3')
compute distance is  tensor(140.2450, device='cuda:3')
compute norm is  tensor(48.5197, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.8239, device='cuda:3')
compute distance is  tensor(138.8239, device='cuda:3')
compute norm is  tensor(48.6062, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.3564, device='cuda:3')
compute distance is  tensor(164.3564, device='cuda:3')
compute norm is  tensor(49.1808, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.6346, device='cuda:3')
compute distance is  tensor(132.6346, device='cuda:3')
compute norm is  tensor(48.5088, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.9622, device='cuda:3')
compute distance is  tensor(142.9622, device='cuda:3')
compute norm is  tensor(48.7919, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.9898, device='cuda:3')
compute distance is  tensor(152.9898, device='cuda:3')
compute norm is  tensor(48.9359, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.3874, device='cuda:3')
compute distance is  tensor(153.3874, device='cuda:3')
compute norm is  tensor(48.9301, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.8471, device='cuda:3')
compute distance is  tensor(159.8471, device='cuda:3')
compute norm is  tensor(49.1020, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.4634, device='cuda:3')
compute distance is  tensor(159.4634, device='cuda:3')
compute norm is  tensor(48.9331, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.7947, device='cuda:3')
compute distance is  tensor(157.7947, device='cuda:3')
compute norm is  tensor(48.9914, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.6219, device='cuda:3')
compute distance is  tensor(141.6219, device='cuda:3')
compute norm is  tensor(48.6299, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.0881, device='cuda:3')
compute distance is  tensor(128.0881, device='cuda:3')
compute norm is  tensor(48.3414, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(164.3564, device='cuda:3')
distance x is tensor(106114.3203, device='cuda:3')
distance x is tensor(106114.3203, device='cuda:3')
________________________________
test distance is  tensor(106114.3203, device='cuda:3')
test distance1 is  tensor(106114.3203, device='cuda:3')
test similarity is  tensor(0.2409, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139276432918680.83
test entropy is  0.0
________________________________
cal ratio is  0.03856846767722701
distance x is tensor(4092.6714, device='cuda:3')
cal_distance is  tensor(4092.6714, device='cuda:3')
cal ratio is  0.19638844880907452
distance x is tensor(803.7574, device='cuda:3')
cal_distance is  tensor(803.7574, device='cuda:3')
cal ratio is  0.44315626936642755
distance x is tensor(356.1929, device='cuda:3')
cal_distance is  tensor(356.1929, device='cuda:3')
cal ratio is  0.665697232316458
distance x is tensor(237.1183, device='cuda:3')
cal_distance is  tensor(237.1183, device='cuda:3')
cal ratio is  0.8158999067753439
distance x is tensor(193.4657, device='cuda:3')
cal_distance is  tensor(193.4657, device='cuda:3')
cal ratio is  0.9032696047449436
distance x is tensor(174.7522, device='cuda:3')
cal_distance is  tensor(174.7522, device='cuda:3')
cal ratio is  0.9504036191654854
distance x is tensor(166.0853, device='cuda:3')
cal_distance is  tensor(166.0853, device='cuda:3')
cal ratio is  0.974885779390537
distance x is tensor(161.9144, device='cuda:3')
cal_distance is  tensor(161.9144, device='cuda:3')
distance x is tensor(161.9144, device='cuda:3')
return_distance is  tensor(161.9144, device='cuda:3')
distance x is tensor(161.9045, device='cuda:3')
distance x is tensor(161.9045, device='cuda:3')
________________________________
test distance is  tensor(161.9045, device='cuda:3')
test distance1 is  tensor(161.9045, device='cuda:3')
test similarity is  tensor(0.9443, device='cuda:3')
test acc is  0.10000000015633198
test loss is 602.5629038861565
test entropy is  0.0
________________________________
0
distance x is tensor(161.9045, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  602.6302663644494
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9443, device='cuda:3')
compute_distance is  tensor(161.9045, device='cuda:3')
compute_norm is  tensor(51.1923, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(218.0106, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5560872905544127
avg test loss is  2.852242985768105
avg accuracy is  0.13421666682299857
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9213, device='cuda:3')
compute_distance is  tensor(218.0106, device='cuda:3')
compute_norm is  tensor(54.6320, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(218.0151, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8354531654289791
avg test loss is  3.585090453436634
avg accuracy is  0.1316500001563319
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9206, device='cuda:3')
compute_distance is  tensor(218.0151, device='cuda:3')
compute_norm is  tensor(54.7325, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(216.8775, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.535675682619945
avg test loss is  2.844168355470019
avg accuracy is  0.1713333334896681
solo acc is  0.10190000015633197
compute similarity  is  tensor(0.9213, device='cuda:3')
compute_distance is  tensor(216.8775, device='cuda:3')
compute_norm is  tensor(54.1424, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(216.9502, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8360439025516957
avg test loss is  3.5677561775199385
avg accuracy is  0.15538333348966699
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9206, device='cuda:3')
compute_distance is  tensor(216.9502, device='cuda:3')
compute_norm is  tensor(54.2393, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(218.2061, device='cuda:3')
distance x is tensor(218.2061, device='cuda:3')
________________________________
test distance is  tensor(218.2061, device='cuda:3')
test distance1 is  tensor(218.2061, device='cuda:3')
test similarity is  tensor(0.9218, device='cuda:3')
test acc is  0.1543166668230002
test loss is 2.293057743801491
test entropy is  1.340554612531845
________________________________
cal ratio is  0.850522756731265
distance x is tensor(185.5939, device='cuda:3')
cal_distance is  tensor(185.5939, device='cuda:3')
cal ratio is  0.9222264308849368
distance x is tensor(171.1598, device='cuda:3')
cal_distance is  tensor(171.1598, device='cuda:3')
cal ratio is  0.9603256627877356
distance x is tensor(164.3692, device='cuda:3')
cal_distance is  tensor(164.3692, device='cuda:3')
cal ratio is  0.9799618266538749
distance x is tensor(161.0756, device='cuda:3')
cal_distance is  tensor(161.0756, device='cuda:3')
distance x is tensor(161.0756, device='cuda:3')
return_distance is  tensor(161.0756, device='cuda:3')
distance x is tensor(161.0706, device='cuda:3')
distance x is tensor(161.0706, device='cuda:3')
________________________________
test distance is  tensor(161.0706, device='cuda:3')
test distance1 is  tensor(161.0706, device='cuda:3')
test similarity is  tensor(0.9535, device='cuda:3')
test acc is  0.16758333348966786
test loss is 2.0505028203097995
test entropy is  1.8014585050438512
________________________________
0
distance x is tensor(161.0706, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.8021714914836355
avg test loss is  2.0517061899211617
avg accuracy is  0.4260500001563415
solo acc is  0.16755000015633453
compute similarity  is  tensor(0.9535, device='cuda:3')
compute_distance is  tensor(161.0706, device='cuda:3')
compute_norm is  tensor(51.0952, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(163.2188, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7770900024152768
avg test loss is  2.9123613732710067
avg accuracy is  0.30431666682300634
solo acc is  0.10081666682299864
compute similarity  is  tensor(0.9526, device='cuda:3')
compute_distance is  tensor(163.2188, device='cuda:3')
compute_norm is  tensor(51.1964, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(164.5206, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.1678171855554398
avg test loss is  1.9371241914438033
avg accuracy is  0.450933333489675
solo acc is  0.15376666682300016
compute similarity  is  tensor(0.9528, device='cuda:3')
compute_distance is  tensor(164.5206, device='cuda:3')
compute_norm is  tensor(50.9285, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(165.2770, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6902043870898452
avg test loss is  2.6572043697462915
avg accuracy is  0.3334166668230068
solo acc is  0.10155000015633196
compute similarity  is  tensor(0.9523, device='cuda:3')
compute_distance is  tensor(165.2770, device='cuda:3')
compute_norm is  tensor(50.8389, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(166.0368, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.074759007135688
avg test loss is  1.7592453946436901
avg accuracy is  0.4455666668230083
solo acc is  0.19751666682300287
compute similarity  is  tensor(0.9525, device='cuda:3')
compute_distance is  tensor(166.0368, device='cuda:3')
compute_norm is  tensor(50.5592, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(166.6267, device='cuda:3')
distance x is tensor(166.6267, device='cuda:3')
________________________________
test distance is  tensor(166.6267, device='cuda:3')
test distance1 is  tensor(166.6267, device='cuda:3')
test similarity is  tensor(0.9520, device='cuda:3')
test acc is  0.1020333334896653
test loss is 2.506864751579919
test entropy is  0.6552585105397808
________________________________
cal ratio is  0.973300840064603
distance x is tensor(162.1824, device='cuda:3')
cal_distance is  tensor(162.1824, device='cuda:3')
distance x is tensor(162.1824, device='cuda:3')
return_distance is  tensor(162.1824, device='cuda:3')
distance x is tensor(162.1778, device='cuda:3')
distance x is tensor(162.1778, device='cuda:3')
________________________________
test distance is  tensor(162.1778, device='cuda:3')
test distance1 is  tensor(162.1778, device='cuda:3')
test similarity is  tensor(0.9543, device='cuda:3')
test acc is  0.1022833334896653
test loss is 2.426066307752117
test entropy is  0.7085085560136767
________________________________
0
distance x is tensor(162.1778, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.7077693193197758
avg test loss is  2.4286898214425614
avg accuracy is  0.3443000001563404
solo acc is  0.10195000015633197
compute similarity  is  tensor(0.9543, device='cuda:3')
compute_distance is  tensor(162.1778, device='cuda:3')
compute_norm is  tensor(50.2634, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(163.0303, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9974434373856608
avg test loss is  1.6082217122700169
avg accuracy is  0.43185000015634145
solo acc is  0.20931666682300343
compute similarity  is  tensor(0.9544, device='cuda:3')
compute_distance is  tensor(163.0303, device='cuda:3')
compute_norm is  tensor(50.0058, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(163.0348, device='cuda:3')
________________________________
test distance is  tensor(163.0348, device='cuda:3')
test similarity is  tensor(0.9544, device='cuda:3')
test acc is  0.4313666668230081
test loss is 1.606113529027398
test entropy is  0.9974120662156453
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.3932292461395264
mal norm is  tensor(678.4890, device='cuda:3')
distance x is tensor(163.0348, device='cuda:3')
mal distance is  tensor(163.0348, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([35., 35., 35., 35., 35., 35., 35., 35., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 35., 35., 35., 35., 35., 35., 35., 35.,
        35., 35., 35., 35., 35., 35., 35., 35.])
count_res tensor([4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07,
        6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07,
        6.9590e-07, 6.9590e-07, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 90.47% 

Test Accuracy: 89.55% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.29982927441596985
distance x is tensor(73.5160, device='cuda:3')
benign distance is  tensor(73.5160, device='cuda:3')
norm1 res is  tensor(326.1000, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9283396005630493
distance x is tensor(90.8674, device='cuda:3')
benign distance is  tensor(90.8674, device='cuda:3')
norm1 res is  tensor(395.1658, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.02535286918282509
distance x is tensor(103.5684, device='cuda:3')
benign distance is  tensor(103.5684, device='cuda:3')
norm1 res is  tensor(434.8356, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5249323844909668
distance x is tensor(91.6827, device='cuda:3')
benign distance is  tensor(91.6827, device='cuda:3')
norm1 res is  tensor(384.3313, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3767234981060028
distance x is tensor(99.9206, device='cuda:3')
benign distance is  tensor(99.9206, device='cuda:3')
norm1 res is  tensor(422.8179, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.732448935508728
distance x is tensor(91.8018, device='cuda:3')
benign distance is  tensor(91.8018, device='cuda:3')
norm1 res is  tensor(395.4471, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.608021080493927
distance x is tensor(90.4903, device='cuda:3')
benign distance is  tensor(90.4903, device='cuda:3')
norm1 res is  tensor(377.4064, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.34192442893981934
distance x is tensor(100.8225, device='cuda:3')
benign distance is  tensor(100.8225, device='cuda:3')
norm1 res is  tensor(436.6669, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.49368423223495483
distance x is tensor(111.3017, device='cuda:3')
benign distance is  tensor(111.3017, device='cuda:3')
norm1 res is  tensor(477.7891, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.703248918056488
distance x is tensor(111.2624, device='cuda:3')
benign distance is  tensor(111.2624, device='cuda:3')
norm1 res is  tensor(475.4348, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.020962119102478
distance x is tensor(106.5512, device='cuda:3')
benign distance is  tensor(106.5512, device='cuda:3')
norm1 res is  tensor(445.1913, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6502924561500549
distance x is tensor(113.9906, device='cuda:3')
benign distance is  tensor(113.9906, device='cuda:3')
norm1 res is  tensor(489.8381, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5537440776824951
distance x is tensor(101.9843, device='cuda:3')
benign distance is  tensor(101.9843, device='cuda:3')
norm1 res is  tensor(450.4887, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.396330326795578
distance x is tensor(117.9640, device='cuda:3')
benign distance is  tensor(117.9640, device='cuda:3')
norm1 res is  tensor(521.1077, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.21899625658988953
distance x is tensor(114.0624, device='cuda:3')
benign distance is  tensor(114.0624, device='cuda:3')
norm1 res is  tensor(496.1219, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.0177364349365234
distance x is tensor(108.2737, device='cuda:3')
benign distance is  tensor(108.2737, device='cuda:3')
norm1 res is  tensor(464.3669, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.311926931142807
distance x is tensor(119.0398, device='cuda:3')
benign distance is  tensor(119.0398, device='cuda:3')
norm1 res is  tensor(513.3062, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5884362459182739
distance x is tensor(114.6031, device='cuda:3')
benign distance is  tensor(114.6031, device='cuda:3')
norm1 res is  tensor(481.1332, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.29454079270362854
distance x is tensor(108.5038, device='cuda:3')
benign distance is  tensor(108.5038, device='cuda:3')
norm1 res is  tensor(473.1232, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.47847023606300354
distance x is tensor(122.5612, device='cuda:3')
benign distance is  tensor(122.5612, device='cuda:3')
norm1 res is  tensor(528.3559, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.3352489471435547
distance x is tensor(118.3132, device='cuda:3')
benign distance is  tensor(118.3132, device='cuda:3')
norm1 res is  tensor(506.6420, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.30774644017219543
distance x is tensor(113.7140, device='cuda:3')
benign distance is  tensor(113.7140, device='cuda:3')
norm1 res is  tensor(489.7436, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.29969683289527893
distance x is tensor(107.3598, device='cuda:3')
benign distance is  tensor(107.3598, device='cuda:3')
norm1 res is  tensor(469.7771, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.34293442964553833
distance x is tensor(115.0764, device='cuda:3')
benign distance is  tensor(115.0764, device='cuda:3')
norm1 res is  tensor(510.7363, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(114.7046, device='cuda:3')
compute distance is  tensor(114.7046, device='cuda:3')
compute norm is  tensor(48.5930, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.3111, device='cuda:3')
compute distance is  tensor(107.3111, device='cuda:3')
compute norm is  tensor(48.5630, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.1066, device='cuda:3')
compute distance is  tensor(107.1066, device='cuda:3')
compute norm is  tensor(48.5893, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.6834, device='cuda:3')
compute distance is  tensor(110.6834, device='cuda:3')
compute norm is  tensor(48.6323, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.9300, device='cuda:3')
compute distance is  tensor(104.9300, device='cuda:3')
compute norm is  tensor(48.5369, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.1256, device='cuda:3')
compute distance is  tensor(116.1256, device='cuda:3')
compute norm is  tensor(48.7865, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.0675, device='cuda:3')
compute distance is  tensor(110.0675, device='cuda:3')
compute norm is  tensor(48.7038, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.8182, device='cuda:3')
compute distance is  tensor(124.8182, device='cuda:3')
compute norm is  tensor(48.9056, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.1808, device='cuda:3')
compute distance is  tensor(136.1808, device='cuda:3')
compute norm is  tensor(49.1412, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.0159, device='cuda:3')
compute distance is  tensor(111.0159, device='cuda:3')
compute norm is  tensor(48.6245, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.3171, device='cuda:3')
compute distance is  tensor(125.3171, device='cuda:3')
compute norm is  tensor(48.9786, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.9009, device='cuda:3')
compute distance is  tensor(108.9009, device='cuda:3')
compute norm is  tensor(48.6100, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(136.1808, device='cuda:3')
distance x is tensor(106168.9922, device='cuda:3')
distance x is tensor(106168.9922, device='cuda:3')
________________________________
test distance is  tensor(106168.9922, device='cuda:3')
test distance1 is  tensor(106168.9922, device='cuda:3')
test similarity is  tensor(0.0804, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139288084480558.94
test entropy is  0.0
________________________________
cal ratio is  0.035098224897586246
distance x is tensor(3726.3481, device='cuda:3')
cal_distance is  tensor(3726.3481, device='cuda:3')
cal ratio is  0.18734507388457664
distance x is tensor(698.1169, device='cuda:3')
cal_distance is  tensor(698.1169, device='cuda:3')
cal ratio is  0.43283254281607597
distance x is tensor(302.1705, device='cuda:3')
cal_distance is  tensor(302.1705, device='cuda:3')
cal ratio is  0.6578970571886855
distance x is tensor(198.7988, device='cuda:3')
cal_distance is  tensor(198.7988, device='cuda:3')
cal ratio is  0.8111050514928557
distance x is tensor(161.2477, device='cuda:3')
cal_distance is  tensor(161.2477, device='cuda:3')
cal ratio is  0.9006110593972979
distance x is tensor(145.2219, device='cuda:3')
cal_distance is  tensor(145.2219, device='cuda:3')
cal ratio is  0.9490036798160627
distance x is tensor(137.8164, device='cuda:3')
cal_distance is  tensor(137.8164, device='cuda:3')
cal ratio is  0.9741672640168573
distance x is tensor(134.2564, device='cuda:3')
cal_distance is  tensor(134.2564, device='cuda:3')
distance x is tensor(134.2564, device='cuda:3')
return_distance is  tensor(134.2564, device='cuda:3')
distance x is tensor(134.2465, device='cuda:3')
distance x is tensor(134.2465, device='cuda:3')
________________________________
test distance is  tensor(134.2465, device='cuda:3')
test distance1 is  tensor(134.2465, device='cuda:3')
test similarity is  tensor(0.9538, device='cuda:3')
test acc is  0.10000000015633198
test loss is 231.10206480371926
test entropy is  3.8694902400939096e-24
________________________________
0
distance x is tensor(134.2465, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  6.1581002583687845e-28
avg test loss is  231.1159966149564
avg accuracy is  0.4268000001563414
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9538, device='cuda:3')
compute_distance is  tensor(134.2465, device='cuda:3')
compute_norm is  tensor(49.5726, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(124.4090, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8673900157403844
avg test loss is  1.3326286661472402
avg accuracy is  0.8711833334896557
solo acc is  0.310183333489673
compute similarity  is  tensor(0.9570, device='cuda:3')
compute_distance is  tensor(124.4090, device='cuda:3')
compute_norm is  tensor(49.1706, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(125.1783, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8155010334972633
avg test loss is  1.3647010743236745
avg accuracy is  0.8772166668229889
solo acc is  0.24766666682300484
compute similarity  is  tensor(0.9567, device='cuda:3')
compute_distance is  tensor(125.1783, device='cuda:3')
compute_norm is  tensor(48.9088, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(126.0056, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.801157452404372
avg test loss is  1.3368401268143644
avg accuracy is  0.8792000001563222
solo acc is  0.23773333348967116
compute similarity  is  tensor(0.9564, device='cuda:3')
compute_distance is  tensor(126.0056, device='cuda:3')
compute_norm is  tensor(48.6538, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(126.8415, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8013085314332803
avg test loss is  1.296563197237088
avg accuracy is  0.8802166668229888
solo acc is  0.24265000015633806
compute similarity  is  tensor(0.9562, device='cuda:3')
compute_distance is  tensor(126.8415, device='cuda:3')
compute_norm is  tensor(48.4040, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(127.7288, device='cuda:3')
distance x is tensor(127.7288, device='cuda:3')
________________________________
test distance is  tensor(127.7288, device='cuda:3')
test distance1 is  tensor(127.7288, device='cuda:3')
test similarity is  tensor(0.9559, device='cuda:3')
test acc is  0.2348333334896711
test loss is 1.2917461977330351
test entropy is  0.7909174633305719
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.2137620449066162
mal norm is  tensor(645.0034, device='cuda:3')
distance x is tensor(127.7364, device='cuda:3')
mal distance is  tensor(127.7364, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([27., 27., 27., 27., 27., 27., 27., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 27., 27., 27., 27., 27., 27., 27.])
count_res tensor([6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 90.42% 

Test Accuracy: 89.70% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7602407336235046
distance x is tensor(84.0812, device='cuda:3')
benign distance is  tensor(84.0812, device='cuda:3')
norm1 res is  tensor(365.2131, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4977239668369293
distance x is tensor(82.4094, device='cuda:3')
benign distance is  tensor(82.4094, device='cuda:3')
norm1 res is  tensor(366.5740, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.038405418395996094
distance x is tensor(108.2041, device='cuda:3')
benign distance is  tensor(108.2041, device='cuda:3')
norm1 res is  tensor(459.9436, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6621785163879395
distance x is tensor(80.6026, device='cuda:3')
benign distance is  tensor(80.6026, device='cuda:3')
norm1 res is  tensor(347.9739, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2953982949256897
distance x is tensor(80.1236, device='cuda:3')
benign distance is  tensor(80.1236, device='cuda:3')
norm1 res is  tensor(345.4815, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9793316125869751
distance x is tensor(85.1242, device='cuda:3')
benign distance is  tensor(85.1242, device='cuda:3')
norm1 res is  tensor(368.2030, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.26446333527565
distance x is tensor(82.4701, device='cuda:3')
benign distance is  tensor(82.4701, device='cuda:3')
norm1 res is  tensor(350.0683, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.31534963846206665
distance x is tensor(93.3113, device='cuda:3')
benign distance is  tensor(93.3113, device='cuda:3')
norm1 res is  tensor(409.0202, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.467914342880249
distance x is tensor(119.4609, device='cuda:3')
benign distance is  tensor(119.4609, device='cuda:3')
norm1 res is  tensor(531.2892, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.542177677154541
distance x is tensor(118.1554, device='cuda:3')
benign distance is  tensor(118.1554, device='cuda:3')
norm1 res is  tensor(515.1458, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.15032345056533813
distance x is tensor(116.1184, device='cuda:3')
benign distance is  tensor(116.1184, device='cuda:3')
norm1 res is  tensor(506.9015, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.21979160606861115
distance x is tensor(111.3291, device='cuda:3')
benign distance is  tensor(111.3291, device='cuda:3')
norm1 res is  tensor(492.1693, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.516353964805603
distance x is tensor(113.3334, device='cuda:3')
benign distance is  tensor(113.3334, device='cuda:3')
norm1 res is  tensor(505.6639, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.4674297869205475
distance x is tensor(107.5455, device='cuda:3')
benign distance is  tensor(107.5455, device='cuda:3')
norm1 res is  tensor(459.3734, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.29454874992370605
distance x is tensor(112.2566, device='cuda:3')
benign distance is  tensor(112.2566, device='cuda:3')
norm1 res is  tensor(501.9228, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4466213285923004
distance x is tensor(101.4570, device='cuda:3')
benign distance is  tensor(101.4570, device='cuda:3')
norm1 res is  tensor(441.8097, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(107.4697, device='cuda:3')
compute distance is  tensor(107.4697, device='cuda:3')
compute norm is  tensor(48.7250, device='cuda:3', dtype=torch.float64)
distance x is tensor(96.9590, device='cuda:3')
compute distance is  tensor(96.9590, device='cuda:3')
compute norm is  tensor(48.6047, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.6492, device='cuda:3')
compute distance is  tensor(118.6492, device='cuda:3')
compute norm is  tensor(49.1615, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.4898, device='cuda:3')
compute distance is  tensor(106.4898, device='cuda:3')
compute norm is  tensor(48.8661, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.7921, device='cuda:3')
compute distance is  tensor(109.7921, device='cuda:3')
compute norm is  tensor(48.8969, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.6545, device='cuda:3')
compute distance is  tensor(110.6545, device='cuda:3')
compute norm is  tensor(48.9920, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.2958, device='cuda:3')
compute distance is  tensor(106.2958, device='cuda:3')
compute norm is  tensor(48.9405, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.0435, device='cuda:3')
compute distance is  tensor(128.0435, device='cuda:3')
compute norm is  tensor(49.2824, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.4078, device='cuda:3')
compute distance is  tensor(121.4078, device='cuda:3')
compute norm is  tensor(49.0775, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.5014, device='cuda:3')
compute distance is  tensor(103.5014, device='cuda:3')
compute norm is  tensor(48.8130, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.0771, device='cuda:3')
compute distance is  tensor(104.0771, device='cuda:3')
compute norm is  tensor(48.8766, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.9006, device='cuda:3')
compute distance is  tensor(119.9006, device='cuda:3')
compute norm is  tensor(49.0399, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(128.0435, device='cuda:3')
distance x is tensor(106176.7188, device='cuda:3')
distance x is tensor(106176.7188, device='cuda:3')
________________________________
test distance is  tensor(106176.7188, device='cuda:3')
test distance1 is  tensor(106176.7188, device='cuda:3')
test similarity is  tensor(0.0513, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139271767672146.42
test entropy is  0.0
________________________________
cal ratio is  0.03403221619322979
distance x is tensor(3613.4346, device='cuda:3')
cal_distance is  tensor(3613.4346, device='cuda:3')
cal ratio is  0.18447808163905552
distance x is tensor(666.6034, device='cuda:3')
cal_distance is  tensor(666.6034, device='cuda:3')
cal ratio is  0.42950785891333865
distance x is tensor(286.3142, device='cuda:3')
cal_distance is  tensor(286.3142, device='cuda:3')
cal ratio is  0.6553652329118166
distance x is tensor(187.6421, device='cuda:3')
cal_distance is  tensor(187.6421, device='cuda:3')
cal ratio is  0.8095426594059582
distance x is tensor(151.9053, device='cuda:3')
cal_distance is  tensor(151.9053, device='cuda:3')
cal ratio is  0.8997429931104928
distance x is tensor(136.6762, device='cuda:3')
cal_distance is  tensor(136.6762, device='cuda:3')
cal ratio is  0.9485461296075974
distance x is tensor(129.6439, device='cuda:3')
cal_distance is  tensor(129.6439, device='cuda:3')
cal ratio is  0.973932421592873
distance x is tensor(126.2646, device='cuda:3')
cal_distance is  tensor(126.2646, device='cuda:3')
distance x is tensor(126.2646, device='cuda:3')
return_distance is  tensor(126.2646, device='cuda:3')
distance x is tensor(126.2547, device='cuda:3')
distance x is tensor(126.2547, device='cuda:3')
________________________________
test distance is  tensor(126.2547, device='cuda:3')
test distance1 is  tensor(126.2547, device='cuda:3')
test similarity is  tensor(0.9583, device='cuda:3')
test acc is  0.10000000015633198
test loss is 186.9218962289123
test entropy is  4.3628309620128645e-18
________________________________
0
distance x is tensor(126.2547, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  3.86818471639296e-19
avg test loss is  186.94059070188607
avg accuracy is  0.6291833334896687
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9583, device='cuda:3')
compute_distance is  tensor(126.2547, device='cuda:3')
compute_norm is  tensor(49.4035, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(116.7269, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8185631585782016
avg test loss is  1.264632041456857
avg accuracy is  0.8854500001563218
solo acc is  0.33950000015634024
compute similarity  is  tensor(0.9611, device='cuda:3')
compute_distance is  tensor(116.7269, device='cuda:3')
compute_norm is  tensor(48.8516, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(118.1645, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7920078515116848
avg test loss is  1.3211899944968315
avg accuracy is  0.8877833334896551
solo acc is  0.2684666668230054
compute similarity  is  tensor(0.9607, device='cuda:3')
compute_distance is  tensor(118.1645, device='cuda:3')
compute_norm is  tensor(48.5678, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(119.4954, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7916711338166235
avg test loss is  1.2926496841760078
avg accuracy is  0.8888166668229884
solo acc is  0.2590666668230051
compute similarity  is  tensor(0.9604, device='cuda:3')
compute_distance is  tensor(119.4954, device='cuda:3')
compute_norm is  tensor(48.3007, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(120.8775, device='cuda:3')
exit early
distance x is tensor(120.8775, device='cuda:3')
distance x is tensor(120.8775, device='cuda:3')
________________________________
test distance is  tensor(120.8775, device='cuda:3')
test distance1 is  tensor(120.8775, device='cuda:3')
test similarity is  tensor(0.9601, device='cuda:3')
test acc is  0.2418166668230046
test loss is 1.2961846227203604
test entropy is  0.7765669825234647
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2053087949752808
mal norm is  tensor(610.9986, device='cuda:3')
distance x is tensor(120.8845, device='cuda:3')
mal distance is  tensor(120.8845, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([27., 27., 27., 27., 27., 27., 27., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 27., 27., 27., 27., 27., 27., 27.])
count_res tensor([6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 90.40% 

Test Accuracy: 89.27% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.34097450971603394
distance x is tensor(65.0025, device='cuda:3')
benign distance is  tensor(65.0025, device='cuda:3')
norm1 res is  tensor(284.4641, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5422462224960327
distance x is tensor(91.4629, device='cuda:3')
benign distance is  tensor(91.4629, device='cuda:3')
norm1 res is  tensor(405.3394, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.08901216834783554
distance x is tensor(89.9030, device='cuda:3')
benign distance is  tensor(89.9030, device='cuda:3')
norm1 res is  tensor(378.4036, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7800483703613281
distance x is tensor(90.3870, device='cuda:3')
benign distance is  tensor(90.3870, device='cuda:3')
norm1 res is  tensor(394.4075, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.32448720932006836
distance x is tensor(67.4969, device='cuda:3')
benign distance is  tensor(67.4969, device='cuda:3')
norm1 res is  tensor(296.6689, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6654070019721985
distance x is tensor(92.0308, device='cuda:3')
benign distance is  tensor(92.0308, device='cuda:3')
norm1 res is  tensor(398.9008, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1707591563463211
distance x is tensor(89.5149, device='cuda:3')
benign distance is  tensor(89.5149, device='cuda:3')
norm1 res is  tensor(381.6807, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4346066117286682
distance x is tensor(80.3438, device='cuda:3')
benign distance is  tensor(80.3438, device='cuda:3')
norm1 res is  tensor(350.8745, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.163285031914711
distance x is tensor(107.5558, device='cuda:3')
benign distance is  tensor(107.5558, device='cuda:3')
norm1 res is  tensor(471.5516, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.2112265825271606
distance x is tensor(122.0237, device='cuda:3')
benign distance is  tensor(122.0237, device='cuda:3')
norm1 res is  tensor(540.8807, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.2937037944793701
distance x is tensor(110.8838, device='cuda:3')
benign distance is  tensor(110.8838, device='cuda:3')
norm1 res is  tensor(480.7975, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9013787508010864
distance x is tensor(99.0538, device='cuda:3')
benign distance is  tensor(99.0538, device='cuda:3')
norm1 res is  tensor(438.7891, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5937997698783875
distance x is tensor(101.0241, device='cuda:3')
benign distance is  tensor(101.0241, device='cuda:3')
norm1 res is  tensor(449.7332, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.19396448135375977
distance x is tensor(101.7380, device='cuda:3')
benign distance is  tensor(101.7380, device='cuda:3')
norm1 res is  tensor(451.4577, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3167497515678406
distance x is tensor(114.6161, device='cuda:3')
benign distance is  tensor(114.6161, device='cuda:3')
norm1 res is  tensor(509.2320, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9111061096191406
distance x is tensor(107.7679, device='cuda:3')
benign distance is  tensor(107.7679, device='cuda:3')
norm1 res is  tensor(463.8778, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(113.6320, device='cuda:3')
compute distance is  tensor(113.6320, device='cuda:3')
compute norm is  tensor(49.0982, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.0250, device='cuda:3')
compute distance is  tensor(117.0250, device='cuda:3')
compute norm is  tensor(49.3438, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.4633, device='cuda:3')
compute distance is  tensor(106.4633, device='cuda:3')
compute norm is  tensor(49.2604, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.3633, device='cuda:3')
compute distance is  tensor(102.3633, device='cuda:3')
compute norm is  tensor(48.9860, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.8743, device='cuda:3')
compute distance is  tensor(125.8743, device='cuda:3')
compute norm is  tensor(49.4583, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.6218, device='cuda:3')
compute distance is  tensor(108.6218, device='cuda:3')
compute norm is  tensor(49.2205, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.0301, device='cuda:3')
compute distance is  tensor(104.0301, device='cuda:3')
compute norm is  tensor(49.1192, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.4220, device='cuda:3')
compute distance is  tensor(112.4220, device='cuda:3')
compute norm is  tensor(49.2654, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.5231, device='cuda:3')
compute distance is  tensor(126.5231, device='cuda:3')
compute norm is  tensor(49.4162, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.8991, device='cuda:3')
compute distance is  tensor(108.8991, device='cuda:3')
compute norm is  tensor(49.2416, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.4982, device='cuda:3')
compute distance is  tensor(121.4982, device='cuda:3')
compute norm is  tensor(49.4298, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.8347, device='cuda:3')
compute distance is  tensor(114.8347, device='cuda:3')
compute norm is  tensor(49.2689, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(126.5231, device='cuda:3')
distance x is tensor(106175.1484, device='cuda:3')
distance x is tensor(106175.1484, device='cuda:3')
________________________________
test distance is  tensor(106175.1484, device='cuda:3')
test distance1 is  tensor(106175.1484, device='cuda:3')
test similarity is  tensor(0.0570, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139287526387720.73
test entropy is  0.0
________________________________
cal ratio is  0.03382981119608874
distance x is tensor(3591.8906, device='cuda:3')
cal_distance is  tensor(3591.8906, device='cuda:3')
cal ratio is  0.1839286847354782
distance x is tensor(660.6558, device='cuda:3')
cal_distance is  tensor(660.6558, device='cuda:3')
cal ratio is  0.4288677602219138
distance x is tensor(283.3368, device='cuda:3')
cal_distance is  tensor(283.3368, device='cuda:3')
cal ratio is  0.6548767146262658
distance x is tensor(185.5524, device='cuda:3')
cal_distance is  tensor(185.5524, device='cuda:3')
cal ratio is  0.8092408047337217
distance x is tensor(150.1575, device='cuda:3')
cal_distance is  tensor(150.1575, device='cuda:3')
cal ratio is  0.8995752992060689
distance x is tensor(135.0785, device='cuda:3')
cal_distance is  tensor(135.0785, device='cuda:3')
cal ratio is  0.9484576530892054
distance x is tensor(128.1165, device='cuda:3')
cal_distance is  tensor(128.1165, device='cuda:3')
cal ratio is  0.9738869863288325
distance x is tensor(124.7711, device='cuda:3')
cal_distance is  tensor(124.7711, device='cuda:3')
distance x is tensor(124.7711, device='cuda:3')
return_distance is  tensor(124.7711, device='cuda:3')
distance x is tensor(124.7613, device='cuda:3')
distance x is tensor(124.7613, device='cuda:3')
________________________________
test distance is  tensor(124.7613, device='cuda:3')
test distance1 is  tensor(124.7613, device='cuda:3')
test similarity is  tensor(0.9599, device='cuda:3')
test acc is  0.10000000015633198
test loss is 186.03607002046826
test entropy is  2.842882656692824e-21
________________________________
0
distance x is tensor(124.7613, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  8.781700957504001e-21
avg test loss is  186.03947225867557
avg accuracy is  0.6601333334896664
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9599, device='cuda:3')
compute_distance is  tensor(124.7613, device='cuda:3')
compute_norm is  tensor(49.7301, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(115.0247, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8261052586757807
avg test loss is  1.2971034008683935
avg accuracy is  0.8861000001563217
solo acc is  0.3267833334896734
compute similarity  is  tensor(0.9626, device='cuda:3')
compute_distance is  tensor(115.0247, device='cuda:3')
compute_norm is  tensor(49.1545, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(116.3047, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7975973769672898
avg test loss is  1.3362222274483393
avg accuracy is  0.8877833334896551
solo acc is  0.26273333348967187
compute similarity  is  tensor(0.9622, device='cuda:3')
compute_distance is  tensor(116.3047, device='cuda:3')
compute_norm is  tensor(48.8754, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.4994, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7858007153722523
avg test loss is  1.3066040137683406
avg accuracy is  0.8902000001563216
solo acc is  0.25556666682300505
compute similarity  is  tensor(0.9619, device='cuda:3')
compute_distance is  tensor(117.4994, device='cuda:3')
compute_norm is  tensor(48.6072, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(118.7703, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7809985599665246
avg test loss is  1.2934746972914697
avg accuracy is  0.8923500001563215
solo acc is  0.24395000015633803
compute similarity  is  tensor(0.9616, device='cuda:3')
compute_distance is  tensor(118.7703, device='cuda:3')
compute_norm is  tensor(48.3461, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(120.0311, device='cuda:3')
distance x is tensor(120.0311, device='cuda:3')
________________________________
test distance is  tensor(120.0311, device='cuda:3')
test distance1 is  tensor(120.0311, device='cuda:3')
test similarity is  tensor(0.9613, device='cuda:3')
test acc is  0.24310000015633798
test loss is 1.2672061104255954
test entropy is  0.7822873066229098
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.129366159439087
mal norm is  tensor(603.8484, device='cuda:3')
distance x is tensor(120.0382, device='cuda:3')
mal distance is  tensor(120.0382, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([27., 27., 27., 27., 27., 27., 27., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 27., 27., 27., 27., 27., 27., 27.])
count_res tensor([6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 90.60% 

Test Accuracy: 89.59% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.289787232875824
distance x is tensor(90.9270, device='cuda:3')
benign distance is  tensor(90.9270, device='cuda:3')
norm1 res is  tensor(389.5612, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.39472144842147827
distance x is tensor(75.9066, device='cuda:3')
benign distance is  tensor(75.9066, device='cuda:3')
norm1 res is  tensor(337.8261, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.16811396181583405
distance x is tensor(100.8547, device='cuda:3')
benign distance is  tensor(100.8547, device='cuda:3')
norm1 res is  tensor(435.4497, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5852420926094055
distance x is tensor(85.7619, device='cuda:3')
benign distance is  tensor(85.7619, device='cuda:3')
norm1 res is  tensor(362.0433, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3946968913078308
distance x is tensor(89.1356, device='cuda:3')
benign distance is  tensor(89.1356, device='cuda:3')
norm1 res is  tensor(374.9698, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.384956032037735
distance x is tensor(76.1596, device='cuda:3')
benign distance is  tensor(76.1596, device='cuda:3')
norm1 res is  tensor(331.1249, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3453255295753479
distance x is tensor(81.7043, device='cuda:3')
benign distance is  tensor(81.7043, device='cuda:3')
norm1 res is  tensor(346.3061, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.15534605085849762
distance x is tensor(100.5051, device='cuda:3')
benign distance is  tensor(100.5051, device='cuda:3')
norm1 res is  tensor(429.2675, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3316396474838257
distance x is tensor(116.4089, device='cuda:3')
benign distance is  tensor(116.4089, device='cuda:3')
norm1 res is  tensor(517.6735, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.01866237446665764
distance x is tensor(110.4466, device='cuda:3')
benign distance is  tensor(110.4466, device='cuda:3')
norm1 res is  tensor(482.4868, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.47917112708091736
distance x is tensor(122.0247, device='cuda:3')
benign distance is  tensor(122.0247, device='cuda:3')
norm1 res is  tensor(526.7016, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.16341084241867065
distance x is tensor(118.6079, device='cuda:3')
benign distance is  tensor(118.6079, device='cuda:3')
norm1 res is  tensor(517.1863, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5382605791091919
distance x is tensor(118.3941, device='cuda:3')
benign distance is  tensor(118.3941, device='cuda:3')
norm1 res is  tensor(515.0004, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.015972375869751
distance x is tensor(102.4804, device='cuda:3')
benign distance is  tensor(102.4804, device='cuda:3')
norm1 res is  tensor(442.6893, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.48454412817955017
distance x is tensor(113.1991, device='cuda:3')
benign distance is  tensor(113.1991, device='cuda:3')
norm1 res is  tensor(488.7993, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.35748955607414246
distance x is tensor(119.5325, device='cuda:3')
benign distance is  tensor(119.5325, device='cuda:3')
norm1 res is  tensor(521.4853, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(112.4293, device='cuda:3')
compute distance is  tensor(112.4293, device='cuda:3')
compute norm is  tensor(48.9380, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.3839, device='cuda:3')
compute distance is  tensor(102.3839, device='cuda:3')
compute norm is  tensor(48.9250, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.9283, device='cuda:3')
compute distance is  tensor(107.9283, device='cuda:3')
compute norm is  tensor(49.1865, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.0426, device='cuda:3')
compute distance is  tensor(109.0426, device='cuda:3')
compute norm is  tensor(49.1317, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.7410, device='cuda:3')
compute distance is  tensor(105.7410, device='cuda:3')
compute norm is  tensor(49.0058, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.3162, device='cuda:3')
compute distance is  tensor(109.3162, device='cuda:3')
compute norm is  tensor(49.1308, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.2962, device='cuda:3')
compute distance is  tensor(113.2962, device='cuda:3')
compute norm is  tensor(49.2362, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.5632, device='cuda:3')
compute distance is  tensor(110.5632, device='cuda:3')
compute norm is  tensor(49.1268, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.1521, device='cuda:3')
compute distance is  tensor(124.1521, device='cuda:3')
compute norm is  tensor(49.3152, device='cuda:3', dtype=torch.float64)
distance x is tensor(91.7682, device='cuda:3')
compute distance is  tensor(91.7682, device='cuda:3')
compute norm is  tensor(48.9022, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.5302, device='cuda:3')
compute distance is  tensor(114.5302, device='cuda:3')
compute norm is  tensor(49.2281, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.5987, device='cuda:3')
compute distance is  tensor(110.5987, device='cuda:3')
compute norm is  tensor(49.1661, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(124.1521, device='cuda:3')
distance x is tensor(106178.7422, device='cuda:3')
distance x is tensor(106178.7422, device='cuda:3')
________________________________
test distance is  tensor(106178.7422, device='cuda:3')
test distance1 is  tensor(106178.7422, device='cuda:3')
test similarity is  tensor(0.0431, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139293571274092.62
test entropy is  0.0
________________________________
cal ratio is  0.03351076710697422
distance x is tensor(3558.1360, device='cuda:3')
cal_distance is  tensor(3558.1360, device='cuda:3')
cal ratio is  0.1830593365307677
distance x is tensor(651.3541, device='cuda:3')
cal_distance is  tensor(651.3541, device='cuda:3')
cal ratio is  0.4278530131621658
distance x is tensor(278.6866, device='cuda:3')
cal_distance is  tensor(278.6866, device='cuda:3')
cal ratio is  0.6541014765605261
distance x is tensor(182.2911, device='cuda:3')
cal_distance is  tensor(182.2911, device='cuda:3')
cal ratio is  0.8087615170756897
distance x is tensor(147.4310, device='cuda:3')
cal_distance is  tensor(147.4310, device='cuda:3')
cal ratio is  0.8993087571450827
distance x is tensor(132.5865, device='cuda:3')
cal_distance is  tensor(132.5865, device='cuda:3')
cal ratio is  0.9483171057164691
distance x is tensor(125.7343, device='cuda:3')
cal_distance is  tensor(125.7343, device='cuda:3')
cal ratio is  0.9738147440089338
distance x is tensor(122.4420, device='cuda:3')
cal_distance is  tensor(122.4420, device='cuda:3')
distance x is tensor(122.4420, device='cuda:3')
return_distance is  tensor(122.4420, device='cuda:3')
distance x is tensor(122.4321, device='cuda:3')
distance x is tensor(122.4321, device='cuda:3')
________________________________
test distance is  tensor(122.4321, device='cuda:3')
test distance1 is  tensor(122.4321, device='cuda:3')
test similarity is  tensor(0.9607, device='cuda:3')
test acc is  0.10000000015633198
test loss is 164.38674398068426
test entropy is  4.694979567373243e-19
________________________________
0
distance x is tensor(122.4321, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.169209424732967e-19
avg test loss is  164.37396248368057
avg accuracy is  0.7054500001563304
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9607, device='cuda:3')
compute_distance is  tensor(122.4321, device='cuda:3')
compute_norm is  tensor(49.4569, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(111.6962, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8182096568379067
avg test loss is  1.2415278177779874
avg accuracy is  0.8901166668229883
solo acc is  0.36305000015634054
compute similarity  is  tensor(0.9634, device='cuda:3')
compute_distance is  tensor(111.6962, device='cuda:3')
compute_norm is  tensor(48.7878, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(113.2871, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7838534404601115
avg test loss is  1.321407786056177
avg accuracy is  0.891133333489655
solo acc is  0.27285000015633887
compute similarity  is  tensor(0.9629, device='cuda:3')
compute_distance is  tensor(113.2871, device='cuda:3')
compute_norm is  tensor(48.4920, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(114.7922, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7886402791878308
avg test loss is  1.290466576115663
avg accuracy is  0.8940166668229882
solo acc is  0.2651000001563387
compute similarity  is  tensor(0.9626, device='cuda:3')
compute_distance is  tensor(114.7922, device='cuda:3')
compute_norm is  tensor(48.2166, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(116.2964, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7831461459461814
avg test loss is  1.2733370591201254
avg accuracy is  0.8949333334896549
solo acc is  0.25515000015633843
compute similarity  is  tensor(0.9622, device='cuda:3')
compute_distance is  tensor(116.2964, device='cuda:3')
compute_norm is  tensor(47.9541, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.7156, device='cuda:3')
distance x is tensor(117.7156, device='cuda:3')
________________________________
test distance is  tensor(117.7156, device='cuda:3')
test distance1 is  tensor(117.7156, device='cuda:3')
test similarity is  tensor(0.9619, device='cuda:3')
test acc is  0.24543333348967142
test loss is 1.2623795928604313
test entropy is  0.7778758201390695
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.0658832788467407
mal norm is  tensor(594.1436, device='cuda:3')
distance x is tensor(117.7227, device='cuda:3')
mal distance is  tensor(117.7227, device='cuda:3')
user_PLR len size 52
counter_tensor is  tensor([51., 51., 51., 51., 51., 51., 51., 51., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 51., 51., 51., 51., 51., 51., 51., 51.,
        51., 51., 51., 51., 51., 51., 51., 51., 51., 51., 51., 51., 51., 51.,
        51., 51., 51., 51., 51., 51., 51., 51., 51., 51.])
count_res tensor([2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 4.1754e-07, 4.1754e-07, 4.1754e-07, 4.1754e-07,
        4.1754e-07, 4.1754e-07, 4.1754e-07, 4.1754e-07, 4.1754e-07, 4.1754e-07,
        4.1754e-07, 4.1754e-07, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 90.57% 

Test Accuracy: 89.71% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5209575891494751
distance x is tensor(70.3612, device='cuda:3')
benign distance is  tensor(70.3612, device='cuda:3')
norm1 res is  tensor(300.5042, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6441782712936401
distance x is tensor(71.9635, device='cuda:3')
benign distance is  tensor(71.9635, device='cuda:3')
norm1 res is  tensor(320.5504, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.11066578328609467
distance x is tensor(95.8288, device='cuda:3')
benign distance is  tensor(95.8288, device='cuda:3')
norm1 res is  tensor(402.8392, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.404207319021225
distance x is tensor(78.8093, device='cuda:3')
benign distance is  tensor(78.8093, device='cuda:3')
norm1 res is  tensor(343.1458, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2646684944629669
distance x is tensor(63.2134, device='cuda:3')
benign distance is  tensor(63.2134, device='cuda:3')
norm1 res is  tensor(270.6232, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5989633798599243
distance x is tensor(77.9853, device='cuda:3')
benign distance is  tensor(77.9853, device='cuda:3')
norm1 res is  tensor(342.1130, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3753761351108551
distance x is tensor(98.3744, device='cuda:3')
benign distance is  tensor(98.3744, device='cuda:3')
norm1 res is  tensor(413.5379, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.34955257177352905
distance x is tensor(89.5350, device='cuda:3')
benign distance is  tensor(89.5350, device='cuda:3')
norm1 res is  tensor(391.2593, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5444033741950989
distance x is tensor(104.3145, device='cuda:3')
benign distance is  tensor(104.3145, device='cuda:3')
norm1 res is  tensor(452.9678, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6838576793670654
distance x is tensor(105.5648, device='cuda:3')
benign distance is  tensor(105.5648, device='cuda:3')
norm1 res is  tensor(455.7401, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6142804622650146
distance x is tensor(97.5687, device='cuda:3')
benign distance is  tensor(97.5687, device='cuda:3')
norm1 res is  tensor(431.6899, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.0632693767547607
distance x is tensor(102.1671, device='cuda:3')
benign distance is  tensor(102.1671, device='cuda:3')
norm1 res is  tensor(455.8114, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3568044602870941
distance x is tensor(99.8692, device='cuda:3')
benign distance is  tensor(99.8692, device='cuda:3')
norm1 res is  tensor(437.5812, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.25449180603027344
distance x is tensor(112.8385, device='cuda:3')
benign distance is  tensor(112.8385, device='cuda:3')
norm1 res is  tensor(497.8994, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2825751006603241
distance x is tensor(97.7044, device='cuda:3')
benign distance is  tensor(97.7044, device='cuda:3')
norm1 res is  tensor(435.9260, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5641162991523743
distance x is tensor(108.3540, device='cuda:3')
benign distance is  tensor(108.3540, device='cuda:3')
norm1 res is  tensor(483.4045, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.36960795521736145
distance x is tensor(109.1034, device='cuda:3')
benign distance is  tensor(109.1034, device='cuda:3')
norm1 res is  tensor(483.6810, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6941965222358704
distance x is tensor(122.1118, device='cuda:3')
benign distance is  tensor(122.1118, device='cuda:3')
norm1 res is  tensor(535.6402, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5561374425888062
distance x is tensor(106.6197, device='cuda:3')
benign distance is  tensor(106.6197, device='cuda:3')
norm1 res is  tensor(461.9319, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4751375615596771
distance x is tensor(125.2834, device='cuda:3')
benign distance is  tensor(125.2834, device='cuda:3')
norm1 res is  tensor(546.0197, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.018955323845148087
distance x is tensor(115.2837, device='cuda:3')
benign distance is  tensor(115.2837, device='cuda:3')
norm1 res is  tensor(510.9920, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5020448565483093
distance x is tensor(110.1378, device='cuda:3')
benign distance is  tensor(110.1378, device='cuda:3')
norm1 res is  tensor(477.9437, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.6761907339096069
distance x is tensor(108.8694, device='cuda:3')
benign distance is  tensor(108.8694, device='cuda:3')
norm1 res is  tensor(485.9013, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6163389086723328
distance x is tensor(106.6428, device='cuda:3')
benign distance is  tensor(106.6428, device='cuda:3')
norm1 res is  tensor(468.3937, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.23416075110435486
distance x is tensor(112.0926, device='cuda:3')
benign distance is  tensor(112.0926, device='cuda:3')
norm1 res is  tensor(501.9170, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.9000822901725769
distance x is tensor(98.4034, device='cuda:3')
benign distance is  tensor(98.4034, device='cuda:3')
norm1 res is  tensor(418.1581, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.24394908547401428
distance x is tensor(114.6323, device='cuda:3')
benign distance is  tensor(114.6323, device='cuda:3')
norm1 res is  tensor(496.7719, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.7867328524589539
distance x is tensor(116.3824, device='cuda:3')
benign distance is  tensor(116.3824, device='cuda:3')
norm1 res is  tensor(503.6935, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7200738191604614
distance x is tensor(103.3636, device='cuda:3')
benign distance is  tensor(103.3636, device='cuda:3')
norm1 res is  tensor(461.3421, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5076696872711182
distance x is tensor(117.0550, device='cuda:3')
benign distance is  tensor(117.0550, device='cuda:3')
norm1 res is  tensor(518.3365, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.21982407569885254
distance x is tensor(103.3193, device='cuda:3')
benign distance is  tensor(103.3193, device='cuda:3')
norm1 res is  tensor(464.5880, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.34112972021102905
distance x is tensor(112.9870, device='cuda:3')
benign distance is  tensor(112.9870, device='cuda:3')
norm1 res is  tensor(505.8289, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.12247855961322784
distance x is tensor(106.2449, device='cuda:3')
benign distance is  tensor(106.2449, device='cuda:3')
norm1 res is  tensor(477.6036, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.24027200043201447
distance x is tensor(120.3798, device='cuda:3')
benign distance is  tensor(120.3798, device='cuda:3')
norm1 res is  tensor(522.3028, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.018991561606526375
distance x is tensor(107.5644, device='cuda:3')
benign distance is  tensor(107.5644, device='cuda:3')
norm1 res is  tensor(465.2636, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.15485145151615143
distance x is tensor(105.3470, device='cuda:3')
benign distance is  tensor(105.3470, device='cuda:3')
norm1 res is  tensor(458.9371, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.4669869542121887
distance x is tensor(116.8966, device='cuda:3')
benign distance is  tensor(116.8966, device='cuda:3')
norm1 res is  tensor(514.2465, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.9755401611328125
distance x is tensor(114.6673, device='cuda:3')
benign distance is  tensor(114.6673, device='cuda:3')
norm1 res is  tensor(496.6375, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6227449774742126
distance x is tensor(112.7532, device='cuda:3')
benign distance is  tensor(112.7532, device='cuda:3')
norm1 res is  tensor(485.7815, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.4500076174736023
distance x is tensor(125.1333, device='cuda:3')
benign distance is  tensor(125.1333, device='cuda:3')
norm1 res is  tensor(551.0161, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(108.1071, device='cuda:3')
compute distance is  tensor(108.1071, device='cuda:3')
compute norm is  tensor(49.0718, device='cuda:3', dtype=torch.float64)
distance x is tensor(98.0359, device='cuda:3')
compute distance is  tensor(98.0359, device='cuda:3')
compute norm is  tensor(49.0066, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.1992, device='cuda:3')
compute distance is  tensor(112.1992, device='cuda:3')
compute norm is  tensor(49.3766, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.5948, device='cuda:3')
compute distance is  tensor(105.5948, device='cuda:3')
compute norm is  tensor(49.1304, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.6971, device='cuda:3')
compute distance is  tensor(108.6971, device='cuda:3')
compute norm is  tensor(49.0694, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.8683, device='cuda:3')
compute distance is  tensor(120.8683, device='cuda:3')
compute norm is  tensor(49.3535, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.5284, device='cuda:3')
compute distance is  tensor(105.5284, device='cuda:3')
compute norm is  tensor(49.1210, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.9736, device='cuda:3')
compute distance is  tensor(107.9736, device='cuda:3')
compute norm is  tensor(49.2421, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.8739, device='cuda:3')
compute distance is  tensor(108.8739, device='cuda:3')
compute norm is  tensor(49.2025, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.1449, device='cuda:3')
compute distance is  tensor(115.1449, device='cuda:3')
compute norm is  tensor(49.3642, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.3891, device='cuda:3')
compute distance is  tensor(113.3891, device='cuda:3')
compute norm is  tensor(49.3780, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.6680, device='cuda:3')
compute distance is  tensor(107.6680, device='cuda:3')
compute norm is  tensor(49.2177, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(120.8683, device='cuda:3')
distance x is tensor(106179.0547, device='cuda:3')
distance x is tensor(106179.0547, device='cuda:3')
________________________________
test distance is  tensor(106179.0547, device='cuda:3')
test distance1 is  tensor(106179.0547, device='cuda:3')
test similarity is  tensor(0.0457, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139267976012387.34
test entropy is  0.0
________________________________
cal ratio is  0.03306457102029145
distance x is tensor(3510.7698, device='cuda:3')
cal_distance is  tensor(3510.7698, device='cuda:3')
cal ratio is  0.1818365277732504
distance x is tensor(638.3903, device='cuda:3')
cal_distance is  tensor(638.3903, device='cuda:3')
cal ratio is  0.42642159506702043
distance x is tensor(272.2262, device='cuda:3')
cal_distance is  tensor(272.2262, device='cuda:3')
cal ratio is  0.6530062823475337
distance x is tensor(177.7672, device='cuda:3')
cal_distance is  tensor(177.7672, device='cuda:3')
cal ratio is  0.8080840791961285
distance x is tensor(143.6518, device='cuda:3')
cal_distance is  tensor(143.6518, device='cuda:3')
cal ratio is  0.8989319439694884
distance x is tensor(129.1337, device='cuda:3')
cal_distance is  tensor(129.1337, device='cuda:3')
cal ratio is  0.9481184568663442
distance x is tensor(122.4343, device='cuda:3')
cal_distance is  tensor(122.4343, device='cuda:3')
cal ratio is  0.9737126022106103
distance x is tensor(119.2159, device='cuda:3')
cal_distance is  tensor(119.2159, device='cuda:3')
distance x is tensor(119.2159, device='cuda:3')
return_distance is  tensor(119.2159, device='cuda:3')
distance x is tensor(119.2061, device='cuda:3')
distance x is tensor(119.2061, device='cuda:3')
________________________________
test distance is  tensor(119.2061, device='cuda:3')
test distance1 is  tensor(119.2061, device='cuda:3')
test similarity is  tensor(0.9628, device='cuda:3')
test acc is  0.10000000015633198
test loss is 144.8449323934787
test entropy is  1.417421195132613e-18
________________________________
0
distance x is tensor(119.2061, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  7.036905918043076e-18
avg test loss is  144.79591251690505
avg accuracy is  0.735183333489662
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9628, device='cuda:3')
compute_distance is  tensor(119.2061, device='cuda:3')
compute_norm is  tensor(49.4659, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(108.9063, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8165710164285672
avg test loss is  1.2338597890156418
avg accuracy is  0.8943666668229882
solo acc is  0.3566333334896739
compute similarity  is  tensor(0.9651, device='cuda:3')
compute_distance is  tensor(108.9063, device='cuda:3')
compute_norm is  tensor(48.7940, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(110.6224, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7816149625442684
avg test loss is  1.3140421335631087
avg accuracy is  0.8942500001563215
solo acc is  0.2738000001563389
compute similarity  is  tensor(0.9647, device='cuda:3')
compute_distance is  tensor(110.6224, device='cuda:3')
compute_norm is  tensor(48.5010, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(112.1391, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7848195748796849
avg test loss is  1.2795234391175863
avg accuracy is  0.895466666822988
solo acc is  0.2689500001563388
compute similarity  is  tensor(0.9643, device='cuda:3')
compute_distance is  tensor(112.1391, device='cuda:3')
compute_norm is  tensor(48.2262, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(113.6307, device='cuda:3')
exit early
distance x is tensor(113.6307, device='cuda:3')
distance x is tensor(113.6307, device='cuda:3')
________________________________
test distance is  tensor(113.6307, device='cuda:3')
test distance1 is  tensor(113.6307, device='cuda:3')
test similarity is  tensor(0.9640, device='cuda:3')
test acc is  0.2517333334896716
test loss is 1.2745700874435368
test entropy is  0.7754307309828842
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.1480724811553955
mal norm is  tensor(580.4516, device='cuda:3')
distance x is tensor(113.6380, device='cuda:3')
mal distance is  tensor(113.6380, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([19., 19., 19., 19., 19., 19., 19., 19., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0669,
        0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669,
        0.0669, 0.0669])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 81.92% 

Test Accuracy: 80.72% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.46811556816101074
distance x is tensor(149.6546, device='cuda:3')
benign distance is  tensor(149.6546, device='cuda:3')
norm1 res is  tensor(615.3358, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.47054916620254517
distance x is tensor(128.7083, device='cuda:3')
benign distance is  tensor(128.7083, device='cuda:3')
norm1 res is  tensor(527.4904, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.042770497500896454
distance x is tensor(146.5784, device='cuda:3')
benign distance is  tensor(146.5784, device='cuda:3')
norm1 res is  tensor(601.8668, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3708324730396271
distance x is tensor(119.0352, device='cuda:3')
benign distance is  tensor(119.0352, device='cuda:3')
norm1 res is  tensor(482.7643, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6694635152816772
distance x is tensor(145.1801, device='cuda:3')
benign distance is  tensor(145.1801, device='cuda:3')
norm1 res is  tensor(587.9350, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.986617922782898
distance x is tensor(138.2912, device='cuda:3')
benign distance is  tensor(138.2912, device='cuda:3')
norm1 res is  tensor(569.0383, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4018586277961731
distance x is tensor(128.4138, device='cuda:3')
benign distance is  tensor(128.4138, device='cuda:3')
norm1 res is  tensor(524.6602, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7876787781715393
distance x is tensor(132.5926, device='cuda:3')
benign distance is  tensor(132.5926, device='cuda:3')
norm1 res is  tensor(544.0671, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(129.2858, device='cuda:3')
compute distance is  tensor(129.2858, device='cuda:3')
compute norm is  tensor(49.3305, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.8204, device='cuda:3')
compute distance is  tensor(131.8204, device='cuda:3')
compute norm is  tensor(49.3932, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.6076, device='cuda:3')
compute distance is  tensor(138.6076, device='cuda:3')
compute norm is  tensor(49.7523, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.2222, device='cuda:3')
compute distance is  tensor(155.2222, device='cuda:3')
compute norm is  tensor(49.9776, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.9601, device='cuda:3')
compute distance is  tensor(157.9601, device='cuda:3')
compute norm is  tensor(50.0901, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.3701, device='cuda:3')
compute distance is  tensor(151.3701, device='cuda:3')
compute norm is  tensor(49.8949, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.0203, device='cuda:3')
compute distance is  tensor(160.0203, device='cuda:3')
compute norm is  tensor(49.8952, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.3167, device='cuda:3')
compute distance is  tensor(146.3167, device='cuda:3')
compute norm is  tensor(49.8782, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.5771, device='cuda:3')
compute distance is  tensor(143.5771, device='cuda:3')
compute norm is  tensor(49.6046, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.1460, device='cuda:3')
compute distance is  tensor(159.1460, device='cuda:3')
compute norm is  tensor(49.9954, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.9817, device='cuda:3')
compute distance is  tensor(147.9817, device='cuda:3')
compute norm is  tensor(49.7644, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.5558, device='cuda:3')
compute distance is  tensor(152.5558, device='cuda:3')
compute norm is  tensor(49.8533, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(160.0203, device='cuda:3')
distance x is tensor(106116.9219, device='cuda:3')
distance x is tensor(106116.9219, device='cuda:3')
________________________________
test distance is  tensor(106116.9219, device='cuda:3')
test distance1 is  tensor(106116.9219, device='cuda:3')
test similarity is  tensor(0.2377, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139271892088259.95
test entropy is  0.0
________________________________
cal ratio is  0.03805583381152441
distance x is tensor(4038.3733, device='cuda:3')
cal_distance is  tensor(4038.3733, device='cuda:3')
cal ratio is  0.19507891280901635
distance x is tensor(787.8055, device='cuda:3')
cal_distance is  tensor(787.8055, device='cuda:3')
cal ratio is  0.4416762564588184
distance x is tensor(347.9577, device='cuda:3')
cal_distance is  tensor(347.9577, device='cuda:3')
cal ratio is  0.6645846690510289
distance x is tensor(231.2490, device='cuda:3')
cal_distance is  tensor(231.2490, device='cuda:3')
cal ratio is  0.8152176923447757
distance x is tensor(188.5192, device='cuda:3')
cal_distance is  tensor(188.5192, device='cuda:3')
cal ratio is  0.9028919085488302
distance x is tensor(170.2130, device='cuda:3')
cal_distance is  tensor(170.2130, device='cuda:3')
cal ratio is  0.9502048643222128
distance x is tensor(161.7375, device='cuda:3')
cal_distance is  tensor(161.7375, device='cuda:3')
cal ratio is  0.9747836910945249
distance x is tensor(157.6592, device='cuda:3')
cal_distance is  tensor(157.6592, device='cuda:3')
distance x is tensor(157.6592, device='cuda:3')
return_distance is  tensor(157.6592, device='cuda:3')
distance x is tensor(157.6493, device='cuda:3')
distance x is tensor(157.6493, device='cuda:3')
________________________________
test distance is  tensor(157.6493, device='cuda:3')
test distance1 is  tensor(157.6493, device='cuda:3')
test similarity is  tensor(0.9487, device='cuda:3')
test acc is  0.10000000015633198
test loss is 529.15861748734
test entropy is  0.0
________________________________
0
distance x is tensor(157.6493, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  529.1425438008583
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9487, device='cuda:3')
compute_distance is  tensor(157.6493, device='cuda:3')
compute_norm is  tensor(52.0600, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(173.9716, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5448829030939766
avg test loss is  2.718220724225807
avg accuracy is  0.30930000015633974
solo acc is  0.11243333348966528
compute similarity  is  tensor(0.9405, device='cuda:3')
compute_distance is  tensor(173.9716, device='cuda:3')
compute_norm is  tensor(53.5340, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(174.8098, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8250900986733467
avg test loss is  3.445331112662358
avg accuracy is  0.24085000015633795
solo acc is  0.10076666682299863
compute similarity  is  tensor(0.9398, device='cuda:3')
compute_distance is  tensor(174.8098, device='cuda:3')
compute_norm is  tensor(53.6183, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(176.9349, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.355528708587069
avg test loss is  2.3044312431105674
avg accuracy is  0.31661666682300643
solo acc is  0.13203333348966523
compute similarity  is  tensor(0.9409, device='cuda:3')
compute_distance is  tensor(176.9349, device='cuda:3')
compute_norm is  tensor(53.1653, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(177.8982, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7604096366017103
avg test loss is  3.0062319042840238
avg accuracy is  0.23456666682300437
solo acc is  0.10190000015633197
compute similarity  is  tensor(0.9403, device='cuda:3')
compute_distance is  tensor(177.8982, device='cuda:3')
compute_norm is  tensor(53.1758, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(179.5247, device='cuda:3')
distance x is tensor(179.5247, device='cuda:3')
________________________________
test distance is  tensor(179.5247, device='cuda:3')
test distance1 is  tensor(179.5247, device='cuda:3')
test similarity is  tensor(0.9408, device='cuda:3')
test acc is  0.14730000015633296
test loss is 2.035010280004188
test entropy is  1.2268792352696727
________________________________
cal ratio is  0.9252337193601502
distance x is tensor(166.1085, device='cuda:3')
cal_distance is  tensor(166.1085, device='cuda:3')
cal ratio is  0.9618726778033347
distance x is tensor(159.7754, device='cuda:3')
cal_distance is  tensor(159.7754, device='cuda:3')
distance x is tensor(159.7754, device='cuda:3')
return_distance is  tensor(159.7754, device='cuda:3')
distance x is tensor(159.7689, device='cuda:3')
distance x is tensor(159.7689, device='cuda:3')
________________________________
test distance is  tensor(159.7689, device='cuda:3')
test distance1 is  tensor(159.7689, device='cuda:3')
test similarity is  tensor(0.9517, device='cuda:3')
test acc is  0.13158333348966525
test loss is 1.9815345308673915
test entropy is  1.3905252427942971
________________________________
0
distance x is tensor(159.7689, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3891362766467177
avg test loss is  1.9781758051945457
avg accuracy is  0.4142333334896746
solo acc is  0.13143333348966524
compute similarity  is  tensor(0.9517, device='cuda:3')
compute_distance is  tensor(159.7689, device='cuda:3')
compute_norm is  tensor(52.0071, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(161.3903, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7369304137951784
avg test loss is  2.735249322106335
avg accuracy is  0.26238333348967197
solo acc is  0.10291666682299863
compute similarity  is  tensor(0.9508, device='cuda:3')
compute_distance is  tensor(161.3903, device='cuda:3')
compute_norm is  tensor(52.0161, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(163.3544, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.142919853552064
avg test loss is  1.8359187829977415
avg accuracy is  0.3787833334896742
solo acc is  0.1802500001563353
compute similarity  is  tensor(0.9510, device='cuda:3')
compute_distance is  tensor(163.3544, device='cuda:3')
compute_norm is  tensor(51.7296, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(164.2174, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6737081547027458
avg test loss is  2.58957235187864
avg accuracy is  0.26241666682300524
solo acc is  0.10191666682299863
compute similarity  is  tensor(0.9504, device='cuda:3')
compute_distance is  tensor(164.2174, device='cuda:3')
compute_norm is  tensor(51.6350, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(165.7198, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0452321847237505
avg test loss is  1.678679205842618
avg accuracy is  0.39136666682300764
solo acc is  0.2047000001563366
compute similarity  is  tensor(0.9507, device='cuda:3')
compute_distance is  tensor(165.7198, device='cuda:3')
compute_norm is  tensor(51.3183, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(166.4107, device='cuda:3')
distance x is tensor(166.4107, device='cuda:3')
________________________________
test distance is  tensor(166.4107, device='cuda:3')
test distance1 is  tensor(166.4107, device='cuda:3')
test similarity is  tensor(0.9503, device='cuda:3')
test acc is  0.1019833334896653
test loss is 2.4634201732525693
test entropy is  0.6237349362134426
________________________________
cal ratio is  0.9609989219946278
distance x is tensor(159.9266, device='cuda:3')
cal_distance is  tensor(159.9266, device='cuda:3')
distance x is tensor(159.9266, device='cuda:3')
return_distance is  tensor(159.9266, device='cuda:3')
distance x is tensor(159.9204, device='cuda:3')
distance x is tensor(159.9204, device='cuda:3')
________________________________
test distance is  tensor(159.9204, device='cuda:3')
test distance1 is  tensor(159.9204, device='cuda:3')
test similarity is  tensor(0.9537, device='cuda:3')
test acc is  0.10181666682299864
test loss is 2.3525368896628747
test entropy is  0.6989778361595007
________________________________
0
distance x is tensor(159.9204, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6984579462105277
avg test loss is  2.353966055140058
avg accuracy is  0.29976666682300623
solo acc is  0.10196666682299864
compute similarity  is  tensor(0.9537, device='cuda:3')
compute_distance is  tensor(159.9204, device='cuda:3')
compute_norm is  tensor(50.9485, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(161.4921, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0051700938612158
avg test loss is  1.5772080699772215
avg accuracy is  0.42181666682300806
solo acc is  0.20766666682300342
compute similarity  is  tensor(0.9537, device='cuda:3')
compute_distance is  tensor(161.4921, device='cuda:3')
compute_norm is  tensor(50.6718, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(162.1874, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6111313243156303
avg test loss is  2.357477576239531
avg accuracy is  0.29818333348967285
solo acc is  0.10205000015633196
compute similarity  is  tensor(0.9533, device='cuda:3')
compute_distance is  tensor(162.1874, device='cuda:3')
compute_norm is  tensor(50.5038, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(163.1977, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9781152927545088
avg test loss is  1.4846622730369
avg accuracy is  0.414416666823008
solo acc is  0.23320000015633774
compute similarity  is  tensor(0.9533, device='cuda:3')
compute_distance is  tensor(163.1977, device='cuda:3')
compute_norm is  tensor(50.2193, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(163.2038, device='cuda:3')
________________________________
test distance is  tensor(163.2038, device='cuda:3')
test similarity is  tensor(0.9533, device='cuda:3')
test acc is  0.4156500001563413
test loss is 1.487733646369438
test entropy is  0.9779084334368391
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.2970154285430908
mal norm is  tensor(696.6644, device='cuda:3')
distance x is tensor(163.2038, device='cuda:3')
mal distance is  tensor(163.2038, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([27., 27., 27., 27., 27., 27., 27., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 27., 27., 27., 27., 27., 27., 27.])
count_res tensor([6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 90.32% 

Test Accuracy: 89.39% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.21885213255882263
distance x is tensor(96.7866, device='cuda:3')
benign distance is  tensor(96.7866, device='cuda:3')
norm1 res is  tensor(422.5778, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.932439923286438
distance x is tensor(110.4472, device='cuda:3')
benign distance is  tensor(110.4472, device='cuda:3')
norm1 res is  tensor(480.9917, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3075699806213379
distance x is tensor(104.8267, device='cuda:3')
benign distance is  tensor(104.8267, device='cuda:3')
norm1 res is  tensor(445.0868, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5757271647453308
distance x is tensor(82.2824, device='cuda:3')
benign distance is  tensor(82.2824, device='cuda:3')
norm1 res is  tensor(348.4772, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6814639568328857
distance x is tensor(65.1142, device='cuda:3')
benign distance is  tensor(65.1142, device='cuda:3')
norm1 res is  tensor(277.0155, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5190702676773071
distance x is tensor(102.0048, device='cuda:3')
benign distance is  tensor(102.0048, device='cuda:3')
norm1 res is  tensor(438.3236, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3630487024784088
distance x is tensor(95.4735, device='cuda:3')
benign distance is  tensor(95.4735, device='cuda:3')
norm1 res is  tensor(402.6643, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.10685507953166962
distance x is tensor(95.0608, device='cuda:3')
benign distance is  tensor(95.0608, device='cuda:3')
norm1 res is  tensor(415.9951, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.14020581543445587
distance x is tensor(123.5006, device='cuda:3')
benign distance is  tensor(123.5006, device='cuda:3')
norm1 res is  tensor(527.1671, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.585992693901062
distance x is tensor(115.7196, device='cuda:3')
benign distance is  tensor(115.7196, device='cuda:3')
norm1 res is  tensor(487.8599, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.33910971879959106
distance x is tensor(113.2583, device='cuda:3')
benign distance is  tensor(113.2583, device='cuda:3')
norm1 res is  tensor(474.2677, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7998611330986023
distance x is tensor(106.6088, device='cuda:3')
benign distance is  tensor(106.6088, device='cuda:3')
norm1 res is  tensor(456.3537, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6771630048751831
distance x is tensor(108.8212, device='cuda:3')
benign distance is  tensor(108.8212, device='cuda:3')
norm1 res is  tensor(474.5322, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3467382490634918
distance x is tensor(118.5763, device='cuda:3')
benign distance is  tensor(118.5763, device='cuda:3')
norm1 res is  tensor(517.9191, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5207948684692383
distance x is tensor(102.1057, device='cuda:3')
benign distance is  tensor(102.1057, device='cuda:3')
norm1 res is  tensor(457.3199, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5678474307060242
distance x is tensor(103.5879, device='cuda:3')
benign distance is  tensor(103.5879, device='cuda:3')
norm1 res is  tensor(454.8957, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(119.7482, device='cuda:3')
compute distance is  tensor(119.7482, device='cuda:3')
compute norm is  tensor(49.6867, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.4745, device='cuda:3')
compute distance is  tensor(114.4745, device='cuda:3')
compute norm is  tensor(49.6637, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.4024, device='cuda:3')
compute distance is  tensor(118.4024, device='cuda:3')
compute norm is  tensor(49.8470, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.5624, device='cuda:3')
compute distance is  tensor(105.5624, device='cuda:3')
compute norm is  tensor(49.5143, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.0455, device='cuda:3')
compute distance is  tensor(121.0455, device='cuda:3')
compute norm is  tensor(49.8765, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.8315, device='cuda:3')
compute distance is  tensor(131.8315, device='cuda:3')
compute norm is  tensor(50.2189, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.8580, device='cuda:3')
compute distance is  tensor(110.8580, device='cuda:3')
compute norm is  tensor(49.7332, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.6903, device='cuda:3')
compute distance is  tensor(122.6903, device='cuda:3')
compute norm is  tensor(49.9260, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.1268, device='cuda:3')
compute distance is  tensor(116.1268, device='cuda:3')
compute norm is  tensor(49.7627, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.5502, device='cuda:3')
compute distance is  tensor(112.5502, device='cuda:3')
compute norm is  tensor(49.6616, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.4527, device='cuda:3')
compute distance is  tensor(125.4527, device='cuda:3')
compute norm is  tensor(49.9518, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.0784, device='cuda:3')
compute distance is  tensor(116.0784, device='cuda:3')
compute norm is  tensor(49.7677, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(131.8315, device='cuda:3')
distance x is tensor(106162.0859, device='cuda:3')
distance x is tensor(106162.0859, device='cuda:3')
________________________________
test distance is  tensor(106162.0859, device='cuda:3')
test distance1 is  tensor(106162.0859, device='cuda:3')
test similarity is  tensor(0.1180, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139288480363832.22
test entropy is  0.0
________________________________
cal ratio is  0.03453432498201012
distance x is tensor(3666.2407, device='cuda:3')
cal_distance is  tensor(3666.2407, device='cuda:3')
cal ratio is  0.18583401462074736
distance x is tensor(681.3163, device='cuda:3')
cal_distance is  tensor(681.3163, device='cuda:3')
cal ratio is  0.4310833902832152
distance x is tensor(293.7069, device='cuda:3')
cal_distance is  tensor(293.7069, device='cuda:3')
cal ratio is  0.6565663350940597
distance x is tensor(192.8398, device='cuda:3')
cal_distance is  tensor(192.8398, device='cuda:3')
cal ratio is  0.8102841937015955
distance x is tensor(156.2560, device='cuda:3')
cal_distance is  tensor(156.2560, device='cuda:3')
cal ratio is  0.9001551118011508
distance x is tensor(140.6551, device='cuda:3')
cal_distance is  tensor(140.6551, device='cuda:3')
cal ratio is  0.9487633931618138
distance x is tensor(133.4487, device='cuda:3')
cal_distance is  tensor(133.4487, device='cuda:3')
cal ratio is  0.9740439435423096
distance x is tensor(129.9850, device='cuda:3')
cal_distance is  tensor(129.9850, device='cuda:3')
distance x is tensor(129.9850, device='cuda:3')
return_distance is  tensor(129.9850, device='cuda:3')
distance x is tensor(129.9752, device='cuda:3')
distance x is tensor(129.9752, device='cuda:3')
________________________________
test distance is  tensor(129.9752, device='cuda:3')
test distance1 is  tensor(129.9752, device='cuda:3')
test similarity is  tensor(0.9596, device='cuda:3')
test acc is  0.10000000015633198
test loss is 172.2937584330024
test entropy is  2.8451961614689558e-21
________________________________
0
distance x is tensor(129.9752, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.7893229610597353e-21
avg test loss is  172.33065747096342
avg accuracy is  0.6995666668229974
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9596, device='cuda:3')
compute_distance is  tensor(129.9752, device='cuda:3')
compute_norm is  tensor(50.7819, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(123.1960, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8745955714920183
avg test loss is  1.3246839899244085
avg accuracy is  0.8707666668229891
solo acc is  0.3028500001563396
compute similarity  is  tensor(0.9617, device='cuda:3')
compute_distance is  tensor(123.1960, device='cuda:3')
compute_norm is  tensor(50.4569, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(123.8210, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8220505289939929
avg test loss is  1.3694505837680435
avg accuracy is  0.877066666822989
solo acc is  0.24273333348967133
compute similarity  is  tensor(0.9614, device='cuda:3')
compute_distance is  tensor(123.8210, device='cuda:3')
compute_norm is  tensor(50.1905, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(124.4698, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7998104160909714
avg test loss is  1.3430745206407901
avg accuracy is  0.8812833334896554
solo acc is  0.2430833334896714
compute similarity  is  tensor(0.9612, device='cuda:3')
compute_distance is  tensor(124.4698, device='cuda:3')
compute_norm is  tensor(49.9277, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(125.1744, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7885538871481474
avg test loss is  1.3161509805905032
avg accuracy is  0.8816166668229887
solo acc is  0.23816666682300452
compute similarity  is  tensor(0.9610, device='cuda:3')
compute_distance is  tensor(125.1744, device='cuda:3')
compute_norm is  tensor(49.6676, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(125.9553, device='cuda:3')
distance x is tensor(125.9553, device='cuda:3')
________________________________
test distance is  tensor(125.9553, device='cuda:3')
test distance1 is  tensor(125.9553, device='cuda:3')
test similarity is  tensor(0.9608, device='cuda:3')
test acc is  0.23620000015633777
test loss is 1.2928473727662426
test entropy is  0.7880386300305567
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2426092624664307
mal norm is  tensor(627.6457, device='cuda:3')
distance x is tensor(125.9631, device='cuda:3')
mal distance is  tensor(125.9631, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([27., 27., 27., 27., 27., 27., 27., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 27., 27., 27., 27., 27., 27., 27.])
count_res tensor([6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 90.58% 

Test Accuracy: 89.51% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2415096014738083
distance x is tensor(66.5313, device='cuda:3')
benign distance is  tensor(66.5313, device='cuda:3')
norm1 res is  tensor(291.1552, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5904017686843872
distance x is tensor(79.3173, device='cuda:3')
benign distance is  tensor(79.3173, device='cuda:3')
norm1 res is  tensor(345.2353, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.35118889808654785
distance x is tensor(103.7795, device='cuda:3')
benign distance is  tensor(103.7795, device='cuda:3')
norm1 res is  tensor(440.8833, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.25196513533592224
distance x is tensor(97.1397, device='cuda:3')
benign distance is  tensor(97.1397, device='cuda:3')
norm1 res is  tensor(415.7605, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7171375155448914
distance x is tensor(71.8468, device='cuda:3')
benign distance is  tensor(71.8468, device='cuda:3')
norm1 res is  tensor(305.7809, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6016904711723328
distance x is tensor(106.5352, device='cuda:3')
benign distance is  tensor(106.5352, device='cuda:3')
norm1 res is  tensor(469.3567, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.38235849142074585
distance x is tensor(69.2027, device='cuda:3')
benign distance is  tensor(69.2027, device='cuda:3')
norm1 res is  tensor(295.3110, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.19192083179950714
distance x is tensor(82.2864, device='cuda:3')
benign distance is  tensor(82.2864, device='cuda:3')
norm1 res is  tensor(365.1998, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.6361756920814514
distance x is tensor(122.4185, device='cuda:3')
benign distance is  tensor(122.4185, device='cuda:3')
norm1 res is  tensor(544.2187, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5321260690689087
distance x is tensor(115.0322, device='cuda:3')
benign distance is  tensor(115.0322, device='cuda:3')
norm1 res is  tensor(512.2751, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5396876335144043
distance x is tensor(115.7394, device='cuda:3')
benign distance is  tensor(115.7394, device='cuda:3')
norm1 res is  tensor(488.2015, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.22775094211101532
distance x is tensor(102.5277, device='cuda:3')
benign distance is  tensor(102.5277, device='cuda:3')
norm1 res is  tensor(453.3667, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3478899598121643
distance x is tensor(107.5681, device='cuda:3')
benign distance is  tensor(107.5681, device='cuda:3')
norm1 res is  tensor(472.5218, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.21431536972522736
distance x is tensor(101.1300, device='cuda:3')
benign distance is  tensor(101.1300, device='cuda:3')
norm1 res is  tensor(430.2388, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.48047012090682983
distance x is tensor(122.8743, device='cuda:3')
benign distance is  tensor(122.8743, device='cuda:3')
norm1 res is  tensor(540.9468, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4955938458442688
distance x is tensor(117.7859, device='cuda:3')
benign distance is  tensor(117.7859, device='cuda:3')
norm1 res is  tensor(513.3056, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(107.1723, device='cuda:3')
compute distance is  tensor(107.1723, device='cuda:3')
compute norm is  tensor(49.6747, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.0763, device='cuda:3')
compute distance is  tensor(104.0763, device='cuda:3')
compute norm is  tensor(49.8012, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.5161, device='cuda:3')
compute distance is  tensor(118.5161, device='cuda:3')
compute norm is  tensor(50.0106, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.3513, device='cuda:3')
compute distance is  tensor(114.3513, device='cuda:3')
compute norm is  tensor(49.8533, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.0578, device='cuda:3')
compute distance is  tensor(104.0578, device='cuda:3')
compute norm is  tensor(49.7086, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.5015, device='cuda:3')
compute distance is  tensor(102.5015, device='cuda:3')
compute norm is  tensor(49.7624, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.2044, device='cuda:3')
compute distance is  tensor(111.2044, device='cuda:3')
compute norm is  tensor(49.8655, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.2496, device='cuda:3')
compute distance is  tensor(114.2496, device='cuda:3')
compute norm is  tensor(49.8638, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.1387, device='cuda:3')
compute distance is  tensor(118.1387, device='cuda:3')
compute norm is  tensor(49.9620, device='cuda:3', dtype=torch.float64)
distance x is tensor(95.0317, device='cuda:3')
compute distance is  tensor(95.0317, device='cuda:3')
compute norm is  tensor(49.5935, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.7599, device='cuda:3')
compute distance is  tensor(121.7599, device='cuda:3')
compute norm is  tensor(50.0887, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.7997, device='cuda:3')
compute distance is  tensor(133.7997, device='cuda:3')
compute norm is  tensor(50.2362, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(133.7997, device='cuda:3')
distance x is tensor(106173.9766, device='cuda:3')
distance x is tensor(106173.9766, device='cuda:3')
________________________________
test distance is  tensor(106173.9766, device='cuda:3')
test distance1 is  tensor(106173.9766, device='cuda:3')
test similarity is  tensor(0.0722, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139289236393835.53
test entropy is  0.0
________________________________
cal ratio is  0.03478921412510514
distance x is tensor(3693.7148, device='cuda:3')
cal_distance is  tensor(3693.7148, device='cuda:3')
cal ratio is  0.1865185278720707
distance x is tensor(688.9503, device='cuda:3')
cal_distance is  tensor(688.9503, device='cuda:3')
cal ratio is  0.431876655249729
distance x is tensor(297.5443, device='cuda:3')
cal_distance is  tensor(297.5443, device='cuda:3')
cal ratio is  0.6571701352432389
distance x is tensor(195.5390, device='cuda:3')
cal_distance is  tensor(195.5390, device='cuda:3')
cal ratio is  0.8106567719673542
distance x is tensor(158.5160, device='cuda:3')
cal_distance is  tensor(158.5160, device='cuda:3')
cal ratio is  0.9003620223063743
distance x is tensor(142.7222, device='cuda:3')
cal_distance is  tensor(142.7222, device='cuda:3')
cal ratio is  0.9488725039962245
distance x is tensor(135.4255, device='cuda:3')
cal_distance is  tensor(135.4255, device='cuda:3')
cal ratio is  0.9740999201029424
distance x is tensor(131.9181, device='cuda:3')
cal_distance is  tensor(131.9181, device='cuda:3')
distance x is tensor(131.9181, device='cuda:3')
return_distance is  tensor(131.9181, device='cuda:3')
distance x is tensor(131.9082, device='cuda:3')
distance x is tensor(131.9082, device='cuda:3')
________________________________
test distance is  tensor(131.9082, device='cuda:3')
test distance1 is  tensor(131.9082, device='cuda:3')
test similarity is  tensor(0.9571, device='cuda:3')
test acc is  0.10000000015633198
test loss is 207.68566544782885
test entropy is  9.312227977591389e-22
________________________________
0
distance x is tensor(131.9082, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.2871863893108172e-21
avg test loss is  207.70650197498833
avg accuracy is  0.6368833334896681
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9571, device='cuda:3')
compute_distance is  tensor(131.9082, device='cuda:3')
compute_norm is  tensor(50.6156, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(128.0425, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8871902061550856
avg test loss is  1.3541427723634472
avg accuracy is  0.8673500001563225
solo acc is  0.308133333489673
compute similarity  is  tensor(0.9592, device='cuda:3')
compute_distance is  tensor(128.0425, device='cuda:3')
compute_norm is  tensor(50.2994, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(128.9512, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8362149171102276
avg test loss is  1.4064248309714962
avg accuracy is  0.870566666822989
solo acc is  0.24448333348967138
compute similarity  is  tensor(0.9588, device='cuda:3')
compute_distance is  tensor(128.9512, device='cuda:3')
compute_norm is  tensor(50.0274, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(129.7316, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8174793236672497
avg test loss is  1.379011956740544
avg accuracy is  0.8747333334896555
solo acc is  0.23468333348967105
compute similarity  is  tensor(0.9586, device='cuda:3')
compute_distance is  tensor(129.7316, device='cuda:3')
compute_norm is  tensor(49.7643, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(130.5582, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8113639725805092
avg test loss is  1.3468202463091055
avg accuracy is  0.8786666668229888
solo acc is  0.2331166668230044
compute similarity  is  tensor(0.9583, device='cuda:3')
compute_distance is  tensor(130.5582, device='cuda:3')
compute_norm is  tensor(49.5069, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(131.3715, device='cuda:3')
distance x is tensor(131.3715, device='cuda:3')
________________________________
test distance is  tensor(131.3715, device='cuda:3')
test distance1 is  tensor(131.3715, device='cuda:3')
test similarity is  tensor(0.9581, device='cuda:3')
test acc is  0.2441166668230047
test loss is 1.309330749804023
test entropy is  0.8073846760080822
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.1500369310379028
mal norm is  tensor(642.2916, device='cuda:3')
distance x is tensor(131.3784, device='cuda:3')
mal distance is  tensor(131.3784, device='cuda:3')
user_PLR len size 44
counter_tensor is  tensor([43., 43., 43., 43., 43., 43., 43., 43., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 43., 43., 43., 43., 43., 43., 43., 43.,
        43., 43., 43., 43., 43., 43., 43., 43., 43., 43., 43., 43., 43., 43.,
        43., 43.])
count_res tensor([3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02, 5.2192e-07, 5.2192e-07, 5.2192e-07, 5.2192e-07,
        5.2192e-07, 5.2192e-07, 5.2192e-07, 5.2192e-07, 5.2192e-07, 5.2192e-07,
        5.2192e-07, 5.2192e-07, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 90.63% 

Test Accuracy: 89.55% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.10862799733877182
distance x is tensor(67.5430, device='cuda:3')
benign distance is  tensor(67.5430, device='cuda:3')
norm1 res is  tensor(301.9456, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6848841905593872
distance x is tensor(93.8164, device='cuda:3')
benign distance is  tensor(93.8164, device='cuda:3')
norm1 res is  tensor(415.3044, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.16792376339435577
distance x is tensor(89.2310, device='cuda:3')
benign distance is  tensor(89.2310, device='cuda:3')
norm1 res is  tensor(380.0681, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.31765860319137573
distance x is tensor(76.0325, device='cuda:3')
benign distance is  tensor(76.0325, device='cuda:3')
norm1 res is  tensor(331.8458, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4805975556373596
distance x is tensor(69.4519, device='cuda:3')
benign distance is  tensor(69.4519, device='cuda:3')
norm1 res is  tensor(302.1186, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6426286101341248
distance x is tensor(88.2854, device='cuda:3')
benign distance is  tensor(88.2854, device='cuda:3')
norm1 res is  tensor(393.3411, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.31818294525146484
distance x is tensor(84.6898, device='cuda:3')
benign distance is  tensor(84.6898, device='cuda:3')
norm1 res is  tensor(357.0618, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8569401502609253
distance x is tensor(111.0744, device='cuda:3')
benign distance is  tensor(111.0744, device='cuda:3')
norm1 res is  tensor(476.0440, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3891123831272125
distance x is tensor(119.5119, device='cuda:3')
benign distance is  tensor(119.5119, device='cuda:3')
norm1 res is  tensor(523.4611, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4751822352409363
distance x is tensor(98.5287, device='cuda:3')
benign distance is  tensor(98.5287, device='cuda:3')
norm1 res is  tensor(432.0772, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.21517643332481384
distance x is tensor(103.5121, device='cuda:3')
benign distance is  tensor(103.5121, device='cuda:3')
norm1 res is  tensor(452.3795, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4876483380794525
distance x is tensor(105.4833, device='cuda:3')
benign distance is  tensor(105.4833, device='cuda:3')
norm1 res is  tensor(464.2977, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6283079385757446
distance x is tensor(116.7569, device='cuda:3')
benign distance is  tensor(116.7569, device='cuda:3')
norm1 res is  tensor(505.5410, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.18253758549690247
distance x is tensor(103.4198, device='cuda:3')
benign distance is  tensor(103.4198, device='cuda:3')
norm1 res is  tensor(457.5836, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2982500195503235
distance x is tensor(106.7783, device='cuda:3')
benign distance is  tensor(106.7783, device='cuda:3')
norm1 res is  tensor(462.1988, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.49337825179100037
distance x is tensor(101.4195, device='cuda:3')
benign distance is  tensor(101.4195, device='cuda:3')
norm1 res is  tensor(441.8858, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.22791524231433868
distance x is tensor(112.4021, device='cuda:3')
benign distance is  tensor(112.4021, device='cuda:3')
norm1 res is  tensor(492.1490, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6797617673873901
distance x is tensor(104.9973, device='cuda:3')
benign distance is  tensor(104.9973, device='cuda:3')
norm1 res is  tensor(452.9419, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.564757227897644
distance x is tensor(117.8744, device='cuda:3')
benign distance is  tensor(117.8744, device='cuda:3')
norm1 res is  tensor(515.3818, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5763663053512573
distance x is tensor(101.7481, device='cuda:3')
benign distance is  tensor(101.7481, device='cuda:3')
norm1 res is  tensor(440.6641, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7367485761642456
distance x is tensor(99.7957, device='cuda:3')
benign distance is  tensor(99.7957, device='cuda:3')
norm1 res is  tensor(438.0093, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.14195340871810913
distance x is tensor(120.6848, device='cuda:3')
benign distance is  tensor(120.6848, device='cuda:3')
norm1 res is  tensor(537.6939, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5704809427261353
distance x is tensor(108.0883, device='cuda:3')
benign distance is  tensor(108.0883, device='cuda:3')
norm1 res is  tensor(495.3906, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.13431791961193085
distance x is tensor(111.7421, device='cuda:3')
benign distance is  tensor(111.7421, device='cuda:3')
norm1 res is  tensor(491.0199, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.23934996128082275
distance x is tensor(138.3905, device='cuda:3')
benign distance is  tensor(138.3905, device='cuda:3')
norm1 res is  tensor(602.1837, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.06805089861154556
distance x is tensor(121.4558, device='cuda:3')
benign distance is  tensor(121.4558, device='cuda:3')
norm1 res is  tensor(531.3571, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.18816643953323364
distance x is tensor(116.6728, device='cuda:3')
benign distance is  tensor(116.6728, device='cuda:3')
norm1 res is  tensor(503.7381, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.22615385055541992
distance x is tensor(115.7589, device='cuda:3')
benign distance is  tensor(115.7589, device='cuda:3')
norm1 res is  tensor(508.8956, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.36251768469810486
distance x is tensor(122.0461, device='cuda:3')
benign distance is  tensor(122.0461, device='cuda:3')
norm1 res is  tensor(527.9119, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.6972091794013977
distance x is tensor(116.0499, device='cuda:3')
benign distance is  tensor(116.0499, device='cuda:3')
norm1 res is  tensor(504.9678, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.3228438198566437
distance x is tensor(110.1089, device='cuda:3')
benign distance is  tensor(110.1089, device='cuda:3')
norm1 res is  tensor(476.7027, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.2604190409183502
distance x is tensor(107.8457, device='cuda:3')
benign distance is  tensor(107.8457, device='cuda:3')
norm1 res is  tensor(455.7482, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(117.9664, device='cuda:3')
compute distance is  tensor(117.9664, device='cuda:3')
compute norm is  tensor(49.7343, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.0434, device='cuda:3')
compute distance is  tensor(102.0434, device='cuda:3')
compute norm is  tensor(49.6172, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.1506, device='cuda:3')
compute distance is  tensor(116.1506, device='cuda:3')
compute norm is  tensor(49.9832, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.3351, device='cuda:3')
compute distance is  tensor(101.3351, device='cuda:3')
compute norm is  tensor(49.5829, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.0505, device='cuda:3')
compute distance is  tensor(105.0505, device='cuda:3')
compute norm is  tensor(49.6626, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.3527, device='cuda:3')
compute distance is  tensor(108.3527, device='cuda:3')
compute norm is  tensor(49.8271, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.3940, device='cuda:3')
compute distance is  tensor(106.3940, device='cuda:3')
compute norm is  tensor(49.8447, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.7592, device='cuda:3')
compute distance is  tensor(109.7592, device='cuda:3')
compute norm is  tensor(49.6927, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.2736, device='cuda:3')
compute distance is  tensor(120.2736, device='cuda:3')
compute norm is  tensor(49.8797, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.7958, device='cuda:3')
compute distance is  tensor(107.7958, device='cuda:3')
compute norm is  tensor(49.7852, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.0098, device='cuda:3')
compute distance is  tensor(125.0098, device='cuda:3')
compute norm is  tensor(50.0107, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.5428, device='cuda:3')
compute distance is  tensor(121.5428, device='cuda:3')
compute norm is  tensor(49.9678, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(125.0098, device='cuda:3')
distance x is tensor(106177.7422, device='cuda:3')
distance x is tensor(106177.7422, device='cuda:3')
________________________________
test distance is  tensor(106177.7422, device='cuda:3')
test distance1 is  tensor(106177.7422, device='cuda:3')
test similarity is  tensor(0.0606, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139271034133986.53
test entropy is  0.0
________________________________
cal ratio is  0.03362647882289237
distance x is tensor(3570.3887, device='cuda:3')
cal_distance is  tensor(3570.3887, device='cuda:3')
cal ratio is  0.18337511524113606
distance x is tensor(654.7246, device='cuda:3')
cal_distance is  tensor(654.7246, device='cuda:3')
cal ratio is  0.4282218254751152
distance x is tensor(280.3702, device='cuda:3')
cal_distance is  tensor(280.3702, device='cuda:3')
cal ratio is  0.6543833265348659
distance x is tensor(183.4713, device='cuda:3')
cal_distance is  tensor(183.4713, device='cuda:3')
cal ratio is  0.8089359006850431
distance x is tensor(148.4174, device='cuda:3')
cal_distance is  tensor(148.4174, device='cuda:3')
cal ratio is  0.8994057919265929
distance x is tensor(133.4880, device='cuda:3')
cal_distance is  tensor(133.4880, device='cuda:3')
cal ratio is  0.9483681723631842
distance x is tensor(126.5961, device='cuda:3')
cal_distance is  tensor(126.5961, device='cuda:3')
cal ratio is  0.9738409905163354
distance x is tensor(123.2846, device='cuda:3')
cal_distance is  tensor(123.2846, device='cuda:3')
distance x is tensor(123.2846, device='cuda:3')
return_distance is  tensor(123.2846, device='cuda:3')
distance x is tensor(123.2747, device='cuda:3')
distance x is tensor(123.2747, device='cuda:3')
________________________________
test distance is  tensor(123.2747, device='cuda:3')
test distance1 is  tensor(123.2747, device='cuda:3')
test similarity is  tensor(0.9617, device='cuda:3')
test acc is  0.10000000015633198
test loss is 158.83566337861996
test entropy is  3.3502354538651484e-19
________________________________
0
distance x is tensor(123.2747, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  6.859910041578063e-20
avg test loss is  158.86970480977854
avg accuracy is  0.7304833334896622
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9617, device='cuda:3')
compute_distance is  tensor(123.2747, device='cuda:3')
compute_norm is  tensor(50.2793, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(113.8460, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8236429258577351
avg test loss is  1.2313118345701872
avg accuracy is  0.8912500001563216
solo acc is  0.3620500001563407
compute similarity  is  tensor(0.9641, device='cuda:3')
compute_distance is  tensor(113.8460, device='cuda:3')
compute_norm is  tensor(49.7052, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.3608, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7931023635971013
avg test loss is  1.3008765730141068
avg accuracy is  0.8926666668229882
solo acc is  0.27683333348967226
compute similarity  is  tensor(0.9637, device='cuda:3')
compute_distance is  tensor(115.3608, device='cuda:3')
compute_norm is  tensor(49.4124, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(116.7385, device='cuda:3')
exit early
distance x is tensor(116.7385, device='cuda:3')
distance x is tensor(116.7385, device='cuda:3')
________________________________
test distance is  tensor(116.7385, device='cuda:3')
test distance1 is  tensor(116.7385, device='cuda:3')
test similarity is  tensor(0.9634, device='cuda:3')
test acc is  0.2519833334896716
test loss is 1.29835726933947
test entropy is  0.7809535471488164
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.1776076555252075
mal norm is  tensor(599.1165, device='cuda:3')
distance x is tensor(116.7456, device='cuda:3')
mal distance is  tensor(116.7456, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([19., 19., 19., 19., 19., 19., 19., 19., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0669,
        0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669,
        0.0669, 0.0669])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 79.78% 

Test Accuracy: 78.63% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.40053367614746094
distance x is tensor(143.2959, device='cuda:3')
benign distance is  tensor(143.2959, device='cuda:3')
norm1 res is  tensor(586.3895, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8447080850601196
distance x is tensor(189.2919, device='cuda:3')
benign distance is  tensor(189.2919, device='cuda:3')
norm1 res is  tensor(770.5314, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2624113857746124
distance x is tensor(141.7276, device='cuda:3')
benign distance is  tensor(141.7276, device='cuda:3')
norm1 res is  tensor(582.9410, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6665035486221313
distance x is tensor(143.2734, device='cuda:3')
benign distance is  tensor(143.2734, device='cuda:3')
norm1 res is  tensor(586.1060, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6843780279159546
distance x is tensor(128.6810, device='cuda:3')
benign distance is  tensor(128.6810, device='cuda:3')
norm1 res is  tensor(522.4525, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2037432193756104
distance x is tensor(164.0501, device='cuda:3')
benign distance is  tensor(164.0501, device='cuda:3')
norm1 res is  tensor(670.1071, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7130202651023865
distance x is tensor(142.0571, device='cuda:3')
benign distance is  tensor(142.0571, device='cuda:3')
norm1 res is  tensor(580.4045, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.774559497833252
distance x is tensor(143.9797, device='cuda:3')
benign distance is  tensor(143.9797, device='cuda:3')
norm1 res is  tensor(589.7778, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(150.4513, device='cuda:3')
compute distance is  tensor(150.4513, device='cuda:3')
compute norm is  tensor(50.7542, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.5285, device='cuda:3')
compute distance is  tensor(142.5285, device='cuda:3')
compute norm is  tensor(50.7439, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.1629, device='cuda:3')
compute distance is  tensor(160.1629, device='cuda:3')
compute norm is  tensor(51.0460, device='cuda:3', dtype=torch.float64)
distance x is tensor(176.8609, device='cuda:3')
compute distance is  tensor(176.8609, device='cuda:3')
compute norm is  tensor(51.4613, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.5422, device='cuda:3')
compute distance is  tensor(161.5422, device='cuda:3')
compute norm is  tensor(50.9636, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.0390, device='cuda:3')
compute distance is  tensor(152.0390, device='cuda:3')
compute norm is  tensor(50.8091, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.8234, device='cuda:3')
compute distance is  tensor(157.8234, device='cuda:3')
compute norm is  tensor(50.9294, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.9451, device='cuda:3')
compute distance is  tensor(153.9451, device='cuda:3')
compute norm is  tensor(50.8844, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.0649, device='cuda:3')
compute distance is  tensor(164.0649, device='cuda:3')
compute norm is  tensor(51.1046, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.4838, device='cuda:3')
compute distance is  tensor(146.4838, device='cuda:3')
compute norm is  tensor(50.7783, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.0459, device='cuda:3')
compute distance is  tensor(154.0459, device='cuda:3')
compute norm is  tensor(50.9462, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.8255, device='cuda:3')
compute distance is  tensor(140.8255, device='cuda:3')
compute norm is  tensor(50.6418, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(176.8609, device='cuda:3')
distance x is tensor(106115.2109, device='cuda:3')
distance x is tensor(106115.2109, device='cuda:3')
________________________________
test distance is  tensor(106115.2109, device='cuda:3')
test distance1 is  tensor(106115.2109, device='cuda:3')
test similarity is  tensor(0.2522, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139276805871899.84
test entropy is  0.0
________________________________
cal ratio is  0.040008577472199235
distance x is tensor(4245.5239, device='cuda:3')
cal_distance is  tensor(4245.5239, device='cuda:3')
cal ratio is  0.20002131995172476
distance x is tensor(849.1993, device='cuda:3')
cal_distance is  tensor(849.1993, device='cuda:3')
cal ratio is  0.44723638990381676
distance x is tensor(379.7956, device='cuda:3')
cal_distance is  tensor(379.7956, device='cuda:3')
cal ratio is  0.6687549254066695
distance x is tensor(253.9918, device='cuda:3')
cal_distance is  tensor(253.9918, device='cuda:3')
cal ratio is  0.8177717231493815
distance x is tensor(207.7082, device='cuda:3')
cal_distance is  tensor(207.7082, device='cuda:3')
cal ratio is  0.9043053748371921
distance x is tensor(187.8321, device='cuda:3')
cal_distance is  tensor(187.8321, device='cuda:3')
cal ratio is  0.9509484984369536
distance x is tensor(178.6190, device='cuda:3')
cal_distance is  tensor(178.6190, device='cuda:3')
cal ratio is  0.9751651242865026
distance x is tensor(174.1831, device='cuda:3')
cal_distance is  tensor(174.1831, device='cuda:3')
distance x is tensor(174.1831, device='cuda:3')
return_distance is  tensor(174.1831, device='cuda:3')
distance x is tensor(174.1732, device='cuda:3')
distance x is tensor(174.1732, device='cuda:3')
________________________________
test distance is  tensor(174.1732, device='cuda:3')
test distance1 is  tensor(174.1732, device='cuda:3')
test similarity is  tensor(0.9426, device='cuda:3')
test acc is  0.10000000015633198
test loss is 672.1053943105344
test entropy is  0.0
________________________________
0
distance x is tensor(174.1732, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  672.1235469988923
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9426, device='cuda:3')
compute_distance is  tensor(174.1732, device='cuda:3')
compute_norm is  tensor(53.7981, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2230.8843, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.6326246814432936
avg test loss is  2.853951814332242
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2795, device='cuda:3')
compute_distance is  tensor(2230.8843, device='cuda:3')
compute_norm is  tensor(168.2157, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2220.8184, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.851972222328186
avg test loss is  3.658988936369353
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2796, device='cuda:3')
compute_distance is  tensor(2220.8184, device='cuda:3')
compute_norm is  tensor(167.6810, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2210.4944, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5673347580661652
avg test loss is  2.8417568923567913
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2795, device='cuda:3')
compute_distance is  tensor(2210.4944, device='cuda:3')
compute_norm is  tensor(166.7694, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2200.5469, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8326605558395386
avg test loss is  3.5993753122622523
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2796, device='cuda:3')
compute_distance is  tensor(2200.5469, device='cuda:3')
compute_norm is  tensor(166.2310, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2190.1816, device='cuda:3')
distance x is tensor(2190.1816, device='cuda:3')
________________________________
test distance is  tensor(2190.1816, device='cuda:3')
test distance1 is  tensor(2190.1816, device='cuda:3')
test similarity is  tensor(0.2795, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8521108523106524
test entropy is  1.5534028067771815
________________________________
cal ratio is  0.27848504532859253
distance x is tensor(609.9333, device='cuda:3')
cal_distance is  tensor(609.9333, device='cuda:3')
cal ratio is  0.5277165847704987
distance x is tensor(321.8721, device='cuda:3')
cal_distance is  tensor(321.8721, device='cuda:3')
cal ratio is  0.7264408570873123
distance x is tensor(233.8212, device='cuda:3')
cal_distance is  tensor(233.8212, device='cuda:3')
cal ratio is  0.8523147785077707
distance x is tensor(199.2893, device='cuda:3')
cal_distance is  tensor(199.2893, device='cuda:3')
cal ratio is  0.9232088774048081
distance x is tensor(183.9857, device='cuda:3')
cal_distance is  tensor(183.9857, device='cuda:3')
cal ratio is  0.9608374805159672
distance x is tensor(176.7803, device='cuda:3')
cal_distance is  tensor(176.7803, device='cuda:3')
distance x is tensor(176.7803, device='cuda:3')
return_distance is  tensor(176.7803, device='cuda:3')
distance x is tensor(176.7797, device='cuda:3')
distance x is tensor(176.7797, device='cuda:3')
________________________________
test distance is  tensor(176.7797, device='cuda:3')
test distance1 is  tensor(176.7797, device='cuda:3')
test similarity is  tensor(0.9550, device='cuda:3')
test acc is  0.17930000015633532
test loss is 2.2711834441115863
test entropy is  1.3785233835675823
________________________________
0
distance x is tensor(176.7797, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3775353565144894
avg test loss is  2.2677507673753605
avg accuracy is  0.23991666682300458
solo acc is  0.18005000015633532
compute similarity  is  tensor(0.9550, device='cuda:3')
compute_distance is  tensor(176.7797, device='cuda:3')
compute_norm is  tensor(51.9252, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(178.4576, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.5402255155829224
avg test loss is  2.477304883094739
avg accuracy is  0.1600666668230007
solo acc is  0.10240000015633197
compute similarity  is  tensor(0.9552, device='cuda:3')
compute_distance is  tensor(178.4576, device='cuda:3')
compute_norm is  tensor(51.6732, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(180.8690, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8924356504544012
avg test loss is  1.3407575907483538
avg accuracy is  0.3633500001563406
solo acc is  0.27621666682300566
compute similarity  is  tensor(0.9552, device='cuda:3')
compute_distance is  tensor(180.8690, device='cuda:3')
compute_norm is  tensor(51.4039, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(180.8690, device='cuda:3')
distance x is tensor(180.8690, device='cuda:3')
________________________________
test distance is  tensor(180.8690, device='cuda:3')
test distance1 is  tensor(180.8690, device='cuda:3')
test similarity is  tensor(0.9552, device='cuda:3')
test acc is  0.27408333348967234
test loss is 1.3426249242667705
test entropy is  0.892132113228983
________________________________
cal ratio is  0.9690805944988
distance x is tensor(175.2758, device='cuda:3')
cal_distance is  tensor(175.2758, device='cuda:3')
distance x is tensor(175.2758, device='cuda:3')
return_distance is  tensor(175.2758, device='cuda:3')
distance x is tensor(175.2766, device='cuda:3')
distance x is tensor(175.2766, device='cuda:3')
________________________________
test distance is  tensor(175.2766, device='cuda:3')
test distance1 is  tensor(175.2766, device='cuda:3')
test similarity is  tensor(0.9578, device='cuda:3')
test acc is  0.27930000015633905
test loss is 1.335189199650974
test entropy is  0.8944580537805171
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.2835103273391724
mal norm is  tensor(664.6514, device='cuda:3')
distance x is tensor(175.2758, device='cuda:3')
mal distance is  tensor(175.2758, device='cuda:3')
user_PLR len size 44
counter_tensor is  tensor([43., 43., 43., 43., 43., 43., 43., 43., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 43., 43., 43., 43., 43., 43., 43., 43.,
        43., 43., 43., 43., 43., 43., 43., 43., 43., 43., 43., 43., 43., 43.,
        43., 43.])
count_res tensor([3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02, 5.2192e-07, 5.2192e-07, 5.2192e-07, 5.2192e-07,
        5.2192e-07, 5.2192e-07, 5.2192e-07, 5.2192e-07, 5.2192e-07, 5.2192e-07,
        5.2192e-07, 5.2192e-07, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02, 3.1250e-02,
        3.1250e-02, 3.1250e-02])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 90.57% 

Test Accuracy: 89.68% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7942935228347778
distance x is tensor(63.4796, device='cuda:3')
benign distance is  tensor(63.4796, device='cuda:3')
norm1 res is  tensor(280.6076, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.42156997323036194
distance x is tensor(90.6444, device='cuda:3')
benign distance is  tensor(90.6444, device='cuda:3')
norm1 res is  tensor(393.7470, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.28160911798477173
distance x is tensor(89.1838, device='cuda:3')
benign distance is  tensor(89.1838, device='cuda:3')
norm1 res is  tensor(375.4510, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2861379086971283
distance x is tensor(80.5563, device='cuda:3')
benign distance is  tensor(80.5563, device='cuda:3')
norm1 res is  tensor(351.1454, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3091195225715637
distance x is tensor(92.1426, device='cuda:3')
benign distance is  tensor(92.1426, device='cuda:3')
norm1 res is  tensor(386.2468, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0006603002548218
distance x is tensor(88.2364, device='cuda:3')
benign distance is  tensor(88.2364, device='cuda:3')
norm1 res is  tensor(382.0774, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5749346613883972
distance x is tensor(70.2167, device='cuda:3')
benign distance is  tensor(70.2167, device='cuda:3')
norm1 res is  tensor(295.5740, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.10057178884744644
distance x is tensor(79.2326, device='cuda:3')
benign distance is  tensor(79.2326, device='cuda:3')
norm1 res is  tensor(355.8518, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.29590803384780884
distance x is tensor(103.8894, device='cuda:3')
benign distance is  tensor(103.8894, device='cuda:3')
norm1 res is  tensor(450.2950, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9597676992416382
distance x is tensor(110.7129, device='cuda:3')
benign distance is  tensor(110.7129, device='cuda:3')
norm1 res is  tensor(481.6637, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5197704434394836
distance x is tensor(106.2230, device='cuda:3')
benign distance is  tensor(106.2230, device='cuda:3')
norm1 res is  tensor(461.6305, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.018447995185852
distance x is tensor(92.2851, device='cuda:3')
benign distance is  tensor(92.2851, device='cuda:3')
norm1 res is  tensor(398.7585, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6502271294593811
distance x is tensor(103.6037, device='cuda:3')
benign distance is  tensor(103.6037, device='cuda:3')
norm1 res is  tensor(455.8825, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.04243035241961479
distance x is tensor(107.7275, device='cuda:3')
benign distance is  tensor(107.7275, device='cuda:3')
norm1 res is  tensor(464.7672, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6304728984832764
distance x is tensor(94.8684, device='cuda:3')
benign distance is  tensor(94.8684, device='cuda:3')
norm1 res is  tensor(420.9250, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5059741735458374
distance x is tensor(100.7301, device='cuda:3')
benign distance is  tensor(100.7301, device='cuda:3')
norm1 res is  tensor(449.2118, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.5773004293441772
distance x is tensor(111.6883, device='cuda:3')
benign distance is  tensor(111.6883, device='cuda:3')
norm1 res is  tensor(491.2132, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6689838171005249
distance x is tensor(113.5264, device='cuda:3')
benign distance is  tensor(113.5264, device='cuda:3')
norm1 res is  tensor(511.1138, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2734590172767639
distance x is tensor(100.6649, device='cuda:3')
benign distance is  tensor(100.6649, device='cuda:3')
norm1 res is  tensor(435.1654, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.45044007897377014
distance x is tensor(118.6031, device='cuda:3')
benign distance is  tensor(118.6031, device='cuda:3')
norm1 res is  tensor(521.8423, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.6278544664382935
distance x is tensor(102.9104, device='cuda:3')
benign distance is  tensor(102.9104, device='cuda:3')
norm1 res is  tensor(448.9781, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8890260457992554
distance x is tensor(100.0054, device='cuda:3')
benign distance is  tensor(100.0054, device='cuda:3')
norm1 res is  tensor(430.3997, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.19883115589618683
distance x is tensor(113.1149, device='cuda:3')
benign distance is  tensor(113.1149, device='cuda:3')
norm1 res is  tensor(495.5501, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.526394248008728
distance x is tensor(112.5039, device='cuda:3')
benign distance is  tensor(112.5039, device='cuda:3')
norm1 res is  tensor(481.8841, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.1275331676006317
distance x is tensor(109.8465, device='cuda:3')
benign distance is  tensor(109.8465, device='cuda:3')
norm1 res is  tensor(475.3052, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.8261243104934692
distance x is tensor(114.0860, device='cuda:3')
benign distance is  tensor(114.0860, device='cuda:3')
norm1 res is  tensor(499.9248, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.07153304666280746
distance x is tensor(109.9994, device='cuda:3')
benign distance is  tensor(109.9994, device='cuda:3')
norm1 res is  tensor(479.5141, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.08525484055280685
distance x is tensor(110.9104, device='cuda:3')
benign distance is  tensor(110.9104, device='cuda:3')
norm1 res is  tensor(495.0647, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.11485439538955688
distance x is tensor(123.9365, device='cuda:3')
benign distance is  tensor(123.9365, device='cuda:3')
norm1 res is  tensor(546.8949, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.3977859616279602
distance x is tensor(120.3874, device='cuda:3')
benign distance is  tensor(120.3874, device='cuda:3')
norm1 res is  tensor(513.0720, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.1095184087753296
distance x is tensor(120.9430, device='cuda:3')
benign distance is  tensor(120.9430, device='cuda:3')
norm1 res is  tensor(515.7656, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6240636110305786
distance x is tensor(125.0550, device='cuda:3')
benign distance is  tensor(125.0550, device='cuda:3')
norm1 res is  tensor(554.1205, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(109.1078, device='cuda:3')
compute distance is  tensor(109.1078, device='cuda:3')
compute norm is  tensor(50.0312, device='cuda:3', dtype=torch.float64)
distance x is tensor(102.4903, device='cuda:3')
compute distance is  tensor(102.4903, device='cuda:3')
compute norm is  tensor(49.9686, device='cuda:3', dtype=torch.float64)
distance x is tensor(104.6844, device='cuda:3')
compute distance is  tensor(104.6844, device='cuda:3')
compute norm is  tensor(50.0626, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.6095, device='cuda:3')
compute distance is  tensor(110.6095, device='cuda:3')
compute norm is  tensor(50.0729, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.6682, device='cuda:3')
compute distance is  tensor(130.6682, device='cuda:3')
compute norm is  tensor(50.4157, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.4883, device='cuda:3')
compute distance is  tensor(125.4883, device='cuda:3')
compute norm is  tensor(50.4412, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.2408, device='cuda:3')
compute distance is  tensor(107.2408, device='cuda:3')
compute norm is  tensor(50.0635, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.2644, device='cuda:3')
compute distance is  tensor(123.2644, device='cuda:3')
compute norm is  tensor(50.3835, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.0235, device='cuda:3')
compute distance is  tensor(113.0235, device='cuda:3')
compute norm is  tensor(50.1581, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.9723, device='cuda:3')
compute distance is  tensor(114.9723, device='cuda:3')
compute norm is  tensor(50.1995, device='cuda:3', dtype=torch.float64)
distance x is tensor(97.1514, device='cuda:3')
compute distance is  tensor(97.1514, device='cuda:3')
compute norm is  tensor(49.9334, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.0468, device='cuda:3')
compute distance is  tensor(106.0468, device='cuda:3')
compute norm is  tensor(49.9639, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(130.6682, device='cuda:3')
distance x is tensor(106171.8125, device='cuda:3')
distance x is tensor(106171.8125, device='cuda:3')
________________________________
test distance is  tensor(106171.8125, device='cuda:3')
test distance1 is  tensor(106171.8125, device='cuda:3')
test similarity is  tensor(0.0903, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139285400671526.75
test entropy is  0.0
________________________________
cal ratio is  0.03438003827961814
distance x is tensor(3650.1965, device='cuda:3')
cal_distance is  tensor(3650.1965, device='cuda:3')
cal ratio is  0.1854184082896878
distance x is tensor(676.8176, device='cuda:3')
cal_distance is  tensor(676.8176, device='cuda:3')
cal ratio is  0.4306011364211449
distance x is tensor(291.4412, device='cuda:3')
cal_distance is  tensor(291.4412, device='cuda:3')
cal ratio is  0.6561988900309096
distance x is tensor(191.2452, device='cuda:3')
cal_distance is  tensor(191.2452, device='cuda:3')
cal ratio is  0.8100573138134337
distance x is tensor(154.9205, device='cuda:3')
cal_distance is  tensor(154.9205, device='cuda:3')
cal ratio is  0.9000290918284277
distance x is tensor(139.4334, device='cuda:3')
cal_distance is  tensor(139.4334, device='cuda:3')
cal ratio is  0.948696931063426
distance x is tensor(132.2804, device='cuda:3')
cal_distance is  tensor(132.2804, device='cuda:3')
cal ratio is  0.9740097095722264
distance x is tensor(128.8425, device='cuda:3')
cal_distance is  tensor(128.8425, device='cuda:3')
distance x is tensor(128.8425, device='cuda:3')
return_distance is  tensor(128.8425, device='cuda:3')
distance x is tensor(128.8326, device='cuda:3')
distance x is tensor(128.8326, device='cuda:3')
________________________________
test distance is  tensor(128.8326, device='cuda:3')
test distance1 is  tensor(128.8326, device='cuda:3')
test similarity is  tensor(0.9599, device='cuda:3')
test acc is  0.10000000015633198
test loss is 159.7780805803311
test entropy is  4.25866544259223e-19
________________________________
0
distance x is tensor(128.8326, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.329200148672029e-19
avg test loss is  159.79049082351392
avg accuracy is  0.7393833334896618
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9599, device='cuda:3')
compute_distance is  tensor(128.8326, device='cuda:3')
compute_norm is  tensor(50.9552, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(119.4062, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8474603051951191
avg test loss is  1.2902921596442714
avg accuracy is  0.8847666668229885
solo acc is  0.31991666682300657
compute similarity  is  tensor(0.9625, device='cuda:3')
compute_distance is  tensor(119.4062, device='cuda:3')
compute_norm is  tensor(50.4745, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(120.4909, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7989088713106062
avg test loss is  1.3300478420277904
avg accuracy is  0.8866666668229884
solo acc is  0.26538333348967197
compute similarity  is  tensor(0.9621, device='cuda:3')
compute_distance is  tensor(120.4909, device='cuda:3')
compute_norm is  tensor(50.1996, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(121.5772, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.795149444834764
avg test loss is  1.3033198991945303
avg accuracy is  0.8876166668229885
solo acc is  0.2547833334896717
compute similarity  is  tensor(0.9619, device='cuda:3')
compute_distance is  tensor(121.5772, device='cuda:3')
compute_norm is  tensor(49.9332, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(122.6275, device='cuda:3')
exit early
distance x is tensor(122.6275, device='cuda:3')
distance x is tensor(122.6275, device='cuda:3')
________________________________
test distance is  tensor(122.6275, device='cuda:3')
test distance1 is  tensor(122.6275, device='cuda:3')
test similarity is  tensor(0.9616, device='cuda:3')
test acc is  0.23841666682300455
test loss is 1.3041618517212776
test entropy is  0.7800164830201725
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.236956238746643
mal norm is  tensor(622.9767, device='cuda:3')
distance x is tensor(122.6352, device='cuda:3')
mal distance is  tensor(122.6352, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([19., 19., 19., 19., 19., 19., 19., 19., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0669,
        0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669,
        0.0669, 0.0669])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 79.07% 

Test Accuracy: 78.01% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1233960390090942
distance x is tensor(131.5933, device='cuda:3')
benign distance is  tensor(131.5933, device='cuda:3')
norm1 res is  tensor(552.6176, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.42497676610946655
distance x is tensor(153.4270, device='cuda:3')
benign distance is  tensor(153.4270, device='cuda:3')
norm1 res is  tensor(624.2363, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1948903501033783
distance x is tensor(142.5364, device='cuda:3')
benign distance is  tensor(142.5364, device='cuda:3')
norm1 res is  tensor(580.0750, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0437166690826416
distance x is tensor(148.3570, device='cuda:3')
benign distance is  tensor(148.3570, device='cuda:3')
norm1 res is  tensor(596.4012, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8000429272651672
distance x is tensor(154.3096, device='cuda:3')
benign distance is  tensor(154.3096, device='cuda:3')
norm1 res is  tensor(613.1837, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.8897018432617188
distance x is tensor(156.4588, device='cuda:3')
benign distance is  tensor(156.4588, device='cuda:3')
norm1 res is  tensor(643.0779, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7588802576065063
distance x is tensor(146.4797, device='cuda:3')
benign distance is  tensor(146.4797, device='cuda:3')
norm1 res is  tensor(595.2866, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5204217433929443
distance x is tensor(143.6899, device='cuda:3')
benign distance is  tensor(143.6899, device='cuda:3')
norm1 res is  tensor(579.6540, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(134.1846, device='cuda:3')
compute distance is  tensor(134.1846, device='cuda:3')
compute norm is  tensor(50.9853, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.3195, device='cuda:3')
compute distance is  tensor(143.3195, device='cuda:3')
compute norm is  tensor(50.9872, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.2343, device='cuda:3')
compute distance is  tensor(158.2343, device='cuda:3')
compute norm is  tensor(51.5246, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.9761, device='cuda:3')
compute distance is  tensor(152.9761, device='cuda:3')
compute norm is  tensor(51.3228, device='cuda:3', dtype=torch.float64)
distance x is tensor(169.9536, device='cuda:3')
compute distance is  tensor(169.9536, device='cuda:3')
compute norm is  tensor(51.6903, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.3591, device='cuda:3')
compute distance is  tensor(161.3591, device='cuda:3')
compute norm is  tensor(51.7891, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.3130, device='cuda:3')
compute distance is  tensor(156.3130, device='cuda:3')
compute norm is  tensor(51.3978, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.5009, device='cuda:3')
compute distance is  tensor(170.5009, device='cuda:3')
compute norm is  tensor(51.8950, device='cuda:3', dtype=torch.float64)
distance x is tensor(169.5041, device='cuda:3')
compute distance is  tensor(169.5041, device='cuda:3')
compute norm is  tensor(51.6585, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.8363, device='cuda:3')
compute distance is  tensor(165.8363, device='cuda:3')
compute norm is  tensor(51.6367, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.5763, device='cuda:3')
compute distance is  tensor(158.5763, device='cuda:3')
compute norm is  tensor(51.5193, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.9723, device='cuda:3')
compute distance is  tensor(159.9723, device='cuda:3')
compute norm is  tensor(51.5942, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(170.5009, device='cuda:3')
distance x is tensor(106103.6016, device='cuda:3')
distance x is tensor(106103.6016, device='cuda:3')
________________________________
test distance is  tensor(106103.6016, device='cuda:3')
test distance1 is  tensor(106103.6016, device='cuda:3')
test similarity is  tensor(0.2872, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139282160808678.34
test entropy is  0.0
________________________________
cal ratio is  0.0392847842776093
distance x is tensor(4168.2627, device='cuda:3')
cal_distance is  tensor(4168.2627, device='cuda:3')
cal ratio is  0.19820376256615413
distance x is tensor(826.1693, device='cuda:3')
cal_distance is  tensor(826.1693, device='cuda:3')
cal ratio is  0.4451997581515015
distance x is tensor(367.8131, device='cuda:3')
cal_distance is  tensor(367.8131, device='cuda:3')
cal ratio is  0.6672304364130974
distance x is tensor(245.4177, device='cuda:3')
cal_distance is  tensor(245.4177, device='cuda:3')
cal ratio is  0.8168389966658517
distance x is tensor(200.4677, device='cuda:3')
cal_distance is  tensor(200.4677, device='cuda:3')
cal ratio is  0.9037894116378039
distance x is tensor(181.1811, device='cuda:3')
cal_distance is  tensor(181.1811, device='cuda:3')
cal ratio is  0.950677091373881
distance x is tensor(172.2449, device='cuda:3')
cal_distance is  tensor(172.2449, device='cuda:3')
cal ratio is  0.975026048948088
distance x is tensor(167.9434, device='cuda:3')
cal_distance is  tensor(167.9434, device='cuda:3')
distance x is tensor(167.9434, device='cuda:3')
return_distance is  tensor(167.9434, device='cuda:3')
distance x is tensor(167.9336, device='cuda:3')
distance x is tensor(167.9336, device='cuda:3')
________________________________
test distance is  tensor(167.9336, device='cuda:3')
test distance1 is  tensor(167.9336, device='cuda:3')
test similarity is  tensor(0.9494, device='cuda:3')
test acc is  0.10000000015633198
test loss is 525.8643620212449
test entropy is  0.0
________________________________
0
distance x is tensor(167.9336, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  525.745725912326
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9494, device='cuda:3')
compute_distance is  tensor(167.9336, device='cuda:3')
compute_norm is  tensor(54.3135, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(190.6307, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.4972139265237332
avg test loss is  2.641205200254282
avg accuracy is  0.23858333348967123
solo acc is  0.10893333348966529
compute similarity  is  tensor(0.9411, device='cuda:3')
compute_distance is  tensor(190.6307, device='cuda:3')
compute_norm is  tensor(56.2030, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(191.2959, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8205186626168964
avg test loss is  3.3288988210499157
avg accuracy is  0.19150000015633592
solo acc is  0.1003833334896653
compute similarity  is  tensor(0.9406, device='cuda:3')
compute_distance is  tensor(191.2959, device='cuda:3')
compute_norm is  tensor(56.2355, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(192.3924, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.3466797746829133
avg test loss is  2.303437623006703
avg accuracy is  0.24665000015633817
solo acc is  0.12295000015633192
compute similarity  is  tensor(0.9412, device='cuda:3')
compute_distance is  tensor(192.3924, device='cuda:3')
compute_norm is  tensor(55.8252, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(192.8541, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7694905268739282
avg test loss is  3.027886125578809
avg accuracy is  0.18956666682300247
solo acc is  0.10090000015633196
compute similarity  is  tensor(0.9408, device='cuda:3')
compute_distance is  tensor(192.8541, device='cuda:3')
compute_norm is  tensor(55.8054, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(193.7110, device='cuda:3')
distance x is tensor(193.7110, device='cuda:3')
________________________________
test distance is  tensor(193.7110, device='cuda:3')
test distance1 is  tensor(193.7110, device='cuda:3')
test similarity is  tensor(0.9412, device='cuda:3')
test acc is  0.14610000015633284
test loss is 2.1015521000697412
test entropy is  1.270119811171916
________________________________
cal ratio is  0.9194164402152186
distance x is tensor(178.1076, device='cuda:3')
cal_distance is  tensor(178.1076, device='cuda:3')
cal ratio is  0.9588446613415973
distance x is tensor(170.7776, device='cuda:3')
cal_distance is  tensor(170.7776, device='cuda:3')
cal ratio is  0.9792056762689346
distance x is tensor(167.2265, device='cuda:3')
cal_distance is  tensor(167.2265, device='cuda:3')
distance x is tensor(167.2265, device='cuda:3')
return_distance is  tensor(167.2265, device='cuda:3')
distance x is tensor(167.2198, device='cuda:3')
distance x is tensor(167.2198, device='cuda:3')
________________________________
test distance is  tensor(167.2198, device='cuda:3')
test distance1 is  tensor(167.2198, device='cuda:3')
test similarity is  tensor(0.9543, device='cuda:3')
test acc is  0.1339500001563319
test loss is 2.042024806745525
test entropy is  1.4280733002274275
________________________________
0
distance x is tensor(167.2198, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.4290135861205648
avg test loss is  2.0461492237251706
avg accuracy is  0.34000000015634024
solo acc is  0.1328500001563319
compute similarity  is  tensor(0.9543, device='cuda:3')
compute_distance is  tensor(167.2198, device='cuda:3')
compute_norm is  tensor(54.2512, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(168.6710, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.748139642766798
avg test loss is  2.8539375064215426
avg accuracy is  0.2287666668230042
solo acc is  0.10200000015633197
compute similarity  is  tensor(0.9535, device='cuda:3')
compute_distance is  tensor(168.6710, device='cuda:3')
compute_norm is  tensor(54.2558, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(170.0686, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.178217332881651
avg test loss is  1.9181222777122628
avg accuracy is  0.3148833334896732
solo acc is  0.1626333334896675
compute similarity  is  tensor(0.9538, device='cuda:3')
compute_distance is  tensor(170.0686, device='cuda:3')
compute_norm is  tensor(53.9053, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(170.9331, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6959288310902968
avg test loss is  2.6665279786469838
avg accuracy is  0.22291666682300396
solo acc is  0.10240000015633197
compute similarity  is  tensor(0.9534, device='cuda:3')
compute_distance is  tensor(170.9331, device='cuda:3')
compute_norm is  tensor(53.8065, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(171.8472, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.1012033990451269
avg test loss is  1.7737332854443775
avg accuracy is  0.3168666668230065
solo acc is  0.18551666682300227
compute similarity  is  tensor(0.9536, device='cuda:3')
compute_distance is  tensor(171.8472, device='cuda:3')
compute_norm is  tensor(53.4670, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(172.4370, device='cuda:3')
distance x is tensor(172.4370, device='cuda:3')
________________________________
test distance is  tensor(172.4370, device='cuda:3')
test distance1 is  tensor(172.4370, device='cuda:3')
test similarity is  tensor(0.9532, device='cuda:3')
test acc is  0.10291666682299863
test loss is 2.5414982134345245
test entropy is  0.6638985696886139
________________________________
cal ratio is  0.9744827958037208
distance x is tensor(168.0432, device='cuda:3')
cal_distance is  tensor(168.0432, device='cuda:3')
distance x is tensor(168.0432, device='cuda:3')
return_distance is  tensor(168.0432, device='cuda:3')
distance x is tensor(168.0368, device='cuda:3')
distance x is tensor(168.0368, device='cuda:3')
________________________________
test distance is  tensor(168.0368, device='cuda:3')
test distance1 is  tensor(168.0368, device='cuda:3')
test similarity is  tensor(0.9553, device='cuda:3')
test acc is  0.10283333348966531
test loss is 2.4839970442786146
test entropy is  0.7048447267460162
________________________________
0
distance x is tensor(168.0368, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.7059853014025861
avg test loss is  2.485712121798794
avg accuracy is  0.23380000015633776
solo acc is  0.10281666682299863
compute similarity  is  tensor(0.9553, device='cuda:3')
compute_distance is  tensor(168.0368, device='cuda:3')
compute_norm is  tensor(53.1757, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(169.0916, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0496550626846264
avg test loss is  1.655564381750916
avg accuracy is  0.34318333348967367
solo acc is  0.200516666823003
compute similarity  is  tensor(0.9553, device='cuda:3')
compute_distance is  tensor(169.0916, device='cuda:3')
compute_norm is  tensor(52.8674, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(169.7238, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6401801402253637
avg test loss is  2.4264083804606376
avg accuracy is  0.2372166668230045
solo acc is  0.10290000015633197
compute similarity  is  tensor(0.9550, device='cuda:3')
compute_distance is  tensor(169.7238, device='cuda:3')
compute_norm is  tensor(52.7191, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(170.7167, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0010845171236027
avg test loss is  1.55324266383897
avg accuracy is  0.3389666668230069
solo acc is  0.20875000015633674
compute similarity  is  tensor(0.9550, device='cuda:3')
compute_distance is  tensor(170.7167, device='cuda:3')
compute_norm is  tensor(52.4191, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(171.2585, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.612882347566995
avg test loss is  2.3486813699512847
avg accuracy is  0.23430000015633776
solo acc is  0.1023833334896653
compute similarity  is  tensor(0.9546, device='cuda:3')
compute_distance is  tensor(171.2585, device='cuda:3')
compute_norm is  tensor(52.2576, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(172.2374, device='cuda:3')
________________________________
test distance is  tensor(172.2374, device='cuda:3')
test similarity is  tensor(0.9545, device='cuda:3')
test acc is  0.3538500001563405
test loss is 1.4678444042642995
test entropy is  0.9535975939810657
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.3286417722702026
mal norm is  tensor(719.9238, device='cuda:3')
distance x is tensor(172.2374, device='cuda:3')
mal distance is  tensor(172.2374, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([35., 35., 35., 35., 35., 35., 35., 35., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 35., 35., 35., 35., 35., 35., 35., 35.,
        35., 35., 35., 35., 35., 35., 35., 35.])
count_res tensor([4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07,
        6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07,
        6.9590e-07, 6.9590e-07, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 90.56% 

Test Accuracy: 89.49% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0282593965530396
distance x is tensor(83.2449, device='cuda:3')
benign distance is  tensor(83.2449, device='cuda:3')
norm1 res is  tensor(365.1887, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5617421865463257
distance x is tensor(83.5553, device='cuda:3')
benign distance is  tensor(83.5553, device='cuda:3')
norm1 res is  tensor(363.2218, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.11162998527288437
distance x is tensor(101.3376, device='cuda:3')
benign distance is  tensor(101.3376, device='cuda:3')
norm1 res is  tensor(432.6346, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.46065250039100647
distance x is tensor(94.3157, device='cuda:3')
benign distance is  tensor(94.3157, device='cuda:3')
norm1 res is  tensor(401.7017, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4385453164577484
distance x is tensor(82.6271, device='cuda:3')
benign distance is  tensor(82.6271, device='cuda:3')
norm1 res is  tensor(345.8796, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9956324696540833
distance x is tensor(89.3514, device='cuda:3')
benign distance is  tensor(89.3514, device='cuda:3')
norm1 res is  tensor(383.6804, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3173210024833679
distance x is tensor(81.1184, device='cuda:3')
benign distance is  tensor(81.1184, device='cuda:3')
norm1 res is  tensor(341.2695, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4345802366733551
distance x is tensor(97.7296, device='cuda:3')
benign distance is  tensor(97.7296, device='cuda:3')
norm1 res is  tensor(414.5171, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4154598116874695
distance x is tensor(109.9902, device='cuda:3')
benign distance is  tensor(109.9902, device='cuda:3')
norm1 res is  tensor(477.0805, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.0227625370025635
distance x is tensor(115.0493, device='cuda:3')
benign distance is  tensor(115.0493, device='cuda:3')
norm1 res is  tensor(492.0226, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8082293272018433
distance x is tensor(103.8492, device='cuda:3')
benign distance is  tensor(103.8492, device='cuda:3')
norm1 res is  tensor(443.7764, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.2479029893875122
distance x is tensor(105.8170, device='cuda:3')
benign distance is  tensor(105.8170, device='cuda:3')
norm1 res is  tensor(454.4656, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9350417852401733
distance x is tensor(99.4526, device='cuda:3')
benign distance is  tensor(99.4526, device='cuda:3')
norm1 res is  tensor(449.4886, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4273628294467926
distance x is tensor(123.5027, device='cuda:3')
benign distance is  tensor(123.5027, device='cuda:3')
norm1 res is  tensor(536.1553, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.36914974451065063
distance x is tensor(103.6922, device='cuda:3')
benign distance is  tensor(103.6922, device='cuda:3')
norm1 res is  tensor(458.7937, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.44099393486976624
distance x is tensor(107.4663, device='cuda:3')
benign distance is  tensor(107.4663, device='cuda:3')
norm1 res is  tensor(464.7086, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3182600140571594
distance x is tensor(118.5717, device='cuda:3')
benign distance is  tensor(118.5717, device='cuda:3')
norm1 res is  tensor(505.4363, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7754303812980652
distance x is tensor(107.0254, device='cuda:3')
benign distance is  tensor(107.0254, device='cuda:3')
norm1 res is  tensor(453.8675, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.6534408926963806
distance x is tensor(110.7930, device='cuda:3')
benign distance is  tensor(110.7930, device='cuda:3')
norm1 res is  tensor(484.7845, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4597882330417633
distance x is tensor(109.9247, device='cuda:3')
benign distance is  tensor(109.9247, device='cuda:3')
norm1 res is  tensor(483.9405, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.7925093770027161
distance x is tensor(111.5491, device='cuda:3')
benign distance is  tensor(111.5491, device='cuda:3')
norm1 res is  tensor(482.1074, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6975916624069214
distance x is tensor(113.4298, device='cuda:3')
benign distance is  tensor(113.4298, device='cuda:3')
norm1 res is  tensor(497.4872, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.30648455023765564
distance x is tensor(109.5291, device='cuda:3')
benign distance is  tensor(109.5291, device='cuda:3')
norm1 res is  tensor(482.0148, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.24092845618724823
distance x is tensor(105.4331, device='cuda:3')
benign distance is  tensor(105.4331, device='cuda:3')
norm1 res is  tensor(462.4312, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(110.7642, device='cuda:3')
compute distance is  tensor(110.7642, device='cuda:3')
compute norm is  tensor(50.5025, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.0957, device='cuda:3')
compute distance is  tensor(109.0957, device='cuda:3')
compute norm is  tensor(50.5434, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.1648, device='cuda:3')
compute distance is  tensor(118.1648, device='cuda:3')
compute norm is  tensor(50.7046, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.3274, device='cuda:3')
compute distance is  tensor(129.3274, device='cuda:3')
compute norm is  tensor(50.9131, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.5946, device='cuda:3')
compute distance is  tensor(120.5946, device='cuda:3')
compute norm is  tensor(50.7315, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.1543, device='cuda:3')
compute distance is  tensor(127.1543, device='cuda:3')
compute norm is  tensor(50.8951, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.0269, device='cuda:3')
compute distance is  tensor(111.0269, device='cuda:3')
compute norm is  tensor(50.5915, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.0056, device='cuda:3')
compute distance is  tensor(118.0056, device='cuda:3')
compute norm is  tensor(50.7183, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.3911, device='cuda:3')
compute distance is  tensor(127.3911, device='cuda:3')
compute norm is  tensor(50.8655, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.6016, device='cuda:3')
compute distance is  tensor(117.6016, device='cuda:3')
compute norm is  tensor(50.7083, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.7010, device='cuda:3')
compute distance is  tensor(113.7010, device='cuda:3')
compute norm is  tensor(50.7174, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.8414, device='cuda:3')
compute distance is  tensor(114.8414, device='cuda:3')
compute norm is  tensor(50.7274, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(129.3274, device='cuda:3')
distance x is tensor(106162.5078, device='cuda:3')
distance x is tensor(106162.5078, device='cuda:3')
________________________________
test distance is  tensor(106162.5078, device='cuda:3')
test distance1 is  tensor(106162.5078, device='cuda:3')
test similarity is  tensor(0.1274, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139294140322202.47
test entropy is  0.0
________________________________
cal ratio is  0.03420469804756944
distance x is tensor(3631.2620, device='cuda:3')
cal_distance is  tensor(3631.2620, device='cuda:3')
cal ratio is  0.18494498327665296
distance x is tensor(671.5877, device='cuda:3')
cal_distance is  tensor(671.5877, device='cuda:3')
cal ratio is  0.4300510098522208
distance x is tensor(288.8198, device='cuda:3')
cal_distance is  tensor(288.8198, device='cuda:3')
cal ratio is  0.6557795642779309
distance x is tensor(189.4038, device='cuda:3')
cal_distance is  tensor(189.4038, device='cuda:3')
cal ratio is  0.8097985606876987
distance x is tensor(153.3799, device='cuda:3')
cal_distance is  tensor(153.3799, device='cuda:3')
cal ratio is  0.8998853063882066
distance x is tensor(138.0248, device='cuda:3')
cal_distance is  tensor(138.0248, device='cuda:3')
cal ratio is  0.9486211410913459
distance x is tensor(130.9335, device='cuda:3')
cal_distance is  tensor(130.9335, device='cuda:3')
cal ratio is  0.97397083125264
distance x is tensor(127.5255, device='cuda:3')
cal_distance is  tensor(127.5255, device='cuda:3')
distance x is tensor(127.5255, device='cuda:3')
return_distance is  tensor(127.5255, device='cuda:3')
distance x is tensor(127.5157, device='cuda:3')
distance x is tensor(127.5157, device='cuda:3')
________________________________
test distance is  tensor(127.5157, device='cuda:3')
test distance1 is  tensor(127.5157, device='cuda:3')
test similarity is  tensor(0.9626, device='cuda:3')
test acc is  0.10000000015633198
test loss is 132.16728678949352
test entropy is  1.8318286202639346e-15
________________________________
0
distance x is tensor(127.5157, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.1875023316142224e-16
avg test loss is  132.2497023966775
avg accuracy is  0.8171500001563246
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9626, device='cuda:3')
compute_distance is  tensor(127.5157, device='cuda:3')
compute_norm is  tensor(51.6785, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(121.4062, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8641965673930609
avg test loss is  1.2970277580625214
avg accuracy is  0.8789500001563221
solo acc is  0.3130166668230064
compute similarity  is  tensor(0.9645, device='cuda:3')
compute_distance is  tensor(121.4062, device='cuda:3')
compute_norm is  tensor(51.3268, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(122.1618, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8085943727350947
avg test loss is  1.367505675185718
avg accuracy is  0.880850000156322
solo acc is  0.24245000015633802
compute similarity  is  tensor(0.9642, device='cuda:3')
compute_distance is  tensor(122.1618, device='cuda:3')
compute_norm is  tensor(51.0521, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(122.9732, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8014922452125468
avg test loss is  1.3134077456968425
avg accuracy is  0.8853333334896551
solo acc is  0.24825000015633816
compute similarity  is  tensor(0.9640, device='cuda:3')
compute_distance is  tensor(122.9732, device='cuda:3')
compute_norm is  tensor(50.7842, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(123.7676, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7872510202276681
avg test loss is  1.307105176802129
avg accuracy is  0.8848500001563219
solo acc is  0.2362666668230045
compute similarity  is  tensor(0.9638, device='cuda:3')
compute_distance is  tensor(123.7676, device='cuda:3')
compute_norm is  tensor(50.5214, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(124.6342, device='cuda:3')
distance x is tensor(124.6342, device='cuda:3')
________________________________
test distance is  tensor(124.6342, device='cuda:3')
test distance1 is  tensor(124.6342, device='cuda:3')
test similarity is  tensor(0.9636, device='cuda:3')
test acc is  0.2346666668230044
test loss is 1.2845956187512575
test entropy is  0.78325353998111
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 1.210699200630188
mal norm is  tensor(617.2470, device='cuda:3')
distance x is tensor(124.6420, device='cuda:3')
mal distance is  tensor(124.6420, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([35., 35., 35., 35., 35., 35., 35., 35., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 35., 35., 35., 35., 35., 35., 35., 35.,
        35., 35., 35., 35., 35., 35., 35., 35.])
count_res tensor([4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07,
        6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07,
        6.9590e-07, 6.9590e-07, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 90.72% 

Test Accuracy: 89.77% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.11514909565448761
distance x is tensor(91.9099, device='cuda:3')
benign distance is  tensor(91.9099, device='cuda:3')
norm1 res is  tensor(395.8681, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6699129343032837
distance x is tensor(92.5356, device='cuda:3')
benign distance is  tensor(92.5356, device='cuda:3')
norm1 res is  tensor(408.1616, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.005815536715090275
distance x is tensor(102.8505, device='cuda:3')
benign distance is  tensor(102.8505, device='cuda:3')
norm1 res is  tensor(436.1321, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5947014093399048
distance x is tensor(95.6114, device='cuda:3')
benign distance is  tensor(95.6114, device='cuda:3')
norm1 res is  tensor(408.1215, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.24934816360473633
distance x is tensor(62.5464, device='cuda:3')
benign distance is  tensor(62.5464, device='cuda:3')
norm1 res is  tensor(271.2394, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7485673427581787
distance x is tensor(100.1736, device='cuda:3')
benign distance is  tensor(100.1736, device='cuda:3')
norm1 res is  tensor(422.7887, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.9783025979995728
distance x is tensor(83.0763, device='cuda:3')
benign distance is  tensor(83.0763, device='cuda:3')
norm1 res is  tensor(351.3354, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.07683990150690079
distance x is tensor(90.6879, device='cuda:3')
benign distance is  tensor(90.6879, device='cuda:3')
norm1 res is  tensor(393.1461, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.26989802718162537
distance x is tensor(113.0989, device='cuda:3')
benign distance is  tensor(113.0989, device='cuda:3')
norm1 res is  tensor(488.3715, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5447400808334351
distance x is tensor(124.3596, device='cuda:3')
benign distance is  tensor(124.3596, device='cuda:3')
norm1 res is  tensor(551.1372, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.3708004355430603
distance x is tensor(102.1056, device='cuda:3')
benign distance is  tensor(102.1056, device='cuda:3')
norm1 res is  tensor(451.1707, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4901607632637024
distance x is tensor(115.7595, device='cuda:3')
benign distance is  tensor(115.7595, device='cuda:3')
norm1 res is  tensor(504.9206, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.14563369750976562
distance x is tensor(111.5152, device='cuda:3')
benign distance is  tensor(111.5152, device='cuda:3')
norm1 res is  tensor(487.8607, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5957710146903992
distance x is tensor(99.7827, device='cuda:3')
benign distance is  tensor(99.7827, device='cuda:3')
norm1 res is  tensor(430.5744, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.37263888120651245
distance x is tensor(110.8065, device='cuda:3')
benign distance is  tensor(110.8065, device='cuda:3')
norm1 res is  tensor(492.1608, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.20657694339752197
distance x is tensor(114.1474, device='cuda:3')
benign distance is  tensor(114.1474, device='cuda:3')
norm1 res is  tensor(493.7206, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3683946132659912
distance x is tensor(112.6873, device='cuda:3')
benign distance is  tensor(112.6873, device='cuda:3')
norm1 res is  tensor(497.4986, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.3406798839569092
distance x is tensor(109.0098, device='cuda:3')
benign distance is  tensor(109.0098, device='cuda:3')
norm1 res is  tensor(472.1037, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.17911438643932343
distance x is tensor(112.0859, device='cuda:3')
benign distance is  tensor(112.0859, device='cuda:3')
norm1 res is  tensor(493.3412, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.030784795060753822
distance x is tensor(106.1624, device='cuda:3')
benign distance is  tensor(106.1624, device='cuda:3')
norm1 res is  tensor(468.7884, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6880146265029907
distance x is tensor(118.6116, device='cuda:3')
benign distance is  tensor(118.6116, device='cuda:3')
norm1 res is  tensor(520.7097, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.4305098056793213
distance x is tensor(107.9693, device='cuda:3')
benign distance is  tensor(107.9693, device='cuda:3')
norm1 res is  tensor(462.8045, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7961386442184448
distance x is tensor(104.7044, device='cuda:3')
benign distance is  tensor(104.7044, device='cuda:3')
norm1 res is  tensor(455.5789, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.12283483892679214
distance x is tensor(121.3609, device='cuda:3')
benign distance is  tensor(121.3609, device='cuda:3')
norm1 res is  tensor(510.9353, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(106.1640, device='cuda:3')
compute distance is  tensor(106.1640, device='cuda:3')
compute norm is  tensor(50.2791, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.6571, device='cuda:3')
compute distance is  tensor(101.6571, device='cuda:3')
compute norm is  tensor(50.3594, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.5973, device='cuda:3')
compute distance is  tensor(116.5973, device='cuda:3')
compute norm is  tensor(50.6961, device='cuda:3', dtype=torch.float64)
distance x is tensor(108.9977, device='cuda:3')
compute distance is  tensor(108.9977, device='cuda:3')
compute norm is  tensor(50.5651, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.9737, device='cuda:3')
compute distance is  tensor(121.9737, device='cuda:3')
compute norm is  tensor(50.6411, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.8120, device='cuda:3')
compute distance is  tensor(109.8120, device='cuda:3')
compute norm is  tensor(50.5390, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.6673, device='cuda:3')
compute distance is  tensor(114.6673, device='cuda:3')
compute norm is  tensor(50.6954, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.0024, device='cuda:3')
compute distance is  tensor(115.0024, device='cuda:3')
compute norm is  tensor(50.5474, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.3513, device='cuda:3')
compute distance is  tensor(115.3513, device='cuda:3')
compute norm is  tensor(50.5572, device='cuda:3', dtype=torch.float64)
distance x is tensor(105.3681, device='cuda:3')
compute distance is  tensor(105.3681, device='cuda:3')
compute norm is  tensor(50.4917, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.5640, device='cuda:3')
compute distance is  tensor(114.5640, device='cuda:3')
compute norm is  tensor(50.6482, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.6309, device='cuda:3')
compute distance is  tensor(110.6309, device='cuda:3')
compute norm is  tensor(50.5402, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(121.9737, device='cuda:3')
distance x is tensor(106174.7422, device='cuda:3')
distance x is tensor(106174.7422, device='cuda:3')
________________________________
test distance is  tensor(106174.7422, device='cuda:3')
test distance1 is  tensor(106174.7422, device='cuda:3')
test similarity is  tensor(0.0831, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139281233286194.22
test entropy is  0.0
________________________________
cal ratio is  0.03321609196745142
distance x is tensor(3526.7156, device='cuda:3')
cal_distance is  tensor(3526.7156, device='cuda:3')
cal ratio is  0.182252675600813
distance x is tensor(642.7574, device='cuda:3')
cal_distance is  tensor(642.7574, device='cuda:3')
cal ratio is  0.4269092575530249
distance x is tensor(274.4019, device='cuda:3')
cal_distance is  tensor(274.4019, device='cuda:3')
cal ratio is  0.6533795968702825
distance x is tensor(179.2903, device='cuda:3')
cal_distance is  tensor(179.2903, device='cuda:3')
cal ratio is  0.8083150893213915
distance x is tensor(144.9241, device='cuda:3')
cal_distance is  tensor(144.9241, device='cuda:3')
cal ratio is  0.8990603462249129
distance x is tensor(130.2960, device='cuda:3')
cal_distance is  tensor(130.2960, device='cuda:3')
cal ratio is  0.94818616696164
distance x is tensor(123.5451, device='cuda:3')
cal_distance is  tensor(123.5451, device='cuda:3')
cal ratio is  0.9737474345025287
distance x is tensor(120.3019, device='cuda:3')
cal_distance is  tensor(120.3019, device='cuda:3')
distance x is tensor(120.3019, device='cuda:3')
return_distance is  tensor(120.3019, device='cuda:3')
distance x is tensor(120.2920, device='cuda:3')
distance x is tensor(120.2920, device='cuda:3')
________________________________
test distance is  tensor(120.2920, device='cuda:3')
test distance1 is  tensor(120.2920, device='cuda:3')
test similarity is  tensor(0.9651, device='cuda:3')
test acc is  0.10000000015633198
test loss is 120.06325944196949
test entropy is  3.3220477399341887e-14
________________________________
0
distance x is tensor(120.2920, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  5.944751969306591e-15
avg test loss is  120.0406299501594
avg accuracy is  0.8267333334896575
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9651, device='cuda:3')
compute_distance is  tensor(120.2920, device='cuda:3')
compute_norm is  tensor(51.1032, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(114.4499, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8184195324174885
avg test loss is  1.2671853092941903
avg accuracy is  0.8894500001563217
solo acc is  0.3355000001563402
compute similarity  is  tensor(0.9667, device='cuda:3')
compute_distance is  tensor(114.4499, device='cuda:3')
compute_norm is  tensor(50.6063, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.8285, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7866842938003256
avg test loss is  1.3135993044767806
avg accuracy is  0.891733333489655
solo acc is  0.2690833334896721
compute similarity  is  tensor(0.9663, device='cuda:3')
compute_distance is  tensor(115.8285, device='cuda:3')
compute_norm is  tensor(50.3168, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.0381, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7836132449890251
avg test loss is  1.2933707173699256
avg accuracy is  0.8919166668229882
solo acc is  0.2546666668230051
compute similarity  is  tensor(0.9660, device='cuda:3')
compute_distance is  tensor(117.0381, device='cuda:3')
compute_norm is  tensor(50.0407, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(118.2050, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7778811466846385
avg test loss is  1.2857051287124406
avg accuracy is  0.8934333334896548
solo acc is  0.2426666668230047
compute similarity  is  tensor(0.9657, device='cuda:3')
compute_distance is  tensor(118.2050, device='cuda:3')
compute_norm is  tensor(49.7741, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(119.4277, device='cuda:3')
distance x is tensor(119.4277, device='cuda:3')
________________________________
test distance is  tensor(119.4277, device='cuda:3')
test distance1 is  tensor(119.4277, device='cuda:3')
test similarity is  tensor(0.9655, device='cuda:3')
test acc is  0.23258333348967095
test loss is 1.2781762519497861
test entropy is  0.7722039032084093
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.146376371383667
mal norm is  tensor(588.3511, device='cuda:3')
distance x is tensor(119.4348, device='cuda:3')
mal distance is  tensor(119.4348, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([27., 27., 27., 27., 27., 27., 27., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 27., 27., 27., 27., 27., 27., 27.])
count_res tensor([6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06, 1.0438e-06,
        1.0438e-06, 1.0438e-06, 6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02,
        6.2499e-02, 6.2499e-02, 6.2499e-02, 6.2499e-02])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 90.59% 

Test Accuracy: 89.57% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5174247622489929
distance x is tensor(81.2840, device='cuda:3')
benign distance is  tensor(81.2840, device='cuda:3')
norm1 res is  tensor(354.9550, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.516689658164978
distance x is tensor(110.4530, device='cuda:3')
benign distance is  tensor(110.4530, device='cuda:3')
norm1 res is  tensor(485.8888, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.04669191688299179
distance x is tensor(103.5594, device='cuda:3')
benign distance is  tensor(103.5594, device='cuda:3')
norm1 res is  tensor(446.2464, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5600945353507996
distance x is tensor(86.1026, device='cuda:3')
benign distance is  tensor(86.1026, device='cuda:3')
norm1 res is  tensor(376.7636, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4771457314491272
distance x is tensor(80.8297, device='cuda:3')
benign distance is  tensor(80.8297, device='cuda:3')
norm1 res is  tensor(337.9508, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7373089790344238
distance x is tensor(91.9457, device='cuda:3')
benign distance is  tensor(91.9457, device='cuda:3')
norm1 res is  tensor(402.9453, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.06470537930727005
distance x is tensor(88.8035, device='cuda:3')
benign distance is  tensor(88.8035, device='cuda:3')
norm1 res is  tensor(380.6010, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2287653386592865
distance x is tensor(108.1759, device='cuda:3')
benign distance is  tensor(108.1759, device='cuda:3')
norm1 res is  tensor(467.0040, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.40387988090515137
distance x is tensor(128.6492, device='cuda:3')
benign distance is  tensor(128.6492, device='cuda:3')
norm1 res is  tensor(556.5109, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.35468143224716187
distance x is tensor(102.2695, device='cuda:3')
benign distance is  tensor(102.2695, device='cuda:3')
norm1 res is  tensor(446.5068, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7838578224182129
distance x is tensor(99.0306, device='cuda:3')
benign distance is  tensor(99.0306, device='cuda:3')
norm1 res is  tensor(430.6613, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7672966718673706
distance x is tensor(105.3751, device='cuda:3')
benign distance is  tensor(105.3751, device='cuda:3')
norm1 res is  tensor(457.6149, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8650226593017578
distance x is tensor(105.2279, device='cuda:3')
benign distance is  tensor(105.2279, device='cuda:3')
norm1 res is  tensor(463.7355, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.04278186708688736
distance x is tensor(111.9192, device='cuda:3')
benign distance is  tensor(111.9192, device='cuda:3')
norm1 res is  tensor(480.3506, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5216389894485474
distance x is tensor(111.6740, device='cuda:3')
benign distance is  tensor(111.6740, device='cuda:3')
norm1 res is  tensor(491.4669, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.40004435181617737
distance x is tensor(93.2011, device='cuda:3')
benign distance is  tensor(93.2011, device='cuda:3')
norm1 res is  tensor(412.7774, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(121.7549, device='cuda:3')
compute distance is  tensor(121.7549, device='cuda:3')
compute norm is  tensor(51.0513, device='cuda:3', dtype=torch.float64)
distance x is tensor(101.7262, device='cuda:3')
compute distance is  tensor(101.7262, device='cuda:3')
compute norm is  tensor(50.7621, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.4128, device='cuda:3')
compute distance is  tensor(126.4128, device='cuda:3')
compute norm is  tensor(51.2169, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.4125, device='cuda:3')
compute distance is  tensor(117.4125, device='cuda:3')
compute norm is  tensor(50.9730, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.3366, device='cuda:3')
compute distance is  tensor(110.3366, device='cuda:3')
compute norm is  tensor(51.0271, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.1966, device='cuda:3')
compute distance is  tensor(125.1966, device='cuda:3')
compute norm is  tensor(51.2552, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.4785, device='cuda:3')
compute distance is  tensor(116.4785, device='cuda:3')
compute norm is  tensor(51.1098, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.7541, device='cuda:3')
compute distance is  tensor(126.7541, device='cuda:3')
compute norm is  tensor(51.2210, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.6819, device='cuda:3')
compute distance is  tensor(129.6819, device='cuda:3')
compute norm is  tensor(51.2248, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.0242, device='cuda:3')
compute distance is  tensor(116.0242, device='cuda:3')
compute norm is  tensor(51.0973, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.6503, device='cuda:3')
compute distance is  tensor(129.6503, device='cuda:3')
compute norm is  tensor(51.4678, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.6337, device='cuda:3')
compute distance is  tensor(125.6337, device='cuda:3')
compute norm is  tensor(51.2349, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(129.6819, device='cuda:3')
distance x is tensor(106171.4844, device='cuda:3')
distance x is tensor(106171.4844, device='cuda:3')
________________________________
test distance is  tensor(106171.4844, device='cuda:3')
test distance1 is  tensor(106171.4844, device='cuda:3')
test similarity is  tensor(0.0957, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139255998135446.66
test entropy is  0.0
________________________________
cal ratio is  0.03425009156974286
distance x is tensor(3636.3887, device='cuda:3')
cal_distance is  tensor(3636.3887, device='cuda:3')
cal ratio is  0.18506765787678997
distance x is tensor(672.9819, device='cuda:3')
cal_distance is  tensor(672.9819, device='cuda:3')
cal ratio is  0.4301936307323659
distance x is tensor(289.5154, device='cuda:3')
cal_distance is  tensor(289.5154, device='cuda:3')
cal ratio is  0.6558882992553697
distance x is tensor(189.8914, device='cuda:3')
cal_distance is  tensor(189.8914, device='cuda:3')
cal ratio is  0.8098656776399208
distance x is tensor(153.7875, device='cuda:3')
cal_distance is  tensor(153.7875, device='cuda:3')
cal ratio is  0.8999225509618497
distance x is tensor(138.3974, device='cuda:3')
cal_distance is  tensor(138.3974, device='cuda:3')
cal ratio is  0.9486407227589873
distance x is tensor(131.2896, device='cuda:3')
cal_distance is  tensor(131.2896, device='cuda:3')
cal ratio is  0.9739809697395269
distance x is tensor(127.8737, device='cuda:3')
cal_distance is  tensor(127.8737, device='cuda:3')
distance x is tensor(127.8737, device='cuda:3')
return_distance is  tensor(127.8737, device='cuda:3')
distance x is tensor(127.8639, device='cuda:3')
distance x is tensor(127.8639, device='cuda:3')
________________________________
test distance is  tensor(127.8639, device='cuda:3')
test distance1 is  tensor(127.8639, device='cuda:3')
test similarity is  tensor(0.9621, device='cuda:3')
test acc is  0.10000000015633198
test loss is 153.9203688940768
test entropy is  1.396839368535003e-16
________________________________
0
distance x is tensor(127.8639, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  3.438110845987935e-17
avg test loss is  153.94579173659466
avg accuracy is  0.7981000001563254
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9621, device='cuda:3')
compute_distance is  tensor(127.8639, device='cuda:3')
compute_norm is  tensor(51.8659, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(122.6698, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.871995034121247
avg test loss is  1.3258130774696244
avg accuracy is  0.8756833334896555
solo acc is  0.31575000015633975
compute similarity  is  tensor(0.9638, device='cuda:3')
compute_distance is  tensor(122.6698, device='cuda:3')
compute_norm is  tensor(51.5234, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(123.6757, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8197327193929188
avg test loss is  1.3708721903849765
avg accuracy is  0.8793166668229887
solo acc is  0.24875000015633816
compute similarity  is  tensor(0.9635, device='cuda:3')
compute_distance is  tensor(123.6757, device='cuda:3')
compute_norm is  tensor(51.2448, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(124.5981, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8022995772265168
avg test loss is  1.3437092164432063
avg accuracy is  0.8825500001563219
solo acc is  0.24236666682300465
compute similarity  is  tensor(0.9633, device='cuda:3')
compute_distance is  tensor(124.5981, device='cuda:3')
compute_norm is  tensor(50.9753, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(125.5678, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7936378004454346
avg test loss is  1.320906662102193
avg accuracy is  0.8852500001563217
solo acc is  0.24160000015633795
compute similarity  is  tensor(0.9630, device='cuda:3')
compute_distance is  tensor(125.5678, device='cuda:3')
compute_norm is  tensor(50.7106, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(126.5413, device='cuda:3')
distance x is tensor(126.5413, device='cuda:3')
________________________________
test distance is  tensor(126.5413, device='cuda:3')
test distance1 is  tensor(126.5413, device='cuda:3')
test similarity is  tensor(0.9628, device='cuda:3')
test acc is  0.2355166668230044
test loss is 1.3030366356820187
test entropy is  0.7889719567954667
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2929960489273071
mal norm is  tensor(622.2020, device='cuda:3')
distance x is tensor(126.5484, device='cuda:3')
mal distance is  tensor(126.5484, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([19., 19., 19., 19., 19., 19., 19., 19., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0669,
        0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669,
        0.0669, 0.0669])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 78.22% 

Test Accuracy: 77.40% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.1504392772912979
distance x is tensor(152.2321, device='cuda:3')
benign distance is  tensor(152.2321, device='cuda:3')
norm1 res is  tensor(631.8568, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7555586099624634
distance x is tensor(169.2330, device='cuda:3')
benign distance is  tensor(169.2330, device='cuda:3')
norm1 res is  tensor(692.4625, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.26918402314186096
distance x is tensor(145.5838, device='cuda:3')
benign distance is  tensor(145.5838, device='cuda:3')
norm1 res is  tensor(599.8351, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5280945897102356
distance x is tensor(121.5777, device='cuda:3')
benign distance is  tensor(121.5777, device='cuda:3')
norm1 res is  tensor(487.6588, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5354477763175964
distance x is tensor(117.6874, device='cuda:3')
benign distance is  tensor(117.6874, device='cuda:3')
norm1 res is  tensor(478.6320, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.690720796585083
distance x is tensor(140.7034, device='cuda:3')
benign distance is  tensor(140.7034, device='cuda:3')
norm1 res is  tensor(579.5923, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5454689860343933
distance x is tensor(158.4814, device='cuda:3')
benign distance is  tensor(158.4814, device='cuda:3')
norm1 res is  tensor(635.4587, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.40914326906204224
distance x is tensor(140.1381, device='cuda:3')
benign distance is  tensor(140.1381, device='cuda:3')
norm1 res is  tensor(585.3478, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(154.4004, device='cuda:3')
compute distance is  tensor(154.4004, device='cuda:3')
compute norm is  tensor(51.9272, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.0601, device='cuda:3')
compute distance is  tensor(138.0601, device='cuda:3')
compute norm is  tensor(51.8561, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.8020, device='cuda:3')
compute distance is  tensor(167.8020, device='cuda:3')
compute norm is  tensor(52.5984, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.9459, device='cuda:3')
compute distance is  tensor(158.9459, device='cuda:3')
compute norm is  tensor(52.1795, device='cuda:3', dtype=torch.float64)
distance x is tensor(168.1066, device='cuda:3')
compute distance is  tensor(168.1066, device='cuda:3')
compute norm is  tensor(52.4491, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.7859, device='cuda:3')
compute distance is  tensor(161.7859, device='cuda:3')
compute norm is  tensor(52.2517, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.3040, device='cuda:3')
compute distance is  tensor(156.3040, device='cuda:3')
compute norm is  tensor(52.0024, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.0201, device='cuda:3')
compute distance is  tensor(142.0201, device='cuda:3')
compute norm is  tensor(51.9782, device='cuda:3', dtype=torch.float64)
distance x is tensor(168.2730, device='cuda:3')
compute distance is  tensor(168.2730, device='cuda:3')
compute norm is  tensor(52.5011, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.2444, device='cuda:3')
compute distance is  tensor(157.2444, device='cuda:3')
compute norm is  tensor(52.2081, device='cuda:3', dtype=torch.float64)
distance x is tensor(171.5229, device='cuda:3')
compute distance is  tensor(171.5229, device='cuda:3')
compute norm is  tensor(52.5504, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.2231, device='cuda:3')
compute distance is  tensor(147.2231, device='cuda:3')
compute norm is  tensor(52.0246, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(171.5229, device='cuda:3')
distance x is tensor(106107.5234, device='cuda:3')
distance x is tensor(106107.5234, device='cuda:3')
________________________________
test distance is  tensor(106107.5234, device='cuda:3')
test distance1 is  tensor(106107.5234, device='cuda:3')
test similarity is  tensor(0.2817, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139309832393952.89
test entropy is  0.0
________________________________
cal ratio is  0.03940161186120263
distance x is tensor(4180.8135, device='cuda:3')
cal_distance is  tensor(4180.8135, device='cuda:3')
cal ratio is  0.198498252838893
distance x is tensor(829.8880, device='cuda:3')
cal_distance is  tensor(829.8880, device='cuda:3')
cal ratio is  0.44553039433344366
distance x is tensor(369.7431, device='cuda:3')
cal_distance is  tensor(369.7431, device='cuda:3')
cal ratio is  0.6674781417661009
distance x is tensor(246.7971, device='cuda:3')
cal_distance is  tensor(246.7971, device='cuda:3')
cal ratio is  0.8169906363038201
distance x is tensor(201.6318, device='cuda:3')
cal_distance is  tensor(201.6318, device='cuda:3')
cal ratio is  0.903873330719432
distance x is tensor(182.2501, device='cuda:3')
cal_distance is  tensor(182.2501, device='cuda:3')
cal ratio is  0.950721317706214
distance x is tensor(173.2693, device='cuda:3')
cal_distance is  tensor(173.2693, device='cuda:3')
cal ratio is  0.9750486522420139
distance x is tensor(168.9461, device='cuda:3')
cal_distance is  tensor(168.9461, device='cuda:3')
distance x is tensor(168.9461, device='cuda:3')
return_distance is  tensor(168.9461, device='cuda:3')
distance x is tensor(168.9363, device='cuda:3')
distance x is tensor(168.9363, device='cuda:3')
________________________________
test distance is  tensor(168.9363, device='cuda:3')
test distance1 is  tensor(168.9363, device='cuda:3')
test similarity is  tensor(0.9499, device='cuda:3')
test acc is  0.10000000015633198
test loss is 379.4806723523496
test entropy is  7.978841075861925e-43
________________________________
0
distance x is tensor(168.9363, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.1151686038961614e-41
avg test loss is  379.55607061650454
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9499, device='cuda:3')
compute_distance is  tensor(168.9363, device='cuda:3')
compute_norm is  tensor(55.0397, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(168.8210, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.2741921490697719
avg test loss is  2.0175435933222903
avg accuracy is  0.30040000015633955
solo acc is  0.1620500001563342
compute similarity  is  tensor(0.9498, device='cuda:3')
compute_distance is  tensor(168.8210, device='cuda:3')
compute_norm is  tensor(56.0001, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(169.9736, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7062109521965483
avg test loss is  2.7555445427579413
avg accuracy is  0.19086666682300257
solo acc is  0.1028833334896653
compute similarity  is  tensor(0.9496, device='cuda:3')
compute_distance is  tensor(169.9736, device='cuda:3')
compute_norm is  tensor(55.9412, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(170.8130, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0960240346282275
avg test loss is  1.7602354127969315
avg accuracy is  0.29241666682300604
solo acc is  0.18715000015633568
compute similarity  is  tensor(0.9500, device='cuda:3')
compute_distance is  tensor(170.8130, device='cuda:3')
compute_norm is  tensor(55.6170, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(171.3999, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6581167413481771
avg test loss is  2.525298850368589
avg accuracy is  0.18875000015633575
solo acc is  0.1032833334896653
compute similarity  is  tensor(0.9498, device='cuda:3')
compute_distance is  tensor(171.3999, device='cuda:3')
compute_norm is  tensor(55.4702, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(172.0684, device='cuda:3')
distance x is tensor(172.0684, device='cuda:3')
________________________________
test distance is  tensor(172.0684, device='cuda:3')
test distance1 is  tensor(172.0684, device='cuda:3')
test similarity is  tensor(0.9500, device='cuda:3')
test acc is  0.2028000001563365
test loss is 1.6055102925310765
test entropy is  1.0184076793158232
________________________________
cal ratio is  0.9784453434539921
distance x is tensor(168.3670, device='cuda:3')
cal_distance is  tensor(168.3670, device='cuda:3')
distance x is tensor(168.3670, device='cuda:3')
return_distance is  tensor(168.3670, device='cuda:3')
distance x is tensor(168.3594, device='cuda:3')
distance x is tensor(168.3594, device='cuda:3')
________________________________
test distance is  tensor(168.3594, device='cuda:3')
test distance1 is  tensor(168.3594, device='cuda:3')
test similarity is  tensor(0.9518, device='cuda:3')
test acc is  0.1968500001563362
test loss is 1.605906157224163
test entropy is  1.0307416886027687
________________________________
0
distance x is tensor(168.3594, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0309098252355418
avg test loss is  1.6071544472596793
avg accuracy is  0.2779833334896723
solo acc is  0.19445000015633604
compute similarity  is  tensor(0.9518, device='cuda:3')
compute_distance is  tensor(168.3594, device='cuda:3')
compute_norm is  tensor(54.9982, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(168.9220, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.616283198663675
avg test loss is  2.3865333083850233
avg accuracy is  0.17430000015633493
solo acc is  0.10316666682299863
compute similarity  is  tensor(0.9516, device='cuda:3')
compute_distance is  tensor(168.9220, device='cuda:3')
compute_norm is  tensor(54.8230, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(169.6078, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9569923125350399
avg test loss is  1.5306420297002488
avg accuracy is  0.2667166668230054
solo acc is  0.20461666682300322
compute similarity  is  tensor(0.9516, device='cuda:3')
compute_distance is  tensor(169.6078, device='cuda:3')
compute_norm is  tensor(54.5072, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(169.6078, device='cuda:3')
distance x is tensor(169.6078, device='cuda:3')
________________________________
test distance is  tensor(169.6078, device='cuda:3')
test distance1 is  tensor(169.6078, device='cuda:3')
test similarity is  tensor(0.9516, device='cuda:3')
test acc is  0.20531666682300326
test loss is 1.5291303378432544
test entropy is  0.9561259473310605
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.4939864873886108
mal norm is  tensor(805.6195, device='cuda:3')
distance x is tensor(169.6154, device='cuda:3')
mal distance is  tensor(169.6154, device='cuda:3')
user_PLR len size 52
counter_tensor is  tensor([51., 51., 51., 51., 51., 51., 51., 51., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 51., 51., 51., 51., 51., 51., 51., 51.,
        51., 51., 51., 51., 51., 51., 51., 51., 51., 51., 51., 51., 51., 51.,
        51., 51., 51., 51., 51., 51., 51., 51., 51., 51.])
count_res tensor([2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 4.1754e-07, 4.1754e-07, 4.1754e-07, 4.1754e-07,
        4.1754e-07, 4.1754e-07, 4.1754e-07, 4.1754e-07, 4.1754e-07, 4.1754e-07,
        4.1754e-07, 4.1754e-07, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02,
        2.5000e-02, 2.5000e-02, 2.5000e-02, 2.5000e-02])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 90.60% 

Test Accuracy: 89.67% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.28469640016555786
distance x is tensor(82.0810, device='cuda:3')
benign distance is  tensor(82.0810, device='cuda:3')
norm1 res is  tensor(357.9347, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6612539291381836
distance x is tensor(76.3467, device='cuda:3')
benign distance is  tensor(76.3467, device='cuda:3')
norm1 res is  tensor(339.8159, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.31585007905960083
distance x is tensor(89.0152, device='cuda:3')
benign distance is  tensor(89.0152, device='cuda:3')
norm1 res is  tensor(378.5696, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.771458089351654
distance x is tensor(88.0583, device='cuda:3')
benign distance is  tensor(88.0583, device='cuda:3')
norm1 res is  tensor(378.2896, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.49409833550453186
distance x is tensor(73.8902, device='cuda:3')
benign distance is  tensor(73.8902, device='cuda:3')
norm1 res is  tensor(320.1887, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.570459246635437
distance x is tensor(81.1866, device='cuda:3')
benign distance is  tensor(81.1866, device='cuda:3')
norm1 res is  tensor(349.7829, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.09765569865703583
distance x is tensor(77.1362, device='cuda:3')
benign distance is  tensor(77.1362, device='cuda:3')
norm1 res is  tensor(325.2085, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.028935706242918968
distance x is tensor(102.5346, device='cuda:3')
benign distance is  tensor(102.5346, device='cuda:3')
norm1 res is  tensor(442.5265, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6156585812568665
distance x is tensor(114.0243, device='cuda:3')
benign distance is  tensor(114.0243, device='cuda:3')
norm1 res is  tensor(505.6511, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.40265464782714844
distance x is tensor(98.1244, device='cuda:3')
benign distance is  tensor(98.1244, device='cuda:3')
norm1 res is  tensor(426.1609, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7397103905677795
distance x is tensor(99.7966, device='cuda:3')
benign distance is  tensor(99.7966, device='cuda:3')
norm1 res is  tensor(437.5409, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.42911505699157715
distance x is tensor(115.4878, device='cuda:3')
benign distance is  tensor(115.4878, device='cuda:3')
norm1 res is  tensor(485.8300, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.236858531832695
distance x is tensor(96.1972, device='cuda:3')
benign distance is  tensor(96.1972, device='cuda:3')
norm1 res is  tensor(425.0561, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6352545022964478
distance x is tensor(110.4310, device='cuda:3')
benign distance is  tensor(110.4310, device='cuda:3')
norm1 res is  tensor(483.8651, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3120530843734741
distance x is tensor(99.2718, device='cuda:3')
benign distance is  tensor(99.2718, device='cuda:3')
norm1 res is  tensor(441.7522, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9105203747749329
distance x is tensor(105.3496, device='cuda:3')
benign distance is  tensor(105.3496, device='cuda:3')
norm1 res is  tensor(460.8117, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.33774569630622864
distance x is tensor(105.7037, device='cuda:3')
benign distance is  tensor(105.7037, device='cuda:3')
norm1 res is  tensor(461.7899, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6535924077033997
distance x is tensor(117.4178, device='cuda:3')
benign distance is  tensor(117.4178, device='cuda:3')
norm1 res is  tensor(522.7513, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.26396650075912476
distance x is tensor(103.6531, device='cuda:3')
benign distance is  tensor(103.6531, device='cuda:3')
norm1 res is  tensor(452.8321, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7839952707290649
distance x is tensor(102.2704, device='cuda:3')
benign distance is  tensor(102.2704, device='cuda:3')
norm1 res is  tensor(454.6996, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.25433349609375
distance x is tensor(110.9756, device='cuda:3')
benign distance is  tensor(110.9756, device='cuda:3')
norm1 res is  tensor(478.7855, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.3057823181152344
distance x is tensor(105.3280, device='cuda:3')
benign distance is  tensor(105.3280, device='cuda:3')
norm1 res is  tensor(453.3466, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.38644176721572876
distance x is tensor(110.9986, device='cuda:3')
benign distance is  tensor(110.9986, device='cuda:3')
norm1 res is  tensor(481.2820, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.597911536693573
distance x is tensor(112.9574, device='cuda:3')
benign distance is  tensor(112.9574, device='cuda:3')
norm1 res is  tensor(483.3479, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.2797864079475403
distance x is tensor(121.3696, device='cuda:3')
benign distance is  tensor(121.3696, device='cuda:3')
norm1 res is  tensor(535.6444, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7873790860176086
distance x is tensor(100.7877, device='cuda:3')
benign distance is  tensor(100.7877, device='cuda:3')
norm1 res is  tensor(430.7002, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9148250818252563
distance x is tensor(118.9285, device='cuda:3')
benign distance is  tensor(118.9285, device='cuda:3')
norm1 res is  tensor(516.1689, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.3291293978691101
distance x is tensor(109.0467, device='cuda:3')
benign distance is  tensor(109.0467, device='cuda:3')
norm1 res is  tensor(479.2895, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9413045644760132
distance x is tensor(96.2761, device='cuda:3')
benign distance is  tensor(96.2761, device='cuda:3')
norm1 res is  tensor(422.0659, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.226355642080307
distance x is tensor(117.2997, device='cuda:3')
benign distance is  tensor(117.2997, device='cuda:3')
norm1 res is  tensor(518.2938, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.3243463635444641
distance x is tensor(111.2398, device='cuda:3')
benign distance is  tensor(111.2398, device='cuda:3')
norm1 res is  tensor(494.0666, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.2845255732536316
distance x is tensor(119.7036, device='cuda:3')
benign distance is  tensor(119.7036, device='cuda:3')
norm1 res is  tensor(528.2107, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.08685702085494995
distance x is tensor(119.7762, device='cuda:3')
benign distance is  tensor(119.7762, device='cuda:3')
norm1 res is  tensor(521.1713, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.3235483169555664
distance x is tensor(99.3785, device='cuda:3')
benign distance is  tensor(99.3785, device='cuda:3')
norm1 res is  tensor(437.5515, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.1812589466571808
distance x is tensor(109.9136, device='cuda:3')
benign distance is  tensor(109.9136, device='cuda:3')
norm1 res is  tensor(480.2648, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.4312324523925781
distance x is tensor(110.2704, device='cuda:3')
benign distance is  tensor(110.2704, device='cuda:3')
norm1 res is  tensor(479.5199, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.2681232988834381
distance x is tensor(102.2114, device='cuda:3')
benign distance is  tensor(102.2114, device='cuda:3')
norm1 res is  tensor(450.4157, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.8687082529067993
distance x is tensor(117.2773, device='cuda:3')
benign distance is  tensor(117.2773, device='cuda:3')
norm1 res is  tensor(504.2331, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.41755780577659607
distance x is tensor(111.0161, device='cuda:3')
benign distance is  tensor(111.0161, device='cuda:3')
norm1 res is  tensor(477.6573, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5186169743537903
distance x is tensor(121.8001, device='cuda:3')
benign distance is  tensor(121.8001, device='cuda:3')
norm1 res is  tensor(523.9096, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(119.8237, device='cuda:3')
compute distance is  tensor(119.8237, device='cuda:3')
compute norm is  tensor(50.9803, device='cuda:3', dtype=torch.float64)
distance x is tensor(96.8693, device='cuda:3')
compute distance is  tensor(96.8693, device='cuda:3')
compute norm is  tensor(50.9064, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.7784, device='cuda:3')
compute distance is  tensor(112.7784, device='cuda:3')
compute norm is  tensor(51.2108, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.4990, device='cuda:3')
compute distance is  tensor(112.4990, device='cuda:3')
compute norm is  tensor(50.9970, device='cuda:3', dtype=torch.float64)
distance x is tensor(107.3477, device='cuda:3')
compute distance is  tensor(107.3477, device='cuda:3')
compute norm is  tensor(50.9963, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.0188, device='cuda:3')
compute distance is  tensor(124.0188, device='cuda:3')
compute norm is  tensor(51.2713, device='cuda:3', dtype=torch.float64)
distance x is tensor(103.1473, device='cuda:3')
compute distance is  tensor(103.1473, device='cuda:3')
compute norm is  tensor(50.9971, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.3036, device='cuda:3')
compute distance is  tensor(124.3036, device='cuda:3')
compute norm is  tensor(51.2114, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.3096, device='cuda:3')
compute distance is  tensor(112.3096, device='cuda:3')
compute norm is  tensor(51.1054, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.2549, device='cuda:3')
compute distance is  tensor(115.2549, device='cuda:3')
compute norm is  tensor(51.2123, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.2757, device='cuda:3')
compute distance is  tensor(115.2757, device='cuda:3')
compute norm is  tensor(51.1249, device='cuda:3', dtype=torch.float64)
distance x is tensor(111.7243, device='cuda:3')
compute distance is  tensor(111.7243, device='cuda:3')
compute norm is  tensor(51.1104, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(124.3036, device='cuda:3')
distance x is tensor(106166.3047, device='cuda:3')
distance x is tensor(106166.3047, device='cuda:3')
________________________________
test distance is  tensor(106166.3047, device='cuda:3')
test distance1 is  tensor(106166.3047, device='cuda:3')
test similarity is  tensor(0.1207, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139285323823649.84
test entropy is  0.0
________________________________
cal ratio is  0.03353316854038774
distance x is tensor(3560.0974, device='cuda:3')
cal_distance is  tensor(3560.0974, device='cuda:3')
cal ratio is  0.18312051954744724
distance x is tensor(651.9308, device='cuda:3')
cal_distance is  tensor(651.9308, device='cuda:3')
cal ratio is  0.427924536969569
distance x is tensor(278.9801, device='cuda:3')
cal_distance is  tensor(278.9801, device='cuda:3')
cal ratio is  0.6541560185916356
distance x is tensor(182.4982, device='cuda:3')
cal_distance is  tensor(182.4982, device='cuda:3')
cal ratio is  0.8087953139143893
distance x is tensor(147.6047, device='cuda:3')
cal_distance is  tensor(147.6047, device='cuda:3')
cal ratio is  0.8993275029548633
distance x is tensor(132.7455, device='cuda:3')
cal_distance is  tensor(132.7455, device='cuda:3')
cal ratio is  0.9483270053758552
distance x is tensor(125.8864, device='cuda:3')
cal_distance is  tensor(125.8864, device='cuda:3')
cal ratio is  0.9738197993822728
distance x is tensor(122.5908, device='cuda:3')
cal_distance is  tensor(122.5908, device='cuda:3')
distance x is tensor(122.5908, device='cuda:3')
return_distance is  tensor(122.5908, device='cuda:3')
distance x is tensor(122.5809, device='cuda:3')
distance x is tensor(122.5809, device='cuda:3')
________________________________
test distance is  tensor(122.5809, device='cuda:3')
test distance1 is  tensor(122.5809, device='cuda:3')
test similarity is  tensor(0.9657, device='cuda:3')
test acc is  0.10000000015633198
test loss is 106.84175771945067
test entropy is  4.508058746404961e-12
________________________________
0
distance x is tensor(122.5809, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  9.488697931168399e-12
avg test loss is  106.82633873750406
avg accuracy is  0.8492166668229899
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9657, device='cuda:3')
compute_distance is  tensor(122.5809, device='cuda:3')
compute_norm is  tensor(51.9740, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(116.4031, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8306599270179074
avg test loss is  1.2617061886070633
avg accuracy is  0.8887166668229883
solo acc is  0.3387333334896736
compute similarity  is  tensor(0.9672, device='cuda:3')
compute_distance is  tensor(116.4031, device='cuda:3')
compute_norm is  tensor(51.5031, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.4945, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7924870852468364
avg test loss is  1.3273194809712328
avg accuracy is  0.889733333489655
solo acc is  0.2591666668230052
compute similarity  is  tensor(0.9669, device='cuda:3')
compute_distance is  tensor(117.4945, device='cuda:3')
compute_norm is  tensor(51.2217, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(118.4433, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.7862595176773031
avg test loss is  1.300982691649435
avg accuracy is  0.890833333489655
solo acc is  0.2509833334896716
compute similarity  is  tensor(0.9666, device='cuda:3')
compute_distance is  tensor(118.4433, device='cuda:3')
compute_norm is  tensor(50.9489, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(119.4230, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.7776892731057555
avg test loss is  1.2874346468240214
avg accuracy is  0.8924833334896548
solo acc is  0.24403333348967138
compute similarity  is  tensor(0.9664, device='cuda:3')
compute_distance is  tensor(119.4230, device='cuda:3')
compute_norm is  tensor(50.6827, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(120.4361, device='cuda:3')
distance x is tensor(120.4361, device='cuda:3')
________________________________
test distance is  tensor(120.4361, device='cuda:3')
test distance1 is  tensor(120.4361, device='cuda:3')
test similarity is  tensor(0.9662, device='cuda:3')
test acc is  0.24590000015633803
test loss is 1.2592620934123424
test entropy is  0.7780332512565767
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.1687257289886475
mal norm is  tensor(596.1859, device='cuda:3')
distance x is tensor(120.4438, device='cuda:3')
mal distance is  tensor(120.4438, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([19., 19., 19., 19., 19., 19., 19., 19., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0246, 0.0669,
        0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669,
        0.0669, 0.0669])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 80.67% 

Test Accuracy: 79.84% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.3422452211380005
distance x is tensor(151.1621, device='cuda:3')
benign distance is  tensor(151.1621, device='cuda:3')
norm1 res is  tensor(614.6773, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6867598295211792
distance x is tensor(140.7430, device='cuda:3')
benign distance is  tensor(140.7430, device='cuda:3')
norm1 res is  tensor(585.7906, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.43213382363319397
distance x is tensor(146.5929, device='cuda:3')
benign distance is  tensor(146.5929, device='cuda:3')
norm1 res is  tensor(597.9749, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.37266653776168823
distance x is tensor(132.1043, device='cuda:3')
benign distance is  tensor(132.1043, device='cuda:3')
norm1 res is  tensor(534.4432, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.912641704082489
distance x is tensor(142.6614, device='cuda:3')
benign distance is  tensor(142.6614, device='cuda:3')
norm1 res is  tensor(568.8730, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8571285009384155
distance x is tensor(126.9688, device='cuda:3')
benign distance is  tensor(126.9688, device='cuda:3')
norm1 res is  tensor(515.6489, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.05902410298585892
distance x is tensor(127.9804, device='cuda:3')
benign distance is  tensor(127.9804, device='cuda:3')
norm1 res is  tensor(506.9777, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.38528376817703247
distance x is tensor(154.0117, device='cuda:3')
benign distance is  tensor(154.0117, device='cuda:3')
norm1 res is  tensor(620.3044, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(140.3290, device='cuda:3')
compute distance is  tensor(140.3290, device='cuda:3')
compute norm is  tensor(51.8122, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.3910, device='cuda:3')
compute distance is  tensor(146.3910, device='cuda:3')
compute norm is  tensor(52.1069, device='cuda:3', dtype=torch.float64)
distance x is tensor(154.9867, device='cuda:3')
compute distance is  tensor(154.9867, device='cuda:3')
compute norm is  tensor(52.3392, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.6789, device='cuda:3')
compute distance is  tensor(155.6789, device='cuda:3')
compute norm is  tensor(52.3043, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.3493, device='cuda:3')
compute distance is  tensor(152.3493, device='cuda:3')
compute norm is  tensor(52.1819, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.7375, device='cuda:3')
compute distance is  tensor(156.7375, device='cuda:3')
compute norm is  tensor(52.2688, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.2576, device='cuda:3')
compute distance is  tensor(151.2576, device='cuda:3')
compute norm is  tensor(52.1915, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.1953, device='cuda:3')
compute distance is  tensor(141.1953, device='cuda:3')
compute norm is  tensor(52.0030, device='cuda:3', dtype=torch.float64)
distance x is tensor(173.4239, device='cuda:3')
compute distance is  tensor(173.4239, device='cuda:3')
compute norm is  tensor(52.4276, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.1125, device='cuda:3')
compute distance is  tensor(149.1125, device='cuda:3')
compute norm is  tensor(52.2115, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.4343, device='cuda:3')
compute distance is  tensor(160.4343, device='cuda:3')
compute norm is  tensor(52.4146, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.5827, device='cuda:3')
compute distance is  tensor(144.5827, device='cuda:3')
compute norm is  tensor(52.0060, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(173.4239, device='cuda:3')
distance x is tensor(106099.5703, device='cuda:3')
distance x is tensor(106099.5703, device='cuda:3')
________________________________
test distance is  tensor(106099.5703, device='cuda:3')
test distance1 is  tensor(106099.5703, device='cuda:3')
test similarity is  tensor(0.3036, device='cuda:3')
test acc is  0.10000000015633198
test loss is 139268956665703.17
test entropy is  0.0
________________________________
cal ratio is  0.03962084215194872
distance x is tensor(4203.7598, device='cuda:3')
cal_distance is  tensor(4203.7598, device='cuda:3')
cal ratio is  0.19904972072076021
distance x is tensor(836.7612, device='cuda:3')
cal_distance is  tensor(836.7612, device='cuda:3')
cal ratio is  0.4461488327184133
distance x is tensor(373.3228, device='cuda:3')
cal_distance is  tensor(373.3228, device='cuda:3')
cal ratio is  0.6679412463231154
distance x is tensor(249.3593, device='cuda:3')
cal_distance is  tensor(249.3593, device='cuda:3')
cal ratio is  0.8172740092538944
distance x is tensor(203.7958, device='cuda:3')
cal_distance is  tensor(203.7958, device='cuda:3')
cal ratio is  0.9040300960251877
distance x is tensor(184.2380, device='cuda:3')
cal_distance is  tensor(184.2380, device='cuda:3')
cal ratio is  0.9508037134931927
distance x is tensor(175.1745, device='cuda:3')
cal_distance is  tensor(175.1745, device='cuda:3')
cal ratio is  0.9750909219309657
distance x is tensor(170.8111, device='cuda:3')
cal_distance is  tensor(170.8111, device='cuda:3')
distance x is tensor(170.8111, device='cuda:3')
return_distance is  tensor(170.8111, device='cuda:3')
distance x is tensor(170.8013, device='cuda:3')
distance x is tensor(170.8013, device='cuda:3')
________________________________
test distance is  tensor(170.8013, device='cuda:3')
test distance1 is  tensor(170.8013, device='cuda:3')
test similarity is  tensor(0.9507, device='cuda:3')
test acc is  0.10000000015633198
test loss is 564.7756831122359
test entropy is  0.0
________________________________
0
distance x is tensor(170.8013, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  564.7618127428392
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9507, device='cuda:3')
compute_distance is  tensor(170.8013, device='cuda:3')
compute_norm is  tensor(55.3347, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(507.9573, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.553172792580082
avg test loss is  2.870307111790948
avg accuracy is  0.10023333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8146, device='cuda:3')
compute_distance is  tensor(507.9573, device='cuda:3')
compute_norm is  tensor(69.6398, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(506.3516, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8315400687743352
avg test loss is  3.6026758837547384
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8145, device='cuda:3')
compute_distance is  tensor(506.3516, device='cuda:3')
compute_norm is  tensor(69.6298, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(503.9176, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5556267266080324
avg test loss is  2.8509329765844447
avg accuracy is  0.10018333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8145, device='cuda:3')
compute_distance is  tensor(503.9176, device='cuda:3')
compute_norm is  tensor(68.9894, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(502.3932, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.831430570911497
avg test loss is  3.589849169574567
avg accuracy is  0.10003333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8145, device='cuda:3')
compute_distance is  tensor(502.3932, device='cuda:3')
compute_norm is  tensor(68.9918, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(499.9996, device='cuda:3')
distance x is tensor(499.9996, device='cuda:3')
________________________________
test distance is  tensor(499.9996, device='cuda:3')
test distance1 is  tensor(499.9996, device='cuda:3')
test similarity is  tensor(0.8145, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8515852199180296
test entropy is  1.5540402347345088
________________________________
cal ratio is  0.5771592759200692
distance x is tensor(288.5816, device='cuda:3')
cal_distance is  tensor(288.5816, device='cuda:3')
cal ratio is  0.7597071531571113
distance x is tensor(219.2378, device='cuda:3')
cal_distance is  tensor(219.2378, device='cuda:3')
cal ratio is  0.8716111538677753
distance x is tensor(191.0903, device='cuda:3')
cal_distance is  tensor(191.0903, device='cuda:3')
cal ratio is  0.9336007236874659
distance x is tensor(178.4022, device='cuda:3')
cal_distance is  tensor(178.4022, device='cuda:3')
cal ratio is  0.9662298715377572
distance x is tensor(172.3775, device='cuda:3')
cal_distance is  tensor(172.3775, device='cuda:3')
distance x is tensor(172.3775, device='cuda:3')
return_distance is  tensor(172.3775, device='cuda:3')
distance x is tensor(172.3748, device='cuda:3')
distance x is tensor(172.3748, device='cuda:3')
________________________________
test distance is  tensor(172.3748, device='cuda:3')
test distance1 is  tensor(172.3748, device='cuda:3')
test similarity is  tensor(0.9681, device='cuda:3')
test acc is  0.10210000015633197
test loss is 2.5123333735252493
test entropy is  2.0674975162375966
________________________________
0
distance x is tensor(172.3748, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.067528612578093
avg test loss is  2.512337444179348
avg accuracy is  0.2166000001563371
solo acc is  0.10231666682299863
compute similarity  is  tensor(0.9681, device='cuda:3')
compute_distance is  tensor(172.3748, device='cuda:3')
compute_norm is  tensor(53.5804, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(174.0223, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6954993001306489
avg test loss is  2.727859487919919
avg accuracy is  0.14226666682299913
solo acc is  0.10330000015633196
compute similarity  is  tensor(0.9678, device='cuda:3')
compute_distance is  tensor(174.0223, device='cuda:3')
compute_norm is  tensor(53.5452, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(175.0232, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9025255345078166
avg test loss is  1.4170682900495875
avg accuracy is  0.250866666823005
solo acc is  0.26345000015633857
compute similarity  is  tensor(0.9680, device='cuda:3')
compute_distance is  tensor(175.0232, device='cuda:3')
compute_norm is  tensor(53.1749, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(175.0232, device='cuda:3')
distance x is tensor(175.0232, device='cuda:3')
________________________________
test distance is  tensor(175.0232, device='cuda:3')
test distance1 is  tensor(175.0232, device='cuda:3')
test similarity is  tensor(0.9680, device='cuda:3')
test acc is  0.26601666682300534
test loss is 1.4150253986753125
test entropy is  0.9021654041972496
________________________________
cal ratio is  0.9755121097340972
distance x is tensor(170.7392, device='cuda:3')
cal_distance is  tensor(170.7392, device='cuda:3')
distance x is tensor(170.7392, device='cuda:3')
return_distance is  tensor(170.7392, device='cuda:3')
distance x is tensor(170.7373, device='cuda:3')
distance x is tensor(170.7373, device='cuda:3')
________________________________
test distance is  tensor(170.7373, device='cuda:3')
test distance1 is  tensor(170.7373, device='cuda:3')
test similarity is  tensor(0.9695, device='cuda:3')
test acc is  0.2557166668230051
test loss is 1.4128723661782645
test entropy is  0.9313997310488972
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.0457333326339722
mal norm is  tensor(592.0589, device='cuda:3')
distance x is tensor(170.7392, device='cuda:3')
mal distance is  tensor(170.7392, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([35., 35., 35., 35., 35., 35., 35., 35., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 35., 35., 35., 35., 35., 35., 35., 35.,
        35., 35., 35., 35., 35., 35., 35., 35.])
count_res tensor([4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07,
        6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07, 6.9590e-07,
        6.9590e-07, 6.9590e-07, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02,
        4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02, 4.1666e-02])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 90.63% 

Test Accuracy: 89.56% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 90.63%
|----0th round Training Accuracy : 82.73%
|----1th round Training Accuracy : 89.65%
|----2th round Training Accuracy : 89.77%
|----3th round Training Accuracy : 89.88%
|----4th round Training Accuracy : 89.82%
|----5th round Training Accuracy : 89.83%
|----6th round Training Accuracy : 77.38%
|----7th round Training Accuracy : 90.17%
|----8th round Training Accuracy : 90.22%
|----9th round Training Accuracy : 90.08%
|----10th round Training Accuracy : 78.27%
|----11th round Training Accuracy : 90.14%
|----12th round Training Accuracy : 79.89%
|----13th round Training Accuracy : 89.97%
|----14th round Training Accuracy : 90.21%
|----15th round Training Accuracy : 90.33%
|----16th round Training Accuracy : 83.03%
|----17th round Training Accuracy : 90.37%
|----18th round Training Accuracy : 80.14%
|----19th round Training Accuracy : 90.24%
|----20th round Training Accuracy : 90.41%
|----21th round Training Accuracy : 90.38%
|----22th round Training Accuracy : 78.79%
|----23th round Training Accuracy : 90.47%
|----24th round Training Accuracy : 90.34%
|----25th round Training Accuracy : 90.59%
|----26th round Training Accuracy : 90.41%
|----27th round Training Accuracy : 90.56%
|----28th round Training Accuracy : 81.43%
|----29th round Training Accuracy : 90.55%
|----30th round Training Accuracy : 81.35%
|----31th round Training Accuracy : 90.47%
|----32th round Training Accuracy : 90.42%
|----33th round Training Accuracy : 90.40%
|----34th round Training Accuracy : 90.60%
|----35th round Training Accuracy : 90.57%
|----36th round Training Accuracy : 81.92%
|----37th round Training Accuracy : 90.32%
|----38th round Training Accuracy : 90.58%
|----39th round Training Accuracy : 90.63%
|----40th round Training Accuracy : 79.78%
|----41th round Training Accuracy : 90.57%
|----42th round Training Accuracy : 79.07%
|----43th round Training Accuracy : 90.56%
|----44th round Training Accuracy : 90.72%
|----45th round Training Accuracy : 90.59%
|----46th round Training Accuracy : 78.22%
|----47th round Training Accuracy : 90.60%
|----48th round Training Accuracy : 80.67%
|----49th round Training Accuracy : 90.63%
|----Final Test Accuracy: 89.56%
|----0th round Final Test Accuracy : 81.59%
|----1th round Final Test Accuracy : 88.94%
|----2th round Final Test Accuracy : 89.01%
|----3th round Final Test Accuracy : 88.95%
|----4th round Final Test Accuracy : 89.27%
|----5th round Final Test Accuracy : 89.24%
|----6th round Final Test Accuracy : 76.18%
|----7th round Final Test Accuracy : 89.19%
|----8th round Final Test Accuracy : 89.42%
|----9th round Final Test Accuracy : 89.34%
|----10th round Final Test Accuracy : 77.27%
|----11th round Final Test Accuracy : 89.47%
|----12th round Final Test Accuracy : 78.94%
|----13th round Final Test Accuracy : 89.28%
|----14th round Final Test Accuracy : 89.68%
|----15th round Final Test Accuracy : 89.56%
|----16th round Final Test Accuracy : 82.04%
|----17th round Final Test Accuracy : 89.63%
|----18th round Final Test Accuracy : 79.19%
|----19th round Final Test Accuracy : 89.33%
|----20th round Final Test Accuracy : 89.77%
|----21th round Final Test Accuracy : 89.53%
|----22th round Final Test Accuracy : 77.63%
|----23th round Final Test Accuracy : 89.56%
|----24th round Final Test Accuracy : 89.39%
|----25th round Final Test Accuracy : 89.59%
|----26th round Final Test Accuracy : 89.61%
|----27th round Final Test Accuracy : 89.57%
|----28th round Final Test Accuracy : 80.41%
|----29th round Final Test Accuracy : 89.63%
|----30th round Final Test Accuracy : 80.12%
|----31th round Final Test Accuracy : 89.55%
|----32th round Final Test Accuracy : 89.70%
|----33th round Final Test Accuracy : 89.27%
|----34th round Final Test Accuracy : 89.59%
|----35th round Final Test Accuracy : 89.71%
|----36th round Final Test Accuracy : 80.72%
|----37th round Final Test Accuracy : 89.39%
|----38th round Final Test Accuracy : 89.51%
|----39th round Final Test Accuracy : 89.55%
|----40th round Final Test Accuracy : 78.63%
|----41th round Final Test Accuracy : 89.68%
|----42th round Final Test Accuracy : 78.01%
|----43th round Final Test Accuracy : 89.49%
|----44th round Final Test Accuracy : 89.77%
|----45th round Final Test Accuracy : 89.57%
|----46th round Final Test Accuracy : 77.40%
|----47th round Final Test Accuracy : 89.67%
|----48th round Final Test Accuracy : 79.84%
|----49th round Final Test Accuracy : 89.56%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 19336.5255
