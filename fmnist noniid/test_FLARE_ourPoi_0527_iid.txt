
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.37637537717819214
distance x is tensor(108.3372, device='cuda:3')
benign distance is  tensor(108.3372, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7681277990341187
distance x is tensor(118.0201, device='cuda:3')
benign distance is  tensor(118.0201, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3420323431491852
distance x is tensor(120.6046, device='cuda:3')
benign distance is  tensor(120.6046, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6842314600944519
distance x is tensor(117.9063, device='cuda:3')
benign distance is  tensor(117.9063, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8361675143241882
distance x is tensor(106.5257, device='cuda:3')
benign distance is  tensor(106.5257, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3435594439506531
distance x is tensor(125.2637, device='cuda:3')
benign distance is  tensor(125.2637, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6416714787483215
distance x is tensor(106.7622, device='cuda:3')
benign distance is  tensor(106.7622, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5051180124282837
distance x is tensor(120.6299, device='cuda:3')
benign distance is  tensor(120.6299, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.48666757345199585
distance x is tensor(133.3661, device='cuda:3')
benign distance is  tensor(133.3661, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5640508532524109
distance x is tensor(137.3759, device='cuda:3')
benign distance is  tensor(137.3759, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7104324102401733
distance x is tensor(119.8496, device='cuda:3')
benign distance is  tensor(119.8496, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4013005793094635
distance x is tensor(126.3673, device='cuda:3')
benign distance is  tensor(126.3673, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.42164739966392517
distance x is tensor(122.5001, device='cuda:3')
benign distance is  tensor(122.5001, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.346833735704422
distance x is tensor(145.6207, device='cuda:3')
benign distance is  tensor(145.6207, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0686190128326416
distance x is tensor(137.4914, device='cuda:3')
benign distance is  tensor(137.4914, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.21781118214130402
distance x is tensor(132.3047, device='cuda:3')
benign distance is  tensor(132.3047, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.34245800971984863
distance x is tensor(126.1581, device='cuda:3')
benign distance is  tensor(126.1581, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.410905659198761
distance x is tensor(148.7663, device='cuda:3')
benign distance is  tensor(148.7663, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.22471868991851807
distance x is tensor(128.1315, device='cuda:3')
benign distance is  tensor(128.1315, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4695284962654114
distance x is tensor(125.3912, device='cuda:3')
benign distance is  tensor(125.3912, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.1057555228471756
distance x is tensor(128.4752, device='cuda:3')
benign distance is  tensor(128.4752, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.18221578001976013
distance x is tensor(121.6978, device='cuda:3')
benign distance is  tensor(121.6978, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4067727029323578
distance x is tensor(137.8249, device='cuda:3')
benign distance is  tensor(137.8249, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.4737471342086792
distance x is tensor(133.1014, device='cuda:3')
benign distance is  tensor(133.1014, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.8277078866958618
distance x is tensor(151.1472, device='cuda:3')
benign distance is  tensor(151.1472, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.4287596344947815
distance x is tensor(121.1141, device='cuda:3')
benign distance is  tensor(121.1141, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.44723477959632874
distance x is tensor(133.0360, device='cuda:3')
benign distance is  tensor(133.0360, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4686488211154938
distance x is tensor(135.7279, device='cuda:3')
benign distance is  tensor(135.7279, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8494880795478821
distance x is tensor(124.0667, device='cuda:3')
benign distance is  tensor(124.0667, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.598904013633728
distance x is tensor(134.2345, device='cuda:3')
benign distance is  tensor(134.2345, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6359353065490723
distance x is tensor(123.3077, device='cuda:3')
benign distance is  tensor(123.3077, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.8212146759033203
distance x is tensor(134.8853, device='cuda:3')
benign distance is  tensor(134.8853, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.5252318978309631
distance x is tensor(137.9492, device='cuda:3')
benign distance is  tensor(137.9492, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.23729968070983887
distance x is tensor(129.8930, device='cuda:3')
benign distance is  tensor(129.8930, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.3140333592891693
distance x is tensor(132.9067, device='cuda:3')
benign distance is  tensor(132.9067, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.04968807101249695
distance x is tensor(128.2686, device='cuda:3')
benign distance is  tensor(128.2686, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5110154151916504
distance x is tensor(127.8121, device='cuda:3')
benign distance is  tensor(127.8121, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.3393841087818146
distance x is tensor(129.5527, device='cuda:3')
benign distance is  tensor(129.5527, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.24555730819702148
distance x is tensor(124.1626, device='cuda:3')
benign distance is  tensor(124.1626, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.2941904664039612
distance x is tensor(130.4359, device='cuda:3')
benign distance is  tensor(130.4359, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.08850498497486115
distance x is tensor(126.3983, device='cuda:3')
benign distance is  tensor(126.3983, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.2755129635334015
distance x is tensor(124.5269, device='cuda:3')
benign distance is  tensor(124.5269, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.04730570688843727
distance x is tensor(129.7012, device='cuda:3')
benign distance is  tensor(129.7012, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.6059579253196716
distance x is tensor(132.4998, device='cuda:3')
benign distance is  tensor(132.4998, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.1689799726009369
distance x is tensor(138.5989, device='cuda:3')
benign distance is  tensor(138.5989, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.49659356474876404
distance x is tensor(131.0971, device='cuda:3')
benign distance is  tensor(131.0971, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7305780649185181
distance x is tensor(133.1095, device='cuda:3')
benign distance is  tensor(133.1095, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.2996561527252197
distance x is tensor(135.8406, device='cuda:3')
benign distance is  tensor(135.8406, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(111.1862, device='cuda:3')
compute distance is  tensor(111.1862, device='cuda:3')
compute norm is  tensor(45.4622, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.3728, device='cuda:3')
compute distance is  tensor(114.3728, device='cuda:3')
compute norm is  tensor(45.5137, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.9705, device='cuda:3')
compute distance is  tensor(117.9705, device='cuda:3')
compute norm is  tensor(45.8654, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.7989, device='cuda:3')
compute distance is  tensor(109.7989, device='cuda:3')
compute norm is  tensor(45.5581, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.3542, device='cuda:3')
compute distance is  tensor(123.3542, device='cuda:3')
compute norm is  tensor(45.6991, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.4449, device='cuda:3')
compute distance is  tensor(118.4449, device='cuda:3')
compute norm is  tensor(45.7929, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.6056, device='cuda:3')
compute distance is  tensor(119.6056, device='cuda:3')
compute norm is  tensor(45.7244, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.1055, device='cuda:3')
compute distance is  tensor(124.1055, device='cuda:3')
compute norm is  tensor(45.7689, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.3483, device='cuda:3')
compute distance is  tensor(126.3483, device='cuda:3')
compute norm is  tensor(45.8020, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.6343, device='cuda:3')
compute distance is  tensor(123.6343, device='cuda:3')
compute norm is  tensor(45.9173, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.8691, device='cuda:3')
compute distance is  tensor(119.8691, device='cuda:3')
compute norm is  tensor(45.9312, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.7504, device='cuda:3')
compute distance is  tensor(130.7504, device='cuda:3')
compute norm is  tensor(45.9974, device='cuda:3', dtype=torch.float64)
batch acc is 0.1023166668229986
mal_rand_acc is 0.10000000049999999
mal_rand loss is 119521490763776.0
len of model dicts is  12
distance x is tensor(111.1862, device='cuda:3')
compute distance is  tensor(111.1862, device='cuda:3')
compute norm is  tensor(45.4622, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.3728, device='cuda:3')
compute distance is  tensor(114.3728, device='cuda:3')
compute norm is  tensor(45.5137, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.9705, device='cuda:3')
compute distance is  tensor(117.9705, device='cuda:3')
compute norm is  tensor(45.8654, device='cuda:3', dtype=torch.float64)
distance x is tensor(109.7989, device='cuda:3')
compute distance is  tensor(109.7989, device='cuda:3')
compute norm is  tensor(45.5581, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.3542, device='cuda:3')
compute distance is  tensor(123.3542, device='cuda:3')
compute norm is  tensor(45.6991, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.4449, device='cuda:3')
compute distance is  tensor(118.4449, device='cuda:3')
compute norm is  tensor(45.7929, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.6056, device='cuda:3')
compute distance is  tensor(119.6056, device='cuda:3')
compute norm is  tensor(45.7244, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.1055, device='cuda:3')
compute distance is  tensor(124.1055, device='cuda:3')
compute norm is  tensor(45.7689, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.3483, device='cuda:3')
compute distance is  tensor(126.3483, device='cuda:3')
compute norm is  tensor(45.8020, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.6343, device='cuda:3')
compute distance is  tensor(123.6343, device='cuda:3')
compute norm is  tensor(45.9173, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.8691, device='cuda:3')
compute distance is  tensor(119.8691, device='cuda:3')
compute norm is  tensor(45.9312, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.7504, device='cuda:3')
compute distance is  tensor(130.7504, device='cuda:3')
compute norm is  tensor(45.9974, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(130.7504, device='cuda:3')
distance x is tensor(107710.2031, device='cuda:3')
distance x is tensor(107710.2031, device='cuda:3')
________________________________
test distance is  tensor(107710.2031, device='cuda:3')
test distance1 is  tensor(107710.2031, device='cuda:3')
test similarity is  tensor(-0.1075, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130124727933456.38
test entropy is  0.0
________________________________
cal ratio is  0.03414437963724053
distance x is tensor(3677.7036, device='cuda:3')
cal_distance is  tensor(3677.7036, device='cuda:3')
cal ratio is  0.18478184227612218
distance x is tensor(679.5771, device='cuda:3')
cal_distance is  tensor(679.5771, device='cuda:3')
cal ratio is  0.42986125226096383
distance x is tensor(292.1268, device='cuda:3')
cal_distance is  tensor(292.1268, device='cuda:3')
cal ratio is  0.6556347090508615
distance x is tensor(191.5303, device='cuda:3')
cal_distance is  tensor(191.5303, device='cuda:3')
cal ratio is  0.8097089567179268
distance x is tensor(155.0848, device='cuda:3')
cal_distance is  tensor(155.0848, device='cuda:3')
cal ratio is  0.8998354006958023
distance x is tensor(139.5513, device='cuda:3')
cal_distance is  tensor(139.5513, device='cuda:3')
cal ratio is  0.9485947097248166
distance x is tensor(132.3779, device='cuda:3')
cal_distance is  tensor(132.3779, device='cuda:3')
cal ratio is  0.9739572543309944
distance x is tensor(128.9306, device='cuda:3')
cal_distance is  tensor(128.9306, device='cuda:3')
distance x is tensor(128.9306, device='cuda:3')
return_distance is  tensor(128.9306, device='cuda:3')
distance x is tensor(128.9202, device='cuda:3')
distance x is tensor(128.9202, device='cuda:3')
________________________________
test distance is  tensor(128.9202, device='cuda:3')
test distance1 is  tensor(128.9202, device='cuda:3')
test similarity is  tensor(0.9445, device='cuda:3')
test acc is  0.10010000015633198
test loss is 297.36056419323756
test entropy is  1.3591405019847141e-05
________________________________
0
distance x is tensor(128.9202, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  4.3348537113566086e-05
avg test loss is  297.6518559405036
avg accuracy is  0.32365000015634
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9445, device='cuda:3')
compute_distance is  tensor(128.9202, device='cuda:3')
compute_norm is  tensor(44.2794, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(108.2497, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9573397726646619
avg test loss is  1.4128467871436179
avg accuracy is  0.8317666668229908
solo acc is  0.35926666682300723
compute similarity  is  tensor(0.9518, device='cuda:3')
compute_distance is  tensor(108.2497, device='cuda:3')
compute_norm is  tensor(43.1187, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(110.7699, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8684648603264457
avg test loss is  1.5590758335107424
avg accuracy is  0.8312333334896576
solo acc is  0.27791666682300564
compute similarity  is  tensor(0.9513, device='cuda:3')
compute_distance is  tensor(110.7699, device='cuda:3')
compute_norm is  tensor(42.8214, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(112.8639, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8779711697274434
avg test loss is  1.4983728403475747
avg accuracy is  0.8372666668229907
solo acc is  0.27471666682300555
compute similarity  is  tensor(0.9509, device='cuda:3')
compute_distance is  tensor(112.8639, device='cuda:3')
compute_norm is  tensor(42.5537, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(114.8511, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.870354812282489
avg test loss is  1.4547708966076247
avg accuracy is  0.841383333489657
solo acc is  0.2757166668230056
compute similarity  is  tensor(0.9505, device='cuda:3')
compute_distance is  tensor(114.8511, device='cuda:3')
compute_norm is  tensor(42.3037, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(116.7205, device='cuda:3')
distance x is tensor(116.7205, device='cuda:3')
________________________________
test distance is  tensor(116.7205, device='cuda:3')
test distance1 is  tensor(116.7205, device='cuda:3')
test similarity is  tensor(0.9501, device='cuda:3')
test acc is  0.2777333334896724
test loss is 1.421352483316271
test entropy is  0.8708440765007727
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.2796510457992554
mal norm is  tensor(611.6917, device='cuda:3')
distance x is tensor(116.7281, device='cuda:3')
mal distance is  tensor(116.7281, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 18.24% 

Test Accuracy: 18.00% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.24667677283287048
distance x is tensor(162.2889, device='cuda:3')
benign distance is  tensor(162.2889, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9095432162284851
distance x is tensor(152.6337, device='cuda:3')
benign distance is  tensor(152.6337, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.11243705451488495
distance x is tensor(156.6206, device='cuda:3')
benign distance is  tensor(156.6206, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5548016428947449
distance x is tensor(172.0831, device='cuda:3')
benign distance is  tensor(172.0831, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6286932826042175
distance x is tensor(154.8676, device='cuda:3')
benign distance is  tensor(154.8676, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7851585149765015
distance x is tensor(168.8863, device='cuda:3')
benign distance is  tensor(168.8863, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.715310275554657
distance x is tensor(164.7718, device='cuda:3')
benign distance is  tensor(164.7718, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.30474528670310974
distance x is tensor(164.6464, device='cuda:3')
benign distance is  tensor(164.6464, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(159.4346, device='cuda:3')
compute distance is  tensor(159.4346, device='cuda:3')
compute norm is  tensor(44.5786, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.3624, device='cuda:3')
compute distance is  tensor(165.3624, device='cuda:3')
compute norm is  tensor(44.6714, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.4463, device='cuda:3')
compute distance is  tensor(158.4463, device='cuda:3')
compute norm is  tensor(44.7362, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.0607, device='cuda:3')
compute distance is  tensor(164.0607, device='cuda:3')
compute norm is  tensor(45.0156, device='cuda:3', dtype=torch.float64)
distance x is tensor(168.8882, device='cuda:3')
compute distance is  tensor(168.8882, device='cuda:3')
compute norm is  tensor(44.8482, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.1515, device='cuda:3')
compute distance is  tensor(161.1515, device='cuda:3')
compute norm is  tensor(44.7858, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.5608, device='cuda:3')
compute distance is  tensor(158.5608, device='cuda:3')
compute norm is  tensor(44.5460, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.2591, device='cuda:3')
compute distance is  tensor(170.2591, device='cuda:3')
compute norm is  tensor(44.8413, device='cuda:3', dtype=torch.float64)
distance x is tensor(168.0734, device='cuda:3')
compute distance is  tensor(168.0734, device='cuda:3')
compute norm is  tensor(44.8269, device='cuda:3', dtype=torch.float64)
distance x is tensor(156.1582, device='cuda:3')
compute distance is  tensor(156.1582, device='cuda:3')
compute norm is  tensor(44.6487, device='cuda:3', dtype=torch.float64)
distance x is tensor(169.7215, device='cuda:3')
compute distance is  tensor(169.7215, device='cuda:3')
compute norm is  tensor(45.0619, device='cuda:3', dtype=torch.float64)
distance x is tensor(166.3699, device='cuda:3')
compute distance is  tensor(166.3699, device='cuda:3')
compute norm is  tensor(44.8319, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(170.2591, device='cuda:3')
distance x is tensor(107640.9766, device='cuda:3')
distance x is tensor(107640.9766, device='cuda:3')
________________________________
test distance is  tensor(107640.9766, device='cuda:3')
test distance1 is  tensor(107640.9766, device='cuda:3')
test similarity is  tensor(0.1656, device='cuda:3')
test acc is  0.10000000015633198
test loss is 129996974039302.0
test entropy is  0.0
________________________________
cal ratio is  0.03897556392116794
distance x is tensor(4195.3735, device='cuda:3')
cal_distance is  tensor(4195.3735, device='cuda:3')
cal ratio is  0.1974221581169064
distance x is tensor(828.2639, device='cuda:3')
cal_distance is  tensor(828.2639, device='cuda:3')
cal ratio is  0.444321019130571
distance x is tensor(368.0179, device='cuda:3')
cal_distance is  tensor(368.0179, device='cuda:3')
cal ratio is  0.6665715141867231
distance x is tensor(245.3120, device='cuda:3')
cal_distance is  tensor(245.3120, device='cuda:3')
cal ratio is  0.8164354448418915
distance x is tensor(200.2823, device='cuda:3')
cal_distance is  tensor(200.2823, device='cuda:3')
cal ratio is  0.9035660222334432
distance x is tensor(180.9688, device='cuda:3')
cal_distance is  tensor(180.9688, device='cuda:3')
cal ratio is  0.9505596362383146
distance x is tensor(172.0219, device='cuda:3')
cal_distance is  tensor(172.0219, device='cuda:3')
cal ratio is  0.9749656926501504
distance x is tensor(167.7156, device='cuda:3')
cal_distance is  tensor(167.7156, device='cuda:3')
distance x is tensor(167.7156, device='cuda:3')
return_distance is  tensor(167.7156, device='cuda:3')
distance x is tensor(167.7053, device='cuda:3')
distance x is tensor(167.7053, device='cuda:3')
________________________________
test distance is  tensor(167.7053, device='cuda:3')
test distance1 is  tensor(167.7053, device='cuda:3')
test similarity is  tensor(0.9231, device='cuda:3')
test acc is  0.10000000015633198
test loss is 1264.470100842051
test entropy is  0.0
________________________________
0
distance x is tensor(167.7053, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  1265.292867697124
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9231, device='cuda:3')
compute_distance is  tensor(167.7053, device='cuda:3')
compute_norm is  tensor(46.2685, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(875.6603, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5817556157549306
avg test loss is  2.857062614040334
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4228, device='cuda:3')
compute_distance is  tensor(875.6603, device='cuda:3')
compute_norm is  tensor(98.0400, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(872.3234, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8529885592364045
avg test loss is  3.6193457346226867
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4231, device='cuda:3')
compute_distance is  tensor(872.3234, device='cuda:3')
compute_norm is  tensor(97.9701, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(868.0648, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5613323143804505
avg test loss is  2.858217260984978
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4228, device='cuda:3')
compute_distance is  tensor(868.0648, device='cuda:3')
compute_norm is  tensor(97.1392, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(864.7935, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8479544726897404
avg test loss is  3.60563726923359
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4231, device='cuda:3')
compute_distance is  tensor(864.7935, device='cuda:3')
compute_norm is  tensor(97.0740, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(860.5793, device='cuda:3')
distance x is tensor(860.5793, device='cuda:3')
________________________________
test distance is  tensor(860.5793, device='cuda:3')
test distance1 is  tensor(860.5793, device='cuda:3')
test similarity is  tensor(0.4227, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8580144529403655
test entropy is  1.5572358789220293
________________________________
cal ratio is  0.4358988931371306
distance x is tensor(375.1271, device='cuda:3')
cal_distance is  tensor(375.1271, device='cuda:3')
cal ratio is  0.6602250081297151
distance x is tensor(247.6687, device='cuda:3')
cal_distance is  tensor(247.6687, device='cuda:3')
cal ratio is  0.8125416883630953
distance x is tensor(201.2413, device='cuda:3')
cal_distance is  tensor(201.2413, device='cuda:3')
cal ratio is  0.901410500484502
distance x is tensor(181.4011, device='cuda:3')
cal_distance is  tensor(181.4011, device='cuda:3')
cal ratio is  0.9494261906266491
distance x is tensor(172.2271, device='cuda:3')
cal_distance is  tensor(172.2271, device='cuda:3')
cal ratio is  0.9743847777369706
distance x is tensor(167.8155, device='cuda:3')
cal_distance is  tensor(167.8155, device='cuda:3')
distance x is tensor(167.8155, device='cuda:3')
return_distance is  tensor(167.8155, device='cuda:3')
distance x is tensor(167.8133, device='cuda:3')
distance x is tensor(167.8133, device='cuda:3')
________________________________
test distance is  tensor(167.8133, device='cuda:3')
test distance1 is  tensor(167.8133, device='cuda:3')
test similarity is  tensor(0.9065, device='cuda:3')
test acc is  0.1010833334896653
test loss is 2.5259122284236493
test entropy is  2.001757144165446
________________________________
0
distance x is tensor(167.8133, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.0011541382081983
avg test loss is  2.5276123201414973
avg accuracy is  0.12511666682299857
solo acc is  0.10120000015633199
compute similarity  is  tensor(0.9065, device='cuda:3')
compute_distance is  tensor(167.8133, device='cuda:3')
compute_norm is  tensor(48.0697, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(169.0069, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7073995227625629
avg test loss is  2.797755644011345
avg accuracy is  0.11298333348966527
solo acc is  0.10386666682299864
compute similarity  is  tensor(0.9064, device='cuda:3')
compute_distance is  tensor(169.0069, device='cuda:3')
compute_norm is  tensor(47.9622, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(171.5744, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0836080065541176
avg test loss is  1.7190221058788584
avg accuracy is  0.14276666682299916
solo acc is  0.19555000015633606
compute similarity  is  tensor(0.9058, device='cuda:3')
compute_distance is  tensor(171.5744, device='cuda:3')
compute_norm is  tensor(47.7330, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(171.6135, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6022205234908345
avg test loss is  2.5890614485689825
avg accuracy is  0.11690000015633192
solo acc is  0.10240000015633197
compute similarity  is  tensor(0.9055, device='cuda:3')
compute_distance is  tensor(171.6135, device='cuda:3')
compute_norm is  tensor(47.5833, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(173.3464, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0604104955059124
avg test loss is  1.5871917642255835
avg accuracy is  0.15280000015633338
solo acc is  0.2118166668230035
compute similarity  is  tensor(0.9050, device='cuda:3')
compute_distance is  tensor(173.3464, device='cuda:3')
compute_norm is  tensor(47.3646, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(173.3604, device='cuda:3')
distance x is tensor(173.3604, device='cuda:3')
________________________________
test distance is  tensor(173.3604, device='cuda:3')
test distance1 is  tensor(173.3604, device='cuda:3')
test similarity is  tensor(0.9048, device='cuda:3')
test acc is  0.10226666682299863
test loss is 2.3699314366779856
test entropy is  0.6270643601031192
________________________________
cal ratio is  0.9711944979196996
distance x is tensor(168.3669, device='cuda:3')
cal_distance is  tensor(168.3669, device='cuda:3')
distance x is tensor(168.3669, device='cuda:3')
return_distance is  tensor(168.3669, device='cuda:3')
distance x is tensor(168.3667, device='cuda:3')
distance x is tensor(168.3667, device='cuda:3')
________________________________
test distance is  tensor(168.3667, device='cuda:3')
test distance1 is  tensor(168.3667, device='cuda:3')
test similarity is  tensor(0.9095, device='cuda:3')
test acc is  0.10295000015633197
test loss is 2.3722370869315257
test entropy is  0.6273270000908167
________________________________
0
distance x is tensor(168.3667, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6247940276350293
avg test loss is  2.3726127230282277
avg accuracy is  0.11933333348966525
solo acc is  0.10285000015633197
compute similarity  is  tensor(0.9095, device='cuda:3')
compute_distance is  tensor(168.3667, device='cuda:3')
compute_norm is  tensor(46.9751, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(170.0730, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0658466994508242
avg test loss is  1.5433009995072127
avg accuracy is  0.1548666668230002
solo acc is  0.18773333348966906
compute similarity  is  tensor(0.9088, device='cuda:3')
compute_distance is  tensor(170.0730, device='cuda:3')
compute_norm is  tensor(46.7620, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(170.2579, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6433925148901909
avg test loss is  2.2753331387983455
avg accuracy is  0.12115000015633193
solo acc is  0.1015833334896653
compute similarity  is  tensor(0.9086, device='cuda:3')
compute_distance is  tensor(170.2579, device='cuda:3')
compute_norm is  tensor(46.6041, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(171.9063, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.977595856131267
avg test loss is  1.4669453455949388
avg accuracy is  0.16153333348966742
solo acc is  0.2254500001563374
compute similarity  is  tensor(0.9079, device='cuda:3')
compute_distance is  tensor(171.9063, device='cuda:3')
compute_norm is  tensor(46.3872, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(171.9061, device='cuda:3')
________________________________
test distance is  tensor(171.9061, device='cuda:3')
test similarity is  tensor(0.9079, device='cuda:3')
test acc is  0.16201666682300078
test loss is 1.465560876865631
test entropy is  0.976977493399496
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.208129644393921
mal norm is  tensor(863.6824, device='cuda:3')
distance x is tensor(171.9061, device='cuda:3')
mal distance is  tensor(171.9061, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([12.,  0., 20., 14., 13., 12., 12., 23., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 15., 12., 12., 22., 27., 12., 12.])
count_res tensor([2.9810e-07, 1.8316e-12, 8.8862e-04, 2.2027e-06, 8.1032e-07, 2.9810e-07,
        2.9810e-07, 1.7848e-02, 1.6276e-05, 1.6276e-05, 1.6276e-05, 1.6276e-05,
        1.6276e-05, 1.6276e-05, 1.6276e-05, 1.6276e-05, 1.6276e-05, 1.6276e-05,
        1.6276e-05, 1.6276e-05, 2.9810e-07, 5.9875e-06, 2.9810e-07, 2.9810e-07,
        6.5661e-03, 9.7449e-01, 2.9810e-07, 2.9810e-07])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 86.95% 

Test Accuracy: 85.85% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.49742889404296875
distance x is tensor(141.5146, device='cuda:3')
benign distance is  tensor(141.5146, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0820499658584595
distance x is tensor(138.6539, device='cuda:3')
benign distance is  tensor(138.6539, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.09387265890836716
distance x is tensor(141.3163, device='cuda:3')
benign distance is  tensor(141.3163, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.35669034719467163
distance x is tensor(139.7588, device='cuda:3')
benign distance is  tensor(139.7588, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8805649876594543
distance x is tensor(129.8634, device='cuda:3')
benign distance is  tensor(129.8634, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.788257360458374
distance x is tensor(135.3207, device='cuda:3')
benign distance is  tensor(135.3207, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2484593391418457
distance x is tensor(141.7049, device='cuda:3')
benign distance is  tensor(141.7049, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5789793133735657
distance x is tensor(138.3999, device='cuda:3')
benign distance is  tensor(138.3999, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.25159579515457153
distance x is tensor(151.7528, device='cuda:3')
benign distance is  tensor(151.7528, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6626370549201965
distance x is tensor(147.2434, device='cuda:3')
benign distance is  tensor(147.2434, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8447310328483582
distance x is tensor(142.4606, device='cuda:3')
benign distance is  tensor(142.4606, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.8046026229858398
distance x is tensor(136.0746, device='cuda:3')
benign distance is  tensor(136.0746, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.43522748351097107
distance x is tensor(134.7066, device='cuda:3')
benign distance is  tensor(134.7066, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.352108359336853
distance x is tensor(99.1419, device='cuda:3')
benign distance is  tensor(99.1419, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.39216136932373047
distance x is tensor(151.2177, device='cuda:3')
benign distance is  tensor(151.2177, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.367747962474823
distance x is tensor(154.2880, device='cuda:3')
benign distance is  tensor(154.2880, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(139.1043, device='cuda:3')
compute distance is  tensor(139.1043, device='cuda:3')
compute norm is  tensor(47.6987, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.4312, device='cuda:3')
compute distance is  tensor(137.4312, device='cuda:3')
compute norm is  tensor(47.7507, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.2929, device='cuda:3')
compute distance is  tensor(140.2929, device='cuda:3')
compute norm is  tensor(47.9128, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.4160, device='cuda:3')
compute distance is  tensor(131.4160, device='cuda:3')
compute norm is  tensor(47.7514, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.3696, device='cuda:3')
compute distance is  tensor(139.3696, device='cuda:3')
compute norm is  tensor(47.9131, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.9603, device='cuda:3')
compute distance is  tensor(143.9603, device='cuda:3')
compute norm is  tensor(47.8300, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.1002, device='cuda:3')
compute distance is  tensor(137.1002, device='cuda:3')
compute norm is  tensor(47.7562, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.5709, device='cuda:3')
compute distance is  tensor(132.5709, device='cuda:3')
compute norm is  tensor(47.6209, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.1759, device='cuda:3')
compute distance is  tensor(152.1759, device='cuda:3')
compute norm is  tensor(48.1506, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.2888, device='cuda:3')
compute distance is  tensor(130.2888, device='cuda:3')
compute norm is  tensor(47.6795, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.1076, device='cuda:3')
compute distance is  tensor(141.1076, device='cuda:3')
compute norm is  tensor(47.9647, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.5014, device='cuda:3')
compute distance is  tensor(141.5014, device='cuda:3')
compute norm is  tensor(47.8080, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(152.1759, device='cuda:3')
distance x is tensor(107724.4297, device='cuda:3')
distance x is tensor(107724.4297, device='cuda:3')
________________________________
test distance is  tensor(107724.4297, device='cuda:3')
test distance1 is  tensor(107724.4297, device='cuda:3')
test similarity is  tensor(-0.1000, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130056449538314.38
test entropy is  0.0
________________________________
cal ratio is  0.03683341319851774
distance x is tensor(3967.8640, device='cuda:3')
cal_distance is  tensor(3967.8640, device='cuda:3')
cal ratio is  0.1919201979422177
distance x is tensor(761.5173, device='cuda:3')
cal_distance is  tensor(761.5173, device='cuda:3')
cal ratio is  0.4380857914700309
distance x is tensor(333.6129, device='cuda:3')
cal_distance is  tensor(333.6129, device='cuda:3')
cal ratio is  0.6618775817417298
distance x is tensor(220.8127, device='cuda:3')
cal_distance is  tensor(220.8127, device='cuda:3')
cal ratio is  0.8135553026574784
distance x is tensor(179.6443, device='cuda:3')
cal_distance is  tensor(179.6443, device='cuda:3')
cal ratio is  0.9019706015564379
distance x is tensor(162.0344, device='cuda:3')
cal_distance is  tensor(162.0344, device='cuda:3')
cal ratio is  0.9497198050911305
distance x is tensor(153.8875, device='cuda:3')
cal_distance is  tensor(153.8875, device='cuda:3')
cal ratio is  0.9745348409464532
distance x is tensor(149.9689, device='cuda:3')
cal_distance is  tensor(149.9689, device='cuda:3')
distance x is tensor(149.9689, device='cuda:3')
return_distance is  tensor(149.9689, device='cuda:3')
distance x is tensor(149.9585, device='cuda:3')
distance x is tensor(149.9585, device='cuda:3')
________________________________
test distance is  tensor(149.9585, device='cuda:3')
test distance1 is  tensor(149.9585, device='cuda:3')
test similarity is  tensor(0.9339, device='cuda:3')
test acc is  0.10013333348966531
test loss is 443.5554092830178
test entropy is  1.8241766260064047e-05
________________________________
0
distance x is tensor(149.9585, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  4.7230668169022064e-05
avg test loss is  443.30635542554387
avg accuracy is  0.17795000015633516
solo acc is  0.10010000015633198
compute similarity  is  tensor(0.9339, device='cuda:3')
compute_distance is  tensor(149.9585, device='cuda:3')
compute_norm is  tensor(46.7226, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(125.5632, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9820537478811959
avg test loss is  1.5161919464180464
avg accuracy is  0.7550666668229943
solo acc is  0.3316166668230068
compute similarity  is  tensor(0.9431, device='cuda:3')
compute_distance is  tensor(125.5632, device='cuda:3')
compute_norm is  tensor(45.6509, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(125.5632, device='cuda:3')
distance x is tensor(125.5632, device='cuda:3')
________________________________
test distance is  tensor(125.5632, device='cuda:3')
test distance1 is  tensor(125.5632, device='cuda:3')
test similarity is  tensor(0.9431, device='cuda:3')
test acc is  0.33425000015634015
test loss is 1.5164880165413244
test entropy is  0.9824957896524401
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.376570224761963
mal norm is  tensor(700.0184, device='cuda:3')
distance x is tensor(125.5716, device='cuda:3')
mal distance is  tensor(125.5716, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([12., 12., 27., 27., 12., 12., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 14.,  0., 12., 12., 12., 12., 13., 27.])
count_res tensor([1.0196e-07, 1.0196e-07, 3.3331e-01, 3.3331e-01, 1.0196e-07, 1.0196e-07,
        1.0196e-07, 1.0196e-07, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06,
        5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06,
        5.5668e-06, 5.5668e-06, 7.5339e-07, 6.2647e-13, 1.0196e-07, 1.0196e-07,
        1.0196e-07, 1.0196e-07, 2.7716e-07, 3.3331e-01])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 88.48% 

Test Accuracy: 87.73% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.6065635681152344
distance x is tensor(132.3272, device='cuda:3')
benign distance is  tensor(132.3272, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.629700779914856
distance x is tensor(130.6019, device='cuda:3')
benign distance is  tensor(130.6019, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.22670873999595642
distance x is tensor(107.2136, device='cuda:3')
benign distance is  tensor(107.2136, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5827072262763977
distance x is tensor(98.1592, device='cuda:3')
benign distance is  tensor(98.1592, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7780532836914062
distance x is tensor(126.4499, device='cuda:3')
benign distance is  tensor(126.4499, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.18192404508590698
distance x is tensor(128.4865, device='cuda:3')
benign distance is  tensor(128.4865, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6518362164497375
distance x is tensor(125.6653, device='cuda:3')
benign distance is  tensor(125.6653, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.32795897126197815
distance x is tensor(125.4458, device='cuda:3')
benign distance is  tensor(125.4458, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.15879611670970917
distance x is tensor(134.8138, device='cuda:3')
benign distance is  tensor(134.8138, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8219881057739258
distance x is tensor(151.0718, device='cuda:3')
benign distance is  tensor(151.0718, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5287051796913147
distance x is tensor(133.8751, device='cuda:3')
benign distance is  tensor(133.8751, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2815787196159363
distance x is tensor(131.3730, device='cuda:3')
benign distance is  tensor(131.3730, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.23039576411247253
distance x is tensor(132.1430, device='cuda:3')
benign distance is  tensor(132.1430, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.14561036229133606
distance x is tensor(132.2578, device='cuda:3')
benign distance is  tensor(132.2578, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.8349235653877258
distance x is tensor(142.6773, device='cuda:3')
benign distance is  tensor(142.6773, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.24340681731700897
distance x is tensor(118.8603, device='cuda:3')
benign distance is  tensor(118.8603, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(127.0244, device='cuda:3')
compute distance is  tensor(127.0244, device='cuda:3')
compute norm is  tensor(47.6433, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.2635, device='cuda:3')
compute distance is  tensor(120.2635, device='cuda:3')
compute norm is  tensor(47.4763, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.8465, device='cuda:3')
compute distance is  tensor(133.8465, device='cuda:3')
compute norm is  tensor(47.7410, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.2579, device='cuda:3')
compute distance is  tensor(122.2579, device='cuda:3')
compute norm is  tensor(47.4795, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.1209, device='cuda:3')
compute distance is  tensor(128.1209, device='cuda:3')
compute norm is  tensor(47.6301, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.8261, device='cuda:3')
compute distance is  tensor(133.8261, device='cuda:3')
compute norm is  tensor(47.6866, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.7446, device='cuda:3')
compute distance is  tensor(119.7446, device='cuda:3')
compute norm is  tensor(47.5320, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.8132, device='cuda:3')
compute distance is  tensor(119.8132, device='cuda:3')
compute norm is  tensor(47.3648, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.0242, device='cuda:3')
compute distance is  tensor(120.0242, device='cuda:3')
compute norm is  tensor(47.5152, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.5679, device='cuda:3')
compute distance is  tensor(122.5679, device='cuda:3')
compute norm is  tensor(47.5184, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.4172, device='cuda:3')
compute distance is  tensor(137.4172, device='cuda:3')
compute norm is  tensor(47.7989, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.6894, device='cuda:3')
compute distance is  tensor(126.6894, device='cuda:3')
compute norm is  tensor(47.4810, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(137.4172, device='cuda:3')
distance x is tensor(107721.7031, device='cuda:3')
distance x is tensor(107721.7031, device='cuda:3')
________________________________
test distance is  tensor(107721.7031, device='cuda:3')
test distance1 is  tensor(107721.7031, device='cuda:3')
test similarity is  tensor(-0.1030, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130028201848840.73
test entropy is  0.0
________________________________
cal ratio is  0.03500217658218977
distance x is tensor(3770.4995, device='cuda:3')
cal_distance is  tensor(3770.4995, device='cuda:3')
cal ratio is  0.18708854681613446
distance x is tensor(705.4214, device='cuda:3')
cal_distance is  tensor(705.4214, device='cuda:3')
cal ratio is  0.43253607418957596
distance x is tensor(305.1232, device='cuda:3')
cal_distance is  tensor(305.1232, device='cuda:3')
cal ratio is  0.6576715294478445
distance x is tensor(200.6726, device='cuda:3')
cal_distance is  tensor(200.6726, device='cuda:3')
cal ratio is  0.8109658995784021
distance x is tensor(162.7396, device='cuda:3')
cal_distance is  tensor(162.7396, device='cuda:3')
cal ratio is  0.9005337333630395
distance x is tensor(146.5531, device='cuda:3')
cal_distance is  tensor(146.5531, device='cuda:3')
cal ratio is  0.9489628118513321
distance x is tensor(139.0737, device='cuda:3')
cal_distance is  tensor(139.0737, device='cuda:3')
cal ratio is  0.9741462856528725
distance x is tensor(135.4783, device='cuda:3')
cal_distance is  tensor(135.4783, device='cuda:3')
distance x is tensor(135.4783, device='cuda:3')
return_distance is  tensor(135.4783, device='cuda:3')
distance x is tensor(135.4679, device='cuda:3')
distance x is tensor(135.4679, device='cuda:3')
________________________________
test distance is  tensor(135.4679, device='cuda:3')
test distance1 is  tensor(135.4679, device='cuda:3')
test similarity is  tensor(0.9446, device='cuda:3')
test acc is  0.10031666682299864
test loss is 325.29913048652696
test entropy is  9.848754629030822e-05
________________________________
0
distance x is tensor(135.4679, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  6.799972967354966e-05
avg test loss is  325.200077666911
avg accuracy is  0.23803333348967123
solo acc is  0.10020000015633199
compute similarity  is  tensor(0.9446, device='cuda:3')
compute_distance is  tensor(135.4679, device='cuda:3')
compute_norm is  tensor(46.3402, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(115.5903, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9027728034235013
avg test loss is  1.584895528455787
avg accuracy is  0.7941000001563258
solo acc is  0.308933333489673
compute similarity  is  tensor(0.9515, device='cuda:3')
compute_distance is  tensor(115.5903, device='cuda:3')
compute_norm is  tensor(45.2414, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(115.5903, device='cuda:3')
distance x is tensor(115.5903, device='cuda:3')
________________________________
test distance is  tensor(115.5903, device='cuda:3')
test distance1 is  tensor(115.5903, device='cuda:3')
test similarity is  tensor(0.9515, device='cuda:3')
test acc is  0.3095500001563397
test loss is 1.5820745114070267
test entropy is  0.9015976805676783
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.7912206649780273
mal norm is  tensor(638.9529, device='cuda:3')
distance x is tensor(115.5987, device='cuda:3')
mal distance is  tensor(115.5987, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([12., 12., 34., 12., 29., 21., 28., 21., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 16., 13., 12., 12., 34., 12., 24., 32.,
        26.,  0., 14., 35., 12., 13.,  0., 12.])
count_res tensor([5.7352e-11, 5.7352e-11, 2.0560e-01, 5.7352e-11, 1.3853e-03, 4.6473e-07,
        5.0964e-04, 4.6473e-07, 9.3343e-06, 9.3343e-06, 9.3343e-06, 9.3343e-06,
        9.3343e-06, 9.3343e-06, 9.3343e-06, 9.3343e-06, 9.3343e-06, 9.3343e-06,
        9.3343e-06, 9.3343e-06, 3.1313e-09, 1.5590e-10, 5.7352e-11, 5.7352e-11,
        2.0560e-01, 5.7352e-11, 9.3343e-06, 2.7825e-02, 6.8972e-05, 3.5238e-16,
        4.2378e-10, 5.5888e-01, 5.7352e-11, 1.5590e-10, 3.5238e-16, 5.7352e-11])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 88.24% 

Test Accuracy: 87.50% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2667526304721832
distance x is tensor(120.8329, device='cuda:3')
benign distance is  tensor(120.8329, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1016019582748413
distance x is tensor(124.2529, device='cuda:3')
benign distance is  tensor(124.2529, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.23586025834083557
distance x is tensor(129.2937, device='cuda:3')
benign distance is  tensor(129.2937, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2216935157775879
distance x is tensor(112.6595, device='cuda:3')
benign distance is  tensor(112.6595, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0466965436935425
distance x is tensor(122.6050, device='cuda:3')
benign distance is  tensor(122.6050, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7472397685050964
distance x is tensor(125.8640, device='cuda:3')
benign distance is  tensor(125.8640, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6965619921684265
distance x is tensor(135.1072, device='cuda:3')
benign distance is  tensor(135.1072, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.46664875745773315
distance x is tensor(120.5180, device='cuda:3')
benign distance is  tensor(120.5180, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4438132643699646
distance x is tensor(145.5310, device='cuda:3')
benign distance is  tensor(145.5310, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6335940361022949
distance x is tensor(137.8437, device='cuda:3')
benign distance is  tensor(137.8437, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4328921437263489
distance x is tensor(136.6182, device='cuda:3')
benign distance is  tensor(136.6182, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5817822813987732
distance x is tensor(103.1982, device='cuda:3')
benign distance is  tensor(103.1982, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0200132131576538
distance x is tensor(129.8457, device='cuda:3')
benign distance is  tensor(129.8457, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3735843300819397
distance x is tensor(120.1422, device='cuda:3')
benign distance is  tensor(120.1422, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7512176632881165
distance x is tensor(144.4765, device='cuda:3')
benign distance is  tensor(144.4765, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5678313970565796
distance x is tensor(141.8331, device='cuda:3')
benign distance is  tensor(141.8331, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.2155255526304245
distance x is tensor(142.8136, device='cuda:3')
benign distance is  tensor(142.8136, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.571064293384552
distance x is tensor(128.4205, device='cuda:3')
benign distance is  tensor(128.4205, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.21582886576652527
distance x is tensor(141.4749, device='cuda:3')
benign distance is  tensor(141.4749, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.7515875101089478
distance x is tensor(137.7307, device='cuda:3')
benign distance is  tensor(137.7307, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6015612483024597
distance x is tensor(128.1375, device='cuda:3')
benign distance is  tensor(128.1375, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.4809120297431946
distance x is tensor(139.5922, device='cuda:3')
benign distance is  tensor(139.5922, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.46034684777259827
distance x is tensor(129.3891, device='cuda:3')
benign distance is  tensor(129.3891, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.29690098762512207
distance x is tensor(137.8335, device='cuda:3')
benign distance is  tensor(137.8335, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(112.9358, device='cuda:3')
compute distance is  tensor(112.9358, device='cuda:3')
compute norm is  tensor(47.4832, device='cuda:3', dtype=torch.float64)
distance x is tensor(106.6459, device='cuda:3')
compute distance is  tensor(106.6459, device='cuda:3')
compute norm is  tensor(47.4094, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.7189, device='cuda:3')
compute distance is  tensor(128.7189, device='cuda:3')
compute norm is  tensor(47.8458, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.0292, device='cuda:3')
compute distance is  tensor(118.0292, device='cuda:3')
compute norm is  tensor(47.6421, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.8172, device='cuda:3')
compute distance is  tensor(136.8172, device='cuda:3')
compute norm is  tensor(47.9000, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.5077, device='cuda:3')
compute distance is  tensor(131.5077, device='cuda:3')
compute norm is  tensor(47.9896, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.1906, device='cuda:3')
compute distance is  tensor(124.1906, device='cuda:3')
compute norm is  tensor(47.7187, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.3438, device='cuda:3')
compute distance is  tensor(131.3438, device='cuda:3')
compute norm is  tensor(47.7692, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.6994, device='cuda:3')
compute distance is  tensor(125.6994, device='cuda:3')
compute norm is  tensor(47.8952, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.9373, device='cuda:3')
compute distance is  tensor(123.9373, device='cuda:3')
compute norm is  tensor(47.7469, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.2146, device='cuda:3')
compute distance is  tensor(136.2146, device='cuda:3')
compute norm is  tensor(48.0742, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.0781, device='cuda:3')
compute distance is  tensor(124.0781, device='cuda:3')
compute norm is  tensor(47.7683, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(136.8172, device='cuda:3')
distance x is tensor(107719.7422, device='cuda:3')
distance x is tensor(107719.7422, device='cuda:3')
________________________________
test distance is  tensor(107719.7422, device='cuda:3')
test distance1 is  tensor(107719.7422, device='cuda:3')
test similarity is  tensor(-0.1032, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130153417554116.5
test entropy is  0.0
________________________________
cal ratio is  0.034925998957216445
distance x is tensor(3762.2249, device='cuda:3')
cal_distance is  tensor(3762.2249, device='cuda:3')
cal ratio is  0.18688485779804595
distance x is tensor(703.1071, device='cuda:3')
cal_distance is  tensor(703.1071, device='cuda:3')
cal ratio is  0.4323005339237775
distance x is tensor(303.9565, device='cuda:3')
cal_distance is  tensor(303.9565, device='cuda:3')
cal ratio is  0.6574924184721075
distance x is tensor(199.8509, device='cuda:3')
cal_distance is  tensor(199.8509, device='cuda:3')
cal ratio is  0.8108554574408878
distance x is tensor(162.0512, device='cuda:3')
cal_distance is  tensor(162.0512, device='cuda:3')
cal ratio is  0.9004723572547064
distance x is tensor(145.9231, device='cuda:3')
cal_distance is  tensor(145.9231, device='cuda:3')
cal ratio is  0.9489305988129412
distance x is tensor(138.4712, device='cuda:3')
cal_distance is  tensor(138.4712, device='cuda:3')
cal ratio is  0.9741297435711085
distance x is tensor(134.8891, device='cuda:3')
cal_distance is  tensor(134.8891, device='cuda:3')
distance x is tensor(134.8891, device='cuda:3')
return_distance is  tensor(134.8891, device='cuda:3')
distance x is tensor(134.8787, device='cuda:3')
distance x is tensor(134.8787, device='cuda:3')
________________________________
test distance is  tensor(134.8787, device='cuda:3')
test distance1 is  tensor(134.8787, device='cuda:3')
test similarity is  tensor(0.9456, device='cuda:3')
test acc is  0.10008333348966532
test loss is 343.0169846914979
test entropy is  5.53320766350822e-05
________________________________
0
distance x is tensor(134.8787, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.6605584567030222e-05
avg test loss is  343.1998275073607
avg accuracy is  0.3211333334896732
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9456, device='cuda:3')
compute_distance is  tensor(134.8787, device='cuda:3')
compute_norm is  tensor(46.5830, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(114.9331, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9494495372146939
avg test loss is  1.5230934649133987
avg accuracy is  0.8186666668229914
solo acc is  0.32838333348967336
compute similarity  is  tensor(0.9524, device='cuda:3')
compute_distance is  tensor(114.9331, device='cuda:3')
compute_norm is  tensor(45.4528, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.6170, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9143962034030255
avg test loss is  1.5650550629030158
avg accuracy is  0.8194333334896579
solo acc is  0.27681666682300554
compute similarity  is  tensor(0.9519, device='cuda:3')
compute_distance is  tensor(117.6170, device='cuda:3')
compute_norm is  tensor(45.1421, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(119.8645, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8914076422831652
avg test loss is  1.5472088487926068
avg accuracy is  0.8227333334896577
solo acc is  0.26396666682300524
compute similarity  is  tensor(0.9514, device='cuda:3')
compute_distance is  tensor(119.8645, device='cuda:3')
compute_norm is  tensor(44.8621, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(122.0490, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8738171388345487
avg test loss is  1.5077082097911632
avg accuracy is  0.8275666668229908
solo acc is  0.26505000015633867
compute similarity  is  tensor(0.9509, device='cuda:3')
compute_distance is  tensor(122.0490, device='cuda:3')
compute_norm is  tensor(44.5988, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(124.1368, device='cuda:3')
distance x is tensor(124.1368, device='cuda:3')
________________________________
test distance is  tensor(124.1368, device='cuda:3')
test distance1 is  tensor(124.1368, device='cuda:3')
test similarity is  tensor(0.9505, device='cuda:3')
test acc is  0.2706000001563388
test loss is 1.4640986287771767
test entropy is  0.8744922111918931
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.3830921649932861
mal norm is  tensor(644.5631, device='cuda:3')
distance x is tensor(124.1444, device='cuda:3')
mal distance is  tensor(124.1444, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([12., 27., 12., 12., 12., 12., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 15., 12., 27., 12., 12., 13., 12., 26.])
count_res tensor([1.2918e-07, 4.2228e-01, 1.2918e-07, 1.2918e-07, 1.2918e-07, 1.2918e-07,
        1.2918e-07, 1.2918e-07, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06,
        7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06,
        7.0528e-06, 7.0528e-06, 2.5946e-06, 1.2918e-07, 4.2228e-01, 1.2918e-07,
        1.2918e-07, 3.5114e-07, 1.2918e-07, 1.5535e-01])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 88.94% 

Test Accuracy: 88.29% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4393945634365082
distance x is tensor(110.4727, device='cuda:3')
benign distance is  tensor(110.4727, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.494255930185318
distance x is tensor(96.9805, device='cuda:3')
benign distance is  tensor(96.9805, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2987210154533386
distance x is tensor(124.9769, device='cuda:3')
benign distance is  tensor(124.9769, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.930794894695282
distance x is tensor(125.5338, device='cuda:3')
benign distance is  tensor(125.5338, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4377400875091553
distance x is tensor(115.3284, device='cuda:3')
benign distance is  tensor(115.3284, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9569608569145203
distance x is tensor(130.9172, device='cuda:3')
benign distance is  tensor(130.9172, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5345795750617981
distance x is tensor(134.1820, device='cuda:3')
benign distance is  tensor(134.1820, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3026010990142822
distance x is tensor(121.7404, device='cuda:3')
benign distance is  tensor(121.7404, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.41006526350975037
distance x is tensor(132.9697, device='cuda:3')
benign distance is  tensor(132.9697, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.13931962847709656
distance x is tensor(134.7439, device='cuda:3')
benign distance is  tensor(134.7439, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.09484781324863434
distance x is tensor(113.6097, device='cuda:3')
benign distance is  tensor(113.6097, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.19256803393363953
distance x is tensor(132.3047, device='cuda:3')
benign distance is  tensor(132.3047, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4975464940071106
distance x is tensor(132.2024, device='cuda:3')
benign distance is  tensor(132.2024, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.28477439284324646
distance x is tensor(125.7428, device='cuda:3')
benign distance is  tensor(125.7428, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.671538770198822
distance x is tensor(130.8947, device='cuda:3')
benign distance is  tensor(130.8947, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.045939475297927856
distance x is tensor(130.9343, device='cuda:3')
benign distance is  tensor(130.9343, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(119.8069, device='cuda:3')
compute distance is  tensor(119.8069, device='cuda:3')
compute norm is  tensor(47.0498, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.6754, device='cuda:3')
compute distance is  tensor(119.6754, device='cuda:3')
compute norm is  tensor(47.1288, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.6143, device='cuda:3')
compute distance is  tensor(126.6143, device='cuda:3')
compute norm is  tensor(47.4624, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.2073, device='cuda:3')
compute distance is  tensor(123.2073, device='cuda:3')
compute norm is  tensor(47.3243, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.3112, device='cuda:3')
compute distance is  tensor(132.3112, device='cuda:3')
compute norm is  tensor(47.4208, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.4755, device='cuda:3')
compute distance is  tensor(122.4755, device='cuda:3')
compute norm is  tensor(47.2224, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.7499, device='cuda:3')
compute distance is  tensor(120.7499, device='cuda:3')
compute norm is  tensor(47.1641, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.3900, device='cuda:3')
compute distance is  tensor(116.3900, device='cuda:3')
compute norm is  tensor(47.1318, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.8220, device='cuda:3')
compute distance is  tensor(124.8220, device='cuda:3')
compute norm is  tensor(47.2444, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.7885, device='cuda:3')
compute distance is  tensor(131.7885, device='cuda:3')
compute norm is  tensor(47.4313, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.1831, device='cuda:3')
compute distance is  tensor(135.1831, device='cuda:3')
compute norm is  tensor(47.4063, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.6302, device='cuda:3')
compute distance is  tensor(123.6302, device='cuda:3')
compute norm is  tensor(47.3315, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(135.1831, device='cuda:3')
distance x is tensor(107719.1250, device='cuda:3')
distance x is tensor(107719.1250, device='cuda:3')
________________________________
test distance is  tensor(107719.1250, device='cuda:3')
test distance1 is  tensor(107719.1250, device='cuda:3')
test similarity is  tensor(-0.1048, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130111404355662.6
test entropy is  0.0
________________________________
cal ratio is  0.0347168945339294
distance x is tensor(3739.6785, device='cuda:3')
cal_distance is  tensor(3739.6785, device='cuda:3')
cal ratio is  0.18632458494330317
distance x is tensor(696.7982, device='cuda:3')
cal_distance is  tensor(696.7982, device='cuda:3')
cal ratio is  0.4316520111446418
distance x is tensor(300.7773, device='cuda:3')
cal_distance is  tensor(300.7773, device='cuda:3')
cal ratio is  0.6569990560602493
distance x is tensor(197.6122, device='cuda:3')
cal_distance is  tensor(197.6122, device='cuda:3')
cal ratio is  0.8105511254624294
distance x is tensor(160.1758, device='cuda:3')
cal_distance is  tensor(160.1758, device='cuda:3')
cal ratio is  0.900303304996693
distance x is tensor(144.2073, device='cuda:3')
cal_distance is  tensor(144.2073, device='cuda:3')
cal ratio is  0.9488414040111743
distance x is tensor(136.8301, device='cuda:3')
cal_distance is  tensor(136.8301, device='cuda:3')
cal ratio is  0.9740840236744482
distance x is tensor(133.2842, device='cuda:3')
cal_distance is  tensor(133.2842, device='cuda:3')
distance x is tensor(133.2842, device='cuda:3')
return_distance is  tensor(133.2842, device='cuda:3')
distance x is tensor(133.2738, device='cuda:3')
distance x is tensor(133.2738, device='cuda:3')
________________________________
test distance is  tensor(133.2738, device='cuda:3')
test distance1 is  tensor(133.2738, device='cuda:3')
test similarity is  tensor(0.9453, device='cuda:3')
test acc is  0.10003333348966531
test loss is 332.0212674008758
test entropy is  1.3461568330693517e-05
________________________________
0
distance x is tensor(133.2738, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  4.43324497943805e-06
avg test loss is  332.1554121330603
avg accuracy is  0.2683500001563387
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9453, device='cuda:3')
compute_distance is  tensor(133.2738, device='cuda:3')
compute_norm is  tensor(45.9981, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(113.6080, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9388698319763517
avg test loss is  1.4848908517660617
avg accuracy is  0.8235833334896577
solo acc is  0.3407000001563403
compute similarity  is  tensor(0.9526, device='cuda:3')
compute_distance is  tensor(113.6080, device='cuda:3')
compute_norm is  tensor(44.7690, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(116.1201, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8965875982348599
avg test loss is  1.5418858035032683
avg accuracy is  0.8255500001563243
solo acc is  0.2836500001563391
compute similarity  is  tensor(0.9520, device='cuda:3')
compute_distance is  tensor(116.1201, device='cuda:3')
compute_norm is  tensor(44.4545, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(118.4339, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8764997894830032
avg test loss is  1.5203314007980737
avg accuracy is  0.8292000001563242
solo acc is  0.2706666668230055
compute similarity  is  tensor(0.9515, device='cuda:3')
compute_distance is  tensor(118.4339, device='cuda:3')
compute_norm is  tensor(44.1749, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(120.6257, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8615789851273047
avg test loss is  1.482793090312974
avg accuracy is  0.8317166668229907
solo acc is  0.2706000001563388
compute similarity  is  tensor(0.9511, device='cuda:3')
compute_distance is  tensor(120.6257, device='cuda:3')
compute_norm is  tensor(43.9127, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(122.7652, device='cuda:3')
distance x is tensor(122.7652, device='cuda:3')
________________________________
test distance is  tensor(122.7652, device='cuda:3')
test distance1 is  tensor(122.7652, device='cuda:3')
test similarity is  tensor(0.9507, device='cuda:3')
test acc is  0.2701500001563388
test loss is 1.4459100406307148
test entropy is  0.8701954860804177
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.283294439315796
mal norm is  tensor(633.5577, device='cuda:3')
distance x is tensor(122.7729, device='cuda:3')
mal distance is  tensor(122.7729, device='cuda:3')
user_PLR len size 44
counter_tensor is  tensor([12., 12.,  0.,  0.,  0., 12.,  0., 37., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 12., 33., 43., 12.,  0., 17., 26., 40.,
        17., 21., 38., 37., 43., 41.,  0., 43.,  0., 43., 25.,  0., 37., 18.,
         0., 12.])
count_res tensor([8.1973e-15, 8.1973e-15, 5.0366e-20, 5.0366e-20, 5.0366e-20, 8.1973e-15,
        5.0366e-20, 5.9024e-04, 3.9770e-06, 3.9770e-06, 3.9770e-06, 3.9770e-06,
        3.9770e-06, 3.9770e-06, 3.9770e-06, 3.9770e-06, 3.9770e-06, 3.9770e-06,
        3.9770e-06, 3.9770e-06, 8.1973e-15, 1.0811e-05, 2.3812e-01, 8.1973e-15,
        5.0366e-20, 1.2166e-12, 9.8581e-09, 1.1855e-02, 1.2166e-12, 6.6423e-11,
        1.6044e-03, 5.9024e-04, 2.3812e-01, 3.2226e-02, 5.0366e-20, 2.3812e-01,
        5.0366e-20, 2.3812e-01, 3.6266e-09, 5.0366e-20, 5.9024e-04, 3.3070e-12,
        5.0366e-20, 8.1973e-15])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 89.00% 

Test Accuracy: 88.66% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3441193699836731
distance x is tensor(116.4449, device='cuda:3')
benign distance is  tensor(116.4449, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.593002200126648
distance x is tensor(119.7274, device='cuda:3')
benign distance is  tensor(119.7274, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.046691734343767166
distance x is tensor(111.6436, device='cuda:3')
benign distance is  tensor(111.6436, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3797561526298523
distance x is tensor(107.9436, device='cuda:3')
benign distance is  tensor(107.9436, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4973906874656677
distance x is tensor(107.6446, device='cuda:3')
benign distance is  tensor(107.6446, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8445532917976379
distance x is tensor(123.7739, device='cuda:3')
benign distance is  tensor(123.7739, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.20717346668243408
distance x is tensor(126.9276, device='cuda:3')
benign distance is  tensor(126.9276, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6007620096206665
distance x is tensor(123.6154, device='cuda:3')
benign distance is  tensor(123.6154, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.25719326734542847
distance x is tensor(137.6538, device='cuda:3')
benign distance is  tensor(137.6538, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.41151851415634155
distance x is tensor(129.0459, device='cuda:3')
benign distance is  tensor(129.0459, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5247821807861328
distance x is tensor(128.5120, device='cuda:3')
benign distance is  tensor(128.5120, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.557391345500946
distance x is tensor(128.7822, device='cuda:3')
benign distance is  tensor(128.7822, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5611710548400879
distance x is tensor(133.9260, device='cuda:3')
benign distance is  tensor(133.9260, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4150978624820709
distance x is tensor(109.6451, device='cuda:3')
benign distance is  tensor(109.6451, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5569208860397339
distance x is tensor(121.6870, device='cuda:3')
benign distance is  tensor(121.6870, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9721530675888062
distance x is tensor(125.9789, device='cuda:3')
benign distance is  tensor(125.9789, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.6192219853401184
distance x is tensor(133.4995, device='cuda:3')
benign distance is  tensor(133.4995, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8786486387252808
distance x is tensor(150.7210, device='cuda:3')
benign distance is  tensor(150.7210, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4170288145542145
distance x is tensor(121.9703, device='cuda:3')
benign distance is  tensor(121.9703, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4045882821083069
distance x is tensor(132.3853, device='cuda:3')
benign distance is  tensor(132.3853, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.07826374471187592
distance x is tensor(122.5780, device='cuda:3')
benign distance is  tensor(122.5780, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.1392641067504883
distance x is tensor(128.2508, device='cuda:3')
benign distance is  tensor(128.2508, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.49295949935913086
distance x is tensor(132.1709, device='cuda:3')
benign distance is  tensor(132.1709, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.5425649285316467
distance x is tensor(113.5060, device='cuda:3')
benign distance is  tensor(113.5060, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.06342635303735733
distance x is tensor(129.4100, device='cuda:3')
benign distance is  tensor(129.4100, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.5933312177658081
distance x is tensor(126.3735, device='cuda:3')
benign distance is  tensor(126.3735, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.3408745229244232
distance x is tensor(108.2749, device='cuda:3')
benign distance is  tensor(108.2749, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.012526273727417
distance x is tensor(139.6290, device='cuda:3')
benign distance is  tensor(139.6290, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5287256240844727
distance x is tensor(127.3831, device='cuda:3')
benign distance is  tensor(127.3831, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.9338618516921997
distance x is tensor(127.1386, device='cuda:3')
benign distance is  tensor(127.1386, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.37582847476005554
distance x is tensor(131.9546, device='cuda:3')
benign distance is  tensor(131.9546, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.14371518790721893
distance x is tensor(122.9022, device='cuda:3')
benign distance is  tensor(122.9022, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(125.7384, device='cuda:3')
compute distance is  tensor(125.7384, device='cuda:3')
compute norm is  tensor(47.5026, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.8399, device='cuda:3')
compute distance is  tensor(114.8399, device='cuda:3')
compute norm is  tensor(47.2016, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.0578, device='cuda:3')
compute distance is  tensor(139.0578, device='cuda:3')
compute norm is  tensor(47.9227, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.7524, device='cuda:3')
compute distance is  tensor(112.7524, device='cuda:3')
compute norm is  tensor(47.3432, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.7267, device='cuda:3')
compute distance is  tensor(136.7267, device='cuda:3')
compute norm is  tensor(47.8980, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.3469, device='cuda:3')
compute distance is  tensor(126.3469, device='cuda:3')
compute norm is  tensor(47.7899, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.9050, device='cuda:3')
compute distance is  tensor(113.9050, device='cuda:3')
compute norm is  tensor(47.3738, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.7060, device='cuda:3')
compute distance is  tensor(120.7060, device='cuda:3')
compute norm is  tensor(47.3668, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.9201, device='cuda:3')
compute distance is  tensor(119.9201, device='cuda:3')
compute norm is  tensor(47.3843, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.7419, device='cuda:3')
compute distance is  tensor(116.7419, device='cuda:3')
compute norm is  tensor(47.3788, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.4026, device='cuda:3')
compute distance is  tensor(125.4026, device='cuda:3')
compute norm is  tensor(47.7506, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.7173, device='cuda:3')
compute distance is  tensor(120.7173, device='cuda:3')
compute norm is  tensor(47.5744, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(139.0578, device='cuda:3')
distance x is tensor(107721., device='cuda:3')
distance x is tensor(107721., device='cuda:3')
________________________________
test distance is  tensor(107721., device='cuda:3')
test distance1 is  tensor(107721., device='cuda:3')
test similarity is  tensor(-0.1060, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130163048892359.23
test entropy is  0.0
________________________________
cal ratio is  0.035210610857704945
distance x is tensor(3792.9275, device='cuda:3')
cal_distance is  tensor(3792.9275, device='cuda:3')
cal ratio is  0.18764477499372612
distance x is tensor(711.7272, device='cuda:3')
cal_distance is  tensor(711.7272, device='cuda:3')
cal ratio is  0.43317858215237237
distance x is tensor(308.3080, device='cuda:3')
cal_distance is  tensor(308.3080, device='cuda:3')
cal ratio is  0.6581598650200584
distance x is tensor(202.9177, device='cuda:3')
cal_distance is  tensor(202.9177, device='cuda:3')
cal ratio is  0.8112669359769893
distance x is tensor(164.6214, device='cuda:3')
cal_distance is  tensor(164.6214, device='cuda:3')
cal ratio is  0.9007008357155015
distance x is tensor(148.2752, device='cuda:3')
cal_distance is  tensor(148.2752, device='cuda:3')
cal ratio is  0.9490509095299088
distance x is tensor(140.7210, device='cuda:3')
cal_distance is  tensor(140.7210, device='cuda:3')
cal ratio is  0.974191503160587
distance x is tensor(137.0893, device='cuda:3')
cal_distance is  tensor(137.0893, device='cuda:3')
distance x is tensor(137.0893, device='cuda:3')
return_distance is  tensor(137.0893, device='cuda:3')
distance x is tensor(137.0789, device='cuda:3')
distance x is tensor(137.0789, device='cuda:3')
________________________________
test distance is  tensor(137.0789, device='cuda:3')
test distance1 is  tensor(137.0789, device='cuda:3')
test similarity is  tensor(0.9428, device='cuda:3')
test acc is  0.10005000015633199
test loss is 331.25471756859883
test entropy is  2.829193162352986e-05
________________________________
0
distance x is tensor(137.0789, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  3.091988581445961e-05
avg test loss is  330.78759085649114
avg accuracy is  0.2735166668230055
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9428, device='cuda:3')
compute_distance is  tensor(137.0789, device='cuda:3')
compute_norm is  tensor(46.2828, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(117.0321, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.899736025567248
avg test loss is  1.5700624281409452
avg accuracy is  0.802216666822992
solo acc is  0.3193000001563399
compute similarity  is  tensor(0.9498, device='cuda:3')
compute_distance is  tensor(117.0321, device='cuda:3')
compute_norm is  tensor(45.1650, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(119.4956, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9002953033838699
avg test loss is  1.5571646489568356
avg accuracy is  0.8074000001563252
solo acc is  0.2845666668230058
compute similarity  is  tensor(0.9493, device='cuda:3')
compute_distance is  tensor(119.4956, device='cuda:3')
compute_norm is  tensor(44.8515, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(121.7512, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8951188776411736
avg test loss is  1.5051868679935236
avg accuracy is  0.8094833334896584
solo acc is  0.28046666682300564
compute similarity  is  tensor(0.9488, device='cuda:3')
compute_distance is  tensor(121.7512, device='cuda:3')
compute_norm is  tensor(44.5721, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(123.8431, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8825018883132731
avg test loss is  1.478256281632096
avg accuracy is  0.8148666668229915
solo acc is  0.27335000015633887
compute similarity  is  tensor(0.9484, device='cuda:3')
compute_distance is  tensor(123.8431, device='cuda:3')
compute_norm is  tensor(44.3109, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(125.8925, device='cuda:3')
distance x is tensor(125.8925, device='cuda:3')
________________________________
test distance is  tensor(125.8925, device='cuda:3')
test distance1 is  tensor(125.8925, device='cuda:3')
test similarity is  tensor(0.9479, device='cuda:3')
test acc is  0.2751666668230056
test loss is 1.44430097664343
test entropy is  0.8818785101493031
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.3666253089904785
mal norm is  tensor(654.5085, device='cuda:3')
distance x is tensor(125.9003, device='cuda:3')
mal distance is  tensor(125.9003, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 17.66% 

Test Accuracy: 17.71% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7976801991462708
distance x is tensor(163.8606, device='cuda:3')
benign distance is  tensor(163.8606, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5885021686553955
distance x is tensor(159.8827, device='cuda:3')
benign distance is  tensor(159.8827, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4781621992588043
distance x is tensor(162.3348, device='cuda:3')
benign distance is  tensor(162.3348, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6413132548332214
distance x is tensor(159.1363, device='cuda:3')
benign distance is  tensor(159.1363, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5055872797966003
distance x is tensor(157.7125, device='cuda:3')
benign distance is  tensor(157.7125, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5530303120613098
distance x is tensor(178.2598, device='cuda:3')
benign distance is  tensor(178.2598, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5709982514381409
distance x is tensor(166.8667, device='cuda:3')
benign distance is  tensor(166.8667, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6022706627845764
distance x is tensor(180.0740, device='cuda:3')
benign distance is  tensor(180.0740, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(170.1148, device='cuda:3')
compute distance is  tensor(170.1148, device='cuda:3')
compute norm is  tensor(46.5769, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.0796, device='cuda:3')
compute distance is  tensor(151.0796, device='cuda:3')
compute norm is  tensor(46.1096, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.5572, device='cuda:3')
compute distance is  tensor(160.5572, device='cuda:3')
compute norm is  tensor(46.4147, device='cuda:3', dtype=torch.float64)
distance x is tensor(168.4085, device='cuda:3')
compute distance is  tensor(168.4085, device='cuda:3')
compute norm is  tensor(46.6111, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.8661, device='cuda:3')
compute distance is  tensor(159.8661, device='cuda:3')
compute norm is  tensor(46.5022, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.4759, device='cuda:3')
compute distance is  tensor(164.4759, device='cuda:3')
compute norm is  tensor(46.5622, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.5727, device='cuda:3')
compute distance is  tensor(170.5727, device='cuda:3')
compute norm is  tensor(46.5387, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.9539, device='cuda:3')
compute distance is  tensor(157.9539, device='cuda:3')
compute norm is  tensor(46.4149, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.8267, device='cuda:3')
compute distance is  tensor(167.8267, device='cuda:3')
compute norm is  tensor(46.5744, device='cuda:3', dtype=torch.float64)
distance x is tensor(171.3736, device='cuda:3')
compute distance is  tensor(171.3736, device='cuda:3')
compute norm is  tensor(46.7437, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.6501, device='cuda:3')
compute distance is  tensor(165.6501, device='cuda:3')
compute norm is  tensor(46.6419, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.2639, device='cuda:3')
compute distance is  tensor(170.2639, device='cuda:3')
compute norm is  tensor(46.6448, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(171.3736, device='cuda:3')
distance x is tensor(107646.3203, device='cuda:3')
distance x is tensor(107646.3203, device='cuda:3')
________________________________
test distance is  tensor(107646.3203, device='cuda:3')
test distance1 is  tensor(107646.3203, device='cuda:3')
test similarity is  tensor(0.1747, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130120097743791.22
test entropy is  0.0
________________________________
cal ratio is  0.0391019574392154
distance x is tensor(4209.1875, device='cuda:3')
cal_distance is  tensor(4209.1875, device='cuda:3')
cal ratio is  0.197742013572727
distance x is tensor(832.3374, device='cuda:3')
cal_distance is  tensor(832.3374, device='cuda:3')
cal ratio is  0.44468080751499217
distance x is tensor(370.1273, device='cuda:3')
cal_distance is  tensor(370.1273, device='cuda:3')
cal ratio is  0.666841311957968
distance x is tensor(246.8179, device='cuda:3')
cal_distance is  tensor(246.8179, device='cuda:3')
cal ratio is  0.8166006889712669
distance x is tensor(201.5527, device='cuda:3')
cal_distance is  tensor(201.5527, device='cuda:3')
cal ratio is  0.9036574370783422
distance x is tensor(182.1351, device='cuda:3')
cal_distance is  tensor(182.1351, device='cuda:3')
cal ratio is  0.9506076919264126
distance x is tensor(173.1393, device='cuda:3')
cal_distance is  tensor(173.1393, device='cuda:3')
cal ratio is  0.9749903522894445
distance x is tensor(168.8092, device='cuda:3')
cal_distance is  tensor(168.8092, device='cuda:3')
distance x is tensor(168.8092, device='cuda:3')
return_distance is  tensor(168.8092, device='cuda:3')
distance x is tensor(168.7989, device='cuda:3')
distance x is tensor(168.7989, device='cuda:3')
________________________________
test distance is  tensor(168.7989, device='cuda:3')
test distance1 is  tensor(168.7989, device='cuda:3')
test similarity is  tensor(0.9290, device='cuda:3')
test acc is  0.10000000015633198
test loss is 1084.9102676489206
test entropy is  0.0
________________________________
0
distance x is tensor(168.7989, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  1086.7474667807378
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9290, device='cuda:3')
compute_distance is  tensor(168.7989, device='cuda:3')
compute_norm is  tensor(48.2293, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(923.5905, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5892266240963804
avg test loss is  2.861154202713387
avg accuracy is  0.09998333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3750, device='cuda:3')
compute_distance is  tensor(923.5905, device='cuda:3')
compute_norm is  tensor(111.8292, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(919.8726, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8413459883569908
avg test loss is  3.655401139879532
avg accuracy is  0.09998333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3752, device='cuda:3')
compute_distance is  tensor(919.8726, device='cuda:3')
compute_norm is  tensor(111.6289, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(915.6173, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5605999580832686
avg test loss is  2.8605732894909663
avg accuracy is  0.09998333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3749, device='cuda:3')
compute_distance is  tensor(915.6173, device='cuda:3')
compute_norm is  tensor(110.8048, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(911.9615, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8366902563363504
avg test loss is  3.6302696890922497
avg accuracy is  0.09998333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3752, device='cuda:3')
compute_distance is  tensor(911.9615, device='cuda:3')
compute_norm is  tensor(110.6024, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(907.7383, device='cuda:3')
distance x is tensor(907.7383, device='cuda:3')
________________________________
test distance is  tensor(907.7383, device='cuda:3')
test distance1 is  tensor(907.7383, device='cuda:3')
test similarity is  tensor(0.3749, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.857322799879859
test entropy is  1.5586802472692054
________________________________
cal ratio is  0.42581186174014235
distance x is tensor(386.5273, device='cuda:3')
cal_distance is  tensor(386.5273, device='cuda:3')
cal ratio is  0.652541263333411
distance x is tensor(252.2254, device='cuda:3')
cal_distance is  tensor(252.2254, device='cuda:3')
cal ratio is  0.8077996792541409
distance x is tensor(203.7478, device='cuda:3')
cal_distance is  tensor(203.7478, device='cuda:3')
cal ratio is  0.8987762957189327
distance x is tensor(183.1238, device='cuda:3')
cal_distance is  tensor(183.1238, device='cuda:3')
cal ratio is  0.9480378504929902
distance x is tensor(173.6084, device='cuda:3')
cal_distance is  tensor(173.6084, device='cuda:3')
cal ratio is  0.9736721834324426
distance x is tensor(169.0377, device='cuda:3')
cal_distance is  tensor(169.0377, device='cuda:3')
distance x is tensor(169.0377, device='cuda:3')
return_distance is  tensor(169.0377, device='cuda:3')
distance x is tensor(169.0355, device='cuda:3')
distance x is tensor(169.0355, device='cuda:3')
________________________________
test distance is  tensor(169.0355, device='cuda:3')
test distance1 is  tensor(169.0355, device='cuda:3')
test similarity is  tensor(0.8875, device='cuda:3')
test acc is  0.14095000015633238
test loss is 2.7447064309232014
test entropy is  1.656753881145388
________________________________
0
distance x is tensor(169.0355, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.6579026621796176
avg test loss is  2.741580724462009
avg accuracy is  0.10873333348966528
solo acc is  0.14010000015633228
compute similarity  is  tensor(0.8875, device='cuda:3')
compute_distance is  tensor(169.0355, device='cuda:3')
compute_norm is  tensor(51.4483, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(170.7993, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.696869471942438
avg test loss is  2.880553786688522
avg accuracy is  0.10496666682299861
solo acc is  0.10325000015633197
compute similarity  is  tensor(0.8874, device='cuda:3')
compute_distance is  tensor(170.7993, device='cuda:3')
compute_norm is  tensor(51.2785, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(173.9435, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.1346446747210488
avg test loss is  1.9377194747233442
avg accuracy is  0.12251666682299857
solo acc is  0.16933333348966798
compute similarity  is  tensor(0.8869, device='cuda:3')
compute_distance is  tensor(173.9435, device='cuda:3')
compute_norm is  tensor(51.0845, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(174.1550, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.672732284900222
avg test loss is  2.6822887681948857
avg accuracy is  0.10938333348966528
solo acc is  0.10235000015633197
compute similarity  is  tensor(0.8867, device='cuda:3')
compute_distance is  tensor(174.1550, device='cuda:3')
compute_norm is  tensor(50.9449, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(176.2087, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.048778132271411
avg test loss is  1.7369182766881832
avg accuracy is  0.13503333348966523
solo acc is  0.19715000015633616
compute similarity  is  tensor(0.8862, device='cuda:3')
compute_distance is  tensor(176.2087, device='cuda:3')
compute_norm is  tensor(50.7088, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(176.4070, device='cuda:3')
distance x is tensor(176.4070, device='cuda:3')
________________________________
test distance is  tensor(176.4070, device='cuda:3')
test distance1 is  tensor(176.4070, device='cuda:3')
test similarity is  tensor(0.8860, device='cuda:3')
test acc is  0.10245000015633197
test loss is 2.5204731154797684
test entropy is  0.6496151876983358
________________________________
cal ratio is  0.965917925813732
distance x is tensor(170.3950, device='cuda:3')
cal_distance is  tensor(170.3950, device='cuda:3')
distance x is tensor(170.3950, device='cuda:3')
return_distance is  tensor(170.3950, device='cuda:3')
distance x is tensor(170.3946, device='cuda:3')
distance x is tensor(170.3946, device='cuda:3')
________________________________
test distance is  tensor(170.3946, device='cuda:3')
test distance1 is  tensor(170.3946, device='cuda:3')
test similarity is  tensor(0.8924, device='cuda:3')
test acc is  0.1031833334896653
test loss is 2.517503733573946
test entropy is  0.6491404710802188
________________________________
0
distance x is tensor(170.3946, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6495591243828284
avg test loss is  2.5199996921807717
avg accuracy is  0.11381666682299861
solo acc is  0.10335000015633197
compute similarity  is  tensor(0.8924, device='cuda:3')
compute_distance is  tensor(170.3946, device='cuda:3')
compute_norm is  tensor(50.2156, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(172.5983, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0153506968829678
avg test loss is  1.6881682543612238
avg accuracy is  0.14033333348966562
solo acc is  0.19591666682300274
compute similarity  is  tensor(0.8918, device='cuda:3')
compute_distance is  tensor(172.5983, device='cuda:3')
compute_norm is  tensor(49.9818, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(172.8150, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6188758698099458
avg test loss is  2.4788340675805425
avg accuracy is  0.11695000015633193
solo acc is  0.10136666682299864
compute similarity  is  tensor(0.8915, device='cuda:3')
compute_distance is  tensor(172.8150, device='cuda:3')
compute_norm is  tensor(49.8197, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(174.7368, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9931086940424783
avg test loss is  1.6232620004906075
avg accuracy is  0.1454666668229994
solo acc is  0.2107000001563368
compute similarity  is  tensor(0.8909, device='cuda:3')
compute_distance is  tensor(174.7368, device='cuda:3')
compute_norm is  tensor(49.5848, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(174.7368, device='cuda:3')
________________________________
test distance is  tensor(174.7368, device='cuda:3')
test similarity is  tensor(0.8909, device='cuda:3')
test acc is  0.14413333348966598
test loss is 1.6229788485620575
test entropy is  0.9946016925992742
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal loss is 1.3775898218154907
mal norm is  tensor(1003.0289, device='cuda:3')
distance x is tensor(174.7368, device='cuda:3')
mal distance is  tensor(174.7368, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([13., 12., 12.,  0., 25., 12.,  0., 20., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 12., 13., 34., 12., 12.,  0., 35., 12.,
        28.,  5., 13., 35., 33., 34., 12., 12.])
count_res tensor([9.7118e-11, 3.5728e-11, 3.5728e-11, 2.1952e-16, 1.5806e-05, 3.5728e-11,
        2.1952e-16, 1.0650e-07, 5.8148e-06, 5.8148e-06, 5.8148e-06, 5.8148e-06,
        5.8148e-06, 5.8148e-06, 5.8148e-06, 5.8148e-06, 5.8148e-06, 5.8148e-06,
        5.8148e-06, 5.8148e-06, 3.5728e-11, 9.7118e-11, 1.2808e-01, 3.5728e-11,
        3.5728e-11, 2.1952e-16, 3.4816e-01, 3.5728e-11, 3.1748e-04, 3.2579e-14,
        9.7118e-11, 3.4816e-01, 4.7118e-02, 1.2808e-01, 3.5728e-11, 3.5728e-11])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 89.06% 

Test Accuracy: 88.44% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5220552086830139
distance x is tensor(125.1289, device='cuda:3')
benign distance is  tensor(125.1289, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6291757822036743
distance x is tensor(118.8652, device='cuda:3')
benign distance is  tensor(118.8652, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5799765586853027
distance x is tensor(125.1832, device='cuda:3')
benign distance is  tensor(125.1832, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.339683473110199
distance x is tensor(110.8897, device='cuda:3')
benign distance is  tensor(110.8897, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2875363528728485
distance x is tensor(103.3914, device='cuda:3')
benign distance is  tensor(103.3914, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.2686563730239868
distance x is tensor(133.7173, device='cuda:3')
benign distance is  tensor(133.7173, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1826602965593338
distance x is tensor(125.4823, device='cuda:3')
benign distance is  tensor(125.4823, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.571008026599884
distance x is tensor(124.5586, device='cuda:3')
benign distance is  tensor(124.5586, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5974040031433105
distance x is tensor(137.1583, device='cuda:3')
benign distance is  tensor(137.1583, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4925270080566406
distance x is tensor(130.4777, device='cuda:3')
benign distance is  tensor(130.4777, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8617708086967468
distance x is tensor(129.2950, device='cuda:3')
benign distance is  tensor(129.2950, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7062383890151978
distance x is tensor(106.5176, device='cuda:3')
benign distance is  tensor(106.5176, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.2914904057979584
distance x is tensor(122.0304, device='cuda:3')
benign distance is  tensor(122.0304, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.40666547417640686
distance x is tensor(108.9662, device='cuda:3')
benign distance is  tensor(108.9662, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9069879651069641
distance x is tensor(126.5438, device='cuda:3')
benign distance is  tensor(126.5438, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.24470968544483185
distance x is tensor(141.1768, device='cuda:3')
benign distance is  tensor(141.1768, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.10467706620693207
distance x is tensor(144.8283, device='cuda:3')
benign distance is  tensor(144.8283, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.71040278673172
distance x is tensor(132.4253, device='cuda:3')
benign distance is  tensor(132.4253, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.32717806100845337
distance x is tensor(135.0537, device='cuda:3')
benign distance is  tensor(135.0537, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.7209949493408203
distance x is tensor(143.6645, device='cuda:3')
benign distance is  tensor(143.6645, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.4036591053009033
distance x is tensor(122.1151, device='cuda:3')
benign distance is  tensor(122.1151, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6353853940963745
distance x is tensor(130.8815, device='cuda:3')
benign distance is  tensor(130.8815, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.34155040979385376
distance x is tensor(109.1714, device='cuda:3')
benign distance is  tensor(109.1714, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.46894198656082153
distance x is tensor(134.9187, device='cuda:3')
benign distance is  tensor(134.9187, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(123.1533, device='cuda:3')
compute distance is  tensor(123.1533, device='cuda:3')
compute norm is  tensor(48.1775, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.3332, device='cuda:3')
compute distance is  tensor(114.3332, device='cuda:3')
compute norm is  tensor(48.0425, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.0611, device='cuda:3')
compute distance is  tensor(138.0611, device='cuda:3')
compute norm is  tensor(48.5596, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.5616, device='cuda:3')
compute distance is  tensor(124.5616, device='cuda:3')
compute norm is  tensor(48.1982, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.1807, device='cuda:3')
compute distance is  tensor(124.1807, device='cuda:3')
compute norm is  tensor(48.1782, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.5758, device='cuda:3')
compute distance is  tensor(126.5758, device='cuda:3')
compute norm is  tensor(48.2981, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.0434, device='cuda:3')
compute distance is  tensor(127.0434, device='cuda:3')
compute norm is  tensor(48.2685, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.6632, device='cuda:3')
compute distance is  tensor(126.6632, device='cuda:3')
compute norm is  tensor(48.3216, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.3619, device='cuda:3')
compute distance is  tensor(127.3619, device='cuda:3')
compute norm is  tensor(48.2731, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.0790, device='cuda:3')
compute distance is  tensor(128.0790, device='cuda:3')
compute norm is  tensor(48.3902, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.9091, device='cuda:3')
compute distance is  tensor(136.9091, device='cuda:3')
compute norm is  tensor(48.7411, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.3388, device='cuda:3')
compute distance is  tensor(123.3388, device='cuda:3')
compute norm is  tensor(48.2882, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(138.0611, device='cuda:3')
distance x is tensor(107724.1562, device='cuda:3')
distance x is tensor(107724.1562, device='cuda:3')
________________________________
test distance is  tensor(107724.1562, device='cuda:3')
test distance1 is  tensor(107724.1562, device='cuda:3')
test similarity is  tensor(-0.1037, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130136226371937.7
test entropy is  0.0
________________________________
cal ratio is  0.03508368805907404
distance x is tensor(3779.3660, device='cuda:3')
cal_distance is  tensor(3779.3660, device='cuda:3')
cal ratio is  0.18730626432771422
distance x is tensor(707.9031, device='cuda:3')
cal_distance is  tensor(707.9031, device='cuda:3')
cal ratio is  0.43278767295581416
distance x is tensor(306.3747, device='cuda:3')
cal_distance is  tensor(306.3747, device='cuda:3')
cal ratio is  0.6578627739494527
distance x is tensor(201.5543, device='cuda:3')
cal_distance is  tensor(201.5543, device='cuda:3')
cal ratio is  0.8110838432199361
distance x is tensor(163.4784, device='cuda:3')
cal_distance is  tensor(163.4784, device='cuda:3')
cal ratio is  0.900599173295317
distance x is tensor(147.2291, device='cuda:3')
cal_distance is  tensor(147.2291, device='cuda:3')
cal ratio is  0.9489973763112056
distance x is tensor(139.7203, device='cuda:3')
cal_distance is  tensor(139.7203, device='cuda:3')
cal ratio is  0.9741639145604775
distance x is tensor(136.1106, device='cuda:3')
cal_distance is  tensor(136.1106, device='cuda:3')
distance x is tensor(136.1106, device='cuda:3')
return_distance is  tensor(136.1106, device='cuda:3')
distance x is tensor(136.1002, device='cuda:3')
distance x is tensor(136.1002, device='cuda:3')
________________________________
test distance is  tensor(136.1002, device='cuda:3')
test distance1 is  tensor(136.1002, device='cuda:3')
test similarity is  tensor(0.9457, device='cuda:3')
test acc is  0.10013333348966531
test loss is 331.35774517262666
test entropy is  6.854514139054261e-05
________________________________
0
distance x is tensor(136.1002, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  7.638601973509137e-06
avg test loss is  330.75222329341017
avg accuracy is  0.294316666823006
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.9457, device='cuda:3')
compute_distance is  tensor(136.1002, device='cuda:3')
compute_norm is  tensor(47.1143, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(114.9715, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9558413175504599
avg test loss is  1.5152042935143655
avg accuracy is  0.8158166668229915
solo acc is  0.33601666682300685
compute similarity  is  tensor(0.9530, device='cuda:3')
compute_distance is  tensor(114.9715, device='cuda:3')
compute_norm is  tensor(45.9404, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.7126, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8995696555322675
avg test loss is  1.5834297391651535
avg accuracy is  0.8164500001563246
solo acc is  0.27931666682300577
compute similarity  is  tensor(0.9524, device='cuda:3')
compute_distance is  tensor(117.7126, device='cuda:3')
compute_norm is  tensor(45.6130, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(120.1757, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8686929817265793
avg test loss is  1.5638417142794838
avg accuracy is  0.8212333334896578
solo acc is  0.2681666668230054
compute similarity  is  tensor(0.9519, device='cuda:3')
compute_distance is  tensor(120.1757, device='cuda:3')
compute_norm is  tensor(45.3198, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(122.4725, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8748765633558668
avg test loss is  1.508566759415527
avg accuracy is  0.8258666668229909
solo acc is  0.2709500001563388
compute similarity  is  tensor(0.9515, device='cuda:3')
compute_distance is  tensor(122.4725, device='cuda:3')
compute_norm is  tensor(45.0465, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(124.6933, device='cuda:3')
distance x is tensor(124.6933, device='cuda:3')
________________________________
test distance is  tensor(124.6933, device='cuda:3')
test distance1 is  tensor(124.6933, device='cuda:3')
test similarity is  tensor(0.9510, device='cuda:3')
test acc is  0.2739666668230056
test loss is 1.4646030325116888
test entropy is  0.8714827569181731
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.329822301864624
mal norm is  tensor(647.2012, device='cuda:3')
distance x is tensor(124.7009, device='cuda:3')
mal distance is  tensor(124.7009, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([23., 12., 12., 12., 12., 12., 19., 13., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 24., 12.,  0., 12., 13., 24., 12., 16.])
count_res tensor([1.5463e-01, 2.5826e-06, 2.5826e-06, 2.5826e-06, 2.5826e-06, 2.5826e-06,
        2.8322e-03, 7.0203e-06, 1.4101e-04, 1.4101e-04, 1.4101e-04, 1.4101e-04,
        1.4101e-04, 1.4101e-04, 1.4101e-04, 1.4101e-04, 1.4101e-04, 1.4101e-04,
        1.4101e-04, 1.4101e-04, 4.2033e-01, 2.5826e-06, 1.5868e-11, 2.5826e-06,
        7.0203e-06, 4.2033e-01, 2.5826e-06, 1.4101e-04])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 89.28% 

Test Accuracy: 88.47% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7509881258010864
distance x is tensor(108.1373, device='cuda:3')
benign distance is  tensor(108.1373, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3394542336463928
distance x is tensor(127.9234, device='cuda:3')
benign distance is  tensor(127.9234, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.14926746487617493
distance x is tensor(122.8787, device='cuda:3')
benign distance is  tensor(122.8787, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.44521769881248474
distance x is tensor(120.3092, device='cuda:3')
benign distance is  tensor(120.3092, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.48916783928871155
distance x is tensor(121.3824, device='cuda:3')
benign distance is  tensor(121.3824, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1042428016662598
distance x is tensor(132.0628, device='cuda:3')
benign distance is  tensor(132.0628, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.18865680694580078
distance x is tensor(123.1815, device='cuda:3')
benign distance is  tensor(123.1815, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.40354815125465393
distance x is tensor(115.1535, device='cuda:3')
benign distance is  tensor(115.1535, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.562398374080658
distance x is tensor(117.7154, device='cuda:3')
benign distance is  tensor(117.7154, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5822955965995789
distance x is tensor(147.8866, device='cuda:3')
benign distance is  tensor(147.8866, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4557940363883972
distance x is tensor(126.9104, device='cuda:3')
benign distance is  tensor(126.9104, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2829197943210602
distance x is tensor(130.0855, device='cuda:3')
benign distance is  tensor(130.0855, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.34183600544929504
distance x is tensor(122.3271, device='cuda:3')
benign distance is  tensor(122.3271, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.5178577899932861
distance x is tensor(106.3839, device='cuda:3')
benign distance is  tensor(106.3839, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.32984888553619385
distance x is tensor(139.7158, device='cuda:3')
benign distance is  tensor(139.7158, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.17237284779548645
distance x is tensor(130.7152, device='cuda:3')
benign distance is  tensor(130.7152, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(122.4493, device='cuda:3')
compute distance is  tensor(122.4493, device='cuda:3')
compute norm is  tensor(48.0970, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.8588, device='cuda:3')
compute distance is  tensor(116.8588, device='cuda:3')
compute norm is  tensor(48.1899, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.5558, device='cuda:3')
compute distance is  tensor(129.5558, device='cuda:3')
compute norm is  tensor(48.7124, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.5159, device='cuda:3')
compute distance is  tensor(116.5159, device='cuda:3')
compute norm is  tensor(48.0368, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.2851, device='cuda:3')
compute distance is  tensor(121.2851, device='cuda:3')
compute norm is  tensor(48.2165, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.1401, device='cuda:3')
compute distance is  tensor(129.1401, device='cuda:3')
compute norm is  tensor(48.5332, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.8081, device='cuda:3')
compute distance is  tensor(122.8081, device='cuda:3')
compute norm is  tensor(48.3470, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.1714, device='cuda:3')
compute distance is  tensor(132.1714, device='cuda:3')
compute norm is  tensor(48.3918, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.9313, device='cuda:3')
compute distance is  tensor(130.9313, device='cuda:3')
compute norm is  tensor(48.4535, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.0055, device='cuda:3')
compute distance is  tensor(118.0055, device='cuda:3')
compute norm is  tensor(48.3017, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.1737, device='cuda:3')
compute distance is  tensor(128.1737, device='cuda:3')
compute norm is  tensor(48.5452, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.5313, device='cuda:3')
compute distance is  tensor(123.5313, device='cuda:3')
compute norm is  tensor(48.3957, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(132.1714, device='cuda:3')
distance x is tensor(107725.0938, device='cuda:3')
distance x is tensor(107725.0938, device='cuda:3')
________________________________
test distance is  tensor(107725.0938, device='cuda:3')
test distance1 is  tensor(107725.0938, device='cuda:3')
test similarity is  tensor(-0.1055, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130081586011129.45
test entropy is  0.0
________________________________
cal ratio is  0.03432703794822048
distance x is tensor(3697.8889, device='cuda:3')
cal_distance is  tensor(3697.8889, device='cuda:3')
cal ratio is  0.1852754399358097
distance x is tensor(685.1323, device='cuda:3')
cal_distance is  tensor(685.1323, device='cuda:3')
cal ratio is  0.4304349786765725
distance x is tensor(294.9078, device='cuda:3')
cal_distance is  tensor(294.9078, device='cuda:3')
cal ratio is  0.6560721672071227
distance x is tensor(193.4826, device='cuda:3')
cal_distance is  tensor(193.4826, device='cuda:3')
cal ratio is  0.809979081693207
distance x is tensor(156.7179, device='cuda:3')
cal_distance is  tensor(156.7179, device='cuda:3')
cal ratio is  0.8999854593029539
distance x is tensor(141.0443, device='cuda:3')
cal_distance is  tensor(141.0443, device='cuda:3')
cal ratio is  0.948673911103083
distance x is tensor(133.8053, device='cuda:3')
cal_distance is  tensor(133.8053, device='cuda:3')
cal ratio is  0.9739979551419171
distance x is tensor(130.3263, device='cuda:3')
cal_distance is  tensor(130.3263, device='cuda:3')
distance x is tensor(130.3263, device='cuda:3')
return_distance is  tensor(130.3263, device='cuda:3')
distance x is tensor(130.3159, device='cuda:3')
distance x is tensor(130.3159, device='cuda:3')
________________________________
test distance is  tensor(130.3159, device='cuda:3')
test distance1 is  tensor(130.3159, device='cuda:3')
test similarity is  tensor(0.9502, device='cuda:3')
test acc is  0.10020000015633197
test loss is 274.9773686130418
test entropy is  0.00011156656724272125
________________________________
0
distance x is tensor(130.3159, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0001036247099068102
avg test loss is  275.07080613321335
avg accuracy is  0.3909666668230077
solo acc is  0.10015000015633198
compute similarity  is  tensor(0.9502, device='cuda:3')
compute_distance is  tensor(130.3159, device='cuda:3')
compute_norm is  tensor(47.0499, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(112.2818, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9385853839327277
avg test loss is  1.5010992092872733
avg accuracy is  0.8229333334896578
solo acc is  0.34025000015634027
compute similarity  is  tensor(0.9563, device='cuda:3')
compute_distance is  tensor(112.2818, device='cuda:3')
compute_norm is  tensor(45.8375, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.0823, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9057800716428615
avg test loss is  1.5414602570950604
avg accuracy is  0.8245333334896576
solo acc is  0.28720000015633923
compute similarity  is  tensor(0.9557, device='cuda:3')
compute_distance is  tensor(115.0823, device='cuda:3')
compute_norm is  tensor(45.5114, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.4702, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8540139064224544
avg test loss is  1.5753929390073584
avg accuracy is  0.8296000001563242
solo acc is  0.26075000015633854
compute similarity  is  tensor(0.9552, device='cuda:3')
compute_distance is  tensor(117.4702, device='cuda:3')
compute_norm is  tensor(45.2201, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(119.7021, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8649222810131146
avg test loss is  1.5026776570755283
avg accuracy is  0.834700000156324
solo acc is  0.2673833334896721
compute similarity  is  tensor(0.9547, device='cuda:3')
compute_distance is  tensor(119.7021, device='cuda:3')
compute_norm is  tensor(44.9463, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(121.9117, device='cuda:3')
distance x is tensor(121.9117, device='cuda:3')
________________________________
test distance is  tensor(121.9117, device='cuda:3')
test distance1 is  tensor(121.9117, device='cuda:3')
test similarity is  tensor(0.9543, device='cuda:3')
test acc is  0.27093333348967213
test loss is 1.4685610011696562
test entropy is  0.8540552466281696
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.4437918663024902
mal norm is  tensor(626.6036, device='cuda:3')
distance x is tensor(121.9191, device='cuda:3')
mal distance is  tensor(121.9191, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([26., 35., 25., 13., 12., 31., 13., 26., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 14.,  0., 15., 12., 18.,  0., 30., 14.,
        33., 20., 13., 17., 34., 13.,  0., 12.])
count_res tensor([8.0725e-05, 6.5412e-01, 2.9697e-05, 1.8247e-10, 6.7125e-11, 1.1981e-02,
        1.8247e-10, 8.0725e-05, 1.0925e-05, 1.0925e-05, 1.0925e-05, 1.0925e-05,
        1.0925e-05, 1.0925e-05, 1.0925e-05, 1.0925e-05, 1.0925e-05, 1.0925e-05,
        1.0925e-05, 1.0925e-05, 4.9599e-10, 4.1243e-16, 1.3483e-09, 6.7125e-11,
        2.7080e-08, 4.1243e-16, 4.4075e-03, 4.9599e-10, 8.8526e-02, 2.0010e-07,
        1.8247e-10, 9.9623e-09, 2.4064e-01, 1.8247e-10, 4.1243e-16, 6.7125e-11])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 88.84% 

Test Accuracy: 87.89% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.36189913749694824
distance x is tensor(122.5792, device='cuda:3')
benign distance is  tensor(122.5792, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3387933373451233
distance x is tensor(111.2267, device='cuda:3')
benign distance is  tensor(111.2267, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.039148878306150436
distance x is tensor(126.7966, device='cuda:3')
benign distance is  tensor(126.7966, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4752923846244812
distance x is tensor(110.3584, device='cuda:3')
benign distance is  tensor(110.3584, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5090845823287964
distance x is tensor(120.3764, device='cuda:3')
benign distance is  tensor(120.3764, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7500383257865906
distance x is tensor(135.1000, device='cuda:3')
benign distance is  tensor(135.1000, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4477381706237793
distance x is tensor(139.8642, device='cuda:3')
benign distance is  tensor(139.8642, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6261305809020996
distance x is tensor(123.3060, device='cuda:3')
benign distance is  tensor(123.3060, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3766624331474304
distance x is tensor(141.8968, device='cuda:3')
benign distance is  tensor(141.8968, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6073959469795227
distance x is tensor(132.9333, device='cuda:3')
benign distance is  tensor(132.9333, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8026169538497925
distance x is tensor(131.4628, device='cuda:3')
benign distance is  tensor(131.4628, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.40063604712486267
distance x is tensor(129.9594, device='cuda:3')
benign distance is  tensor(129.9594, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5289098620414734
distance x is tensor(137.5677, device='cuda:3')
benign distance is  tensor(137.5677, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5179694890975952
distance x is tensor(124.0225, device='cuda:3')
benign distance is  tensor(124.0225, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4465878903865814
distance x is tensor(139.3588, device='cuda:3')
benign distance is  tensor(139.3588, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.35949963331222534
distance x is tensor(143.0957, device='cuda:3')
benign distance is  tensor(143.0957, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.17013117671012878
distance x is tensor(141.3027, device='cuda:3')
benign distance is  tensor(141.3027, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.12670275568962097
distance x is tensor(135.0181, device='cuda:3')
benign distance is  tensor(135.0181, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.21488574147224426
distance x is tensor(139.0012, device='cuda:3')
benign distance is  tensor(139.0012, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.09951357543468475
distance x is tensor(126.3582, device='cuda:3')
benign distance is  tensor(126.3582, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.31920331716537476
distance x is tensor(129.6322, device='cuda:3')
benign distance is  tensor(129.6322, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.4877393841743469
distance x is tensor(133.5504, device='cuda:3')
benign distance is  tensor(133.5504, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.2749055325984955
distance x is tensor(141.7655, device='cuda:3')
benign distance is  tensor(141.7655, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.2916114330291748
distance x is tensor(134.1638, device='cuda:3')
benign distance is  tensor(134.1638, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(138.2785, device='cuda:3')
compute distance is  tensor(138.2785, device='cuda:3')
compute norm is  tensor(49.1756, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.7550, device='cuda:3')
compute distance is  tensor(131.7550, device='cuda:3')
compute norm is  tensor(49.0641, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.9652, device='cuda:3')
compute distance is  tensor(140.9652, device='cuda:3')
compute norm is  tensor(49.4904, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.9259, device='cuda:3')
compute distance is  tensor(123.9259, device='cuda:3')
compute norm is  tensor(48.8579, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.2871, device='cuda:3')
compute distance is  tensor(136.2871, device='cuda:3')
compute norm is  tensor(49.3121, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.5913, device='cuda:3')
compute distance is  tensor(131.5913, device='cuda:3')
compute norm is  tensor(49.2120, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.8986, device='cuda:3')
compute distance is  tensor(129.8986, device='cuda:3')
compute norm is  tensor(49.1578, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.8657, device='cuda:3')
compute distance is  tensor(123.8657, device='cuda:3')
compute norm is  tensor(49.0282, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.2940, device='cuda:3')
compute distance is  tensor(127.2940, device='cuda:3')
compute norm is  tensor(49.1047, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.4252, device='cuda:3')
compute distance is  tensor(112.4252, device='cuda:3')
compute norm is  tensor(48.9866, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.8903, device='cuda:3')
compute distance is  tensor(142.8903, device='cuda:3')
compute norm is  tensor(49.4928, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.3272, device='cuda:3')
compute distance is  tensor(133.3272, device='cuda:3')
compute norm is  tensor(49.2698, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(142.8903, device='cuda:3')
distance x is tensor(107729.1641, device='cuda:3')
distance x is tensor(107729.1641, device='cuda:3')
________________________________
test distance is  tensor(107729.1641, device='cuda:3')
test distance1 is  tensor(107729.1641, device='cuda:3')
test similarity is  tensor(-0.1019, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130084851218663.44
test entropy is  0.0
________________________________
cal ratio is  0.03569117222163134
distance x is tensor(3844.9861, device='cuda:3')
cal_distance is  tensor(3844.9861, device='cuda:3')
cal ratio is  0.18892092725452805
distance x is tensor(726.4025, device='cuda:3')
cal_distance is  tensor(726.4025, device='cuda:3')
cal ratio is  0.4346491062285668
distance x is tensor(315.7331, device='cuda:3')
cal_distance is  tensor(315.7331, device='cuda:3')
cal ratio is  0.6592761722193218
distance x is tensor(208.1571, device='cuda:3')
cal_distance is  tensor(208.1571, device='cuda:3')
cal ratio is  0.8119547612109436
distance x is tensor(169.0151, device='cuda:3')
cal_distance is  tensor(169.0151, device='cuda:3')
cal ratio is  0.9010827220376203
distance x is tensor(152.2971, device='cuda:3')
cal_distance is  tensor(152.2971, device='cuda:3')
cal ratio is  0.9492521674156812
distance x is tensor(144.5687, device='cuda:3')
cal_distance is  tensor(144.5687, device='cuda:3')
cal ratio is  0.9742947698452172
distance x is tensor(140.8526, device='cuda:3')
cal_distance is  tensor(140.8526, device='cuda:3')
distance x is tensor(140.8526, device='cuda:3')
return_distance is  tensor(140.8526, device='cuda:3')
distance x is tensor(140.8423, device='cuda:3')
distance x is tensor(140.8423, device='cuda:3')
________________________________
test distance is  tensor(140.8423, device='cuda:3')
test distance1 is  tensor(140.8423, device='cuda:3')
test similarity is  tensor(0.9445, device='cuda:3')
test acc is  0.10006666682299865
test loss is 375.6785729251691
test entropy is  5.186013354785365e-05
________________________________
0
distance x is tensor(140.8423, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.6332326310965833e-05
avg test loss is  375.0859732882046
avg accuracy is  0.254316666823005
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.9445, device='cuda:3')
compute_distance is  tensor(140.8423, device='cuda:3')
compute_norm is  tensor(48.0473, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(117.6158, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9538814686635918
avg test loss is  1.4921358506054259
avg accuracy is  0.8027833334896586
solo acc is  0.3424500001563403
compute similarity  is  tensor(0.9522, device='cuda:3')
compute_distance is  tensor(117.6158, device='cuda:3')
compute_norm is  tensor(46.7846, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(120.3539, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8894255029113054
avg test loss is  1.586218108500499
avg accuracy is  0.8041000001563253
solo acc is  0.27465000015633895
compute similarity  is  tensor(0.9516, device='cuda:3')
compute_distance is  tensor(120.3539, device='cuda:3')
compute_norm is  tensor(46.4681, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(122.8475, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9130201784532461
avg test loss is  1.488985760888057
avg accuracy is  0.8073333334896584
solo acc is  0.2879666668230058
compute similarity  is  tensor(0.9512, device='cuda:3')
compute_distance is  tensor(122.8475, device='cuda:3')
compute_norm is  tensor(46.1848, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(125.0882, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8896575159609699
avg test loss is  1.4805704309487902
avg accuracy is  0.8116000001563249
solo acc is  0.2798833334896724
compute similarity  is  tensor(0.9508, device='cuda:3')
compute_distance is  tensor(125.0882, device='cuda:3')
compute_norm is  tensor(45.9199, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(127.3577, device='cuda:3')
distance x is tensor(127.3577, device='cuda:3')
________________________________
test distance is  tensor(127.3577, device='cuda:3')
test distance1 is  tensor(127.3577, device='cuda:3')
test similarity is  tensor(0.9504, device='cuda:3')
test acc is  0.27870000015633906
test loss is 1.4480854753238053
test entropy is  0.8896248371108
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.3379265069961548
mal norm is  tensor(665.9222, device='cuda:3')
distance x is tensor(127.3652, device='cuda:3')
mal distance is  tensor(127.3652, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 19.05% 

Test Accuracy: 18.49% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5702390670776367
distance x is tensor(168.6498, device='cuda:3')
benign distance is  tensor(168.6498, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8295266032218933
distance x is tensor(162.9792, device='cuda:3')
benign distance is  tensor(162.9792, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.21277789771556854
distance x is tensor(175.3237, device='cuda:3')
benign distance is  tensor(175.3237, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4429372251033783
distance x is tensor(164.3717, device='cuda:3')
benign distance is  tensor(164.3717, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7905570268630981
distance x is tensor(163.8914, device='cuda:3')
benign distance is  tensor(163.8914, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.29720643162727356
distance x is tensor(186.5890, device='cuda:3')
benign distance is  tensor(186.5890, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3510168492794037
distance x is tensor(170.2500, device='cuda:3')
benign distance is  tensor(170.2500, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6745977997779846
distance x is tensor(171.6806, device='cuda:3')
benign distance is  tensor(171.6806, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(154.1770, device='cuda:3')
compute distance is  tensor(154.1770, device='cuda:3')
compute norm is  tensor(47.5194, device='cuda:3', dtype=torch.float64)
distance x is tensor(166.5026, device='cuda:3')
compute distance is  tensor(166.5026, device='cuda:3')
compute norm is  tensor(47.8680, device='cuda:3', dtype=torch.float64)
distance x is tensor(179.0207, device='cuda:3')
compute distance is  tensor(179.0207, device='cuda:3')
compute norm is  tensor(48.2249, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.6999, device='cuda:3')
compute distance is  tensor(161.6999, device='cuda:3')
compute norm is  tensor(47.9110, device='cuda:3', dtype=torch.float64)
distance x is tensor(173.0567, device='cuda:3')
compute distance is  tensor(173.0567, device='cuda:3')
compute norm is  tensor(48.2239, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.8535, device='cuda:3')
compute distance is  tensor(162.8535, device='cuda:3')
compute norm is  tensor(47.9977, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.6441, device='cuda:3')
compute distance is  tensor(167.6441, device='cuda:3')
compute norm is  tensor(48.0435, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.3510, device='cuda:3')
compute distance is  tensor(164.3510, device='cuda:3')
compute norm is  tensor(47.9640, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.0020, device='cuda:3')
compute distance is  tensor(160.0020, device='cuda:3')
compute norm is  tensor(47.7876, device='cuda:3', dtype=torch.float64)
distance x is tensor(163.5484, device='cuda:3')
compute distance is  tensor(163.5484, device='cuda:3')
compute norm is  tensor(47.9410, device='cuda:3', dtype=torch.float64)
distance x is tensor(163.9540, device='cuda:3')
compute distance is  tensor(163.9540, device='cuda:3')
compute norm is  tensor(48.1542, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.2415, device='cuda:3')
compute distance is  tensor(165.2415, device='cuda:3')
compute norm is  tensor(48.0519, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(179.0207, device='cuda:3')
distance x is tensor(107658.9922, device='cuda:3')
distance x is tensor(107658.9922, device='cuda:3')
________________________________
test distance is  tensor(107658.9922, device='cuda:3')
test distance1 is  tensor(107658.9922, device='cuda:3')
test similarity is  tensor(0.1692, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130041270039130.61
test entropy is  0.0
________________________________
cal ratio is  0.039962487245482105
distance x is tensor(4302.3267, device='cuda:3')
cal_distance is  tensor(4302.3267, device='cuda:3')
cal ratio is  0.19990606804133235
distance x is tensor(860.0654, device='cuda:3')
cal_distance is  tensor(860.0654, device='cuda:3')
cal ratio is  0.4471074797320019
distance x is tensor(384.5445, device='cuda:3')
cal_distance is  tensor(384.5445, device='cuda:3')
cal ratio is  0.668658513344467
distance x is tensor(257.1307, device='cuda:3')
cal_distance is  tensor(257.1307, device='cuda:3')
cal ratio is  0.8177126057231758
distance x is tensor(210.2599, device='cuda:3')
cal_distance is  tensor(210.2599, device='cuda:3')
cal ratio is  0.9042726471326905
distance x is tensor(190.1328, device='cuda:3')
cal_distance is  tensor(190.1328, device='cuda:3')
cal ratio is  0.9509313120219124
distance x is tensor(180.8035, device='cuda:3')
cal_distance is  tensor(180.8035, device='cuda:3')
cal ratio is  0.9751563189224882
distance x is tensor(176.3118, device='cuda:3')
cal_distance is  tensor(176.3118, device='cuda:3')
distance x is tensor(176.3118, device='cuda:3')
return_distance is  tensor(176.3118, device='cuda:3')
distance x is tensor(176.3015, device='cuda:3')
distance x is tensor(176.3015, device='cuda:3')
________________________________
test distance is  tensor(176.3015, device='cuda:3')
test distance1 is  tensor(176.3015, device='cuda:3')
test similarity is  tensor(0.9281, device='cuda:3')
test acc is  0.10000000015633198
test loss is 1223.7221475369386
test entropy is  0.0
________________________________
0
distance x is tensor(176.3015, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  1224.6756521521854
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9281, device='cuda:3')
compute_distance is  tensor(176.3015, device='cuda:3')
compute_norm is  tensor(49.8839, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1238.4651, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5985852981935431
avg test loss is  2.8595823100380806
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4174, device='cuda:3')
compute_distance is  tensor(1238.4651, device='cuda:3')
compute_norm is  tensor(115.1503, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1233.0452, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8611864591204027
avg test loss is  3.6552652481522387
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4175, device='cuda:3')
compute_distance is  tensor(1233.0452, device='cuda:3')
compute_norm is  tensor(114.7443, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1227.6882, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5669592052126236
avg test loss is  2.8561922103357213
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4173, device='cuda:3')
compute_distance is  tensor(1227.6882, device='cuda:3')
compute_norm is  tensor(114.1345, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1222.3287, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8431377578010437
avg test loss is  3.6334491703810214
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4174, device='cuda:3')
compute_distance is  tensor(1222.3287, device='cuda:3')
compute_norm is  tensor(113.7266, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1216.9391, device='cuda:3')
distance x is tensor(1216.9391, device='cuda:3')
________________________________
test distance is  tensor(1216.9391, device='cuda:3')
test distance1 is  tensor(1216.9391, device='cuda:3')
test similarity is  tensor(0.4172, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8652713499597904
test entropy is  1.5525481449261402
________________________________
cal ratio is  0.3758748420303337
distance x is tensor(457.4171, device='cuda:3')
cal_distance is  tensor(457.4171, device='cuda:3')
cal ratio is  0.6130860648104951
distance x is tensor(280.4362, device='cuda:3')
cal_distance is  tensor(280.4362, device='cuda:3')
cal ratio is  0.7829980137764498
distance x is tensor(219.5810, device='cuda:3')
cal_distance is  tensor(219.5810, device='cuda:3')
cal ratio is  0.8848716578662287
distance x is tensor(194.3010, device='cuda:3')
cal_distance is  tensor(194.3010, device='cuda:3')
cal ratio is  0.9406761613283743
distance x is tensor(182.7744, device='cuda:3')
cal_distance is  tensor(182.7744, device='cuda:3')
cal ratio is  0.9698845680980209
distance x is tensor(177.2701, device='cuda:3')
cal_distance is  tensor(177.2701, device='cuda:3')
distance x is tensor(177.2701, device='cuda:3')
return_distance is  tensor(177.2701, device='cuda:3')
distance x is tensor(177.2696, device='cuda:3')
distance x is tensor(177.2696, device='cuda:3')
________________________________
test distance is  tensor(177.2696, device='cuda:3')
test distance1 is  tensor(177.2696, device='cuda:3')
test similarity is  tensor(0.9439, device='cuda:3')
test acc is  0.10065000015633198
test loss is 2.9217410616274835
test entropy is  1.6663135604055197
________________________________
0
distance x is tensor(177.2696, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.6653025741261969
avg test loss is  2.924368275762367
avg accuracy is  0.10325000015633197
solo acc is  0.10083333348966532
compute similarity  is  tensor(0.9439, device='cuda:3')
compute_distance is  tensor(177.2696, device='cuda:3')
compute_norm is  tensor(50.0101, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(178.6271, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.77118904167401
avg test loss is  3.200273522690161
avg accuracy is  0.10361666682299864
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9434, device='cuda:3')
compute_distance is  tensor(178.6271, device='cuda:3')
compute_norm is  tensor(49.9648, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(180.7896, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.1345596063111636
avg test loss is  1.9255328820204176
avg accuracy is  0.11438333348966527
solo acc is  0.16601666682300104
compute similarity  is  tensor(0.9433, device='cuda:3')
compute_distance is  tensor(180.7896, device='cuda:3')
compute_norm is  tensor(49.5648, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(180.5684, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.679132712484677
avg test loss is  2.670663125479399
avg accuracy is  0.1049333334896653
solo acc is  0.10216666682299863
compute similarity  is  tensor(0.9431, device='cuda:3')
compute_distance is  tensor(180.5684, device='cuda:3')
compute_norm is  tensor(49.4078, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(182.9959, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0796868888172768
avg test loss is  1.7252480850290897
avg accuracy is  0.11435000015633194
solo acc is  0.1958166668230028
compute similarity  is  tensor(0.9425, device='cuda:3')
compute_distance is  tensor(182.9959, device='cuda:3')
compute_norm is  tensor(49.1170, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(182.7461, device='cuda:3')
distance x is tensor(182.7461, device='cuda:3')
________________________________
test distance is  tensor(182.7461, device='cuda:3')
test distance1 is  tensor(182.7461, device='cuda:3')
test similarity is  tensor(0.9423, device='cuda:3')
test acc is  0.10285000015633197
test loss is 2.540720971408429
test entropy is  0.6371418735238789
________________________________
cal ratio is  0.9699595818627835
distance x is tensor(177.2553, device='cuda:3')
cal_distance is  tensor(177.2553, device='cuda:3')
distance x is tensor(177.2553, device='cuda:3')
return_distance is  tensor(177.2553, device='cuda:3')
distance x is tensor(177.2563, device='cuda:3')
distance x is tensor(177.2563, device='cuda:3')
________________________________
test distance is  tensor(177.2563, device='cuda:3')
test distance1 is  tensor(177.2563, device='cuda:3')
test similarity is  tensor(0.9454, device='cuda:3')
test acc is  0.1027833334896653
test loss is 2.554554478191872
test entropy is  0.6361707625612776
________________________________
0
distance x is tensor(177.2563, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.638457543623727
avg test loss is  2.5518321088636355
avg accuracy is  0.1042333334896653
solo acc is  0.1019833334896653
compute similarity  is  tensor(0.9454, device='cuda:3')
compute_distance is  tensor(177.2563, device='cuda:3')
compute_norm is  tensor(48.7699, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(179.7556, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0385037681568405
avg test loss is  1.6362839311933213
avg accuracy is  0.11421666682299861
solo acc is  0.20681666682300337
compute similarity  is  tensor(0.9447, device='cuda:3')
compute_distance is  tensor(179.7556, device='cuda:3')
compute_norm is  tensor(48.5117, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(179.5595, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6047905660959195
avg test loss is  2.4745390753247847
avg accuracy is  0.10435000015633197
solo acc is  0.10256666682299863
compute similarity  is  tensor(0.9445, device='cuda:3')
compute_distance is  tensor(179.5595, device='cuda:3')
compute_norm is  tensor(48.3294, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(181.8607, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9695732192571229
avg test loss is  1.609724142531088
avg accuracy is  0.11418333348966526
solo acc is  0.21246666682300358
compute similarity  is  tensor(0.9439, device='cuda:3')
compute_distance is  tensor(181.8607, device='cuda:3')
compute_norm is  tensor(48.0761, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(181.8594, device='cuda:3')
________________________________
test distance is  tensor(181.8594, device='cuda:3')
test similarity is  tensor(0.9439, device='cuda:3')
test acc is  0.11393333348966526
test loss is 1.6112259134554914
test entropy is  0.9696773528290201
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.3813056945800781
mal norm is  tensor(709.7224, device='cuda:3')
distance x is tensor(181.8594, device='cuda:3')
mal distance is  tensor(181.8594, device='cuda:3')
user_PLR len size 52
counter_tensor is  tensor([12., 12., 23.,  0., 10., 12., 46., 12., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40.,  1., 48., 44., 21., 15., 12., 50., 47.,
        50., 46., 50.,  0., 38.,  0., 42., 44., 13., 45., 41., 17., 51., 12.,
        12.,  1., 50.,  0., 15., 50., 12.,  0.,  2., 12.])
count_res tensor([3.9472e-18, 3.9472e-18, 2.3634e-13, 2.4253e-23, 5.3420e-19, 3.9472e-18,
        2.3031e-03, 3.9472e-18, 5.7087e-06, 5.7087e-06, 5.7087e-06, 5.7087e-06,
        5.7087e-06, 5.7087e-06, 5.7087e-06, 5.7087e-06, 5.7087e-06, 5.7087e-06,
        5.7087e-06, 5.7087e-06, 6.5926e-23, 1.7017e-02, 3.1169e-04, 3.1985e-14,
        7.9282e-17, 3.9472e-18, 1.2574e-01, 6.2604e-03, 1.2574e-01, 2.3031e-03,
        1.2574e-01, 2.4253e-23, 7.7259e-07, 2.4253e-23, 4.2182e-05, 3.1169e-04,
        1.0730e-17, 8.4725e-04, 1.5518e-05, 5.8582e-16, 3.4180e-01, 3.9472e-18,
        3.9472e-18, 6.5926e-23, 1.2574e-01, 2.4253e-23, 7.9282e-17, 1.2574e-01,
        3.9472e-18, 2.4253e-23, 1.7920e-22, 3.9472e-18])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 89.79% 

Test Accuracy: 88.95% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.46588271856307983
distance x is tensor(104.7015, device='cuda:3')
benign distance is  tensor(104.7015, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5163007378578186
distance x is tensor(99.5783, device='cuda:3')
benign distance is  tensor(99.5783, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.13472740352153778
distance x is tensor(117.9419, device='cuda:3')
benign distance is  tensor(117.9419, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3052530884742737
distance x is tensor(108.1117, device='cuda:3')
benign distance is  tensor(108.1117, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.816031813621521
distance x is tensor(112.6306, device='cuda:3')
benign distance is  tensor(112.6306, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3484784662723541
distance x is tensor(126.3405, device='cuda:3')
benign distance is  tensor(126.3405, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.24255800247192383
distance x is tensor(110.7852, device='cuda:3')
benign distance is  tensor(110.7852, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2356068640947342
distance x is tensor(123.2678, device='cuda:3')
benign distance is  tensor(123.2678, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.43502718210220337
distance x is tensor(129.2865, device='cuda:3')
benign distance is  tensor(129.2865, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.20398345589637756
distance x is tensor(128.8220, device='cuda:3')
benign distance is  tensor(128.8220, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.2234352082014084
distance x is tensor(127.6243, device='cuda:3')
benign distance is  tensor(127.6243, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.1495845317840576
distance x is tensor(109.7211, device='cuda:3')
benign distance is  tensor(109.7211, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3146213889122009
distance x is tensor(117.8227, device='cuda:3')
benign distance is  tensor(117.8227, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.24867157638072968
distance x is tensor(104.6915, device='cuda:3')
benign distance is  tensor(104.6915, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2437271624803543
distance x is tensor(122.5776, device='cuda:3')
benign distance is  tensor(122.5776, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.32121920585632324
distance x is tensor(140.9542, device='cuda:3')
benign distance is  tensor(140.9542, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.1799435317516327
distance x is tensor(115.9798, device='cuda:3')
benign distance is  tensor(115.9798, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5688461661338806
distance x is tensor(132.3438, device='cuda:3')
benign distance is  tensor(132.3438, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.658490002155304
distance x is tensor(122.0751, device='cuda:3')
benign distance is  tensor(122.0751, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.23790483176708221
distance x is tensor(130.5469, device='cuda:3')
benign distance is  tensor(130.5469, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.6428021788597107
distance x is tensor(101.0042, device='cuda:3')
benign distance is  tensor(101.0042, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8084616661071777
distance x is tensor(112.5526, device='cuda:3')
benign distance is  tensor(112.5526, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.24695976078510284
distance x is tensor(133.9883, device='cuda:3')
benign distance is  tensor(133.9883, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.33966702222824097
distance x is tensor(118.9896, device='cuda:3')
benign distance is  tensor(118.9896, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.58631432056427
distance x is tensor(137.7747, device='cuda:3')
benign distance is  tensor(137.7747, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.2901007831096649
distance x is tensor(120.8402, device='cuda:3')
benign distance is  tensor(120.8402, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.16947057843208313
distance x is tensor(130.0520, device='cuda:3')
benign distance is  tensor(130.0520, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.884825587272644
distance x is tensor(133.9191, device='cuda:3')
benign distance is  tensor(133.9191, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.3024744391441345
distance x is tensor(126.4299, device='cuda:3')
benign distance is  tensor(126.4299, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.2127974033355713
distance x is tensor(134.4332, device='cuda:3')
benign distance is  tensor(134.4332, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.2792186141014099
distance x is tensor(129.8965, device='cuda:3')
benign distance is  tensor(129.8965, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.5321272611618042
distance x is tensor(129.8812, device='cuda:3')
benign distance is  tensor(129.8812, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.19639286398887634
distance x is tensor(132.7705, device='cuda:3')
benign distance is  tensor(132.7705, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.1560743749141693
distance x is tensor(119.8654, device='cuda:3')
benign distance is  tensor(119.8654, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.05878497287631035
distance x is tensor(119.7576, device='cuda:3')
benign distance is  tensor(119.7576, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.29850929975509644
distance x is tensor(131.5109, device='cuda:3')
benign distance is  tensor(131.5109, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.3299757242202759
distance x is tensor(121.2270, device='cuda:3')
benign distance is  tensor(121.2270, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.1076971292495728
distance x is tensor(127.8619, device='cuda:3')
benign distance is  tensor(127.8619, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.33596286177635193
distance x is tensor(121.0275, device='cuda:3')
benign distance is  tensor(121.0275, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.44912999868392944
distance x is tensor(137.9812, device='cuda:3')
benign distance is  tensor(137.9812, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(125.1758, device='cuda:3')
compute distance is  tensor(125.1758, device='cuda:3')
compute norm is  tensor(48.8873, device='cuda:3', dtype=torch.float64)
distance x is tensor(112.8596, device='cuda:3')
compute distance is  tensor(112.8596, device='cuda:3')
compute norm is  tensor(48.5425, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.6860, device='cuda:3')
compute distance is  tensor(128.6860, device='cuda:3')
compute norm is  tensor(49.0502, device='cuda:3', dtype=torch.float64)
distance x is tensor(110.8492, device='cuda:3')
compute distance is  tensor(110.8492, device='cuda:3')
compute norm is  tensor(48.4680, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.0574, device='cuda:3')
compute distance is  tensor(120.0574, device='cuda:3')
compute norm is  tensor(48.8386, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.7922, device='cuda:3')
compute distance is  tensor(115.7922, device='cuda:3')
compute norm is  tensor(48.7372, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.0254, device='cuda:3')
compute distance is  tensor(114.0254, device='cuda:3')
compute norm is  tensor(48.7065, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.3482, device='cuda:3')
compute distance is  tensor(125.3482, device='cuda:3')
compute norm is  tensor(48.8113, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.1532, device='cuda:3')
compute distance is  tensor(124.1532, device='cuda:3')
compute norm is  tensor(48.7825, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.4806, device='cuda:3')
compute distance is  tensor(121.4806, device='cuda:3')
compute norm is  tensor(48.8095, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.7225, device='cuda:3')
compute distance is  tensor(128.7225, device='cuda:3')
compute norm is  tensor(49.0007, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.2001, device='cuda:3')
compute distance is  tensor(122.2001, device='cuda:3')
compute norm is  tensor(48.9353, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(128.7225, device='cuda:3')
distance x is tensor(107728.5391, device='cuda:3')
distance x is tensor(107728.5391, device='cuda:3')
________________________________
test distance is  tensor(107728.5391, device='cuda:3')
test distance1 is  tensor(107728.5391, device='cuda:3')
test similarity is  tensor(-0.1041, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130044358915978.1
test entropy is  0.0
________________________________
cal ratio is  0.03387567901730834
distance x is tensor(3649.3831, device='cuda:3')
cal_distance is  tensor(3649.3831, device='cuda:3')
cal ratio is  0.18405331968428065
distance x is tensor(671.6852, device='cuda:3')
cal_distance is  tensor(671.6852, device='cuda:3')
cal ratio is  0.42901304282244135
distance x is tensor(288.1647, device='cuda:3')
cal_distance is  tensor(288.1647, device='cuda:3')
cal ratio is  0.6549874566875505
distance x is tensor(188.7461, device='cuda:3')
cal_distance is  tensor(188.7461, device='cuda:3')
cal ratio is  0.809309135025244
distance x is tensor(152.7549, device='cuda:3')
cal_distance is  tensor(152.7549, device='cuda:3')
cal ratio is  0.8996130974875195
distance x is tensor(137.4209, device='cuda:3')
cal_distance is  tensor(137.4209, device='cuda:3')
cal ratio is  0.9484775399015724
distance x is tensor(130.3409, device='cuda:3')
cal_distance is  tensor(130.3409, device='cuda:3')
cal ratio is  0.9738970962992677
distance x is tensor(126.9388, device='cuda:3')
cal_distance is  tensor(126.9388, device='cuda:3')
distance x is tensor(126.9388, device='cuda:3')
return_distance is  tensor(126.9388, device='cuda:3')
distance x is tensor(126.9284, device='cuda:3')
distance x is tensor(126.9284, device='cuda:3')
________________________________
test distance is  tensor(126.9284, device='cuda:3')
test distance1 is  tensor(126.9284, device='cuda:3')
test similarity is  tensor(0.9535, device='cuda:3')
test acc is  0.10008333348966532
test loss is 239.96624262958193
test entropy is  6.972694671404811e-05
________________________________
0
distance x is tensor(126.9284, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  6.430300995086951e-05
avg test loss is  240.009432973638
avg accuracy is  0.42858333348967476
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9535, device='cuda:3')
compute_distance is  tensor(126.9284, device='cuda:3')
compute_norm is  tensor(47.5399, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(110.3147, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9306324465569656
avg test loss is  1.4827775617144001
avg accuracy is  0.8197500001563246
solo acc is  0.33826666682300693
compute similarity  is  tensor(0.9587, device='cuda:3')
compute_distance is  tensor(110.3147, device='cuda:3')
compute_norm is  tensor(46.3815, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(113.0079, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8802422011839047
avg test loss is  1.54798599296033
avg accuracy is  0.8235833334896577
solo acc is  0.2855000001563392
compute similarity  is  tensor(0.9582, device='cuda:3')
compute_distance is  tensor(113.0079, device='cuda:3')
compute_norm is  tensor(46.0549, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(115.3904, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8794157395103593
avg test loss is  1.5089398086198103
avg accuracy is  0.8254833334896575
solo acc is  0.27625000015633894
compute similarity  is  tensor(0.9577, device='cuda:3')
compute_distance is  tensor(115.3904, device='cuda:3')
compute_norm is  tensor(45.7627, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(117.6219, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8669315570198906
avg test loss is  1.4697263996992538
avg accuracy is  0.8293500001563242
solo acc is  0.276750000156339
compute similarity  is  tensor(0.9573, device='cuda:3')
compute_distance is  tensor(117.6219, device='cuda:3')
compute_norm is  tensor(45.4908, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(119.7806, device='cuda:3')
distance x is tensor(119.7806, device='cuda:3')
________________________________
test distance is  tensor(119.7806, device='cuda:3')
test distance1 is  tensor(119.7806, device='cuda:3')
test similarity is  tensor(0.9570, device='cuda:3')
test acc is  0.27525000015633894
test loss is 1.43897380198497
test entropy is  0.8619306755980958
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.323792815208435
mal norm is  tensor(613.6476, device='cuda:3')
distance x is tensor(119.7881, device='cuda:3')
mal distance is  tensor(119.7881, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 18.39% 

Test Accuracy: 18.12% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7462920546531677
distance x is tensor(162.3991, device='cuda:3')
benign distance is  tensor(162.3991, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.400867223739624
distance x is tensor(159.0220, device='cuda:3')
benign distance is  tensor(159.0220, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.5389260053634644
distance x is tensor(164.2598, device='cuda:3')
benign distance is  tensor(164.2598, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5345050096511841
distance x is tensor(163.6708, device='cuda:3')
benign distance is  tensor(163.6708, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7791555523872375
distance x is tensor(159.4891, device='cuda:3')
benign distance is  tensor(159.4891, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.567527174949646
distance x is tensor(163.1611, device='cuda:3')
benign distance is  tensor(163.1611, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2530391812324524
distance x is tensor(156.7527, device='cuda:3')
benign distance is  tensor(156.7527, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7646923065185547
distance x is tensor(170.7215, device='cuda:3')
benign distance is  tensor(170.7215, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(156.1370, device='cuda:3')
compute distance is  tensor(156.1370, device='cuda:3')
compute norm is  tensor(47.2963, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.2382, device='cuda:3')
compute distance is  tensor(155.2382, device='cuda:3')
compute norm is  tensor(47.2053, device='cuda:3', dtype=torch.float64)
distance x is tensor(166.1415, device='cuda:3')
compute distance is  tensor(166.1415, device='cuda:3')
compute norm is  tensor(47.7342, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.0808, device='cuda:3')
compute distance is  tensor(162.0808, device='cuda:3')
compute norm is  tensor(47.5076, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.4135, device='cuda:3')
compute distance is  tensor(161.4135, device='cuda:3')
compute norm is  tensor(47.4869, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.9797, device='cuda:3')
compute distance is  tensor(159.9797, device='cuda:3')
compute norm is  tensor(47.5404, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.2813, device='cuda:3')
compute distance is  tensor(160.2813, device='cuda:3')
compute norm is  tensor(47.5157, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.6447, device='cuda:3')
compute distance is  tensor(153.6447, device='cuda:3')
compute norm is  tensor(47.3211, device='cuda:3', dtype=torch.float64)
distance x is tensor(171.6327, device='cuda:3')
compute distance is  tensor(171.6327, device='cuda:3')
compute norm is  tensor(47.6156, device='cuda:3', dtype=torch.float64)
distance x is tensor(166.1991, device='cuda:3')
compute distance is  tensor(166.1991, device='cuda:3')
compute norm is  tensor(47.5190, device='cuda:3', dtype=torch.float64)
distance x is tensor(180.9061, device='cuda:3')
compute distance is  tensor(180.9061, device='cuda:3')
compute norm is  tensor(47.8504, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.3854, device='cuda:3')
compute distance is  tensor(159.3854, device='cuda:3')
compute norm is  tensor(47.5290, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(180.9061, device='cuda:3')
distance x is tensor(107658.0312, device='cuda:3')
distance x is tensor(107658.0312, device='cuda:3')
________________________________
test distance is  tensor(107658.0312, device='cuda:3')
test distance1 is  tensor(107658.0312, device='cuda:3')
test similarity is  tensor(0.1489, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130166618048315.5
test entropy is  0.0
________________________________
cal ratio is  0.0401725501936553
distance x is tensor(4324.9033, device='cuda:3')
cal_distance is  tensor(4324.9033, device='cuda:3')
cal ratio is  0.2004307800200742
distance x is tensor(866.8480, device='cuda:3')
cal_distance is  tensor(866.8480, device='cuda:3')
cal ratio is  0.44769386827811575
distance x is tensor(388.0854, device='cuda:3')
cal_distance is  tensor(388.0854, device='cuda:3')
cal ratio is  0.6690968674906954
distance x is tensor(259.6684, device='cuda:3')
cal_distance is  tensor(259.6684, device='cuda:3')
cal ratio is  0.8179806824754714
distance x is tensor(212.4047, device='cuda:3')
cal_distance is  tensor(212.4047, device='cuda:3')
cal ratio is  0.9044208302382841
distance x is tensor(192.1038, device='cuda:3')
cal_distance is  tensor(192.1038, device='cuda:3')
cal ratio is  0.9510091450378876
distance x is tensor(182.6927, device='cuda:3')
cal_distance is  tensor(182.6927, device='cuda:3')
cal ratio is  0.9751962359359283
distance x is tensor(178.1613, device='cuda:3')
cal_distance is  tensor(178.1613, device='cuda:3')
distance x is tensor(178.1613, device='cuda:3')
return_distance is  tensor(178.1613, device='cuda:3')
distance x is tensor(178.1510, device='cuda:3')
distance x is tensor(178.1510, device='cuda:3')
________________________________
test distance is  tensor(178.1510, device='cuda:3')
test distance1 is  tensor(178.1510, device='cuda:3')
test similarity is  tensor(0.9235, device='cuda:3')
test acc is  0.10000000015633198
test loss is 1416.5493372284782
test entropy is  0.0
________________________________
0
distance x is tensor(178.1510, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  1417.358540939624
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9235, device='cuda:3')
compute_distance is  tensor(178.1510, device='cuda:3')
compute_norm is  tensor(49.4098, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1254.5481, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.6294482474896446
avg test loss is  2.857287252381412
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3888, device='cuda:3')
compute_distance is  tensor(1254.5481, device='cuda:3')
compute_norm is  tensor(118.9410, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1249.0599, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8798703339054132
avg test loss is  3.6812080071170703
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3889, device='cuda:3')
compute_distance is  tensor(1249.0599, device='cuda:3')
compute_norm is  tensor(118.5781, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1243.6190, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5675673066680111
avg test loss is  2.8563565160674074
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3888, device='cuda:3')
compute_distance is  tensor(1243.6190, device='cuda:3')
compute_norm is  tensor(117.9736, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1238.2002, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8622976657805412
avg test loss is  3.616504122453458
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3889, device='cuda:3')
compute_distance is  tensor(1238.2002, device='cuda:3')
compute_norm is  tensor(117.6072, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1232.6465, device='cuda:3')
distance x is tensor(1232.6465, device='cuda:3')
________________________________
test distance is  tensor(1232.6465, device='cuda:3')
test distance1 is  tensor(1232.6465, device='cuda:3')
test similarity is  tensor(0.3887, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8707858125792383
test entropy is  1.548254327352113
________________________________
cal ratio is  0.3754337810118151
distance x is tensor(462.7781, device='cuda:3')
cal_distance is  tensor(462.7781, device='cuda:3')
cal ratio is  0.6127258980935705
distance x is tensor(283.5563, device='cuda:3')
cal_distance is  tensor(283.5563, device='cuda:3')
cal ratio is  0.7827677958471859
distance x is tensor(221.9589, device='cuda:3')
cal_distance is  tensor(221.9589, device='cuda:3')
cal ratio is  0.8847413258161022
distance x is tensor(196.3763, device='cuda:3')
cal_distance is  tensor(196.3763, device='cuda:3')
cal ratio is  0.9406067847329006
distance x is tensor(184.7129, device='cuda:3')
cal_distance is  tensor(184.7129, device='cuda:3')
cal ratio is  0.9698487412238376
distance x is tensor(179.1436, device='cuda:3')
cal_distance is  tensor(179.1436, device='cuda:3')
distance x is tensor(179.1436, device='cuda:3')
return_distance is  tensor(179.1436, device='cuda:3')
distance x is tensor(179.1423, device='cuda:3')
distance x is tensor(179.1423, device='cuda:3')
________________________________
test distance is  tensor(179.1423, device='cuda:3')
test distance1 is  tensor(179.1423, device='cuda:3')
test similarity is  tensor(0.9355, device='cuda:3')
test acc is  0.09931666682299865
test loss is 2.641975967868813
test entropy is  1.980468540049311
________________________________
0
distance x is tensor(179.1423, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.9803201417678964
avg test loss is  2.6438428272824805
avg accuracy is  0.12081666682299859
solo acc is  0.09953333348966531
compute similarity  is  tensor(0.9355, device='cuda:3')
compute_distance is  tensor(179.1423, device='cuda:3')
compute_norm is  tensor(49.8946, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(179.9313, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.745765335651349
avg test loss is  3.0392455254028095
avg accuracy is  0.11543333348966527
solo acc is  0.10150000015633197
compute similarity  is  tensor(0.9351, device='cuda:3')
compute_distance is  tensor(179.9313, device='cuda:3')
compute_norm is  tensor(49.9330, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(182.5009, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0763912629216974
avg test loss is  1.8104505763887597
avg accuracy is  0.17335000015633484
solo acc is  0.19585000015633616
compute similarity  is  tensor(0.9349, device='cuda:3')
compute_distance is  tensor(182.5009, device='cuda:3')
compute_norm is  tensor(49.6408, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(182.1729, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6424853925003426
avg test loss is  2.5759500275288563
avg accuracy is  0.12831666682299858
solo acc is  0.10386666682299864
compute similarity  is  tensor(0.9347, device='cuda:3')
compute_distance is  tensor(182.1729, device='cuda:3')
compute_norm is  tensor(49.4917, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(183.9624, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9497085696598614
avg test loss is  1.6654320021173847
avg accuracy is  0.18810000015633577
solo acc is  0.2175500001563371
compute similarity  is  tensor(0.9344, device='cuda:3')
compute_distance is  tensor(183.9624, device='cuda:3')
compute_norm is  tensor(49.1845, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(183.9624, device='cuda:3')
distance x is tensor(183.9624, device='cuda:3')
________________________________
test distance is  tensor(183.9624, device='cuda:3')
test distance1 is  tensor(183.9624, device='cuda:3')
test similarity is  tensor(0.9344, device='cuda:3')
test acc is  0.21765000015633718
test loss is 1.6706702570671212
test entropy is  0.9486310641521584
________________________________
cal ratio is  0.9718249154754783
distance x is tensor(178.7783, device='cuda:3')
cal_distance is  tensor(178.7783, device='cuda:3')
distance x is tensor(178.7783, device='cuda:3')
return_distance is  tensor(178.7783, device='cuda:3')
distance x is tensor(178.7793, device='cuda:3')
distance x is tensor(178.7793, device='cuda:3')
________________________________
test distance is  tensor(178.7793, device='cuda:3')
test distance1 is  tensor(178.7793, device='cuda:3')
test similarity is  tensor(0.9377, device='cuda:3')
test acc is  0.21705000015633708
test loss is 1.6460973485700612
test entropy is  0.9820875221096885
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.4542158842086792
mal norm is  tensor(753.8194, device='cuda:3')
distance x is tensor(178.7783, device='cuda:3')
mal distance is  tensor(178.7783, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12.,  3., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 14., 27., 12., 12., 12., 25., 12., 27.])
count_res tensor([1.4324e-07, 1.4324e-07, 1.4324e-07, 1.4324e-07, 1.4324e-07, 1.4324e-07,
        1.4324e-07, 1.7678e-11, 7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06,
        7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06,
        7.8208e-06, 7.8208e-06, 1.0584e-06, 4.6827e-01, 1.4324e-07, 1.4324e-07,
        1.4324e-07, 6.3373e-02, 1.4324e-07, 4.6827e-01])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 89.18% 

Test Accuracy: 88.16% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.39131152629852295
distance x is tensor(125.0425, device='cuda:3')
benign distance is  tensor(125.0425, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7793005704879761
distance x is tensor(132.9723, device='cuda:3')
benign distance is  tensor(132.9723, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.08596061170101166
distance x is tensor(129.4848, device='cuda:3')
benign distance is  tensor(129.4848, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3053271770477295
distance x is tensor(117.6746, device='cuda:3')
benign distance is  tensor(117.6746, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.23732952773571014
distance x is tensor(124.4244, device='cuda:3')
benign distance is  tensor(124.4244, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8390321731567383
distance x is tensor(129.7202, device='cuda:3')
benign distance is  tensor(129.7202, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.7042566537857056
distance x is tensor(122.1258, device='cuda:3')
benign distance is  tensor(122.1258, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.46185317635536194
distance x is tensor(132.0217, device='cuda:3')
benign distance is  tensor(132.0217, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.5107412338256836
distance x is tensor(141.8528, device='cuda:3')
benign distance is  tensor(141.8528, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8245146870613098
distance x is tensor(104.0178, device='cuda:3')
benign distance is  tensor(104.0178, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4676731526851654
distance x is tensor(134.5886, device='cuda:3')
benign distance is  tensor(134.5886, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9439043998718262
distance x is tensor(131.2177, device='cuda:3')
benign distance is  tensor(131.2177, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5650758147239685
distance x is tensor(134.0754, device='cuda:3')
benign distance is  tensor(134.0754, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.5687704086303711
distance x is tensor(112.6206, device='cuda:3')
benign distance is  tensor(112.6206, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.3189091086387634
distance x is tensor(140.3356, device='cuda:3')
benign distance is  tensor(140.3356, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6942320466041565
distance x is tensor(110.9234, device='cuda:3')
benign distance is  tensor(110.9234, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(128.9808, device='cuda:3')
compute distance is  tensor(128.9808, device='cuda:3')
compute norm is  tensor(49.8190, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.4191, device='cuda:3')
compute distance is  tensor(139.4191, device='cuda:3')
compute norm is  tensor(49.9322, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.8372, device='cuda:3')
compute distance is  tensor(142.8372, device='cuda:3')
compute norm is  tensor(50.0946, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.1404, device='cuda:3')
compute distance is  tensor(126.1404, device='cuda:3')
compute norm is  tensor(49.6593, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.1151, device='cuda:3')
compute distance is  tensor(126.1151, device='cuda:3')
compute norm is  tensor(49.6599, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.5771, device='cuda:3')
compute distance is  tensor(123.5771, device='cuda:3')
compute norm is  tensor(49.8357, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.6518, device='cuda:3')
compute distance is  tensor(134.6518, device='cuda:3')
compute norm is  tensor(49.9864, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.0419, device='cuda:3')
compute distance is  tensor(144.0419, device='cuda:3')
compute norm is  tensor(49.9581, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.8422, device='cuda:3')
compute distance is  tensor(129.8422, device='cuda:3')
compute norm is  tensor(49.8693, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.7197, device='cuda:3')
compute distance is  tensor(143.7197, device='cuda:3')
compute norm is  tensor(50.1341, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.0324, device='cuda:3')
compute distance is  tensor(135.0324, device='cuda:3')
compute norm is  tensor(49.9011, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.9913, device='cuda:3')
compute distance is  tensor(135.9913, device='cuda:3')
compute norm is  tensor(49.9421, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(144.0419, device='cuda:3')
distance x is tensor(107733.9062, device='cuda:3')
distance x is tensor(107733.9062, device='cuda:3')
________________________________
test distance is  tensor(107733.9062, device='cuda:3')
test distance1 is  tensor(107733.9062, device='cuda:3')
test similarity is  tensor(-0.1022, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130045317596149.08
test entropy is  0.0
________________________________
cal ratio is  0.0358339201354623
distance x is tensor(3860.5337, device='cuda:3')
cal_distance is  tensor(3860.5337, device='cuda:3')
cal ratio is  0.18929836166733224
distance x is tensor(730.7969, device='cuda:3')
cal_distance is  tensor(730.7969, device='cuda:3')
cal ratio is  0.4350830627958532
distance x is tensor(317.9603, device='cuda:3')
cal_distance is  tensor(317.9603, device='cuda:3')
cal ratio is  0.6596051720965697
distance x is tensor(209.7300, device='cuda:3')
cal_distance is  tensor(209.7300, device='cuda:3')
cal ratio is  0.8121574286940701
distance x is tensor(170.3348, device='cuda:3')
cal_distance is  tensor(170.3348, device='cuda:3')
cal ratio is  0.901195128446336
distance x is tensor(153.5054, device='cuda:3')
cal_distance is  tensor(153.5054, device='cuda:3')
cal ratio is  0.9493113244145047
distance x is tensor(145.7247, device='cuda:3')
cal_distance is  tensor(145.7247, device='cuda:3')
cal ratio is  0.9743252336297763
distance x is tensor(141.9834, device='cuda:3')
cal_distance is  tensor(141.9834, device='cuda:3')
distance x is tensor(141.9834, device='cuda:3')
return_distance is  tensor(141.9834, device='cuda:3')
distance x is tensor(141.9730, device='cuda:3')
distance x is tensor(141.9730, device='cuda:3')
________________________________
test distance is  tensor(141.9730, device='cuda:3')
test distance1 is  tensor(141.9730, device='cuda:3')
test similarity is  tensor(0.9450, device='cuda:3')
test acc is  0.10003333348966531
test loss is 341.5580920319059
test entropy is  1.199593224041689e-05
________________________________
0
distance x is tensor(141.9730, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.065709572259294e-05
avg test loss is  341.3751464713611
avg accuracy is  0.2779333334896723
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9450, device='cuda:3')
compute_distance is  tensor(141.9730, device='cuda:3')
compute_norm is  tensor(48.7153, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(121.6154, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9596183010891303
avg test loss is  1.5175631568630112
avg accuracy is  0.7947500001563257
solo acc is  0.3326500001563402
compute similarity  is  tensor(0.9516, device='cuda:3')
compute_distance is  tensor(121.6154, device='cuda:3')
compute_norm is  tensor(47.5391, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(121.6154, device='cuda:3')
distance x is tensor(121.6154, device='cuda:3')
________________________________
test distance is  tensor(121.6154, device='cuda:3')
test distance1 is  tensor(121.6154, device='cuda:3')
test similarity is  tensor(0.9516, device='cuda:3')
test acc is  0.3332166668230069
test loss is 1.5166585985531431
test entropy is  0.9601305638040815
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.5388566255569458
mal norm is  tensor(671.7550, device='cuda:3')
distance x is tensor(121.6236, device='cuda:3')
mal distance is  tensor(121.6236, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([16., 35., 12., 34.,  0., 12., 32.,  0., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 13., 12., 32.,  0., 12., 18., 12.,  0.,
        33., 12., 34., 12., 14., 30., 20., 13.])
count_res tensor([2.8331e-09, 5.0566e-01, 5.1890e-11, 1.8602e-01, 3.1883e-16, 5.1890e-11,
        2.5175e-02, 3.1883e-16, 8.4454e-06, 8.4454e-06, 8.4454e-06, 8.4454e-06,
        8.4454e-06, 8.4454e-06, 8.4454e-06, 8.4454e-06, 8.4454e-06, 8.4454e-06,
        8.4454e-06, 8.4454e-06, 1.4105e-10, 5.1890e-11, 2.5175e-02, 3.1883e-16,
        5.1890e-11, 2.0934e-08, 5.1890e-11, 3.1883e-16, 6.8434e-02, 5.1890e-11,
        1.8602e-01, 5.1890e-11, 3.8342e-10, 3.4071e-03, 1.5468e-07, 1.4105e-10])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 89.39% 

Test Accuracy: 88.35% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5669257044792175
distance x is tensor(117.6133, device='cuda:3')
benign distance is  tensor(117.6133, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.2907491624355316
distance x is tensor(84.4674, device='cuda:3')
benign distance is  tensor(84.4674, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.009479380212724209
distance x is tensor(128.8425, device='cuda:3')
benign distance is  tensor(128.8425, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4866026043891907
distance x is tensor(99.9743, device='cuda:3')
benign distance is  tensor(99.9743, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2344234436750412
distance x is tensor(117.6929, device='cuda:3')
benign distance is  tensor(117.6929, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.40043526887893677
distance x is tensor(126.4157, device='cuda:3')
benign distance is  tensor(126.4157, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.43373164534568787
distance x is tensor(127.2079, device='cuda:3')
benign distance is  tensor(127.2079, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.33740153908729553
distance x is tensor(124.8184, device='cuda:3')
benign distance is  tensor(124.8184, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.07083755731582642
distance x is tensor(126.6872, device='cuda:3')
benign distance is  tensor(126.6872, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.44434109330177307
distance x is tensor(143.9052, device='cuda:3')
benign distance is  tensor(143.9052, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.29048314690589905
distance x is tensor(126.1676, device='cuda:3')
benign distance is  tensor(126.1676, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.09921945631504059
distance x is tensor(136.4446, device='cuda:3')
benign distance is  tensor(136.4446, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.1885250061750412
distance x is tensor(126.3552, device='cuda:3')
benign distance is  tensor(126.3552, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5342524647712708
distance x is tensor(129.6929, device='cuda:3')
benign distance is  tensor(129.6929, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2420388162136078
distance x is tensor(143.9751, device='cuda:3')
benign distance is  tensor(143.9751, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.20958571135997772
distance x is tensor(132.1700, device='cuda:3')
benign distance is  tensor(132.1700, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.26004427671432495
distance x is tensor(130.8882, device='cuda:3')
benign distance is  tensor(130.8882, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.3505052924156189
distance x is tensor(141.3525, device='cuda:3')
benign distance is  tensor(141.3525, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.37545663118362427
distance x is tensor(136.6070, device='cuda:3')
benign distance is  tensor(136.6070, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.08922500908374786
distance x is tensor(140.1671, device='cuda:3')
benign distance is  tensor(140.1671, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.3467026948928833
distance x is tensor(139.3310, device='cuda:3')
benign distance is  tensor(139.3310, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.6509866714477539
distance x is tensor(128.2525, device='cuda:3')
benign distance is  tensor(128.2525, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.17150887846946716
distance x is tensor(123.4664, device='cuda:3')
benign distance is  tensor(123.4664, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.28992825746536255
distance x is tensor(130.6776, device='cuda:3')
benign distance is  tensor(130.6776, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(131.8405, device='cuda:3')
compute distance is  tensor(131.8405, device='cuda:3')
compute norm is  tensor(50.2703, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.9312, device='cuda:3')
compute distance is  tensor(133.9312, device='cuda:3')
compute norm is  tensor(50.3339, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.8726, device='cuda:3')
compute distance is  tensor(130.8726, device='cuda:3')
compute norm is  tensor(50.3299, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.6301, device='cuda:3')
compute distance is  tensor(119.6301, device='cuda:3')
compute norm is  tensor(50.1352, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.2212, device='cuda:3')
compute distance is  tensor(131.2212, device='cuda:3')
compute norm is  tensor(50.3255, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.2669, device='cuda:3')
compute distance is  tensor(131.2669, device='cuda:3')
compute norm is  tensor(50.3060, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.6175, device='cuda:3')
compute distance is  tensor(137.6175, device='cuda:3')
compute norm is  tensor(50.4160, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.7505, device='cuda:3')
compute distance is  tensor(120.7505, device='cuda:3')
compute norm is  tensor(50.1258, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.1920, device='cuda:3')
compute distance is  tensor(138.1920, device='cuda:3')
compute norm is  tensor(50.4243, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.5223, device='cuda:3')
compute distance is  tensor(117.5223, device='cuda:3')
compute norm is  tensor(50.0836, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.4494, device='cuda:3')
compute distance is  tensor(123.4494, device='cuda:3')
compute norm is  tensor(50.2128, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.0171, device='cuda:3')
compute distance is  tensor(135.0171, device='cuda:3')
compute norm is  tensor(50.3714, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(138.1920, device='cuda:3')
distance x is tensor(107735.1953, device='cuda:3')
distance x is tensor(107735.1953, device='cuda:3')
________________________________
test distance is  tensor(107735.1953, device='cuda:3')
test distance1 is  tensor(107735.1953, device='cuda:3')
test similarity is  tensor(-0.1019, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130048146461920.89
test entropy is  0.0
________________________________
cal ratio is  0.03509851318384202
distance x is tensor(3781.3503, device='cuda:3')
cal_distance is  tensor(3781.3503, device='cuda:3')
cal ratio is  0.18734584732011142
distance x is tensor(708.4246, device='cuda:3')
cal_distance is  tensor(708.4246, device='cuda:3')
cal ratio is  0.4328333528776584
distance x is tensor(306.6327, device='cuda:3')
cal_distance is  tensor(306.6327, device='cuda:3')
cal ratio is  0.6578976010074007
distance x is tensor(201.7347, device='cuda:3')
cal_distance is  tensor(201.7347, device='cuda:3')
cal ratio is  0.8111052985077424
distance x is tensor(163.6291, device='cuda:3')
cal_distance is  tensor(163.6291, device='cuda:3')
cal ratio is  0.900611122958919
distance x is tensor(147.3667, device='cuda:3')
cal_distance is  tensor(147.3667, device='cuda:3')
cal ratio is  0.9490035893354279
distance x is tensor(139.8518, device='cuda:3')
cal_distance is  tensor(139.8518, device='cuda:3')
cal ratio is  0.9741671758734158
distance x is tensor(136.2392, device='cuda:3')
cal_distance is  tensor(136.2392, device='cuda:3')
distance x is tensor(136.2392, device='cuda:3')
return_distance is  tensor(136.2392, device='cuda:3')
distance x is tensor(136.2288, device='cuda:3')
distance x is tensor(136.2288, device='cuda:3')
________________________________
test distance is  tensor(136.2288, device='cuda:3')
test distance1 is  tensor(136.2288, device='cuda:3')
test similarity is  tensor(0.9503, device='cuda:3')
test acc is  0.10005000015633199
test loss is 327.39975912586203
test entropy is  1.858589401642255e-05
________________________________
0
distance x is tensor(136.2288, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.406198706322796e-05
avg test loss is  327.9669107465602
avg accuracy is  0.3060166668230063
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9503, device='cuda:3')
compute_distance is  tensor(136.2288, device='cuda:3')
compute_norm is  tensor(49.1069, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(118.6134, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9554546526245979
avg test loss is  1.4693726891520689
avg accuracy is  0.8003166668229922
solo acc is  0.34906666682300713
compute similarity  is  tensor(0.9560, device='cuda:3')
compute_distance is  tensor(118.6134, device='cuda:3')
compute_norm is  tensor(47.8927, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(121.4256, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8874548279019053
avg test loss is  1.5757661928246016
avg accuracy is  0.8008000001563254
solo acc is  0.2795166668230057
compute similarity  is  tensor(0.9554, device='cuda:3')
compute_distance is  tensor(121.4256, device='cuda:3')
compute_norm is  tensor(47.5643, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(123.6415, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8880391389703446
avg test loss is  1.5074652973522764
avg accuracy is  0.8071333334896583
solo acc is  0.2837500001563391
compute similarity  is  tensor(0.9550, device='cuda:3')
compute_distance is  tensor(123.6415, device='cuda:3')
compute_norm is  tensor(47.2688, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(125.7752, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8705276710265226
avg test loss is  1.5012161547441218
avg accuracy is  0.8109333334896583
solo acc is  0.2698166668230054
compute similarity  is  tensor(0.9546, device='cuda:3')
compute_distance is  tensor(125.7752, device='cuda:3')
compute_norm is  tensor(46.9918, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(127.8341, device='cuda:3')
distance x is tensor(127.8341, device='cuda:3')
________________________________
test distance is  tensor(127.8341, device='cuda:3')
test distance1 is  tensor(127.8341, device='cuda:3')
test similarity is  tensor(0.9542, device='cuda:3')
test acc is  0.2760666668230057
test loss is 1.4511803902669755
test entropy is  0.8763559753579626
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.3762047290802002
mal norm is  tensor(655.3902, device='cuda:3')
distance x is tensor(127.8417, device='cuda:3')
mal distance is  tensor(127.8417, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([12., 26., 26., 34., 35., 12., 35., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 34., 12., 13., 12., 15., 12., 12., 13.,
        12., 12., 35., 12., 12., 35., 12., 12.])
count_res tensor([2.1667e-11, 2.6057e-05, 2.6057e-05, 7.7674e-02, 2.1114e-01, 2.1667e-11,
        2.1114e-01, 2.1667e-11, 3.5264e-06, 3.5264e-06, 3.5264e-06, 3.5264e-06,
        3.5264e-06, 3.5264e-06, 3.5264e-06, 3.5264e-06, 3.5264e-06, 3.5264e-06,
        3.5264e-06, 3.5264e-06, 7.7674e-02, 2.1667e-11, 5.8897e-11, 2.1667e-11,
        4.3519e-10, 2.1667e-11, 2.1667e-11, 5.8897e-11, 2.1667e-11, 2.1667e-11,
        2.1114e-01, 2.1667e-11, 2.1667e-11, 2.1114e-01, 2.1667e-11, 2.1667e-11])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 89.70% 

Test Accuracy: 88.93% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.27576035261154175
distance x is tensor(132.8379, device='cuda:3')
benign distance is  tensor(132.8379, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7493869662284851
distance x is tensor(104.6111, device='cuda:3')
benign distance is  tensor(104.6111, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.08058517426252365
distance x is tensor(130.4681, device='cuda:3')
benign distance is  tensor(130.4681, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6001137495040894
distance x is tensor(115.3423, device='cuda:3')
benign distance is  tensor(115.3423, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5654466152191162
distance x is tensor(115.9624, device='cuda:3')
benign distance is  tensor(115.9624, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4419550895690918
distance x is tensor(128.7584, device='cuda:3')
benign distance is  tensor(128.7584, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.8253618478775024
distance x is tensor(112.8224, device='cuda:3')
benign distance is  tensor(112.8224, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.20926406979560852
distance x is tensor(129.9169, device='cuda:3')
benign distance is  tensor(129.9169, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.18992206454277039
distance x is tensor(133.8375, device='cuda:3')
benign distance is  tensor(133.8375, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.35554343461990356
distance x is tensor(109.0803, device='cuda:3')
benign distance is  tensor(109.0803, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7594782710075378
distance x is tensor(115.6724, device='cuda:3')
benign distance is  tensor(115.6724, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5149057507514954
distance x is tensor(135.5488, device='cuda:3')
benign distance is  tensor(135.5488, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7410711050033569
distance x is tensor(122.7697, device='cuda:3')
benign distance is  tensor(122.7697, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1721254140138626
distance x is tensor(104.8189, device='cuda:3')
benign distance is  tensor(104.8189, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.2655186653137207
distance x is tensor(143.5133, device='cuda:3')
benign distance is  tensor(143.5133, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7601660490036011
distance x is tensor(129.5536, device='cuda:3')
benign distance is  tensor(129.5536, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.24143746495246887
distance x is tensor(128.7360, device='cuda:3')
benign distance is  tensor(128.7360, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.48345404863357544
distance x is tensor(127.2420, device='cuda:3')
benign distance is  tensor(127.2420, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.3707163631916046
distance x is tensor(141.0177, device='cuda:3')
benign distance is  tensor(141.0177, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.4324866831302643
distance x is tensor(139.4123, device='cuda:3')
benign distance is  tensor(139.4123, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8754293322563171
distance x is tensor(126.5312, device='cuda:3')
benign distance is  tensor(126.5312, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.2485591471195221
distance x is tensor(134.3881, device='cuda:3')
benign distance is  tensor(134.3881, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.09863825887441635
distance x is tensor(123.4167, device='cuda:3')
benign distance is  tensor(123.4167, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.10725889354944229
distance x is tensor(134.4943, device='cuda:3')
benign distance is  tensor(134.4943, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(130.7630, device='cuda:3')
compute distance is  tensor(130.7630, device='cuda:3')
compute norm is  tensor(50.3242, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.9017, device='cuda:3')
compute distance is  tensor(116.9017, device='cuda:3')
compute norm is  tensor(50.1366, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.0195, device='cuda:3')
compute distance is  tensor(143.0195, device='cuda:3')
compute norm is  tensor(50.7992, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.5315, device='cuda:3')
compute distance is  tensor(125.5315, device='cuda:3')
compute norm is  tensor(50.4274, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.2018, device='cuda:3')
compute distance is  tensor(128.2018, device='cuda:3')
compute norm is  tensor(50.3562, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.5547, device='cuda:3')
compute distance is  tensor(136.5547, device='cuda:3')
compute norm is  tensor(50.5925, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.2740, device='cuda:3')
compute distance is  tensor(128.2740, device='cuda:3')
compute norm is  tensor(50.4659, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.7174, device='cuda:3')
compute distance is  tensor(130.7174, device='cuda:3')
compute norm is  tensor(50.3707, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.8061, device='cuda:3')
compute distance is  tensor(128.8061, device='cuda:3')
compute norm is  tensor(50.3794, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.7126, device='cuda:3')
compute distance is  tensor(116.7126, device='cuda:3')
compute norm is  tensor(50.3388, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.9696, device='cuda:3')
compute distance is  tensor(135.9696, device='cuda:3')
compute norm is  tensor(50.5726, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.7856, device='cuda:3')
compute distance is  tensor(132.7856, device='cuda:3')
compute norm is  tensor(50.4573, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(143.0195, device='cuda:3')
distance x is tensor(107734.4219, device='cuda:3')
distance x is tensor(107734.4219, device='cuda:3')
________________________________
test distance is  tensor(107734.4219, device='cuda:3')
test distance1 is  tensor(107734.4219, device='cuda:3')
test similarity is  tensor(-0.1011, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130141291624504.77
test entropy is  0.0
________________________________
cal ratio is  0.03570642929990729
distance x is tensor(3846.8176, device='cuda:3')
cal_distance is  tensor(3846.8176, device='cuda:3')
cal ratio is  0.18896129857959046
distance x is tensor(726.9038, device='cuda:3')
cal_distance is  tensor(726.9038, device='cuda:3')
cal ratio is  0.43469554528251253
distance x is tensor(315.9848, device='cuda:3')
cal_distance is  tensor(315.9848, device='cuda:3')
cal ratio is  0.6593114021509823
distance x is tensor(208.3341, device='cuda:3')
cal_distance is  tensor(208.3341, device='cuda:3')
cal ratio is  0.8119764754858599
distance x is tensor(169.1634, device='cuda:3')
cal_distance is  tensor(169.1634, device='cuda:3')
cal ratio is  0.901094728816258
distance x is tensor(152.4328, device='cuda:3')
cal_distance is  tensor(152.4328, device='cuda:3')
cal ratio is  0.9492583787722614
distance x is tensor(144.6984, device='cuda:3')
cal_distance is  tensor(144.6984, device='cuda:3')
cal ratio is  0.9742980307201375
distance x is tensor(140.9795, device='cuda:3')
cal_distance is  tensor(140.9795, device='cuda:3')
distance x is tensor(140.9795, device='cuda:3')
return_distance is  tensor(140.9795, device='cuda:3')
distance x is tensor(140.9691, device='cuda:3')
distance x is tensor(140.9691, device='cuda:3')
________________________________
test distance is  tensor(140.9691, device='cuda:3')
test distance1 is  tensor(140.9691, device='cuda:3')
test similarity is  tensor(0.9471, device='cuda:3')
test acc is  0.10005000015633199
test loss is 381.3520229965893
test entropy is  1.248312299770398e-05
________________________________
0
distance x is tensor(140.9691, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.245286660929966e-05
avg test loss is  381.1201182936809
avg accuracy is  0.26268333348967193
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9471, device='cuda:3')
compute_distance is  tensor(140.9691, device='cuda:3')
compute_norm is  tensor(49.3369, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(119.2810, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9223955028982305
avg test loss is  1.55739458461306
avg accuracy is  0.8040000001563253
solo acc is  0.3280666668230067
compute similarity  is  tensor(0.9538, device='cuda:3')
compute_distance is  tensor(119.2810, device='cuda:3')
compute_norm is  tensor(48.1267, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(121.9266, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9042115520948032
avg test loss is  1.5831941394155213
avg accuracy is  0.808600000156325
solo acc is  0.27886666682300565
compute similarity  is  tensor(0.9533, device='cuda:3')
compute_distance is  tensor(121.9266, device='cuda:3')
compute_norm is  tensor(47.7868, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(124.2474, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.882177319099654
avg test loss is  1.5260760960802595
avg accuracy is  0.8145833334896582
solo acc is  0.2809666668230057
compute similarity  is  tensor(0.9529, device='cuda:3')
compute_distance is  tensor(124.2474, device='cuda:3')
compute_norm is  tensor(47.4860, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(126.5819, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8681413678726407
avg test loss is  1.505923953900205
avg accuracy is  0.817933333489658
solo acc is  0.27161666682300545
compute similarity  is  tensor(0.9524, device='cuda:3')
compute_distance is  tensor(126.5819, device='cuda:3')
compute_norm is  tensor(47.2007, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(128.8163, device='cuda:3')
distance x is tensor(128.8163, device='cuda:3')
________________________________
test distance is  tensor(128.8163, device='cuda:3')
test distance1 is  tensor(128.8163, device='cuda:3')
test similarity is  tensor(0.9520, device='cuda:3')
test acc is  0.27023333348967216
test loss is 1.4726126210521788
test entropy is  0.8656895911769826
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.5775282382965088
mal norm is  tensor(671.8772, device='cuda:3')
distance x is tensor(128.8239, device='cuda:3')
mal distance is  tensor(128.8239, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 18.02% 

Test Accuracy: 17.36% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4815065860748291
distance x is tensor(163.2933, device='cuda:3')
benign distance is  tensor(163.2933, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8432193994522095
distance x is tensor(172.0754, device='cuda:3')
benign distance is  tensor(172.0754, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2028755247592926
distance x is tensor(175.9726, device='cuda:3')
benign distance is  tensor(175.9726, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6037018895149231
distance x is tensor(174.7225, device='cuda:3')
benign distance is  tensor(174.7225, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6068657636642456
distance x is tensor(163.3252, device='cuda:3')
benign distance is  tensor(163.3252, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4240047335624695
distance x is tensor(168.7795, device='cuda:3')
benign distance is  tensor(168.7795, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.42672115564346313
distance x is tensor(162.7767, device='cuda:3')
benign distance is  tensor(162.7767, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.42578238248825073
distance x is tensor(176.4783, device='cuda:3')
benign distance is  tensor(176.4783, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(161.3765, device='cuda:3')
compute distance is  tensor(161.3765, device='cuda:3')
compute norm is  tensor(48.9396, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.5609, device='cuda:3')
compute distance is  tensor(165.5609, device='cuda:3')
compute norm is  tensor(49.0019, device='cuda:3', dtype=torch.float64)
distance x is tensor(175.1516, device='cuda:3')
compute distance is  tensor(175.1516, device='cuda:3')
compute norm is  tensor(49.3644, device='cuda:3', dtype=torch.float64)
distance x is tensor(174.4476, device='cuda:3')
compute distance is  tensor(174.4476, device='cuda:3')
compute norm is  tensor(49.2581, device='cuda:3', dtype=torch.float64)
distance x is tensor(179.4714, device='cuda:3')
compute distance is  tensor(179.4714, device='cuda:3')
compute norm is  tensor(49.6285, device='cuda:3', dtype=torch.float64)
distance x is tensor(186.3358, device='cuda:3')
compute distance is  tensor(186.3358, device='cuda:3')
compute norm is  tensor(49.6196, device='cuda:3', dtype=torch.float64)
distance x is tensor(179.3885, device='cuda:3')
compute distance is  tensor(179.3885, device='cuda:3')
compute norm is  tensor(49.4307, device='cuda:3', dtype=torch.float64)
distance x is tensor(168.3733, device='cuda:3')
compute distance is  tensor(168.3733, device='cuda:3')
compute norm is  tensor(49.2405, device='cuda:3', dtype=torch.float64)
distance x is tensor(174.3117, device='cuda:3')
compute distance is  tensor(174.3117, device='cuda:3')
compute norm is  tensor(49.2525, device='cuda:3', dtype=torch.float64)
distance x is tensor(176.8121, device='cuda:3')
compute distance is  tensor(176.8121, device='cuda:3')
compute norm is  tensor(49.4345, device='cuda:3', dtype=torch.float64)
distance x is tensor(168.5761, device='cuda:3')
compute distance is  tensor(168.5761, device='cuda:3')
compute norm is  tensor(49.2647, device='cuda:3', dtype=torch.float64)
distance x is tensor(171.4107, device='cuda:3')
compute distance is  tensor(171.4107, device='cuda:3')
compute norm is  tensor(49.3477, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(186.3358, device='cuda:3')
distance x is tensor(107660.1719, device='cuda:3')
distance x is tensor(107660.1719, device='cuda:3')
________________________________
test distance is  tensor(107660.1719, device='cuda:3')
test distance1 is  tensor(107660.1719, device='cuda:3')
test similarity is  tensor(0.1665, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130054249594565.6
test entropy is  0.0
________________________________
cal ratio is  0.04077055973672008
distance x is tensor(4389.3716, device='cuda:3')
cal_distance is  tensor(4389.3716, device='cuda:3')
cal ratio is  0.20191707145749987
distance x is tensor(886.2931, device='cuda:3')
cal_distance is  tensor(886.2931, device='cuda:3')
cal ratio is  0.4493508072377224
distance x is tensor(398.2593, device='cuda:3')
cal_distance is  tensor(398.2593, device='cuda:3')
cal ratio is  0.6703339552924661
distance x is tensor(266.9685, device='cuda:3')
cal_distance is  tensor(266.9685, device='cuda:3')
cal ratio is  0.8187366336139132
distance x is tensor(218.5778, device='cuda:3')
cal_distance is  tensor(218.5778, device='cuda:3')
cal ratio is  0.9048387580882755
distance x is tensor(197.7782, device='cuda:3')
cal_distance is  tensor(197.7782, device='cuda:3')
cal ratio is  0.9512289452697736
distance x is tensor(188.1326, device='cuda:3')
cal_distance is  tensor(188.1326, device='cuda:3')
cal ratio is  0.9753089339787867
distance x is tensor(183.4875, device='cuda:3')
cal_distance is  tensor(183.4875, device='cuda:3')
distance x is tensor(183.4875, device='cuda:3')
return_distance is  tensor(183.4875, device='cuda:3')
distance x is tensor(183.4772, device='cuda:3')
distance x is tensor(183.4772, device='cuda:3')
________________________________
test distance is  tensor(183.4772, device='cuda:3')
test distance1 is  tensor(183.4772, device='cuda:3')
test similarity is  tensor(0.9263, device='cuda:3')
test acc is  0.10000000015633198
test loss is 1400.6141494067747
test entropy is  0.0
________________________________
0
distance x is tensor(183.4772, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  1401.19268694717
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9263, device='cuda:3')
compute_distance is  tensor(183.4772, device='cuda:3')
compute_norm is  tensor(51.3429, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1794.1293, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.6313945074071254
avg test loss is  2.849777884320664
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2302, device='cuda:3')
compute_distance is  tensor(1794.1293, device='cuda:3')
compute_norm is  tensor(190.1748, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1786.1592, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.870581204321847
avg test loss is  3.684492045374059
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2303, device='cuda:3')
compute_distance is  tensor(1786.1592, device='cuda:3')
compute_norm is  tensor(189.5224, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1778.1688, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.571735502306078
avg test loss is  2.853530025431342
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2302, device='cuda:3')
compute_distance is  tensor(1778.1688, device='cuda:3')
compute_norm is  tensor(188.5263, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1770.2800, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8530382023437191
avg test loss is  3.6259449476372203
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2303, device='cuda:3')
compute_distance is  tensor(1770.2800, device='cuda:3')
compute_norm is  tensor(187.8616, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1762.2150, device='cuda:3')
distance x is tensor(1762.2150, device='cuda:3')
________________________________
test distance is  tensor(1762.2150, device='cuda:3')
test distance1 is  tensor(1762.2150, device='cuda:3')
test similarity is  tensor(0.2302, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8646997251490287
test entropy is  1.5525741347117719
________________________________
cal ratio is  0.31867263509552635
distance x is tensor(561.5704, device='cuda:3')
cal_distance is  tensor(561.5704, device='cuda:3')
cal ratio is  0.5645106193326673
distance x is tensor(317.0126, device='cuda:3')
cal_distance is  tensor(317.0126, device='cuda:3')
cal ratio is  0.7513389813825916
distance x is tensor(238.1841, device='cuda:3')
cal_distance is  tensor(238.1841, device='cuda:3')
cal ratio is  0.8667978696606823
distance x is tensor(206.4575, device='cuda:3')
cal_distance is  tensor(206.4575, device='cuda:3')
cal ratio is  0.9310196313294075
distance x is tensor(192.2160, device='cuda:3')
cal_distance is  tensor(192.2160, device='cuda:3')
cal ratio is  0.9648935352284208
distance x is tensor(185.4680, device='cuda:3')
cal_distance is  tensor(185.4680, device='cuda:3')
distance x is tensor(185.4680, device='cuda:3')
return_distance is  tensor(185.4680, device='cuda:3')
distance x is tensor(185.4670, device='cuda:3')
distance x is tensor(185.4670, device='cuda:3')
________________________________
test distance is  tensor(185.4670, device='cuda:3')
test distance1 is  tensor(185.4670, device='cuda:3')
test similarity is  tensor(0.8783, device='cuda:3')
test acc is  0.12376666682299858
test loss is 4.148446101623811
test entropy is  0.9857591147234699
________________________________
0
distance x is tensor(185.4670, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.9862643260437288
avg test loss is  4.141677709022311
avg accuracy is  0.11393333348966526
solo acc is  0.12498333348966525
compute similarity  is  tensor(0.8783, device='cuda:3')
compute_distance is  tensor(185.4670, device='cuda:3')
compute_norm is  tensor(55.1841, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(189.9896, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.21483054305953
avg test loss is  2.0750150714855966
avg accuracy is  0.10771666682299862
solo acc is  0.13765000015633203
compute similarity  is  tensor(0.8778, device='cuda:3')
compute_distance is  tensor(189.9896, device='cuda:3')
compute_norm is  tensor(54.9466, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(190.1079, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.7142548612567153
avg test loss is  2.789653414348041
avg accuracy is  0.10216666682299863
solo acc is  0.10146666682299864
compute similarity  is  tensor(0.8776, device='cuda:3')
compute_distance is  tensor(190.1079, device='cuda:3')
compute_norm is  tensor(54.8130, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(192.2154, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.1152261617595454
avg test loss is  1.9317983298667714
avg accuracy is  0.11508333348966528
solo acc is  0.1544833334896669
compute similarity  is  tensor(0.8773, device='cuda:3')
compute_distance is  tensor(192.2154, device='cuda:3')
compute_norm is  tensor(54.5156, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(191.9618, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6315999368487645
avg test loss is  2.659284574136551
avg accuracy is  0.10456666682299863
solo acc is  0.1036333334896653
compute similarity  is  tensor(0.8771, device='cuda:3')
compute_distance is  tensor(191.9618, device='cuda:3')
compute_norm is  tensor(54.3430, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(193.8658, device='cuda:3')
distance x is tensor(193.8658, device='cuda:3')
________________________________
test distance is  tensor(193.8658, device='cuda:3')
test distance1 is  tensor(193.8658, device='cuda:3')
test similarity is  tensor(0.8767, device='cuda:3')
test acc is  0.19455000015633608
test loss is 1.7754367470487094
test entropy is  1.0137670487483172
________________________________
cal ratio is  0.9607791225765272
distance x is tensor(186.2607, device='cuda:3')
cal_distance is  tensor(186.2607, device='cuda:3')
distance x is tensor(186.2607, device='cuda:3')
return_distance is  tensor(186.2607, device='cuda:3')
distance x is tensor(186.2623, device='cuda:3')
distance x is tensor(186.2623, device='cuda:3')
________________________________
test distance is  tensor(186.2623, device='cuda:3')
test distance1 is  tensor(186.2623, device='cuda:3')
test similarity is  tensor(0.8846, device='cuda:3')
test acc is  0.18320000015633545
test loss is 1.8031626175969904
test entropy is  1.0133930432643972
________________________________
0
distance x is tensor(186.2623, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0112197722580387
avg test loss is  1.8056812008052492
avg accuracy is  0.11170000015633194
solo acc is  0.18625000015633564
compute similarity  is  tensor(0.8846, device='cuda:3')
compute_distance is  tensor(186.2623, device='cuda:3')
compute_norm is  tensor(53.6176, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(186.4550, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6150267431413187
avg test loss is  2.5682902520399358
avg accuracy is  0.10481666682299862
solo acc is  0.10216666682299863
compute similarity  is  tensor(0.8844, device='cuda:3')
compute_distance is  tensor(186.4550, device='cuda:3')
compute_norm is  tensor(53.4250, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(188.7108, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0106911042224624
avg test loss is  1.677962683030029
avg accuracy is  0.11403333348966527
solo acc is  0.18448333348966894
compute similarity  is  tensor(0.8839, device='cuda:3')
compute_distance is  tensor(188.7108, device='cuda:3')
compute_norm is  tensor(53.1415, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(188.9118, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6141123511770895
avg test loss is  2.443782514346434
avg accuracy is  0.10523333348966529
solo acc is  0.10245000015633197
compute similarity  is  tensor(0.8837, device='cuda:3')
compute_distance is  tensor(188.9118, device='cuda:3')
compute_norm is  tensor(52.9449, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(191.0656, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0357302025055835
avg test loss is  1.617979182363319
avg accuracy is  0.11945000015633192
solo acc is  0.18601666682300227
compute similarity  is  tensor(0.8831, device='cuda:3')
compute_distance is  tensor(191.0656, device='cuda:3')
compute_norm is  tensor(52.6709, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(191.2573, device='cuda:3')
________________________________
test distance is  tensor(191.2573, device='cuda:3')
test similarity is  tensor(0.8830, device='cuda:3')
test acc is  0.10660000015633195
test loss is 2.37457293208474
test entropy is  0.6046741147603053
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 2.0832345485687256
mal norm is  tensor(1103.0564, device='cuda:3')
distance x is tensor(191.2573, device='cuda:3')
mal distance is  tensor(191.2573, device='cuda:3')
user_PLR len size 44
counter_tensor is  tensor([ 0.,  0.,  0.,  0., 40., 14., 12., 12., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 12., 42., 12., 43., 12., 41., 43., 41.,
        12., 17.,  0., 12., 41., 24.,  0.,  0.,  0., 43., 43., 43., 40., 17.,
         0., 12.])
count_res tensor([3.6010e-20, 3.6010e-20, 3.6010e-20, 3.6010e-20, 8.4763e-03, 4.3306e-14,
        5.8609e-15, 5.8609e-15, 2.8435e-06, 2.8435e-06, 2.8435e-06, 2.8435e-06,
        2.8435e-06, 2.8435e-06, 2.8435e-06, 2.8435e-06, 2.8435e-06, 2.8435e-06,
        2.8435e-06, 2.8435e-06, 5.8609e-15, 6.2632e-02, 5.8609e-15, 1.7025e-01,
        5.8609e-15, 2.3041e-02, 1.7025e-01, 2.3041e-02, 5.8609e-15, 8.6983e-13,
        3.6010e-20, 5.8609e-15, 2.3041e-02, 9.5389e-10, 3.6010e-20, 3.6010e-20,
        3.6010e-20, 1.7025e-01, 1.7025e-01, 1.7025e-01, 8.4763e-03, 8.6983e-13,
        3.6010e-20, 5.8609e-15])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 89.53% 

Test Accuracy: 88.91% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.593582808971405
distance x is tensor(101.8074, device='cuda:3')
benign distance is  tensor(101.8074, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1139646768569946
distance x is tensor(104.8673, device='cuda:3')
benign distance is  tensor(104.8673, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.23208875954151154
distance x is tensor(124.1179, device='cuda:3')
benign distance is  tensor(124.1179, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7260351181030273
distance x is tensor(114.1642, device='cuda:3')
benign distance is  tensor(114.1642, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.3073391914367676
distance x is tensor(104.9606, device='cuda:3')
benign distance is  tensor(104.9606, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7206782102584839
distance x is tensor(141.9579, device='cuda:3')
benign distance is  tensor(141.9579, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6009010076522827
distance x is tensor(116.5133, device='cuda:3')
benign distance is  tensor(116.5133, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4059913754463196
distance x is tensor(125.6988, device='cuda:3')
benign distance is  tensor(125.6988, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.22935721278190613
distance x is tensor(138.8649, device='cuda:3')
benign distance is  tensor(138.8649, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.2538638114929199
distance x is tensor(115.7463, device='cuda:3')
benign distance is  tensor(115.7463, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4267922043800354
distance x is tensor(123.2082, device='cuda:3')
benign distance is  tensor(123.2082, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.46004533767700195
distance x is tensor(105.0642, device='cuda:3')
benign distance is  tensor(105.0642, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.8587497472763062
distance x is tensor(133.5830, device='cuda:3')
benign distance is  tensor(133.5830, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6309970617294312
distance x is tensor(111.3110, device='cuda:3')
benign distance is  tensor(111.3110, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5850278735160828
distance x is tensor(132.0639, device='cuda:3')
benign distance is  tensor(132.0639, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4110693335533142
distance x is tensor(137.1239, device='cuda:3')
benign distance is  tensor(137.1239, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3801637887954712
distance x is tensor(128.5337, device='cuda:3')
benign distance is  tensor(128.5337, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.764642059803009
distance x is tensor(140.4095, device='cuda:3')
benign distance is  tensor(140.4095, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.4356614053249359
distance x is tensor(120.4997, device='cuda:3')
benign distance is  tensor(120.4997, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.4230143427848816
distance x is tensor(127.1256, device='cuda:3')
benign distance is  tensor(127.1256, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.1926760971546173
distance x is tensor(109.1650, device='cuda:3')
benign distance is  tensor(109.1650, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6362285017967224
distance x is tensor(118.0715, device='cuda:3')
benign distance is  tensor(118.0715, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.41393351554870605
distance x is tensor(145.3834, device='cuda:3')
benign distance is  tensor(145.3834, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.14830979704856873
distance x is tensor(118.9132, device='cuda:3')
benign distance is  tensor(118.9132, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.38311606645584106
distance x is tensor(128.9125, device='cuda:3')
benign distance is  tensor(128.9125, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.4765966534614563
distance x is tensor(127.2151, device='cuda:3')
benign distance is  tensor(127.2151, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.05496493726968765
distance x is tensor(118.5170, device='cuda:3')
benign distance is  tensor(118.5170, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.3145262897014618
distance x is tensor(127.0808, device='cuda:3')
benign distance is  tensor(127.0808, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.2559835910797119
distance x is tensor(129.1527, device='cuda:3')
benign distance is  tensor(129.1527, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6958776116371155
distance x is tensor(129.3149, device='cuda:3')
benign distance is  tensor(129.3149, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.3542265295982361
distance x is tensor(117.6667, device='cuda:3')
benign distance is  tensor(117.6667, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.3938536047935486
distance x is tensor(137.3369, device='cuda:3')
benign distance is  tensor(137.3369, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(123.7459, device='cuda:3')
compute distance is  tensor(123.7459, device='cuda:3')
compute norm is  tensor(49.9646, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.9242, device='cuda:3')
compute distance is  tensor(119.9242, device='cuda:3')
compute norm is  tensor(50.0050, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.3365, device='cuda:3')
compute distance is  tensor(137.3365, device='cuda:3')
compute norm is  tensor(50.4078, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.5471, device='cuda:3')
compute distance is  tensor(118.5471, device='cuda:3')
compute norm is  tensor(49.9554, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.3116, device='cuda:3')
compute distance is  tensor(123.3116, device='cuda:3')
compute norm is  tensor(49.9847, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.8621, device='cuda:3')
compute distance is  tensor(127.8621, device='cuda:3')
compute norm is  tensor(50.2143, device='cuda:3', dtype=torch.float64)
distance x is tensor(115.0409, device='cuda:3')
compute distance is  tensor(115.0409, device='cuda:3')
compute norm is  tensor(49.9216, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.4771, device='cuda:3')
compute distance is  tensor(127.4771, device='cuda:3')
compute norm is  tensor(50.2027, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.3029, device='cuda:3')
compute distance is  tensor(131.3029, device='cuda:3')
compute norm is  tensor(50.2193, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.4046, device='cuda:3')
compute distance is  tensor(119.4046, device='cuda:3')
compute norm is  tensor(49.9524, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.3714, device='cuda:3')
compute distance is  tensor(130.3714, device='cuda:3')
compute norm is  tensor(50.1756, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.8867, device='cuda:3')
compute distance is  tensor(131.8867, device='cuda:3')
compute norm is  tensor(50.2952, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(137.3365, device='cuda:3')
distance x is tensor(107732.6875, device='cuda:3')
distance x is tensor(107732.6875, device='cuda:3')
________________________________
test distance is  tensor(107732.6875, device='cuda:3')
test distance1 is  tensor(107732.6875, device='cuda:3')
test similarity is  tensor(-0.1026, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130121385260973.03
test entropy is  0.0
________________________________
cal ratio is  0.03499010667077582
distance x is tensor(3769.5833, device='cuda:3')
cal_distance is  tensor(3769.5833, device='cuda:3')
cal ratio is  0.1870563019878518
distance x is tensor(705.1285, device='cuda:3')
cal_distance is  tensor(705.1285, device='cuda:3')
cal ratio is  0.432498784173789
distance x is tensor(304.9702, device='cuda:3')
cal_distance is  tensor(304.9702, device='cuda:3')
cal ratio is  0.6576431535126916
distance x is tensor(200.5634, device='cuda:3')
cal_distance is  tensor(200.5634, device='cuda:3')
cal ratio is  0.8109483936144082
distance x is tensor(162.6475, device='cuda:3')
cal_distance is  tensor(162.6475, device='cuda:3')
cal ratio is  0.9005240075471149
distance x is tensor(146.4685, device='cuda:3')
cal_distance is  tensor(146.4685, device='cuda:3')
cal ratio is  0.9489577447042862
distance x is tensor(138.9927, device='cuda:3')
cal_distance is  tensor(138.9927, device='cuda:3')
cal ratio is  0.9741436706710735
distance x is tensor(135.3990, device='cuda:3')
cal_distance is  tensor(135.3990, device='cuda:3')
distance x is tensor(135.3990, device='cuda:3')
return_distance is  tensor(135.3990, device='cuda:3')
distance x is tensor(135.3886, device='cuda:3')
distance x is tensor(135.3886, device='cuda:3')
________________________________
test distance is  tensor(135.3886, device='cuda:3')
test distance1 is  tensor(135.3886, device='cuda:3')
test similarity is  tensor(0.9502, device='cuda:3')
test acc is  0.10020000015633199
test loss is 311.0742941980423
test entropy is  6.055279516504266e-05
________________________________
0
distance x is tensor(135.3886, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.3648592293064984e-05
avg test loss is  311.28038405558704
avg accuracy is  0.3781666668230075
solo acc is  0.10018333348966532
compute similarity  is  tensor(0.9502, device='cuda:3')
compute_distance is  tensor(135.3886, device='cuda:3')
compute_norm is  tensor(48.9293, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(116.7115, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9204453972102736
avg test loss is  1.5510554198008866
avg accuracy is  0.8214166668229911
solo acc is  0.32428333348967336
compute similarity  is  tensor(0.9561, device='cuda:3')
compute_distance is  tensor(116.7115, device='cuda:3')
compute_norm is  tensor(47.7183, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(119.3343, device='cuda:3')
exit early
distance x is tensor(119.3343, device='cuda:3')
distance x is tensor(119.3343, device='cuda:3')
________________________________
test distance is  tensor(119.3343, device='cuda:3')
test distance1 is  tensor(119.3343, device='cuda:3')
test similarity is  tensor(0.9556, device='cuda:3')
test acc is  0.29150000015633937
test loss is 1.5491862457189987
test entropy is  0.8919460035717564
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.7800174951553345
mal norm is  tensor(643.2073, device='cuda:3')
distance x is tensor(119.3419, device='cuda:3')
mal distance is  tensor(119.3419, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 20.48% 

Test Accuracy: 19.92% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7292059063911438
distance x is tensor(171.2283, device='cuda:3')
benign distance is  tensor(171.2283, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.15977196395397186
distance x is tensor(166.9791, device='cuda:3')
benign distance is  tensor(166.9791, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.29753929376602173
distance x is tensor(172.1157, device='cuda:3')
benign distance is  tensor(172.1157, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7786978483200073
distance x is tensor(169.5632, device='cuda:3')
benign distance is  tensor(169.5632, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6131149530410767
distance x is tensor(176.2061, device='cuda:3')
benign distance is  tensor(176.2061, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1468336582183838
distance x is tensor(183.5549, device='cuda:3')
benign distance is  tensor(183.5549, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.28822144865989685
distance x is tensor(178.6072, device='cuda:3')
benign distance is  tensor(178.6072, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.30931800603866577
distance x is tensor(178.6989, device='cuda:3')
benign distance is  tensor(178.6989, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(168.4124, device='cuda:3')
compute distance is  tensor(168.4124, device='cuda:3')
compute norm is  tensor(49.1937, device='cuda:3', dtype=torch.float64)
distance x is tensor(179.5307, device='cuda:3')
compute distance is  tensor(179.5307, device='cuda:3')
compute norm is  tensor(49.4203, device='cuda:3', dtype=torch.float64)
distance x is tensor(183.3165, device='cuda:3')
compute distance is  tensor(183.3165, device='cuda:3')
compute norm is  tensor(49.9452, device='cuda:3', dtype=torch.float64)
distance x is tensor(173.4700, device='cuda:3')
compute distance is  tensor(173.4700, device='cuda:3')
compute norm is  tensor(49.5809, device='cuda:3', dtype=torch.float64)
distance x is tensor(180.0936, device='cuda:3')
compute distance is  tensor(180.0936, device='cuda:3')
compute norm is  tensor(49.7493, device='cuda:3', dtype=torch.float64)
distance x is tensor(191.9025, device='cuda:3')
compute distance is  tensor(191.9025, device='cuda:3')
compute norm is  tensor(49.9285, device='cuda:3', dtype=torch.float64)
distance x is tensor(176.8330, device='cuda:3')
compute distance is  tensor(176.8330, device='cuda:3')
compute norm is  tensor(49.6398, device='cuda:3', dtype=torch.float64)
distance x is tensor(176.9492, device='cuda:3')
compute distance is  tensor(176.9492, device='cuda:3')
compute norm is  tensor(49.8188, device='cuda:3', dtype=torch.float64)
distance x is tensor(178.5213, device='cuda:3')
compute distance is  tensor(178.5213, device='cuda:3')
compute norm is  tensor(49.6207, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.6914, device='cuda:3')
compute distance is  tensor(170.6914, device='cuda:3')
compute norm is  tensor(49.6279, device='cuda:3', dtype=torch.float64)
distance x is tensor(184.4442, device='cuda:3')
compute distance is  tensor(184.4442, device='cuda:3')
compute norm is  tensor(49.8051, device='cuda:3', dtype=torch.float64)
distance x is tensor(173.7420, device='cuda:3')
compute distance is  tensor(173.7420, device='cuda:3')
compute norm is  tensor(49.6359, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(191.9025, device='cuda:3')
distance x is tensor(107658.9062, device='cuda:3')
distance x is tensor(107658.9062, device='cuda:3')
________________________________
test distance is  tensor(107658.9062, device='cuda:3')
test distance1 is  tensor(107658.9062, device='cuda:3')
test similarity is  tensor(0.1618, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130091589175763.23
test entropy is  0.0
________________________________
cal ratio is  0.04137531847760095
distance x is tensor(4454.4268, device='cuda:3')
cal_distance is  tensor(4454.4268, device='cuda:3')
cal ratio is  0.2034091244156167
distance x is tensor(906.0752, device='cuda:3')
cal_distance is  tensor(906.0752, device='cuda:3')
cal ratio is  0.45100797337131027
distance x is tensor(408.6500, device='cuda:3')
cal_distance is  tensor(408.6500, device='cuda:3')
cal ratio is  0.6715689347545984
distance x is tensor(274.4383, device='cuda:3')
cal_distance is  tensor(274.4383, device='cuda:3')
cal ratio is  0.8194905601996988
distance x is tensor(224.9005, device='cuda:3')
cal_distance is  tensor(224.9005, device='cuda:3')
cal ratio is  0.9052553231378578
distance x is tensor(203.5929, device='cuda:3')
cal_distance is  tensor(203.5929, device='cuda:3')
cal ratio is  0.951447822325362
distance x is tensor(193.7083, device='cuda:3')
cal_distance is  tensor(193.7083, device='cuda:3')
cal ratio is  0.9754212668803472
distance x is tensor(188.9473, device='cuda:3')
cal_distance is  tensor(188.9473, device='cuda:3')
distance x is tensor(188.9473, device='cuda:3')
return_distance is  tensor(188.9473, device='cuda:3')
distance x is tensor(188.9370, device='cuda:3')
distance x is tensor(188.9370, device='cuda:3')
________________________________
test distance is  tensor(188.9370, device='cuda:3')
test distance1 is  tensor(188.9370, device='cuda:3')
test similarity is  tensor(0.9230, device='cuda:3')
test acc is  0.10000000015633198
test loss is 1717.8710649892973
test entropy is  0.0
________________________________
0
distance x is tensor(188.9370, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  1716.883968133662
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9230, device='cuda:3')
compute_distance is  tensor(188.9370, device='cuda:3')
compute_norm is  tensor(51.9758, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2141.6821, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.6411174641235042
avg test loss is  2.85638188146579
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2679, device='cuda:3')
compute_distance is  tensor(2141.6821, device='cuda:3')
compute_norm is  tensor(179.4379, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2132.1094, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8884081102764683
avg test loss is  3.6854461983068667
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2680, device='cuda:3')
compute_distance is  tensor(2132.1094, device='cuda:3')
compute_norm is  tensor(178.7616, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2122.6240, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5681287554789707
avg test loss is  2.8597258642029915
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2679, device='cuda:3')
compute_distance is  tensor(2122.6240, device='cuda:3')
compute_norm is  tensor(177.8915, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2113.1443, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8680461488171681
avg test loss is  3.616101588267507
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2679, device='cuda:3')
compute_distance is  tensor(2113.1443, device='cuda:3')
compute_norm is  tensor(177.2107, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2103.5818, device='cuda:3')
distance x is tensor(2103.5818, device='cuda:3')
________________________________
test distance is  tensor(2103.5818, device='cuda:3')
test distance1 is  tensor(2103.5818, device='cuda:3')
test similarity is  tensor(0.2678, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8670016544968333
test entropy is  1.55120012945712
________________________________
cal ratio is  0.2959965459102146
distance x is tensor(622.6531, device='cuda:3')
cal_distance is  tensor(622.6531, device='cuda:3')
cal ratio is  0.544055588868411
distance x is tensor(338.7579, device='cuda:3')
cal_distance is  tensor(338.7579, device='cuda:3')
cal ratio is  0.7376011811208423
distance x is tensor(249.8683, device='cuda:3')
cal_distance is  tensor(249.8683, device='cuda:3')
cal ratio is  0.858837105638064
distance x is tensor(214.5962, device='cuda:3')
cal_distance is  tensor(214.5962, device='cuda:3')
cal ratio is  0.926734522516623
distance x is tensor(198.8737, device='cuda:3')
cal_distance is  tensor(198.8737, device='cuda:3')
cal ratio is  0.9626705107076099
distance x is tensor(191.4498, device='cuda:3')
cal_distance is  tensor(191.4498, device='cuda:3')
distance x is tensor(191.4498, device='cuda:3')
return_distance is  tensor(191.4498, device='cuda:3')
distance x is tensor(191.4496, device='cuda:3')
distance x is tensor(191.4496, device='cuda:3')
________________________________
test distance is  tensor(191.4496, device='cuda:3')
test distance1 is  tensor(191.4496, device='cuda:3')
test similarity is  tensor(0.9321, device='cuda:3')
test acc is  0.09073333348966535
test loss is 2.7854321368975934
test entropy is  1.8406175589764804
________________________________
0
distance x is tensor(191.4496, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.8397383997435255
avg test loss is  2.7886863120837506
avg accuracy is  0.1212666668229986
solo acc is  0.09100000015633201
compute similarity  is  tensor(0.9321, device='cuda:3')
compute_distance is  tensor(191.4496, device='cuda:3')
compute_norm is  tensor(52.5516, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(193.0487, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8238012733489974
avg test loss is  2.9296493100713312
avg accuracy is  0.10840000015633196
solo acc is  0.10195000015633197
compute similarity  is  tensor(0.9318, device='cuda:3')
compute_distance is  tensor(193.0487, device='cuda:3')
compute_norm is  tensor(52.3730, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(195.9909, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.1277166690780664
avg test loss is  1.9967111712579788
avg accuracy is  0.12155000015633192
solo acc is  0.1715666668230014
compute similarity  is  tensor(0.9313, device='cuda:3')
compute_distance is  tensor(195.9909, device='cuda:3')
compute_norm is  tensor(52.1026, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(195.8978, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6631129101268264
avg test loss is  2.759995252338808
avg accuracy is  0.11238333348966527
solo acc is  0.10256666682299863
compute similarity  is  tensor(0.9310, device='cuda:3')
compute_distance is  tensor(195.8978, device='cuda:3')
compute_norm is  tensor(51.9301, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(197.9293, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.1408662024591523
avg test loss is  1.783565782280619
avg accuracy is  0.1267000001563319
solo acc is  0.18453333348966885
compute similarity  is  tensor(0.9305, device='cuda:3')
compute_distance is  tensor(197.9293, device='cuda:3')
compute_norm is  tensor(51.6322, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(197.8911, device='cuda:3')
distance x is tensor(197.8911, device='cuda:3')
________________________________
test distance is  tensor(197.8911, device='cuda:3')
test distance1 is  tensor(197.8911, device='cuda:3')
test similarity is  tensor(0.9302, device='cuda:3')
test acc is  0.1038833334896653
test loss is 2.58271345934634
test entropy is  0.6547530246441806
________________________________
cal ratio is  0.965057619936685
distance x is tensor(190.9739, device='cuda:3')
cal_distance is  tensor(190.9739, device='cuda:3')
distance x is tensor(190.9739, device='cuda:3')
return_distance is  tensor(190.9739, device='cuda:3')
distance x is tensor(190.9763, device='cuda:3')
distance x is tensor(190.9763, device='cuda:3')
________________________________
test distance is  tensor(190.9763, device='cuda:3')
test distance1 is  tensor(190.9763, device='cuda:3')
test similarity is  tensor(0.9346, device='cuda:3')
test acc is  0.10431666682299863
test loss is 2.615137051671807
test entropy is  0.6445869783729886
________________________________
0
distance x is tensor(190.9763, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6457733769279553
avg test loss is  2.6109681688646265
avg accuracy is  0.11381666682299861
solo acc is  0.1042333334896653
compute similarity  is  tensor(0.9346, device='cuda:3')
compute_distance is  tensor(190.9763, device='cuda:3')
compute_norm is  tensor(51.2077, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(193.4342, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0454555712401994
avg test loss is  1.6873831089371558
avg accuracy is  0.1287500001563319
solo acc is  0.20936666682300345
compute similarity  is  tensor(0.9338, device='cuda:3')
compute_distance is  tensor(193.4342, device='cuda:3')
compute_norm is  tensor(50.9308, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(193.5192, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6396062723609176
avg test loss is  2.4668183298761654
avg accuracy is  0.11475000015633194
solo acc is  0.10456666682299862
compute similarity  is  tensor(0.9336, device='cuda:3')
compute_distance is  tensor(193.5192, device='cuda:3')
compute_norm is  tensor(50.7428, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(195.6991, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9965770415532818
avg test loss is  1.5877662489154953
avg accuracy is  0.13006666682299858
solo acc is  0.22886666682300427
compute similarity  is  tensor(0.9328, device='cuda:3')
compute_distance is  tensor(195.6991, device='cuda:3')
compute_norm is  tensor(50.4728, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(195.6964, device='cuda:3')
________________________________
test distance is  tensor(195.6964, device='cuda:3')
test similarity is  tensor(0.9328, device='cuda:3')
test acc is  0.13003333348966525
test loss is 1.588230964725714
test entropy is  0.9980994991020862
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.577325701713562
mal norm is  tensor(808.3259, device='cuda:3')
distance x is tensor(195.6964, device='cuda:3')
mal distance is  tensor(195.6964, device='cuda:3')
user_PLR len size 44
counter_tensor is  tensor([12.,  1., 12., 12., 15., 21., 12.,  0., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 12.,  0., 43., 12., 43., 41.,  0.,  0.,
        43., 42., 12., 12., 19., 12., 29., 43., 43., 42., 40., 12.,  0., 12.,
        43.,  0.])
count_res tensor([4.9739e-15, 8.3073e-20, 4.9739e-15, 4.9739e-15, 9.9903e-14, 4.0304e-11,
        4.9739e-15, 3.0561e-20, 2.4132e-06, 2.4132e-06, 2.4132e-06, 2.4132e-06,
        2.4132e-06, 2.4132e-06, 2.4132e-06, 2.4132e-06, 2.4132e-06, 2.4132e-06,
        2.4132e-06, 2.4132e-06, 4.9739e-15, 3.0561e-20, 1.4449e-01, 4.9739e-15,
        1.4449e-01, 1.9554e-02, 3.0561e-20, 3.0561e-20, 1.4449e-01, 5.3153e-02,
        4.9739e-15, 4.9739e-15, 5.4545e-12, 4.9739e-15, 1.2014e-07, 1.4449e-01,
        1.4449e-01, 5.3153e-02, 7.1935e-03, 4.9739e-15, 3.0561e-20, 4.9739e-15,
        1.4449e-01, 3.0561e-20])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 89.94% 

Test Accuracy: 88.98% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.20693929493427277
distance x is tensor(112.8376, device='cuda:3')
benign distance is  tensor(112.8376, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.621829092502594
distance x is tensor(107.1437, device='cuda:3')
benign distance is  tensor(107.1437, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.17370577156543732
distance x is tensor(128.8732, device='cuda:3')
benign distance is  tensor(128.8732, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5625970959663391
distance x is tensor(113.4001, device='cuda:3')
benign distance is  tensor(113.4001, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5412070155143738
distance x is tensor(106.9434, device='cuda:3')
benign distance is  tensor(106.9434, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.129778504371643
distance x is tensor(121.6557, device='cuda:3')
benign distance is  tensor(121.6557, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.22745808959007263
distance x is tensor(130.3002, device='cuda:3')
benign distance is  tensor(130.3002, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8575750589370728
distance x is tensor(121.6708, device='cuda:3')
benign distance is  tensor(121.6708, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2715494930744171
distance x is tensor(119.7562, device='cuda:3')
benign distance is  tensor(119.7562, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4449843764305115
distance x is tensor(113.9617, device='cuda:3')
benign distance is  tensor(113.9617, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6193902492523193
distance x is tensor(117.8354, device='cuda:3')
benign distance is  tensor(117.8354, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3166171908378601
distance x is tensor(100.6669, device='cuda:3')
benign distance is  tensor(100.6669, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4600515365600586
distance x is tensor(121.1214, device='cuda:3')
benign distance is  tensor(121.1214, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.13241305947303772
distance x is tensor(120.7141, device='cuda:3')
benign distance is  tensor(120.7141, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6046217679977417
distance x is tensor(127.8880, device='cuda:3')
benign distance is  tensor(127.8880, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.2353159487247467
distance x is tensor(123.4595, device='cuda:3')
benign distance is  tensor(123.4595, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.6695124506950378
distance x is tensor(120.3563, device='cuda:3')
benign distance is  tensor(120.3563, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.4023711085319519
distance x is tensor(127.8234, device='cuda:3')
benign distance is  tensor(127.8234, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.025685861706733704
distance x is tensor(132.4683, device='cuda:3')
benign distance is  tensor(132.4683, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.6045774817466736
distance x is tensor(147.3189, device='cuda:3')
benign distance is  tensor(147.3189, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.5895792245864868
distance x is tensor(121.0138, device='cuda:3')
benign distance is  tensor(121.0138, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.1918230652809143
distance x is tensor(123.6463, device='cuda:3')
benign distance is  tensor(123.6463, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.34731826186180115
distance x is tensor(127.5872, device='cuda:3')
benign distance is  tensor(127.5872, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.42359018325805664
distance x is tensor(129.6673, device='cuda:3')
benign distance is  tensor(129.6673, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.44651857018470764
distance x is tensor(131.2323, device='cuda:3')
benign distance is  tensor(131.2323, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.17350995540618896
distance x is tensor(131.3473, device='cuda:3')
benign distance is  tensor(131.3473, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.07939331233501434
distance x is tensor(128.9275, device='cuda:3')
benign distance is  tensor(128.9275, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.14511694014072418
distance x is tensor(116.4842, device='cuda:3')
benign distance is  tensor(116.4842, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.3794165253639221
distance x is tensor(115.0724, device='cuda:3')
benign distance is  tensor(115.0724, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.4884936213493347
distance x is tensor(122.4769, device='cuda:3')
benign distance is  tensor(122.4769, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.2293865978717804
distance x is tensor(121.5739, device='cuda:3')
benign distance is  tensor(121.5739, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.14647844433784485
distance x is tensor(121.6343, device='cuda:3')
benign distance is  tensor(121.6343, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(118.0114, device='cuda:3')
compute distance is  tensor(118.0114, device='cuda:3')
compute norm is  tensor(50.4616, device='cuda:3', dtype=torch.float64)
distance x is tensor(113.6679, device='cuda:3')
compute distance is  tensor(113.6679, device='cuda:3')
compute norm is  tensor(50.3793, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.9304, device='cuda:3')
compute distance is  tensor(136.9304, device='cuda:3')
compute norm is  tensor(50.9396, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.1146, device='cuda:3')
compute distance is  tensor(125.1146, device='cuda:3')
compute norm is  tensor(50.5425, device='cuda:3', dtype=torch.float64)
distance x is tensor(114.1343, device='cuda:3')
compute distance is  tensor(114.1343, device='cuda:3')
compute norm is  tensor(50.3699, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.9295, device='cuda:3')
compute distance is  tensor(117.9295, device='cuda:3')
compute norm is  tensor(50.5896, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.5063, device='cuda:3')
compute distance is  tensor(132.5063, device='cuda:3')
compute norm is  tensor(50.8269, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.6405, device='cuda:3')
compute distance is  tensor(126.6405, device='cuda:3')
compute norm is  tensor(50.5882, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.6665, device='cuda:3')
compute distance is  tensor(117.6665, device='cuda:3')
compute norm is  tensor(50.4954, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.2582, device='cuda:3')
compute distance is  tensor(118.2582, device='cuda:3')
compute norm is  tensor(50.6039, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.6926, device='cuda:3')
compute distance is  tensor(126.6926, device='cuda:3')
compute norm is  tensor(50.7036, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.2851, device='cuda:3')
compute distance is  tensor(126.2851, device='cuda:3')
compute norm is  tensor(50.5926, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(136.9304, device='cuda:3')
distance x is tensor(107738.3047, device='cuda:3')
distance x is tensor(107738.3047, device='cuda:3')
________________________________
test distance is  tensor(107738.3047, device='cuda:3')
test distance1 is  tensor(107738.3047, device='cuda:3')
test similarity is  tensor(-0.1059, device='cuda:3')
test acc is  0.10000000015633198
test loss is 129964023059436.34
test entropy is  0.0
________________________________
cal ratio is  0.0349374333895601
distance x is tensor(3764.1057, device='cuda:3')
cal_distance is  tensor(3764.1057, device='cuda:3')
cal ratio is  0.18691543822145967
distance x is tensor(703.5737, device='cuda:3')
cal_distance is  tensor(703.5737, device='cuda:3')
cal ratio is  0.43233585493835974
distance x is tensor(304.1831, device='cuda:3')
cal_distance is  tensor(304.1831, device='cuda:3')
cal ratio is  0.6575193644072563
distance x is tensor(200.0080, device='cuda:3')
cal_distance is  tensor(200.0080, device='cuda:3')
cal ratio is  0.8108720829621453
distance x is tensor(162.1820, device='cuda:3')
cal_distance is  tensor(162.1820, device='cuda:3')
cal ratio is  0.900481511491763
distance x is tensor(146.0424, device='cuda:3')
cal_distance is  tensor(146.0424, device='cuda:3')
cal ratio is  0.9489353041564101
distance x is tensor(138.5851, device='cuda:3')
cal_distance is  tensor(138.5851, device='cuda:3')
cal ratio is  0.9741321529148819
distance x is tensor(135.0003, device='cuda:3')
cal_distance is  tensor(135.0003, device='cuda:3')
distance x is tensor(135.0003, device='cuda:3')
return_distance is  tensor(135.0003, device='cuda:3')
distance x is tensor(134.9899, device='cuda:3')
distance x is tensor(134.9899, device='cuda:3')
________________________________
test distance is  tensor(134.9899, device='cuda:3')
test distance1 is  tensor(134.9899, device='cuda:3')
test similarity is  tensor(0.9515, device='cuda:3')
test acc is  0.10003333348966531
test loss is 293.70029028138117
test entropy is  6.6047150425667e-06
________________________________
0
distance x is tensor(134.9899, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.1498159970131033e-05
avg test loss is  293.7010550590466
avg accuracy is  0.3768166668230075
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9515, device='cuda:3')
compute_distance is  tensor(134.9899, device='cuda:3')
compute_norm is  tensor(49.4295, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(117.6611, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.927300014094249
avg test loss is  1.5237869878313435
avg accuracy is  0.8064666668229917
solo acc is  0.3327166668230068
compute similarity  is  tensor(0.9570, device='cuda:3')
compute_distance is  tensor(117.6611, device='cuda:3')
compute_norm is  tensor(48.2355, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(120.1899, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8920708758109159
avg test loss is  1.5598578148050857
avg accuracy is  0.8072333334896584
solo acc is  0.2836166668230058
compute similarity  is  tensor(0.9565, device='cuda:3')
compute_distance is  tensor(120.1899, device='cuda:3')
compute_norm is  tensor(47.9023, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(122.4309, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8855983449070692
avg test loss is  1.5147517611985521
avg accuracy is  0.8138166668229915
solo acc is  0.28068333348967245
compute similarity  is  tensor(0.9561, device='cuda:3')
compute_distance is  tensor(122.4309, device='cuda:3')
compute_norm is  tensor(47.6041, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(124.6449, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8828429931770764
avg test loss is  1.4762768862344056
avg accuracy is  0.8185833334896578
solo acc is  0.2796833334896724
compute similarity  is  tensor(0.9557, device='cuda:3')
compute_distance is  tensor(124.6449, device='cuda:3')
compute_norm is  tensor(47.3253, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(126.8022, device='cuda:3')
distance x is tensor(126.8022, device='cuda:3')
________________________________
test distance is  tensor(126.8022, device='cuda:3')
test distance1 is  tensor(126.8022, device='cuda:3')
test similarity is  tensor(0.9554, device='cuda:3')
test acc is  0.27433333348967226
test loss is 1.4501566443361962
test entropy is  0.8709408162372199
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.3820315599441528
mal norm is  tensor(650.4384, device='cuda:3')
distance x is tensor(126.8099, device='cuda:3')
mal distance is  tensor(126.8099, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([12., 12., 12., 12., 14., 12., 25., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16.,  0., 27., 12., 15., 12., 12., 12., 27.])
count_res tensor([1.4324e-07, 1.4324e-07, 1.4324e-07, 1.4324e-07, 1.0584e-06, 1.4324e-07,
        6.3373e-02, 1.4324e-07, 7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06,
        7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06, 7.8208e-06,
        7.8208e-06, 7.8208e-06, 8.8012e-13, 4.6826e-01, 1.4324e-07, 2.8771e-06,
        1.4324e-07, 1.4324e-07, 1.4324e-07, 4.6826e-01])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 89.08% 

Test Accuracy: 88.27% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4153873920440674
distance x is tensor(123.3033, device='cuda:3')
benign distance is  tensor(123.3033, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5763669610023499
distance x is tensor(128.3832, device='cuda:3')
benign distance is  tensor(128.3832, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.22935369610786438
distance x is tensor(130.0856, device='cuda:3')
benign distance is  tensor(130.0856, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5585792660713196
distance x is tensor(107.6980, device='cuda:3')
benign distance is  tensor(107.6980, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6081217527389526
distance x is tensor(112.5240, device='cuda:3')
benign distance is  tensor(112.5240, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6477288603782654
distance x is tensor(133.7088, device='cuda:3')
benign distance is  tensor(133.7088, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.30037158727645874
distance x is tensor(113.7698, device='cuda:3')
benign distance is  tensor(113.7698, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.26726287603378296
distance x is tensor(134.1206, device='cuda:3')
benign distance is  tensor(134.1206, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.3159278929233551
distance x is tensor(137.6184, device='cuda:3')
benign distance is  tensor(137.6184, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4957571029663086
distance x is tensor(119.2257, device='cuda:3')
benign distance is  tensor(119.2257, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5911874771118164
distance x is tensor(134.6841, device='cuda:3')
benign distance is  tensor(134.6841, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.7734614610671997
distance x is tensor(136.3142, device='cuda:3')
benign distance is  tensor(136.3142, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3616110682487488
distance x is tensor(136.9029, device='cuda:3')
benign distance is  tensor(136.9029, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.34865033626556396
distance x is tensor(119.1529, device='cuda:3')
benign distance is  tensor(119.1529, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3558467626571655
distance x is tensor(145.0228, device='cuda:3')
benign distance is  tensor(145.0228, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.8821626901626587
distance x is tensor(104.9151, device='cuda:3')
benign distance is  tensor(104.9151, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(135.8904, device='cuda:3')
compute distance is  tensor(135.8904, device='cuda:3')
compute norm is  tensor(50.9935, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.0908, device='cuda:3')
compute distance is  tensor(119.0908, device='cuda:3')
compute norm is  tensor(50.8048, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.3571, device='cuda:3')
compute distance is  tensor(125.3571, device='cuda:3')
compute norm is  tensor(51.0064, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.7372, device='cuda:3')
compute distance is  tensor(125.7372, device='cuda:3')
compute norm is  tensor(50.8605, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.5919, device='cuda:3')
compute distance is  tensor(131.5919, device='cuda:3')
compute norm is  tensor(50.9224, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.9449, device='cuda:3')
compute distance is  tensor(124.9449, device='cuda:3')
compute norm is  tensor(50.8960, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.2885, device='cuda:3')
compute distance is  tensor(130.2885, device='cuda:3')
compute norm is  tensor(51.0695, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.7825, device='cuda:3')
compute distance is  tensor(128.7825, device='cuda:3')
compute norm is  tensor(50.9510, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.0394, device='cuda:3')
compute distance is  tensor(132.0394, device='cuda:3')
compute norm is  tensor(51.1146, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.4379, device='cuda:3')
compute distance is  tensor(123.4379, device='cuda:3')
compute norm is  tensor(50.9004, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.9980, device='cuda:3')
compute distance is  tensor(127.9980, device='cuda:3')
compute norm is  tensor(51.0323, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.0516, device='cuda:3')
compute distance is  tensor(143.0516, device='cuda:3')
compute norm is  tensor(51.1310, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(143.0516, device='cuda:3')
distance x is tensor(107739.5938, device='cuda:3')
distance x is tensor(107739.5938, device='cuda:3')
________________________________
test distance is  tensor(107739.5938, device='cuda:3')
test distance1 is  tensor(107739.5938, device='cuda:3')
test similarity is  tensor(-0.1024, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130055844458539.67
test entropy is  0.0
________________________________
cal ratio is  0.035709582315861584
distance x is tensor(3847.3416, device='cuda:3')
cal_distance is  tensor(3847.3416, device='cuda:3')
cal ratio is  0.18896965769863128
distance x is tensor(727.0350, device='cuda:3')
cal_distance is  tensor(727.0350, device='cuda:3')
cal ratio is  0.4347051584193405
distance x is tensor(316.0489, device='cuda:3')
cal_distance is  tensor(316.0489, device='cuda:3')
cal ratio is  0.6593186085347766
distance x is tensor(208.3786, device='cuda:3')
cal_distance is  tensor(208.3786, device='cuda:3')
cal ratio is  0.8119809522203376
distance x is tensor(169.2005, device='cuda:3')
cal_distance is  tensor(169.2005, device='cuda:3')
cal ratio is  0.9010971746219218
distance x is tensor(152.4666, device='cuda:3')
cal_distance is  tensor(152.4666, device='cuda:3')
cal ratio is  0.9492597356165908
distance x is tensor(144.7307, device='cuda:3')
cal_distance is  tensor(144.7307, device='cuda:3')
cal ratio is  0.9742987357727395
distance x is tensor(141.0110, device='cuda:3')
cal_distance is  tensor(141.0110, device='cuda:3')
distance x is tensor(141.0110, device='cuda:3')
return_distance is  tensor(141.0110, device='cuda:3')
distance x is tensor(141.0007, device='cuda:3')
distance x is tensor(141.0007, device='cuda:3')
________________________________
test distance is  tensor(141.0007, device='cuda:3')
test distance1 is  tensor(141.0007, device='cuda:3')
test similarity is  tensor(0.9482, device='cuda:3')
test acc is  0.10021666682299865
test loss is 367.0943009756776
test entropy is  3.885313401286259e-05
________________________________
0
distance x is tensor(141.0007, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  3.0002987474565406e-05
avg test loss is  367.5091807481322
avg accuracy is  0.25485000015633835
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9482, device='cuda:3')
compute_distance is  tensor(141.0007, device='cuda:3')
compute_norm is  tensor(49.8803, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(121.4924, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.935415225433134
avg test loss is  1.5530466924089867
avg accuracy is  0.7956833334896588
solo acc is  0.3330833334896734
compute similarity  is  tensor(0.9545, device='cuda:3')
compute_distance is  tensor(121.4924, device='cuda:3')
compute_norm is  tensor(48.7291, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(121.4924, device='cuda:3')
distance x is tensor(121.4924, device='cuda:3')
________________________________
test distance is  tensor(121.4924, device='cuda:3')
test distance1 is  tensor(121.4924, device='cuda:3')
test similarity is  tensor(0.9545, device='cuda:3')
test acc is  0.33131666682300676
test loss is 1.5568105090401574
test entropy is  0.9355580841681597
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.6345341205596924
mal norm is  tensor(667.0637, device='cuda:3')
distance x is tensor(121.5004, device='cuda:3')
mal distance is  tensor(121.5004, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([12., 12., 12., 26., 14., 12., 27.,  0., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 14., 12., 12., 12., 12., 12., 27.])
count_res tensor([1.2918e-07, 1.2918e-07, 1.2918e-07, 1.5535e-01, 9.5450e-07, 1.2918e-07,
        4.2228e-01, 7.9369e-13, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06,
        7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06,
        7.0528e-06, 7.0528e-06, 1.2918e-07, 9.5450e-07, 1.2918e-07, 1.2918e-07,
        1.2918e-07, 1.2918e-07, 1.2918e-07, 4.2228e-01])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 89.58% 

Test Accuracy: 88.70% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.32967641949653625
distance x is tensor(128.6364, device='cuda:3')
benign distance is  tensor(128.6364, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8384777307510376
distance x is tensor(129.3271, device='cuda:3')
benign distance is  tensor(129.3271, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.07835698872804642
distance x is tensor(141.1266, device='cuda:3')
benign distance is  tensor(141.1266, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.853416919708252
distance x is tensor(107.2532, device='cuda:3')
benign distance is  tensor(107.2532, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.2975994646549225
distance x is tensor(117.9842, device='cuda:3')
benign distance is  tensor(117.9842, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6780420541763306
distance x is tensor(141.9413, device='cuda:3')
benign distance is  tensor(141.9413, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.36451011896133423
distance x is tensor(90.2334, device='cuda:3')
benign distance is  tensor(90.2334, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6290290951728821
distance x is tensor(141.9192, device='cuda:3')
benign distance is  tensor(141.9192, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.25169381499290466
distance x is tensor(144.9726, device='cuda:3')
benign distance is  tensor(144.9726, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8279417157173157
distance x is tensor(138.7549, device='cuda:3')
benign distance is  tensor(138.7549, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.48110952973365784
distance x is tensor(131.6323, device='cuda:3')
benign distance is  tensor(131.6323, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.517274796962738
distance x is tensor(112.9447, device='cuda:3')
benign distance is  tensor(112.9447, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5275333523750305
distance x is tensor(143.6341, device='cuda:3')
benign distance is  tensor(143.6341, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.19595389068126678
distance x is tensor(121.8697, device='cuda:3')
benign distance is  tensor(121.8697, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7121734619140625
distance x is tensor(139.3625, device='cuda:3')
benign distance is  tensor(139.3625, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6335358619689941
distance x is tensor(115.2464, device='cuda:3')
benign distance is  tensor(115.2464, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(133.3957, device='cuda:3')
compute distance is  tensor(133.3957, device='cuda:3')
compute norm is  tensor(51.3886, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.4988, device='cuda:3')
compute distance is  tensor(129.4988, device='cuda:3')
compute norm is  tensor(51.4081, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.7096, device='cuda:3')
compute distance is  tensor(146.7096, device='cuda:3')
compute norm is  tensor(51.7760, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.8726, device='cuda:3')
compute distance is  tensor(131.8726, device='cuda:3')
compute norm is  tensor(51.3879, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.4516, device='cuda:3')
compute distance is  tensor(142.4516, device='cuda:3')
compute norm is  tensor(51.4821, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.5831, device='cuda:3')
compute distance is  tensor(134.5831, device='cuda:3')
compute norm is  tensor(51.5941, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.6454, device='cuda:3')
compute distance is  tensor(125.6454, device='cuda:3')
compute norm is  tensor(51.3478, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.1866, device='cuda:3')
compute distance is  tensor(130.1866, device='cuda:3')
compute norm is  tensor(51.4341, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.7503, device='cuda:3')
compute distance is  tensor(144.7503, device='cuda:3')
compute norm is  tensor(51.6309, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.6760, device='cuda:3')
compute distance is  tensor(132.6760, device='cuda:3')
compute norm is  tensor(51.3154, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.6410, device='cuda:3')
compute distance is  tensor(138.6410, device='cuda:3')
compute norm is  tensor(51.5888, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.9201, device='cuda:3')
compute distance is  tensor(136.9201, device='cuda:3')
compute norm is  tensor(51.6219, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(146.7096, device='cuda:3')
distance x is tensor(107739.1719, device='cuda:3')
distance x is tensor(107739.1719, device='cuda:3')
________________________________
test distance is  tensor(107739.1719, device='cuda:3')
test distance1 is  tensor(107739.1719, device='cuda:3')
test similarity is  tensor(-0.1007, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130193642852238.47
test entropy is  0.0
________________________________
cal ratio is  0.03616334051333249
distance x is tensor(3896.2141, device='cuda:3')
cal_distance is  tensor(3896.2141, device='cuda:3')
cal ratio is  0.19016646822429514
distance x is tensor(740.9335, device='cuda:3')
cal_distance is  tensor(740.9335, device='cuda:3')
cal ratio is  0.43607957492316557
distance x is tensor(323.1089, device='cuda:3')
cal_distance is  tensor(323.1089, device='cuda:3')
cal ratio is  0.6603602528760422
distance x is tensor(213.3700, device='cuda:3')
cal_distance is  tensor(213.3700, device='cuda:3')
cal ratio is  0.8126221393188062
distance x is tensor(173.3902, device='cuda:3')
cal_distance is  tensor(173.3902, device='cuda:3')
cal ratio is  0.901452984496833
distance x is tensor(156.3036, device='cuda:3')
cal_distance is  tensor(156.3036, device='cuda:3')
cal ratio is  0.9494472328517357
distance x is tensor(148.4023, device='cuda:3')
cal_distance is  tensor(148.4023, device='cuda:3')
cal ratio is  0.9743949412910644
distance x is tensor(144.6026, device='cuda:3')
cal_distance is  tensor(144.6026, device='cuda:3')
distance x is tensor(144.6026, device='cuda:3')
return_distance is  tensor(144.6026, device='cuda:3')
distance x is tensor(144.5922, device='cuda:3')
distance x is tensor(144.5922, device='cuda:3')
________________________________
test distance is  tensor(144.5922, device='cuda:3')
test distance1 is  tensor(144.5922, device='cuda:3')
test similarity is  tensor(0.9467, device='cuda:3')
test acc is  0.10005000015633199
test loss is 407.1426476517212
test entropy is  1.3326026745035581e-05
________________________________
0
distance x is tensor(144.5922, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  4.440813110241663e-10
avg test loss is  407.30221811388094
avg accuracy is  0.24286666682300467
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9467, device='cuda:3')
compute_distance is  tensor(144.5922, device='cuda:3')
compute_norm is  tensor(50.4033, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(125.3421, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9400083344501219
avg test loss is  1.5641612002590317
avg accuracy is  0.7766500001563266
solo acc is  0.3202833334896733
compute similarity  is  tensor(0.9530, device='cuda:3')
compute_distance is  tensor(125.3421, device='cuda:3')
compute_norm is  tensor(49.2031, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(125.3421, device='cuda:3')
distance x is tensor(125.3421, device='cuda:3')
________________________________
test distance is  tensor(125.3421, device='cuda:3')
test distance1 is  tensor(125.3421, device='cuda:3')
test similarity is  tensor(0.9530, device='cuda:3')
test acc is  0.32318333348967326
test loss is 1.5638453758347517
test entropy is  0.9392919040310865
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.622774362564087
mal norm is  tensor(684.4039, device='cuda:3')
distance x is tensor(125.3497, device='cuda:3')
mal distance is  tensor(125.3497, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 24.68% 

Test Accuracy: 24.34% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2788320481777191
distance x is tensor(197.4026, device='cuda:3')
benign distance is  tensor(197.4026, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.47991031408309937
distance x is tensor(194.4082, device='cuda:3')
benign distance is  tensor(194.4082, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3199586570262909
distance x is tensor(194.6610, device='cuda:3')
benign distance is  tensor(194.6610, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.738214373588562
distance x is tensor(186.1109, device='cuda:3')
benign distance is  tensor(186.1109, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5507607460021973
distance x is tensor(207.1930, device='cuda:3')
benign distance is  tensor(207.1930, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7129403948783875
distance x is tensor(191.7688, device='cuda:3')
benign distance is  tensor(191.7688, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.6226707696914673
distance x is tensor(178.1591, device='cuda:3')
benign distance is  tensor(178.1591, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1584164798259735
distance x is tensor(194.7366, device='cuda:3')
benign distance is  tensor(194.7366, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(193.2115, device='cuda:3')
compute distance is  tensor(193.2115, device='cuda:3')
compute norm is  tensor(51.5240, device='cuda:3', dtype=torch.float64)
distance x is tensor(185.6515, device='cuda:3')
compute distance is  tensor(185.6515, device='cuda:3')
compute norm is  tensor(51.2573, device='cuda:3', dtype=torch.float64)
distance x is tensor(200.1647, device='cuda:3')
compute distance is  tensor(200.1647, device='cuda:3')
compute norm is  tensor(51.6101, device='cuda:3', dtype=torch.float64)
distance x is tensor(191.1404, device='cuda:3')
compute distance is  tensor(191.1404, device='cuda:3')
compute norm is  tensor(51.1598, device='cuda:3', dtype=torch.float64)
distance x is tensor(194.0397, device='cuda:3')
compute distance is  tensor(194.0397, device='cuda:3')
compute norm is  tensor(51.6134, device='cuda:3', dtype=torch.float64)
distance x is tensor(191.7156, device='cuda:3')
compute distance is  tensor(191.7156, device='cuda:3')
compute norm is  tensor(51.5777, device='cuda:3', dtype=torch.float64)
distance x is tensor(195.6175, device='cuda:3')
compute distance is  tensor(195.6175, device='cuda:3')
compute norm is  tensor(51.5587, device='cuda:3', dtype=torch.float64)
distance x is tensor(198.2302, device='cuda:3')
compute distance is  tensor(198.2302, device='cuda:3')
compute norm is  tensor(51.6839, device='cuda:3', dtype=torch.float64)
distance x is tensor(195.9747, device='cuda:3')
compute distance is  tensor(195.9747, device='cuda:3')
compute norm is  tensor(51.4462, device='cuda:3', dtype=torch.float64)
distance x is tensor(185.4648, device='cuda:3')
compute distance is  tensor(185.4648, device='cuda:3')
compute norm is  tensor(51.3368, device='cuda:3', dtype=torch.float64)
distance x is tensor(183.9149, device='cuda:3')
compute distance is  tensor(183.9149, device='cuda:3')
compute norm is  tensor(51.4005, device='cuda:3', dtype=torch.float64)
distance x is tensor(205.7493, device='cuda:3')
compute distance is  tensor(205.7493, device='cuda:3')
compute norm is  tensor(52.0003, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(205.7493, device='cuda:3')
distance x is tensor(107661.0703, device='cuda:3')
distance x is tensor(107661.0703, device='cuda:3')
________________________________
test distance is  tensor(107661.0703, device='cuda:3')
test distance1 is  tensor(107661.0703, device='cuda:3')
test similarity is  tensor(0.1736, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130013146729998.19
test entropy is  0.0
________________________________
cal ratio is  0.04284161794765108
distance x is tensor(4612.3799, device='cuda:3')
cal_distance is  tensor(4612.3799, device='cuda:3')
cal ratio is  0.2069820445660902
distance x is tensor(954.6839, device='cuda:3')
cal_distance is  tensor(954.6839, device='cuda:3')
cal ratio is  0.45495182891922065
distance x is tensor(434.3380, device='cuda:3')
cal_distance is  tensor(434.3380, device='cuda:3')
cal ratio is  0.6744989848687752
distance x is tensor(292.9622, device='cuda:3')
cal_distance is  tensor(292.9622, device='cuda:3')
cal ratio is  0.8212764801041316
distance x is tensor(240.6039, device='cuda:3')
cal_distance is  tensor(240.6039, device='cuda:3')
cal ratio is  0.9062412920960994
distance x is tensor(218.0457, device='cuda:3')
cal_distance is  tensor(218.0457, device='cuda:3')
cal ratio is  0.9519660367657488
distance x is tensor(207.5723, device='cuda:3')
cal_distance is  tensor(207.5723, device='cuda:3')
cal ratio is  0.9756868762763936
distance x is tensor(202.5258, device='cuda:3')
cal_distance is  tensor(202.5258, device='cuda:3')
distance x is tensor(202.5258, device='cuda:3')
return_distance is  tensor(202.5258, device='cuda:3')
distance x is tensor(202.5154, device='cuda:3')
distance x is tensor(202.5154, device='cuda:3')
________________________________
test distance is  tensor(202.5154, device='cuda:3')
test distance1 is  tensor(202.5154, device='cuda:3')
test similarity is  tensor(0.9202, device='cuda:3')
test acc is  0.10000000015633198
test loss is 1722.2782953258263
test entropy is  0.0
________________________________
0
distance x is tensor(202.5154, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  1724.5460579878231
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9202, device='cuda:3')
compute_distance is  tensor(202.5154, device='cuda:3')
compute_norm is  tensor(54.3147, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2958.3291, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5965983117821374
avg test loss is  2.862845965031622
avg accuracy is  0.10010000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1868, device='cuda:3')
compute_distance is  tensor(2958.3291, device='cuda:3')
compute_norm is  tensor(264.8439, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2945.0308, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8580274679767552
avg test loss is  3.6493527922294797
avg accuracy is  0.09996666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1869, device='cuda:3')
compute_distance is  tensor(2945.0308, device='cuda:3')
compute_norm is  tensor(263.9234, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2931.1340, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.56578671665334
avg test loss is  2.8604986792180074
avg accuracy is  0.10016666682299866
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1867, device='cuda:3')
compute_distance is  tensor(2931.1340, device='cuda:3')
compute_norm is  tensor(262.3739, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2917.9749, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8483977246640334
avg test loss is  3.628057320743227
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1868, device='cuda:3')
compute_distance is  tensor(2917.9749, device='cuda:3')
compute_norm is  tensor(261.4566, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2904.2083, device='cuda:3')
distance x is tensor(2904.2083, device='cuda:3')
________________________________
test distance is  tensor(2904.2083, device='cuda:3')
test distance1 is  tensor(2904.2083, device='cuda:3')
test similarity is  tensor(0.1867, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8601504795586883
test entropy is  1.5609083189638948
________________________________
cal ratio is  0.26084429443401275
distance x is tensor(757.5461, device='cuda:3')
cal_distance is  tensor(757.5461, device='cuda:3')
cal ratio is  0.5107291887368774
distance x is tensor(386.9008, device='cuda:3')
cal_distance is  tensor(386.9008, device='cuda:3')
cal ratio is  0.7146532336061339
distance x is tensor(276.4999, device='cuda:3')
cal_distance is  tensor(276.4999, device='cuda:3')
cal ratio is  0.8453716979390281
distance x is tensor(233.7452, device='cuda:3')
cal_distance is  tensor(233.7452, device='cuda:3')
cal ratio is  0.9194409709421745
distance x is tensor(214.9149, device='cuda:3')
cal_distance is  tensor(214.9149, device='cuda:3')
cal ratio is  0.9588748100388982
distance x is tensor(206.0765, device='cuda:3')
cal_distance is  tensor(206.0765, device='cuda:3')
cal ratio is  0.9792215187833436
distance x is tensor(201.7946, device='cuda:3')
cal_distance is  tensor(201.7946, device='cuda:3')
distance x is tensor(201.7946, device='cuda:3')
return_distance is  tensor(201.7946, device='cuda:3')
distance x is tensor(201.7948, device='cuda:3')
distance x is tensor(201.7948, device='cuda:3')
________________________________
test distance is  tensor(201.7948, device='cuda:3')
test distance1 is  tensor(201.7948, device='cuda:3')
test similarity is  tensor(0.9041, device='cuda:3')
test acc is  0.1343500001563319
test loss is 4.680954465479739
test entropy is  0.8850969601668783
________________________________
0
distance x is tensor(201.7948, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.8846984958089491
avg test loss is  4.683283295458568
avg accuracy is  0.1157666668229986
solo acc is  0.1339500001563319
compute similarity  is  tensor(0.9041, device='cuda:3')
compute_distance is  tensor(201.7948, device='cuda:3')
compute_norm is  tensor(56.2046, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(209.6982, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.120206193438471
avg test loss is  1.8943758744166603
avg accuracy is  0.1409000001563324
solo acc is  0.20075000015633643
compute similarity  is  tensor(0.9031, device='cuda:3')
compute_distance is  tensor(209.6982, device='cuda:3')
compute_norm is  tensor(55.8513, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(210.1345, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6683675967045685
avg test loss is  2.6903158578791344
avg accuracy is  0.12071666682299859
solo acc is  0.10763333348966529
compute similarity  is  tensor(0.9028, device='cuda:3')
compute_distance is  tensor(210.1345, device='cuda:3')
compute_norm is  tensor(55.6413, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(213.2168, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.0442286868974853
avg test loss is  1.6802604958446803
avg accuracy is  0.14325000015633255
solo acc is  0.23305000015633762
compute similarity  is  tensor(0.9022, device='cuda:3')
compute_distance is  tensor(213.2168, device='cuda:3')
compute_norm is  tensor(55.3235, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(213.3445, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.667299329344906
avg test loss is  2.4458273738177856
avg accuracy is  0.12188333348966525
solo acc is  0.10650000015633196
compute similarity  is  tensor(0.9019, device='cuda:3')
compute_distance is  tensor(213.3445, device='cuda:3')
compute_norm is  tensor(55.1113, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(215.9511, device='cuda:3')
distance x is tensor(215.9511, device='cuda:3')
________________________________
test distance is  tensor(215.9511, device='cuda:3')
test distance1 is  tensor(215.9511, device='cuda:3')
test similarity is  tensor(0.9013, device='cuda:3')
test acc is  0.2362666668230045
test loss is 1.5792904517798028
test entropy is  1.0338895934095769
________________________________
cal ratio is  0.9565715552458787
distance x is tensor(206.5703, device='cuda:3')
cal_distance is  tensor(206.5703, device='cuda:3')
cal ratio is  0.9780505866364155
distance x is tensor(202.0361, device='cuda:3')
cal_distance is  tensor(202.0361, device='cuda:3')
distance x is tensor(202.0361, device='cuda:3')
return_distance is  tensor(202.0361, device='cuda:3')
distance x is tensor(202.0386, device='cuda:3')
distance x is tensor(202.0386, device='cuda:3')
________________________________
test distance is  tensor(202.0386, device='cuda:3')
test distance1 is  tensor(202.0386, device='cuda:3')
test similarity is  tensor(0.9121, device='cuda:3')
test acc is  0.21885000015633713
test loss is 1.639499815923573
test entropy is  0.9940757853771324
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.180506706237793
mal norm is  tensor(993.2742, device='cuda:3')
distance x is tensor(202.0361, device='cuda:3')
mal distance is  tensor(202.0361, device='cuda:3')
user_PLR len size 52
counter_tensor is  tensor([12.,  0., 12.,  0.,  0., 12., 12., 32., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 12., 35., 12., 51., 48., 50.,  0., 50.,
        12., 42., 29., 47., 49., 12.,  0., 50., 39., 51., 18., 51., 51.,  0.,
        51., 12., 12., 12., 12., 12., 12., 48., 12., 12.])
count_res tensor([1.8166e-18, 1.1161e-23, 1.8166e-18, 1.1161e-23, 1.1161e-23, 1.8166e-18,
        1.8166e-18, 8.8133e-10, 2.6272e-06, 2.6272e-06, 2.6272e-06, 2.6272e-06,
        2.6272e-06, 2.6272e-06, 2.6272e-06, 2.6272e-06, 2.6272e-06, 2.6272e-06,
        2.6272e-06, 2.6272e-06, 1.8166e-18, 1.7702e-08, 1.8166e-18, 1.5730e-01,
        7.8316e-03, 5.7868e-02, 1.1161e-23, 5.7868e-02, 1.8166e-18, 1.9413e-05,
        4.3879e-11, 2.8811e-03, 2.1289e-02, 1.8166e-18, 1.1161e-23, 5.7868e-02,
        9.6650e-07, 1.5730e-01, 7.3285e-16, 1.5730e-01, 1.5730e-01, 1.1161e-23,
        1.5730e-01, 1.8166e-18, 1.8166e-18, 1.8166e-18, 1.8166e-18, 1.8166e-18,
        1.8166e-18, 7.8316e-03, 1.8166e-18, 1.8166e-18])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 89.63% 

Test Accuracy: 89.25% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.63042813539505
distance x is tensor(115.1373, device='cuda:3')
benign distance is  tensor(115.1373, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2169692516326904
distance x is tensor(110.3978, device='cuda:3')
benign distance is  tensor(110.3978, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.31640625
distance x is tensor(120.2551, device='cuda:3')
benign distance is  tensor(120.2551, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5897406339645386
distance x is tensor(109.7275, device='cuda:3')
benign distance is  tensor(109.7275, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6470600962638855
distance x is tensor(101.4579, device='cuda:3')
benign distance is  tensor(101.4579, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5774277448654175
distance x is tensor(130.5247, device='cuda:3')
benign distance is  tensor(130.5247, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.48347148299217224
distance x is tensor(115.5283, device='cuda:3')
benign distance is  tensor(115.5283, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5782535672187805
distance x is tensor(123.3938, device='cuda:3')
benign distance is  tensor(123.3938, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.3308250606060028
distance x is tensor(134.8132, device='cuda:3')
benign distance is  tensor(134.8132, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.19287464022636414
distance x is tensor(121.8114, device='cuda:3')
benign distance is  tensor(121.8114, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.9662682414054871
distance x is tensor(129.3870, device='cuda:3')
benign distance is  tensor(129.3870, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7313903570175171
distance x is tensor(117.9242, device='cuda:3')
benign distance is  tensor(117.9242, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.396247535943985
distance x is tensor(122.7661, device='cuda:3')
benign distance is  tensor(122.7661, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.17206504940986633
distance x is tensor(120.5945, device='cuda:3')
benign distance is  tensor(120.5945, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.41003432869911194
distance x is tensor(133.1447, device='cuda:3')
benign distance is  tensor(133.1447, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5216416716575623
distance x is tensor(131.4509, device='cuda:3')
benign distance is  tensor(131.4509, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.45548972487449646
distance x is tensor(127.1073, device='cuda:3')
benign distance is  tensor(127.1073, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.8038975596427917
distance x is tensor(124.4168, device='cuda:3')
benign distance is  tensor(124.4168, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.20782089233398438
distance x is tensor(124.2572, device='cuda:3')
benign distance is  tensor(124.2572, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.2017812728881836
distance x is tensor(120.9798, device='cuda:3')
benign distance is  tensor(120.9798, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.3603925108909607
distance x is tensor(110.0292, device='cuda:3')
benign distance is  tensor(110.0292, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.016518235206604
distance x is tensor(112.8355, device='cuda:3')
benign distance is  tensor(112.8355, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.1792757660150528
distance x is tensor(129.4153, device='cuda:3')
benign distance is  tensor(129.4153, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4167848229408264
distance x is tensor(122.0335, device='cuda:3')
benign distance is  tensor(122.0335, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.5285838842391968
distance x is tensor(132.0047, device='cuda:3')
benign distance is  tensor(132.0047, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.19602902233600616
distance x is tensor(122.3038, device='cuda:3')
benign distance is  tensor(122.3038, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.02812420204281807
distance x is tensor(123.5325, device='cuda:3')
benign distance is  tensor(123.5325, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.577753484249115
distance x is tensor(136.7037, device='cuda:3')
benign distance is  tensor(136.7037, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.3045560121536255
distance x is tensor(119.8667, device='cuda:3')
benign distance is  tensor(119.8667, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6848340630531311
distance x is tensor(128.7786, device='cuda:3')
benign distance is  tensor(128.7786, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.3672606945037842
distance x is tensor(128.3298, device='cuda:3')
benign distance is  tensor(128.3298, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.2541532814502716
distance x is tensor(133.5762, device='cuda:3')
benign distance is  tensor(133.5762, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.09748201072216034
distance x is tensor(124.9993, device='cuda:3')
benign distance is  tensor(124.9993, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.4930468499660492
distance x is tensor(133.9530, device='cuda:3')
benign distance is  tensor(133.9530, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.06655459851026535
distance x is tensor(126.2638, device='cuda:3')
benign distance is  tensor(126.2638, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.701751708984375
distance x is tensor(121.0258, device='cuda:3')
benign distance is  tensor(121.0258, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.2463558465242386
distance x is tensor(131.5202, device='cuda:3')
benign distance is  tensor(131.5202, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7913855314254761
distance x is tensor(136.0068, device='cuda:3')
benign distance is  tensor(136.0068, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6705475449562073
distance x is tensor(119.4184, device='cuda:3')
benign distance is  tensor(119.4184, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.4402923583984375
distance x is tensor(120.6467, device='cuda:3')
benign distance is  tensor(120.6467, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(129.2639, device='cuda:3')
compute distance is  tensor(129.2639, device='cuda:3')
compute norm is  tensor(51.0227, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.3311, device='cuda:3')
compute distance is  tensor(123.3311, device='cuda:3')
compute norm is  tensor(51.0118, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.6369, device='cuda:3')
compute distance is  tensor(129.6369, device='cuda:3')
compute norm is  tensor(51.1942, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.2842, device='cuda:3')
compute distance is  tensor(119.2842, device='cuda:3')
compute norm is  tensor(51.0136, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.9355, device='cuda:3')
compute distance is  tensor(135.9355, device='cuda:3')
compute norm is  tensor(51.1393, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.9482, device='cuda:3')
compute distance is  tensor(127.9482, device='cuda:3')
compute norm is  tensor(51.3070, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.5078, device='cuda:3')
compute distance is  tensor(131.5078, device='cuda:3')
compute norm is  tensor(51.3445, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.6366, device='cuda:3')
compute distance is  tensor(126.6366, device='cuda:3')
compute norm is  tensor(50.9942, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.1507, device='cuda:3')
compute distance is  tensor(129.1507, device='cuda:3')
compute norm is  tensor(51.1714, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.9600, device='cuda:3')
compute distance is  tensor(124.9600, device='cuda:3')
compute norm is  tensor(51.1854, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.3860, device='cuda:3')
compute distance is  tensor(126.3860, device='cuda:3')
compute norm is  tensor(51.2548, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.7659, device='cuda:3')
compute distance is  tensor(125.7659, device='cuda:3')
compute norm is  tensor(51.1639, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(135.9355, device='cuda:3')
distance x is tensor(107740.3750, device='cuda:3')
distance x is tensor(107740.3750, device='cuda:3')
________________________________
test distance is  tensor(107740.3750, device='cuda:3')
test distance1 is  tensor(107740.3750, device='cuda:3')
test similarity is  tensor(-0.1048, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130125567277182.64
test entropy is  0.0
________________________________
cal ratio is  0.03480993851325014
distance x is tensor(3750.4417, device='cuda:3')
cal_distance is  tensor(3750.4417, device='cuda:3')
cal ratio is  0.1865740702146719
distance x is tensor(699.7394, device='cuda:3')
cal_distance is  tensor(699.7394, device='cuda:3')
cal ratio is  0.4319409030172529
distance x is tensor(302.2490, device='cuda:3')
cal_distance is  tensor(302.2490, device='cuda:3')
cal ratio is  0.6572188917327391
distance x is tensor(198.6456, device='cuda:3')
cal_distance is  tensor(198.6456, device='cuda:3')
cal ratio is  0.8106866414435627
distance x is tensor(161.0403, device='cuda:3')
cal_distance is  tensor(161.0403, device='cuda:3')
cal ratio is  0.900378648114761
distance x is tensor(144.9978, device='cuda:3')
cal_distance is  tensor(144.9978, device='cuda:3')
cal ratio is  0.948881191297787
distance x is tensor(137.5860, device='cuda:3')
cal_distance is  tensor(137.5860, device='cuda:3')
cal ratio is  0.9741042688034394
distance x is tensor(134.0232, device='cuda:3')
cal_distance is  tensor(134.0232, device='cuda:3')
distance x is tensor(134.0232, device='cuda:3')
return_distance is  tensor(134.0232, device='cuda:3')
distance x is tensor(134.0128, device='cuda:3')
distance x is tensor(134.0128, device='cuda:3')
________________________________
test distance is  tensor(134.0128, device='cuda:3')
test distance1 is  tensor(134.0128, device='cuda:3')
test similarity is  tensor(0.9531, device='cuda:3')
test acc is  0.10040000015633196
test loss is 273.9845876632723
test entropy is  0.00011100991384903089
________________________________
0
distance x is tensor(134.0128, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  9.338308640719811e-05
avg test loss is  274.06501787913635
avg accuracy is  0.42305000015634137
solo acc is  0.10046666682299865
compute similarity  is  tensor(0.9531, device='cuda:3')
compute_distance is  tensor(134.0128, device='cuda:3')
compute_norm is  tensor(49.9293, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(116.9031, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9371050142530185
avg test loss is  1.5155809339938133
avg accuracy is  0.8313500001563241
solo acc is  0.3344666668230069
compute similarity  is  tensor(0.9585, device='cuda:3')
compute_distance is  tensor(116.9031, device='cuda:3')
compute_norm is  tensor(48.6683, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(119.5067, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8814457323251248
avg test loss is  1.5757169628194145
avg accuracy is  0.8350500001563238
solo acc is  0.2807166668230057
compute similarity  is  tensor(0.9581, device='cuda:3')
compute_distance is  tensor(119.5067, device='cuda:3')
compute_norm is  tensor(48.3227, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(121.8287, device='cuda:3')
exit early
distance x is tensor(121.8287, device='cuda:3')
distance x is tensor(121.8287, device='cuda:3')
________________________________
test distance is  tensor(121.8287, device='cuda:3')
test distance1 is  tensor(121.8287, device='cuda:3')
test similarity is  tensor(0.9577, device='cuda:3')
test acc is  0.2606166668230052
test loss is 1.58077694955411
test entropy is  0.8418667421920467
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.7989261150360107
mal norm is  tensor(640.8983, device='cuda:3')
distance x is tensor(121.8362, device='cuda:3')
mal distance is  tensor(121.8362, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([12., 22., 12., 13., 12., 16., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12.,  0., 25., 12., 27., 17., 12., 12.])
count_res tensor([2.6779e-07, 5.8984e-03, 2.6779e-07, 7.2792e-07, 2.6779e-07, 1.4621e-05,
        2.6779e-07, 2.6779e-07, 1.4621e-05, 1.4621e-05, 1.4621e-05, 1.4621e-05,
        1.4621e-05, 1.4621e-05, 1.4621e-05, 1.4621e-05, 1.4621e-05, 1.4621e-05,
        1.4621e-05, 1.4621e-05, 2.6779e-07, 1.6453e-12, 1.1847e-01, 2.6779e-07,
        8.7540e-01, 3.9743e-05, 2.6779e-07, 2.6779e-07])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 88.26% 

Test Accuracy: 87.57% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.738292932510376
distance x is tensor(134.0918, device='cuda:3')
benign distance is  tensor(134.0918, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2182397842407227
distance x is tensor(119.6427, device='cuda:3')
benign distance is  tensor(119.6427, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.27214980125427246
distance x is tensor(139.4990, device='cuda:3')
benign distance is  tensor(139.4990, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3812772333621979
distance x is tensor(127.8199, device='cuda:3')
benign distance is  tensor(127.8199, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4688991606235504
distance x is tensor(120.9324, device='cuda:3')
benign distance is  tensor(120.9324, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9631125330924988
distance x is tensor(141.7314, device='cuda:3')
benign distance is  tensor(141.7314, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.38426539301872253
distance x is tensor(142.5137, device='cuda:3')
benign distance is  tensor(142.5137, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4005211293697357
distance x is tensor(140.3946, device='cuda:3')
benign distance is  tensor(140.3946, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.32889899611473083
distance x is tensor(145.6601, device='cuda:3')
benign distance is  tensor(145.6601, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.05653178691864014
distance x is tensor(144.0285, device='cuda:3')
benign distance is  tensor(144.0285, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.5141646265983582
distance x is tensor(140.7952, device='cuda:3')
benign distance is  tensor(140.7952, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.07132796943187714
distance x is tensor(140.4172, device='cuda:3')
benign distance is  tensor(140.4172, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4482004642486572
distance x is tensor(94.8553, device='cuda:3')
benign distance is  tensor(94.8553, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.1078451871871948
distance x is tensor(138.9583, device='cuda:3')
benign distance is  tensor(138.9583, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.5695566534996033
distance x is tensor(134.7478, device='cuda:3')
benign distance is  tensor(134.7478, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.42660146951675415
distance x is tensor(141.9383, device='cuda:3')
benign distance is  tensor(141.9383, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(135.8476, device='cuda:3')
compute distance is  tensor(135.8476, device='cuda:3')
compute norm is  tensor(51.6160, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.6551, device='cuda:3')
compute distance is  tensor(133.6551, device='cuda:3')
compute norm is  tensor(51.6899, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.0655, device='cuda:3')
compute distance is  tensor(151.0655, device='cuda:3')
compute norm is  tensor(52.0449, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.4592, device='cuda:3')
compute distance is  tensor(137.4592, device='cuda:3')
compute norm is  tensor(51.6283, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.7785, device='cuda:3')
compute distance is  tensor(147.7785, device='cuda:3')
compute norm is  tensor(51.9344, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.1772, device='cuda:3')
compute distance is  tensor(141.1772, device='cuda:3')
compute norm is  tensor(51.9345, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.2974, device='cuda:3')
compute distance is  tensor(142.2974, device='cuda:3')
compute norm is  tensor(52.0792, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.5903, device='cuda:3')
compute distance is  tensor(139.5903, device='cuda:3')
compute norm is  tensor(51.7396, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.1680, device='cuda:3')
compute distance is  tensor(143.1680, device='cuda:3')
compute norm is  tensor(51.9906, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.5826, device='cuda:3')
compute distance is  tensor(133.5826, device='cuda:3')
compute norm is  tensor(51.7672, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.6715, device='cuda:3')
compute distance is  tensor(148.6715, device='cuda:3')
compute norm is  tensor(52.0469, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.0462, device='cuda:3')
compute distance is  tensor(145.0462, device='cuda:3')
compute norm is  tensor(52.0682, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(151.0655, device='cuda:3')
distance x is tensor(107741.9766, device='cuda:3')
distance x is tensor(107741.9766, device='cuda:3')
________________________________
test distance is  tensor(107741.9766, device='cuda:3')
test distance1 is  tensor(107741.9766, device='cuda:3')
test similarity is  tensor(-0.1026, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130059501426587.56
test entropy is  0.0
________________________________
cal ratio is  0.03669578918909213
distance x is tensor(3953.6824, device='cuda:3')
cal_distance is  tensor(3953.6824, device='cuda:3')
cal ratio is  0.19156132157462677
distance x is tensor(757.3768, device='cuda:3')
cal_distance is  tensor(757.3768, device='cuda:3')
cal ratio is  0.43767596830614025
distance x is tensor(331.4886, device='cuda:3')
cal_distance is  tensor(331.4886, device='cuda:3')
cal ratio is  0.6615679264161394
distance x is tensor(219.3040, device='cuda:3')
cal_distance is  tensor(219.3040, device='cuda:3')
cal ratio is  0.8133649481103453
distance x is tensor(178.3751, device='cuda:3')
cal_distance is  tensor(178.3751, device='cuda:3')
cal ratio is  0.9018650199908965
distance x is tensor(160.8708, device='cuda:3')
cal_distance is  tensor(160.8708, device='cuda:3')
cal ratio is  0.9496641998344894
distance x is tensor(152.7735, device='cuda:3')
cal_distance is  tensor(152.7735, device='cuda:3')
cal ratio is  0.9745062634554019
distance x is tensor(148.8789, device='cuda:3')
cal_distance is  tensor(148.8789, device='cuda:3')
distance x is tensor(148.8789, device='cuda:3')
return_distance is  tensor(148.8789, device='cuda:3')
distance x is tensor(148.8685, device='cuda:3')
distance x is tensor(148.8685, device='cuda:3')
________________________________
test distance is  tensor(148.8685, device='cuda:3')
test distance1 is  tensor(148.8685, device='cuda:3')
test similarity is  tensor(0.9445, device='cuda:3')
test acc is  0.10035000015633198
test loss is 416.3925865840302
test entropy is  5.3666490990702676e-05
________________________________
0
distance x is tensor(148.8685, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  8.314003437176086e-05
avg test loss is  416.06751949090693
avg accuracy is  0.27786666682300565
solo acc is  0.10031666682299865
compute similarity  is  tensor(0.9445, device='cuda:3')
compute_distance is  tensor(148.8685, device='cuda:3')
compute_norm is  tensor(50.8114, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(127.3978, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9665128074602277
avg test loss is  1.5160267345432534
avg accuracy is  0.795033333489659
solo acc is  0.34466666682300706
compute similarity  is  tensor(0.9519, device='cuda:3')
compute_distance is  tensor(127.3978, device='cuda:3')
compute_norm is  tensor(49.6152, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(127.3978, device='cuda:3')
distance x is tensor(127.3978, device='cuda:3')
________________________________
test distance is  tensor(127.3978, device='cuda:3')
test distance1 is  tensor(127.3978, device='cuda:3')
test similarity is  tensor(0.9519, device='cuda:3')
test acc is  0.3438500001563404
test loss is 1.5125032541340093
test entropy is  0.9682387275609381
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.583905816078186
mal norm is  tensor(698.8333, device='cuda:3')
distance x is tensor(127.4058, device='cuda:3')
mal distance is  tensor(127.4058, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([12., 12., 27., 12., 12., 12., 12., 16., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 26., 27., 12., 12., 12.,  0., 12.])
count_res tensor([1.2918e-07, 1.2918e-07, 4.2228e-01, 1.2918e-07, 1.2918e-07, 1.2918e-07,
        1.2918e-07, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06,
        7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06, 7.0528e-06,
        7.0528e-06, 7.0528e-06, 1.2918e-07, 1.5535e-01, 4.2228e-01, 1.2918e-07,
        1.2918e-07, 1.2918e-07, 7.9369e-13, 1.2918e-07])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 89.38% 

Test Accuracy: 88.65% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.06462816894054413
distance x is tensor(118.8359, device='cuda:3')
benign distance is  tensor(118.8359, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5680373311042786
distance x is tensor(111.8764, device='cuda:3')
benign distance is  tensor(111.8764, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.15654513239860535
distance x is tensor(92.3890, device='cuda:3')
benign distance is  tensor(92.3890, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.44004693627357483
distance x is tensor(114.7239, device='cuda:3')
benign distance is  tensor(114.7239, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7102173566818237
distance x is tensor(107.5498, device='cuda:3')
benign distance is  tensor(107.5498, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7543827295303345
distance x is tensor(143.9962, device='cuda:3')
benign distance is  tensor(143.9962, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.21336278319358826
distance x is tensor(126.2952, device='cuda:3')
benign distance is  tensor(126.2952, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.40520721673965454
distance x is tensor(121.2778, device='cuda:3')
benign distance is  tensor(121.2778, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.19574567675590515
distance x is tensor(135.6239, device='cuda:3')
benign distance is  tensor(135.6239, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.979328453540802
distance x is tensor(128.8896, device='cuda:3')
benign distance is  tensor(128.8896, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.4730657637119293
distance x is tensor(108.4270, device='cuda:3')
benign distance is  tensor(108.4270, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.49258846044540405
distance x is tensor(127.2023, device='cuda:3')
benign distance is  tensor(127.2023, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6473979353904724
distance x is tensor(121.6686, device='cuda:3')
benign distance is  tensor(121.6686, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.1515856236219406
distance x is tensor(126.8502, device='cuda:3')
benign distance is  tensor(126.8502, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5831276178359985
distance x is tensor(132.5607, device='cuda:3')
benign distance is  tensor(132.5607, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.4226694703102112
distance x is tensor(134.5459, device='cuda:3')
benign distance is  tensor(134.5459, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(123.0166, device='cuda:3')
compute distance is  tensor(123.0166, device='cuda:3')
compute norm is  tensor(51.6778, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.5863, device='cuda:3')
compute distance is  tensor(121.5863, device='cuda:3')
compute norm is  tensor(51.6799, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.2076, device='cuda:3')
compute distance is  tensor(137.2076, device='cuda:3')
compute norm is  tensor(52.0801, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.8732, device='cuda:3')
compute distance is  tensor(129.8732, device='cuda:3')
compute norm is  tensor(51.8810, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.6146, device='cuda:3')
compute distance is  tensor(128.6146, device='cuda:3')
compute norm is  tensor(51.9747, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.6104, device='cuda:3')
compute distance is  tensor(128.6104, device='cuda:3')
compute norm is  tensor(51.9979, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.1000, device='cuda:3')
compute distance is  tensor(124.1000, device='cuda:3')
compute norm is  tensor(51.8945, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.9309, device='cuda:3')
compute distance is  tensor(132.9309, device='cuda:3')
compute norm is  tensor(52.0351, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.3697, device='cuda:3')
compute distance is  tensor(138.3697, device='cuda:3')
compute norm is  tensor(52.1505, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.1943, device='cuda:3')
compute distance is  tensor(129.1943, device='cuda:3')
compute norm is  tensor(52.0300, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.2047, device='cuda:3')
compute distance is  tensor(134.2047, device='cuda:3')
compute norm is  tensor(52.0876, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.8472, device='cuda:3')
compute distance is  tensor(135.8472, device='cuda:3')
compute norm is  tensor(51.9997, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(138.3697, device='cuda:3')
distance x is tensor(107744.6719, device='cuda:3')
distance x is tensor(107744.6719, device='cuda:3')
________________________________
test distance is  tensor(107744.6719, device='cuda:3')
test distance1 is  tensor(107744.6719, device='cuda:3')
test similarity is  tensor(-0.1043, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130106274945447.58
test entropy is  0.0
________________________________
cal ratio is  0.03511952622020402
distance x is tensor(3783.9473, device='cuda:3')
cal_distance is  tensor(3783.9473, device='cuda:3')
cal ratio is  0.18740191766433026
distance x is tensor(709.1233, device='cuda:3')
cal_distance is  tensor(709.1233, device='cuda:3')
cal ratio is  0.43289810330482553
distance x is tensor(306.9811, device='cuda:3')
cal_distance is  tensor(306.9811, device='cuda:3')
cal ratio is  0.6579467603622993
distance x is tensor(201.9790, device='cuda:3')
cal_distance is  tensor(201.9790, device='cuda:3')
cal ratio is  0.8111355749056114
distance x is tensor(163.8334, device='cuda:3')
cal_distance is  tensor(163.8334, device='cuda:3')
cal ratio is  0.900627903069947
distance x is tensor(147.5534, device='cuda:3')
cal_distance is  tensor(147.5534, device='cuda:3')
cal ratio is  0.9490124262367022
distance x is tensor(140.0303, device='cuda:3')
cal_distance is  tensor(140.0303, device='cuda:3')
cal ratio is  0.9741717887028031
distance x is tensor(136.4137, device='cuda:3')
cal_distance is  tensor(136.4137, device='cuda:3')
distance x is tensor(136.4137, device='cuda:3')
return_distance is  tensor(136.4137, device='cuda:3')
distance x is tensor(136.4033, device='cuda:3')
distance x is tensor(136.4033, device='cuda:3')
________________________________
test distance is  tensor(136.4033, device='cuda:3')
test distance1 is  tensor(136.4033, device='cuda:3')
test similarity is  tensor(0.9532, device='cuda:3')
test acc is  0.10021666682299865
test loss is 296.2132508332795
test entropy is  6.0968722589342185e-05
________________________________
0
distance x is tensor(136.4033, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  3.0252665167178317e-05
avg test loss is  295.8032208505724
avg accuracy is  0.3823833334896742
solo acc is  0.10021666682299865
compute similarity  is  tensor(0.9532, device='cuda:3')
compute_distance is  tensor(136.4033, device='cuda:3')
compute_norm is  tensor(50.8017, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(116.1397, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9401307597851702
avg test loss is  1.556610394896729
avg accuracy is  0.8230833334896578
solo acc is  0.3298000001563401
compute similarity  is  tensor(0.9592, device='cuda:3')
compute_distance is  tensor(116.1397, device='cuda:3')
compute_norm is  tensor(49.5047, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(119.1346, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9009578461204765
avg test loss is  1.567584027105303
avg accuracy is  0.8294333334896574
solo acc is  0.291716666823006
compute similarity  is  tensor(0.9587, device='cuda:3')
compute_distance is  tensor(119.1346, device='cuda:3')
compute_norm is  tensor(49.1463, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(121.9100, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8846362691952475
avg test loss is  1.5257963517835653
avg accuracy is  0.8349333334896573
solo acc is  0.2855833334896725
compute similarity  is  tensor(0.9582, device='cuda:3')
compute_distance is  tensor(121.9100, device='cuda:3')
compute_norm is  tensor(48.8233, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(124.5028, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8606754395244981
avg test loss is  1.5104358765616346
avg accuracy is  0.8395500001563238
solo acc is  0.277700000156339
compute similarity  is  tensor(0.9578, device='cuda:3')
compute_distance is  tensor(124.5028, device='cuda:3')
compute_norm is  tensor(48.5202, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(127.0065, device='cuda:3')
distance x is tensor(127.0065, device='cuda:3')
________________________________
test distance is  tensor(127.0065, device='cuda:3')
test distance1 is  tensor(127.0065, device='cuda:3')
test similarity is  tensor(0.9574, device='cuda:3')
test acc is  0.27626666682300566
test loss is 1.4715839272368945
test entropy is  0.8591932369701898
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.313520073890686
mal norm is  tensor(654.2224, device='cuda:3')
distance x is tensor(127.0138, device='cuda:3')
mal distance is  tensor(127.0138, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([15., 27., 12., 12., 12.,  0., 27., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 27., 12., 12., 12., 12., 12., 12., 12.])
count_res tensor([2.0479e-06, 3.3331e-01, 1.0196e-07, 1.0196e-07, 1.0196e-07, 6.2647e-13,
        3.3331e-01, 1.0196e-07, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06,
        5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06,
        5.5668e-06, 5.5668e-06, 3.3331e-01, 1.0196e-07, 1.0196e-07, 1.0196e-07,
        1.0196e-07, 1.0196e-07, 1.0196e-07, 1.0196e-07])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 89.62% 

Test Accuracy: 88.91% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3732006549835205
distance x is tensor(138.9728, device='cuda:3')
benign distance is  tensor(138.9728, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7573512196540833
distance x is tensor(96.8240, device='cuda:3')
benign distance is  tensor(96.8240, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.23821859061717987
distance x is tensor(113.1201, device='cuda:3')
benign distance is  tensor(113.1201, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5751746892929077
distance x is tensor(111.2468, device='cuda:3')
benign distance is  tensor(111.2468, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.35530886054039
distance x is tensor(112.0123, device='cuda:3')
benign distance is  tensor(112.0123, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.43022871017456055
distance x is tensor(136.1799, device='cuda:3')
benign distance is  tensor(136.1799, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.601044774055481
distance x is tensor(102.9975, device='cuda:3')
benign distance is  tensor(102.9975, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.48820096254348755
distance x is tensor(126.1795, device='cuda:3')
benign distance is  tensor(126.1795, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.14033666253089905
distance x is tensor(121.5172, device='cuda:3')
benign distance is  tensor(121.5172, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.47227707505226135
distance x is tensor(139.7852, device='cuda:3')
benign distance is  tensor(139.7852, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.35487857460975647
distance x is tensor(126.4568, device='cuda:3')
benign distance is  tensor(126.4568, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.21232280135154724
distance x is tensor(135.1020, device='cuda:3')
benign distance is  tensor(135.1020, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.007559061050415
distance x is tensor(137.9908, device='cuda:3')
benign distance is  tensor(137.9908, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.106966257095337
distance x is tensor(129.8711, device='cuda:3')
benign distance is  tensor(129.8711, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.17189547419548035
distance x is tensor(141.7749, device='cuda:3')
benign distance is  tensor(141.7749, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4522072672843933
distance x is tensor(129.2195, device='cuda:3')
benign distance is  tensor(129.2195, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(123.2170, device='cuda:3')
compute distance is  tensor(123.2170, device='cuda:3')
compute norm is  tensor(51.9104, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.7773, device='cuda:3')
compute distance is  tensor(124.7773, device='cuda:3')
compute norm is  tensor(51.9471, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.0218, device='cuda:3')
compute distance is  tensor(134.0218, device='cuda:3')
compute norm is  tensor(52.3152, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.6775, device='cuda:3')
compute distance is  tensor(131.6775, device='cuda:3')
compute norm is  tensor(52.1116, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.9660, device='cuda:3')
compute distance is  tensor(124.9660, device='cuda:3')
compute norm is  tensor(52.0034, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.2965, device='cuda:3')
compute distance is  tensor(135.2965, device='cuda:3')
compute norm is  tensor(52.3885, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.7657, device='cuda:3')
compute distance is  tensor(130.7657, device='cuda:3')
compute norm is  tensor(52.0644, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.7504, device='cuda:3')
compute distance is  tensor(137.7504, device='cuda:3')
compute norm is  tensor(52.3428, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.3050, device='cuda:3')
compute distance is  tensor(135.3050, device='cuda:3')
compute norm is  tensor(52.1853, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.6358, device='cuda:3')
compute distance is  tensor(133.6358, device='cuda:3')
compute norm is  tensor(52.3745, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.5200, device='cuda:3')
compute distance is  tensor(135.5200, device='cuda:3')
compute norm is  tensor(52.3694, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.5446, device='cuda:3')
compute distance is  tensor(136.5446, device='cuda:3')
compute norm is  tensor(52.2203, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(137.7504, device='cuda:3')
distance x is tensor(107746.2422, device='cuda:3')
distance x is tensor(107746.2422, device='cuda:3')
________________________________
test distance is  tensor(107746.2422, device='cuda:3')
test distance1 is  tensor(107746.2422, device='cuda:3')
test similarity is  tensor(-0.1047, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130130100783221.9
test entropy is  0.0
________________________________
cal ratio is  0.03504059016962552
distance x is tensor(3775.4980, device='cuda:3')
cal_distance is  tensor(3775.4980, device='cuda:3')
cal ratio is  0.18719117307084246
distance x is tensor(706.7440, device='cuda:3')
cal_distance is  tensor(706.7440, device='cuda:3')
cal ratio is  0.4326546893258703
distance x is tensor(305.7791, device='cuda:3')
cal_distance is  tensor(305.7791, device='cuda:3')
cal ratio is  0.6577616540915951
distance x is tensor(201.1315, device='cuda:3')
cal_distance is  tensor(201.1315, device='cuda:3')
cal ratio is  0.8110215208594248
distance x is tensor(163.1230, device='cuda:3')
cal_distance is  tensor(163.1230, device='cuda:3')
cal ratio is  0.900564562869643
distance x is tensor(146.9033, device='cuda:3')
cal_distance is  tensor(146.9033, device='cuda:3')
cal ratio is  0.9489790989264418
distance x is tensor(139.4085, device='cuda:3')
cal_distance is  tensor(139.4085, device='cuda:3')
cal ratio is  0.9741546594237631
distance x is tensor(135.8055, device='cuda:3')
cal_distance is  tensor(135.8055, device='cuda:3')
distance x is tensor(135.8055, device='cuda:3')
return_distance is  tensor(135.8055, device='cuda:3')
distance x is tensor(135.7951, device='cuda:3')
distance x is tensor(135.7951, device='cuda:3')
________________________________
test distance is  tensor(135.7951, device='cuda:3')
test distance1 is  tensor(135.7951, device='cuda:3')
test similarity is  tensor(0.9541, device='cuda:3')
test acc is  0.10026666682299865
test loss is 293.7346393609606
test entropy is  8.184419320980036e-05
________________________________
0
distance x is tensor(135.7951, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  6.687341695588511e-05
avg test loss is  294.0048411843111
avg accuracy is  0.3972333334896744
solo acc is  0.10018333348966532
compute similarity  is  tensor(0.9541, device='cuda:3')
compute_distance is  tensor(135.7951, device='cuda:3')
compute_norm is  tensor(51.0136, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(118.5742, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9369081026201309
avg test loss is  1.4948376869596143
avg accuracy is  0.8250000001563242
solo acc is  0.35441666682300715
compute similarity  is  tensor(0.9596, device='cuda:3')
compute_distance is  tensor(118.5742, device='cuda:3')
compute_norm is  tensor(49.6940, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(121.5439, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9055417773566012
avg test loss is  1.5388874261618168
avg accuracy is  0.8265666668229908
solo acc is  0.3005833334896728
compute similarity  is  tensor(0.9590, device='cuda:3')
compute_distance is  tensor(121.5439, device='cuda:3')
compute_norm is  tensor(49.3413, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(124.1544, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8841230819728583
avg test loss is  1.5282349036192335
avg accuracy is  0.8299333334896574
solo acc is  0.28318333348967245
compute similarity  is  tensor(0.9586, device='cuda:3')
compute_distance is  tensor(124.1544, device='cuda:3')
compute_norm is  tensor(49.0239, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(126.6020, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8758191340513575
avg test loss is  1.4896167741655542
avg accuracy is  0.8339333334896573
solo acc is  0.2810500001563392
compute similarity  is  tensor(0.9582, device='cuda:3')
compute_distance is  tensor(126.6020, device='cuda:3')
compute_norm is  tensor(48.7292, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(128.8758, device='cuda:3')
distance x is tensor(128.8758, device='cuda:3')
________________________________
test distance is  tensor(128.8758, device='cuda:3')
test distance1 is  tensor(128.8758, device='cuda:3')
test similarity is  tensor(0.9578, device='cuda:3')
test acc is  0.27940000015633903
test loss is 1.458431477104423
test entropy is  0.8697950156258621
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.5215190649032593
mal norm is  tensor(653.8242, device='cuda:3')
distance x is tensor(128.8832, device='cuda:3')
mal distance is  tensor(128.8832, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([19., 34., 12., 35., 12.,  0., 12., 25., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24.,  0., 12., 35.,  0., 16., 12.,  0., 35.,
        14., 12., 12., 24., 14., 28., 33., 12.])
count_res tensor([3.2113e-08, 1.0498e-01, 2.9283e-11, 2.8536e-01, 2.9283e-11, 1.7992e-16,
        2.9283e-11, 1.2955e-05, 4.7659e-06, 4.7659e-06, 4.7659e-06, 4.7659e-06,
        4.7659e-06, 4.7659e-06, 4.7659e-06, 4.7659e-06, 4.7659e-06, 4.7659e-06,
        4.7659e-06, 4.7659e-06, 1.7992e-16, 2.9283e-11, 2.8536e-01, 1.7992e-16,
        1.5988e-09, 2.9283e-11, 1.7992e-16, 2.8536e-01, 2.1637e-10, 2.9283e-11,
        2.9283e-11, 4.7659e-06, 2.1637e-10, 2.6021e-04, 3.8619e-02, 2.9283e-11])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 89.83% 

Test Accuracy: 88.82% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.711746096611023
distance x is tensor(125.9169, device='cuda:3')
benign distance is  tensor(125.9169, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.29673078656196594
distance x is tensor(105.0773, device='cuda:3')
benign distance is  tensor(105.0773, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.10737515985965729
distance x is tensor(118.9013, device='cuda:3')
benign distance is  tensor(118.9013, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2308061569929123
distance x is tensor(111.0438, device='cuda:3')
benign distance is  tensor(111.0438, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6050124168395996
distance x is tensor(115.3350, device='cuda:3')
benign distance is  tensor(115.3350, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9085990190505981
distance x is tensor(138.5344, device='cuda:3')
benign distance is  tensor(138.5344, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5176844596862793
distance x is tensor(109.4719, device='cuda:3')
benign distance is  tensor(109.4719, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.5233567357063293
distance x is tensor(128.9929, device='cuda:3')
benign distance is  tensor(128.9929, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.6604621410369873
distance x is tensor(147.6844, device='cuda:3')
benign distance is  tensor(147.6844, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.34804949164390564
distance x is tensor(122.2057, device='cuda:3')
benign distance is  tensor(122.2057, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.16835546493530273
distance x is tensor(108.9608, device='cuda:3')
benign distance is  tensor(108.9608, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9304679036140442
distance x is tensor(121.6942, device='cuda:3')
benign distance is  tensor(121.6942, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6203586459159851
distance x is tensor(134.2475, device='cuda:3')
benign distance is  tensor(134.2475, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.275495320558548
distance x is tensor(118.1122, device='cuda:3')
benign distance is  tensor(118.1122, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.48207730054855347
distance x is tensor(126.5953, device='cuda:3')
benign distance is  tensor(126.5953, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.7931085824966431
distance x is tensor(128.5306, device='cuda:3')
benign distance is  tensor(128.5306, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.046015914529561996
distance x is tensor(133.9135, device='cuda:3')
benign distance is  tensor(133.9135, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5358905792236328
distance x is tensor(131.6101, device='cuda:3')
benign distance is  tensor(131.6101, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.37812337279319763
distance x is tensor(117.0107, device='cuda:3')
benign distance is  tensor(117.0107, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.28569045662879944
distance x is tensor(138.2460, device='cuda:3')
benign distance is  tensor(138.2460, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8145936727523804
distance x is tensor(127.2419, device='cuda:3')
benign distance is  tensor(127.2419, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.41956228017807007
distance x is tensor(128.1312, device='cuda:3')
benign distance is  tensor(128.1312, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.48282116651535034
distance x is tensor(127.2016, device='cuda:3')
benign distance is  tensor(127.2016, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.4174939692020416
distance x is tensor(114.0406, device='cuda:3')
benign distance is  tensor(114.0406, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(129.6611, device='cuda:3')
compute distance is  tensor(129.6611, device='cuda:3')
compute norm is  tensor(51.9715, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.6398, device='cuda:3')
compute distance is  tensor(119.6398, device='cuda:3')
compute norm is  tensor(51.8670, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.3249, device='cuda:3')
compute distance is  tensor(141.3249, device='cuda:3')
compute norm is  tensor(52.4739, device='cuda:3', dtype=torch.float64)
distance x is tensor(122.9172, device='cuda:3')
compute distance is  tensor(122.9172, device='cuda:3')
compute norm is  tensor(51.8631, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.1198, device='cuda:3')
compute distance is  tensor(138.1198, device='cuda:3')
compute norm is  tensor(52.0588, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.9620, device='cuda:3')
compute distance is  tensor(125.9620, device='cuda:3')
compute norm is  tensor(52.0470, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.5463, device='cuda:3')
compute distance is  tensor(127.5463, device='cuda:3')
compute norm is  tensor(52.0284, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.1127, device='cuda:3')
compute distance is  tensor(139.1127, device='cuda:3')
compute norm is  tensor(52.1478, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.8981, device='cuda:3')
compute distance is  tensor(140.8981, device='cuda:3')
compute norm is  tensor(52.3114, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.3784, device='cuda:3')
compute distance is  tensor(128.3784, device='cuda:3')
compute norm is  tensor(52.0294, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.4803, device='cuda:3')
compute distance is  tensor(136.4803, device='cuda:3')
compute norm is  tensor(52.2955, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.4152, device='cuda:3')
compute distance is  tensor(130.4152, device='cuda:3')
compute norm is  tensor(52.1420, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(141.3249, device='cuda:3')
distance x is tensor(107744.6016, device='cuda:3')
distance x is tensor(107744.6016, device='cuda:3')
________________________________
test distance is  tensor(107744.6016, device='cuda:3')
test distance1 is  tensor(107744.6016, device='cuda:3')
test similarity is  tensor(-0.1034, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130055428632200.45
test entropy is  0.0
________________________________
cal ratio is  0.03549258619203567
distance x is tensor(3824.1409, device='cuda:3')
cal_distance is  tensor(3824.1409, device='cuda:3')
cal ratio is  0.1883946101127927
distance x is tensor(720.4517, device='cuda:3')
cal_distance is  tensor(720.4517, device='cuda:3')
cal ratio is  0.43404323187013605
distance x is tensor(312.7101, device='cuda:3')
cal_distance is  tensor(312.7101, device='cuda:3')
cal ratio is  0.6588164259393084
distance x is tensor(206.0204, device='cuda:3')
cal_distance is  tensor(206.0204, device='cuda:3')
cal ratio is  0.8116715764573472
distance x is tensor(167.2218, device='cuda:3')
cal_distance is  tensor(167.2218, device='cuda:3')
cal ratio is  0.900925539184099
distance x is tensor(150.6550, device='cuda:3')
cal_distance is  tensor(150.6550, device='cuda:3')
cal ratio is  0.9491692750823496
distance x is tensor(142.9973, device='cuda:3')
cal_distance is  tensor(142.9973, device='cuda:3')
cal ratio is  0.9742522893423072
distance x is tensor(139.3156, device='cuda:3')
cal_distance is  tensor(139.3156, device='cuda:3')
distance x is tensor(139.3156, device='cuda:3')
return_distance is  tensor(139.3156, device='cuda:3')
distance x is tensor(139.3052, device='cuda:3')
distance x is tensor(139.3052, device='cuda:3')
________________________________
test distance is  tensor(139.3052, device='cuda:3')
test distance1 is  tensor(139.3052, device='cuda:3')
test similarity is  tensor(0.9514, device='cuda:3')
test acc is  0.10030000015633199
test loss is 321.6101774691519
test entropy is  9.021695801546155e-05
________________________________
0
distance x is tensor(139.3052, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00010062077915836155
avg test loss is  321.32050486159983
avg accuracy is  0.3699666668230074
solo acc is  0.10033333348966532
compute similarity  is  tensor(0.9514, device='cuda:3')
compute_distance is  tensor(139.3052, device='cuda:3')
compute_norm is  tensor(50.9508, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(119.7364, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9015413269813635
avg test loss is  1.5487182635996641
avg accuracy is  0.8208166668229913
solo acc is  0.3280333334896734
compute similarity  is  tensor(0.9573, device='cuda:3')
compute_distance is  tensor(119.7364, device='cuda:3')
compute_norm is  tensor(49.6774, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(122.8392, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8844543070172959
avg test loss is  1.570329578319338
avg accuracy is  0.8236666668229911
solo acc is  0.282000000156339
compute similarity  is  tensor(0.9567, device='cuda:3')
compute_distance is  tensor(122.8392, device='cuda:3')
compute_norm is  tensor(49.3275, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(125.4717, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8947565887909709
avg test loss is  1.4812269063392427
avg accuracy is  0.8261500001563242
solo acc is  0.2946666668230061
compute similarity  is  tensor(0.9563, device='cuda:3')
compute_distance is  tensor(125.4717, device='cuda:3')
compute_norm is  tensor(49.0175, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(127.9764, device='cuda:3')
exit early
distance x is tensor(127.9764, device='cuda:3')
distance x is tensor(127.9764, device='cuda:3')
________________________________
test distance is  tensor(127.9764, device='cuda:3')
test distance1 is  tensor(127.9764, device='cuda:3')
test similarity is  tensor(0.9559, device='cuda:3')
test acc is  0.2798333334896724
test loss is 1.4824402990625865
test entropy is  0.8743839014186534
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.3183491230010986
mal norm is  tensor(666.2711, device='cuda:3')
distance x is tensor(127.9840, device='cuda:3')
mal distance is  tensor(127.9840, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 18.56% 

Test Accuracy: 18.34% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4332011342048645
distance x is tensor(170.0694, device='cuda:3')
benign distance is  tensor(170.0694, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3033859133720398
distance x is tensor(187.5903, device='cuda:3')
benign distance is  tensor(187.5903, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3093183636665344
distance x is tensor(179.5139, device='cuda:3')
benign distance is  tensor(179.5139, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7675660252571106
distance x is tensor(174.3347, device='cuda:3')
benign distance is  tensor(174.3347, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2358201742172241
distance x is tensor(158.8237, device='cuda:3')
benign distance is  tensor(158.8237, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.45048442482948303
distance x is tensor(185.6930, device='cuda:3')
benign distance is  tensor(185.6930, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1890417337417603
distance x is tensor(189.0054, device='cuda:3')
benign distance is  tensor(189.0054, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.16707341372966766
distance x is tensor(177.9642, device='cuda:3')
benign distance is  tensor(177.9642, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(168.0317, device='cuda:3')
compute distance is  tensor(168.0317, device='cuda:3')
compute norm is  tensor(50.7043, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.0596, device='cuda:3')
compute distance is  tensor(160.0596, device='cuda:3')
compute norm is  tensor(50.5384, device='cuda:3', dtype=torch.float64)
distance x is tensor(178.6235, device='cuda:3')
compute distance is  tensor(178.6235, device='cuda:3')
compute norm is  tensor(51.1449, device='cuda:3', dtype=torch.float64)
distance x is tensor(169.1708, device='cuda:3')
compute distance is  tensor(169.1708, device='cuda:3')
compute norm is  tensor(50.8877, device='cuda:3', dtype=torch.float64)
distance x is tensor(186.6915, device='cuda:3')
compute distance is  tensor(186.6915, device='cuda:3')
compute norm is  tensor(51.0911, device='cuda:3', dtype=torch.float64)
distance x is tensor(180.9714, device='cuda:3')
compute distance is  tensor(180.9714, device='cuda:3')
compute norm is  tensor(51.0201, device='cuda:3', dtype=torch.float64)
distance x is tensor(179.1396, device='cuda:3')
compute distance is  tensor(179.1396, device='cuda:3')
compute norm is  tensor(50.9122, device='cuda:3', dtype=torch.float64)
distance x is tensor(188.0496, device='cuda:3')
compute distance is  tensor(188.0496, device='cuda:3')
compute norm is  tensor(51.1361, device='cuda:3', dtype=torch.float64)
distance x is tensor(189.0294, device='cuda:3')
compute distance is  tensor(189.0294, device='cuda:3')
compute norm is  tensor(51.1371, device='cuda:3', dtype=torch.float64)
distance x is tensor(185.5200, device='cuda:3')
compute distance is  tensor(185.5200, device='cuda:3')
compute norm is  tensor(51.1159, device='cuda:3', dtype=torch.float64)
distance x is tensor(198.4327, device='cuda:3')
compute distance is  tensor(198.4327, device='cuda:3')
compute norm is  tensor(51.4122, device='cuda:3', dtype=torch.float64)
distance x is tensor(189.0959, device='cuda:3')
compute distance is  tensor(189.0959, device='cuda:3')
compute norm is  tensor(51.0228, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(198.4327, device='cuda:3')
distance x is tensor(107669.2500, device='cuda:3')
distance x is tensor(107669.2500, device='cuda:3')
________________________________
test distance is  tensor(107669.2500, device='cuda:3')
test distance1 is  tensor(107669.2500, device='cuda:3')
test similarity is  tensor(0.1538, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130055492512612.98
test entropy is  0.0
________________________________
cal ratio is  0.04207139236623639
distance x is tensor(4529.8013, device='cuda:3')
cal_distance is  tensor(4529.8013, device='cuda:3')
cal ratio is  0.20511297855479454
distance x is tensor(929.1251, device='cuda:3')
cal_distance is  tensor(929.1251, device='cuda:3')
cal ratio is  0.4528930307271437
distance x is tensor(420.7971, device='cuda:3')
cal_distance is  tensor(420.7971, device='cuda:3')
cal ratio is  0.6729710059286461
distance x is tensor(283.1859, device='cuda:3')
cal_distance is  tensor(283.1859, device='cuda:3')
cal ratio is  0.8203456450823324
distance x is tensor(232.3113, device='cuda:3')
cal_distance is  tensor(232.3113, device='cuda:3')
cal ratio is  0.9057275061713703
distance x is tensor(210.4113, device='cuda:3')
cal_distance is  tensor(210.4113, device='cuda:3')
cal ratio is  0.9516959123591006
distance x is tensor(200.2478, device='cuda:3')
cal_distance is  tensor(200.2478, device='cuda:3')
cal ratio is  0.9755485501293697
distance x is tensor(195.3516, device='cuda:3')
cal_distance is  tensor(195.3516, device='cuda:3')
distance x is tensor(195.3516, device='cuda:3')
return_distance is  tensor(195.3516, device='cuda:3')
distance x is tensor(195.3412, device='cuda:3')
distance x is tensor(195.3412, device='cuda:3')
________________________________
test distance is  tensor(195.3412, device='cuda:3')
test distance1 is  tensor(195.3412, device='cuda:3')
test similarity is  tensor(0.9218, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2012.7801527987158
test entropy is  0.0
________________________________
0
distance x is tensor(195.3412, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  2009.8030640168993
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9218, device='cuda:3')
compute_distance is  tensor(195.3412, device='cuda:3')
compute_norm is  tensor(53.3445, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2006.0247, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.6328771677352727
avg test loss is  2.863792095102989
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2763, device='cuda:3')
compute_distance is  tensor(2006.0247, device='cuda:3')
compute_norm is  tensor(168.0477, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1997.1389, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8744112638268136
avg test loss is  3.695645959138362
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2764, device='cuda:3')
compute_distance is  tensor(1997.1389, device='cuda:3')
compute_norm is  tensor(167.4217, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1988.3503, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5697769220195599
avg test loss is  2.8594701577351294
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2763, device='cuda:3')
compute_distance is  tensor(1988.3503, device='cuda:3')
compute_norm is  tensor(166.5738, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1979.5518, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8558988949256157
avg test loss is  3.6323778586092788
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2763, device='cuda:3')
compute_distance is  tensor(1979.5518, device='cuda:3')
compute_norm is  tensor(165.9438, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1970.7004, device='cuda:3')
distance x is tensor(1970.7004, device='cuda:3')
________________________________
test distance is  tensor(1970.7004, device='cuda:3')
test distance1 is  tensor(1970.7004, device='cuda:3')
test similarity is  tensor(0.2762, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8639297063416764
test entropy is  1.5554234511308325
________________________________
cal ratio is  0.3109728049358034
distance x is tensor(612.8345, device='cuda:3')
cal_distance is  tensor(612.8345, device='cuda:3')
cal ratio is  0.5576492707277234
distance x is tensor(341.7468, device='cuda:3')
cal_distance is  tensor(341.7468, device='cuda:3')
cal ratio is  0.7467590491816457
distance x is tensor(255.2025, device='cuda:3')
cal_distance is  tensor(255.2025, device='cuda:3')
cal ratio is  0.8641521872800614
distance x is tensor(220.5338, device='cuda:3')
cal_distance is  tensor(220.5338, device='cuda:3')
cal ratio is  0.929597828658136
distance x is tensor(205.0078, device='cuda:3')
cal_distance is  tensor(205.0078, device='cuda:3')
cal ratio is  0.9641564709015228
distance x is tensor(197.6596, device='cuda:3')
cal_distance is  tensor(197.6596, device='cuda:3')
distance x is tensor(197.6596, device='cuda:3')
return_distance is  tensor(197.6596, device='cuda:3')
distance x is tensor(197.6593, device='cuda:3')
distance x is tensor(197.6593, device='cuda:3')
________________________________
test distance is  tensor(197.6593, device='cuda:3')
test distance1 is  tensor(197.6593, device='cuda:3')
test similarity is  tensor(0.9350, device='cuda:3')
test acc is  0.16068333348966737
test loss is 2.610781380362602
test entropy is  1.5782074303006821
________________________________
0
distance x is tensor(197.6593, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.5794564391504218
avg test loss is  2.611182679245467
avg accuracy is  0.14205000015633243
solo acc is  0.16048333348966734
compute similarity  is  tensor(0.9350, device='cuda:3')
compute_distance is  tensor(197.6593, device='cuda:3')
compute_norm is  tensor(53.3909, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(196.9535, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7026537446452102
avg test loss is  2.7565842462755215
avg accuracy is  0.13403333348966523
solo acc is  0.10671666682299862
compute similarity  is  tensor(0.9354, device='cuda:3')
compute_distance is  tensor(196.9535, device='cuda:3')
compute_norm is  tensor(53.1959, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(198.4536, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0090913984821295
avg test loss is  1.5856612237023393
avg accuracy is  0.1915500001563359
solo acc is  0.2543000001563384
compute similarity  is  tensor(0.9355, device='cuda:3')
compute_distance is  tensor(198.4536, device='cuda:3')
compute_norm is  tensor(52.8869, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(198.2775, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6270541513461803
avg test loss is  2.41370436466579
avg accuracy is  0.14148333348966574
solo acc is  0.10836666682299861
compute similarity  is  tensor(0.9353, device='cuda:3')
compute_distance is  tensor(198.2775, device='cuda:3')
compute_norm is  tensor(52.6948, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(200.1261, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9508773650187673
avg test loss is  1.4599039925695227
avg accuracy is  0.20395000015633652
solo acc is  0.27481666682300565
compute similarity  is  tensor(0.9350, device='cuda:3')
compute_distance is  tensor(200.1261, device='cuda:3')
compute_norm is  tensor(52.3842, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(200.1261, device='cuda:3')
distance x is tensor(200.1261, device='cuda:3')
________________________________
test distance is  tensor(200.1261, device='cuda:3')
test distance1 is  tensor(200.1261, device='cuda:3')
test similarity is  tensor(0.9350, device='cuda:3')
test acc is  0.2756166668230056
test loss is 1.4610087088684538
test entropy is  0.9505667596229358
________________________________
cal ratio is  0.9758450105236115
distance x is tensor(195.2903, device='cuda:3')
cal_distance is  tensor(195.2903, device='cuda:3')
distance x is tensor(195.2903, device='cuda:3')
return_distance is  tensor(195.2903, device='cuda:3')
distance x is tensor(195.2921, device='cuda:3')
distance x is tensor(195.2921, device='cuda:3')
________________________________
test distance is  tensor(195.2921, device='cuda:3')
test distance1 is  tensor(195.2921, device='cuda:3')
test similarity is  tensor(0.9378, device='cuda:3')
test acc is  0.277150000156339
test loss is 1.4515308922033574
test entropy is  0.968045623571888
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.5500000005000001
mal loss is 0.8950234651565552
mal norm is  tensor(806.0604, device='cuda:3')
distance x is tensor(195.2903, device='cuda:3')
mal distance is  tensor(195.2903, device='cuda:3')
user_PLR len size 52
counter_tensor is  tensor([12.,  0.,  0.,  0., 12., 34., 12., 12., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 50., 51.,  0., 13., 12., 49., 49., 28.,
        51.,  0., 51., 12., 14., 51., 12.,  5., 38., 12., 25., 47., 12., 45.,
        51., 51.,  0., 12., 51., 12.,  0., 12., 50.,  0.])
count_res tensor([1.4386e-18, 8.8390e-24, 8.8390e-24, 8.8390e-24, 1.4386e-18, 5.1572e-09,
        1.4386e-18, 1.4386e-18, 2.0806e-06, 2.0806e-06, 2.0806e-06, 2.0806e-06,
        2.0806e-06, 2.0806e-06, 2.0806e-06, 2.0806e-06, 2.0806e-06, 2.0806e-06,
        2.0806e-06, 2.0806e-06, 4.5828e-02, 1.2457e-01, 8.8390e-24, 3.9105e-18,
        1.4386e-18, 1.6859e-02, 1.6859e-02, 1.2784e-11, 1.2457e-01, 8.8390e-24,
        1.2457e-01, 1.4386e-18, 1.0630e-17, 1.2457e-01, 1.4386e-18, 1.3118e-21,
        2.8158e-07, 1.4386e-18, 6.3645e-13, 2.2816e-03, 1.4386e-18, 3.0879e-04,
        1.2457e-01, 1.2457e-01, 8.8390e-24, 1.4386e-18, 1.2457e-01, 1.4386e-18,
        8.8390e-24, 1.4386e-18, 4.5828e-02, 8.8390e-24])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 90.02% 

Test Accuracy: 89.18% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3346775472164154
distance x is tensor(116.0094, device='cuda:3')
benign distance is  tensor(116.0094, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5322370529174805
distance x is tensor(118.5994, device='cuda:3')
benign distance is  tensor(118.5994, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.01402717549353838
distance x is tensor(122.7041, device='cuda:3')
benign distance is  tensor(122.7041, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.8880268335342407
distance x is tensor(111.9126, device='cuda:3')
benign distance is  tensor(111.9126, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.46026602387428284
distance x is tensor(114.6210, device='cuda:3')
benign distance is  tensor(114.6210, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.442457914352417
distance x is tensor(128.7259, device='cuda:3')
benign distance is  tensor(128.7259, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.11920689046382904
distance x is tensor(117.4707, device='cuda:3')
benign distance is  tensor(117.4707, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.41880497336387634
distance x is tensor(119.8499, device='cuda:3')
benign distance is  tensor(119.8499, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.10805225372314453
distance x is tensor(122.5053, device='cuda:3')
benign distance is  tensor(122.5053, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5639491081237793
distance x is tensor(109.4958, device='cuda:3')
benign distance is  tensor(109.4958, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.23047074675559998
distance x is tensor(105.9478, device='cuda:3')
benign distance is  tensor(105.9478, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5653322339057922
distance x is tensor(105.1305, device='cuda:3')
benign distance is  tensor(105.1305, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.6675524711608887
distance x is tensor(129.5532, device='cuda:3')
benign distance is  tensor(129.5532, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.4762924611568451
distance x is tensor(120.7345, device='cuda:3')
benign distance is  tensor(120.7345, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5315364599227905
distance x is tensor(129.2148, device='cuda:3')
benign distance is  tensor(129.2148, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.689763069152832
distance x is tensor(124.8702, device='cuda:3')
benign distance is  tensor(124.8702, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.2854401469230652
distance x is tensor(126.1396, device='cuda:3')
benign distance is  tensor(126.1396, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7264025211334229
distance x is tensor(143.1457, device='cuda:3')
benign distance is  tensor(143.1457, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.25573983788490295
distance x is tensor(125.2622, device='cuda:3')
benign distance is  tensor(125.2622, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.21433663368225098
distance x is tensor(121.2130, device='cuda:3')
benign distance is  tensor(121.2130, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.5688971281051636
distance x is tensor(115.9778, device='cuda:3')
benign distance is  tensor(115.9778, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5942641496658325
distance x is tensor(114.7422, device='cuda:3')
benign distance is  tensor(114.7422, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.3350886106491089
distance x is tensor(124.5847, device='cuda:3')
benign distance is  tensor(124.5847, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.31153634190559387
distance x is tensor(108.6456, device='cuda:3')
benign distance is  tensor(108.6456, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.2692645788192749
distance x is tensor(123.8506, device='cuda:3')
benign distance is  tensor(123.8506, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.0383945032954216
distance x is tensor(124.4831, device='cuda:3')
benign distance is  tensor(124.4831, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.3250344395637512
distance x is tensor(123.2450, device='cuda:3')
benign distance is  tensor(123.2450, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.1262865513563156
distance x is tensor(127.4054, device='cuda:3')
benign distance is  tensor(127.4054, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.25836053490638733
distance x is tensor(112.8501, device='cuda:3')
benign distance is  tensor(112.8501, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.5898949503898621
distance x is tensor(111.0659, device='cuda:3')
benign distance is  tensor(111.0659, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.3261398673057556
distance x is tensor(130.8178, device='cuda:3')
benign distance is  tensor(130.8178, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.1194882020354271
distance x is tensor(131.6945, device='cuda:3')
benign distance is  tensor(131.6945, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.06470916420221329
distance x is tensor(120.6920, device='cuda:3')
benign distance is  tensor(120.6920, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.4229908883571625
distance x is tensor(113.5131, device='cuda:3')
benign distance is  tensor(113.5131, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.07077552378177643
distance x is tensor(122.7996, device='cuda:3')
benign distance is  tensor(122.7996, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.5837310552597046
distance x is tensor(120.1661, device='cuda:3')
benign distance is  tensor(120.1661, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.39162617921829224
distance x is tensor(122.6982, device='cuda:3')
benign distance is  tensor(122.6982, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.6111348271369934
distance x is tensor(132.5109, device='cuda:3')
benign distance is  tensor(132.5109, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.5928750038146973
distance x is tensor(119.8013, device='cuda:3')
benign distance is  tensor(119.8013, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.2249385416507721
distance x is tensor(119.5346, device='cuda:3')
benign distance is  tensor(119.5346, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(122.0456, device='cuda:3')
compute distance is  tensor(122.0456, device='cuda:3')
compute norm is  tensor(51.7063, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.5387, device='cuda:3')
compute distance is  tensor(120.5387, device='cuda:3')
compute norm is  tensor(51.7087, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.8250, device='cuda:3')
compute distance is  tensor(133.8250, device='cuda:3')
compute norm is  tensor(52.0670, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.8387, device='cuda:3')
compute distance is  tensor(125.8387, device='cuda:3')
compute norm is  tensor(51.7714, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.4102, device='cuda:3')
compute distance is  tensor(120.4102, device='cuda:3')
compute norm is  tensor(51.7154, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.3139, device='cuda:3')
compute distance is  tensor(125.3139, device='cuda:3')
compute norm is  tensor(51.9595, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.5527, device='cuda:3')
compute distance is  tensor(123.5527, device='cuda:3')
compute norm is  tensor(51.8365, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.6742, device='cuda:3')
compute distance is  tensor(124.6742, device='cuda:3')
compute norm is  tensor(51.8728, device='cuda:3', dtype=torch.float64)
distance x is tensor(121.0055, device='cuda:3')
compute distance is  tensor(121.0055, device='cuda:3')
compute norm is  tensor(51.7740, device='cuda:3', dtype=torch.float64)
distance x is tensor(117.2135, device='cuda:3')
compute distance is  tensor(117.2135, device='cuda:3')
compute norm is  tensor(51.8025, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.2711, device='cuda:3')
compute distance is  tensor(125.2711, device='cuda:3')
compute norm is  tensor(51.8033, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.8745, device='cuda:3')
compute distance is  tensor(126.8745, device='cuda:3')
compute norm is  tensor(51.9151, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(133.8250, device='cuda:3')
distance x is tensor(107744.6641, device='cuda:3')
distance x is tensor(107744.6641, device='cuda:3')
________________________________
test distance is  tensor(107744.6641, device='cuda:3')
test distance1 is  tensor(107744.6641, device='cuda:3')
test similarity is  tensor(-0.1080, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130006283122639.97
test entropy is  0.0
________________________________
cal ratio is  0.03453797346476953
distance x is tensor(3721.2886, device='cuda:3')
cal_distance is  tensor(3721.2886, device='cuda:3')
cal ratio is  0.18584379463185643
distance x is tensor(691.5826, device='cuda:3')
cal_distance is  tensor(691.5826, device='cuda:3')
cal ratio is  0.43109472722644104
distance x is tensor(298.1406, device='cuda:3')
cal_distance is  tensor(298.1406, device='cuda:3')
cal ratio is  0.6565747704192252
distance x is tensor(195.7534, device='cuda:3')
cal_distance is  tensor(195.7534, device='cuda:3')
cal ratio is  0.8102893156066339
distance x is tensor(158.6179, device='cuda:3')
cal_distance is  tensor(158.6179, device='cuda:3')
cal ratio is  0.9001578145343816
distance x is tensor(142.7817, device='cuda:3')
cal_distance is  tensor(142.7817, device='cuda:3')
cal ratio is  0.9487646903784176
distance x is tensor(135.4665, device='cuda:3')
cal_distance is  tensor(135.4665, device='cuda:3')
cal ratio is  0.9740445606242929
distance x is tensor(131.9505, device='cuda:3')
cal_distance is  tensor(131.9505, device='cuda:3')
distance x is tensor(131.9505, device='cuda:3')
return_distance is  tensor(131.9505, device='cuda:3')
distance x is tensor(131.9401, device='cuda:3')
distance x is tensor(131.9401, device='cuda:3')
________________________________
test distance is  tensor(131.9401, device='cuda:3')
test distance1 is  tensor(131.9401, device='cuda:3')
test similarity is  tensor(0.9557, device='cuda:3')
test acc is  0.1007333334896653
test loss is 256.3261695650341
test entropy is  0.00018752114654074423
________________________________
0
distance x is tensor(131.9401, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00013248361352149326
avg test loss is  256.0387440500483
avg accuracy is  0.45333333348967497
solo acc is  0.10068333348966531
compute similarity  is  tensor(0.9557, device='cuda:3')
compute_distance is  tensor(131.9401, device='cuda:3')
compute_norm is  tensor(50.6541, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(115.3430, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9137023136432745
avg test loss is  1.4955207699143303
avg accuracy is  0.8289833334896575
solo acc is  0.34440000015634037
compute similarity  is  tensor(0.9608, device='cuda:3')
compute_distance is  tensor(115.3430, device='cuda:3')
compute_norm is  tensor(49.3951, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(118.0750, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8585302702018193
avg test loss is  1.5972826691832878
avg accuracy is  0.8292166668229908
solo acc is  0.275150000156339
compute similarity  is  tensor(0.9602, device='cuda:3')
compute_distance is  tensor(118.0750, device='cuda:3')
compute_norm is  tensor(49.0460, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(120.5097, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8719932410889851
avg test loss is  1.5241690232301317
avg accuracy is  0.8320833334896572
solo acc is  0.2739333334896722
compute similarity  is  tensor(0.9598, device='cuda:3')
compute_distance is  tensor(120.5097, device='cuda:3')
compute_norm is  tensor(48.7344, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(122.8703, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.865300645896875
avg test loss is  1.4742792072072466
avg accuracy is  0.8354166668229905
solo acc is  0.2792833334896724
compute similarity  is  tensor(0.9595, device='cuda:3')
compute_distance is  tensor(122.8703, device='cuda:3')
compute_norm is  tensor(48.4448, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(125.2274, device='cuda:3')
distance x is tensor(125.2274, device='cuda:3')
________________________________
test distance is  tensor(125.2274, device='cuda:3')
test distance1 is  tensor(125.2274, device='cuda:3')
test similarity is  tensor(0.9591, device='cuda:3')
test acc is  0.2691166668230055
test loss is 1.4704261137478387
test entropy is  0.8433135411759684
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.4065183401107788
mal norm is  tensor(638.0743, device='cuda:3')
distance x is tensor(125.2347, device='cuda:3')
mal distance is  tensor(125.2347, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 17.55% 

Test Accuracy: 17.09% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5329842567443848
distance x is tensor(164.6983, device='cuda:3')
benign distance is  tensor(164.6983, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7069641351699829
distance x is tensor(179.2962, device='cuda:3')
benign distance is  tensor(179.2962, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2454930543899536
distance x is tensor(162.4751, device='cuda:3')
benign distance is  tensor(162.4751, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9043945074081421
distance x is tensor(154.7346, device='cuda:3')
benign distance is  tensor(154.7346, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2883230447769165
distance x is tensor(171.8675, device='cuda:3')
benign distance is  tensor(171.8675, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6016293168067932
distance x is tensor(170.2036, device='cuda:3')
benign distance is  tensor(170.2036, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.39167195558547974
distance x is tensor(175.9440, device='cuda:3')
benign distance is  tensor(175.9440, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3734373450279236
distance x is tensor(166.7313, device='cuda:3')
benign distance is  tensor(166.7313, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(169.4009, device='cuda:3')
compute distance is  tensor(169.4009, device='cuda:3')
compute norm is  tensor(50.2415, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.0959, device='cuda:3')
compute distance is  tensor(167.0959, device='cuda:3')
compute norm is  tensor(50.2943, device='cuda:3', dtype=torch.float64)
distance x is tensor(179.7235, device='cuda:3')
compute distance is  tensor(179.7235, device='cuda:3')
compute norm is  tensor(50.6803, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.6368, device='cuda:3')
compute distance is  tensor(170.6368, device='cuda:3')
compute norm is  tensor(50.3124, device='cuda:3', dtype=torch.float64)
distance x is tensor(173.9042, device='cuda:3')
compute distance is  tensor(173.9042, device='cuda:3')
compute norm is  tensor(50.4469, device='cuda:3', dtype=torch.float64)
distance x is tensor(169.8877, device='cuda:3')
compute distance is  tensor(169.8877, device='cuda:3')
compute norm is  tensor(50.4007, device='cuda:3', dtype=torch.float64)
distance x is tensor(159.1428, device='cuda:3')
compute distance is  tensor(159.1428, device='cuda:3')
compute norm is  tensor(50.1857, device='cuda:3', dtype=torch.float64)
distance x is tensor(172.5107, device='cuda:3')
compute distance is  tensor(172.5107, device='cuda:3')
compute norm is  tensor(50.3828, device='cuda:3', dtype=torch.float64)
distance x is tensor(182.8684, device='cuda:3')
compute distance is  tensor(182.8684, device='cuda:3')
compute norm is  tensor(50.5405, device='cuda:3', dtype=torch.float64)
distance x is tensor(174.7603, device='cuda:3')
compute distance is  tensor(174.7603, device='cuda:3')
compute norm is  tensor(50.4493, device='cuda:3', dtype=torch.float64)
distance x is tensor(168.3042, device='cuda:3')
compute distance is  tensor(168.3042, device='cuda:3')
compute norm is  tensor(50.4450, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.4970, device='cuda:3')
compute distance is  tensor(170.4970, device='cuda:3')
compute norm is  tensor(50.2519, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(182.8684, device='cuda:3')
distance x is tensor(107673.4688, device='cuda:3')
distance x is tensor(107673.4688, device='cuda:3')
________________________________
test distance is  tensor(107673.4688, device='cuda:3')
test distance1 is  tensor(107673.4688, device='cuda:3')
test similarity is  tensor(0.1369, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130151220087600.58
test entropy is  0.0
________________________________
cal ratio is  0.04038694536791856
distance x is tensor(4348.6079, device='cuda:3')
cal_distance is  tensor(4348.6079, device='cuda:3')
cal ratio is  0.20096491080522924
distance x is tensor(873.9217, device='cuda:3')
cal_distance is  tensor(873.9217, device='cuda:3')
cal ratio is  0.4482900566453963
distance x is tensor(391.7733, device='cuda:3')
cal_distance is  tensor(391.7733, device='cuda:3')
cal ratio is  0.6695422019819459
distance x is tensor(262.3105, device='cuda:3')
cal_distance is  tensor(262.3105, device='cuda:3')
cal ratio is  0.8182529039410076
distance x is tensor(214.6373, device='cuda:3')
cal_distance is  tensor(214.6373, device='cuda:3')
cal ratio is  0.9045712356308985
distance x is tensor(194.1552, device='cuda:3')
cal_distance is  tensor(194.1552, device='cuda:3')
cal ratio is  0.9510882958258445
distance x is tensor(184.6590, device='cuda:3')
cal_distance is  tensor(184.6590, device='cuda:3')
cal ratio is  0.9752368556899235
distance x is tensor(180.0864, device='cuda:3')
cal_distance is  tensor(180.0864, device='cuda:3')
distance x is tensor(180.0864, device='cuda:3')
return_distance is  tensor(180.0864, device='cuda:3')
distance x is tensor(180.0760, device='cuda:3')
distance x is tensor(180.0760, device='cuda:3')
________________________________
test distance is  tensor(180.0760, device='cuda:3')
test distance1 is  tensor(180.0760, device='cuda:3')
test similarity is  tensor(0.9289, device='cuda:3')
test acc is  0.10000000015633198
test loss is 1414.9916531495703
test entropy is  0.0
________________________________
0
distance x is tensor(180.0760, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  1415.1417846679688
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9289, device='cuda:3')
compute_distance is  tensor(180.0760, device='cuda:3')
compute_norm is  tensor(52.1052, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(925.8759, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.6127663315740475
avg test loss is  2.8671592301143005
avg accuracy is  0.10003333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4858, device='cuda:3')
compute_distance is  tensor(925.8759, device='cuda:3')
compute_norm is  tensor(99.4171, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(922.1654, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8529769708352811
avg test loss is  3.682905845550586
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4860, device='cuda:3')
compute_distance is  tensor(922.1654, device='cuda:3')
compute_norm is  tensor(99.2182, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(918.2175, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.568190026384935
avg test loss is  2.8589777440658763
avg accuracy is  0.10005000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4857, device='cuda:3')
compute_distance is  tensor(918.2175, device='cuda:3')
compute_norm is  tensor(98.5242, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(914.5493, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8394029676787126
avg test loss is  3.6397403460830007
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4859, device='cuda:3')
compute_distance is  tensor(914.5493, device='cuda:3')
compute_norm is  tensor(98.3195, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(910.5529, device='cuda:3')
distance x is tensor(910.5529, device='cuda:3')
________________________________
test distance is  tensor(910.5529, device='cuda:3')
test distance1 is  tensor(910.5529, device='cuda:3')
test similarity is  tensor(0.4856, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8593787567447753
test entropy is  1.560599650655474
________________________________
cal ratio is  0.4391802159724983
distance x is tensor(399.8982, device='cuda:3')
cal_distance is  tensor(399.8982, device='cuda:3')
cal ratio is  0.6627055732164304
distance x is tensor(265.0152, device='cuda:3')
cal_distance is  tensor(265.0152, device='cuda:3')
cal ratio is  0.8140667170819902
distance x is tensor(215.7402, device='cuda:3')
cal_distance is  tensor(215.7402, device='cuda:3')
cal ratio is  0.9022560890850565
distance x is tensor(194.6530, device='cuda:3')
cal_distance is  tensor(194.6530, device='cuda:3')
cal ratio is  0.9498714447251129
distance x is tensor(184.8954, device='cuda:3')
cal_distance is  tensor(184.8954, device='cuda:3')
cal ratio is  0.9746133733327186
distance x is tensor(180.2015, device='cuda:3')
cal_distance is  tensor(180.2015, device='cuda:3')
distance x is tensor(180.2015, device='cuda:3')
return_distance is  tensor(180.2015, device='cuda:3')
distance x is tensor(180.1996, device='cuda:3')
distance x is tensor(180.1996, device='cuda:3')
________________________________
test distance is  tensor(180.1996, device='cuda:3')
test distance1 is  tensor(180.1996, device='cuda:3')
test similarity is  tensor(0.9353, device='cuda:3')
test acc is  0.08248333348966536
test loss is 2.6706525514374917
test entropy is  1.9512004215580059
________________________________
0
distance x is tensor(180.1996, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.9511230272779079
avg test loss is  2.6706079704675085
avg accuracy is  0.12086666682299858
solo acc is  0.08226666682299871
compute similarity  is  tensor(0.9353, device='cuda:3')
compute_distance is  tensor(180.1996, device='cuda:3')
compute_norm is  tensor(52.9685, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(180.5504, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6886396469083677
avg test loss is  2.7317830057286505
avg accuracy is  0.10835000015633195
solo acc is  0.10726666682299862
compute similarity  is  tensor(0.9354, device='cuda:3')
compute_distance is  tensor(180.5504, device='cuda:3')
compute_norm is  tensor(52.7940, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(181.9463, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9659636534734576
avg test loss is  1.6135573051631578
avg accuracy is  0.12038333348966526
solo acc is  0.24273333348967135
compute similarity  is  tensor(0.9353, device='cuda:3')
compute_distance is  tensor(181.9463, device='cuda:3')
compute_norm is  tensor(52.5003, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(181.9463, device='cuda:3')
distance x is tensor(181.9463, device='cuda:3')
________________________________
test distance is  tensor(181.9463, device='cuda:3')
test distance1 is  tensor(181.9463, device='cuda:3')
test similarity is  tensor(0.9353, device='cuda:3')
test acc is  0.24305000015633801
test loss is 1.609734996803788
test entropy is  0.9689402540863704
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.4977467060089111
mal norm is  tensor(825.0276, device='cuda:3')
distance x is tensor(181.9471, device='cuda:3')
mal distance is  tensor(181.9471, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([ 3., 13., 13., 24., 12.,  1., 13.,  1., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 34., 24., 27., 32., 12., 12., 29., 35.,
        12., 34., 15., 13., 12., 14., 31.,  0.])
count_res tensor([7.0087e-15, 1.5438e-10, 1.5438e-10, 9.2432e-06, 5.6792e-11, 9.4853e-16,
        1.5438e-10, 9.4853e-16, 9.2432e-06, 9.2432e-06, 9.2432e-06, 9.2432e-06,
        9.2432e-06, 9.2432e-06, 9.2432e-06, 9.2432e-06, 9.2432e-06, 9.2432e-06,
        9.2432e-06, 9.2432e-06, 2.0360e-01, 9.2432e-06, 1.8566e-04, 2.7554e-02,
        5.6792e-11, 5.6792e-11, 1.3718e-03, 5.5343e-01, 5.6792e-11, 2.0360e-01,
        1.1407e-09, 1.5438e-10, 5.6792e-11, 4.1964e-10, 1.0136e-02, 3.4894e-16])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 89.58% 

Test Accuracy: 88.67% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.26355838775634766
distance x is tensor(140.8439, device='cuda:3')
benign distance is  tensor(140.8439, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6474548578262329
distance x is tensor(109.3950, device='cuda:3')
benign distance is  tensor(109.3950, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.11088450253009796
distance x is tensor(129.0836, device='cuda:3')
benign distance is  tensor(129.0836, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.36709684133529663
distance x is tensor(107.3685, device='cuda:3')
benign distance is  tensor(107.3685, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.660176157951355
distance x is tensor(131.8805, device='cuda:3')
benign distance is  tensor(131.8805, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.31003567576408386
distance x is tensor(141.3415, device='cuda:3')
benign distance is  tensor(141.3415, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4492173194885254
distance x is tensor(125.6191, device='cuda:3')
benign distance is  tensor(125.6191, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.2694556713104248
distance x is tensor(133.2980, device='cuda:3')
benign distance is  tensor(133.2980, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.48836368322372437
distance x is tensor(148.3899, device='cuda:3')
benign distance is  tensor(148.3899, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8872703313827515
distance x is tensor(119.1396, device='cuda:3')
benign distance is  tensor(119.1396, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.20820081233978271
distance x is tensor(113.2730, device='cuda:3')
benign distance is  tensor(113.2730, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4696659445762634
distance x is tensor(129.1425, device='cuda:3')
benign distance is  tensor(129.1425, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.30830663442611694
distance x is tensor(123.8151, device='cuda:3')
benign distance is  tensor(123.8151, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.486581951379776
distance x is tensor(129.6239, device='cuda:3')
benign distance is  tensor(129.6239, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.724819540977478
distance x is tensor(133.1287, device='cuda:3')
benign distance is  tensor(133.1287, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.465085506439209
distance x is tensor(142.2958, device='cuda:3')
benign distance is  tensor(142.2958, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.34005552530288696
distance x is tensor(133.1720, device='cuda:3')
benign distance is  tensor(133.1720, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6632086038589478
distance x is tensor(135.5709, device='cuda:3')
benign distance is  tensor(135.5709, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.7529674172401428
distance x is tensor(129.7645, device='cuda:3')
benign distance is  tensor(129.7645, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.266042023897171
distance x is tensor(153.5459, device='cuda:3')
benign distance is  tensor(153.5459, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.600010097026825
distance x is tensor(131.6054, device='cuda:3')
benign distance is  tensor(131.6054, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.2093062400817871
distance x is tensor(138.1451, device='cuda:3')
benign distance is  tensor(138.1451, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.44047561287879944
distance x is tensor(140.0003, device='cuda:3')
benign distance is  tensor(140.0003, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.02649867907166481
distance x is tensor(107.0733, device='cuda:3')
benign distance is  tensor(107.0733, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(130.2234, device='cuda:3')
compute distance is  tensor(130.2234, device='cuda:3')
compute norm is  tensor(52.5146, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.6547, device='cuda:3')
compute distance is  tensor(131.6547, device='cuda:3')
compute norm is  tensor(52.7860, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.1201, device='cuda:3')
compute distance is  tensor(141.1201, device='cuda:3')
compute norm is  tensor(53.1134, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.4532, device='cuda:3')
compute distance is  tensor(124.4532, device='cuda:3')
compute norm is  tensor(52.6200, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.2475, device='cuda:3')
compute distance is  tensor(141.2475, device='cuda:3')
compute norm is  tensor(52.9695, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.2774, device='cuda:3')
compute distance is  tensor(125.2774, device='cuda:3')
compute norm is  tensor(52.7563, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.9553, device='cuda:3')
compute distance is  tensor(127.9553, device='cuda:3')
compute norm is  tensor(52.7435, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.8655, device='cuda:3')
compute distance is  tensor(140.8655, device='cuda:3')
compute norm is  tensor(52.8257, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.0403, device='cuda:3')
compute distance is  tensor(146.0403, device='cuda:3')
compute norm is  tensor(53.0796, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.8716, device='cuda:3')
compute distance is  tensor(132.8716, device='cuda:3')
compute norm is  tensor(52.8336, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.6705, device='cuda:3')
compute distance is  tensor(131.6705, device='cuda:3')
compute norm is  tensor(52.8533, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.4391, device='cuda:3')
compute distance is  tensor(126.4391, device='cuda:3')
compute norm is  tensor(52.7610, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(146.0403, device='cuda:3')
distance x is tensor(107747.3516, device='cuda:3')
distance x is tensor(107747.3516, device='cuda:3')
________________________________
test distance is  tensor(107747.3516, device='cuda:3')
test distance1 is  tensor(107747.3516, device='cuda:3')
test similarity is  tensor(-0.1034, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130058383309206.11
test entropy is  0.0
________________________________
cal ratio is  0.036079386030333574
distance x is tensor(3887.4639, device='cuda:3')
cal_distance is  tensor(3887.4639, device='cuda:3')
cal ratio is  0.18994560614014697
distance x is tensor(738.4108, device='cuda:3')
cal_distance is  tensor(738.4108, device='cuda:3')
cal ratio is  0.43582626451539613
distance x is tensor(321.8218, device='cuda:3')
cal_distance is  tensor(321.8218, device='cuda:3')
cal ratio is  0.6601683444839517
distance x is tensor(212.4583, device='cuda:3')
cal_distance is  tensor(212.4583, device='cuda:3')
cal ratio is  0.8125040667065303
distance x is tensor(172.6242, device='cuda:3')
cal_distance is  tensor(172.6242, device='cuda:3')
cal ratio is  0.9013875430436186
distance x is tensor(155.6019, device='cuda:3')
cal_distance is  tensor(155.6019, device='cuda:3')
cal ratio is  0.9494126244749703
distance x is tensor(147.7307, device='cuda:3')
cal_distance is  tensor(147.7307, device='cuda:3')
cal ratio is  0.9743771109396021
distance x is tensor(143.9455, device='cuda:3')
cal_distance is  tensor(143.9455, device='cuda:3')
distance x is tensor(143.9455, device='cuda:3')
return_distance is  tensor(143.9455, device='cuda:3')
distance x is tensor(143.9351, device='cuda:3')
distance x is tensor(143.9351, device='cuda:3')
________________________________
test distance is  tensor(143.9351, device='cuda:3')
test distance1 is  tensor(143.9351, device='cuda:3')
test similarity is  tensor(0.9497, device='cuda:3')
test acc is  0.10028333348966531
test loss is 373.2914496708526
test entropy is  7.219254071728355e-05
________________________________
0
distance x is tensor(143.9351, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  5.4233118012797675e-05
avg test loss is  373.855721252051
avg accuracy is  0.3202166668230065
solo acc is  0.1002333334896653
compute similarity  is  tensor(0.9497, device='cuda:3')
compute_distance is  tensor(143.9351, device='cuda:3')
compute_norm is  tensor(51.7379, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(124.1439, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9370302238316932
avg test loss is  1.5502270188158764
avg accuracy is  0.8098166668229917
solo acc is  0.3337833334896735
compute similarity  is  tensor(0.9560, device='cuda:3')
compute_distance is  tensor(124.1439, device='cuda:3')
compute_norm is  tensor(50.4784, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(126.9713, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9011781707501361
avg test loss is  1.5774777615502444
avg accuracy is  0.8119666668229915
solo acc is  0.28638333348967254
compute similarity  is  tensor(0.9554, device='cuda:3')
compute_distance is  tensor(126.9713, device='cuda:3')
compute_norm is  tensor(50.1315, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(129.4896, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8428703230072949
avg test loss is  1.6199230129784867
avg accuracy is  0.8172166668229913
solo acc is  0.26060000015633855
compute similarity  is  tensor(0.9550, device='cuda:3')
compute_distance is  tensor(129.4896, device='cuda:3')
compute_norm is  tensor(49.8181, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(131.8977, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8375984758837645
avg test loss is  1.5729570717953925
avg accuracy is  0.8207166668229913
solo acc is  0.2591333334896718
compute similarity  is  tensor(0.9546, device='cuda:3')
compute_distance is  tensor(131.8977, device='cuda:3')
compute_norm is  tensor(49.5222, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.2420, device='cuda:3')
distance x is tensor(134.2420, device='cuda:3')
________________________________
test distance is  tensor(134.2420, device='cuda:3')
test distance1 is  tensor(134.2420, device='cuda:3')
test similarity is  tensor(0.9542, device='cuda:3')
test acc is  0.27226666682300554
test loss is 1.4831646126724765
test entropy is  0.8641422810966272
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.3465697765350342
mal norm is  tensor(688.5859, device='cuda:3')
distance x is tensor(134.2495, device='cuda:3')
mal distance is  tensor(134.2495, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([12., 12., 12., 12., 27., 13., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 24., 12., 12., 12., 12., 27., 17., 13.])
count_res tensor([1.4922e-07, 1.4922e-07, 1.4922e-07, 1.4922e-07, 4.8780e-01, 4.0562e-07,
        1.4922e-07, 1.4922e-07, 8.1470e-06, 8.1470e-06, 8.1470e-06, 8.1470e-06,
        8.1470e-06, 8.1470e-06, 8.1470e-06, 8.1470e-06, 8.1470e-06, 8.1470e-06,
        8.1470e-06, 8.1470e-06, 2.4286e-02, 1.4922e-07, 1.4922e-07, 1.4922e-07,
        1.4922e-07, 4.8780e-01, 2.2146e-05, 4.0562e-07])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 89.68% 

Test Accuracy: 88.97% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.34154292941093445
distance x is tensor(127.8831, device='cuda:3')
benign distance is  tensor(127.8831, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.236330270767212
distance x is tensor(115.4902, device='cuda:3')
benign distance is  tensor(115.4902, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.18266561627388
distance x is tensor(134.6498, device='cuda:3')
benign distance is  tensor(134.6498, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5093180537223816
distance x is tensor(135.3795, device='cuda:3')
benign distance is  tensor(135.3795, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6274925470352173
distance x is tensor(85.4474, device='cuda:3')
benign distance is  tensor(85.4474, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6043962836265564
distance x is tensor(148.9690, device='cuda:3')
benign distance is  tensor(148.9690, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2496579885482788
distance x is tensor(124.4620, device='cuda:3')
benign distance is  tensor(124.4620, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4274898171424866
distance x is tensor(127.0945, device='cuda:3')
benign distance is  tensor(127.0945, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.4363153874874115
distance x is tensor(129.6436, device='cuda:3')
benign distance is  tensor(129.6436, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6077649593353271
distance x is tensor(141.7466, device='cuda:3')
benign distance is  tensor(141.7466, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.34740155935287476
distance x is tensor(141.8241, device='cuda:3')
benign distance is  tensor(141.8241, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.49476179480552673
distance x is tensor(121.7339, device='cuda:3')
benign distance is  tensor(121.7339, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.48340803384780884
distance x is tensor(113.7049, device='cuda:3')
benign distance is  tensor(113.7049, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6821189522743225
distance x is tensor(97.3925, device='cuda:3')
benign distance is  tensor(97.3925, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.1877889484167099
distance x is tensor(145.8675, device='cuda:3')
benign distance is  tensor(145.8675, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.4467049539089203
distance x is tensor(131.6954, device='cuda:3')
benign distance is  tensor(131.6954, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(140.4254, device='cuda:3')
compute distance is  tensor(140.4254, device='cuda:3')
compute norm is  tensor(52.9884, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.8332, device='cuda:3')
compute distance is  tensor(127.8332, device='cuda:3')
compute norm is  tensor(52.8429, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.5893, device='cuda:3')
compute distance is  tensor(133.5893, device='cuda:3')
compute norm is  tensor(53.0250, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.2077, device='cuda:3')
compute distance is  tensor(130.2077, device='cuda:3')
compute norm is  tensor(52.7665, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.2993, device='cuda:3')
compute distance is  tensor(142.2993, device='cuda:3')
compute norm is  tensor(53.0394, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.0998, device='cuda:3')
compute distance is  tensor(142.0998, device='cuda:3')
compute norm is  tensor(53.1202, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.2770, device='cuda:3')
compute distance is  tensor(135.2770, device='cuda:3')
compute norm is  tensor(52.9677, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.7056, device='cuda:3')
compute distance is  tensor(134.7056, device='cuda:3')
compute norm is  tensor(52.9382, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.5166, device='cuda:3')
compute distance is  tensor(146.5166, device='cuda:3')
compute norm is  tensor(53.1033, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.9155, device='cuda:3')
compute distance is  tensor(128.9155, device='cuda:3')
compute norm is  tensor(52.9557, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.7605, device='cuda:3')
compute distance is  tensor(135.7605, device='cuda:3')
compute norm is  tensor(53.0037, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.6713, device='cuda:3')
compute distance is  tensor(132.6713, device='cuda:3')
compute norm is  tensor(52.8941, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(146.5166, device='cuda:3')
distance x is tensor(107748.7422, device='cuda:3')
distance x is tensor(107748.7422, device='cuda:3')
________________________________
test distance is  tensor(107748.7422, device='cuda:3')
test distance1 is  tensor(107748.7422, device='cuda:3')
test similarity is  tensor(-0.1062, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130113610970948.23
test entropy is  0.0
________________________________
cal ratio is  0.03613793657673578
distance x is tensor(3893.8230, device='cuda:3')
cal_distance is  tensor(3893.8230, device='cuda:3')
cal ratio is  0.1900996672232834
distance x is tensor(740.2187, device='cuda:3')
cal_distance is  tensor(740.2187, device='cuda:3')
cal ratio is  0.43600295555765517
distance x is tensor(322.7404, device='cuda:3')
cal_distance is  tensor(322.7404, device='cuda:3')
cal ratio is  0.6603022137322292
distance x is tensor(213.1080, device='cuda:3')
cal_distance is  tensor(213.1080, device='cuda:3')
cal ratio is  0.8125864234590799
distance x is tensor(173.1697, device='cuda:3')
cal_distance is  tensor(173.1697, device='cuda:3')
cal ratio is  0.9014331398224834
distance x is tensor(156.1014, device='cuda:3')
cal_distance is  tensor(156.1014, device='cuda:3')
cal ratio is  0.9494368022368455
distance x is tensor(148.2087, device='cuda:3')
cal_distance is  tensor(148.2087, device='cuda:3')
cal ratio is  0.9743896245317704
distance x is tensor(144.4131, device='cuda:3')
cal_distance is  tensor(144.4131, device='cuda:3')
distance x is tensor(144.4131, device='cuda:3')
return_distance is  tensor(144.4131, device='cuda:3')
distance x is tensor(144.4027, device='cuda:3')
distance x is tensor(144.4027, device='cuda:3')
________________________________
test distance is  tensor(144.4027, device='cuda:3')
test distance1 is  tensor(144.4027, device='cuda:3')
test similarity is  tensor(0.9497, device='cuda:3')
test acc is  0.1002333334896653
test loss is 360.27229289561194
test entropy is  7.548161873425798e-05
________________________________
0
distance x is tensor(144.4027, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  7.211593008094544e-05
avg test loss is  360.20753696986606
avg accuracy is  0.37803333348967405
solo acc is  0.10025000015633198
compute similarity  is  tensor(0.9497, device='cuda:3')
compute_distance is  tensor(144.4027, device='cuda:3')
compute_norm is  tensor(51.8721, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(125.4966, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8944921980915802
avg test loss is  1.5816827155887954
avg accuracy is  0.8138666668229915
solo acc is  0.32450000015633995
compute similarity  is  tensor(0.9558, device='cuda:3')
compute_distance is  tensor(125.4966, device='cuda:3')
compute_norm is  tensor(50.6184, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(128.4588, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8923454291657853
avg test loss is  1.5968837133094447
avg accuracy is  0.814383333489658
solo acc is  0.27633333348967226
compute similarity  is  tensor(0.9553, device='cuda:3')
compute_distance is  tensor(128.4588, device='cuda:3')
compute_norm is  tensor(50.2632, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(130.9610, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8869079609415425
avg test loss is  1.5579513386368498
avg accuracy is  0.8188000001563246
solo acc is  0.26555000015633873
compute similarity  is  tensor(0.9549, device='cuda:3')
compute_distance is  tensor(130.9610, device='cuda:3')
compute_norm is  tensor(49.9445, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(133.3236, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8684161323219982
avg test loss is  1.518481297025294
avg accuracy is  0.8234833334896576
solo acc is  0.26963333348967217
compute similarity  is  tensor(0.9545, device='cuda:3')
compute_distance is  tensor(133.3236, device='cuda:3')
compute_norm is  tensor(49.6457, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(135.6120, device='cuda:3')
distance x is tensor(135.6120, device='cuda:3')
________________________________
test distance is  tensor(135.6120, device='cuda:3')
test distance1 is  tensor(135.6120, device='cuda:3')
test similarity is  tensor(0.9541, device='cuda:3')
test acc is  0.2710666668230055
test loss is 1.4668893083326344
test entropy is  0.8780407084584999
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.3060659170150757
mal norm is  tensor(691.8915, device='cuda:3')
distance x is tensor(135.6193, device='cuda:3')
mal distance is  tensor(135.6193, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([12., 27., 26., 15., 13., 18., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 12., 12., 22., 12., 12., 12.])
count_res tensor([2.2248e-07, 7.2730e-01, 2.6756e-01, 4.4687e-06, 6.0477e-07, 8.9756e-05,
        2.2248e-07, 2.2248e-07, 1.2147e-05, 1.2147e-05, 1.2147e-05, 1.2147e-05,
        1.2147e-05, 1.2147e-05, 1.2147e-05, 1.2147e-05, 1.2147e-05, 1.2147e-05,
        1.2147e-05, 1.2147e-05, 2.2248e-07, 2.2248e-07, 2.2248e-07, 2.2248e-07,
        4.9005e-03, 2.2248e-07, 2.2248e-07, 2.2248e-07])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 89.11% 

Test Accuracy: 88.15% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2139582633972168
distance x is tensor(131.2593, device='cuda:3')
benign distance is  tensor(131.2593, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2229046821594238
distance x is tensor(72.6526, device='cuda:3')
benign distance is  tensor(72.6526, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.09017547965049744
distance x is tensor(128.9291, device='cuda:3')
benign distance is  tensor(128.9291, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4609544277191162
distance x is tensor(128.4301, device='cuda:3')
benign distance is  tensor(128.4301, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8630043864250183
distance x is tensor(104.0865, device='cuda:3')
benign distance is  tensor(104.0865, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9097535014152527
distance x is tensor(140.9288, device='cuda:3')
benign distance is  tensor(140.9288, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0241435766220093
distance x is tensor(133.1673, device='cuda:3')
benign distance is  tensor(133.1673, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.20494318008422852
distance x is tensor(136.4955, device='cuda:3')
benign distance is  tensor(136.4955, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7565382719039917
distance x is tensor(150.6260, device='cuda:3')
benign distance is  tensor(150.6260, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7085296511650085
distance x is tensor(132.7275, device='cuda:3')
benign distance is  tensor(132.7275, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.597560703754425
distance x is tensor(134.1530, device='cuda:3')
benign distance is  tensor(134.1530, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6886627078056335
distance x is tensor(125.6669, device='cuda:3')
benign distance is  tensor(125.6669, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.24143624305725098
distance x is tensor(142.7571, device='cuda:3')
benign distance is  tensor(142.7571, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.30110564827919006
distance x is tensor(131.0702, device='cuda:3')
benign distance is  tensor(131.0702, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.4831586480140686
distance x is tensor(148.5115, device='cuda:3')
benign distance is  tensor(148.5115, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.46857428550720215
distance x is tensor(152.4641, device='cuda:3')
benign distance is  tensor(152.4641, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(138.2490, device='cuda:3')
compute distance is  tensor(138.2490, device='cuda:3')
compute norm is  tensor(53.5840, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.8875, device='cuda:3')
compute distance is  tensor(132.8875, device='cuda:3')
compute norm is  tensor(53.5835, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.9070, device='cuda:3')
compute distance is  tensor(153.9070, device='cuda:3')
compute norm is  tensor(54.0965, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.5566, device='cuda:3')
compute distance is  tensor(128.5566, device='cuda:3')
compute norm is  tensor(53.6362, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.0438, device='cuda:3')
compute distance is  tensor(149.0438, device='cuda:3')
compute norm is  tensor(53.9574, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.5843, device='cuda:3')
compute distance is  tensor(140.5843, device='cuda:3')
compute norm is  tensor(53.9842, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.9327, device='cuda:3')
compute distance is  tensor(139.9327, device='cuda:3')
compute norm is  tensor(53.7638, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.4901, device='cuda:3')
compute distance is  tensor(146.4901, device='cuda:3')
compute norm is  tensor(53.8689, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.3830, device='cuda:3')
compute distance is  tensor(138.3830, device='cuda:3')
compute norm is  tensor(53.8235, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.2711, device='cuda:3')
compute distance is  tensor(137.2711, device='cuda:3')
compute norm is  tensor(53.8499, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.5411, device='cuda:3')
compute distance is  tensor(140.5411, device='cuda:3')
compute norm is  tensor(53.8426, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.9933, device='cuda:3')
compute distance is  tensor(149.9933, device='cuda:3')
compute norm is  tensor(54.0873, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(153.9070, device='cuda:3')
distance x is tensor(107755.4844, device='cuda:3')
distance x is tensor(107755.4844, device='cuda:3')
________________________________
test distance is  tensor(107755.4844, device='cuda:3')
test distance1 is  tensor(107755.4844, device='cuda:3')
test similarity is  tensor(-0.1046, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130087604613792.48
test entropy is  0.0
________________________________
cal ratio is  0.037036984882096224
distance x is tensor(3990.9438, device='cuda:3')
cal_distance is  tensor(3990.9438, device='cuda:3')
cal ratio is  0.1924498216296435
distance x is tensor(768.0607, device='cuda:3')
cal_distance is  tensor(768.0607, device='cuda:3')
cal ratio is  0.438689817909153
distance x is tensor(336.9433, device='cuda:3')
cal_distance is  tensor(336.9433, device='cuda:3')
cal ratio is  0.6623337555167474
distance x is tensor(223.1707, device='cuda:3')
cal_distance is  tensor(223.1707, device='cuda:3')
cal ratio is  0.8138357569514361
distance x is tensor(181.6252, device='cuda:3')
cal_distance is  tensor(181.6252, device='cuda:3')
cal ratio is  0.9021260476795406
distance x is tensor(163.8494, device='cuda:3')
cal_distance is  tensor(163.8494, device='cuda:3')
cal ratio is  0.9498016850625836
distance x is tensor(155.6247, device='cuda:3')
cal_distance is  tensor(155.6247, device='cuda:3')
cal ratio is  0.9745768098638672
distance x is tensor(151.6684, device='cuda:3')
cal_distance is  tensor(151.6684, device='cuda:3')
distance x is tensor(151.6684, device='cuda:3')
return_distance is  tensor(151.6684, device='cuda:3')
distance x is tensor(151.6580, device='cuda:3')
distance x is tensor(151.6580, device='cuda:3')
________________________________
test distance is  tensor(151.6580, device='cuda:3')
test distance1 is  tensor(151.6580, device='cuda:3')
test similarity is  tensor(0.9468, device='cuda:3')
test acc is  0.10010000015633198
test loss is 440.1890009573019
test entropy is  1.8340271915332207e-05
________________________________
0
distance x is tensor(151.6580, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.4420918192282267e-06
avg test loss is  440.4573787209322
avg accuracy is  0.28813333348967257
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.9468, device='cuda:3')
compute_distance is  tensor(151.6580, device='cuda:3')
compute_norm is  tensor(52.8539, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(131.2120, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9298350739199469
avg test loss is  1.5837284785343895
avg accuracy is  0.7919166668229926
solo acc is  0.31986666682300663
compute similarity  is  tensor(0.9534, device='cuda:3')
compute_distance is  tensor(131.2120, device='cuda:3')
compute_norm is  tensor(51.5748, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(131.2120, device='cuda:3')
distance x is tensor(131.2120, device='cuda:3')
________________________________
test distance is  tensor(131.2120, device='cuda:3')
test distance1 is  tensor(131.2120, device='cuda:3')
test similarity is  tensor(0.9534, device='cuda:3')
test acc is  0.3162666668230065
test loss is 1.58708481836929
test entropy is  0.9276080937273721
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.364447832107544
mal norm is  tensor(716.7561, device='cuda:3')
distance x is tensor(131.2196, device='cuda:3')
mal distance is  tensor(131.2196, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([12., 27., 12., 15., 12., 12., 12., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12., 12., 12., 12., 27., 12., 12.])
count_res tensor([1.0196e-07, 3.3331e-01, 1.0196e-07, 2.0479e-06, 1.0196e-07, 1.0196e-07,
        1.0196e-07, 3.3331e-01, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06,
        5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06,
        5.5668e-06, 5.5668e-06, 1.0196e-07, 1.0196e-07, 1.0196e-07, 1.0196e-07,
        1.0196e-07, 3.3331e-01, 1.0196e-07, 1.0196e-07])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 89.67% 

Test Accuracy: 88.75% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.45293593406677246
distance x is tensor(132.4594, device='cuda:3')
benign distance is  tensor(132.4594, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.28802111744880676
distance x is tensor(87.1372, device='cuda:3')
benign distance is  tensor(87.1372, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.23108677566051483
distance x is tensor(137.1860, device='cuda:3')
benign distance is  tensor(137.1860, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.44695204496383667
distance x is tensor(116.6287, device='cuda:3')
benign distance is  tensor(116.6287, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5649542808532715
distance x is tensor(110.1882, device='cuda:3')
benign distance is  tensor(110.1882, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5767601728439331
distance x is tensor(153.0664, device='cuda:3')
benign distance is  tensor(153.0664, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.1520380675792694
distance x is tensor(131.8148, device='cuda:3')
benign distance is  tensor(131.8148, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.10568197071552277
distance x is tensor(126.9471, device='cuda:3')
benign distance is  tensor(126.9471, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.6067698001861572
distance x is tensor(137.7214, device='cuda:3')
benign distance is  tensor(137.7214, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.07392565906047821
distance x is tensor(146.6386, device='cuda:3')
benign distance is  tensor(146.6386, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.3819683790206909
distance x is tensor(151.9487, device='cuda:3')
benign distance is  tensor(151.9487, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.13343742489814758
distance x is tensor(142.1932, device='cuda:3')
benign distance is  tensor(142.1932, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.5706987380981445
distance x is tensor(131.9329, device='cuda:3')
benign distance is  tensor(131.9329, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.6390699148178101
distance x is tensor(126.4306, device='cuda:3')
benign distance is  tensor(126.4306, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.4091615080833435
distance x is tensor(136.6796, device='cuda:3')
benign distance is  tensor(136.6796, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.14845332503318787
distance x is tensor(135.5245, device='cuda:3')
benign distance is  tensor(135.5245, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(124.6896, device='cuda:3')
compute distance is  tensor(124.6896, device='cuda:3')
compute norm is  tensor(53.2118, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.5291, device='cuda:3')
compute distance is  tensor(133.5291, device='cuda:3')
compute norm is  tensor(53.4143, device='cuda:3', dtype=torch.float64)
distance x is tensor(155.3228, device='cuda:3')
compute distance is  tensor(155.3228, device='cuda:3')
compute norm is  tensor(54.0052, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.5051, device='cuda:3')
compute distance is  tensor(137.5051, device='cuda:3')
compute norm is  tensor(53.5787, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.9438, device='cuda:3')
compute distance is  tensor(129.9438, device='cuda:3')
compute norm is  tensor(53.3778, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.5428, device='cuda:3')
compute distance is  tensor(129.5428, device='cuda:3')
compute norm is  tensor(53.5535, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.4490, device='cuda:3')
compute distance is  tensor(139.4490, device='cuda:3')
compute norm is  tensor(53.5566, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.3969, device='cuda:3')
compute distance is  tensor(135.3969, device='cuda:3')
compute norm is  tensor(53.5878, device='cuda:3', dtype=torch.float64)
distance x is tensor(163.6993, device='cuda:3')
compute distance is  tensor(163.6993, device='cuda:3')
compute norm is  tensor(54.0757, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.3369, device='cuda:3')
compute distance is  tensor(125.3369, device='cuda:3')
compute norm is  tensor(53.3020, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.9585, device='cuda:3')
compute distance is  tensor(145.9585, device='cuda:3')
compute norm is  tensor(53.5998, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.0382, device='cuda:3')
compute distance is  tensor(127.0382, device='cuda:3')
compute norm is  tensor(53.3558, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(163.6993, device='cuda:3')
distance x is tensor(107752.4766, device='cuda:3')
distance x is tensor(107752.4766, device='cuda:3')
________________________________
test distance is  tensor(107752.4766, device='cuda:3')
test distance1 is  tensor(107752.4766, device='cuda:3')
test similarity is  tensor(-0.1061, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130169921317593.25
test entropy is  0.0
________________________________
cal ratio is  0.03819758335110022
distance x is tensor(4115.8901, device='cuda:3')
cal_distance is  tensor(4115.8901, device='cuda:3')
cal ratio is  0.19544188354838302
distance x is tensor(804.4214, device='cuda:3')
cal_distance is  tensor(804.4214, device='cuda:3')
cal ratio is  0.44208695186463765
distance x is tensor(355.6271, device='cuda:3')
cal_distance is  tensor(355.6271, device='cuda:3')
cal ratio is  0.6648934790350304
distance x is tensor(236.4559, device='cuda:3')
cal_distance is  tensor(236.4559, device='cuda:3')
cal ratio is  0.8154069825443507
distance x is tensor(192.8088, device='cuda:3')
cal_distance is  tensor(192.8088, device='cuda:3')
cal ratio is  0.9029966410197394
distance x is tensor(174.1062, device='cuda:3')
cal_distance is  tensor(174.1062, device='cuda:3')
cal ratio is  0.9502599258958228
distance x is tensor(165.4464, device='cuda:3')
cal_distance is  tensor(165.4464, device='cuda:3')
cal ratio is  0.974812054920578
distance x is tensor(161.2793, device='cuda:3')
cal_distance is  tensor(161.2793, device='cuda:3')
distance x is tensor(161.2793, device='cuda:3')
return_distance is  tensor(161.2793, device='cuda:3')
distance x is tensor(161.2689, device='cuda:3')
distance x is tensor(161.2689, device='cuda:3')
________________________________
test distance is  tensor(161.2689, device='cuda:3')
test distance1 is  tensor(161.2689, device='cuda:3')
test similarity is  tensor(0.9393, device='cuda:3')
test acc is  0.10005000015633199
test loss is 524.3650863094371
test entropy is  2.0026834250803768e-07
________________________________
0
distance x is tensor(161.2689, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.0015801077409936e-08
avg test loss is  524.9851545972357
avg accuracy is  0.21680000015633713
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9393, device='cuda:3')
compute_distance is  tensor(161.2689, device='cuda:3')
compute_norm is  tensor(52.7226, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(137.2070, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9997976579899981
avg test loss is  1.5094683777803042
avg accuracy is  0.785800000156326
solo acc is  0.35235000015634044
compute similarity  is  tensor(0.9474, device='cuda:3')
compute_distance is  tensor(137.2070, device='cuda:3')
compute_norm is  tensor(51.5529, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(137.2070, device='cuda:3')
distance x is tensor(137.2070, device='cuda:3')
________________________________
test distance is  tensor(137.2070, device='cuda:3')
test distance1 is  tensor(137.2070, device='cuda:3')
test similarity is  tensor(0.9474, device='cuda:3')
test acc is  0.3502666668230071
test loss is 1.5180753541907777
test entropy is  1.000417728223272
________________________________
0
distance x is tensor(137.2070, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.000354000627359
avg test loss is  1.5117984950415362
avg accuracy is  0.7852666668229927
solo acc is  0.3507666668230071
compute similarity  is  tensor(0.9474, device='cuda:3')
compute_distance is  tensor(137.2070, device='cuda:3')
compute_norm is  tensor(51.5529, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(140.3276, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6303597635297633
avg test loss is  2.469737569406343
avg accuracy is  0.7559666668229942
solo acc is  0.13398333348966524
compute similarity  is  tensor(0.9467, device='cuda:3')
compute_distance is  tensor(140.3276, device='cuda:3')
compute_norm is  tensor(51.2311, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(142.8501, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9187038334956301
avg test loss is  1.4405752147184505
avg accuracy is  0.8008500001563255
solo acc is  0.32245000015633996
compute similarity  is  tensor(0.9463, device='cuda:3')
compute_distance is  tensor(142.8501, device='cuda:3')
compute_norm is  tensor(50.8511, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(145.0332, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8657276701571336
avg test loss is  1.5449648498217943
avg accuracy is  0.803266666822992
solo acc is  0.26675000015633876
compute similarity  is  tensor(0.9459, device='cuda:3')
compute_distance is  tensor(145.0332, device='cuda:3')
compute_norm is  tensor(50.5607, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(147.0624, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8852316462027747
avg test loss is  1.4930060035638464
avg accuracy is  0.8057666668229918
solo acc is  0.2656000001563387
compute similarity  is  tensor(0.9456, device='cuda:3')
compute_distance is  tensor(147.0624, device='cuda:3')
compute_norm is  tensor(50.2822, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(149.1239, device='cuda:3')
distance x is tensor(149.1239, device='cuda:3')
________________________________
test distance is  tensor(149.1239, device='cuda:3')
test distance1 is  tensor(149.1239, device='cuda:3')
test similarity is  tensor(0.9452, device='cuda:3')
test acc is  0.27140000015633886
test loss is 1.4615570512661802
test entropy is  0.8723163441427226
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.323432445526123
mal norm is  tensor(764.7678, device='cuda:3')
distance x is tensor(149.1316, device='cuda:3')
mal distance is  tensor(149.1316, device='cuda:3')
user_PLR len size 52
counter_tensor is  tensor([45., 50., 13., 42.,  0., 39., 49., 46., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 48., 50.,  0.,  0., 15., 17., 14., 47.,
         0.,  0., 18., 16.,  0.,  1.,  0., 32., 12.,  0., 50.,  0., 44., 51.,
        16., 13., 48.,  0., 51., 43.,  0., 13.,  0., 45.])
count_res tensor([7.3551e-04, 1.0916e-01, 9.3146e-18, 3.6619e-05, 2.1054e-23, 1.8231e-06,
        4.0157e-02, 1.9993e-03, 4.9558e-06, 4.9558e-06, 4.9558e-06, 4.9558e-06,
        4.9558e-06, 4.9558e-06, 4.9558e-06, 4.9558e-06, 4.9558e-06, 4.9558e-06,
        4.9558e-06, 4.9558e-06, 1.4773e-02, 1.0916e-01, 2.1054e-23, 2.1054e-23,
        6.8826e-17, 5.0856e-16, 2.5320e-17, 5.4347e-03, 2.1054e-23, 2.1054e-23,
        1.3824e-15, 1.8709e-16, 2.1054e-23, 5.7231e-23, 2.1054e-23, 1.6625e-09,
        3.4266e-18, 2.1054e-23, 1.0916e-01, 2.1054e-23, 2.7058e-04, 2.9672e-01,
        1.8709e-16, 9.3146e-18, 1.4773e-02, 2.1054e-23, 2.9672e-01, 9.9540e-05,
        2.1054e-23, 9.3146e-18, 2.1054e-23, 7.3551e-04])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 89.78% 

Test Accuracy: 88.93% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5427016019821167
distance x is tensor(124.3618, device='cuda:3')
benign distance is  tensor(124.3618, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5147238969802856
distance x is tensor(88.4553, device='cuda:3')
benign distance is  tensor(88.4553, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.15519292652606964
distance x is tensor(120.0910, device='cuda:3')
benign distance is  tensor(120.0910, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.640630841255188
distance x is tensor(128.5732, device='cuda:3')
benign distance is  tensor(128.5732, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6198108792304993
distance x is tensor(108.5460, device='cuda:3')
benign distance is  tensor(108.5460, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6862624287605286
distance x is tensor(142.5790, device='cuda:3')
benign distance is  tensor(142.5790, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.45086127519607544
distance x is tensor(127.2432, device='cuda:3')
benign distance is  tensor(127.2432, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.29817166924476624
distance x is tensor(140.0510, device='cuda:3')
benign distance is  tensor(140.0510, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.2759261727333069
distance x is tensor(138.9587, device='cuda:3')
benign distance is  tensor(138.9587, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6045488119125366
distance x is tensor(130.3670, device='cuda:3')
benign distance is  tensor(130.3670, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.214904546737671
distance x is tensor(104.9706, device='cuda:3')
benign distance is  tensor(104.9706, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.42031145095825195
distance x is tensor(128.2047, device='cuda:3')
benign distance is  tensor(128.2047, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.4038497507572174
distance x is tensor(134.0334, device='cuda:3')
benign distance is  tensor(134.0334, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.28994476795196533
distance x is tensor(121.7964, device='cuda:3')
benign distance is  tensor(121.7964, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6338996887207031
distance x is tensor(139.1966, device='cuda:3')
benign distance is  tensor(139.1966, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.8485172390937805
distance x is tensor(151.2114, device='cuda:3')
benign distance is  tensor(151.2114, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.7140888571739197
distance x is tensor(140.2987, device='cuda:3')
benign distance is  tensor(140.2987, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.131450891494751
distance x is tensor(146.4528, device='cuda:3')
benign distance is  tensor(146.4528, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.36221855878829956
distance x is tensor(134.9156, device='cuda:3')
benign distance is  tensor(134.9156, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.08331631124019623
distance x is tensor(130.0482, device='cuda:3')
benign distance is  tensor(130.0482, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.18633833527565002
distance x is tensor(118.5812, device='cuda:3')
benign distance is  tensor(118.5812, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9443010091781616
distance x is tensor(92.1958, device='cuda:3')
benign distance is  tensor(92.1958, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.4013892114162445
distance x is tensor(127.8823, device='cuda:3')
benign distance is  tensor(127.8823, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.36274972558021545
distance x is tensor(112.4991, device='cuda:3')
benign distance is  tensor(112.4991, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.17180927097797394
distance x is tensor(139.2639, device='cuda:3')
benign distance is  tensor(139.2639, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7370355129241943
distance x is tensor(131.1180, device='cuda:3')
benign distance is  tensor(131.1180, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.460541307926178
distance x is tensor(141.5301, device='cuda:3')
benign distance is  tensor(141.5301, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5268219113349915
distance x is tensor(137.6070, device='cuda:3')
benign distance is  tensor(137.6070, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.0930907726287842
distance x is tensor(134.6188, device='cuda:3')
benign distance is  tensor(134.6188, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.2995351254940033
distance x is tensor(148.4326, device='cuda:3')
benign distance is  tensor(148.4326, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5376842021942139
distance x is tensor(135.7109, device='cuda:3')
benign distance is  tensor(135.7109, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.07489603012800217
distance x is tensor(130.7787, device='cuda:3')
benign distance is  tensor(130.7787, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.05343324691057205
distance x is tensor(151.0696, device='cuda:3')
benign distance is  tensor(151.0696, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.24760349094867706
distance x is tensor(123.8100, device='cuda:3')
benign distance is  tensor(123.8100, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.04481320083141327
distance x is tensor(138.1868, device='cuda:3')
benign distance is  tensor(138.1868, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.3710283637046814
distance x is tensor(144.7359, device='cuda:3')
benign distance is  tensor(144.7359, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.3053184449672699
distance x is tensor(132.6323, device='cuda:3')
benign distance is  tensor(132.6323, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.28797775506973267
distance x is tensor(140.3280, device='cuda:3')
benign distance is  tensor(140.3280, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6807965636253357
distance x is tensor(141.7975, device='cuda:3')
benign distance is  tensor(141.7975, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7505877614021301
distance x is tensor(155.5455, device='cuda:3')
benign distance is  tensor(155.5455, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(137.1523, device='cuda:3')
compute distance is  tensor(137.1523, device='cuda:3')
compute norm is  tensor(53.4794, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.3284, device='cuda:3')
compute distance is  tensor(140.3284, device='cuda:3')
compute norm is  tensor(53.5519, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.3473, device='cuda:3')
compute distance is  tensor(137.3473, device='cuda:3')
compute norm is  tensor(53.6300, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.1006, device='cuda:3')
compute distance is  tensor(132.1006, device='cuda:3')
compute norm is  tensor(53.4573, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.7937, device='cuda:3')
compute distance is  tensor(142.7937, device='cuda:3')
compute norm is  tensor(53.6631, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.9203, device='cuda:3')
compute distance is  tensor(135.9203, device='cuda:3')
compute norm is  tensor(53.8789, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.9909, device='cuda:3')
compute distance is  tensor(134.9909, device='cuda:3')
compute norm is  tensor(53.5811, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.2009, device='cuda:3')
compute distance is  tensor(129.2009, device='cuda:3')
compute norm is  tensor(53.5526, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.2314, device='cuda:3')
compute distance is  tensor(150.2314, device='cuda:3')
compute norm is  tensor(53.8934, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.9162, device='cuda:3')
compute distance is  tensor(128.9162, device='cuda:3')
compute norm is  tensor(53.5400, device='cuda:3', dtype=torch.float64)
distance x is tensor(149.5858, device='cuda:3')
compute distance is  tensor(149.5858, device='cuda:3')
compute norm is  tensor(53.7792, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.7068, device='cuda:3')
compute distance is  tensor(136.7068, device='cuda:3')
compute norm is  tensor(53.5756, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(150.2314, device='cuda:3')
distance x is tensor(107750.6484, device='cuda:3')
distance x is tensor(107750.6484, device='cuda:3')
________________________________
test distance is  tensor(107750.6484, device='cuda:3')
test distance1 is  tensor(107750.6484, device='cuda:3')
test similarity is  tensor(-0.1050, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130019151944872.12
test entropy is  0.0
________________________________
cal ratio is  0.03659286664804452
distance x is tensor(3942.9106, device='cuda:3')
cal_distance is  tensor(3942.9106, device='cuda:3')
cal ratio is  0.1912924939674109
distance x is tensor(754.2535, device='cuda:3')
cal_distance is  tensor(754.2535, device='cuda:3')
cal ratio is  0.4373687129445092
distance x is tensor(329.8898, device='cuda:3')
cal_distance is  tensor(329.8898, device='cuda:3')
cal ratio is  0.661335665511682
distance x is tensor(218.1697, device='cuda:3')
cal_distance is  tensor(218.1697, device='cuda:3')
cal ratio is  0.8132221705573622
distance x is tensor(177.4214, device='cuda:3')
cal_distance is  tensor(177.4214, device='cuda:3')
cal ratio is  0.9017858336393285
distance x is tensor(159.9966, device='cuda:3')
cal_distance is  tensor(159.9966, device='cuda:3')
cal ratio is  0.9496224560795803
distance x is tensor(151.9366, device='cuda:3')
cal_distance is  tensor(151.9366, device='cuda:3')
cal ratio is  0.9744849105589563
distance x is tensor(148.0601, device='cuda:3')
cal_distance is  tensor(148.0601, device='cuda:3')
distance x is tensor(148.0601, device='cuda:3')
return_distance is  tensor(148.0601, device='cuda:3')
distance x is tensor(148.0497, device='cuda:3')
distance x is tensor(148.0497, device='cuda:3')
________________________________
test distance is  tensor(148.0497, device='cuda:3')
test distance1 is  tensor(148.0497, device='cuda:3')
test similarity is  tensor(0.9484, device='cuda:3')
test acc is  0.10003333348966531
test loss is 414.4023068556145
test entropy is  3.955128701960096e-06
________________________________
0
distance x is tensor(148.0497, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.3789734966037738e-05
avg test loss is  414.3751121797541
avg accuracy is  0.28916666682300596
solo acc is  0.10008333348966532
compute similarity  is  tensor(0.9484, device='cuda:3')
compute_distance is  tensor(148.0497, device='cuda:3')
compute_norm is  tensor(52.5459, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(128.0442, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9272598157813554
avg test loss is  1.5854083093752993
avg accuracy is  0.806150000156325
solo acc is  0.3267166668230067
compute similarity  is  tensor(0.9548, device='cuda:3')
compute_distance is  tensor(128.0442, device='cuda:3')
compute_norm is  tensor(51.2932, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(130.9935, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.89183895623506
avg test loss is  1.6051466636566212
avg accuracy is  0.8089666668229916
solo acc is  0.2850000001563391
compute similarity  is  tensor(0.9543, device='cuda:3')
compute_distance is  tensor(130.9935, device='cuda:3')
compute_norm is  tensor(50.9378, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(133.5178, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.873830439375916
avg test loss is  1.5681203039470257
avg accuracy is  0.8134833334896582
solo acc is  0.27656666682300557
compute similarity  is  tensor(0.9538, device='cuda:3')
compute_distance is  tensor(133.5178, device='cuda:3')
compute_norm is  tensor(50.6197, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(135.8576, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.884316911511838
avg test loss is  1.5033922642787128
avg accuracy is  0.8180500001563246
solo acc is  0.2807500001563391
compute similarity  is  tensor(0.9534, device='cuda:3')
compute_distance is  tensor(135.8576, device='cuda:3')
compute_norm is  tensor(50.3238, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.2131, device='cuda:3')
distance x is tensor(138.2131, device='cuda:3')
________________________________
test distance is  tensor(138.2131, device='cuda:3')
test distance1 is  tensor(138.2131, device='cuda:3')
test similarity is  tensor(0.9530, device='cuda:3')
test acc is  0.27888333348967237
test loss is 1.4678442593830734
test entropy is  0.8823107975378219
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.5756876468658447
mal norm is  tensor(708.0413, device='cuda:3')
distance x is tensor(138.2205, device='cuda:3')
mal distance is  tensor(138.2205, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 19.03% 

Test Accuracy: 19.08% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.2521276473999023
distance x is tensor(178.7879, device='cuda:3')
benign distance is  tensor(178.7879, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5058174133300781
distance x is tensor(172.6628, device='cuda:3')
benign distance is  tensor(172.6628, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8597369194030762
distance x is tensor(193.9177, device='cuda:3')
benign distance is  tensor(193.9177, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2898140847682953
distance x is tensor(166.4927, device='cuda:3')
benign distance is  tensor(166.4927, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.48123154044151306
distance x is tensor(176.0138, device='cuda:3')
benign distance is  tensor(176.0138, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.634576678276062
distance x is tensor(177.9810, device='cuda:3')
benign distance is  tensor(177.9810, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4787551462650299
distance x is tensor(157.5322, device='cuda:3')
benign distance is  tensor(157.5322, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.20140016078948975
distance x is tensor(197.9130, device='cuda:3')
benign distance is  tensor(197.9130, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(173.5785, device='cuda:3')
compute distance is  tensor(173.5785, device='cuda:3')
compute norm is  tensor(51.9955, device='cuda:3', dtype=torch.float64)
distance x is tensor(183.6835, device='cuda:3')
compute distance is  tensor(183.6835, device='cuda:3')
compute norm is  tensor(52.2746, device='cuda:3', dtype=torch.float64)
distance x is tensor(178.8966, device='cuda:3')
compute distance is  tensor(178.8966, device='cuda:3')
compute norm is  tensor(52.1917, device='cuda:3', dtype=torch.float64)
distance x is tensor(190.2035, device='cuda:3')
compute distance is  tensor(190.2035, device='cuda:3')
compute norm is  tensor(52.2017, device='cuda:3', dtype=torch.float64)
distance x is tensor(178.9738, device='cuda:3')
compute distance is  tensor(178.9738, device='cuda:3')
compute norm is  tensor(52.1738, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.0390, device='cuda:3')
compute distance is  tensor(165.0390, device='cuda:3')
compute norm is  tensor(52.0321, device='cuda:3', dtype=torch.float64)
distance x is tensor(183.2576, device='cuda:3')
compute distance is  tensor(183.2576, device='cuda:3')
compute norm is  tensor(52.2725, device='cuda:3', dtype=torch.float64)
distance x is tensor(172.6185, device='cuda:3')
compute distance is  tensor(172.6185, device='cuda:3')
compute norm is  tensor(52.0579, device='cuda:3', dtype=torch.float64)
distance x is tensor(183.3513, device='cuda:3')
compute distance is  tensor(183.3513, device='cuda:3')
compute norm is  tensor(52.4251, device='cuda:3', dtype=torch.float64)
distance x is tensor(187.6273, device='cuda:3')
compute distance is  tensor(187.6273, device='cuda:3')
compute norm is  tensor(52.4181, device='cuda:3', dtype=torch.float64)
distance x is tensor(192.1341, device='cuda:3')
compute distance is  tensor(192.1341, device='cuda:3')
compute norm is  tensor(52.3314, device='cuda:3', dtype=torch.float64)
distance x is tensor(201.5461, device='cuda:3')
compute distance is  tensor(201.5461, device='cuda:3')
compute norm is  tensor(52.7242, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(201.5461, device='cuda:3')
distance x is tensor(107674.7188, device='cuda:3')
distance x is tensor(107674.7188, device='cuda:3')
________________________________
test distance is  tensor(107674.7188, device='cuda:3')
test distance1 is  tensor(107674.7188, device='cuda:3')
test similarity is  tensor(0.1584, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130018184169589.9
test entropy is  0.0
________________________________
cal ratio is  0.04239907649449466
distance x is tensor(4565.3140, device='cuda:3')
cal_distance is  tensor(4565.3140, device='cuda:3')
cal ratio is  0.20591024494131238
distance x is tensor(940.0490, device='cuda:3')
cal_distance is  tensor(940.0490, device='cuda:3')
cal ratio is  0.4537723580939272
distance x is tensor(426.5711, device='cuda:3')
cal_distance is  tensor(426.5711, device='cuda:3')
cal ratio is  0.6736239870311194
distance x is tensor(287.3502, device='cuda:3')
cal_distance is  tensor(287.3502, device='cuda:3')
cal ratio is  0.8207436126061889
distance x is tensor(235.8418, device='cuda:3')
cal_distance is  tensor(235.8418, device='cuda:3')
cal ratio is  0.9059471400531955
distance x is tensor(213.6607, device='cuda:3')
cal_distance is  tensor(213.6607, device='cuda:3')
cal ratio is  0.9518114831462992
distance x is tensor(203.3650, device='cuda:3')
cal_distance is  tensor(203.3650, device='cuda:3')
cal ratio is  0.9756076675209726
distance x is tensor(198.4046, device='cuda:3')
cal_distance is  tensor(198.4046, device='cuda:3')
distance x is tensor(198.4046, device='cuda:3')
return_distance is  tensor(198.4046, device='cuda:3')
distance x is tensor(198.3942, device='cuda:3')
distance x is tensor(198.3942, device='cuda:3')
________________________________
test distance is  tensor(198.3942, device='cuda:3')
test distance1 is  tensor(198.3942, device='cuda:3')
test similarity is  tensor(0.9236, device='cuda:3')
test acc is  0.10000000015633198
test loss is 1369.305613308319
test entropy is  0.0
________________________________
0
distance x is tensor(198.3942, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  1366.768349198136
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9236, device='cuda:3')
compute_distance is  tensor(198.3942, device='cuda:3')
compute_norm is  tensor(54.7392, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2245.0615, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.6145080589790588
avg test loss is  2.8487555431658778
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2287, device='cuda:3')
compute_distance is  tensor(2245.0615, device='cuda:3')
compute_norm is  tensor(223.1228, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2234.8696, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8709741495946831
avg test loss is  3.6520212110934227
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2288, device='cuda:3')
compute_distance is  tensor(2234.8696, device='cuda:3')
compute_norm is  tensor(222.2161, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2224.8035, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5576639927780704
avg test loss is  2.863858357167193
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2287, device='cuda:3')
compute_distance is  tensor(2224.8035, device='cuda:3')
compute_norm is  tensor(221.1219, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2214.7314, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8581264412352271
avg test loss is  3.6162712909519543
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2288, device='cuda:3')
compute_distance is  tensor(2214.7314, device='cuda:3')
compute_norm is  tensor(220.2080, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2204.6624, device='cuda:3')
distance x is tensor(2204.6624, device='cuda:3')
________________________________
test distance is  tensor(2204.6624, device='cuda:3')
test distance1 is  tensor(2204.6624, device='cuda:3')
test similarity is  tensor(0.2287, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8724091825708906
test entropy is  1.5444040843672844
________________________________
cal ratio is  0.2963072172523567
distance x is tensor(653.2571, device='cuda:3')
cal_distance is  tensor(653.2571, device='cuda:3')
cal ratio is  0.5443411800815066
distance x is tensor(355.5946, device='cuda:3')
cal_distance is  tensor(355.5946, device='cuda:3')
cal ratio is  0.737794983497156
distance x is tensor(262.3559, device='cuda:3')
cal_distance is  tensor(262.3559, device='cuda:3')
cal ratio is  0.8589500088550095
distance x is tensor(225.3505, device='cuda:3')
cal_distance is  tensor(225.3505, device='cuda:3')
cal ratio is  0.9267956109365104
distance x is tensor(208.8539, device='cuda:3')
cal_distance is  tensor(208.8539, device='cuda:3')
cal ratio is  0.9627022342630399
distance x is tensor(201.0641, device='cuda:3')
cal_distance is  tensor(201.0641, device='cuda:3')
distance x is tensor(201.0641, device='cuda:3')
return_distance is  tensor(201.0641, device='cuda:3')
distance x is tensor(201.0646, device='cuda:3')
distance x is tensor(201.0646, device='cuda:3')
________________________________
test distance is  tensor(201.0646, device='cuda:3')
test distance1 is  tensor(201.0646, device='cuda:3')
test similarity is  tensor(0.8995, device='cuda:3')
test acc is  0.10165000015633197
test loss is 3.9746763701123724
test entropy is  1.2156848648845007
________________________________
0
distance x is tensor(201.0646, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.214997220331672
avg test loss is  3.9784615947239437
avg accuracy is  0.1011833334896653
solo acc is  0.1025333334896653
compute similarity  is  tensor(0.8995, device='cuda:3')
compute_distance is  tensor(201.0646, device='cuda:3')
compute_norm is  tensor(57.7162, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(202.3449, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9016133553819108
avg test loss is  2.861493215377905
avg accuracy is  0.10381666682299863
solo acc is  0.10025000015633198
compute similarity  is  tensor(0.8994, device='cuda:3')
compute_distance is  tensor(202.3449, device='cuda:3')
compute_norm is  tensor(57.5081, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(205.6299, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0951157631650408
avg test loss is  1.950128131329632
avg accuracy is  0.12616666682299857
solo acc is  0.17256666682300148
compute similarity  is  tensor(0.8990, device='cuda:3')
compute_distance is  tensor(205.6299, device='cuda:3')
compute_norm is  tensor(57.1438, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(205.3211, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.6811289478466709
avg test loss is  2.6493480492756567
avg accuracy is  0.1118666668229986
solo acc is  0.1045333334896653
compute similarity  is  tensor(0.8989, device='cuda:3')
compute_distance is  tensor(205.3211, device='cuda:3')
compute_norm is  tensor(56.9391, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(207.4745, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.1413391053295339
avg test loss is  1.7963291302418658
avg accuracy is  0.13191666682299855
solo acc is  0.17451666682300163
compute similarity  is  tensor(0.8986, device='cuda:3')
compute_distance is  tensor(207.4745, device='cuda:3')
compute_norm is  tensor(56.5970, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(207.2026, device='cuda:3')
distance x is tensor(207.2026, device='cuda:3')
________________________________
test distance is  tensor(207.2026, device='cuda:3')
test distance1 is  tensor(207.2026, device='cuda:3')
test similarity is  tensor(0.8985, device='cuda:3')
test acc is  0.10426666682299864
test loss is 2.502967616134107
test entropy is  0.6354865216370076
________________________________
cal ratio is  0.9665307893432202
distance x is tensor(200.2655, device='cuda:3')
cal_distance is  tensor(200.2655, device='cuda:3')
distance x is tensor(200.2655, device='cuda:3')
return_distance is  tensor(200.2655, device='cuda:3')
distance x is tensor(200.2677, device='cuda:3')
distance x is tensor(200.2677, device='cuda:3')
________________________________
test distance is  tensor(200.2677, device='cuda:3')
test distance1 is  tensor(200.2677, device='cuda:3')
test similarity is  tensor(0.9042, device='cuda:3')
test acc is  0.10445000015633196
test loss is 2.542258816741423
test entropy is  0.6174307449349462
________________________________
0
distance x is tensor(200.2677, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6178624987093879
avg test loss is  2.5429378794962916
avg accuracy is  0.11523333348966527
solo acc is  0.1044333334896653
compute similarity  is  tensor(0.9042, device='cuda:3')
compute_distance is  tensor(200.2677, device='cuda:3')
compute_norm is  tensor(56.0423, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(202.6522, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0436311174811586
avg test loss is  1.6090395857276185
avg accuracy is  0.14320000015633252
solo acc is  0.2242500001563374
compute similarity  is  tensor(0.9038, device='cuda:3')
compute_distance is  tensor(202.6522, device='cuda:3')
compute_norm is  tensor(55.7361, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(202.5550, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.5909909707015512
avg test loss is  2.461616384322201
avg accuracy is  0.11623333348966527
solo acc is  0.10385000015633197
compute similarity  is  tensor(0.9037, device='cuda:3')
compute_distance is  tensor(202.5550, device='cuda:3')
compute_norm is  tensor(55.5179, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(204.6521, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.9625897973076876
avg test loss is  1.5848533672564573
avg accuracy is  0.14106666682299904
solo acc is  0.22276666682300397
compute similarity  is  tensor(0.9033, device='cuda:3')
compute_distance is  tensor(204.6521, device='cuda:3')
compute_norm is  tensor(55.2258, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(204.6496, device='cuda:3')
________________________________
test distance is  tensor(204.6496, device='cuda:3')
test similarity is  tensor(0.9033, device='cuda:3')
test acc is  0.1412333334896657
test loss is 1.5841971483311927
test entropy is  0.9606316597349862
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.4402594566345215
mal norm is  tensor(1056.9474, device='cuda:3')
distance x is tensor(204.6496, device='cuda:3')
mal distance is  tensor(204.6496, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([12., 13., 12., 14., 12., 23., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 23., 12., 12., 21., 27., 12.,  0.])
count_res tensor([2.9433e-07, 8.0007e-07, 2.9433e-07, 2.1748e-06, 2.9433e-07, 1.7623e-02,
        2.9433e-07, 2.9433e-07, 1.6070e-05, 1.6070e-05, 1.6070e-05, 1.6070e-05,
        1.6070e-05, 1.6070e-05, 1.6070e-05, 1.6070e-05, 1.6070e-05, 1.6070e-05,
        1.6070e-05, 1.6070e-05, 2.9433e-07, 1.7623e-02, 2.9433e-07, 2.9433e-07,
        2.3850e-03, 9.6217e-01, 2.9433e-07, 1.8084e-12])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 88.15% 

Test Accuracy: 87.90% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.32042694091796875
distance x is tensor(139.1838, device='cuda:3')
benign distance is  tensor(139.1838, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.4120326638221741
distance x is tensor(125.7279, device='cuda:3')
benign distance is  tensor(125.7279, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.3970138728618622
distance x is tensor(143.3651, device='cuda:3')
benign distance is  tensor(143.3651, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6489599943161011
distance x is tensor(138.9233, device='cuda:3')
benign distance is  tensor(138.9233, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.40461111068725586
distance x is tensor(152.0292, device='cuda:3')
benign distance is  tensor(152.0292, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6880907416343689
distance x is tensor(155.8704, device='cuda:3')
benign distance is  tensor(155.8704, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.27750855684280396
distance x is tensor(138.6350, device='cuda:3')
benign distance is  tensor(138.6350, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6423310041427612
distance x is tensor(159.0602, device='cuda:3')
benign distance is  tensor(159.0602, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.10482120513916016
distance x is tensor(149.9716, device='cuda:3')
benign distance is  tensor(149.9716, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4271985590457916
distance x is tensor(144.3318, device='cuda:3')
benign distance is  tensor(144.3318, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.35460609197616577
distance x is tensor(136.6647, device='cuda:3')
benign distance is  tensor(136.6647, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.6550388336181641
distance x is tensor(147.5500, device='cuda:3')
benign distance is  tensor(147.5500, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.28241783380508423
distance x is tensor(161.6936, device='cuda:3')
benign distance is  tensor(161.6936, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.15454281866550446
distance x is tensor(93.1802, device='cuda:3')
benign distance is  tensor(93.1802, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.10884630680084229
distance x is tensor(155.0897, device='cuda:3')
benign distance is  tensor(155.0897, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5465167760848999
distance x is tensor(158.6746, device='cuda:3')
benign distance is  tensor(158.6746, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(151.0926, device='cuda:3')
compute distance is  tensor(151.0926, device='cuda:3')
compute norm is  tensor(54.7876, device='cuda:3', dtype=torch.float64)
distance x is tensor(152.1288, device='cuda:3')
compute distance is  tensor(152.1288, device='cuda:3')
compute norm is  tensor(54.9524, device='cuda:3', dtype=torch.float64)
distance x is tensor(157.2382, device='cuda:3')
compute distance is  tensor(157.2382, device='cuda:3')
compute norm is  tensor(55.2093, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.4228, device='cuda:3')
compute distance is  tensor(136.4228, device='cuda:3')
compute norm is  tensor(54.5770, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.6113, device='cuda:3')
compute distance is  tensor(151.6113, device='cuda:3')
compute norm is  tensor(54.9309, device='cuda:3', dtype=torch.float64)
distance x is tensor(173.8577, device='cuda:3')
compute distance is  tensor(173.8577, device='cuda:3')
compute norm is  tensor(55.4307, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.0416, device='cuda:3')
compute distance is  tensor(150.0416, device='cuda:3')
compute norm is  tensor(54.9080, device='cuda:3', dtype=torch.float64)
distance x is tensor(151.5625, device='cuda:3')
compute distance is  tensor(151.5625, device='cuda:3')
compute norm is  tensor(54.9668, device='cuda:3', dtype=torch.float64)
distance x is tensor(161.8805, device='cuda:3')
compute distance is  tensor(161.8805, device='cuda:3')
compute norm is  tensor(55.1243, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.4451, device='cuda:3')
compute distance is  tensor(147.4451, device='cuda:3')
compute norm is  tensor(54.9727, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.7467, device='cuda:3')
compute distance is  tensor(158.7467, device='cuda:3')
compute norm is  tensor(55.0668, device='cuda:3', dtype=torch.float64)
distance x is tensor(146.1249, device='cuda:3')
compute distance is  tensor(146.1249, device='cuda:3')
compute norm is  tensor(54.8786, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(173.8577, device='cuda:3')
distance x is tensor(107756.6797, device='cuda:3')
distance x is tensor(107756.6797, device='cuda:3')
________________________________
test distance is  tensor(107756.6797, device='cuda:3')
test distance1 is  tensor(107756.6797, device='cuda:3')
test similarity is  tensor(-0.0979, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130125948923074.31
test entropy is  0.0
________________________________
cal ratio is  0.03936415074971337
distance x is tensor(4241.7563, device='cuda:3')
cal_distance is  tensor(4241.7563, device='cuda:3')
cal ratio is  0.19840386478836702
distance x is tensor(841.5851, device='cuda:3')
cal_distance is  tensor(841.5851, device='cuda:3')
cal ratio is  0.44542436492343884
distance x is tensor(374.8654, device='cuda:3')
cal_distance is  tensor(374.8654, device='cuda:3')
cal ratio is  0.6673986570438359
distance x is tensor(250.1864, device='cuda:3')
cal_distance is  tensor(250.1864, device='cuda:3')
cal ratio is  0.816941832994888
distance x is tensor(204.3887, device='cuda:3')
cal_distance is  tensor(204.3887, device='cuda:3')
cal ratio is  0.9038461924575542
distance x is tensor(184.7365, device='cuda:3')
cal_distance is  tensor(184.7365, device='cuda:3')
cal ratio is  0.9507069872751747
distance x is tensor(175.6305, device='cuda:3')
cal_distance is  tensor(175.6305, device='cuda:3')
cal ratio is  0.9750413135676649
distance x is tensor(171.2471, device='cuda:3')
cal_distance is  tensor(171.2471, device='cuda:3')
distance x is tensor(171.2471, device='cuda:3')
return_distance is  tensor(171.2471, device='cuda:3')
distance x is tensor(171.2367, device='cuda:3')
distance x is tensor(171.2367, device='cuda:3')
________________________________
test distance is  tensor(171.2367, device='cuda:3')
test distance1 is  tensor(171.2367, device='cuda:3')
test similarity is  tensor(0.9358, device='cuda:3')
test acc is  0.10003333348966531
test loss is 667.5200605250117
test entropy is  1.2263332846136892e-05
________________________________
0
distance x is tensor(171.2367, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.2279827322644865e-05
avg test loss is  667.3700025351063
avg accuracy is  0.1485166668229997
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.9358, device='cuda:3')
compute_distance is  tensor(171.2367, device='cuda:3')
compute_norm is  tensor(54.2547, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(146.6621, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9841916878213252
avg test loss is  1.5116438685195532
avg accuracy is  0.7350666668229953
solo acc is  0.3477833334896737
compute similarity  is  tensor(0.9447, device='cuda:3')
compute_distance is  tensor(146.6621, device='cuda:3')
compute_norm is  tensor(53.0910, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(146.6621, device='cuda:3')
distance x is tensor(146.6621, device='cuda:3')
________________________________
test distance is  tensor(146.6621, device='cuda:3')
test distance1 is  tensor(146.6621, device='cuda:3')
test similarity is  tensor(0.9447, device='cuda:3')
test acc is  0.3448833334896737
test loss is 1.5183129164455795
test entropy is  0.9838349910687282
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.4622644186019897
mal norm is  tensor(798.8285, device='cuda:3')
distance x is tensor(146.6701, device='cuda:3')
mal distance is  tensor(146.6701, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12.,  0., 15., 27., 12., 27., 27.])
count_res tensor([1.0196e-07, 1.0196e-07, 1.0196e-07, 1.0196e-07, 1.0196e-07, 1.0196e-07,
        1.0196e-07, 1.0196e-07, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06,
        5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06, 5.5668e-06,
        5.5668e-06, 5.5668e-06, 1.0196e-07, 1.0196e-07, 6.2647e-13, 2.0479e-06,
        3.3331e-01, 1.0196e-07, 3.3331e-01, 3.3331e-01])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 89.12% 

Test Accuracy: 88.63% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.47617635130882263
distance x is tensor(146.7574, device='cuda:3')
benign distance is  tensor(146.7574, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.6495015621185303
distance x is tensor(92.6828, device='cuda:3')
benign distance is  tensor(92.6828, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2668647766113281
distance x is tensor(142.1790, device='cuda:3')
benign distance is  tensor(142.1790, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.2542668282985687
distance x is tensor(122.9300, device='cuda:3')
benign distance is  tensor(122.9300, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.929459273815155
distance x is tensor(117.2353, device='cuda:3')
benign distance is  tensor(117.2353, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7225899696350098
distance x is tensor(143.4561, device='cuda:3')
benign distance is  tensor(143.4561, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.17755672335624695
distance x is tensor(124.4067, device='cuda:3')
benign distance is  tensor(124.4067, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.26516321301460266
distance x is tensor(139.9733, device='cuda:3')
benign distance is  tensor(139.9733, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.06953053176403046
distance x is tensor(130.1381, device='cuda:3')
benign distance is  tensor(130.1381, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.4210982918739319
distance x is tensor(136.5598, device='cuda:3')
benign distance is  tensor(136.5598, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.23044231534004211
distance x is tensor(125.8857, device='cuda:3')
benign distance is  tensor(125.8857, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.22984322905540466
distance x is tensor(131.8127, device='cuda:3')
benign distance is  tensor(131.8127, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.1638268679380417
distance x is tensor(117.4663, device='cuda:3')
benign distance is  tensor(117.4663, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.847790539264679
distance x is tensor(106.6105, device='cuda:3')
benign distance is  tensor(106.6105, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5967411398887634
distance x is tensor(115.1247, device='cuda:3')
benign distance is  tensor(115.1247, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3832681179046631
distance x is tensor(111.0919, device='cuda:3')
benign distance is  tensor(111.0919, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(129.9340, device='cuda:3')
compute distance is  tensor(129.9340, device='cuda:3')
compute norm is  tensor(53.9995, device='cuda:3', dtype=torch.float64)
distance x is tensor(118.1461, device='cuda:3')
compute distance is  tensor(118.1461, device='cuda:3')
compute norm is  tensor(53.7573, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.6623, device='cuda:3')
compute distance is  tensor(142.6623, device='cuda:3')
compute norm is  tensor(54.3476, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.3075, device='cuda:3')
compute distance is  tensor(123.3075, device='cuda:3')
compute norm is  tensor(53.9674, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.9981, device='cuda:3')
compute distance is  tensor(132.9981, device='cuda:3')
compute norm is  tensor(54.0788, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.2480, device='cuda:3')
compute distance is  tensor(143.2480, device='cuda:3')
compute norm is  tensor(54.3100, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.3289, device='cuda:3')
compute distance is  tensor(136.3289, device='cuda:3')
compute norm is  tensor(54.2073, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.0291, device='cuda:3')
compute distance is  tensor(133.0291, device='cuda:3')
compute norm is  tensor(54.0740, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.3851, device='cuda:3')
compute distance is  tensor(135.3851, device='cuda:3')
compute norm is  tensor(54.1144, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.8114, device='cuda:3')
compute distance is  tensor(127.8114, device='cuda:3')
compute norm is  tensor(54.0760, device='cuda:3', dtype=torch.float64)
distance x is tensor(145.2372, device='cuda:3')
compute distance is  tensor(145.2372, device='cuda:3')
compute norm is  tensor(54.3301, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.6191, device='cuda:3')
compute distance is  tensor(138.6191, device='cuda:3')
compute norm is  tensor(54.3274, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(145.2372, device='cuda:3')
distance x is tensor(107755.8125, device='cuda:3')
distance x is tensor(107755.8125, device='cuda:3')
________________________________
test distance is  tensor(107755.8125, device='cuda:3')
test distance1 is  tensor(107755.8125, device='cuda:3')
test similarity is  tensor(-0.1050, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130041785062100.88
test entropy is  0.0
________________________________
cal ratio is  0.03597863749788431
distance x is tensor(3876.9124, device='cuda:3')
cal_distance is  tensor(3876.9124, device='cuda:3')
cal ratio is  0.1896802321751084
distance x is tensor(735.3778, device='cuda:3')
cal_distance is  tensor(735.3778, device='cuda:3')
cal ratio is  0.43552171309110915
distance x is tensor(320.2760, device='cuda:3')
cal_distance is  tensor(320.2760, device='cuda:3')
cal ratio is  0.659937629443912
distance x is tensor(211.3640, device='cuda:3')
cal_distance is  tensor(211.3640, device='cuda:3')
cal ratio is  0.8123619834466362
distance x is tensor(171.7050, device='cuda:3')
cal_distance is  tensor(171.7050, device='cuda:3')
cal ratio is  0.9013087910855649
distance x is tensor(154.7598, device='cuda:3')
cal_distance is  tensor(154.7598, device='cuda:3')
cal ratio is  0.9493711409951812
distance x is tensor(146.9247, device='cuda:3')
cal_distance is  tensor(146.9247, device='cuda:3')
cal ratio is  0.9743559020900924
distance x is tensor(143.1571, device='cuda:3')
cal_distance is  tensor(143.1571, device='cuda:3')
distance x is tensor(143.1571, device='cuda:3')
return_distance is  tensor(143.1571, device='cuda:3')
distance x is tensor(143.1467, device='cuda:3')
distance x is tensor(143.1467, device='cuda:3')
________________________________
test distance is  tensor(143.1467, device='cuda:3')
test distance1 is  tensor(143.1467, device='cuda:3')
test similarity is  tensor(0.9528, device='cuda:3')
test acc is  0.10025000015633198
test loss is 347.43593784486814
test entropy is  3.200458850139657e-05
________________________________
0
distance x is tensor(143.1467, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  6.320083467672162e-05
avg test loss is  347.02928138846784
avg accuracy is  0.3773666668230074
solo acc is  0.10030000015633196
compute similarity  is  tensor(0.9528, device='cuda:3')
compute_distance is  tensor(143.1467, device='cuda:3')
compute_norm is  tensor(53.0809, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(123.8461, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9550239367525715
avg test loss is  1.4732455683669556
avg accuracy is  0.8211000001563244
solo acc is  0.3561500001563405
compute similarity  is  tensor(0.9586, device='cuda:3')
compute_distance is  tensor(123.8461, device='cuda:3')
compute_norm is  tensor(51.7791, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(126.9740, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9035999179521857
avg test loss is  1.5689291216925518
avg accuracy is  0.8227833334896578
solo acc is  0.28890000015633915
compute similarity  is  tensor(0.9580, device='cuda:3')
compute_distance is  tensor(126.9740, device='cuda:3')
compute_norm is  tensor(51.4336, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(129.5722, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8889194732027521
avg test loss is  1.5401410166896992
avg accuracy is  0.8256000001563243
solo acc is  0.28020000015633906
compute similarity  is  tensor(0.9576, device='cuda:3')
compute_distance is  tensor(129.5722, device='cuda:3')
compute_norm is  tensor(51.1220, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(132.0322, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8807431411768581
avg test loss is  1.503837229219327
avg accuracy is  0.8283666668229908
solo acc is  0.2756666668230056
compute similarity  is  tensor(0.9572, device='cuda:3')
compute_distance is  tensor(132.0322, device='cuda:3')
compute_norm is  tensor(50.8285, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.4160, device='cuda:3')
distance x is tensor(134.4160, device='cuda:3')
________________________________
test distance is  tensor(134.4160, device='cuda:3')
test distance1 is  tensor(134.4160, device='cuda:3')
test similarity is  tensor(0.9569, device='cuda:3')
test acc is  0.2793166668230057
test loss is 1.4538668312751917
test entropy is  0.8864951689741505
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.3210960626602173
mal norm is  tensor(687.8471, device='cuda:3')
distance x is tensor(134.4235, device='cuda:3')
mal distance is  tensor(134.4235, device='cuda:3')
user_PLR len size 44
counter_tensor is  tensor([12., 13., 12., 41., 29., 35., 42., 43., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 29.,  0., 12., 12., 38., 43., 12., 12.,
        39., 40.,  1., 43., 12., 34., 12., 41., 12.,  1., 12., 23., 13., 13.,
         0.,  0.])
count_res tensor([9.2688e-15, 2.5195e-14, 9.2688e-15, 3.6439e-02, 2.2389e-07, 9.0323e-05,
        9.9051e-02, 2.6925e-01, 4.4969e-06, 4.4969e-06, 4.4969e-06, 4.4969e-06,
        4.4969e-06, 4.4969e-06, 4.4969e-06, 4.4969e-06, 4.4969e-06, 4.4969e-06,
        4.4969e-06, 4.4969e-06, 2.2389e-07, 5.6949e-20, 9.2688e-15, 9.2688e-15,
        1.8142e-03, 2.6925e-01, 9.2688e-15, 9.2688e-15, 4.9314e-03, 1.3405e-02,
        1.5480e-19, 2.6925e-01, 9.2688e-15, 3.3228e-05, 9.2688e-15, 3.6439e-02,
        9.2688e-15, 1.5480e-19, 9.2688e-15, 5.5496e-10, 2.5195e-14, 2.5195e-14,
        5.6949e-20, 5.6949e-20])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 89.77% 

Test Accuracy: 89.02% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2571001350879669
distance x is tensor(143.3141, device='cuda:3')
benign distance is  tensor(143.3141, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9588719606399536
distance x is tensor(87.5551, device='cuda:3')
benign distance is  tensor(87.5551, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1225757822394371
distance x is tensor(124.6129, device='cuda:3')
benign distance is  tensor(124.6129, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.1161407008767128
distance x is tensor(111.8210, device='cuda:3')
benign distance is  tensor(111.8210, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.652560830116272
distance x is tensor(96.6599, device='cuda:3')
benign distance is  tensor(96.6599, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7079647183418274
distance x is tensor(141.2644, device='cuda:3')
benign distance is  tensor(141.2644, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4401085376739502
distance x is tensor(115.9703, device='cuda:3')
benign distance is  tensor(115.9703, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7652891874313354
distance x is tensor(114.4902, device='cuda:3')
benign distance is  tensor(114.4902, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.21454019844532013
distance x is tensor(134.8217, device='cuda:3')
benign distance is  tensor(134.8217, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.4215754568576813
distance x is tensor(122.1063, device='cuda:3')
benign distance is  tensor(122.1063, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.1752951741218567
distance x is tensor(115.8086, device='cuda:3')
benign distance is  tensor(115.8086, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.47599226236343384
distance x is tensor(126.7672, device='cuda:3')
benign distance is  tensor(126.7672, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5398147702217102
distance x is tensor(140.1530, device='cuda:3')
benign distance is  tensor(140.1530, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.35062551498413086
distance x is tensor(120.8755, device='cuda:3')
benign distance is  tensor(120.8755, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.27065223455429077
distance x is tensor(130.9476, device='cuda:3')
benign distance is  tensor(130.9476, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.30318552255630493
distance x is tensor(142.2726, device='cuda:3')
benign distance is  tensor(142.2726, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.33653515577316284
distance x is tensor(134.6284, device='cuda:3')
benign distance is  tensor(134.6284, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.3402007222175598
distance x is tensor(126.9844, device='cuda:3')
benign distance is  tensor(126.9844, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.26838839054107666
distance x is tensor(124.4600, device='cuda:3')
benign distance is  tensor(124.4600, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.34248536825180054
distance x is tensor(153.7328, device='cuda:3')
benign distance is  tensor(153.7328, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6792284846305847
distance x is tensor(130.8792, device='cuda:3')
benign distance is  tensor(130.8792, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.5639390349388123
distance x is tensor(136.9564, device='cuda:3')
benign distance is  tensor(136.9564, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.14415141940116882
distance x is tensor(147.4608, device='cuda:3')
benign distance is  tensor(147.4608, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.19828757643699646
distance x is tensor(124.4685, device='cuda:3')
benign distance is  tensor(124.4685, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.485103040933609
distance x is tensor(141.3679, device='cuda:3')
benign distance is  tensor(141.3679, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.4190800189971924
distance x is tensor(140.2084, device='cuda:3')
benign distance is  tensor(140.2084, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.3717220425605774
distance x is tensor(135.3117, device='cuda:3')
benign distance is  tensor(135.3117, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.19606468081474304
distance x is tensor(140.2613, device='cuda:3')
benign distance is  tensor(140.2613, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.4437188506126404
distance x is tensor(131.2572, device='cuda:3')
benign distance is  tensor(131.2572, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.347257137298584
distance x is tensor(113.7532, device='cuda:3')
benign distance is  tensor(113.7532, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.24446435272693634
distance x is tensor(130.1892, device='cuda:3')
benign distance is  tensor(130.1892, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.305670827627182
distance x is tensor(132.2455, device='cuda:3')
benign distance is  tensor(132.2455, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(136.1499, device='cuda:3')
compute distance is  tensor(136.1499, device='cuda:3')
compute norm is  tensor(54.2273, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.3213, device='cuda:3')
compute distance is  tensor(131.3213, device='cuda:3')
compute norm is  tensor(54.1121, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.1308, device='cuda:3')
compute distance is  tensor(141.1308, device='cuda:3')
compute norm is  tensor(54.4056, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.6944, device='cuda:3')
compute distance is  tensor(129.6944, device='cuda:3')
compute norm is  tensor(54.2343, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.3324, device='cuda:3')
compute distance is  tensor(138.3324, device='cuda:3')
compute norm is  tensor(54.2018, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.1381, device='cuda:3')
compute distance is  tensor(142.1381, device='cuda:3')
compute norm is  tensor(54.4922, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.3837, device='cuda:3')
compute distance is  tensor(132.3837, device='cuda:3')
compute norm is  tensor(54.2446, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.7419, device='cuda:3')
compute distance is  tensor(141.7419, device='cuda:3')
compute norm is  tensor(54.4023, device='cuda:3', dtype=torch.float64)
distance x is tensor(143.4681, device='cuda:3')
compute distance is  tensor(143.4681, device='cuda:3')
compute norm is  tensor(54.4417, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.1694, device='cuda:3')
compute distance is  tensor(130.1694, device='cuda:3')
compute norm is  tensor(54.2113, device='cuda:3', dtype=torch.float64)
distance x is tensor(141.4642, device='cuda:3')
compute distance is  tensor(141.4642, device='cuda:3')
compute norm is  tensor(54.4249, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.0815, device='cuda:3')
compute distance is  tensor(133.0815, device='cuda:3')
compute norm is  tensor(54.3415, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(143.4681, device='cuda:3')
distance x is tensor(107757.0234, device='cuda:3')
distance x is tensor(107757.0234, device='cuda:3')
________________________________
test distance is  tensor(107757.0234, device='cuda:3')
test distance1 is  tensor(107757.0234, device='cuda:3')
test similarity is  tensor(-0.1084, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130128619237000.45
test entropy is  0.0
________________________________
cal ratio is  0.035758632688740126
distance x is tensor(3853.2498, device='cuda:3')
cal_distance is  tensor(3853.2498, device='cuda:3')
cal ratio is  0.18909938018270844
distance x is tensor(728.6514, device='cuda:3')
cal_distance is  tensor(728.6514, device='cuda:3')
cal ratio is  0.43485433232531157
distance x is tensor(316.8601, device='cuda:3')
cal_distance is  tensor(316.8601, device='cuda:3')
cal ratio is  0.6594317948618191
distance x is tensor(208.9494, device='cuda:3')
cal_distance is  tensor(208.9494, device='cuda:3')
cal ratio is  0.8120505675527908
distance x is tensor(169.6785, device='cuda:3')
cal_distance is  tensor(169.6785, device='cuda:3')
cal ratio is  0.9011358619376083
distance x is tensor(152.9039, device='cuda:3')
cal_distance is  tensor(152.9039, device='cuda:3')
cal ratio is  0.9492801182002335
distance x is tensor(145.1489, device='cuda:3')
cal_distance is  tensor(145.1489, device='cuda:3')
cal ratio is  0.9743091058624854
distance x is tensor(141.4201, device='cuda:3')
cal_distance is  tensor(141.4201, device='cuda:3')
distance x is tensor(141.4201, device='cuda:3')
return_distance is  tensor(141.4201, device='cuda:3')
distance x is tensor(141.4096, device='cuda:3')
distance x is tensor(141.4096, device='cuda:3')
________________________________
test distance is  tensor(141.4096, device='cuda:3')
test distance1 is  tensor(141.4096, device='cuda:3')
test similarity is  tensor(0.9540, device='cuda:3')
test acc is  0.10025000015633198
test loss is 308.82888076554485
test entropy is  3.358983266999653e-05
________________________________
0
distance x is tensor(141.4096, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  7.287389815150019e-05
avg test loss is  308.7460631348177
avg accuracy is  0.4329166668230081
solo acc is  0.10028333348966531
compute similarity  is  tensor(0.9540, device='cuda:3')
compute_distance is  tensor(141.4096, device='cuda:3')
compute_norm is  tensor(53.1138, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(124.1012, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9419113060177516
avg test loss is  1.5345395936894772
avg accuracy is  0.8287000001563241
solo acc is  0.3395333334896736
compute similarity  is  tensor(0.9593, device='cuda:3')
compute_distance is  tensor(124.1012, device='cuda:3')
compute_norm is  tensor(51.8266, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(127.0944, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8811410182574665
avg test loss is  1.6095396580218253
avg accuracy is  0.8276333334896574
solo acc is  0.27793333348967225
compute similarity  is  tensor(0.9588, device='cuda:3')
compute_distance is  tensor(127.0944, device='cuda:3')
compute_norm is  tensor(51.4629, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(129.6636, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.872895503412686
avg test loss is  1.5529503941790128
avg accuracy is  0.8329000001563239
solo acc is  0.27801666682300563
compute similarity  is  tensor(0.9584, device='cuda:3')
compute_distance is  tensor(129.6636, device='cuda:3')
compute_norm is  tensor(51.1338, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(132.0978, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8664599538230693
avg test loss is  1.510875738887136
avg accuracy is  0.8382166668229903
solo acc is  0.2746333334896723
compute similarity  is  tensor(0.9580, device='cuda:3')
compute_distance is  tensor(132.0978, device='cuda:3')
compute_norm is  tensor(50.8266, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.5447, device='cuda:3')
distance x is tensor(134.5447, device='cuda:3')
________________________________
test distance is  tensor(134.5447, device='cuda:3')
test distance1 is  tensor(134.5447, device='cuda:3')
test similarity is  tensor(0.9576, device='cuda:3')
test acc is  0.28650000015633925
test loss is 1.4389235209554498
test entropy is  0.8834429653341582
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.2513253688812256
mal norm is  tensor(682.4691, device='cuda:3')
distance x is tensor(134.5522, device='cuda:3')
mal distance is  tensor(134.5522, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 20.02% 

Test Accuracy: 19.98% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7807700634002686
distance x is tensor(172.4173, device='cuda:3')
benign distance is  tensor(172.4173, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5073559880256653
distance x is tensor(168.9032, device='cuda:3')
benign distance is  tensor(168.9032, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.17341871559619904
distance x is tensor(173.8048, device='cuda:3')
benign distance is  tensor(173.8048, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.340730220079422
distance x is tensor(173.5843, device='cuda:3')
benign distance is  tensor(173.5843, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6089249849319458
distance x is tensor(157.5681, device='cuda:3')
benign distance is  tensor(157.5681, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5777592658996582
distance x is tensor(169.9857, device='cuda:3')
benign distance is  tensor(169.9857, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4050668776035309
distance x is tensor(168.0875, device='cuda:3')
benign distance is  tensor(168.0875, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.38055291771888733
distance x is tensor(169.0472, device='cuda:3')
benign distance is  tensor(169.0472, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(168.0698, device='cuda:3')
compute distance is  tensor(168.0698, device='cuda:3')
compute norm is  tensor(52.3084, device='cuda:3', dtype=torch.float64)
distance x is tensor(158.9296, device='cuda:3')
compute distance is  tensor(158.9296, device='cuda:3')
compute norm is  tensor(52.1615, device='cuda:3', dtype=torch.float64)
distance x is tensor(171.6111, device='cuda:3')
compute distance is  tensor(171.6111, device='cuda:3')
compute norm is  tensor(52.6942, device='cuda:3', dtype=torch.float64)
distance x is tensor(184.4749, device='cuda:3')
compute distance is  tensor(184.4749, device='cuda:3')
compute norm is  tensor(52.6697, device='cuda:3', dtype=torch.float64)
distance x is tensor(190.6158, device='cuda:3')
compute distance is  tensor(190.6158, device='cuda:3')
compute norm is  tensor(52.8659, device='cuda:3', dtype=torch.float64)
distance x is tensor(169.0974, device='cuda:3')
compute distance is  tensor(169.0974, device='cuda:3')
compute norm is  tensor(52.6223, device='cuda:3', dtype=torch.float64)
distance x is tensor(175.8862, device='cuda:3')
compute distance is  tensor(175.8862, device='cuda:3')
compute norm is  tensor(52.6358, device='cuda:3', dtype=torch.float64)
distance x is tensor(169.5777, device='cuda:3')
compute distance is  tensor(169.5777, device='cuda:3')
compute norm is  tensor(52.5256, device='cuda:3', dtype=torch.float64)
distance x is tensor(162.6265, device='cuda:3')
compute distance is  tensor(162.6265, device='cuda:3')
compute norm is  tensor(52.4200, device='cuda:3', dtype=torch.float64)
distance x is tensor(184.2398, device='cuda:3')
compute distance is  tensor(184.2398, device='cuda:3')
compute norm is  tensor(52.7835, device='cuda:3', dtype=torch.float64)
distance x is tensor(176.4825, device='cuda:3')
compute distance is  tensor(176.4825, device='cuda:3')
compute norm is  tensor(52.8210, device='cuda:3', dtype=torch.float64)
distance x is tensor(175.3797, device='cuda:3')
compute distance is  tensor(175.3797, device='cuda:3')
compute norm is  tensor(52.6693, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(190.6158, device='cuda:3')
distance x is tensor(107679.3594, device='cuda:3')
distance x is tensor(107679.3594, device='cuda:3')
________________________________
test distance is  tensor(107679.3594, device='cuda:3')
test distance1 is  tensor(107679.3594, device='cuda:3')
test similarity is  tensor(0.1428, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130047772864800.2
test entropy is  0.0
________________________________
cal ratio is  0.04123246754147804
distance x is tensor(4439.8906, device='cuda:3')
cal_distance is  tensor(4439.8906, device='cuda:3')
cal ratio is  0.20305768224951432
distance x is tensor(901.5581, device='cuda:3')
cal_distance is  tensor(901.5581, device='cuda:3')
cal ratio is  0.45061816025144846
distance x is tensor(406.2613, device='cuda:3')
cal_distance is  tensor(406.2613, device='cuda:3')
cal ratio is  0.6712786523202124
distance x is tensor(272.7163, device='cuda:3')
cal_distance is  tensor(272.7163, device='cuda:3')
cal ratio is  0.819313357585633
distance x is tensor(223.4410, device='cuda:3')
cal_distance is  tensor(223.4410, device='cuda:3')
cal ratio is  0.9051574292431233
distance x is tensor(202.2498, device='cuda:3')
cal_distance is  tensor(202.2498, device='cuda:3')
cal ratio is  0.9513964697149847
distance x is tensor(192.4200, device='cuda:3')
cal_distance is  tensor(192.4200, device='cuda:3')
cal ratio is  0.9753948868309719
distance x is tensor(187.6856, device='cuda:3')
cal_distance is  tensor(187.6856, device='cuda:3')
distance x is tensor(187.6856, device='cuda:3')
return_distance is  tensor(187.6856, device='cuda:3')
distance x is tensor(187.6752, device='cuda:3')
distance x is tensor(187.6752, device='cuda:3')
________________________________
test distance is  tensor(187.6752, device='cuda:3')
test distance1 is  tensor(187.6752, device='cuda:3')
test similarity is  tensor(0.9305, device='cuda:3')
test acc is  0.10000000015633198
test loss is 1337.3292997640842
test entropy is  0.0
________________________________
0
distance x is tensor(187.6752, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  1338.4771072615438
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9305, device='cuda:3')
compute_distance is  tensor(187.6752, device='cuda:3')
compute_norm is  tensor(54.6623, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1082.4326, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.604011112184667
avg test loss is  2.8842935897648205
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4438, device='cuda:3')
compute_distance is  tensor(1082.4326, device='cuda:3')
compute_norm is  tensor(115.4638, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1077.8531, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.857720099214806
avg test loss is  3.705519808380843
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4438, device='cuda:3')
compute_distance is  tensor(1077.8531, device='cuda:3')
compute_norm is  tensor(115.0536, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1073.4364, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5757086066040658
avg test loss is  2.8554042636204375
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4436, device='cuda:3')
compute_distance is  tensor(1073.4364, device='cuda:3')
compute_norm is  tensor(114.4249, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1068.9341, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8447240871279987
avg test loss is  3.65008072278647
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4437, device='cuda:3')
compute_distance is  tensor(1068.9341, device='cuda:3')
compute_norm is  tensor(114.0231, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1064.4420, device='cuda:3')
distance x is tensor(1064.4420, device='cuda:3')
________________________________
test distance is  tensor(1064.4420, device='cuda:3')
test distance1 is  tensor(1064.4420, device='cuda:3')
test similarity is  tensor(0.4435, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.86464955786398
test entropy is  1.5546575608029802
________________________________
cal ratio is  0.41471004288982594
distance x is tensor(441.4360, device='cuda:3')
cal_distance is  tensor(441.4360, device='cuda:3')
cal ratio is  0.6439789697229814
distance x is tensor(284.2758, device='cuda:3')
cal_distance is  tensor(284.2758, device='cuda:3')
cal ratio is  0.8024826516596568
distance x is tensor(228.1266, device='cuda:3')
cal_distance is  tensor(228.1266, device='cuda:3')
cal ratio is  0.8958135211054883
distance x is tensor(204.3589, device='cuda:3')
cal_distance is  tensor(204.3589, device='cuda:3')
cal ratio is  0.9464741195141995
distance x is tensor(193.4205, device='cuda:3')
cal_distance is  tensor(193.4205, device='cuda:3')
cal ratio is  0.9728688391679483
distance x is tensor(188.1728, device='cuda:3')
cal_distance is  tensor(188.1728, device='cuda:3')
distance x is tensor(188.1728, device='cuda:3')
return_distance is  tensor(188.1728, device='cuda:3')
distance x is tensor(188.1711, device='cuda:3')
distance x is tensor(188.1711, device='cuda:3')
________________________________
test distance is  tensor(188.1711, device='cuda:3')
test distance1 is  tensor(188.1711, device='cuda:3')
test similarity is  tensor(0.9342, device='cuda:3')
test acc is  0.09466666682299867
test loss is 2.754723458656116
test entropy is  1.90211957375378
________________________________
0
distance x is tensor(188.1711, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.902682037495855
avg test loss is  2.755216993756894
avg accuracy is  0.10131666682299864
solo acc is  0.09613333348966531
compute similarity  is  tensor(0.9342, device='cuda:3')
compute_distance is  tensor(188.1711, device='cuda:3')
compute_norm is  tensor(55.7570, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(188.6842, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7282209017002252
avg test loss is  3.1109526836033314
avg accuracy is  0.10025000015633198
solo acc is  0.1007333334896653
compute similarity  is  tensor(0.9340, device='cuda:3')
compute_distance is  tensor(188.6842, device='cuda:3')
compute_norm is  tensor(55.6067, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(191.7186, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.1085350756833294
avg test loss is  1.7786592167577764
avg accuracy is  0.10538333348966529
solo acc is  0.20911666682300345
compute similarity  is  tensor(0.9337, device='cuda:3')
compute_distance is  tensor(191.7186, device='cuda:3')
compute_norm is  tensor(55.2369, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(191.6373, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.656613517036316
avg test loss is  2.568030264331842
avg accuracy is  0.10206666682299863
solo acc is  0.10753333348966529
compute similarity  is  tensor(0.9335, device='cuda:3')
compute_distance is  tensor(191.6373, device='cuda:3')
compute_norm is  tensor(55.0269, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(193.9714, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.0317918852702388
avg test loss is  1.6438777900453825
avg accuracy is  0.10725000015633196
solo acc is  0.224716666823004
compute similarity  is  tensor(0.9331, device='cuda:3')
compute_distance is  tensor(193.9714, device='cuda:3')
compute_norm is  tensor(54.7086, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(193.8822, device='cuda:3')
distance x is tensor(193.8822, device='cuda:3')
________________________________
test distance is  tensor(193.8822, device='cuda:3')
test distance1 is  tensor(193.8822, device='cuda:3')
test similarity is  tensor(0.9329, device='cuda:3')
test acc is  0.10561666682299864
test loss is 2.455659322392966
test entropy is  0.628471947618639
________________________________
cal ratio is  0.9717098103915741
distance x is tensor(188.3972, device='cuda:3')
cal_distance is  tensor(188.3972, device='cuda:3')
distance x is tensor(188.3972, device='cuda:3')
return_distance is  tensor(188.3972, device='cuda:3')
distance x is tensor(188.3972, device='cuda:3')
distance x is tensor(188.3972, device='cuda:3')
________________________________
test distance is  tensor(188.3972, device='cuda:3')
test distance1 is  tensor(188.3972, device='cuda:3')
test similarity is  tensor(0.9363, device='cuda:3')
test acc is  0.10495000015633196
test loss is 2.526326095117435
test entropy is  0.6014264861403752
________________________________
0
distance x is tensor(188.3972, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6039714644522046
avg test loss is  2.5212422807587744
avg accuracy is  0.1027833334896653
solo acc is  0.10486666682299862
compute similarity  is  tensor(0.9363, device='cuda:3')
compute_distance is  tensor(188.3972, device='cuda:3')
compute_norm is  tensor(54.2952, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(190.8184, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.014951659036852
avg test loss is  1.5625300726402542
avg accuracy is  0.11000000015633193
solo acc is  0.23166666682300432
compute similarity  is  tensor(0.9358, device='cuda:3')
compute_distance is  tensor(190.8184, device='cuda:3')
compute_norm is  tensor(53.9969, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(190.8507, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6046313160200363
avg test loss is  2.398333087913009
avg accuracy is  0.10405000015633196
solo acc is  0.10461666682299864
compute similarity  is  tensor(0.9356, device='cuda:3')
compute_distance is  tensor(190.8507, device='cuda:3')
compute_norm is  tensor(53.7884, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(192.9760, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.98247421925256
avg test loss is  1.4862622797870433
avg accuracy is  0.1118666668229986
solo acc is  0.24823333348967153
compute similarity  is  tensor(0.9351, device='cuda:3')
compute_distance is  tensor(192.9760, device='cuda:3')
compute_norm is  tensor(53.4912, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(192.9756, device='cuda:3')
________________________________
test distance is  tensor(192.9756, device='cuda:3')
test similarity is  tensor(0.9351, device='cuda:3')
test acc is  0.11238333348966527
test loss is 1.482081311089652
test entropy is  0.982880704374964
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.233209252357483
mal norm is  tensor(844.9966, device='cuda:3')
distance x is tensor(192.9756, device='cuda:3')
mal distance is  tensor(192.9756, device='cuda:3')
user_PLR len size 44
counter_tensor is  tensor([13., 12., 15., 12., 38.,  5.,  3., 12., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 43., 22., 12., 12., 41., 39., 19., 42.,
        42.,  0., 30., 12., 12., 43., 33., 35., 12., 12., 42., 12., 12., 41.,
         0.,  0.])
count_res tensor([2.7523e-14, 1.0125e-14, 2.0337e-13, 1.0125e-14, 1.9818e-03, 9.2329e-18,
        1.2495e-18, 1.0125e-14, 4.9123e-06, 4.9123e-06, 4.9123e-06, 4.9123e-06,
        4.9123e-06, 4.9123e-06, 4.9123e-06, 4.9123e-06, 4.9123e-06, 4.9123e-06,
        4.9123e-06, 4.9123e-06, 2.9412e-01, 2.2302e-10, 1.0125e-14, 1.0125e-14,
        3.9805e-02, 5.3870e-03, 1.1104e-11, 1.0820e-01, 1.0820e-01, 6.2211e-20,
        6.6481e-07, 1.0125e-14, 1.0125e-14, 2.9412e-01, 1.3353e-05, 9.8667e-05,
        1.0125e-14, 1.0125e-14, 1.0820e-01, 1.0125e-14, 1.0125e-14, 3.9805e-02,
        6.2211e-20, 6.2211e-20])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 89.83% 

Test Accuracy: 89.01% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2831851541996002
distance x is tensor(121.3015, device='cuda:3')
benign distance is  tensor(121.3015, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5839856863021851
distance x is tensor(90.1162, device='cuda:3')
benign distance is  tensor(90.1162, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1725979745388031
distance x is tensor(132.9595, device='cuda:3')
benign distance is  tensor(132.9595, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.41777682304382324
distance x is tensor(114.0054, device='cuda:3')
benign distance is  tensor(114.0054, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8233763575553894
distance x is tensor(89.7344, device='cuda:3')
benign distance is  tensor(89.7344, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5628060102462769
distance x is tensor(125.6539, device='cuda:3')
benign distance is  tensor(125.6539, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.31009596586227417
distance x is tensor(109.9385, device='cuda:3')
benign distance is  tensor(109.9385, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.09184227883815765
distance x is tensor(125.4793, device='cuda:3')
benign distance is  tensor(125.4793, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.538935124874115
distance x is tensor(133.0499, device='cuda:3')
benign distance is  tensor(133.0499, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7451618313789368
distance x is tensor(129.1250, device='cuda:3')
benign distance is  tensor(129.1250, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0622284412384033
distance x is tensor(109.4478, device='cuda:3')
benign distance is  tensor(109.4478, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.5390765070915222
distance x is tensor(125.5052, device='cuda:3')
benign distance is  tensor(125.5052, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.20985905826091766
distance x is tensor(129.9146, device='cuda:3')
benign distance is  tensor(129.9146, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.496980756521225
distance x is tensor(114.9985, device='cuda:3')
benign distance is  tensor(114.9985, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0843353271484375
distance x is tensor(138.8676, device='cuda:3')
benign distance is  tensor(138.8676, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.45280274748802185
distance x is tensor(128.6574, device='cuda:3')
benign distance is  tensor(128.6574, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.299334317445755
distance x is tensor(115.7981, device='cuda:3')
benign distance is  tensor(115.7981, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.3889099955558777
distance x is tensor(144.9952, device='cuda:3')
benign distance is  tensor(144.9952, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.41947808861732483
distance x is tensor(123.0803, device='cuda:3')
benign distance is  tensor(123.0803, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.3527637720108032
distance x is tensor(128.3243, device='cuda:3')
benign distance is  tensor(128.3243, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.20235943794250488
distance x is tensor(119.5944, device='cuda:3')
benign distance is  tensor(119.5944, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.1032936573028564
distance x is tensor(82.8288, device='cuda:3')
benign distance is  tensor(82.8288, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.5798517465591431
distance x is tensor(122.3821, device='cuda:3')
benign distance is  tensor(122.3821, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.42890414595603943
distance x is tensor(109.7730, device='cuda:3')
benign distance is  tensor(109.7730, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.8617717623710632
distance x is tensor(127.2119, device='cuda:3')
benign distance is  tensor(127.2119, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.42976588010787964
distance x is tensor(114.6697, device='cuda:3')
benign distance is  tensor(114.6697, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.029868096113204956
distance x is tensor(132.7144, device='cuda:3')
benign distance is  tensor(132.7144, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.23892173171043396
distance x is tensor(135.4633, device='cuda:3')
benign distance is  tensor(135.4633, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.4299730360507965
distance x is tensor(137.1313, device='cuda:3')
benign distance is  tensor(137.1313, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.5087339878082275
distance x is tensor(131.9150, device='cuda:3')
benign distance is  tensor(131.9150, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.6749442219734192
distance x is tensor(132.5796, device='cuda:3')
benign distance is  tensor(132.5796, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5489175915718079
distance x is tensor(129.5429, device='cuda:3')
benign distance is  tensor(129.5429, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(122.0818, device='cuda:3')
compute distance is  tensor(122.0818, device='cuda:3')
compute norm is  tensor(54.1626, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.6622, device='cuda:3')
compute distance is  tensor(123.6622, device='cuda:3')
compute norm is  tensor(54.0792, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.1353, device='cuda:3')
compute distance is  tensor(131.1353, device='cuda:3')
compute norm is  tensor(54.2421, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.1482, device='cuda:3')
compute distance is  tensor(129.1482, device='cuda:3')
compute norm is  tensor(54.2974, device='cuda:3', dtype=torch.float64)
distance x is tensor(119.0296, device='cuda:3')
compute distance is  tensor(119.0296, device='cuda:3')
compute norm is  tensor(54.0796, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.3304, device='cuda:3')
compute distance is  tensor(131.3304, device='cuda:3')
compute norm is  tensor(54.4185, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.4700, device='cuda:3')
compute distance is  tensor(129.4700, device='cuda:3')
compute norm is  tensor(54.1622, device='cuda:3', dtype=torch.float64)
distance x is tensor(136.7332, device='cuda:3')
compute distance is  tensor(136.7332, device='cuda:3')
compute norm is  tensor(54.3132, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.8316, device='cuda:3')
compute distance is  tensor(125.8316, device='cuda:3')
compute norm is  tensor(54.0949, device='cuda:3', dtype=torch.float64)
distance x is tensor(123.2201, device='cuda:3')
compute distance is  tensor(123.2201, device='cuda:3')
compute norm is  tensor(54.1351, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.6904, device='cuda:3')
compute distance is  tensor(139.6904, device='cuda:3')
compute norm is  tensor(54.5017, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.8099, device='cuda:3')
compute distance is  tensor(120.8099, device='cuda:3')
compute norm is  tensor(54.0642, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(139.6904, device='cuda:3')
distance x is tensor(107759.4609, device='cuda:3')
distance x is tensor(107759.4609, device='cuda:3')
________________________________
test distance is  tensor(107759.4609, device='cuda:3')
test distance1 is  tensor(107759.4609, device='cuda:3')
test similarity is  tensor(-0.1079, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130084263434803.31
test entropy is  0.0
________________________________
cal ratio is  0.03528431566172664
distance x is tensor(3802.2244, device='cuda:3')
cal_distance is  tensor(3802.2244, device='cuda:3')
cal ratio is  0.18784105946193058
distance x is tensor(714.2181, device='cuda:3')
cal_distance is  tensor(714.2181, device='cuda:3')
cal ratio is  0.43340506010079927
distance x is tensor(309.5487, device='cuda:3')
cal_distance is  tensor(309.5487, device='cuda:3')
cal ratio is  0.6583319033735978
distance x is tensor(203.7876, device='cuda:3')
cal_distance is  tensor(203.7876, device='cuda:3')
cal ratio is  0.8113729831451281
distance x is tensor(165.3488, device='cuda:3')
cal_distance is  tensor(165.3488, device='cuda:3')
cal ratio is  0.9007596859894224
distance x is tensor(148.9400, device='cuda:3')
cal_distance is  tensor(148.9400, device='cuda:3')
cal ratio is  0.9490819724920575
distance x is tensor(141.3565, device='cuda:3')
cal_distance is  tensor(141.3565, device='cuda:3')
cal ratio is  0.9742074565951758
distance x is tensor(137.7108, device='cuda:3')
cal_distance is  tensor(137.7108, device='cuda:3')
distance x is tensor(137.7108, device='cuda:3')
return_distance is  tensor(137.7108, device='cuda:3')
distance x is tensor(137.7003, device='cuda:3')
distance x is tensor(137.7003, device='cuda:3')
________________________________
test distance is  tensor(137.7003, device='cuda:3')
test distance1 is  tensor(137.7003, device='cuda:3')
test similarity is  tensor(0.9563, device='cuda:3')
test acc is  0.10030000015633199
test loss is 275.38937864323924
test entropy is  4.480164409322807e-05
________________________________
0
distance x is tensor(137.7003, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  5.234706936973906e-05
avg test loss is  275.8414966444979
avg accuracy is  0.4760333334896752
solo acc is  0.1002833334896653
compute similarity  is  tensor(0.9563, device='cuda:3')
compute_distance is  tensor(137.7003, device='cuda:3')
compute_norm is  tensor(53.1412, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(123.2455, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9612257940682776
avg test loss is  1.5399798946594125
avg accuracy is  0.8162500001563247
solo acc is  0.3435333334896737
compute similarity  is  tensor(0.9610, device='cuda:3')
compute_distance is  tensor(123.2455, device='cuda:3')
compute_norm is  tensor(51.7874, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(126.2216, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8959872834463872
avg test loss is  1.59127008228668
avg accuracy is  0.8201000001563244
solo acc is  0.29141666682300604
compute similarity  is  tensor(0.9605, device='cuda:3')
compute_distance is  tensor(126.2216, device='cuda:3')
compute_norm is  tensor(51.4143, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(128.9003, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8638133017111943
avg test loss is  1.5808288301232019
avg accuracy is  0.8247500001563243
solo acc is  0.2694833334896721
compute similarity  is  tensor(0.9601, device='cuda:3')
compute_distance is  tensor(128.9003, device='cuda:3')
compute_norm is  tensor(51.0802, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(131.3956, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8560646579845119
avg test loss is  1.552652796448421
avg accuracy is  0.8303166668229908
solo acc is  0.26128333348967187
compute similarity  is  tensor(0.9597, device='cuda:3')
compute_distance is  tensor(131.3956, device='cuda:3')
compute_norm is  tensor(50.7693, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(133.6756, device='cuda:3')
distance x is tensor(133.6756, device='cuda:3')
________________________________
test distance is  tensor(133.6756, device='cuda:3')
test distance1 is  tensor(133.6756, device='cuda:3')
test similarity is  tensor(0.9593, device='cuda:3')
test acc is  0.2847000001563392
test loss is 1.447625229734856
test entropy is  0.8807844377275723
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.3815202713012695
mal norm is  tensor(669.0617, device='cuda:3')
distance x is tensor(133.6827, device='cuda:3')
mal distance is  tensor(133.6827, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 19.72% 

Test Accuracy: 19.07% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6367157101631165
distance x is tensor(172.6670, device='cuda:3')
benign distance is  tensor(172.6670, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5212922096252441
distance x is tensor(156.5506, device='cuda:3')
benign distance is  tensor(156.5506, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.10201916843652725
distance x is tensor(173.5213, device='cuda:3')
benign distance is  tensor(173.5213, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5982365012168884
distance x is tensor(162.9034, device='cuda:3')
benign distance is  tensor(162.9034, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7049061059951782
distance x is tensor(152.5709, device='cuda:3')
benign distance is  tensor(152.5709, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5321139097213745
distance x is tensor(166.8878, device='cuda:3')
benign distance is  tensor(166.8878, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5412988662719727
distance x is tensor(178.3171, device='cuda:3')
benign distance is  tensor(178.3171, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.45214980840682983
distance x is tensor(174.4864, device='cuda:3')
benign distance is  tensor(174.4864, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(166.6282, device='cuda:3')
compute distance is  tensor(166.6282, device='cuda:3')
compute norm is  tensor(52.2364, device='cuda:3', dtype=torch.float64)
distance x is tensor(177.1826, device='cuda:3')
compute distance is  tensor(177.1826, device='cuda:3')
compute norm is  tensor(52.5560, device='cuda:3', dtype=torch.float64)
distance x is tensor(189.7103, device='cuda:3')
compute distance is  tensor(189.7103, device='cuda:3')
compute norm is  tensor(53.0415, device='cuda:3', dtype=torch.float64)
distance x is tensor(167.2386, device='cuda:3')
compute distance is  tensor(167.2386, device='cuda:3')
compute norm is  tensor(52.5204, device='cuda:3', dtype=torch.float64)
distance x is tensor(172.0358, device='cuda:3')
compute distance is  tensor(172.0358, device='cuda:3')
compute norm is  tensor(52.5974, device='cuda:3', dtype=torch.float64)
distance x is tensor(174.6038, device='cuda:3')
compute distance is  tensor(174.6038, device='cuda:3')
compute norm is  tensor(52.6468, device='cuda:3', dtype=torch.float64)
distance x is tensor(183.7843, device='cuda:3')
compute distance is  tensor(183.7843, device='cuda:3')
compute norm is  tensor(52.6014, device='cuda:3', dtype=torch.float64)
distance x is tensor(176.7287, device='cuda:3')
compute distance is  tensor(176.7287, device='cuda:3')
compute norm is  tensor(52.7037, device='cuda:3', dtype=torch.float64)
distance x is tensor(175.2249, device='cuda:3')
compute distance is  tensor(175.2249, device='cuda:3')
compute norm is  tensor(52.4758, device='cuda:3', dtype=torch.float64)
distance x is tensor(165.0691, device='cuda:3')
compute distance is  tensor(165.0691, device='cuda:3')
compute norm is  tensor(52.4252, device='cuda:3', dtype=torch.float64)
distance x is tensor(185.9787, device='cuda:3')
compute distance is  tensor(185.9787, device='cuda:3')
compute norm is  tensor(52.7870, device='cuda:3', dtype=torch.float64)
distance x is tensor(164.2986, device='cuda:3')
compute distance is  tensor(164.2986, device='cuda:3')
compute norm is  tensor(52.4291, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(189.7103, device='cuda:3')
distance x is tensor(107684.7422, device='cuda:3')
distance x is tensor(107684.7422, device='cuda:3')
________________________________
test distance is  tensor(107684.7422, device='cuda:3')
test distance1 is  tensor(107684.7422, device='cuda:3')
test similarity is  tensor(0.1350, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130034914783205.8
test entropy is  0.0
________________________________
cal ratio is  0.041133382470985615
distance x is tensor(4429.4434, device='cuda:3')
cal_distance is  tensor(4429.4434, device='cuda:3')
cal ratio is  0.20281353223593815
distance x is tensor(898.3553, device='cuda:3')
cal_distance is  tensor(898.3553, device='cuda:3')
cal ratio is  0.45034717652640804
distance x is tensor(404.5746, device='cuda:3')
cal_distance is  tensor(404.5746, device='cuda:3')
cal ratio is  0.6710767298128824
distance x is tensor(271.5023, device='cuda:3')
cal_distance is  tensor(271.5023, device='cuda:3')
cal ratio is  0.8191901699321553
distance x is tensor(222.4130, device='cuda:3')
cal_distance is  tensor(222.4130, device='cuda:3')
cal ratio is  0.9050893146480106
distance x is tensor(201.3041, device='cuda:3')
cal_distance is  tensor(201.3041, device='cuda:3')
cal ratio is  0.9513605784008663
distance x is tensor(191.5131, device='cuda:3')
cal_distance is  tensor(191.5131, device='cuda:3')
cal ratio is  0.9753765465541899
distance x is tensor(186.7975, device='cuda:3')
cal_distance is  tensor(186.7975, device='cuda:3')
distance x is tensor(186.7975, device='cuda:3')
return_distance is  tensor(186.7975, device='cuda:3')
distance x is tensor(186.7870, device='cuda:3')
distance x is tensor(186.7870, device='cuda:3')
________________________________
test distance is  tensor(186.7870, device='cuda:3')
test distance1 is  tensor(186.7870, device='cuda:3')
test similarity is  tensor(0.9304, device='cuda:3')
test acc is  0.10000000015633198
test loss is 1220.7417058558353
test entropy is  0.0
________________________________
0
distance x is tensor(186.7870, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  1219.980812251695
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9304, device='cuda:3')
compute_distance is  tensor(186.7870, device='cuda:3')
compute_norm is  tensor(54.4651, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1243.2526, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.5895326963619891
avg test loss is  2.8650529229564707
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3630, device='cuda:3')
compute_distance is  tensor(1243.2526, device='cuda:3')
compute_norm is  tensor(131.9099, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1237.9055, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8447495827288516
avg test loss is  3.6697693445535102
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3631, device='cuda:3')
compute_distance is  tensor(1237.9055, device='cuda:3')
compute_norm is  tensor(131.4861, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1232.5432, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.565010968428939
avg test loss is  2.859276050697766
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3629, device='cuda:3')
compute_distance is  tensor(1232.5432, device='cuda:3')
compute_norm is  tensor(130.6943, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1227.2865, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8329961876879369
avg test loss is  3.6463855565992245
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3631, device='cuda:3')
compute_distance is  tensor(1227.2865, device='cuda:3')
compute_norm is  tensor(130.2799, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1221.9158, device='cuda:3')
distance x is tensor(1221.9158, device='cuda:3')
________________________________
test distance is  tensor(1221.9158, device='cuda:3')
test distance1 is  tensor(1221.9158, device='cuda:3')
test similarity is  tensor(0.3629, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8626634098573533
test entropy is  1.5559145629024709
________________________________
cal ratio is  0.3861454135920621
distance x is tensor(471.8380, device='cuda:3')
cal_distance is  tensor(471.8380, device='cuda:3')
cal ratio is  0.6214054185930329
distance x is tensor(293.2030, device='cuda:3')
cal_distance is  tensor(293.2030, device='cuda:3')
cal ratio is  0.7882923698434927
distance x is tensor(231.1298, device='cuda:3')
cal_distance is  tensor(231.1298, device='cuda:3')
cal ratio is  0.8878580507746855
distance x is tensor(205.2106, device='cuda:3')
cal_distance is  tensor(205.2106, device='cuda:3')
cal ratio is  0.942261938352452
distance x is tensor(193.3621, device='cuda:3')
cal_distance is  tensor(193.3621, device='cuda:3')
cal ratio is  0.9707017933151351
distance x is tensor(187.6970, device='cuda:3')
cal_distance is  tensor(187.6970, device='cuda:3')
distance x is tensor(187.6970, device='cuda:3')
return_distance is  tensor(187.6970, device='cuda:3')
distance x is tensor(187.6957, device='cuda:3')
distance x is tensor(187.6957, device='cuda:3')
________________________________
test distance is  tensor(187.6957, device='cuda:3')
test distance1 is  tensor(187.6957, device='cuda:3')
test similarity is  tensor(0.9135, device='cuda:3')
test acc is  0.09628333348966533
test loss is 2.9951451020454294
test entropy is  1.7471528648059251
________________________________
0
distance x is tensor(187.6957, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.746767052582332
avg test loss is  2.9926666806755797
avg accuracy is  0.12030000015633192
solo acc is  0.09691666682299865
compute similarity  is  tensor(0.9135, device='cuda:3')
compute_distance is  tensor(187.6957, device='cuda:3')
compute_norm is  tensor(57.0632, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(189.9504, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7530236852321543
avg test loss is  3.0196661606017967
avg accuracy is  0.10973333348966527
solo acc is  0.10246666682299864
compute similarity  is  tensor(0.9132, device='cuda:3')
compute_distance is  tensor(189.9504, device='cuda:3')
compute_norm is  tensor(56.8791, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(193.4203, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.118622903694222
avg test loss is  1.822345233166904
avg accuracy is  0.1269000001563319
solo acc is  0.19633333348966953
compute similarity  is  tensor(0.9127, device='cuda:3')
compute_distance is  tensor(193.4203, device='cuda:3')
compute_norm is  tensor(56.5497, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(193.4850, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.660288096236776
avg test loss is  2.6305716175006144
avg accuracy is  0.11280000015633193
solo acc is  0.10356666682299863
compute similarity  is  tensor(0.9125, device='cuda:3')
compute_distance is  tensor(193.4850, device='cuda:3')
compute_norm is  tensor(56.3662, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(195.5677, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  1.085820921575591
avg test loss is  1.737943438070415
avg accuracy is  0.12856666682299858
solo acc is  0.1827666668230021
compute similarity  is  tensor(0.9121, device='cuda:3')
compute_distance is  tensor(195.5677, device='cuda:3')
compute_norm is  tensor(56.0745, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(195.6747, device='cuda:3')
distance x is tensor(195.6747, device='cuda:3')
________________________________
test distance is  tensor(195.6747, device='cuda:3')
test distance1 is  tensor(195.6747, device='cuda:3')
test similarity is  tensor(0.9119, device='cuda:3')
test acc is  0.1024333334896653
test loss is 2.544401189919982
test entropy is  0.6368882119147254
________________________________
cal ratio is  0.9649485595116779
distance x is tensor(188.8157, device='cuda:3')
cal_distance is  tensor(188.8157, device='cuda:3')
distance x is tensor(188.8157, device='cuda:3')
return_distance is  tensor(188.8157, device='cuda:3')
distance x is tensor(188.8160, device='cuda:3')
distance x is tensor(188.8160, device='cuda:3')
________________________________
test distance is  tensor(188.8160, device='cuda:3')
test distance1 is  tensor(188.8160, device='cuda:3')
test similarity is  tensor(0.9172, device='cuda:3')
test acc is  0.1029833334896653
test loss is 2.574514028360086
test entropy is  0.63774617038556
________________________________
0
distance x is tensor(188.8160, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.6374164846406054
avg test loss is  2.5755053941629082
avg accuracy is  0.11468333348966527
solo acc is  0.10306666682299863
compute similarity  is  tensor(0.9172, device='cuda:3')
compute_distance is  tensor(188.8160, device='cuda:3')
compute_norm is  tensor(55.5810, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(191.1278, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.0776011910138608
avg test loss is  1.6538372410894202
avg accuracy is  0.1339333334896652
solo acc is  0.1970500001563362
compute similarity  is  tensor(0.9167, device='cuda:3')
compute_distance is  tensor(191.1278, device='cuda:3')
compute_norm is  tensor(55.3011, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(191.3954, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.6468485203633176
avg test loss is  2.436934753775851
avg accuracy is  0.11638333348966527
solo acc is  0.10195000015633197
compute similarity  is  tensor(0.9165, device='cuda:3')
compute_distance is  tensor(191.3954, device='cuda:3')
compute_norm is  tensor(55.1092, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(193.5243, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.026207412674483
avg test loss is  1.6503153747078707
avg accuracy is  0.13695000015633196
solo acc is  0.19900000015633626
compute similarity  is  tensor(0.9160, device='cuda:3')
compute_distance is  tensor(193.5243, device='cuda:3')
compute_norm is  tensor(54.8309, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(193.6574, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.6164192066772152
avg test loss is  2.3961404785672737
avg accuracy is  0.11876666682299859
solo acc is  0.10191666682299863
compute similarity  is  tensor(0.9158, device='cuda:3')
compute_distance is  tensor(193.6574, device='cuda:3')
compute_norm is  tensor(54.6347, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(195.5437, device='cuda:3')
________________________________
test distance is  tensor(195.5437, device='cuda:3')
test similarity is  tensor(0.9153, device='cuda:3')
test acc is  0.1365000001563319
test loss is 1.608520701750001
test entropy is  1.031742287406535
________________________________
final entropy
distance x is tensor(195.5445, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.0323149305798098
avg test loss is  1.609774196325843
avg accuracy is  0.13633333348966523
solo acc is  0.18043333348966864
compute similarity  is  tensor(0.9153, device='cuda:3')
compute_distance is  tensor(195.5445, device='cuda:3')
compute_norm is  tensor(54.3608, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal loss is 1.7949235439300537
mal norm is  tensor(976.4604, device='cuda:3')
distance x is tensor(195.9095, device='cuda:3')
mal distance is  tensor(195.9095, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([ 0., 12., 12., 33., 12.,  0., 12., 14., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 12., 12., 35.,  0., 35.,  0., 12., 12.,
        12., 12., 35., 20., 12., 35., 35., 35.])
count_res tensor([1.0276e-16, 1.6725e-11, 1.6725e-11, 2.2058e-02, 1.6725e-11, 1.0276e-16,
        1.6725e-11, 1.2358e-10, 2.7221e-06, 2.7221e-06, 2.7221e-06, 2.7221e-06,
        2.7221e-06, 2.7221e-06, 2.7221e-06, 2.7221e-06, 2.7221e-06, 2.7221e-06,
        2.7221e-06, 2.7221e-06, 1.6725e-11, 1.6725e-11, 1.6298e-01, 1.0276e-16,
        1.6298e-01, 1.0276e-16, 1.6725e-11, 1.6725e-11, 1.6725e-11, 1.6725e-11,
        1.6298e-01, 4.9857e-08, 1.6725e-11, 1.6298e-01, 1.6298e-01, 1.6298e-01])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 89.93% 

Test Accuracy: 89.32% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3190048038959503
distance x is tensor(121.0898, device='cuda:3')
benign distance is  tensor(121.0898, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5275007486343384
distance x is tensor(100.3443, device='cuda:3')
benign distance is  tensor(100.3443, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.1043047308921814
distance x is tensor(124.3572, device='cuda:3')
benign distance is  tensor(124.3572, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4892606735229492
distance x is tensor(137.0812, device='cuda:3')
benign distance is  tensor(137.0812, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5650637745857239
distance x is tensor(91.9694, device='cuda:3')
benign distance is  tensor(91.9694, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7800747156143188
distance x is tensor(135.3192, device='cuda:3')
benign distance is  tensor(135.3192, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.31304439902305603
distance x is tensor(119.2901, device='cuda:3')
benign distance is  tensor(119.2901, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4615723192691803
distance x is tensor(117.9604, device='cuda:3')
benign distance is  tensor(117.9604, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.25692862272262573
distance x is tensor(140.4055, device='cuda:3')
benign distance is  tensor(140.4055, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6229813694953918
distance x is tensor(134.9578, device='cuda:3')
benign distance is  tensor(134.9578, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.8253715634346008
distance x is tensor(93.0241, device='cuda:3')
benign distance is  tensor(93.0241, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.528115451335907
distance x is tensor(136.1754, device='cuda:3')
benign distance is  tensor(136.1754, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3750949800014496
distance x is tensor(125.0647, device='cuda:3')
benign distance is  tensor(125.0647, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.27946776151657104
distance x is tensor(112.3807, device='cuda:3')
benign distance is  tensor(112.3807, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1747181415557861
distance x is tensor(116.1117, device='cuda:3')
benign distance is  tensor(116.1117, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.2589205503463745
distance x is tensor(126.1935, device='cuda:3')
benign distance is  tensor(126.1935, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.5590271353721619
distance x is tensor(137.6485, device='cuda:3')
benign distance is  tensor(137.6485, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6187809705734253
distance x is tensor(117.3515, device='cuda:3')
benign distance is  tensor(117.3515, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.2450728863477707
distance x is tensor(113.6620, device='cuda:3')
benign distance is  tensor(113.6620, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.21188385784626007
distance x is tensor(133.7075, device='cuda:3')
benign distance is  tensor(133.7075, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.1832083463668823
distance x is tensor(114.4417, device='cuda:3')
benign distance is  tensor(114.4417, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.1598551720380783
distance x is tensor(135.5830, device='cuda:3')
benign distance is  tensor(135.5830, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.45029598474502563
distance x is tensor(135.3317, device='cuda:3')
benign distance is  tensor(135.3317, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.4122700095176697
distance x is tensor(126.3763, device='cuda:3')
benign distance is  tensor(126.3763, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(133.0532, device='cuda:3')
compute distance is  tensor(133.0532, device='cuda:3')
compute norm is  tensor(54.5710, device='cuda:3', dtype=torch.float64)
distance x is tensor(116.1404, device='cuda:3')
compute distance is  tensor(116.1404, device='cuda:3')
compute norm is  tensor(54.3211, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.0600, device='cuda:3')
compute distance is  tensor(139.0600, device='cuda:3')
compute norm is  tensor(54.7962, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.6219, device='cuda:3')
compute distance is  tensor(129.6219, device='cuda:3')
compute norm is  tensor(54.5304, device='cuda:3', dtype=torch.float64)
distance x is tensor(142.0335, device='cuda:3')
compute distance is  tensor(142.0335, device='cuda:3')
compute norm is  tensor(54.7966, device='cuda:3', dtype=torch.float64)
distance x is tensor(127.6272, device='cuda:3')
compute distance is  tensor(127.6272, device='cuda:3')
compute norm is  tensor(54.6150, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.1978, device='cuda:3')
compute distance is  tensor(135.1978, device='cuda:3')
compute norm is  tensor(54.5747, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.4346, device='cuda:3')
compute distance is  tensor(128.4346, device='cuda:3')
compute norm is  tensor(54.5282, device='cuda:3', dtype=torch.float64)
distance x is tensor(147.8854, device='cuda:3')
compute distance is  tensor(147.8854, device='cuda:3')
compute norm is  tensor(54.8638, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.5669, device='cuda:3')
compute distance is  tensor(124.5669, device='cuda:3')
compute norm is  tensor(54.5481, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.4121, device='cuda:3')
compute distance is  tensor(135.4121, device='cuda:3')
compute norm is  tensor(54.7217, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.9126, device='cuda:3')
compute distance is  tensor(126.9126, device='cuda:3')
compute norm is  tensor(54.6276, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(147.8854, device='cuda:3')
distance x is tensor(107759.3594, device='cuda:3')
distance x is tensor(107759.3594, device='cuda:3')
________________________________
test distance is  tensor(107759.3594, device='cuda:3')
test distance1 is  tensor(107759.3594, device='cuda:3')
test similarity is  tensor(-0.1038, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130051487023837.61
test entropy is  0.0
________________________________
cal ratio is  0.03630456297682041
distance x is tensor(3912.1619, device='cuda:3')
cal_distance is  tensor(3912.1619, device='cuda:3')
cal ratio is  0.19053742651995847
distance x is tensor(745.4175, device='cuda:3')
cal_distance is  tensor(745.4175, device='cuda:3')
cal ratio is  0.43650469991250035
distance x is tensor(325.3812, device='cuda:3')
cal_distance is  tensor(325.3812, device='cuda:3')
cal ratio is  0.6606819980234547
distance x is tensor(214.9753, device='cuda:3')
cal_distance is  tensor(214.9753, device='cuda:3')
cal ratio is  0.812820097885201
distance x is tensor(174.7372, device='cuda:3')
cal_distance is  tensor(174.7372, device='cuda:3')
cal ratio is  0.9015628049641693
distance x is tensor(157.5371, device='cuda:3')
cal_distance is  tensor(157.5371, device='cuda:3')
cal ratio is  0.949504991061254
distance x is tensor(149.5825, device='cuda:3')
cal_distance is  tensor(149.5825, device='cuda:3')
cal ratio is  0.9744246676095948
distance x is tensor(145.7570, device='cuda:3')
cal_distance is  tensor(145.7570, device='cuda:3')
distance x is tensor(145.7570, device='cuda:3')
return_distance is  tensor(145.7570, device='cuda:3')
distance x is tensor(145.7466, device='cuda:3')
distance x is tensor(145.7466, device='cuda:3')
________________________________
test distance is  tensor(145.7466, device='cuda:3')
test distance1 is  tensor(145.7466, device='cuda:3')
test similarity is  tensor(0.9519, device='cuda:3')
test acc is  0.10010000015633198
test loss is 338.4151898609804
test entropy is  3.2337769576424056e-05
________________________________
0
distance x is tensor(145.7466, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  2.1385074240416548e-05
avg test loss is  338.6526703661693
avg accuracy is  0.3520000001563404
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.9519, device='cuda:3')
compute_distance is  tensor(145.7466, device='cuda:3')
compute_norm is  tensor(53.6176, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(128.3693, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9191434837099332
avg test loss is  1.5751774513136858
avg accuracy is  0.8154000001563246
solo acc is  0.33668333348967355
compute similarity  is  tensor(0.9574, device='cuda:3')
compute_distance is  tensor(128.3693, device='cuda:3')
compute_norm is  tensor(52.2933, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(131.3736, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9008503635046579
avg test loss is  1.5957590881695372
avg accuracy is  0.8192833334896579
solo acc is  0.2882500001563392
compute similarity  is  tensor(0.9569, device='cuda:3')
compute_distance is  tensor(131.3736, device='cuda:3')
compute_norm is  tensor(51.9130, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(134.0295, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8956012005872055
avg test loss is  1.535834747209732
avg accuracy is  0.8242500001563243
solo acc is  0.2902333334896727
compute similarity  is  tensor(0.9565, device='cuda:3')
compute_distance is  tensor(134.0295, device='cuda:3')
compute_norm is  tensor(51.5750, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(136.4185, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8776469885159149
avg test loss is  1.5112518933790324
avg accuracy is  0.8286333334896574
solo acc is  0.2810166668230058
compute similarity  is  tensor(0.9561, device='cuda:3')
compute_distance is  tensor(136.4185, device='cuda:3')
compute_norm is  tensor(51.2618, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(138.6846, device='cuda:3')
distance x is tensor(138.6846, device='cuda:3')
________________________________
test distance is  tensor(138.6846, device='cuda:3')
test distance1 is  tensor(138.6846, device='cuda:3')
test similarity is  tensor(0.9557, device='cuda:3')
test acc is  0.29106666682300597
test loss is 1.4443741748327894
test entropy is  0.8843429266516842
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal loss is 1.4253956079483032
mal norm is  tensor(701.5237, device='cuda:3')
distance x is tensor(138.6920, device='cuda:3')
mal distance is  tensor(138.6920, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([12., 34., 31.,  0., 35., 16., 12., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 12., 12., 12.,  0., 12., 12.,  0., 12.,
        35.,  0., 12., 35., 35., 12., 21., 34.])
count_res tensor([2.1585e-11, 7.7379e-02, 3.8525e-03, 1.3262e-16, 2.1034e-01, 1.1785e-09,
        2.1585e-11, 2.1585e-11, 3.5130e-06, 3.5130e-06, 3.5130e-06, 3.5130e-06,
        3.5130e-06, 3.5130e-06, 3.5130e-06, 3.5130e-06, 3.5130e-06, 3.5130e-06,
        3.5130e-06, 3.5130e-06, 2.1585e-11, 2.1585e-11, 2.1585e-11, 1.3262e-16,
        2.1585e-11, 2.1585e-11, 1.3262e-16, 2.1585e-11, 2.1034e-01, 1.3262e-16,
        2.1585e-11, 2.1034e-01, 2.1034e-01, 2.1585e-11, 1.7490e-07, 7.7379e-02])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 89.84% 

Test Accuracy: 89.28% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6082797050476074
distance x is tensor(114.5305, device='cuda:3')
benign distance is  tensor(114.5305, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7131714224815369
distance x is tensor(96.9895, device='cuda:3')
benign distance is  tensor(96.9895, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.05590366572141647
distance x is tensor(132.4536, device='cuda:3')
benign distance is  tensor(132.4536, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7459618449211121
distance x is tensor(123.5490, device='cuda:3')
benign distance is  tensor(123.5490, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.7013242244720459
distance x is tensor(105.4554, device='cuda:3')
benign distance is  tensor(105.4554, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5949896574020386
distance x is tensor(146.6248, device='cuda:3')
benign distance is  tensor(146.6248, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.38971227407455444
distance x is tensor(134.5741, device='cuda:3')
benign distance is  tensor(134.5741, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.4786774218082428
distance x is tensor(149.4551, device='cuda:3')
benign distance is  tensor(149.4551, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.262425035238266
distance x is tensor(117.7692, device='cuda:3')
benign distance is  tensor(117.7692, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5627954006195068
distance x is tensor(146.4886, device='cuda:3')
benign distance is  tensor(146.4886, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.5935580730438232
distance x is tensor(139.6527, device='cuda:3')
benign distance is  tensor(139.6527, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.49390044808387756
distance x is tensor(124.1030, device='cuda:3')
benign distance is  tensor(124.1030, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.24323678016662598
distance x is tensor(114.3017, device='cuda:3')
benign distance is  tensor(114.3017, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.6795167326927185
distance x is tensor(111.1420, device='cuda:3')
benign distance is  tensor(111.1420, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.45964592695236206
distance x is tensor(134.9622, device='cuda:3')
benign distance is  tensor(134.9622, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.3630216121673584
distance x is tensor(116.8920, device='cuda:3')
benign distance is  tensor(116.8920, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.28358495235443115
distance x is tensor(136.0506, device='cuda:3')
benign distance is  tensor(136.0506, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.015329709276556969
distance x is tensor(137.3727, device='cuda:3')
benign distance is  tensor(137.3727, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.3821259140968323
distance x is tensor(144.0498, device='cuda:3')
benign distance is  tensor(144.0498, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.41332292556762695
distance x is tensor(140.5577, device='cuda:3')
benign distance is  tensor(140.5577, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.22731797397136688
distance x is tensor(136.0085, device='cuda:3')
benign distance is  tensor(136.0085, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.5424421429634094
distance x is tensor(142.5209, device='cuda:3')
benign distance is  tensor(142.5209, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.19451269507408142
distance x is tensor(128.3133, device='cuda:3')
benign distance is  tensor(128.3133, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.09851838648319244
distance x is tensor(137.5618, device='cuda:3')
benign distance is  tensor(137.5618, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(129.6879, device='cuda:3')
compute distance is  tensor(129.6879, device='cuda:3')
compute norm is  tensor(54.7245, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.1853, device='cuda:3')
compute distance is  tensor(131.1853, device='cuda:3')
compute norm is  tensor(54.8058, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.7221, device='cuda:3')
compute distance is  tensor(140.7221, device='cuda:3')
compute norm is  tensor(55.2063, device='cuda:3', dtype=torch.float64)
distance x is tensor(129.7932, device='cuda:3')
compute distance is  tensor(129.7932, device='cuda:3')
compute norm is  tensor(54.8351, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.1764, device='cuda:3')
compute distance is  tensor(140.1764, device='cuda:3')
compute norm is  tensor(54.9484, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.9194, device='cuda:3')
compute distance is  tensor(131.9194, device='cuda:3')
compute norm is  tensor(54.8984, device='cuda:3', dtype=torch.float64)
distance x is tensor(132.6996, device='cuda:3')
compute distance is  tensor(132.6996, device='cuda:3')
compute norm is  tensor(54.8578, device='cuda:3', dtype=torch.float64)
distance x is tensor(130.7121, device='cuda:3')
compute distance is  tensor(130.7121, device='cuda:3')
compute norm is  tensor(54.7655, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.0946, device='cuda:3')
compute distance is  tensor(135.0946, device='cuda:3')
compute norm is  tensor(54.8769, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.2031, device='cuda:3')
compute distance is  tensor(134.2031, device='cuda:3')
compute norm is  tensor(54.9578, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.1395, device='cuda:3')
compute distance is  tensor(138.1395, device='cuda:3')
compute norm is  tensor(55.0040, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.0415, device='cuda:3')
compute distance is  tensor(131.0415, device='cuda:3')
compute norm is  tensor(54.7965, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(140.7221, device='cuda:3')
distance x is tensor(107757.8438, device='cuda:3')
distance x is tensor(107757.8438, device='cuda:3')
________________________________
test distance is  tensor(107757.8438, device='cuda:3')
test distance1 is  tensor(107757.8438, device='cuda:3')
test similarity is  tensor(-0.1042, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130018312681633.56
test entropy is  0.0
________________________________
cal ratio is  0.035414639524222864
distance x is tensor(3816.2107, device='cuda:3')
cal_distance is  tensor(3816.2107, device='cuda:3')
cal ratio is  0.18818763887722703
distance x is tensor(718.1679, device='cuda:3')
cal_distance is  tensor(718.1679, device='cuda:3')
cal ratio is  0.4338047161343765
distance x is tensor(311.5476, device='cuda:3')
cal_distance is  tensor(311.5476, device='cuda:3')
cal ratio is  0.6586353665616769
distance x is tensor(205.1980, device='cuda:3')
cal_distance is  tensor(205.1980, device='cuda:3')
cal ratio is  0.8115600312393354
distance x is tensor(166.5316, device='cuda:3')
cal_distance is  tensor(166.5316, device='cuda:3')
cal ratio is  0.9008635225598356
distance x is tensor(150.0227, device='cuda:3')
cal_distance is  tensor(150.0227, device='cuda:3')
cal ratio is  0.9491366167114936
distance x is tensor(142.3923, device='cuda:3')
cal_distance is  tensor(142.3923, device='cuda:3')
cal ratio is  0.9742355140277662
distance x is tensor(138.7238, device='cuda:3')
cal_distance is  tensor(138.7238, device='cuda:3')
distance x is tensor(138.7238, device='cuda:3')
return_distance is  tensor(138.7238, device='cuda:3')
distance x is tensor(138.7134, device='cuda:3')
distance x is tensor(138.7134, device='cuda:3')
________________________________
test distance is  tensor(138.7134, device='cuda:3')
test distance1 is  tensor(138.7134, device='cuda:3')
test similarity is  tensor(0.9567, device='cuda:3')
test acc is  0.10020000015633199
test loss is 315.5156492546423
test entropy is  6.838349323293321e-05
________________________________
0
distance x is tensor(138.7134, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  4.732819278151563e-05
avg test loss is  315.54226530030337
avg accuracy is  0.41791666682300793
solo acc is  0.10031666682299864
compute similarity  is  tensor(0.9567, device='cuda:3')
compute_distance is  tensor(138.7134, device='cuda:3')
compute_norm is  tensor(53.7792, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(122.0968, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.9321458995469344
avg test loss is  1.542012055164207
avg accuracy is  0.8194166668229912
solo acc is  0.3354166668230069
compute similarity  is  tensor(0.9616, device='cuda:3')
compute_distance is  tensor(122.0968, device='cuda:3')
compute_norm is  tensor(52.4094, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(125.2864, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8944337000724858
avg test loss is  1.5782170159730322
avg accuracy is  0.8220500001563245
solo acc is  0.28876666682300595
compute similarity  is  tensor(0.9611, device='cuda:3')
compute_distance is  tensor(125.2864, device='cuda:3')
compute_norm is  tensor(52.0380, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(127.9767, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8735558785863523
avg test loss is  1.547512017587609
avg accuracy is  0.8270000001563242
solo acc is  0.28031666682300577
compute similarity  is  tensor(0.9607, device='cuda:3')
compute_distance is  tensor(127.9767, device='cuda:3')
compute_norm is  tensor(51.7054, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(130.6181, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8707230791989674
avg test loss is  1.5061529100830875
avg accuracy is  0.8300833334896573
solo acc is  0.27760000015633907
compute similarity  is  tensor(0.9603, device='cuda:3')
compute_distance is  tensor(130.6181, device='cuda:3')
compute_norm is  tensor(51.3947, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(133.0979, device='cuda:3')
distance x is tensor(133.0979, device='cuda:3')
________________________________
test distance is  tensor(133.0979, device='cuda:3')
test distance1 is  tensor(133.0979, device='cuda:3')
test similarity is  tensor(0.9599, device='cuda:3')
test acc is  0.28278333348967244
test loss is 1.4617172057694718
test entropy is  0.872156069222798
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.2536540031433105
mal norm is  tensor(671.8859, device='cuda:3')
distance x is tensor(133.1049, device='cuda:3')
mal distance is  tensor(133.1049, device='cuda:3')
user_PLR len size 28
counter_tensor is  tensor([12., 26., 12.,  0., 17., 25., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 13., 12., 12., 12., 12., 27., 12., 12.])
count_res tensor([2.0346e-07, 2.4469e-01, 2.0346e-07, 1.2501e-12, 3.0197e-05, 9.0016e-02,
        2.0346e-07, 2.0346e-07, 1.1109e-05, 1.1109e-05, 1.1109e-05, 1.1109e-05,
        1.1109e-05, 1.1109e-05, 1.1109e-05, 1.1109e-05, 1.1109e-05, 1.1109e-05,
        1.1109e-05, 1.1109e-05, 5.5308e-07, 2.0346e-07, 2.0346e-07, 2.0346e-07,
        2.0346e-07, 6.6513e-01, 2.0346e-07, 2.0346e-07])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 89.02% 

Test Accuracy: 88.54% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.2999899685382843
distance x is tensor(131.6847, device='cuda:3')
benign distance is  tensor(131.6847, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.9773969650268555
distance x is tensor(113.3664, device='cuda:3')
benign distance is  tensor(113.3664, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.108101986348629
distance x is tensor(143.9887, device='cuda:3')
benign distance is  tensor(143.9887, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.40563973784446716
distance x is tensor(131.7896, device='cuda:3')
benign distance is  tensor(131.7896, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6065690517425537
distance x is tensor(114.9763, device='cuda:3')
benign distance is  tensor(114.9763, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4402908682823181
distance x is tensor(149.3037, device='cuda:3')
benign distance is  tensor(149.3037, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.16510219871997833
distance x is tensor(144.6060, device='cuda:3')
benign distance is  tensor(144.6060, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.1157107949256897
distance x is tensor(145.9820, device='cuda:3')
benign distance is  tensor(145.9820, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.16785696148872375
distance x is tensor(153.0444, device='cuda:3')
benign distance is  tensor(153.0444, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8866155743598938
distance x is tensor(136.6091, device='cuda:3')
benign distance is  tensor(136.6091, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0298960208892822
distance x is tensor(107.3054, device='cuda:3')
benign distance is  tensor(107.3054, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9940024614334106
distance x is tensor(146.7570, device='cuda:3')
benign distance is  tensor(146.7570, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.41086047887802124
distance x is tensor(151.5902, device='cuda:3')
benign distance is  tensor(151.5902, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3723674416542053
distance x is tensor(95.1024, device='cuda:3')
benign distance is  tensor(95.1024, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.7163017988204956
distance x is tensor(130.6955, device='cuda:3')
benign distance is  tensor(130.6955, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.6208420395851135
distance x is tensor(141.8514, device='cuda:3')
benign distance is  tensor(141.8514, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(132.9371, device='cuda:3')
compute distance is  tensor(132.9371, device='cuda:3')
compute norm is  tensor(55.3242, device='cuda:3', dtype=torch.float64)
distance x is tensor(128.0891, device='cuda:3')
compute distance is  tensor(128.0891, device='cuda:3')
compute norm is  tensor(55.2074, device='cuda:3', dtype=torch.float64)
distance x is tensor(150.1020, device='cuda:3')
compute distance is  tensor(150.1020, device='cuda:3')
compute norm is  tensor(55.9821, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.0695, device='cuda:3')
compute distance is  tensor(137.0695, device='cuda:3')
compute norm is  tensor(55.4433, device='cuda:3', dtype=torch.float64)
distance x is tensor(144.2074, device='cuda:3')
compute distance is  tensor(144.2074, device='cuda:3')
compute norm is  tensor(55.5589, device='cuda:3', dtype=torch.float64)
distance x is tensor(148.2459, device='cuda:3')
compute distance is  tensor(148.2459, device='cuda:3')
compute norm is  tensor(55.6071, device='cuda:3', dtype=torch.float64)
distance x is tensor(160.1679, device='cuda:3')
compute distance is  tensor(160.1679, device='cuda:3')
compute norm is  tensor(55.9377, device='cuda:3', dtype=torch.float64)
distance x is tensor(138.3651, device='cuda:3')
compute distance is  tensor(138.3651, device='cuda:3')
compute norm is  tensor(55.4545, device='cuda:3', dtype=torch.float64)
distance x is tensor(153.8080, device='cuda:3')
compute distance is  tensor(153.8080, device='cuda:3')
compute norm is  tensor(55.8695, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.5490, device='cuda:3')
compute distance is  tensor(135.5490, device='cuda:3')
compute norm is  tensor(55.5120, device='cuda:3', dtype=torch.float64)
distance x is tensor(140.4365, device='cuda:3')
compute distance is  tensor(140.4365, device='cuda:3')
compute norm is  tensor(55.6192, device='cuda:3', dtype=torch.float64)
distance x is tensor(137.4901, device='cuda:3')
compute distance is  tensor(137.4901, device='cuda:3')
compute norm is  tensor(55.4316, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(160.1679, device='cuda:3')
distance x is tensor(107762.5000, device='cuda:3')
distance x is tensor(107762.5000, device='cuda:3')
________________________________
test distance is  tensor(107762.5000, device='cuda:3')
test distance1 is  tensor(107762.5000, device='cuda:3')
test similarity is  tensor(-0.1037, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130133129392660.73
test entropy is  0.0
________________________________
cal ratio is  0.037781563878826196
distance x is tensor(4071.4417, device='cuda:3')
cal_distance is  tensor(4071.4417, device='cuda:3')
cal ratio is  0.19437466518643115
distance x is tensor(791.3892, device='cuda:3')
cal_distance is  tensor(791.3892, device='cuda:3')
cal ratio is  0.44087827480755787
distance x is tensor(348.9093, device='cuda:3')
cal_distance is  tensor(348.9093, device='cuda:3')
cal ratio is  0.6639838395507607
distance x is tensor(231.6719, device='cuda:3')
cal_distance is  tensor(231.6719, device='cuda:3')
cal ratio is  0.8148489206649271
distance x is tensor(188.7785, device='cuda:3')
cal_distance is  tensor(188.7785, device='cuda:3')
cal ratio is  0.9026875438155331
distance x is tensor(170.4086, device='cuda:3')
cal_distance is  tensor(170.4086, device='cuda:3')
cal ratio is  0.9500972320213785
distance x is tensor(161.9050, device='cuda:3')
cal_distance is  tensor(161.9050, device='cuda:3')
cal ratio is  0.9747285172716471
distance x is tensor(157.8135, device='cuda:3')
cal_distance is  tensor(157.8135, device='cuda:3')
distance x is tensor(157.8135, device='cuda:3')
return_distance is  tensor(157.8135, device='cuda:3')
distance x is tensor(157.8030, device='cuda:3')
distance x is tensor(157.8030, device='cuda:3')
________________________________
test distance is  tensor(157.8030, device='cuda:3')
test distance1 is  tensor(157.8030, device='cuda:3')
test similarity is  tensor(0.9459, device='cuda:3')
test acc is  0.10006666682299865
test loss is 489.11505667029667
test entropy is  4.734266325260544e-06
________________________________
0
distance x is tensor(157.8030, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  7.404960136554767e-06
avg test loss is  489.2142354481256
avg accuracy is  0.2404000001563379
solo acc is  0.09998333348966532
compute similarity  is  tensor(0.9459, device='cuda:3')
compute_distance is  tensor(157.8030, device='cuda:3')
compute_norm is  tensor(54.6289, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(134.7735, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.944918923794842
avg test loss is  1.5903710187879452
avg accuracy is  0.7880666668229925
solo acc is  0.33568333348967355
compute similarity  is  tensor(0.9532, device='cuda:3')
compute_distance is  tensor(134.7735, device='cuda:3')
compute_norm is  tensor(53.2421, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(134.7735, device='cuda:3')
distance x is tensor(134.7735, device='cuda:3')
________________________________
test distance is  tensor(134.7735, device='cuda:3')
test distance1 is  tensor(134.7735, device='cuda:3')
test similarity is  tensor(0.9532, device='cuda:3')
test acc is  0.33363333348967356
test loss is 1.5904095555419353
test entropy is  0.9474453903845886
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.6524267196655273
mal norm is  tensor(740.3073, device='cuda:3')
distance x is tensor(134.7812, device='cuda:3')
mal distance is  tensor(134.7812, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 26.82% 

Test Accuracy: 25.44% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.33031216263771057
distance x is tensor(195.7610, device='cuda:3')
benign distance is  tensor(195.7610, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.342225581407547
distance x is tensor(210.0540, device='cuda:3')
benign distance is  tensor(210.0540, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.020697711035609245
distance x is tensor(195.3297, device='cuda:3')
benign distance is  tensor(195.3297, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3075897693634033
distance x is tensor(194.8788, device='cuda:3')
benign distance is  tensor(194.8788, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.46171507239341736
distance x is tensor(196.9545, device='cuda:3')
benign distance is  tensor(196.9545, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0334655046463013
distance x is tensor(202.4425, device='cuda:3')
benign distance is  tensor(202.4425, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.4391302168369293
distance x is tensor(189.1276, device='cuda:3')
benign distance is  tensor(189.1276, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.21741394698619843
distance x is tensor(214.5943, device='cuda:3')
benign distance is  tensor(214.5943, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(205.6029, device='cuda:3')
compute distance is  tensor(205.6029, device='cuda:3')
compute norm is  tensor(55.4491, device='cuda:3', dtype=torch.float64)
distance x is tensor(190.2574, device='cuda:3')
compute distance is  tensor(190.2574, device='cuda:3')
compute norm is  tensor(55.2181, device='cuda:3', dtype=torch.float64)
distance x is tensor(212.0840, device='cuda:3')
compute distance is  tensor(212.0840, device='cuda:3')
compute norm is  tensor(55.5971, device='cuda:3', dtype=torch.float64)
distance x is tensor(190.8610, device='cuda:3')
compute distance is  tensor(190.8610, device='cuda:3')
compute norm is  tensor(55.2200, device='cuda:3', dtype=torch.float64)
distance x is tensor(204.4142, device='cuda:3')
compute distance is  tensor(204.4142, device='cuda:3')
compute norm is  tensor(55.7104, device='cuda:3', dtype=torch.float64)
distance x is tensor(203.2833, device='cuda:3')
compute distance is  tensor(203.2833, device='cuda:3')
compute norm is  tensor(55.5454, device='cuda:3', dtype=torch.float64)
distance x is tensor(209.8940, device='cuda:3')
compute distance is  tensor(209.8940, device='cuda:3')
compute norm is  tensor(55.5425, device='cuda:3', dtype=torch.float64)
distance x is tensor(182.2389, device='cuda:3')
compute distance is  tensor(182.2389, device='cuda:3')
compute norm is  tensor(54.9843, device='cuda:3', dtype=torch.float64)
distance x is tensor(197.0126, device='cuda:3')
compute distance is  tensor(197.0126, device='cuda:3')
compute norm is  tensor(55.5967, device='cuda:3', dtype=torch.float64)
distance x is tensor(193.1112, device='cuda:3')
compute distance is  tensor(193.1112, device='cuda:3')
compute norm is  tensor(55.2632, device='cuda:3', dtype=torch.float64)
distance x is tensor(213.3558, device='cuda:3')
compute distance is  tensor(213.3558, device='cuda:3')
compute norm is  tensor(55.8652, device='cuda:3', dtype=torch.float64)
distance x is tensor(191.0344, device='cuda:3')
compute distance is  tensor(191.0344, device='cuda:3')
compute norm is  tensor(55.3804, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(213.3558, device='cuda:3')
distance x is tensor(107680.7500, device='cuda:3')
distance x is tensor(107680.7500, device='cuda:3')
________________________________
test distance is  tensor(107680.7500, device='cuda:3')
test distance1 is  tensor(107680.7500, device='cuda:3')
test similarity is  tensor(0.1689, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130070122477485.03
test entropy is  0.0
________________________________
cal ratio is  0.04362236582303612
distance x is tensor(4697.2949, device='cuda:3')
cal_distance is  tensor(4697.2949, device='cuda:3')
cal ratio is  0.20885955720629418
distance x is tensor(981.0791, device='cuda:3')
cal_distance is  tensor(981.0791, device='cuda:3')
cal ratio is  0.4570105745121978
distance x is tensor(448.3664, device='cuda:3')
cal_distance is  tensor(448.3664, device='cuda:3')
cal ratio is  0.6760234043630816
distance x is tensor(303.1079, device='cuda:3')
cal_distance is  tensor(303.1079, device='cuda:3')
cal ratio is  0.8222041030013556
distance x is tensor(249.2175, device='cuda:3')
cal_distance is  tensor(249.2175, device='cuda:3')
cal ratio is  0.9067530507961137
distance x is tensor(225.9792, device='cuda:3')
cal_distance is  tensor(225.9792, device='cuda:3')
cal ratio is  0.9522347319418755
distance x is tensor(215.1855, device='cuda:3')
cal_distance is  tensor(215.1855, device='cuda:3')
cal ratio is  0.9758245961905455
distance x is tensor(209.9834, device='cuda:3')
cal_distance is  tensor(209.9834, device='cuda:3')
distance x is tensor(209.9834, device='cuda:3')
return_distance is  tensor(209.9834, device='cuda:3')
distance x is tensor(209.9730, device='cuda:3')
distance x is tensor(209.9730, device='cuda:3')
________________________________
test distance is  tensor(209.9730, device='cuda:3')
test distance1 is  tensor(209.9730, device='cuda:3')
test similarity is  tensor(0.9254, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2421.8731287323844
test entropy is  0.0
________________________________
0
distance x is tensor(209.9730, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  2418.78702335317
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9254, device='cuda:3')
compute_distance is  tensor(209.9730, device='cuda:3')
compute_norm is  tensor(58.2741, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(4055.0696, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.6342568149698822
avg test loss is  2.8846792480838834
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1702, device='cuda:3')
compute_distance is  tensor(4055.0696, device='cuda:3')
compute_norm is  tensor(297.4163, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(4036.6643, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8913814063900823
avg test loss is  3.7187303635103106
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1702, device='cuda:3')
compute_distance is  tensor(4036.6643, device='cuda:3')
compute_norm is  tensor(296.1393, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(4018.4460, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5471537741008343
avg test loss is  2.884517268077143
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1702, device='cuda:3')
compute_distance is  tensor(4018.4460, device='cuda:3')
compute_norm is  tensor(294.7425, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(4000.2031, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8676383738070409
avg test loss is  3.633341966153208
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1702, device='cuda:3')
compute_distance is  tensor(4000.2031, device='cuda:3')
compute_norm is  tensor(293.4729, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(3981.9634, device='cuda:3')
distance x is tensor(3981.9634, device='cuda:3')
________________________________
test distance is  tensor(3981.9634, device='cuda:3')
test distance1 is  tensor(3981.9634, device='cuda:3')
test similarity is  tensor(0.1701, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8732663753952807
test entropy is  1.5474584977001524
________________________________
cal ratio is  0.22684521536413566
distance x is tensor(903.2878, device='cuda:3')
cal_distance is  tensor(903.2878, device='cuda:3')
cal ratio is  0.47628312131520223
distance x is tensor(430.2202, device='cuda:3')
cal_distance is  tensor(430.2202, device='cuda:3')
cal ratio is  0.6901331154381206
distance x is tensor(296.9088, device='cuda:3')
cal_distance is  tensor(296.9088, device='cuda:3')
cal ratio is  0.8307429888604779
distance x is tensor(246.6547, device='cuda:3')
cal_distance is  tensor(246.6547, device='cuda:3')
cal ratio is  0.9114514355614645
distance x is tensor(224.8137, device='cuda:3')
cal_distance is  tensor(224.8137, device='cuda:3')
cal ratio is  0.954699863547326
distance x is tensor(214.6296, device='cuda:3')
cal_distance is  tensor(214.6296, device='cuda:3')
cal ratio is  0.9770875742331557
distance x is tensor(209.7119, device='cuda:3')
cal_distance is  tensor(209.7119, device='cuda:3')
distance x is tensor(209.7119, device='cuda:3')
return_distance is  tensor(209.7119, device='cuda:3')
distance x is tensor(209.7143, device='cuda:3')
distance x is tensor(209.7143, device='cuda:3')
________________________________
test distance is  tensor(209.7143, device='cuda:3')
test distance1 is  tensor(209.7143, device='cuda:3')
test similarity is  tensor(0.9447, device='cuda:3')
test acc is  0.11306666682299861
test loss is 2.7941999486260323
test entropy is  1.7594596394089494
________________________________
0
distance x is tensor(209.7143, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.7594599764484333
avg test loss is  2.7944235753403035
avg accuracy is  0.1791333334896686
solo acc is  0.11176666682299861
compute similarity  is  tensor(0.9447, device='cuda:3')
compute_distance is  tensor(209.7143, device='cuda:3')
compute_norm is  tensor(57.6119, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(210.9283, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8081194433067908
avg test loss is  3.11454139996185
avg accuracy is  0.1480166668229997
solo acc is  0.10146666682299864
compute similarity  is  tensor(0.9442, device='cuda:3')
compute_distance is  tensor(210.9283, device='cuda:3')
compute_norm is  tensor(57.4540, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(213.1560, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  1.0661808866808917
avg test loss is  1.767911223587451
avg accuracy is  0.24320000015633805
solo acc is  0.2378000001563379
compute similarity  is  tensor(0.9441, device='cuda:3')
compute_distance is  tensor(213.1560, device='cuda:3')
compute_norm is  tensor(57.0030, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(213.2898, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.648353745306987
avg test loss is  2.5928794481098523
avg accuracy is  0.18305000015633546
solo acc is  0.11175000015633195
compute similarity  is  tensor(0.9438, device='cuda:3')
compute_distance is  tensor(213.2898, device='cuda:3')
compute_norm is  tensor(56.8035, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(215.9055, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.9988633351666587
avg test loss is  1.559354260659167
avg accuracy is  0.27051666682300546
solo acc is  0.2656833334896721
compute similarity  is  tensor(0.9434, device='cuda:3')
compute_distance is  tensor(215.9055, device='cuda:3')
compute_norm is  tensor(56.4116, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(215.9055, device='cuda:3')
distance x is tensor(215.9055, device='cuda:3')
________________________________
test distance is  tensor(215.9055, device='cuda:3')
test distance1 is  tensor(215.9055, device='cuda:3')
test similarity is  tensor(0.9434, device='cuda:3')
test acc is  0.26941666682300547
test loss is 1.555753282519546
test entropy is  0.9981487289801844
________________________________
cal ratio is  0.9741962333958799
distance x is tensor(210.3307, device='cuda:3')
cal_distance is  tensor(210.3307, device='cuda:3')
distance x is tensor(210.3307, device='cuda:3')
return_distance is  tensor(210.3307, device='cuda:3')
distance x is tensor(210.3343, device='cuda:3')
distance x is tensor(210.3343, device='cuda:3')
________________________________
test distance is  tensor(210.3343, device='cuda:3')
test distance1 is  tensor(210.3343, device='cuda:3')
test similarity is  tensor(0.9461, device='cuda:3')
test acc is  0.2727500001563389
test loss is 1.5449500638030484
test entropy is  1.0186021720676788
________________________________
0
distance x is tensor(210.3343, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.019030587314797
avg test loss is  1.546999285978549
avg accuracy is  0.26123333348967187
solo acc is  0.2692333334896721
compute similarity  is  tensor(0.9461, device='cuda:3')
compute_distance is  tensor(210.3343, device='cuda:3')
compute_norm is  tensor(56.2535, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(210.6909, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.6280007917108312
avg test loss is  2.400386605562686
avg accuracy is  0.1893500001563358
solo acc is  0.11170000015633194
compute similarity  is  tensor(0.9456, device='cuda:3')
compute_distance is  tensor(210.6909, device='cuda:3')
compute_norm is  tensor(56.0431, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(213.1635, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.960942499419011
avg test loss is  1.467341720422448
avg accuracy is  0.27218333348967216
solo acc is  0.277350000156339
compute similarity  is  tensor(0.9451, device='cuda:3')
compute_distance is  tensor(213.1635, device='cuda:3')
compute_norm is  tensor(55.6792, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(213.1598, device='cuda:3')
________________________________
test distance is  tensor(213.1598, device='cuda:3')
test similarity is  tensor(0.9451, device='cuda:3')
test acc is  0.27371666682300555
test loss is 1.46494795658441
test entropy is  0.9611569397739256
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.45000000050000005
mal loss is 1.0837934017181396
mal norm is  tensor(813.9570, device='cuda:3')
distance x is tensor(213.1598, device='cuda:3')
mal distance is  tensor(213.1598, device='cuda:3')
user_PLR len size 52
counter_tensor is  tensor([ 0.,  0.,  0., 15.,  0.,  0.,  0.,  0., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 12., 51., 12., 12., 17., 12., 50., 51.,
        50., 51., 44., 51., 51., 50., 12., 50., 12.,  0., 48., 14.,  0., 41.,
        12., 51.,  0., 51., 35.,  0.,  0., 51.,  0., 18.])
count_res tensor([7.4513e-24, 7.4513e-24, 7.4513e-24, 2.4358e-17, 7.4513e-24, 7.4513e-24,
        7.4513e-24, 7.4513e-24, 1.7539e-06, 1.7539e-06, 1.7539e-06, 1.7539e-06,
        1.7539e-06, 1.7539e-06, 1.7539e-06, 1.7539e-06, 1.7539e-06, 1.7539e-06,
        1.7539e-06, 1.7539e-06, 1.2127e-18, 1.0501e-01, 1.2127e-18, 1.2127e-18,
        1.7999e-16, 1.2127e-18, 3.8633e-02, 1.0501e-01, 3.8633e-02, 1.0501e-01,
        9.5761e-05, 1.0501e-01, 1.0501e-01, 3.8633e-02, 1.2127e-18, 3.8633e-02,
        1.2127e-18, 7.4513e-24, 5.2284e-03, 8.9610e-18, 7.4513e-24, 4.7677e-06,
        1.2127e-18, 1.0501e-01, 7.4513e-24, 1.0501e-01, 1.1818e-08, 7.4513e-24,
        7.4513e-24, 1.0501e-01, 7.4513e-24, 4.8925e-16])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 90.10% 

Test Accuracy: 89.54% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7938739061355591
distance x is tensor(129.5442, device='cuda:3')
benign distance is  tensor(129.5442, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5806857943534851
distance x is tensor(109.8443, device='cuda:3')
benign distance is  tensor(109.8443, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.13048246502876282
distance x is tensor(132.9743, device='cuda:3')
benign distance is  tensor(132.9743, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.4984162449836731
distance x is tensor(121.7038, device='cuda:3')
benign distance is  tensor(121.7038, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0519592761993408
distance x is tensor(95.7772, device='cuda:3')
benign distance is  tensor(95.7772, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.41319188475608826
distance x is tensor(137.2205, device='cuda:3')
benign distance is  tensor(137.2205, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.45269647240638733
distance x is tensor(118.3066, device='cuda:3')
benign distance is  tensor(118.3066, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.15005630254745483
distance x is tensor(134.0289, device='cuda:3')
benign distance is  tensor(134.0289, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.1723719835281372
distance x is tensor(133.8544, device='cuda:3')
benign distance is  tensor(133.8544, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6159349679946899
distance x is tensor(114.0565, device='cuda:3')
benign distance is  tensor(114.0565, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.7944996356964111
distance x is tensor(98.7764, device='cuda:3')
benign distance is  tensor(98.7764, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.657971978187561
distance x is tensor(126.1771, device='cuda:3')
benign distance is  tensor(126.1771, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.3390868306159973
distance x is tensor(127.2890, device='cuda:3')
benign distance is  tensor(127.2890, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6141607761383057
distance x is tensor(109.5480, device='cuda:3')
benign distance is  tensor(109.5480, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.5732234716415405
distance x is tensor(137.3118, device='cuda:3')
benign distance is  tensor(137.3118, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.9396167993545532
distance x is tensor(126.3358, device='cuda:3')
benign distance is  tensor(126.3358, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.25822797417640686
distance x is tensor(128.1308, device='cuda:3')
benign distance is  tensor(128.1308, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9836085438728333
distance x is tensor(142.5917, device='cuda:3')
benign distance is  tensor(142.5917, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.10400302708148956
distance x is tensor(127.7262, device='cuda:3')
benign distance is  tensor(127.7262, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.1673727035522461
distance x is tensor(127.5570, device='cuda:3')
benign distance is  tensor(127.5570, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.6627200841903687
distance x is tensor(114.7240, device='cuda:3')
benign distance is  tensor(114.7240, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5812151432037354
distance x is tensor(104.4773, device='cuda:3')
benign distance is  tensor(104.4773, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.12137795984745026
distance x is tensor(129.2054, device='cuda:3')
benign distance is  tensor(129.2054, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.570686936378479
distance x is tensor(104.7654, device='cuda:3')
benign distance is  tensor(104.7654, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.3705727458000183
distance x is tensor(138.1315, device='cuda:3')
benign distance is  tensor(138.1315, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6526979804039001
distance x is tensor(126.3731, device='cuda:3')
benign distance is  tensor(126.3731, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.722007155418396
distance x is tensor(131.8894, device='cuda:3')
benign distance is  tensor(131.8894, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.5577123761177063
distance x is tensor(150.1522, device='cuda:3')
benign distance is  tensor(150.1522, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.366594910621643
distance x is tensor(119.4683, device='cuda:3')
benign distance is  tensor(119.4683, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.34016531705856323
distance x is tensor(131.2285, device='cuda:3')
benign distance is  tensor(131.2285, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.7429355382919312
distance x is tensor(127.0567, device='cuda:3')
benign distance is  tensor(127.0567, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.9126739501953125
distance x is tensor(124.0760, device='cuda:3')
benign distance is  tensor(124.0760, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.09134433418512344
distance x is tensor(137.9034, device='cuda:3')
benign distance is  tensor(137.9034, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.45061883330345154
distance x is tensor(115.0226, device='cuda:3')
benign distance is  tensor(115.0226, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.3052974045276642
distance x is tensor(123.2251, device='cuda:3')
benign distance is  tensor(123.2251, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.31362518668174744
distance x is tensor(143.1266, device='cuda:3')
benign distance is  tensor(143.1266, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.4192879796028137
distance x is tensor(132.8075, device='cuda:3')
benign distance is  tensor(132.8075, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.19639886915683746
distance x is tensor(130.3952, device='cuda:3')
benign distance is  tensor(130.3952, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7055991888046265
distance x is tensor(124.3419, device='cuda:3')
benign distance is  tensor(124.3419, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.4161399006843567
distance x is tensor(120.2752, device='cuda:3')
benign distance is  tensor(120.2752, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(130.0747, device='cuda:3')
compute distance is  tensor(130.0747, device='cuda:3')
compute norm is  tensor(54.8483, device='cuda:3', dtype=torch.float64)
distance x is tensor(120.9097, device='cuda:3')
compute distance is  tensor(120.9097, device='cuda:3')
compute norm is  tensor(54.7697, device='cuda:3', dtype=torch.float64)
distance x is tensor(131.8310, device='cuda:3')
compute distance is  tensor(131.8310, device='cuda:3')
compute norm is  tensor(55.1273, device='cuda:3', dtype=torch.float64)
distance x is tensor(124.2657, device='cuda:3')
compute distance is  tensor(124.2657, device='cuda:3')
compute norm is  tensor(54.8924, device='cuda:3', dtype=torch.float64)
distance x is tensor(134.1010, device='cuda:3')
compute distance is  tensor(134.1010, device='cuda:3')
compute norm is  tensor(55.0294, device='cuda:3', dtype=torch.float64)
distance x is tensor(135.1864, device='cuda:3')
compute distance is  tensor(135.1864, device='cuda:3')
compute norm is  tensor(55.2029, device='cuda:3', dtype=torch.float64)
distance x is tensor(133.8463, device='cuda:3')
compute distance is  tensor(133.8463, device='cuda:3')
compute norm is  tensor(55.2047, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.3724, device='cuda:3')
compute distance is  tensor(126.3724, device='cuda:3')
compute norm is  tensor(54.9770, device='cuda:3', dtype=torch.float64)
distance x is tensor(139.9199, device='cuda:3')
compute distance is  tensor(139.9199, device='cuda:3')
compute norm is  tensor(55.1468, device='cuda:3', dtype=torch.float64)
distance x is tensor(125.1545, device='cuda:3')
compute distance is  tensor(125.1545, device='cuda:3')
compute norm is  tensor(54.9773, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.5090, device='cuda:3')
compute distance is  tensor(126.5090, device='cuda:3')
compute norm is  tensor(54.9161, device='cuda:3', dtype=torch.float64)
distance x is tensor(126.1971, device='cuda:3')
compute distance is  tensor(126.1971, device='cuda:3')
compute norm is  tensor(54.9432, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(139.9199, device='cuda:3')
distance x is tensor(107760.8516, device='cuda:3')
distance x is tensor(107760.8516, device='cuda:3')
________________________________
test distance is  tensor(107760.8516, device='cuda:3')
test distance1 is  tensor(107760.8516, device='cuda:3')
test similarity is  tensor(-0.1055, device='cuda:3')
test acc is  0.10000000015633198
test loss is 130138366906813.4
test entropy is  0.0
________________________________
cal ratio is  0.035313058288030524
distance x is tensor(3805.3706, device='cuda:3')
cal_distance is  tensor(3805.3706, device='cuda:3')
cal ratio is  0.18791755483280687
distance x is tensor(715.1002, device='cuda:3')
cal_distance is  tensor(715.1002, device='cuda:3')
cal ratio is  0.4334932973160922
distance x is tensor(309.9940, device='cuda:3')
cal_distance is  tensor(309.9940, device='cuda:3')
cal ratio is  0.658398984625359
distance x is tensor(204.1016, device='cuda:3')
cal_distance is  tensor(204.1016, device='cuda:3')
cal ratio is  0.8114142199675263
distance x is tensor(165.6120, device='cuda:3')
cal_distance is  tensor(165.6120, device='cuda:3')
cal ratio is  0.9007825958824194
distance x is tensor(149.1809, device='cuda:3')
cal_distance is  tensor(149.1809, device='cuda:3')
cal ratio is  0.9490940053469155
distance x is tensor(141.5869, device='cuda:3')
cal_distance is  tensor(141.5869, device='cuda:3')
cal ratio is  0.9742136851211955
distance x is tensor(137.9361, device='cuda:3')
cal_distance is  tensor(137.9361, device='cuda:3')
distance x is tensor(137.9361, device='cuda:3')
return_distance is  tensor(137.9361, device='cuda:3')
distance x is tensor(137.9256, device='cuda:3')
distance x is tensor(137.9256, device='cuda:3')
________________________________
test distance is  tensor(137.9256, device='cuda:3')
test distance1 is  tensor(137.9256, device='cuda:3')
test similarity is  tensor(0.9573, device='cuda:3')
test acc is  0.1003833334896653
test loss is 281.52550573288
test entropy is  4.2562422565495355e-05
________________________________
0
distance x is tensor(137.9256, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.00011297843963731263
avg test loss is  281.3197306976644
avg accuracy is  0.48063333348967524
solo acc is  0.10046666682299864
compute similarity  is  tensor(0.9573, device='cuda:3')
compute_distance is  tensor(137.9256, device='cuda:3')
compute_norm is  tensor(53.9136, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(121.5495, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.8922106103220983
avg test loss is  1.5419904860352147
avg accuracy is  0.8389666668229904
solo acc is  0.33998333348967363
compute similarity  is  tensor(0.9622, device='cuda:3')
compute_distance is  tensor(121.5495, device='cuda:3')
compute_norm is  tensor(52.5086, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(124.8239, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8954207889560951
avg test loss is  1.5318305981692983
avg accuracy is  0.8396166668229903
solo acc is  0.3058500001563397
compute similarity  is  tensor(0.9616, device='cuda:3')
compute_distance is  tensor(124.8239, device='cuda:3')
compute_norm is  tensor(52.1245, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(127.6849, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  0.8924714436790327
avg test loss is  1.4758772871641717
avg accuracy is  0.8435166668229902
solo acc is  0.29991666682300616
compute similarity  is  tensor(0.9612, device='cuda:3')
compute_distance is  tensor(127.6849, device='cuda:3')
compute_norm is  tensor(51.7851, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(130.3753, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8685102742363904
avg test loss is  1.4827015158464152
avg accuracy is  0.8447000001563235
solo acc is  0.2821500001563391
compute similarity  is  tensor(0.9608, device='cuda:3')
compute_distance is  tensor(130.3753, device='cuda:3')
compute_norm is  tensor(51.4676, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(132.9293, device='cuda:3')
distance x is tensor(132.9293, device='cuda:3')
________________________________
test distance is  tensor(132.9293, device='cuda:3')
test distance1 is  tensor(132.9293, device='cuda:3')
test similarity is  tensor(0.9604, device='cuda:3')
test acc is  0.27811666682300573
test loss is 1.4580443669229681
test entropy is  0.8507902032530892
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.3768008947372437
mal norm is  tensor(668.9233, device='cuda:3')
distance x is tensor(132.9362, device='cuda:3')
mal distance is  tensor(132.9362, device='cuda:3')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 18.98% 

Test Accuracy: 18.43% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6131101250648499
distance x is tensor(163.9178, device='cuda:3')
benign distance is  tensor(163.9178, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.6199484467506409
distance x is tensor(164.9553, device='cuda:3')
benign distance is  tensor(164.9553, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.06254707276821136
distance x is tensor(167.8589, device='cuda:3')
benign distance is  tensor(167.8589, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.521160900592804
distance x is tensor(168.0605, device='cuda:3')
benign distance is  tensor(168.0605, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.41219788789749146
distance x is tensor(159.7559, device='cuda:3')
benign distance is  tensor(159.7559, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.4402443468570709
distance x is tensor(164.4106, device='cuda:3')
benign distance is  tensor(164.4106, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3657809793949127
distance x is tensor(162.2769, device='cuda:3')
benign distance is  tensor(162.2769, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.772687554359436
distance x is tensor(163.8920, device='cuda:3')
benign distance is  tensor(163.8920, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(161.2624, device='cuda:3')
compute distance is  tensor(161.2624, device='cuda:3')
compute norm is  tensor(52.9802, device='cuda:3', dtype=torch.float64)
distance x is tensor(172.6707, device='cuda:3')
compute distance is  tensor(172.6707, device='cuda:3')
compute norm is  tensor(53.1252, device='cuda:3', dtype=torch.float64)
distance x is tensor(173.4157, device='cuda:3')
compute distance is  tensor(173.4157, device='cuda:3')
compute norm is  tensor(53.3242, device='cuda:3', dtype=torch.float64)
distance x is tensor(170.7024, device='cuda:3')
compute distance is  tensor(170.7024, device='cuda:3')
compute norm is  tensor(53.1334, device='cuda:3', dtype=torch.float64)
distance x is tensor(189.9784, device='cuda:3')
compute distance is  tensor(189.9784, device='cuda:3')
compute norm is  tensor(53.7082, device='cuda:3', dtype=torch.float64)
distance x is tensor(171.2339, device='cuda:3')
compute distance is  tensor(171.2339, device='cuda:3')
compute norm is  tensor(53.3221, device='cuda:3', dtype=torch.float64)
distance x is tensor(175.4232, device='cuda:3')
compute distance is  tensor(175.4232, device='cuda:3')
compute norm is  tensor(53.2160, device='cuda:3', dtype=torch.float64)
distance x is tensor(168.7960, device='cuda:3')
compute distance is  tensor(168.7960, device='cuda:3')
compute norm is  tensor(53.3560, device='cuda:3', dtype=torch.float64)
distance x is tensor(175.3466, device='cuda:3')
compute distance is  tensor(175.3466, device='cuda:3')
compute norm is  tensor(53.2862, device='cuda:3', dtype=torch.float64)
distance x is tensor(177.2484, device='cuda:3')
compute distance is  tensor(177.2484, device='cuda:3')
compute norm is  tensor(53.4052, device='cuda:3', dtype=torch.float64)
distance x is tensor(179.2897, device='cuda:3')
compute distance is  tensor(179.2897, device='cuda:3')
compute norm is  tensor(53.4127, device='cuda:3', dtype=torch.float64)
distance x is tensor(186.5094, device='cuda:3')
compute distance is  tensor(186.5094, device='cuda:3')
compute norm is  tensor(53.5526, device='cuda:3', dtype=torch.float64)
distance Threshold  is  tensor(189.9784, device='cuda:3')
distance x is tensor(107685.4844, device='cuda:3')
distance x is tensor(107685.4844, device='cuda:3')
________________________________
test distance is  tensor(107685.4844, device='cuda:3')
test distance1 is  tensor(107685.4844, device='cuda:3')
test similarity is  tensor(0.1343, device='cuda:3')
test acc is  0.10000000015633198
test loss is 129987391896936.25
test entropy is  0.0
________________________________
cal ratio is  0.04116229848999257
distance x is tensor(4432.5879, device='cuda:3')
cal_distance is  tensor(4432.5879, device='cuda:3')
cal ratio is  0.20288480570383008
distance x is tensor(899.3089, device='cuda:3')
cal_distance is  tensor(899.3089, device='cuda:3')
cal ratio is  0.45042631236522096
distance x is tensor(405.0753, device='cuda:3')
cal_distance is  tensor(405.0753, device='cuda:3')
cal ratio is  0.6711356923471339
distance x is tensor(271.8622, device='cuda:3')
cal_distance is  tensor(271.8622, device='cuda:3')
cal ratio is  0.8192261219584249
distance x is tensor(222.7176, device='cuda:3')
cal_distance is  tensor(222.7176, device='cuda:3')
cal ratio is  0.9051091740287104
distance x is tensor(201.5842, device='cuda:3')
cal_distance is  tensor(201.5842, device='cuda:3')
cal ratio is  0.9513710180090748
distance x is tensor(191.7816, device='cuda:3')
cal_distance is  tensor(191.7816, device='cuda:3')
cal ratio is  0.9753819459674927
distance x is tensor(187.0605, device='cuda:3')
cal_distance is  tensor(187.0605, device='cuda:3')
distance x is tensor(187.0605, device='cuda:3')
return_distance is  tensor(187.0605, device='cuda:3')
distance x is tensor(187.0500, device='cuda:3')
distance x is tensor(187.0500, device='cuda:3')
________________________________
test distance is  tensor(187.0500, device='cuda:3')
test distance1 is  tensor(187.0500, device='cuda:3')
test similarity is  tensor(0.9316, device='cuda:3')
test acc is  0.10000000015633198
test loss is 1531.1024293553855
test entropy is  0.0
________________________________
0
distance x is tensor(187.0500, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  1531.8579192659747
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9316, device='cuda:3')
compute_distance is  tensor(187.0500, device='cuda:3')
compute_norm is  tensor(55.1350, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1091.4167, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  1.615963303839474
avg test loss is  2.8594116895183572
avg accuracy is  0.10165000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4462, device='cuda:3')
compute_distance is  tensor(1091.4167, device='cuda:3')
compute_norm is  tensor(114.0580, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1086.8104, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.8579388230340059
avg test loss is  3.681931685282986
avg accuracy is  0.10140000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4464, device='cuda:3')
compute_distance is  tensor(1086.8104, device='cuda:3')
compute_norm is  tensor(113.7384, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1082.1556, device='cuda:3')
++++++++++++++++++++
after training  3
avg test entropy is  1.5658721687442967
avg test loss is  2.8608519021890313
avg accuracy is  0.1013833334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4462, device='cuda:3')
compute_distance is  tensor(1082.1556, device='cuda:3')
compute_norm is  tensor(113.0370, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1077.6083, device='cuda:3')
++++++++++++++++++++
after training  4
avg test entropy is  0.8442720697124375
avg test loss is  3.6388591588941464
avg accuracy is  0.10120000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4463, device='cuda:3')
compute_distance is  tensor(1077.6083, device='cuda:3')
compute_norm is  tensor(112.7090, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1072.9069, device='cuda:3')
distance x is tensor(1072.9069, device='cuda:3')
________________________________
test distance is  tensor(1072.9069, device='cuda:3')
test distance1 is  tensor(1072.9069, device='cuda:3')
test similarity is  tensor(0.4461, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8677692698008976
test entropy is  1.5514686722745266
________________________________
cal ratio is  0.412379614942374
distance x is tensor(442.4462, device='cuda:3')
cal_distance is  tensor(442.4462, device='cuda:3')
cal ratio is  0.6421669658988478
distance x is tensor(284.1247, device='cuda:3')
cal_distance is  tensor(284.1247, device='cuda:3')
cal ratio is  0.8013527101961089
distance x is tensor(227.6843, device='cuda:3')
cal_distance is  tensor(227.6843, device='cuda:3')
cal ratio is  0.8951826818195764
distance x is tensor(203.8191, device='cuda:3')
cal_distance is  tensor(203.8191, device='cuda:3')
cal ratio is  0.9461406860175149
distance x is tensor(192.8416, device='cuda:3')
cal_distance is  tensor(192.8416, device='cuda:3')
cal ratio is  0.972697479906207
distance x is tensor(187.5766, device='cuda:3')
cal_distance is  tensor(187.5766, device='cuda:3')
distance x is tensor(187.5766, device='cuda:3')
return_distance is  tensor(187.5766, device='cuda:3')
distance x is tensor(187.5747, device='cuda:3')
distance x is tensor(187.5747, device='cuda:3')
________________________________
test distance is  tensor(187.5747, device='cuda:3')
test distance1 is  tensor(187.5747, device='cuda:3')
test similarity is  tensor(0.9368, device='cuda:3')
test acc is  0.13921666682299882
test loss is 2.5833692042304
test entropy is  1.7449542440331058
________________________________
0
distance x is tensor(187.5747, device='cuda:3')
++++++++++++++++++++
after training  0
avg test entropy is  1.7448130497800263
avg test loss is  2.5835178251713833
avg accuracy is  0.10895000015633195
solo acc is  0.1372333334896653
compute similarity  is  tensor(0.9368, device='cuda:3')
compute_distance is  tensor(187.5747, device='cuda:3')
compute_norm is  tensor(56.1489, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(187.0051, device='cuda:3')
++++++++++++++++++++
after training  1
avg test entropy is  0.7019834492379414
avg test loss is  2.72705074642767
avg accuracy is  0.10595000015633195
solo acc is  0.10748333348966528
compute similarity  is  tensor(0.9370, device='cuda:3')
compute_distance is  tensor(187.0051, device='cuda:3')
compute_norm is  tensor(55.9474, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(187.9637, device='cuda:3')
++++++++++++++++++++
after training  2
avg test entropy is  0.9899744115658661
avg test loss is  1.5576132102561657
avg accuracy is  0.11751666682299859
solo acc is  0.26858333348967217
compute similarity  is  tensor(0.9371, device='cuda:3')
compute_distance is  tensor(187.9637, device='cuda:3')
compute_norm is  tensor(55.6166, device='cuda:3', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(187.9637, device='cuda:3')
distance x is tensor(187.9637, device='cuda:3')
________________________________
test distance is  tensor(187.9637, device='cuda:3')
test distance1 is  tensor(187.9637, device='cuda:3')
test similarity is  tensor(0.9371, device='cuda:3')
test acc is  0.27048333348967213
test loss is 1.5549842585632796
test entropy is  0.9895783679317564
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.488274097442627
mal norm is  tensor(863.1642, device='cuda:3')
distance x is tensor(187.9642, device='cuda:3')
mal distance is  tensor(187.9642, device='cuda:3')
user_PLR len size 36
counter_tensor is  tensor([13., 13., 12., 12., 12.,  0., 12.,  0., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 34., 34., 35.,  0., 12., 12., 17., 35.,
         0., 13., 12., 31., 35., 33.,  0., 20.])
count_res tensor([7.1716e-11, 7.1716e-11, 2.6383e-11, 2.6383e-11, 2.6383e-11, 1.6210e-16,
        2.6383e-11, 1.6210e-16, 4.2939e-06, 4.2939e-06, 4.2939e-06, 4.2939e-06,
        4.2939e-06, 4.2939e-06, 4.2939e-06, 4.2939e-06, 4.2939e-06, 4.2939e-06,
        4.2939e-06, 4.2939e-06, 9.4580e-02, 9.4580e-02, 2.5710e-01, 1.6210e-16,
        2.6383e-11, 2.6383e-11, 3.9156e-09, 2.5710e-01, 1.6210e-16, 7.1716e-11,
        2.6383e-11, 4.7089e-03, 2.5710e-01, 3.4794e-02, 1.6210e-16, 7.8646e-08])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 89.83% 

Test Accuracy: 89.07% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 89.83%
|----0th round Training Accuracy : 18.24%
|----1th round Training Accuracy : 86.95%
|----2th round Training Accuracy : 88.48%
|----3th round Training Accuracy : 88.24%
|----4th round Training Accuracy : 88.94%
|----5th round Training Accuracy : 89.00%
|----6th round Training Accuracy : 17.66%
|----7th round Training Accuracy : 89.06%
|----8th round Training Accuracy : 89.28%
|----9th round Training Accuracy : 88.84%
|----10th round Training Accuracy : 19.05%
|----11th round Training Accuracy : 89.79%
|----12th round Training Accuracy : 18.39%
|----13th round Training Accuracy : 89.18%
|----14th round Training Accuracy : 89.39%
|----15th round Training Accuracy : 89.70%
|----16th round Training Accuracy : 18.02%
|----17th round Training Accuracy : 89.53%
|----18th round Training Accuracy : 20.48%
|----19th round Training Accuracy : 89.94%
|----20th round Training Accuracy : 89.08%
|----21th round Training Accuracy : 89.58%
|----22th round Training Accuracy : 24.68%
|----23th round Training Accuracy : 89.63%
|----24th round Training Accuracy : 88.26%
|----25th round Training Accuracy : 89.38%
|----26th round Training Accuracy : 89.62%
|----27th round Training Accuracy : 89.83%
|----28th round Training Accuracy : 18.56%
|----29th round Training Accuracy : 90.02%
|----30th round Training Accuracy : 17.55%
|----31th round Training Accuracy : 89.58%
|----32th round Training Accuracy : 89.68%
|----33th round Training Accuracy : 89.11%
|----34th round Training Accuracy : 89.67%
|----35th round Training Accuracy : 89.78%
|----36th round Training Accuracy : 19.03%
|----37th round Training Accuracy : 88.15%
|----38th round Training Accuracy : 89.12%
|----39th round Training Accuracy : 89.77%
|----40th round Training Accuracy : 20.02%
|----41th round Training Accuracy : 89.83%
|----42th round Training Accuracy : 19.72%
|----43th round Training Accuracy : 89.93%
|----44th round Training Accuracy : 89.84%
|----45th round Training Accuracy : 89.02%
|----46th round Training Accuracy : 26.82%
|----47th round Training Accuracy : 90.10%
|----48th round Training Accuracy : 18.98%
|----49th round Training Accuracy : 89.83%
|----Final Test Accuracy: 89.07%
|----0th round Final Test Accuracy : 18.00%
|----1th round Final Test Accuracy : 85.85%
|----2th round Final Test Accuracy : 87.73%
|----3th round Final Test Accuracy : 87.50%
|----4th round Final Test Accuracy : 88.29%
|----5th round Final Test Accuracy : 88.66%
|----6th round Final Test Accuracy : 17.71%
|----7th round Final Test Accuracy : 88.44%
|----8th round Final Test Accuracy : 88.47%
|----9th round Final Test Accuracy : 87.89%
|----10th round Final Test Accuracy : 18.49%
|----11th round Final Test Accuracy : 88.95%
|----12th round Final Test Accuracy : 18.12%
|----13th round Final Test Accuracy : 88.16%
|----14th round Final Test Accuracy : 88.35%
|----15th round Final Test Accuracy : 88.93%
|----16th round Final Test Accuracy : 17.36%
|----17th round Final Test Accuracy : 88.91%
|----18th round Final Test Accuracy : 19.92%
|----19th round Final Test Accuracy : 88.98%
|----20th round Final Test Accuracy : 88.27%
|----21th round Final Test Accuracy : 88.70%
|----22th round Final Test Accuracy : 24.34%
|----23th round Final Test Accuracy : 89.25%
|----24th round Final Test Accuracy : 87.57%
|----25th round Final Test Accuracy : 88.65%
|----26th round Final Test Accuracy : 88.91%
|----27th round Final Test Accuracy : 88.82%
|----28th round Final Test Accuracy : 18.34%
|----29th round Final Test Accuracy : 89.18%
|----30th round Final Test Accuracy : 17.09%
|----31th round Final Test Accuracy : 88.67%
|----32th round Final Test Accuracy : 88.97%
|----33th round Final Test Accuracy : 88.15%
|----34th round Final Test Accuracy : 88.75%
|----35th round Final Test Accuracy : 88.93%
|----36th round Final Test Accuracy : 19.08%
|----37th round Final Test Accuracy : 87.90%
|----38th round Final Test Accuracy : 88.63%
|----39th round Final Test Accuracy : 89.02%
|----40th round Final Test Accuracy : 19.98%
|----41th round Final Test Accuracy : 89.01%
|----42th round Final Test Accuracy : 19.07%
|----43th round Final Test Accuracy : 89.32%
|----44th round Final Test Accuracy : 89.28%
|----45th round Final Test Accuracy : 88.54%
|----46th round Final Test Accuracy : 25.44%
|----47th round Final Test Accuracy : 89.54%
|----48th round Final Test Accuracy : 18.43%
|----49th round Final Test Accuracy : 89.07%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 19792.4617
