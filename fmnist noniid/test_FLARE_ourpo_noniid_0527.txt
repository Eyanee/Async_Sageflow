
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.085422445088625
distance x is tensor(174.6152, device='cuda:1')
benign distance is  tensor(174.6152, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.3430124297738075
distance x is tensor(119.1537, device='cuda:1')
benign distance is  tensor(119.1537, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.4007452577352524
distance x is tensor(103.5619, device='cuda:1')
benign distance is  tensor(103.5619, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.5570208579301834
distance x is tensor(179.3657, device='cuda:1')
benign distance is  tensor(179.3657, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.8441508561372757
distance x is tensor(129.7113, device='cuda:1')
benign distance is  tensor(129.7113, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5301802307367325
distance x is tensor(121.7491, device='cuda:1')
benign distance is  tensor(121.7491, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2278845831751823
distance x is tensor(138.2701, device='cuda:1')
benign distance is  tensor(138.2701, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.684435471892357
distance x is tensor(115.0869, device='cuda:1')
benign distance is  tensor(115.0869, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.7674264311790466
distance x is tensor(124.1826, device='cuda:1')
benign distance is  tensor(124.1826, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.9998653158545494
distance x is tensor(144.8199, device='cuda:1')
benign distance is  tensor(144.8199, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.9999068528413773
distance x is tensor(124.3526, device='cuda:1')
benign distance is  tensor(124.3526, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.7229441702365875
distance x is tensor(139.6630, device='cuda:1')
benign distance is  tensor(139.6630, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.578142397105694
distance x is tensor(165.1523, device='cuda:1')
benign distance is  tensor(165.1523, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.8965240344405174
distance x is tensor(109.4930, device='cuda:1')
benign distance is  tensor(109.4930, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.6799326986074448
distance x is tensor(162.0159, device='cuda:1')
benign distance is  tensor(162.0159, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  5.445470497012138
distance x is tensor(141.4245, device='cuda:1')
benign distance is  tensor(141.4245, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  4.849958568811417
distance x is tensor(129.3964, device='cuda:1')
benign distance is  tensor(129.3964, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.9575436785817146
distance x is tensor(136.2204, device='cuda:1')
benign distance is  tensor(136.2204, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  2.600122094154358
distance x is tensor(135.8301, device='cuda:1')
benign distance is  tensor(135.8301, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.072927474975586
distance x is tensor(156.6726, device='cuda:1')
benign distance is  tensor(156.6726, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.7130745127797127
distance x is tensor(138.0027, device='cuda:1')
benign distance is  tensor(138.0027, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.5016328245401382
distance x is tensor(229.4148, device='cuda:1')
benign distance is  tensor(229.4148, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  2.038444310426712
distance x is tensor(182.5851, device='cuda:1')
benign distance is  tensor(182.5851, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.9610061943531036
distance x is tensor(148.2405, device='cuda:1')
benign distance is  tensor(148.2405, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.728952147066593
distance x is tensor(152.8514, device='cuda:1')
benign distance is  tensor(152.8514, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  2.132578484714031
distance x is tensor(97.4412, device='cuda:1')
benign distance is  tensor(97.4412, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.17641381919384
distance x is tensor(152.6260, device='cuda:1')
benign distance is  tensor(152.6260, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  5.235823184251785
distance x is tensor(129.4056, device='cuda:1')
benign distance is  tensor(129.4056, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.9993382170796394
distance x is tensor(142.1494, device='cuda:1')
benign distance is  tensor(142.1494, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.1838595122098923
distance x is tensor(143.9968, device='cuda:1')
benign distance is  tensor(143.9968, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  1.1021473035216331
distance x is tensor(143.4013, device='cuda:1')
benign distance is  tensor(143.4013, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  3.3285723328590393
distance x is tensor(167.1610, device='cuda:1')
benign distance is  tensor(167.1610, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  1.2646480314433575
distance x is tensor(149.2667, device='cuda:1')
benign distance is  tensor(149.2667, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  3.5784216672182083
distance x is tensor(141.3411, device='cuda:1')
benign distance is  tensor(141.3411, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  3.40272456407547
distance x is tensor(141.6928, device='cuda:1')
benign distance is  tensor(141.6928, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  4.833024904131889
distance x is tensor(134.0406, device='cuda:1')
benign distance is  tensor(134.0406, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.4681321308016777
distance x is tensor(152.9828, device='cuda:1')
benign distance is  tensor(152.9828, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.9661364406347275
distance x is tensor(130.1675, device='cuda:1')
benign distance is  tensor(130.1675, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.8998275324702263
distance x is tensor(109.4010, device='cuda:1')
benign distance is  tensor(109.4010, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.2441481128335
distance x is tensor(140.7133, device='cuda:1')
benign distance is  tensor(140.7133, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  4.486856460571289
distance x is tensor(117.8706, device='cuda:1')
benign distance is  tensor(117.8706, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  4.306211560964584
distance x is tensor(158.1706, device='cuda:1')
benign distance is  tensor(158.1706, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.452866107225418
distance x is tensor(181.4702, device='cuda:1')
benign distance is  tensor(181.4702, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  2.486126884818077
distance x is tensor(99.2828, device='cuda:1')
benign distance is  tensor(99.2828, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.6475285738706589
distance x is tensor(157.4673, device='cuda:1')
benign distance is  tensor(157.4673, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.7954817563295364
distance x is tensor(137.5315, device='cuda:1')
benign distance is  tensor(137.5315, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  5.00469246506691
distance x is tensor(128.8931, device='cuda:1')
benign distance is  tensor(128.8931, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.7636594511568546
distance x is tensor(153.7115, device='cuda:1')
benign distance is  tensor(153.7115, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(109.9910, device='cuda:1')
compute distance is  tensor(109.9910, device='cuda:1')
compute norm is  tensor(19.0460, device='cuda:1', dtype=torch.float64)
distance x is tensor(156.5147, device='cuda:1')
compute distance is  tensor(156.5147, device='cuda:1')
compute norm is  tensor(21.4556, device='cuda:1', dtype=torch.float64)
distance x is tensor(132.6544, device='cuda:1')
compute distance is  tensor(132.6544, device='cuda:1')
compute norm is  tensor(19.6607, device='cuda:1', dtype=torch.float64)
distance x is tensor(140.9391, device='cuda:1')
compute distance is  tensor(140.9391, device='cuda:1')
compute norm is  tensor(20.1824, device='cuda:1', dtype=torch.float64)
distance x is tensor(112.2245, device='cuda:1')
compute distance is  tensor(112.2245, device='cuda:1')
compute norm is  tensor(18.7198, device='cuda:1', dtype=torch.float64)
distance x is tensor(117.9819, device='cuda:1')
compute distance is  tensor(117.9819, device='cuda:1')
compute norm is  tensor(19.3093, device='cuda:1', dtype=torch.float64)
distance x is tensor(147.4080, device='cuda:1')
compute distance is  tensor(147.4080, device='cuda:1')
compute norm is  tensor(21.1437, device='cuda:1', dtype=torch.float64)
distance x is tensor(114.6409, device='cuda:1')
compute distance is  tensor(114.6409, device='cuda:1')
compute norm is  tensor(19.0570, device='cuda:1', dtype=torch.float64)
distance x is tensor(130.5560, device='cuda:1')
compute distance is  tensor(130.5560, device='cuda:1')
compute norm is  tensor(20.0075, device='cuda:1', dtype=torch.float64)
distance x is tensor(121.9978, device='cuda:1')
compute distance is  tensor(121.9978, device='cuda:1')
compute norm is  tensor(19.4514, device='cuda:1', dtype=torch.float64)
distance x is tensor(122.7531, device='cuda:1')
compute distance is  tensor(122.7531, device='cuda:1')
compute norm is  tensor(19.4825, device='cuda:1', dtype=torch.float64)
distance x is tensor(164.4519, device='cuda:1')
compute distance is  tensor(164.4519, device='cuda:1')
compute norm is  tensor(22.4074, device='cuda:1', dtype=torch.float64)
batch acc is 0.09995000015633199
mal_rand_acc is 0.10900000016000001
mal_rand loss is 251306567532544.0
len of model dicts is  12
distance x is tensor(109.9910, device='cuda:1')
compute distance is  tensor(109.9910, device='cuda:1')
compute norm is  tensor(19.0460, device='cuda:1', dtype=torch.float64)
distance x is tensor(156.5147, device='cuda:1')
compute distance is  tensor(156.5147, device='cuda:1')
compute norm is  tensor(21.4556, device='cuda:1', dtype=torch.float64)
distance x is tensor(132.6544, device='cuda:1')
compute distance is  tensor(132.6544, device='cuda:1')
compute norm is  tensor(19.6607, device='cuda:1', dtype=torch.float64)
distance x is tensor(140.9391, device='cuda:1')
compute distance is  tensor(140.9391, device='cuda:1')
compute norm is  tensor(20.1824, device='cuda:1', dtype=torch.float64)
distance x is tensor(112.2245, device='cuda:1')
compute distance is  tensor(112.2245, device='cuda:1')
compute norm is  tensor(18.7198, device='cuda:1', dtype=torch.float64)
distance x is tensor(117.9819, device='cuda:1')
compute distance is  tensor(117.9819, device='cuda:1')
compute norm is  tensor(19.3093, device='cuda:1', dtype=torch.float64)
distance x is tensor(147.4080, device='cuda:1')
compute distance is  tensor(147.4080, device='cuda:1')
compute norm is  tensor(21.1437, device='cuda:1', dtype=torch.float64)
distance x is tensor(114.6409, device='cuda:1')
compute distance is  tensor(114.6409, device='cuda:1')
compute norm is  tensor(19.0570, device='cuda:1', dtype=torch.float64)
distance x is tensor(130.5560, device='cuda:1')
compute distance is  tensor(130.5560, device='cuda:1')
compute norm is  tensor(20.0075, device='cuda:1', dtype=torch.float64)
distance x is tensor(121.9978, device='cuda:1')
compute distance is  tensor(121.9978, device='cuda:1')
compute norm is  tensor(19.4514, device='cuda:1', dtype=torch.float64)
distance x is tensor(122.7531, device='cuda:1')
compute distance is  tensor(122.7531, device='cuda:1')
compute norm is  tensor(19.4825, device='cuda:1', dtype=torch.float64)
distance x is tensor(164.4519, device='cuda:1')
compute distance is  tensor(164.4519, device='cuda:1')
compute norm is  tensor(22.4074, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(164.4519, device='cuda:1')
distance x is tensor(126212.6953, device='cuda:1')
distance x is tensor(126212.6953, device='cuda:1')
________________________________
test distance is  tensor(126212.6953, device='cuda:1')
test distance1 is  tensor(126212.6953, device='cuda:1')
test similarity is  tensor(0.0085, device='cuda:1')
test acc is  0.10000000015633198
test loss is 253405241342742.38
test entropy is  0.0
________________________________
cal ratio is  0.03537480374479151
distance x is tensor(4464.7559, device='cuda:1')
cal_distance is  tensor(4464.7559, device='cuda:1')
cal ratio is  0.18808177090918987
distance x is tensor(839.7437, device='cuda:1')
cal_distance is  tensor(839.7437, device='cuda:1')
cal ratio is  0.43368278566660406
distance x is tensor(364.1856, device='cuda:1')
cal_distance is  tensor(364.1856, device='cuda:1')
cal ratio is  0.6585431014255227
distance x is tensor(239.8338, device='cuda:1')
cal_distance is  tensor(239.8338, device='cuda:1')
cal ratio is  0.811503459294315
distance x is tensor(194.6270, device='cuda:1')
cal_distance is  tensor(194.6270, device='cuda:1')
cal ratio is  0.9008323537816507
distance x is tensor(175.3269, device='cuda:1')
cal_distance is  tensor(175.3269, device='cuda:1')
cal ratio is  0.9491203624959201
distance x is tensor(166.4066, device='cuda:1')
cal_distance is  tensor(166.4066, device='cuda:1')
cal ratio is  0.9742272878485339
distance x is tensor(162.1180, device='cuda:1')
cal_distance is  tensor(162.1180, device='cuda:1')
distance x is tensor(162.1180, device='cuda:1')
return_distance is  tensor(162.1180, device='cuda:1')
distance x is tensor(162.1069, device='cuda:1')
distance x is tensor(162.1069, device='cuda:1')
________________________________
test distance is  tensor(162.1069, device='cuda:1')
test distance1 is  tensor(162.1069, device='cuda:1')
test similarity is  tensor(0.6779, device='cuda:1')
test acc is  0.10000000015633198
test loss is 1575.1989293210288
test entropy is  0.0
________________________________
0
distance x is tensor(162.1069, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  1574.2270639252815
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6779, device='cuda:1')
compute_distance is  tensor(162.1069, device='cuda:1')
compute_norm is  tensor(20.3743, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2051.1055, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  2.0100658171212493
avg test loss is  2.5161146044985316
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0912, device='cuda:1')
compute_distance is  tensor(2051.1055, device='cuda:1')
compute_norm is  tensor(106.7186, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2042.7676, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.3737770667208282
avg test loss is  3.0038372789110457
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0911, device='cuda:1')
compute_distance is  tensor(2042.7676, device='cuda:1')
compute_norm is  tensor(107.3579, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2033.8440, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.0270250576264315
avg test loss is  3.352063522410037
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0911, device='cuda:1')
compute_distance is  tensor(2033.8440, device='cuda:1')
compute_norm is  tensor(107.3455, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(2024.6692, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.9025925965324394
avg test loss is  3.5044383776467494
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0911, device='cuda:1')
compute_distance is  tensor(2024.6692, device='cuda:1')
compute_norm is  tensor(107.0326, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(2014.5653, device='cuda:1')
distance x is tensor(2014.5653, device='cuda:1')
________________________________
test distance is  tensor(2014.5653, device='cuda:1')
test distance1 is  tensor(2014.5653, device='cuda:1')
test similarity is  tensor(0.0911, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.9250723675115786
test entropy is  1.4651355510835709
________________________________
cal ratio is  0.27999797824040296
distance x is tensor(564.0698, device='cuda:1')
cal_distance is  tensor(564.0698, device='cuda:1')
cal ratio is  0.5291504451438043
distance x is tensor(298.4761, device='cuda:1')
cal_distance is  tensor(298.4761, device='cuda:1')
cal ratio is  0.7274293347249576
distance x is tensor(217.1193, device='cuda:1')
cal_distance is  tensor(217.1193, device='cuda:1')
cal ratio is  0.852896483113716
distance x is tensor(185.1798, device='cuda:1')
cal_distance is  tensor(185.1798, device='cuda:1')
cal ratio is  0.9235252077821923
distance x is tensor(171.0180, device='cuda:1')
cal_distance is  tensor(171.0180, device='cuda:1')
cal ratio is  0.9610028832250446
distance x is tensor(164.3486, device='cuda:1')
cal_distance is  tensor(164.3486, device='cuda:1')
distance x is tensor(164.3486, device='cuda:1')
return_distance is  tensor(164.3486, device='cuda:1')
distance x is tensor(164.3556, device='cuda:1')
distance x is tensor(164.3556, device='cuda:1')
________________________________
test distance is  tensor(164.3556, device='cuda:1')
test distance1 is  tensor(164.3556, device='cuda:1')
test similarity is  tensor(0.8220, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.304470546972523
test entropy is  2.3006825134444084
________________________________
0
distance x is tensor(164.3556, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  2.300683116862006
avg test loss is  2.3044428212810426
avg accuracy is  0.09995000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8220, device='cuda:1')
compute_distance is  tensor(164.3556, device='cuda:1')
compute_norm is  tensor(18.4217, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(165.8985, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.8555576469598294
avg test loss is  2.625159907696852
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8074, device='cuda:1')
compute_distance is  tensor(165.8985, device='cuda:1')
compute_norm is  tensor(20.2517, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(166.7680, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.1361294669637294
avg test loss is  3.233780208427006
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7942, device='cuda:1')
compute_distance is  tensor(166.7680, device='cuda:1')
compute_norm is  tensor(21.2488, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(166.7017, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.9061078387282805
avg test loss is  3.5004569444575035
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7897, device='cuda:1')
compute_distance is  tensor(166.7017, device='cuda:1')
compute_norm is  tensor(21.4782, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(165.1258, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  1.508383126147012
avg test loss is  2.8895304426709725
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8000, device='cuda:1')
compute_distance is  tensor(165.1258, device='cuda:1')
compute_norm is  tensor(20.5729, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(165.5963, device='cuda:1')
distance x is tensor(165.5963, device='cuda:1')
________________________________
test distance is  tensor(165.5963, device='cuda:1')
test distance1 is  tensor(165.5963, device='cuda:1')
test similarity is  tensor(0.7908, device='cuda:1')
test acc is  0.10000000015633198
test loss is 3.3747107977551947
test entropy is  1.007683385219147
________________________________
cal ratio is  0.9766078074328718
distance x is tensor(161.7161, device='cuda:1')
cal_distance is  tensor(161.7161, device='cuda:1')
distance x is tensor(161.7161, device='cuda:1')
return_distance is  tensor(161.7161, device='cuda:1')
distance x is tensor(161.7227, device='cuda:1')
distance x is tensor(161.7227, device='cuda:1')
________________________________
test distance is  tensor(161.7227, device='cuda:1')
test distance1 is  tensor(161.7227, device='cuda:1')
test similarity is  tensor(0.7980, device='cuda:1')
test acc is  0.10000000015633198
test loss is 3.307410525106418
test entropy is  1.0670721956661768
________________________________
0
distance x is tensor(161.7227, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.0673072274559852
avg test loss is  3.306931536589096
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7980, device='cuda:1')
compute_distance is  tensor(161.7227, device='cuda:1')
compute_norm is  tensor(20.9727, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(161.6517, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.887783831561298
avg test loss is  3.5234268972360248
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7942, device='cuda:1')
compute_distance is  tensor(161.6517, device='cuda:1')
compute_norm is  tensor(21.1377, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(160.1151, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.507068889354592
avg test loss is  2.890561117292213
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8054, device='cuda:1')
compute_distance is  tensor(160.1151, device='cuda:1')
compute_norm is  tensor(20.2072, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(160.6534, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.0070789156437936
avg test loss is  3.3749090483956246
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7957, device='cuda:1')
compute_distance is  tensor(160.6534, device='cuda:1')
compute_norm is  tensor(20.8147, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(160.5443, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8743422702431425
avg test loss is  3.5402569270083135
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7927, device='cuda:1')
compute_distance is  tensor(160.5443, device='cuda:1')
compute_norm is  tensor(20.9227, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(159.0154, device='cuda:1')
________________________________
test distance is  tensor(159.0154, device='cuda:1')
test similarity is  tensor(0.8045, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.8929622427486916
test entropy is  1.503841878635797
________________________________
final entropy
distance x is tensor(159.0219, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.5036371587944437
avg test loss is  2.8931813839910383
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8045, device='cuda:1')
compute_distance is  tensor(159.0219, device='cuda:1')
compute_norm is  tensor(19.9709, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 3.341876894235611
mal norm is  tensor(566.6965, device='cuda:1')
distance x is tensor(159.5832, device='cuda:1')
mal distance is  tensor(159.5832, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.6871450543403625
distance x is tensor(7.8105, device='cuda:1')
benign distance is  tensor(7.8105, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.448918104171753
distance x is tensor(10.1687, device='cuda:1')
benign distance is  tensor(10.1687, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.266672119498253
distance x is tensor(9.0228, device='cuda:1')
benign distance is  tensor(9.0228, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.136206865310669
distance x is tensor(9.6687, device='cuda:1')
benign distance is  tensor(9.6687, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.1791353672742844
distance x is tensor(7.6839, device='cuda:1')
benign distance is  tensor(7.6839, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.6871094703674316
distance x is tensor(7.5659, device='cuda:1')
benign distance is  tensor(7.5659, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.0611568093299866
distance x is tensor(8.6241, device='cuda:1')
benign distance is  tensor(8.6241, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.890768676996231
distance x is tensor(7.9751, device='cuda:1')
benign distance is  tensor(7.9751, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(7.0676, device='cuda:1')
compute distance is  tensor(7.0676, device='cuda:1')
compute norm is  tensor(20.3553, device='cuda:1', dtype=torch.float64)
distance x is tensor(9.5782, device='cuda:1')
compute distance is  tensor(9.5782, device='cuda:1')
compute norm is  tensor(21.9151, device='cuda:1', dtype=torch.float64)
distance x is tensor(7.6321, device='cuda:1')
compute distance is  tensor(7.6321, device='cuda:1')
compute norm is  tensor(21.2998, device='cuda:1', dtype=torch.float64)
distance x is tensor(9.8811, device='cuda:1')
compute distance is  tensor(9.8811, device='cuda:1')
compute norm is  tensor(21.7039, device='cuda:1', dtype=torch.float64)
distance x is tensor(10.6796, device='cuda:1')
compute distance is  tensor(10.6796, device='cuda:1')
compute norm is  tensor(22.3253, device='cuda:1', dtype=torch.float64)
distance x is tensor(10.3891, device='cuda:1')
compute distance is  tensor(10.3891, device='cuda:1')
compute norm is  tensor(21.7379, device='cuda:1', dtype=torch.float64)
distance x is tensor(8.9928, device='cuda:1')
compute distance is  tensor(8.9928, device='cuda:1')
compute norm is  tensor(21.4139, device='cuda:1', dtype=torch.float64)
distance x is tensor(7.7242, device='cuda:1')
compute distance is  tensor(7.7242, device='cuda:1')
compute norm is  tensor(22.0696, device='cuda:1', dtype=torch.float64)
distance x is tensor(9.2210, device='cuda:1')
compute distance is  tensor(9.2210, device='cuda:1')
compute norm is  tensor(21.3085, device='cuda:1', dtype=torch.float64)
distance x is tensor(7.9143, device='cuda:1')
compute distance is  tensor(7.9143, device='cuda:1')
compute norm is  tensor(21.7313, device='cuda:1', dtype=torch.float64)
distance x is tensor(8.6851, device='cuda:1')
compute distance is  tensor(8.6851, device='cuda:1')
compute norm is  tensor(21.4275, device='cuda:1', dtype=torch.float64)
distance x is tensor(8.0650, device='cuda:1')
compute distance is  tensor(8.0650, device='cuda:1')
compute norm is  tensor(21.1684, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(10.6796, device='cuda:1')
distance x is tensor(126332.2109, device='cuda:1')
distance x is tensor(126332.2109, device='cuda:1')
________________________________
test distance is  tensor(126332.2109, device='cuda:1')
test distance1 is  tensor(126332.2109, device='cuda:1')
test similarity is  tensor(-0.1650, device='cuda:1')
test acc is  0.10000000015633198
test loss is 253458099768252.3
test entropy is  0.0
________________________________
cal ratio is  0.009010429941036208
distance x is tensor(1138.3132, device='cuda:1')
cal_distance is  tensor(1138.3132, device='cuda:1')
cal ratio is  0.09492304480777668
distance x is tensor(108.0573, device='cuda:1')
cal_distance is  tensor(108.0573, device='cuda:1')
cal ratio is  0.30808851891760575
distance x is tensor(33.2953, device='cuda:1')
cal_distance is  tensor(33.2953, device='cuda:1')
cal ratio is  0.5550229227964049
distance x is tensor(18.4825, device='cuda:1')
cal_distance is  tensor(18.4825, device='cuda:1')
cal ratio is  0.7449415616023072
distance x is tensor(13.7701, device='cuda:1')
cal_distance is  tensor(13.7701, device='cuda:1')
cal ratio is  0.8630464420712903
distance x is tensor(11.8852, device='cuda:1')
cal_distance is  tensor(11.8852, device='cuda:1')
cal ratio is  0.928966053172582
distance x is tensor(11.0414, device='cuda:1')
cal_distance is  tensor(11.0414, device='cuda:1')
cal ratio is  0.9638070305847878
distance x is tensor(10.6421, device='cuda:1')
cal_distance is  tensor(10.6421, device='cuda:1')
distance x is tensor(10.6421, device='cuda:1')
return_distance is  tensor(10.6421, device='cuda:1')
distance x is tensor(10.6309, device='cuda:1')
distance x is tensor(10.6309, device='cuda:1')
________________________________
test distance is  tensor(10.6309, device='cuda:1')
test distance1 is  tensor(10.6309, device='cuda:1')
test similarity is  tensor(0.9982, device='cuda:1')
test acc is  0.10000000015633198
test loss is 3.3806986869779476
test entropy is  1.0017462784547542
________________________________
0
distance x is tensor(10.6309, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.003013965862392
avg test loss is  3.3786402127381834
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9982, device='cuda:1')
compute_distance is  tensor(10.6309, device='cuda:1')
compute_norm is  tensor(20.4430, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(11.5647, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.871429768579601
avg test loss is  3.5426094346463297
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9980, device='cuda:1')
compute_distance is  tensor(11.5647, device='cuda:1')
compute_norm is  tensor(20.5491, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(12.9904, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.5019300915539138
avg test loss is  2.8943813012352884
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9971, device='cuda:1')
compute_distance is  tensor(12.9904, device='cuda:1')
compute_norm is  tensor(19.5931, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(12.9779, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.0115879159619305
avg test loss is  3.3684473571492664
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9981, device='cuda:1')
compute_distance is  tensor(12.9779, device='cuda:1')
compute_norm is  tensor(20.2016, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(14.1032, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8740362181846522
avg test loss is  3.5387058768953596
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9979, device='cuda:1')
compute_distance is  tensor(14.1032, device='cuda:1')
compute_norm is  tensor(20.3181, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(15.7490, device='cuda:1')
distance x is tensor(15.7490, device='cuda:1')
________________________________
test distance is  tensor(15.7490, device='cuda:1')
test distance1 is  tensor(15.7490, device='cuda:1')
test similarity is  tensor(0.9972, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.8957870131108296
test entropy is  1.500013717837425
________________________________
cal ratio is  0.8070052876316971
distance x is tensor(12.7197, device='cuda:1')
cal_distance is  tensor(12.7197, device='cuda:1')
cal ratio is  0.8979751150855826
distance x is tensor(11.4225, device='cuda:1')
cal_distance is  tensor(11.4225, device='cuda:1')
cal ratio is  0.9475916442107979
distance x is tensor(10.8242, device='cuda:1')
cal_distance is  tensor(10.8242, device='cuda:1')
cal ratio is  0.9734298413436159
distance x is tensor(10.5367, device='cuda:1')
cal_distance is  tensor(10.5367, device='cuda:1')
distance x is tensor(10.5367, device='cuda:1')
return_distance is  tensor(10.5367, device='cuda:1')
distance x is tensor(10.5255, device='cuda:1')
distance x is tensor(10.5255, device='cuda:1')
________________________________
test distance is  tensor(10.5255, device='cuda:1')
test distance1 is  tensor(10.5255, device='cuda:1')
test similarity is  tensor(0.9988, device='cuda:1')
test acc is  0.10000000015633198
test loss is 3.0286306323273093
test entropy is  1.3458392008789566
________________________________
0

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7175028752535582
distance x is tensor(121.4842, device='cuda:1')
benign distance is  tensor(121.4842, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.8631141446530819
distance x is tensor(105.8376, device='cuda:1')
benign distance is  tensor(105.8376, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6426927093416452
distance x is tensor(105.2684, device='cuda:1')
benign distance is  tensor(105.2684, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9245010688900948
distance x is tensor(150.8644, device='cuda:1')
benign distance is  tensor(150.8644, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.9338985532522202
distance x is tensor(107.0016, device='cuda:1')
benign distance is  tensor(107.0016, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7030193414539099
distance x is tensor(100.7114, device='cuda:1')
benign distance is  tensor(100.7114, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0744033083319664
distance x is tensor(108.4145, device='cuda:1')
benign distance is  tensor(108.4145, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7001772616058588
distance x is tensor(82.7784, device='cuda:1')
benign distance is  tensor(82.7784, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7828882038593292
distance x is tensor(114.3119, device='cuda:1')
benign distance is  tensor(114.3119, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.656279374845326
distance x is tensor(133.6308, device='cuda:1')
benign distance is  tensor(133.6308, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.051419010385871
distance x is tensor(95.3869, device='cuda:1')
benign distance is  tensor(95.3869, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.1803929507732391
distance x is tensor(124.2066, device='cuda:1')
benign distance is  tensor(124.2066, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.0728263519704342
distance x is tensor(169.8244, device='cuda:1')
benign distance is  tensor(169.8244, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.6138993632048368
distance x is tensor(66.9778, device='cuda:1')
benign distance is  tensor(66.9778, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.9278478026390076
distance x is tensor(149.1283, device='cuda:1')
benign distance is  tensor(149.1283, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.2576127238571644
distance x is tensor(135.3276, device='cuda:1')
benign distance is  tensor(135.3276, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.0971046686172485
distance x is tensor(126.0185, device='cuda:1')
benign distance is  tensor(126.0185, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6195245245471597
distance x is tensor(111.6954, device='cuda:1')
benign distance is  tensor(111.6954, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.9063990861177444
distance x is tensor(123.6551, device='cuda:1')
benign distance is  tensor(123.6551, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.6805670391768217
distance x is tensor(118.0159, device='cuda:1')
benign distance is  tensor(118.0159, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.972500461153686
distance x is tensor(85.7480, device='cuda:1')
benign distance is  tensor(85.7480, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7261785957962275
distance x is tensor(208.6980, device='cuda:1')
benign distance is  tensor(208.6980, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.095829676836729
distance x is tensor(147.8607, device='cuda:1')
benign distance is  tensor(147.8607, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.6441767811775208
distance x is tensor(113.4586, device='cuda:1')
benign distance is  tensor(113.4586, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.8836894053965807
distance x is tensor(126.7553, device='cuda:1')
benign distance is  tensor(126.7553, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.5737946834415197
distance x is tensor(78.4280, device='cuda:1')
benign distance is  tensor(78.4280, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.9338245466351509
distance x is tensor(135.7540, device='cuda:1')
benign distance is  tensor(135.7540, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.163502525538206
distance x is tensor(115.0322, device='cuda:1')
benign distance is  tensor(115.0322, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6156128430739045
distance x is tensor(121.2289, device='cuda:1')
benign distance is  tensor(121.2289, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.737584663555026
distance x is tensor(120.3775, device='cuda:1')
benign distance is  tensor(120.3775, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5209000678732991
distance x is tensor(116.8486, device='cuda:1')
benign distance is  tensor(116.8486, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.6983190700411797
distance x is tensor(172.6355, device='cuda:1')
benign distance is  tensor(172.6355, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8069497290998697
distance x is tensor(116.4547, device='cuda:1')
benign distance is  tensor(116.4547, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.7936126329004765
distance x is tensor(105.3810, device='cuda:1')
benign distance is  tensor(105.3810, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.6133328070864081
distance x is tensor(145.6270, device='cuda:1')
benign distance is  tensor(145.6270, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.3995206840336323
distance x is tensor(124.9790, device='cuda:1')
benign distance is  tensor(124.9790, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.798279382288456
distance x is tensor(111.5149, device='cuda:1')
benign distance is  tensor(111.5149, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.881069484166801
distance x is tensor(83.9199, device='cuda:1')
benign distance is  tensor(83.9199, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7228117175400257
distance x is tensor(101.3140, device='cuda:1')
benign distance is  tensor(101.3140, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9699015989899635
distance x is tensor(116.5615, device='cuda:1')
benign distance is  tensor(116.5615, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.2562912814319134
distance x is tensor(108.7771, device='cuda:1')
benign distance is  tensor(108.7771, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.3381646387279034
distance x is tensor(143.8754, device='cuda:1')
benign distance is  tensor(143.8754, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.322195615619421
distance x is tensor(145.0142, device='cuda:1')
benign distance is  tensor(145.0142, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.0842047333717346
distance x is tensor(99.1078, device='cuda:1')
benign distance is  tensor(99.1078, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.5455318130552769
distance x is tensor(158.0715, device='cuda:1')
benign distance is  tensor(158.0715, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.7044980973005295
distance x is tensor(141.0746, device='cuda:1')
benign distance is  tensor(141.0746, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7260187715291977
distance x is tensor(106.6659, device='cuda:1')
benign distance is  tensor(106.6659, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5542940143495798
distance x is tensor(126.9459, device='cuda:1')
benign distance is  tensor(126.9459, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(84.6155, device='cuda:1')
compute distance is  tensor(84.6155, device='cuda:1')
compute norm is  tensor(44.6422, device='cuda:1', dtype=torch.float64)
distance x is tensor(136.4708, device='cuda:1')
compute distance is  tensor(136.4708, device='cuda:1')
compute norm is  tensor(46.1755, device='cuda:1', dtype=torch.float64)
distance x is tensor(107.1574, device='cuda:1')
compute distance is  tensor(107.1574, device='cuda:1')
compute norm is  tensor(45.2215, device='cuda:1', dtype=torch.float64)
distance x is tensor(96.7293, device='cuda:1')
compute distance is  tensor(96.7293, device='cuda:1')
compute norm is  tensor(44.9747, device='cuda:1', dtype=torch.float64)
distance x is tensor(107.4930, device='cuda:1')
compute distance is  tensor(107.4930, device='cuda:1')
compute norm is  tensor(45.1190, device='cuda:1', dtype=torch.float64)
distance x is tensor(102.4560, device='cuda:1')
compute distance is  tensor(102.4560, device='cuda:1')
compute norm is  tensor(45.2577, device='cuda:1', dtype=torch.float64)
distance x is tensor(123.1593, device='cuda:1')
compute distance is  tensor(123.1593, device='cuda:1')
compute norm is  tensor(45.5903, device='cuda:1', dtype=torch.float64)
distance x is tensor(101.4344, device='cuda:1')
compute distance is  tensor(101.4344, device='cuda:1')
compute norm is  tensor(45.1211, device='cuda:1', dtype=torch.float64)
distance x is tensor(121.4018, device='cuda:1')
compute distance is  tensor(121.4018, device='cuda:1')
compute norm is  tensor(45.6788, device='cuda:1', dtype=torch.float64)
distance x is tensor(97.6885, device='cuda:1')
compute distance is  tensor(97.6885, device='cuda:1')
compute norm is  tensor(45.1227, device='cuda:1', dtype=torch.float64)
distance x is tensor(109.2544, device='cuda:1')
compute distance is  tensor(109.2544, device='cuda:1')
compute norm is  tensor(45.1599, device='cuda:1', dtype=torch.float64)
distance x is tensor(150.1379, device='cuda:1')
compute distance is  tensor(150.1379, device='cuda:1')
compute norm is  tensor(46.9029, device='cuda:1', dtype=torch.float64)
batch acc is 0.10243333348966525
mal_rand_acc is 0.10900000016000001
mal_rand loss is 106489764642816.0
len of model dicts is  12
distance x is tensor(84.6155, device='cuda:1')
compute distance is  tensor(84.6155, device='cuda:1')
compute norm is  tensor(44.6422, device='cuda:1', dtype=torch.float64)
distance x is tensor(136.4708, device='cuda:1')
compute distance is  tensor(136.4708, device='cuda:1')
compute norm is  tensor(46.1755, device='cuda:1', dtype=torch.float64)
distance x is tensor(107.1574, device='cuda:1')
compute distance is  tensor(107.1574, device='cuda:1')
compute norm is  tensor(45.2215, device='cuda:1', dtype=torch.float64)
distance x is tensor(96.7293, device='cuda:1')
compute distance is  tensor(96.7293, device='cuda:1')
compute norm is  tensor(44.9747, device='cuda:1', dtype=torch.float64)
distance x is tensor(107.4930, device='cuda:1')
compute distance is  tensor(107.4930, device='cuda:1')
compute norm is  tensor(45.1190, device='cuda:1', dtype=torch.float64)
distance x is tensor(102.4560, device='cuda:1')
compute distance is  tensor(102.4560, device='cuda:1')
compute norm is  tensor(45.2577, device='cuda:1', dtype=torch.float64)
distance x is tensor(123.1593, device='cuda:1')
compute distance is  tensor(123.1593, device='cuda:1')
compute norm is  tensor(45.5903, device='cuda:1', dtype=torch.float64)
distance x is tensor(101.4344, device='cuda:1')
compute distance is  tensor(101.4344, device='cuda:1')
compute norm is  tensor(45.1211, device='cuda:1', dtype=torch.float64)
distance x is tensor(121.4018, device='cuda:1')
compute distance is  tensor(121.4018, device='cuda:1')
compute norm is  tensor(45.6788, device='cuda:1', dtype=torch.float64)
distance x is tensor(97.6885, device='cuda:1')
compute distance is  tensor(97.6885, device='cuda:1')
compute norm is  tensor(45.1227, device='cuda:1', dtype=torch.float64)
distance x is tensor(109.2544, device='cuda:1')
compute distance is  tensor(109.2544, device='cuda:1')
compute norm is  tensor(45.1599, device='cuda:1', dtype=torch.float64)
distance x is tensor(150.1379, device='cuda:1')
compute distance is  tensor(150.1379, device='cuda:1')
compute norm is  tensor(46.9029, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(150.1379, device='cuda:1')
distance x is tensor(102085.9062, device='cuda:1')
distance x is tensor(102085.9062, device='cuda:1')
________________________________
test distance is  tensor(102085.9062, device='cuda:1')
test distance1 is  tensor(102085.9062, device='cuda:1')
test similarity is  tensor(-0.1082, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107539919973779.92
test entropy is  0.0
________________________________
cal ratio is  0.0375827366053542
distance x is tensor(3836.6733, device='cuda:1')
cal_distance is  tensor(3836.6733, device='cuda:1')
cal ratio is  0.19386253666107833
distance x is tensor(743.7910, device='cuda:1')
cal_distance is  tensor(743.7910, device='cuda:1')
cal ratio is  0.4402971106899901
distance x is tensor(327.4916, device='cuda:1')
cal_distance is  tensor(327.4916, device='cuda:1')
cal ratio is  0.663546270158889
distance x is tensor(217.3074, device='cuda:1')
cal_distance is  tensor(217.3074, device='cuda:1')
cal ratio is  0.8145805160021701
distance x is tensor(177.0152, device='cuda:1')
cal_distance is  tensor(177.0152, device='cuda:1')
cal ratio is  0.9025389809921086
distance x is tensor(159.7636, device='cuda:1')
cal_distance is  tensor(159.7636, device='cuda:1')
cal ratio is  0.9500191736545126
distance x is tensor(151.7787, device='cuda:1')
cal_distance is  tensor(151.7787, device='cuda:1')
cal ratio is  0.974688493007143
distance x is tensor(147.9371, device='cuda:1')
cal_distance is  tensor(147.9371, device='cuda:1')
distance x is tensor(147.9371, device='cuda:1')
return_distance is  tensor(147.9371, device='cuda:1')
distance x is tensor(147.9278, device='cuda:1')
distance x is tensor(147.9278, device='cuda:1')
________________________________
test distance is  tensor(147.9278, device='cuda:1')
test distance1 is  tensor(147.9278, device='cuda:1')
test similarity is  tensor(0.9308, device='cuda:1')
test acc is  0.10041666682299863
test loss is 386.8897669615268
test entropy is  0.00020532995555922503
________________________________
0
distance x is tensor(147.9278, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.00020437008462201466
avg test loss is  386.22619977027875
avg accuracy is  0.2916833334896727
solo acc is  0.10045000015633199
compute similarity  is  tensor(0.9308, device='cuda:1')
compute_distance is  tensor(147.9278, device='cuda:1')
compute_norm is  tensor(44.5291, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(121.2430, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.926556746906309
avg test loss is  1.531450120116602
avg accuracy is  0.8103000001563251
solo acc is  0.3168166668230065
compute similarity  is  tensor(0.9426, device='cuda:1')
compute_distance is  tensor(121.2430, device='cuda:1')
compute_norm is  tensor(43.5273, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(123.9482, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.9019651229320559
avg test loss is  1.546050576385913
avg accuracy is  0.8116833334896584
solo acc is  0.2732666668230056
compute similarity  is  tensor(0.9419, device='cuda:1')
compute_distance is  tensor(123.9482, device='cuda:1')
compute_norm is  tensor(43.2386, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(126.2127, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8740769190701849
avg test loss is  1.5202200500441512
avg accuracy is  0.8170500001563248
solo acc is  0.26533333348967203
compute similarity  is  tensor(0.9415, device='cuda:1')
compute_distance is  tensor(126.2127, device='cuda:1')
compute_norm is  tensor(42.9766, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(128.2776, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8645005676029588
avg test loss is  1.4837474515443163
avg accuracy is  0.821083333489658
solo acc is  0.2648166668230053
compute similarity  is  tensor(0.9410, device='cuda:1')
compute_distance is  tensor(128.2776, device='cuda:1')
compute_norm is  tensor(42.7317, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(130.1859, device='cuda:1')
distance x is tensor(130.1859, device='cuda:1')
________________________________
test distance is  tensor(130.1859, device='cuda:1')
test distance1 is  tensor(130.1859, device='cuda:1')
test similarity is  tensor(0.9406, device='cuda:1')
test acc is  0.26363333348967194
test loss is 1.444106610599103
test entropy is  0.8734423601424007
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2750000001600001
mal loss is 1.432459034025669
mal norm is  tensor(668.6460, device='cuda:1')
distance x is tensor(130.1931, device='cuda:1')
mal distance is  tensor(130.1931, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 9.55% 

Test Accuracy: 16.96% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9387949146330357
distance x is tensor(178.4640, device='cuda:1')
benign distance is  tensor(178.4640, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0890661850571632
distance x is tensor(146.2877, device='cuda:1')
benign distance is  tensor(146.2877, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0866059884428978
distance x is tensor(158.1410, device='cuda:1')
benign distance is  tensor(158.1410, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0827222224324942
distance x is tensor(181.1042, device='cuda:1')
benign distance is  tensor(181.1042, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.174086599610746
distance x is tensor(149.5657, device='cuda:1')
benign distance is  tensor(149.5657, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.8546336758881807
distance x is tensor(153.0041, device='cuda:1')
benign distance is  tensor(153.0041, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.1144552249461412
distance x is tensor(150.7680, device='cuda:1')
benign distance is  tensor(150.7680, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3333658576011658
distance x is tensor(135.3681, device='cuda:1')
benign distance is  tensor(135.3681, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(106.8163, device='cuda:1')
compute distance is  tensor(106.8163, device='cuda:1')
compute norm is  tensor(43.7878, device='cuda:1', dtype=torch.float64)
distance x is tensor(180.8129, device='cuda:1')
compute distance is  tensor(180.8129, device='cuda:1')
compute norm is  tensor(45.5153, device='cuda:1', dtype=torch.float64)
distance x is tensor(129.4367, device='cuda:1')
compute distance is  tensor(129.4367, device='cuda:1')
compute norm is  tensor(44.2065, device='cuda:1', dtype=torch.float64)
distance x is tensor(147.4235, device='cuda:1')
compute distance is  tensor(147.4235, device='cuda:1')
compute norm is  tensor(44.7018, device='cuda:1', dtype=torch.float64)
distance x is tensor(141.7573, device='cuda:1')
compute distance is  tensor(141.7573, device='cuda:1')
compute norm is  tensor(44.2133, device='cuda:1', dtype=torch.float64)
distance x is tensor(143.8145, device='cuda:1')
compute distance is  tensor(143.8145, device='cuda:1')
compute norm is  tensor(44.6352, device='cuda:1', dtype=torch.float64)
distance x is tensor(163.4321, device='cuda:1')
compute distance is  tensor(163.4321, device='cuda:1')
compute norm is  tensor(44.8840, device='cuda:1', dtype=torch.float64)
distance x is tensor(137.7536, device='cuda:1')
compute distance is  tensor(137.7536, device='cuda:1')
compute norm is  tensor(44.4362, device='cuda:1', dtype=torch.float64)
distance x is tensor(164.7315, device='cuda:1')
compute distance is  tensor(164.7315, device='cuda:1')
compute norm is  tensor(44.8616, device='cuda:1', dtype=torch.float64)
distance x is tensor(126.2971, device='cuda:1')
compute distance is  tensor(126.2971, device='cuda:1')
compute norm is  tensor(44.2560, device='cuda:1', dtype=torch.float64)
distance x is tensor(152.3074, device='cuda:1')
compute distance is  tensor(152.3074, device='cuda:1')
compute norm is  tensor(44.6895, device='cuda:1', dtype=torch.float64)
distance x is tensor(181.2798, device='cuda:1')
compute distance is  tensor(181.2798, device='cuda:1')
compute norm is  tensor(46.0326, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(181.2798, device='cuda:1')
distance x is tensor(102015.9688, device='cuda:1')
distance x is tensor(102015.9688, device='cuda:1')
________________________________
test distance is  tensor(102015.9688, device='cuda:1')
test distance1 is  tensor(102015.9688, device='cuda:1')
test similarity is  tensor(0.1830, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107524783857471.86
test entropy is  0.0
________________________________
cal ratio is  0.04131109627905781
distance x is tensor(4214.3965, device='cuda:1')
cal_distance is  tensor(4214.3965, device='cuda:1')
cal ratio is  0.20325119278309686
distance x is tensor(856.5848, device='cuda:1')
cal_distance is  tensor(856.5848, device='cuda:1')
cal ratio is  0.45083290947176147
distance x is tensor(386.1792, device='cuda:1')
cal_distance is  tensor(386.1792, device='cuda:1')
cal ratio is  0.671438718565107
distance x is tensor(259.2971, device='cuda:1')
cal_distance is  tensor(259.2971, device='cuda:1')
cal ratio is  0.819411272618033
distance x is tensor(212.4719, device='cuda:1')
cal_distance is  tensor(212.4719, device='cuda:1')
cal ratio is  0.9052115630928836
distance x is tensor(192.3324, device='cuda:1')
cal_distance is  tensor(192.3324, device='cuda:1')
cal ratio is  0.9514250494242498
distance x is tensor(182.9901, device='cuda:1')
cal_distance is  tensor(182.9901, device='cuda:1')
cal ratio is  0.975409441429199
distance x is tensor(178.4904, device='cuda:1')
cal_distance is  tensor(178.4904, device='cuda:1')
distance x is tensor(178.4904, device='cuda:1')
return_distance is  tensor(178.4904, device='cuda:1')
distance x is tensor(178.4812, device='cuda:1')
distance x is tensor(178.4812, device='cuda:1')
________________________________
test distance is  tensor(178.4812, device='cuda:1')
test distance1 is  tensor(178.4812, device='cuda:1')
test similarity is  tensor(0.9205, device='cuda:1')
test acc is  0.10000000015633198
test loss is 1090.4279060933127
test entropy is  0.0
________________________________
0
distance x is tensor(178.4812, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  1091.9411366021454
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9205, device='cuda:1')
compute_distance is  tensor(178.4812, device='cuda:1')
compute_norm is  tensor(47.0836, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1089.9043, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.5880102661372757
avg test loss is  2.852768342886398
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4485, device='cuda:1')
compute_distance is  tensor(1089.9043, device='cuda:1')
compute_norm is  tensor(107.4522, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1084.8790, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8566502285664523
avg test loss is  3.635279613263063
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4486, device='cuda:1')
compute_distance is  tensor(1084.8790, device='cuda:1')
compute_norm is  tensor(107.0513, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1079.9711, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.5523943104215268
avg test loss is  2.864644717051785
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4484, device='cuda:1')
compute_distance is  tensor(1079.9711, device='cuda:1')
compute_norm is  tensor(106.4810, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1075.0302, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8445314435816523
avg test loss is  3.6228014263771238
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4485, device='cuda:1')
compute_distance is  tensor(1075.0302, device='cuda:1')
compute_norm is  tensor(106.0891, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1070.1188, device='cuda:1')
distance x is tensor(1070.1188, device='cuda:1')
________________________________
test distance is  tensor(1070.1188, device='cuda:1')
test distance1 is  tensor(1070.1188, device='cuda:1')
test similarity is  tensor(0.4483, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.865876033870396
test entropy is  1.5473857444486638
________________________________
cal ratio is  0.4033525545325673
distance x is tensor(431.6350, device='cuda:1')
cal_distance is  tensor(431.6350, device='cuda:1')
cal ratio is  0.6351005006560994
distance x is tensor(274.1316, device='cuda:1')
cal_distance is  tensor(274.1316, device='cuda:1')
cal ratio is  0.796931930647584
distance x is tensor(218.4642, device='cuda:1')
cal_distance is  tensor(218.4642, device='cuda:1')
cal ratio is  0.8927105280397754
distance x is tensor(195.0253, device='cuda:1')
cal_distance is  tensor(195.0253, device='cuda:1')
cal ratio is  0.9448336758651378
distance x is tensor(184.2664, device='cuda:1')
cal_distance is  tensor(184.2664, device='cuda:1')
cal ratio is  0.9720255509813305
distance x is tensor(179.1117, device='cuda:1')
cal_distance is  tensor(179.1117, device='cuda:1')
distance x is tensor(179.1117, device='cuda:1')
return_distance is  tensor(179.1117, device='cuda:1')
distance x is tensor(179.1119, device='cuda:1')
distance x is tensor(179.1119, device='cuda:1')
________________________________
test distance is  tensor(179.1119, device='cuda:1')
test distance1 is  tensor(179.1119, device='cuda:1')
test similarity is  tensor(0.9336, device='cuda:1')
test acc is  0.10665000015633196
test loss is 3.720498462221516
test entropy is  1.0944790148785881
________________________________
0
distance x is tensor(179.1119, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.0944379608132946
avg test loss is  3.7216030572777363
avg accuracy is  0.10131666682299864
solo acc is  0.10720000015633195
compute similarity  is  tensor(0.9336, device='cuda:1')
compute_distance is  tensor(179.1119, device='cuda:1')
compute_norm is  tensor(47.5036, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(180.8682, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.6872218346544928
avg test loss is  3.235904491532332
avg accuracy is  0.10823333348966528
solo acc is  0.10211666682299864
compute similarity  is  tensor(0.9333, device='cuda:1')
compute_distance is  tensor(180.8682, device='cuda:1')
compute_norm is  tensor(47.3509, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(182.9243, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.1507237661621972
avg test loss is  1.968327833899557
avg accuracy is  0.1165166668229986
solo acc is  0.15886666682300055
compute similarity  is  tensor(0.9328, device='cuda:1')
compute_distance is  tensor(182.9243, device='cuda:1')
compute_norm is  tensor(47.0699, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(182.8426, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.684764343220542
avg test loss is  2.7041739187260934
avg accuracy is  0.10468333348966528
solo acc is  0.1017333334896653
compute similarity  is  tensor(0.9326, device='cuda:1')
compute_distance is  tensor(182.8426, device='cuda:1')
compute_norm is  tensor(46.9663, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(184.2400, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  1.1415055465342394
avg test loss is  1.8057128393065447
avg accuracy is  0.12020000015633192
solo acc is  0.1611833334896674
compute similarity  is  tensor(0.9321, device='cuda:1')
compute_distance is  tensor(184.2400, device='cuda:1')
compute_norm is  tensor(46.6976, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(183.9730, device='cuda:1')
distance x is tensor(183.9730, device='cuda:1')
________________________________
test distance is  tensor(183.9730, device='cuda:1')
test distance1 is  tensor(183.9730, device='cuda:1')
test similarity is  tensor(0.9319, device='cuda:1')
test acc is  0.10096666682299864
test loss is 2.589093113758925
test entropy is  0.6656409310125339
________________________________
cal ratio is  0.9728004050062028
distance x is tensor(178.9678, device='cuda:1')
cal_distance is  tensor(178.9678, device='cuda:1')
distance x is tensor(178.9678, device='cuda:1')
return_distance is  tensor(178.9678, device='cuda:1')
distance x is tensor(178.9690, device='cuda:1')
distance x is tensor(178.9690, device='cuda:1')
________________________________
test distance is  tensor(178.9690, device='cuda:1')
test distance1 is  tensor(178.9690, device='cuda:1')
test similarity is  tensor(0.9352, device='cuda:1')
test acc is  0.1006333334896653
test loss is 2.594875172511347
test entropy is  0.6684459663276225
________________________________
0
distance x is tensor(178.9690, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.6692321090174637
avg test loss is  2.5905192541415247
avg accuracy is  0.10491666682299862
solo acc is  0.1007833334896653
compute similarity  is  tensor(0.9352, device='cuda:1')
compute_distance is  tensor(178.9690, device='cuda:1')
compute_norm is  tensor(46.3920, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(180.2412, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.0819157754053186
avg test loss is  1.7747397920978603
avg accuracy is  0.12296666682299857
solo acc is  0.1645500001563343
compute similarity  is  tensor(0.9347, device='cuda:1')
compute_distance is  tensor(180.2412, device='cuda:1')
compute_norm is  tensor(46.1547, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(180.0264, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.63685292526603
avg test loss is  2.5530897104409713
avg accuracy is  0.10561666682299863
solo acc is  0.10081666682299864
compute similarity  is  tensor(0.9344, device='cuda:1')
compute_distance is  tensor(180.0264, device='cuda:1')
compute_norm is  tensor(46.0277, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(181.0592, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.0756870665148632
avg test loss is  1.7150470416174768
avg accuracy is  0.12568333348966523
solo acc is  0.16191666682300082
compute similarity  is  tensor(0.9340, device='cuda:1')
compute_distance is  tensor(181.0592, device='cuda:1')
compute_norm is  tensor(45.7933, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(180.9008, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.6299125587762292
avg test loss is  2.4929478514169072
avg accuracy is  0.10820000015633195
solo acc is  0.1005833334896653
compute similarity  is  tensor(0.9337, device='cuda:1')
compute_distance is  tensor(180.9008, device='cuda:1')
compute_norm is  tensor(45.6578, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(181.9648, device='cuda:1')
________________________________
test distance is  tensor(181.9648, device='cuda:1')
test similarity is  tensor(0.9332, device='cuda:1')
test acc is  0.13268333348966524
test loss is 1.6619840268133037
test entropy is  1.0243509933511332
________________________________
final entropy
distance x is tensor(181.9664, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.0251547497218605
avg test loss is  1.6584750920978946
avg accuracy is  0.13383333348966522
solo acc is  0.18083333348966865
compute similarity  is  tensor(0.9332, device='cuda:1')
compute_distance is  tensor(181.9664, device='cuda:1')
compute_norm is  tensor(45.4291, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 2.409722462296486
mal norm is  tensor(721.9152, device='cuda:1')
distance x is tensor(181.8205, device='cuda:1')
mal distance is  tensor(181.8205, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([12., 12., 27., 12., 12., 27., 24., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 16., 12., 14., 12.,  0., 12., 12., 12.])
count_res tensor([1.4922e-07, 1.4922e-07, 4.8780e-01, 1.4922e-07, 1.4922e-07, 4.8780e-01,
        2.4286e-02, 1.4922e-07, 8.1471e-06, 8.1471e-06, 8.1471e-06, 8.1471e-06,
        8.1471e-06, 8.1471e-06, 8.1471e-06, 8.1471e-06, 8.1471e-06, 8.1471e-06,
        8.1471e-06, 8.1471e-06, 8.1471e-06, 1.4922e-07, 1.1026e-06, 1.4922e-07,
        9.1684e-13, 1.4922e-07, 1.4922e-07, 1.4922e-07])
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 85.63% 

Test Accuracy: 82.00% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7522477079182863
distance x is tensor(136.3495, device='cuda:1')
benign distance is  tensor(136.3495, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.334412094205618
distance x is tensor(123.4944, device='cuda:1')
benign distance is  tensor(123.4944, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1901517249643803
distance x is tensor(103.8837, device='cuda:1')
benign distance is  tensor(103.8837, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.050147719681263
distance x is tensor(161.4661, device='cuda:1')
benign distance is  tensor(161.4661, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.7542495653033257
distance x is tensor(117.0107, device='cuda:1')
benign distance is  tensor(117.0107, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9522540709003806
distance x is tensor(104.7685, device='cuda:1')
benign distance is  tensor(104.7685, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.696302942931652
distance x is tensor(102.4609, device='cuda:1')
benign distance is  tensor(102.4609, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9997531659901142
distance x is tensor(111.6683, device='cuda:1')
benign distance is  tensor(111.6683, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.1056946106255054
distance x is tensor(110.8901, device='cuda:1')
benign distance is  tensor(110.8901, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.7676331624388695
distance x is tensor(123.6609, device='cuda:1')
benign distance is  tensor(123.6609, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1732172705233097
distance x is tensor(93.3262, device='cuda:1')
benign distance is  tensor(93.3262, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.3782172575592995
distance x is tensor(123.5179, device='cuda:1')
benign distance is  tensor(123.5179, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2052994556725025
distance x is tensor(161.4003, device='cuda:1')
benign distance is  tensor(161.4003, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8732459601014853
distance x is tensor(86.0280, device='cuda:1')
benign distance is  tensor(86.0280, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.212928293272853
distance x is tensor(150.6270, device='cuda:1')
benign distance is  tensor(150.6270, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.950971931219101
distance x is tensor(124.2312, device='cuda:1')
benign distance is  tensor(124.2312, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(92.5292, device='cuda:1')
compute distance is  tensor(92.5292, device='cuda:1')
compute norm is  tensor(44.9946, device='cuda:1', dtype=torch.float64)
distance x is tensor(150.2757, device='cuda:1')
compute distance is  tensor(150.2757, device='cuda:1')
compute norm is  tensor(46.0617, device='cuda:1', dtype=torch.float64)
distance x is tensor(101.7775, device='cuda:1')
compute distance is  tensor(101.7775, device='cuda:1')
compute norm is  tensor(45.0790, device='cuda:1', dtype=torch.float64)
distance x is tensor(111.2988, device='cuda:1')
compute distance is  tensor(111.2988, device='cuda:1')
compute norm is  tensor(45.3676, device='cuda:1', dtype=torch.float64)
distance x is tensor(112.8593, device='cuda:1')
compute distance is  tensor(112.8593, device='cuda:1')
compute norm is  tensor(45.2083, device='cuda:1', dtype=torch.float64)
distance x is tensor(126.5362, device='cuda:1')
compute distance is  tensor(126.5362, device='cuda:1')
compute norm is  tensor(45.7056, device='cuda:1', dtype=torch.float64)
distance x is tensor(136.9412, device='cuda:1')
compute distance is  tensor(136.9412, device='cuda:1')
compute norm is  tensor(45.7621, device='cuda:1', dtype=torch.float64)
distance x is tensor(94.5713, device='cuda:1')
compute distance is  tensor(94.5713, device='cuda:1')
compute norm is  tensor(45.0264, device='cuda:1', dtype=torch.float64)
distance x is tensor(123.7923, device='cuda:1')
compute distance is  tensor(123.7923, device='cuda:1')
compute norm is  tensor(45.4750, device='cuda:1', dtype=torch.float64)
distance x is tensor(101.9422, device='cuda:1')
compute distance is  tensor(101.9422, device='cuda:1')
compute norm is  tensor(45.4128, device='cuda:1', dtype=torch.float64)
distance x is tensor(128.8015, device='cuda:1')
compute distance is  tensor(128.8015, device='cuda:1')
compute norm is  tensor(45.5150, device='cuda:1', dtype=torch.float64)
distance x is tensor(152.9182, device='cuda:1')
compute distance is  tensor(152.9182, device='cuda:1')
compute norm is  tensor(46.6646, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(152.9182, device='cuda:1')
distance x is tensor(102047.8125, device='cuda:1')
distance x is tensor(102047.8125, device='cuda:1')
________________________________
test distance is  tensor(102047.8125, device='cuda:1')
test distance1 is  tensor(102047.8125, device='cuda:1')
test similarity is  tensor(0.1265, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107476126961969.67
test entropy is  0.0
________________________________
cal ratio is  0.03793619697791311
distance x is tensor(3871.3108, device='cuda:1')
cal_distance is  tensor(3871.3108, device='cuda:1')
cal ratio is  0.19477204314152743
distance x is tensor(754.0267, device='cuda:1')
cal_distance is  tensor(754.0267, device='cuda:1')
cal ratio is  0.4413288056416799
distance x is tensor(332.7763, device='cuda:1')
cal_distance is  tensor(332.7763, device='cuda:1')
cal ratio is  0.6643232611447564
distance x is tensor(221.0726, device='cuda:1')
cal_distance is  tensor(221.0726, device='cuda:1')
cal ratio is  0.8150574353521949
distance x is tensor(180.1877, device='cuda:1')
cal_distance is  tensor(180.1877, device='cuda:1')
cal ratio is  0.9028031110027755
distance x is tensor(162.6745, device='cuda:1')
cal_distance is  tensor(162.6745, device='cuda:1')
cal ratio is  0.9501582944396647
distance x is tensor(154.5667, device='cuda:1')
cal_distance is  tensor(154.5667, device='cuda:1')
cal ratio is  0.9747599071259465
distance x is tensor(150.6656, device='cuda:1')
cal_distance is  tensor(150.6656, device='cuda:1')
distance x is tensor(150.6656, device='cuda:1')
return_distance is  tensor(150.6656, device='cuda:1')
distance x is tensor(150.6565, device='cuda:1')
distance x is tensor(150.6565, device='cuda:1')
________________________________
test distance is  tensor(150.6565, device='cuda:1')
test distance1 is  tensor(150.6565, device='cuda:1')
test similarity is  tensor(0.9402, device='cuda:1')
test acc is  0.10256666682299863
test loss is 207.21331517071104
test entropy is  0.001485944561757291
________________________________
0
distance x is tensor(150.6565, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.001587602023589442
avg test loss is  207.46782450076105
avg accuracy is  0.3867833334896743
solo acc is  0.1018333334896653
compute similarity  is  tensor(0.9402, device='cuda:1')
compute_distance is  tensor(150.6565, device='cuda:1')
compute_norm is  tensor(46.9520, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(153.7023, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.193768039441058
avg test loss is  1.8320388846051718
avg accuracy is  0.629166666823002
solo acc is  0.20743333348967005
compute similarity  is  tensor(0.9386, device='cuda:1')
compute_distance is  tensor(153.7023, device='cuda:1')
compute_norm is  tensor(47.5087, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(155.0065, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.6911541202556349
avg test loss is  2.687115400584776
avg accuracy is  0.6240000001563357
solo acc is  0.10746666682299862
compute similarity  is  tensor(0.9379, device='cuda:1')
compute_distance is  tensor(155.0065, device='cuda:1')
compute_norm is  tensor(47.4296, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(156.8539, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.0336406682091734
avg test loss is  1.6483508905113886
avg accuracy is  0.6820333334896652
solo acc is  0.23023333348967093
compute similarity  is  tensor(0.9381, device='cuda:1')
compute_distance is  tensor(156.8539, device='cuda:1')
compute_norm is  tensor(47.1156, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(157.8626, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.6392561716438611
avg test loss is  2.4591284318010946
avg accuracy is  0.6736000001563321
solo acc is  0.10891666682299862
compute similarity  is  tensor(0.9373, device='cuda:1')
compute_distance is  tensor(157.8626, device='cuda:1')
compute_norm is  tensor(46.9959, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(159.2181, device='cuda:1')
distance x is tensor(159.2181, device='cuda:1')
________________________________
test distance is  tensor(159.2181, device='cuda:1')
test distance1 is  tensor(159.2181, device='cuda:1')
test similarity is  tensor(0.9373, device='cuda:1')
test acc is  0.2839833334896724
test loss is 1.4697611358628344
test entropy is  0.9703442069894469
________________________________
cal ratio is  0.9604161453797311
distance x is tensor(152.9228, device='cuda:1')
cal_distance is  tensor(152.9228, device='cuda:1')
cal ratio is  0.979985221512944
distance x is tensor(149.8622, device='cuda:1')
cal_distance is  tensor(149.8622, device='cuda:1')
distance x is tensor(149.8622, device='cuda:1')
return_distance is  tensor(149.8622, device='cuda:1')
distance x is tensor(149.8548, device='cuda:1')
distance x is tensor(149.8548, device='cuda:1')
________________________________
test distance is  tensor(149.8548, device='cuda:1')
test distance1 is  tensor(149.8548, device='cuda:1')
test similarity is  tensor(0.9437, device='cuda:1')
test acc is  0.27701666682300563
test loss is 1.4377555992049196
test entropy is  1.0809646236744008
________________________________
0
distance x is tensor(149.8548, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.0791229358487038
avg test loss is  1.4376049284487644
avg accuracy is  0.7021500001563304
solo acc is  0.2771000001563389
compute similarity  is  tensor(0.9437, device='cuda:1')
compute_distance is  tensor(149.8548, device='cuda:1')
compute_norm is  tensor(46.3705, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(151.1395, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.6156265656195724
avg test loss is  2.334470276385228
avg accuracy is  0.684833333489665
solo acc is  0.10801666682299862
compute similarity  is  tensor(0.9428, device='cuda:1')
compute_distance is  tensor(151.1395, device='cuda:1')
compute_norm is  tensor(46.2487, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(152.3540, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.946072318787768
avg test loss is  1.379981131505356
avg accuracy is  0.7112333334896634
solo acc is  0.3009166668230063
compute similarity  is  tensor(0.9427, device='cuda:1')
compute_distance is  tensor(152.3540, device='cuda:1')
compute_norm is  tensor(45.9404, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(152.3540, device='cuda:1')
distance x is tensor(152.3540, device='cuda:1')
________________________________
test distance is  tensor(152.3540, device='cuda:1')
test distance1 is  tensor(152.3540, device='cuda:1')
test similarity is  tensor(0.9427, device='cuda:1')
test acc is  0.30238333348967295
test loss is 1.376502636526185
test entropy is  0.9467396844805939
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.29900000016000006
mal loss is 1.3827533051371574
mal norm is  tensor(702.1586, device='cuda:1')
distance x is tensor(152.3613, device='cuda:1')
mal distance is  tensor(152.3613, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([12., 27., 26., 12., 12., 12., 26., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 12.,  0., 12., 12., 17., 12., 12.])
count_res tensor([1.7621e-07, 5.7603e-01, 2.1191e-01, 1.7621e-07, 1.7621e-07, 1.7621e-07,
        2.1191e-01, 1.7621e-07, 9.6208e-06, 9.6208e-06, 9.6208e-06, 9.6208e-06,
        9.6208e-06, 9.6208e-06, 9.6208e-06, 9.6208e-06, 9.6208e-06, 9.6208e-06,
        9.6208e-06, 9.6208e-06, 1.7621e-07, 1.7621e-07, 1.0827e-12, 1.7621e-07,
        1.7621e-07, 2.6152e-05, 1.7621e-07, 1.7621e-07])
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 75.81% 

Test Accuracy: 82.77% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7382420226931572
distance x is tensor(125.8456, device='cuda:1')
benign distance is  tensor(125.8456, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2070023268461227
distance x is tensor(89.3593, device='cuda:1')
benign distance is  tensor(89.3593, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0525570064783096
distance x is tensor(98.0143, device='cuda:1')
benign distance is  tensor(98.0143, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3091872185468674
distance x is tensor(151.2421, device='cuda:1')
benign distance is  tensor(151.2421, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1106593664735556
distance x is tensor(110.2882, device='cuda:1')
benign distance is  tensor(110.2882, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7413064893335104
distance x is tensor(105.4242, device='cuda:1')
benign distance is  tensor(105.4242, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5907306037843227
distance x is tensor(112.8230, device='cuda:1')
benign distance is  tensor(112.8230, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.992966877296567
distance x is tensor(103.8448, device='cuda:1')
benign distance is  tensor(103.8448, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.6498899012804031
distance x is tensor(116.2198, device='cuda:1')
benign distance is  tensor(116.2198, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.1927769556641579
distance x is tensor(113.4299, device='cuda:1')
benign distance is  tensor(113.4299, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.4189079366624355
distance x is tensor(121.2681, device='cuda:1')
benign distance is  tensor(121.2681, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.3153754845261574
distance x is tensor(120.2095, device='cuda:1')
benign distance is  tensor(120.2095, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.552031334489584
distance x is tensor(92.9008, device='cuda:1')
benign distance is  tensor(92.9008, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7289028000086546
distance x is tensor(204.7028, device='cuda:1')
benign distance is  tensor(204.7028, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.2730087786912918
distance x is tensor(161.0612, device='cuda:1')
benign distance is  tensor(161.0612, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.0394377522170544
distance x is tensor(124.8305, device='cuda:1')
benign distance is  tensor(124.8305, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(91.0484, device='cuda:1')
compute distance is  tensor(91.0484, device='cuda:1')
compute norm is  tensor(45.7649, device='cuda:1', dtype=torch.float64)
distance x is tensor(139.6026, device='cuda:1')
compute distance is  tensor(139.6026, device='cuda:1')
compute norm is  tensor(46.8024, device='cuda:1', dtype=torch.float64)
distance x is tensor(105.4681, device='cuda:1')
compute distance is  tensor(105.4681, device='cuda:1')
compute norm is  tensor(45.8577, device='cuda:1', dtype=torch.float64)
distance x is tensor(100.1601, device='cuda:1')
compute distance is  tensor(100.1601, device='cuda:1')
compute norm is  tensor(45.8924, device='cuda:1', dtype=torch.float64)
distance x is tensor(98.1340, device='cuda:1')
compute distance is  tensor(98.1340, device='cuda:1')
compute norm is  tensor(45.7966, device='cuda:1', dtype=torch.float64)
distance x is tensor(114.8704, device='cuda:1')
compute distance is  tensor(114.8704, device='cuda:1')
compute norm is  tensor(46.2249, device='cuda:1', dtype=torch.float64)
distance x is tensor(130.0764, device='cuda:1')
compute distance is  tensor(130.0764, device='cuda:1')
compute norm is  tensor(46.4356, device='cuda:1', dtype=torch.float64)
distance x is tensor(95.2924, device='cuda:1')
compute distance is  tensor(95.2924, device='cuda:1')
compute norm is  tensor(45.8154, device='cuda:1', dtype=torch.float64)
distance x is tensor(119.7573, device='cuda:1')
compute distance is  tensor(119.7573, device='cuda:1')
compute norm is  tensor(46.2591, device='cuda:1', dtype=torch.float64)
distance x is tensor(103.1872, device='cuda:1')
compute distance is  tensor(103.1872, device='cuda:1')
compute norm is  tensor(46.0097, device='cuda:1', dtype=torch.float64)
distance x is tensor(118.4750, device='cuda:1')
compute distance is  tensor(118.4750, device='cuda:1')
compute norm is  tensor(46.1048, device='cuda:1', dtype=torch.float64)
distance x is tensor(147.9171, device='cuda:1')
compute distance is  tensor(147.9171, device='cuda:1')
compute norm is  tensor(47.3502, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(147.9171, device='cuda:1')
distance x is tensor(102050.6562, device='cuda:1')
distance x is tensor(102050.6562, device='cuda:1')
________________________________
test distance is  tensor(102050.6562, device='cuda:1')
test distance1 is  tensor(102050.6562, device='cuda:1')
test similarity is  tensor(0.1088, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107589667316777.48
test entropy is  0.0
________________________________
cal ratio is  0.03731018361889422
distance x is tensor(3807.5339, device='cuda:1')
cal_distance is  tensor(3807.5339, device='cuda:1')
cal ratio is  0.19315830883255167
distance x is tensor(735.4606, device='cuda:1')
cal_distance is  tensor(735.4606, device='cuda:1')
cal ratio is  0.43949667381334256
distance x is tensor(323.2350, device='cuda:1')
cal_distance is  tensor(323.2350, device='cuda:1')
cal ratio is  0.6629428805164109
distance x is tensor(214.2879, device='cuda:1')
cal_distance is  tensor(214.2879, device='cuda:1')
cal ratio is  0.8142101550632279
distance x is tensor(174.4762, device='cuda:1')
cal_distance is  tensor(174.4762, device='cuda:1')
cal ratio is  0.902333711602987
distance x is tensor(157.4362, device='cuda:1')
cal_distance is  tensor(157.4362, device='cuda:1')
cal ratio is  0.9499110683426006
distance x is tensor(149.5507, device='cuda:1')
cal_distance is  tensor(149.5507, device='cuda:1')
cal ratio is  0.9746330201241103
distance x is tensor(145.7571, device='cuda:1')
cal_distance is  tensor(145.7571, device='cuda:1')
distance x is tensor(145.7571, device='cuda:1')
return_distance is  tensor(145.7571, device='cuda:1')
distance x is tensor(145.7481, device='cuda:1')
distance x is tensor(145.7481, device='cuda:1')
________________________________
test distance is  tensor(145.7481, device='cuda:1')
test distance1 is  tensor(145.7481, device='cuda:1')
test similarity is  tensor(0.9445, device='cuda:1')
test acc is  0.13301666682299856
test loss is 185.6453525079593
test entropy is  0.011962389103806353
________________________________
0
distance x is tensor(145.7481, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.011308637468243548
avg test loss is  186.09536002998922
avg accuracy is  0.4292666668230081
solo acc is  0.13358333348966522
compute similarity  is  tensor(0.9445, device='cuda:1')
compute_distance is  tensor(145.7481, device='cuda:1')
compute_norm is  tensor(47.4465, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(139.3811, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.0542349280324825
avg test loss is  1.626881703257815
avg accuracy is  0.7465000001563281
solo acc is  0.26841666682300547
compute similarity  is  tensor(0.9463, device='cuda:1')
compute_distance is  tensor(139.3811, device='cuda:1')
compute_norm is  tensor(47.2504, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(141.0271, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.6646588643921464
avg test loss is  2.4376074997092614
avg accuracy is  0.7287833334896624
solo acc is  0.11848333348966525
compute similarity  is  tensor(0.9455, device='cuda:1')
compute_distance is  tensor(141.0271, device='cuda:1')
compute_norm is  tensor(47.0752, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(142.8260, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.9310384557318332
avg test loss is  1.4724159747806949
avg accuracy is  0.7702833334896602
solo acc is  0.27965000015633906
compute similarity  is  tensor(0.9451, device='cuda:1')
compute_distance is  tensor(142.8260, device='cuda:1')
compute_norm is  tensor(46.7865, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(142.8260, device='cuda:1')
distance x is tensor(142.8260, device='cuda:1')
________________________________
test distance is  tensor(142.8260, device='cuda:1')
test distance1 is  tensor(142.8260, device='cuda:1')
test similarity is  tensor(0.9451, device='cuda:1')
test acc is  0.279950000156339
test loss is 1.4697285214466835
test entropy is  0.9321306334502661
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.29000000016000005
mal loss is 1.4610304161906242
mal norm is  tensor(705.5193, device='cuda:1')
distance x is tensor(142.8342, device='cuda:1')
mal distance is  tensor(142.8342, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([ 0.,  0., 34., 12., 32., 12., 12., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 12., 25., 12., 12., 13., 13., 21., 19.,
        19., 17., 32., 34.,  2., 17., 12., 22.])
count_res tensor([7.5458e-16, 7.5458e-16, 4.4027e-01, 1.2281e-10, 5.9584e-02, 1.2281e-10,
        1.2281e-10, 1.2281e-10, 1.9988e-05, 1.9988e-05, 1.9988e-05, 1.9988e-05,
        1.9988e-05, 1.9988e-05, 1.9988e-05, 1.9988e-05, 1.9988e-05, 1.9988e-05,
        1.9988e-05, 1.9988e-05, 1.2281e-10, 5.4333e-05, 1.2281e-10, 1.2281e-10,
        3.3384e-10, 3.3384e-10, 9.9515e-07, 1.3468e-07, 1.3468e-07, 1.8227e-08,
        5.9584e-02, 4.4027e-01, 5.5756e-15, 1.8227e-08, 1.2281e-10, 2.7051e-06])
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 73.19% 

Test Accuracy: 81.64% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.737143037840724
distance x is tensor(135.1454, device='cuda:1')
benign distance is  tensor(135.1454, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1880787573754787
distance x is tensor(100.9719, device='cuda:1')
benign distance is  tensor(100.9719, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.2492783889174461
distance x is tensor(80.2375, device='cuda:1')
benign distance is  tensor(80.2375, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0121278949081898
distance x is tensor(151.1576, device='cuda:1')
benign distance is  tensor(151.1576, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4170369356870651
distance x is tensor(100.9295, device='cuda:1')
benign distance is  tensor(100.9295, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7315878784283996
distance x is tensor(106.9328, device='cuda:1')
benign distance is  tensor(106.9328, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4903347678482533
distance x is tensor(96.5583, device='cuda:1')
benign distance is  tensor(96.5583, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1053574979305267
distance x is tensor(102.8434, device='cuda:1')
benign distance is  tensor(102.8434, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.7738802907988429
distance x is tensor(109.8002, device='cuda:1')
benign distance is  tensor(109.8002, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8027400327846408
distance x is tensor(128.8179, device='cuda:1')
benign distance is  tensor(128.8179, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1137680690735579
distance x is tensor(78.6735, device='cuda:1')
benign distance is  tensor(78.6735, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.296443350613117
distance x is tensor(96.3533, device='cuda:1')
benign distance is  tensor(96.3533, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.0405369363725185
distance x is tensor(167.1561, device='cuda:1')
benign distance is  tensor(167.1561, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8649184610694647
distance x is tensor(82.6920, device='cuda:1')
benign distance is  tensor(82.6920, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1551363971084356
distance x is tensor(149.2528, device='cuda:1')
benign distance is  tensor(149.2528, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.3174039274454117
distance x is tensor(118.0177, device='cuda:1')
benign distance is  tensor(118.0177, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.2262019403278828
distance x is tensor(122.1949, device='cuda:1')
benign distance is  tensor(122.1949, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.6620928253978491
distance x is tensor(97.6870, device='cuda:1')
benign distance is  tensor(97.6870, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.4867650121450424
distance x is tensor(129.5562, device='cuda:1')
benign distance is  tensor(129.5562, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.717431791126728
distance x is tensor(112.6534, device='cuda:1')
benign distance is  tensor(112.6534, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.978168923407793
distance x is tensor(134.5850, device='cuda:1')
benign distance is  tensor(134.5850, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.8742541465908289
distance x is tensor(114.3906, device='cuda:1')
benign distance is  tensor(114.3906, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6029109973460436
distance x is tensor(122.3665, device='cuda:1')
benign distance is  tensor(122.3665, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.4213342368602753
distance x is tensor(164.6404, device='cuda:1')
benign distance is  tensor(164.6404, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(91.2627, device='cuda:1')
compute distance is  tensor(91.2627, device='cuda:1')
compute norm is  tensor(45.9980, device='cuda:1', dtype=torch.float64)
distance x is tensor(142.4299, device='cuda:1')
compute distance is  tensor(142.4299, device='cuda:1')
compute norm is  tensor(46.9375, device='cuda:1', dtype=torch.float64)
distance x is tensor(112.2799, device='cuda:1')
compute distance is  tensor(112.2799, device='cuda:1')
compute norm is  tensor(46.2221, device='cuda:1', dtype=torch.float64)
distance x is tensor(106.1434, device='cuda:1')
compute distance is  tensor(106.1434, device='cuda:1')
compute norm is  tensor(46.2933, device='cuda:1', dtype=torch.float64)
distance x is tensor(102.1401, device='cuda:1')
compute distance is  tensor(102.1401, device='cuda:1')
compute norm is  tensor(46.1459, device='cuda:1', dtype=torch.float64)
distance x is tensor(111.6038, device='cuda:1')
compute distance is  tensor(111.6038, device='cuda:1')
compute norm is  tensor(46.4041, device='cuda:1', dtype=torch.float64)
distance x is tensor(125.0591, device='cuda:1')
compute distance is  tensor(125.0591, device='cuda:1')
compute norm is  tensor(46.6060, device='cuda:1', dtype=torch.float64)
distance x is tensor(97.7081, device='cuda:1')
compute distance is  tensor(97.7081, device='cuda:1')
compute norm is  tensor(46.1160, device='cuda:1', dtype=torch.float64)
distance x is tensor(116.1027, device='cuda:1')
compute distance is  tensor(116.1027, device='cuda:1')
compute norm is  tensor(46.4596, device='cuda:1', dtype=torch.float64)
distance x is tensor(102.9075, device='cuda:1')
compute distance is  tensor(102.9075, device='cuda:1')
compute norm is  tensor(46.3475, device='cuda:1', dtype=torch.float64)
distance x is tensor(118.8784, device='cuda:1')
compute distance is  tensor(118.8784, device='cuda:1')
compute norm is  tensor(46.2691, device='cuda:1', dtype=torch.float64)
distance x is tensor(150.8776, device='cuda:1')
compute distance is  tensor(150.8776, device='cuda:1')
compute norm is  tensor(47.6901, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(150.8776, device='cuda:1')
distance x is tensor(102055.2969, device='cuda:1')
distance x is tensor(102055.2969, device='cuda:1')
________________________________
test distance is  tensor(102055.2969, device='cuda:1')
test distance1 is  tensor(102055.2969, device='cuda:1')
test similarity is  tensor(0.1016, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107623082710729.97
test entropy is  0.0
________________________________
cal ratio is  0.03768084604059448
distance x is tensor(3845.5352, device='cuda:1')
cal_distance is  tensor(3845.5352, device='cuda:1')
cal ratio is  0.1941154199813678
distance x is tensor(746.4813, device='cuda:1')
cal_distance is  tensor(746.4813, device='cuda:1')
cal ratio is  0.44058423180380596
distance x is tensor(328.8904, device='cuda:1')
cal_distance is  tensor(328.8904, device='cuda:1')
cal ratio is  0.6637626653565636
distance x is tensor(218.3068, device='cuda:1')
cal_distance is  tensor(218.3068, device='cuda:1')
cal ratio is  0.814713324125453
distance x is tensor(177.8583, device='cuda:1')
cal_distance is  tensor(177.8583, device='cuda:1')
cal ratio is  0.9026126471090078
distance x is tensor(160.5376, device='cuda:1')
cal_distance is  tensor(160.5376, device='cuda:1')
cal ratio is  0.9500579776890923
distance x is tensor(152.5202, device='cuda:1')
cal_distance is  tensor(152.5202, device='cuda:1')
cal ratio is  0.9747083732030857
distance x is tensor(148.6629, device='cuda:1')
cal_distance is  tensor(148.6629, device='cuda:1')
distance x is tensor(148.6629, device='cuda:1')
return_distance is  tensor(148.6629, device='cuda:1')
distance x is tensor(148.6538, device='cuda:1')
distance x is tensor(148.6538, device='cuda:1')
________________________________
test distance is  tensor(148.6538, device='cuda:1')
test distance1 is  tensor(148.6538, device='cuda:1')
test similarity is  tensor(0.9427, device='cuda:1')
test acc is  0.12288333348966525
test loss is 223.9433524451022
test entropy is  0.008130826173102026
________________________________
0
distance x is tensor(148.6538, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.007796894392390513
avg test loss is  223.6407880478068
avg accuracy is  0.38593333348967424
solo acc is  0.12240000015633193
compute similarity  is  tensor(0.9427, device='cuda:1')
compute_distance is  tensor(148.6538, device='cuda:1')
compute_norm is  tensor(47.6628, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(139.9978, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.0244411275203802
avg test loss is  1.5815256841655478
avg accuracy is  0.7171000001563298
solo acc is  0.28245000015633914
compute similarity  is  tensor(0.9452, device='cuda:1')
compute_distance is  tensor(139.9978, device='cuda:1')
compute_norm is  tensor(47.3948, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(141.8351, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.614985315562057
avg test loss is  2.461311881349031
avg accuracy is  0.6860000001563314
solo acc is  0.11838333348966526
compute similarity  is  tensor(0.9445, device='cuda:1')
compute_distance is  tensor(141.8351, device='cuda:1')
compute_norm is  tensor(47.1935, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(143.3934, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.9263008688050293
avg test loss is  1.4407729740335997
avg accuracy is  0.7370666668229954
solo acc is  0.2907000001563393
compute similarity  is  tensor(0.9441, device='cuda:1')
compute_distance is  tensor(143.3934, device='cuda:1')
compute_norm is  tensor(46.8915, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(143.3934, device='cuda:1')
distance x is tensor(143.3934, device='cuda:1')
________________________________
test distance is  tensor(143.3934, device='cuda:1')
test distance1 is  tensor(143.3934, device='cuda:1')
test similarity is  tensor(0.9441, device='cuda:1')
test acc is  0.29306666682300603
test loss is 1.4381151848764562
test entropy is  0.9269465115914213
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.31000000016000007
mal loss is 1.431064210832119
mal norm is  tensor(714.3270, device='cuda:1')
distance x is tensor(143.4017, device='cuda:1')
mal distance is  tensor(143.4017, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([12., 12., 23., 14., 12., 12., 24., 18., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 13., 16., 12., 12., 12., 12., 12.])
count_res tensor([4.4690e-06, 4.4690e-06, 2.6758e-01, 3.3022e-05, 4.4690e-06, 4.4690e-06,
        7.2736e-01, 1.8029e-03, 2.4400e-04, 2.4400e-04, 2.4400e-04, 2.4400e-04,
        2.4400e-04, 2.4400e-04, 2.4400e-04, 2.4400e-04, 2.4400e-04, 2.4400e-04,
        2.4400e-04, 2.4400e-04, 4.4690e-06, 1.2148e-05, 2.4400e-04, 4.4690e-06,
        4.4690e-06, 4.4690e-06, 4.4690e-06, 4.4690e-06])
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 64.76% 

Test Accuracy: 77.99% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7404683381319046
distance x is tensor(129.7839, device='cuda:1')
benign distance is  tensor(129.7839, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2536665983498096
distance x is tensor(98.3895, device='cuda:1')
benign distance is  tensor(98.3895, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.4235130622982979
distance x is tensor(97.0948, device='cuda:1')
benign distance is  tensor(97.0948, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3872381150722504
distance x is tensor(161.5487, device='cuda:1')
benign distance is  tensor(161.5487, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2445017267018557
distance x is tensor(104.0130, device='cuda:1')
benign distance is  tensor(104.0130, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3696756176650524
distance x is tensor(111.0623, device='cuda:1')
benign distance is  tensor(111.0623, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6216260455548763
distance x is tensor(72.8273, device='cuda:1')
benign distance is  tensor(72.8273, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9677679650485516
distance x is tensor(111.9796, device='cuda:1')
benign distance is  tensor(111.9796, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8013446480035782
distance x is tensor(132.9716, device='cuda:1')
benign distance is  tensor(132.9716, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.3389174826443195
distance x is tensor(107.8972, device='cuda:1')
benign distance is  tensor(107.8972, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.0245131365954876
distance x is tensor(153.0210, device='cuda:1')
benign distance is  tensor(153.0210, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.1005261689424515
distance x is tensor(141.5546, device='cuda:1')
benign distance is  tensor(141.5546, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8456115517765284
distance x is tensor(132.1300, device='cuda:1')
benign distance is  tensor(132.1300, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.309847678989172
distance x is tensor(94.9659, device='cuda:1')
benign distance is  tensor(94.9659, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.056762594729662
distance x is tensor(111.1032, device='cuda:1')
benign distance is  tensor(111.1032, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8092906568199396
distance x is tensor(127.4555, device='cuda:1')
benign distance is  tensor(127.4555, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(107.0783, device='cuda:1')
compute distance is  tensor(107.0783, device='cuda:1')
compute norm is  tensor(46.8658, device='cuda:1', dtype=torch.float64)
distance x is tensor(148.6041, device='cuda:1')
compute distance is  tensor(148.6041, device='cuda:1')
compute norm is  tensor(47.6505, device='cuda:1', dtype=torch.float64)
distance x is tensor(108.9064, device='cuda:1')
compute distance is  tensor(108.9064, device='cuda:1')
compute norm is  tensor(46.7908, device='cuda:1', dtype=torch.float64)
distance x is tensor(131.9362, device='cuda:1')
compute distance is  tensor(131.9362, device='cuda:1')
compute norm is  tensor(47.4622, device='cuda:1', dtype=torch.float64)
distance x is tensor(105.7898, device='cuda:1')
compute distance is  tensor(105.7898, device='cuda:1')
compute norm is  tensor(46.7522, device='cuda:1', dtype=torch.float64)
distance x is tensor(126.1215, device='cuda:1')
compute distance is  tensor(126.1215, device='cuda:1')
compute norm is  tensor(47.2479, device='cuda:1', dtype=torch.float64)
distance x is tensor(135.0561, device='cuda:1')
compute distance is  tensor(135.0561, device='cuda:1')
compute norm is  tensor(47.4271, device='cuda:1', dtype=torch.float64)
distance x is tensor(100.3140, device='cuda:1')
compute distance is  tensor(100.3140, device='cuda:1')
compute norm is  tensor(46.8029, device='cuda:1', dtype=torch.float64)
distance x is tensor(128.7931, device='cuda:1')
compute distance is  tensor(128.7931, device='cuda:1')
compute norm is  tensor(47.2650, device='cuda:1', dtype=torch.float64)
distance x is tensor(108.6983, device='cuda:1')
compute distance is  tensor(108.6983, device='cuda:1')
compute norm is  tensor(47.0271, device='cuda:1', dtype=torch.float64)
distance x is tensor(116.9925, device='cuda:1')
compute distance is  tensor(116.9925, device='cuda:1')
compute norm is  tensor(46.9029, device='cuda:1', dtype=torch.float64)
distance x is tensor(156.1811, device='cuda:1')
compute distance is  tensor(156.1811, device='cuda:1')
compute norm is  tensor(48.2770, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(156.1811, device='cuda:1')
distance x is tensor(102058.0938, device='cuda:1')
distance x is tensor(102058.0938, device='cuda:1')
________________________________
test distance is  tensor(102058.0938, device='cuda:1')
test distance1 is  tensor(102058.0938, device='cuda:1')
test similarity is  tensor(0.0926, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107570922829112.22
test entropy is  0.0
________________________________
cal ratio is  0.038336860705991856
distance x is tensor(3912.5920, device='cuda:1')
cal_distance is  tensor(3912.5920, device='cuda:1')
cal ratio is  0.1957978865678243
distance x is tensor(766.0809, device='cuda:1')
cal_distance is  tensor(766.0809, device='cuda:1')
cal ratio is  0.4424895040363736
distance x is tensor(338.9853, device='cuda:1')
cal_distance is  tensor(338.9853, device='cuda:1')
cal ratio is  0.6651963368873385
distance x is tensor(225.4933, device='cuda:1')
cal_distance is  tensor(225.4933, device='cuda:1')
cal ratio is  0.8155929651071339
distance x is tensor(183.9116, device='cuda:1')
cal_distance is  tensor(183.9116, device='cuda:1')
cal ratio is  0.9030997449914223
distance x is tensor(166.0910, device='cuda:1')
cal_distance is  tensor(166.0910, device='cuda:1')
cal ratio is  0.9503142614326348
distance x is tensor(157.8389, device='cuda:1')
cal_distance is  tensor(157.8389, device='cuda:1')
cal ratio is  0.9748399481475305
distance x is tensor(153.8677, device='cuda:1')
cal_distance is  tensor(153.8677, device='cuda:1')
distance x is tensor(153.8677, device='cuda:1')
return_distance is  tensor(153.8677, device='cuda:1')
distance x is tensor(153.8586, device='cuda:1')
distance x is tensor(153.8586, device='cuda:1')
________________________________
test distance is  tensor(153.8586, device='cuda:1')
test distance1 is  tensor(153.8586, device='cuda:1')
test similarity is  tensor(0.9405, device='cuda:1')
test acc is  0.11950000015633194
test loss is 289.03891205940164
test entropy is  0.006638548208252673
________________________________
0
distance x is tensor(153.8586, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.006739928191758511
avg test loss is  288.67528776319296
avg accuracy is  0.3160166668230065
solo acc is  0.11925000015633193
compute similarity  is  tensor(0.9405, device='cuda:1')
compute_distance is  tensor(153.8586, device='cuda:1')
compute_norm is  tensor(48.4408, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(148.6329, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.2391726178909415
avg test loss is  1.924904982926749
avg accuracy is  0.6098500001563368
solo acc is  0.194250000156336
compute similarity  is  tensor(0.9416, device='cuda:1')
compute_distance is  tensor(148.6329, device='cuda:1')
compute_norm is  tensor(48.3757, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(150.5923, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.7003167849232648
avg test loss is  2.800274589676847
avg accuracy is  0.5964666668230045
solo acc is  0.10845000015633195
compute similarity  is  tensor(0.9410, device='cuda:1')
compute_distance is  tensor(150.5923, device='cuda:1')
compute_norm is  tensor(48.2458, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(152.6953, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.0250659513193916
avg test loss is  1.6095908143118756
avg accuracy is  0.6540166668230002
solo acc is  0.25866666682300515
compute similarity  is  tensor(0.9407, device='cuda:1')
compute_distance is  tensor(152.6953, device='cuda:1')
compute_norm is  tensor(47.9491, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(153.8181, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.630820544194311
avg test loss is  2.483233417020932
avg accuracy is  0.634250000156335
solo acc is  0.1097666668229986
compute similarity  is  tensor(0.9401, device='cuda:1')
compute_distance is  tensor(153.8181, device='cuda:1')
compute_norm is  tensor(47.7895, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(155.1113, device='cuda:1')
distance x is tensor(155.1113, device='cuda:1')
________________________________
test distance is  tensor(155.1113, device='cuda:1')
test distance1 is  tensor(155.1113, device='cuda:1')
test similarity is  tensor(0.9399, device='cuda:1')
test acc is  0.2564666668230051
test loss is 1.5021267961591547
test entropy is  0.9529865443833602
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2670000001600001
mal loss is 1.5065759792923927
mal norm is  tensor(746.4641, device='cuda:1')
distance x is tensor(155.1193, device='cuda:1')
mal distance is  tensor(155.1193, device='cuda:1')
user_PLR len size 44
counter_tensor is  tensor([12., 24., 32., 13., 17., 12., 14., 43., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32.,  1., 17., 13., 42.,  7.,  0.,  9.,  1.,
         0., 35., 38., 27., 12., 42., 12.,  3., 42., 18., 29., 12., 43., 39.,
         0., 19.])
count_res tensor([1.1001e-14, 1.7905e-09, 5.3373e-06, 2.9904e-14, 1.6327e-12, 1.1001e-14,
        8.1287e-14, 3.1957e-01, 5.3373e-06, 5.3373e-06, 5.3373e-06, 5.3373e-06,
        5.3373e-06, 5.3373e-06, 5.3373e-06, 5.3373e-06, 5.3373e-06, 5.3373e-06,
        5.3373e-06, 5.3373e-06, 1.8374e-19, 1.6327e-12, 2.9904e-14, 1.1756e-01,
        7.4124e-17, 6.7592e-20, 5.4771e-16, 1.8374e-19, 6.7592e-20, 1.0720e-04,
        2.1532e-03, 3.5962e-08, 1.1001e-14, 1.1756e-01, 1.1001e-14, 1.3576e-18,
        1.1756e-01, 4.4381e-12, 2.6573e-07, 1.1001e-14, 3.1957e-01, 5.8531e-03,
        6.7592e-20, 1.2064e-11])
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 77.76% 

Test Accuracy: 83.01% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6627549529075623
distance x is tensor(115.7089, device='cuda:1')
benign distance is  tensor(115.7089, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0257355906069279
distance x is tensor(100.6921, device='cuda:1')
benign distance is  tensor(100.6921, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.049335390329361
distance x is tensor(82.1913, device='cuda:1')
benign distance is  tensor(82.1913, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.9224209692329168
distance x is tensor(146.2748, device='cuda:1')
benign distance is  tensor(146.2748, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3913520611822605
distance x is tensor(97.9868, device='cuda:1')
benign distance is  tensor(97.9868, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0321991806849837
distance x is tensor(94.6063, device='cuda:1')
benign distance is  tensor(94.6063, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.418603427708149
distance x is tensor(88.6107, device='cuda:1')
benign distance is  tensor(88.6107, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8440375626087189
distance x is tensor(73.2597, device='cuda:1')
benign distance is  tensor(73.2597, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.9694029800593853
distance x is tensor(93.6858, device='cuda:1')
benign distance is  tensor(93.6858, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6704522669315338
distance x is tensor(119.2232, device='cuda:1')
benign distance is  tensor(119.2232, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.247093167155981
distance x is tensor(85.4217, device='cuda:1')
benign distance is  tensor(85.4217, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.237369529902935
distance x is tensor(108.3974, device='cuda:1')
benign distance is  tensor(108.3974, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2838321886956692
distance x is tensor(151.1026, device='cuda:1')
benign distance is  tensor(151.1026, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8948128968477249
distance x is tensor(62.3121, device='cuda:1')
benign distance is  tensor(62.3121, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.0470253210514784
distance x is tensor(125.4395, device='cuda:1')
benign distance is  tensor(125.4395, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.179564945399761
distance x is tensor(120.2587, device='cuda:1')
benign distance is  tensor(120.2587, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.1184058487415314
distance x is tensor(99.5951, device='cuda:1')
benign distance is  tensor(99.5951, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.883833521977067
distance x is tensor(101.4651, device='cuda:1')
benign distance is  tensor(101.4651, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.4172368347644806
distance x is tensor(114.4282, device='cuda:1')
benign distance is  tensor(114.4282, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.045715818181634
distance x is tensor(117.0522, device='cuda:1')
benign distance is  tensor(117.0522, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.2365207727998495
distance x is tensor(93.4353, device='cuda:1')
benign distance is  tensor(93.4353, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.7268185969442129
distance x is tensor(202.6420, device='cuda:1')
benign distance is  tensor(202.6420, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0453013442456722
distance x is tensor(146.5318, device='cuda:1')
benign distance is  tensor(146.5318, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.0797062795609236
distance x is tensor(102.0431, device='cuda:1')
benign distance is  tensor(102.0431, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.5530295744538307
distance x is tensor(96.2526, device='cuda:1')
benign distance is  tensor(96.2526, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.3737506307661533
distance x is tensor(124.0735, device='cuda:1')
benign distance is  tensor(124.0735, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.348457183688879
distance x is tensor(140.4302, device='cuda:1')
benign distance is  tensor(140.4302, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.225177813321352
distance x is tensor(85.4370, device='cuda:1')
benign distance is  tensor(85.4370, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7928631901741028
distance x is tensor(148.3688, device='cuda:1')
benign distance is  tensor(148.3688, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  2.138852298259735
distance x is tensor(128.6119, device='cuda:1')
benign distance is  tensor(128.6119, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.1182723138481379
distance x is tensor(95.1250, device='cuda:1')
benign distance is  tensor(95.1250, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6424994887784123
distance x is tensor(118.1686, device='cuda:1')
benign distance is  tensor(118.1686, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(73.7350, device='cuda:1')
compute distance is  tensor(73.7350, device='cuda:1')
compute norm is  tensor(46.1901, device='cuda:1', dtype=torch.float64)
distance x is tensor(129.4549, device='cuda:1')
compute distance is  tensor(129.4549, device='cuda:1')
compute norm is  tensor(47.3996, device='cuda:1', dtype=torch.float64)
distance x is tensor(90.2901, device='cuda:1')
compute distance is  tensor(90.2901, device='cuda:1')
compute norm is  tensor(46.3792, device='cuda:1', dtype=torch.float64)
distance x is tensor(86.8191, device='cuda:1')
compute distance is  tensor(86.8191, device='cuda:1')
compute norm is  tensor(46.3238, device='cuda:1', dtype=torch.float64)
distance x is tensor(93.5788, device='cuda:1')
compute distance is  tensor(93.5788, device='cuda:1')
compute norm is  tensor(46.3569, device='cuda:1', dtype=torch.float64)
distance x is tensor(111.2210, device='cuda:1')
compute distance is  tensor(111.2210, device='cuda:1')
compute norm is  tensor(46.9150, device='cuda:1', dtype=torch.float64)
distance x is tensor(123.3373, device='cuda:1')
compute distance is  tensor(123.3373, device='cuda:1')
compute norm is  tensor(47.0977, device='cuda:1', dtype=torch.float64)
distance x is tensor(89.1476, device='cuda:1')
compute distance is  tensor(89.1476, device='cuda:1')
compute norm is  tensor(46.4752, device='cuda:1', dtype=torch.float64)
distance x is tensor(119.1776, device='cuda:1')
compute distance is  tensor(119.1776, device='cuda:1')
compute norm is  tensor(47.1241, device='cuda:1', dtype=torch.float64)
distance x is tensor(90.9711, device='cuda:1')
compute distance is  tensor(90.9711, device='cuda:1')
compute norm is  tensor(46.5449, device='cuda:1', dtype=torch.float64)
distance x is tensor(108.9076, device='cuda:1')
compute distance is  tensor(108.9076, device='cuda:1')
compute norm is  tensor(46.6636, device='cuda:1', dtype=torch.float64)
distance x is tensor(143.0368, device='cuda:1')
compute distance is  tensor(143.0368, device='cuda:1')
compute norm is  tensor(47.9141, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(143.0368, device='cuda:1')
distance x is tensor(102067.8516, device='cuda:1')
distance x is tensor(102067.8516, device='cuda:1')
________________________________
test distance is  tensor(102067.8516, device='cuda:1')
test distance1 is  tensor(102067.8516, device='cuda:1')
test similarity is  tensor(0.0565, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107609033661433.45
test entropy is  0.0
________________________________
cal ratio is  0.03668642665612049
distance x is tensor(3744.5100, device='cuda:1')
cal_distance is  tensor(3744.5100, device='cuda:1')
cal ratio is  0.19153688131130528
distance x is tensor(717.2155, device='cuda:1')
cal_distance is  tensor(717.2155, device='cuda:1')
cal ratio is  0.4376481415277678
distance x is tensor(313.8907, device='cuda:1')
cal_distance is  tensor(313.8907, device='cuda:1')
cal ratio is  0.6615470078861313
distance x is tensor(207.6550, device='cuda:1')
cal_distance is  tensor(207.6550, device='cuda:1')
cal ratio is  0.8133523148737836
distance x is tensor(168.8975, device='cuda:1')
cal_distance is  tensor(168.8975, device='cuda:1')
cal ratio is  0.901858228327934
distance x is tensor(152.3221, device='cuda:1')
cal_distance is  tensor(152.3221, device='cuda:1')
cal ratio is  0.9496607036770465
distance x is tensor(144.6546, device='cuda:1')
cal_distance is  tensor(144.6546, device='cuda:1')
cal ratio is  0.9745045011983057
distance x is tensor(140.9666, device='cuda:1')
cal_distance is  tensor(140.9666, device='cuda:1')
distance x is tensor(140.9666, device='cuda:1')
return_distance is  tensor(140.9666, device='cuda:1')
distance x is tensor(140.9574, device='cuda:1')
distance x is tensor(140.9574, device='cuda:1')
________________________________
test distance is  tensor(140.9574, device='cuda:1')
test distance1 is  tensor(140.9574, device='cuda:1')
test similarity is  tensor(0.9467, device='cuda:1')
test acc is  0.10283333348966531
test loss is 195.54156934986236
test entropy is  0.0013306890113316326
________________________________
0
distance x is tensor(140.9574, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.0012781751383540182
avg test loss is  195.38468469485545
avg accuracy is  0.39620000015634105
solo acc is  0.10260000015633197
compute similarity  is  tensor(0.9467, device='cuda:1')
compute_distance is  tensor(140.9574, device='cuda:1')
compute_norm is  tensor(47.4951, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(131.9426, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9293222078509422
avg test loss is  1.5159680873854582
avg accuracy is  0.7632000001563273
solo acc is  0.31203333348967305
compute similarity  is  tensor(0.9493, device='cuda:1')
compute_distance is  tensor(131.9426, device='cuda:1')
compute_norm is  tensor(47.0567, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(131.9426, device='cuda:1')
distance x is tensor(131.9426, device='cuda:1')
________________________________
test distance is  tensor(131.9426, device='cuda:1')
test distance1 is  tensor(131.9426, device='cuda:1')
test similarity is  tensor(0.9493, device='cuda:1')
test acc is  0.3116333334896731
test loss is 1.5174876199856495
test entropy is  0.9287101811945819
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.30200000016000006
mal loss is 1.5279603153467178
mal norm is  tensor(677.2385, device='cuda:1')
distance x is tensor(131.9508, device='cuda:1')
mal distance is  tensor(131.9508, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 20.63% 

Test Accuracy: 24.66% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8898404538631439
distance x is tensor(182.4678, device='cuda:1')
benign distance is  tensor(182.4678, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.9885767325758934
distance x is tensor(152.9594, device='cuda:1')
benign distance is  tensor(152.9594, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.6488552689552307
distance x is tensor(144.8725, device='cuda:1')
benign distance is  tensor(144.8725, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.6029720455408096
distance x is tensor(187.9143, device='cuda:1')
benign distance is  tensor(187.9143, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.172878947108984
distance x is tensor(140.3529, device='cuda:1')
benign distance is  tensor(140.3529, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7875384651124477
distance x is tensor(161.8261, device='cuda:1')
benign distance is  tensor(161.8261, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6795370131731033
distance x is tensor(155.0167, device='cuda:1')
benign distance is  tensor(155.0167, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.7235692515969276
distance x is tensor(136.9426, device='cuda:1')
benign distance is  tensor(136.9426, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(135.9362, device='cuda:1')
compute distance is  tensor(135.9362, device='cuda:1')
compute norm is  tensor(48.9750, device='cuda:1', dtype=torch.float64)
distance x is tensor(183.3863, device='cuda:1')
compute distance is  tensor(183.3863, device='cuda:1')
compute norm is  tensor(50.1269, device='cuda:1', dtype=torch.float64)
distance x is tensor(152.5978, device='cuda:1')
compute distance is  tensor(152.5978, device='cuda:1')
compute norm is  tensor(48.8471, device='cuda:1', dtype=torch.float64)
distance x is tensor(146.8249, device='cuda:1')
compute distance is  tensor(146.8249, device='cuda:1')
compute norm is  tensor(48.9499, device='cuda:1', dtype=torch.float64)
distance x is tensor(137.4961, device='cuda:1')
compute distance is  tensor(137.4961, device='cuda:1')
compute norm is  tensor(48.6705, device='cuda:1', dtype=torch.float64)
distance x is tensor(153.9436, device='cuda:1')
compute distance is  tensor(153.9436, device='cuda:1')
compute norm is  tensor(49.1067, device='cuda:1', dtype=torch.float64)
distance x is tensor(174.7912, device='cuda:1')
compute distance is  tensor(174.7912, device='cuda:1')
compute norm is  tensor(49.6246, device='cuda:1', dtype=torch.float64)
distance x is tensor(126.7141, device='cuda:1')
compute distance is  tensor(126.7141, device='cuda:1')
compute norm is  tensor(48.4155, device='cuda:1', dtype=torch.float64)
distance x is tensor(161.4811, device='cuda:1')
compute distance is  tensor(161.4811, device='cuda:1')
compute norm is  tensor(49.3857, device='cuda:1', dtype=torch.float64)
distance x is tensor(136.7028, device='cuda:1')
compute distance is  tensor(136.7028, device='cuda:1')
compute norm is  tensor(48.9616, device='cuda:1', dtype=torch.float64)
distance x is tensor(156.5812, device='cuda:1')
compute distance is  tensor(156.5812, device='cuda:1')
compute norm is  tensor(49.0904, device='cuda:1', dtype=torch.float64)
distance x is tensor(184.3422, device='cuda:1')
compute distance is  tensor(184.3422, device='cuda:1')
compute norm is  tensor(50.4686, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(184.3422, device='cuda:1')
distance x is tensor(101970.5156, device='cuda:1')
distance x is tensor(101970.5156, device='cuda:1')
________________________________
test distance is  tensor(101970.5156, device='cuda:1')
test distance1 is  tensor(101970.5156, device='cuda:1')
test similarity is  tensor(0.3394, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107562072328973.64
test entropy is  0.0
________________________________
cal ratio is  0.04166785366793989
distance x is tensor(4248.8975, device='cuda:1')
cal_distance is  tensor(4248.8975, device='cuda:1')
cal ratio is  0.20412693252951
distance x is tensor(867.3181, device='cuda:1')
cal_distance is  tensor(867.3181, device='cuda:1')
cal ratio is  0.4518031413240554
distance x is tensor(391.8595, device='cuda:1')
cal_distance is  tensor(391.8595, device='cuda:1')
cal ratio is  0.6721608763440711
distance x is tensor(263.3942, device='cuda:1')
cal_distance is  tensor(263.3942, device='cuda:1')
cal ratio is  0.8198517979175441
distance x is tensor(215.9450, device='cuda:1')
cal_distance is  tensor(215.9450, device='cuda:1')
cal ratio is  0.9054549040900076
distance x is tensor(195.5289, device='cuda:1')
cal_distance is  tensor(195.5289, device='cuda:1')
cal ratio is  0.9515528654290389
distance x is tensor(186.0563, device='cuda:1')
cal_distance is  tensor(186.0563, device='cuda:1')
cal ratio is  0.97547513982613
distance x is tensor(181.4934, device='cuda:1')
cal_distance is  tensor(181.4934, device='cuda:1')
distance x is tensor(181.4934, device='cuda:1')
return_distance is  tensor(181.4934, device='cuda:1')
distance x is tensor(181.4843, device='cuda:1')
distance x is tensor(181.4843, device='cuda:1')
________________________________
test distance is  tensor(181.4843, device='cuda:1')
test distance1 is  tensor(181.4843, device='cuda:1')
test similarity is  tensor(0.9445, device='cuda:1')
test acc is  0.10000000015633198
test loss is 763.3245404534248
test entropy is  9.830222265280477e-42
________________________________
0
distance x is tensor(181.4843, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  4.6119790147960065e-38
avg test loss is  764.4078324242696
avg accuracy is  0.10006666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9445, device='cuda:1')
compute_distance is  tensor(181.4843, device='cuda:1')
compute_norm is  tensor(52.8830, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1971.0604, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.5538099980049296
avg test loss is  2.8977349625467492
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2919, device='cuda:1')
compute_distance is  tensor(1971.0604, device='cuda:1')
compute_norm is  tensor(156.8861, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1962.0697, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8379690741170952
avg test loss is  3.681696679800558
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2919, device='cuda:1')
compute_distance is  tensor(1962.0697, device='cuda:1')
compute_norm is  tensor(156.2084, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1953.2734, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.5549168398639541
avg test loss is  2.8664926760740626
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2918, device='cuda:1')
compute_distance is  tensor(1953.2734, device='cuda:1')
compute_norm is  tensor(155.4459, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1944.4210, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8400328982232222
avg test loss is  3.6382394508003935
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2919, device='cuda:1')
compute_distance is  tensor(1944.4210, device='cuda:1')
compute_norm is  tensor(154.7907, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1935.6404, device='cuda:1')
distance x is tensor(1935.6404, device='cuda:1')
________________________________
test distance is  tensor(1935.6404, device='cuda:1')
test distance1 is  tensor(1935.6404, device='cuda:1')
test similarity is  tensor(0.2918, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.8835512836858914
test entropy is  1.5288387426435313
________________________________
cal ratio is  0.30243085413290427
distance x is tensor(585.3969, device='cuda:1')
cal_distance is  tensor(585.3969, device='cuda:1')
cal ratio is  0.549937347940137
distance x is tensor(321.9315, device='cuda:1')
cal_distance is  tensor(321.9315, device='cuda:1')
cal ratio is  0.7415777275750054
distance x is tensor(238.7372, device='cuda:1')
cal_distance is  tensor(238.7372, device='cuda:1')
cal ratio is  0.8611492612136891
distance x is tensor(205.5883, device='cuda:1')
cal_distance is  tensor(205.5883, device='cuda:1')
cal ratio is  0.9279813739992522
distance x is tensor(190.7821, device='cuda:1')
cal_distance is  tensor(190.7821, device='cuda:1')
cal ratio is  0.963317975559264
distance x is tensor(183.7838, device='cuda:1')
cal_distance is  tensor(183.7838, device='cuda:1')
distance x is tensor(183.7838, device='cuda:1')
return_distance is  tensor(183.7838, device='cuda:1')
distance x is tensor(183.7845, device='cuda:1')
distance x is tensor(183.7845, device='cuda:1')
________________________________
test distance is  tensor(183.7845, device='cuda:1')
test distance1 is  tensor(183.7845, device='cuda:1')
test similarity is  tensor(0.9516, device='cuda:1')
test acc is  0.14028333348966562
test loss is 5.683826613273702
test entropy is  0.9194970693288327
________________________________
0
distance x is tensor(183.7845, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.9199369886536588
avg test loss is  5.6782033552747295
avg accuracy is  0.1020333334896653
solo acc is  0.14070000015633233
compute similarity  is  tensor(0.9516, device='cuda:1')
compute_distance is  tensor(183.7845, device='cuda:1')
compute_norm is  tensor(50.1934, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(189.2744, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.4530373394870555
avg test loss is  2.0473900428458824
avg accuracy is  0.10470000015633195
solo acc is  0.12755000015633192
compute similarity  is  tensor(0.9514, device='cuda:1')
compute_distance is  tensor(189.2744, device='cuda:1')
compute_norm is  tensor(50.0243, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(189.5347, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.7273656323647448
avg test loss is  2.744082074938044
avg accuracy is  0.1013833334896653
solo acc is  0.1009333334896653
compute similarity  is  tensor(0.9511, device='cuda:1')
compute_distance is  tensor(189.5347, device='cuda:1')
compute_norm is  tensor(49.9024, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(192.4665, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.0405266720221749
avg test loss is  1.7836067215211864
avg accuracy is  0.10701666682299862
solo acc is  0.19380000015633597
compute similarity  is  tensor(0.9509, device='cuda:1')
compute_distance is  tensor(192.4665, device='cuda:1')
compute_norm is  tensor(49.6681, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(192.2404, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.6818599286618263
avg test loss is  2.4925571893578145
avg accuracy is  0.10258333348966531
solo acc is  0.10345000015633196
compute similarity  is  tensor(0.9507, device='cuda:1')
compute_distance is  tensor(192.2404, device='cuda:1')
compute_norm is  tensor(49.5082, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(194.2163, device='cuda:1')
distance x is tensor(194.2163, device='cuda:1')
________________________________
test distance is  tensor(194.2163, device='cuda:1')
test distance1 is  tensor(194.2163, device='cuda:1')
test similarity is  tensor(0.9503, device='cuda:1')
test acc is  0.23355000015633778
test loss is 1.624961535813712
test entropy is  0.9652039600587857
________________________________
cal ratio is  0.9547631198009588
distance x is tensor(185.4280, device='cuda:1')
cal_distance is  tensor(185.4280, device='cuda:1')
cal ratio is  0.9771264457111222
distance x is tensor(181.1866, device='cuda:1')
cal_distance is  tensor(181.1866, device='cuda:1')
distance x is tensor(181.1866, device='cuda:1')
return_distance is  tensor(181.1866, device='cuda:1')
distance x is tensor(181.1891, device='cuda:1')
distance x is tensor(181.1891, device='cuda:1')
________________________________
test distance is  tensor(181.1891, device='cuda:1')
test distance1 is  tensor(181.1891, device='cuda:1')
test similarity is  tensor(0.9565, device='cuda:1')
test acc is  0.2096333334896701
test loss is 1.7035162227748553
test entropy is  0.9388118805026194
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2230000001600001
mal loss is 1.7620660588145256
mal norm is  tensor(646.1216, device='cuda:1')
distance x is tensor(181.1866, device='cuda:1')
mal distance is  tensor(181.1866, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([30., 30., 16., 18., 22., 22., 12., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 13., 27., 12., 12., 19., 22., 21., 14.,
        12., 13., 12., 12., 12., 21.,  0., 12.])
count_res tensor([4.8058e-01, 4.8058e-01, 3.9962e-07, 2.9528e-06, 1.6122e-04, 1.6122e-04,
        7.3193e-09, 7.3193e-09, 1.1912e-03, 1.1912e-03, 1.1912e-03, 1.1912e-03,
        1.1912e-03, 1.1912e-03, 1.1912e-03, 1.1912e-03, 1.1912e-03, 1.1912e-03,
        1.1912e-03, 1.1912e-03, 1.9896e-08, 2.3927e-02, 7.3193e-09, 7.3193e-09,
        8.0265e-06, 1.6122e-04, 5.9309e-05, 5.4082e-08, 7.3193e-09, 1.9896e-08,
        7.3193e-09, 7.3193e-09, 7.3193e-09, 5.9309e-05, 4.4971e-14, 7.3193e-09])
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 88.74% 

Test Accuracy: 83.13% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8852263931185007
distance x is tensor(115.0497, device='cuda:1')
benign distance is  tensor(115.0497, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.1900660768151283
distance x is tensor(80.7344, device='cuda:1')
benign distance is  tensor(80.7344, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.8487892616540194
distance x is tensor(104.5236, device='cuda:1')
benign distance is  tensor(104.5236, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3395243361592293
distance x is tensor(149.7672, device='cuda:1')
benign distance is  tensor(149.7672, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4786249995231628
distance x is tensor(108.9452, device='cuda:1')
benign distance is  tensor(108.9452, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.732157695107162
distance x is tensor(107.0815, device='cuda:1')
benign distance is  tensor(107.0815, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5484808459877968
distance x is tensor(105.0370, device='cuda:1')
benign distance is  tensor(105.0370, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8484541121870279
distance x is tensor(101.6012, device='cuda:1')
benign distance is  tensor(101.6012, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.405833326280117
distance x is tensor(114.7728, device='cuda:1')
benign distance is  tensor(114.7728, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6800500615499914
distance x is tensor(126.4260, device='cuda:1')
benign distance is  tensor(126.4260, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3677210249006748
distance x is tensor(97.5921, device='cuda:1')
benign distance is  tensor(97.5921, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.9804820865392685
distance x is tensor(110.6451, device='cuda:1')
benign distance is  tensor(110.6451, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.352452252060175
distance x is tensor(165.5570, device='cuda:1')
benign distance is  tensor(165.5570, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8382664211094379
distance x is tensor(74.6586, device='cuda:1')
benign distance is  tensor(74.6586, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.1107392758131027
distance x is tensor(147.4546, device='cuda:1')
benign distance is  tensor(147.4546, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.3444190323352814
distance x is tensor(119.5742, device='cuda:1')
benign distance is  tensor(119.5742, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.4533977322280407
distance x is tensor(132.6176, device='cuda:1')
benign distance is  tensor(132.6176, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.910708375275135
distance x is tensor(89.3315, device='cuda:1')
benign distance is  tensor(89.3315, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.3421041779220104
distance x is tensor(124.6345, device='cuda:1')
benign distance is  tensor(124.6345, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.102394998073578
distance x is tensor(114.4775, device='cuda:1')
benign distance is  tensor(114.4775, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.1965411230921745
distance x is tensor(124.7097, device='cuda:1')
benign distance is  tensor(124.7097, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9804089739918709
distance x is tensor(120.0110, device='cuda:1')
benign distance is  tensor(120.0110, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6042210152372718
distance x is tensor(118.9914, device='cuda:1')
benign distance is  tensor(118.9914, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.1508554592728615
distance x is tensor(163.6041, device='cuda:1')
benign distance is  tensor(163.6041, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(93.3980, device='cuda:1')
compute distance is  tensor(93.3980, device='cuda:1')
compute norm is  tensor(49.5337, device='cuda:1', dtype=torch.float64)
distance x is tensor(145.6537, device='cuda:1')
compute distance is  tensor(145.6537, device='cuda:1')
compute norm is  tensor(50.6785, device='cuda:1', dtype=torch.float64)
distance x is tensor(109.6212, device='cuda:1')
compute distance is  tensor(109.6212, device='cuda:1')
compute norm is  tensor(49.7584, device='cuda:1', dtype=torch.float64)
distance x is tensor(105.0801, device='cuda:1')
compute distance is  tensor(105.0801, device='cuda:1')
compute norm is  tensor(49.7526, device='cuda:1', dtype=torch.float64)
distance x is tensor(94.0185, device='cuda:1')
compute distance is  tensor(94.0185, device='cuda:1')
compute norm is  tensor(49.5788, device='cuda:1', dtype=torch.float64)
distance x is tensor(112.4458, device='cuda:1')
compute distance is  tensor(112.4458, device='cuda:1')
compute norm is  tensor(50.0025, device='cuda:1', dtype=torch.float64)
distance x is tensor(124.6390, device='cuda:1')
compute distance is  tensor(124.6390, device='cuda:1')
compute norm is  tensor(50.2201, device='cuda:1', dtype=torch.float64)
distance x is tensor(105.5514, device='cuda:1')
compute distance is  tensor(105.5514, device='cuda:1')
compute norm is  tensor(49.6667, device='cuda:1', dtype=torch.float64)
distance x is tensor(133.4691, device='cuda:1')
compute distance is  tensor(133.4691, device='cuda:1')
compute norm is  tensor(50.2860, device='cuda:1', dtype=torch.float64)
distance x is tensor(96.1045, device='cuda:1')
compute distance is  tensor(96.1045, device='cuda:1')
compute norm is  tensor(49.6637, device='cuda:1', dtype=torch.float64)
distance x is tensor(123.1699, device='cuda:1')
compute distance is  tensor(123.1699, device='cuda:1')
compute norm is  tensor(49.9040, device='cuda:1', dtype=torch.float64)
distance x is tensor(149.1447, device='cuda:1')
compute distance is  tensor(149.1447, device='cuda:1')
compute norm is  tensor(50.8371, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(149.1447, device='cuda:1')
distance x is tensor(102013.0234, device='cuda:1')
distance x is tensor(102013.0234, device='cuda:1')
________________________________
test distance is  tensor(102013.0234, device='cuda:1')
test distance1 is  tensor(102013.0234, device='cuda:1')
test similarity is  tensor(0.2740, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107545451724171.19
test entropy is  0.0
________________________________
cal ratio is  0.03747159322971895
distance x is tensor(3822.5952, device='cuda:1')
cal_distance is  tensor(3822.5952, device='cuda:1')
cal ratio is  0.1935756877512035
distance x is tensor(739.9652, device='cuda:1')
cal_distance is  tensor(739.9652, device='cuda:1')
cal ratio is  0.4399712590630301
distance x is tensor(325.5659, device='cuda:1')
cal_distance is  tensor(325.5659, device='cuda:1')
cal ratio is  0.6633007427447069
distance x is tensor(215.9497, device='cuda:1')
cal_distance is  tensor(215.9497, device='cuda:1')
cal ratio is  0.8144298333732317
distance x is tensor(175.8767, device='cuda:1')
cal_distance is  tensor(175.8767, device='cuda:1')
cal ratio is  0.9024554769993676
distance x is tensor(158.7214, device='cuda:1')
cal_distance is  tensor(158.7214, device='cuda:1')
cal ratio is  0.949975215927381
distance x is tensor(150.7816, device='cuda:1')
cal_distance is  tensor(150.7816, device='cuda:1')
cal ratio is  0.9746659988252849
distance x is tensor(146.9618, device='cuda:1')
cal_distance is  tensor(146.9618, device='cuda:1')
distance x is tensor(146.9618, device='cuda:1')
return_distance is  tensor(146.9618, device='cuda:1')
distance x is tensor(146.9527, device='cuda:1')
distance x is tensor(146.9527, device='cuda:1')
________________________________
test distance is  tensor(146.9527, device='cuda:1')
test distance1 is  tensor(146.9527, device='cuda:1')
test similarity is  tensor(0.9595, device='cuda:1')
test acc is  0.21370000015633703
test loss is 75.10730822304927
test entropy is  0.044646155306084484
________________________________
0
distance x is tensor(146.9527, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.044359077104250154
avg test loss is  74.90714381041049
avg accuracy is  0.5657500001563405
solo acc is  0.21601666682300366
compute similarity  is  tensor(0.9595, device='cuda:1')
compute_distance is  tensor(146.9527, device='cuda:1')
compute_norm is  tensor(52.4802, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(146.7601, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.0361392238755216
avg test loss is  1.5945737674546394
avg accuracy is  0.727400000156329
solo acc is  0.2679833334896721
compute similarity  is  tensor(0.9553, device='cuda:1')
compute_distance is  tensor(146.7601, device='cuda:1')
compute_norm is  tensor(52.7238, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(147.8120, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.6278392106675899
avg test loss is  2.475293290894677
avg accuracy is  0.7123333334896633
solo acc is  0.1123666668229986
compute similarity  is  tensor(0.9548, device='cuda:1')
compute_distance is  tensor(147.8120, device='cuda:1')
compute_norm is  tensor(52.5008, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(148.7472, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.9638245955967446
avg test loss is  1.5020055753081591
avg accuracy is  0.7603333334896607
solo acc is  0.26755000015633873
compute similarity  is  tensor(0.9552, device='cuda:1')
compute_distance is  tensor(148.7472, device='cuda:1')
compute_norm is  tensor(52.2160, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(148.7472, device='cuda:1')
distance x is tensor(148.7472, device='cuda:1')
________________________________
test distance is  tensor(148.7472, device='cuda:1')
test distance1 is  tensor(148.7472, device='cuda:1')
test similarity is  tensor(0.9552, device='cuda:1')
test acc is  0.2693833334896721
test loss is 1.499445886118834
test entropy is  0.9634625885659444
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2650000001600001
mal loss is 1.5055598989129066
mal norm is  tensor(748.5830, device='cuda:1')
distance x is tensor(148.7562, device='cuda:1')
mal distance is  tensor(148.7562, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([12., 12., 14., 12., 12., 10., 12., 27., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 19., 26., 12., 12., 12., 12., 12., 12.])
count_res tensor([2.2354e-07, 2.2354e-07, 1.6518e-06, 2.2354e-07, 2.2354e-07, 3.0253e-08,
        2.2354e-07, 7.3077e-01, 1.2205e-05, 1.2205e-05, 1.2205e-05, 1.2205e-05,
        1.2205e-05, 1.2205e-05, 1.2205e-05, 1.2205e-05, 1.2205e-05, 1.2205e-05,
        1.2205e-05, 1.2205e-05, 2.4515e-04, 2.6883e-01, 2.2354e-07, 2.2354e-07,
        2.2354e-07, 2.2354e-07, 2.2354e-07, 2.2354e-07])
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 76.52% 

Test Accuracy: 82.88% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6690187714993954
distance x is tensor(111.0091, device='cuda:1')
benign distance is  tensor(111.0091, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2527899332344532
distance x is tensor(106.9060, device='cuda:1')
benign distance is  tensor(106.9060, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.4785255193710327
distance x is tensor(108.0828, device='cuda:1')
benign distance is  tensor(108.0828, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3156335763633251
distance x is tensor(157.1648, device='cuda:1')
benign distance is  tensor(157.1648, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2757575325667858
distance x is tensor(119.6051, device='cuda:1')
benign distance is  tensor(119.6051, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9564955327659845
distance x is tensor(119.7401, device='cuda:1')
benign distance is  tensor(119.7401, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2726607993245125
distance x is tensor(108.9326, device='cuda:1')
benign distance is  tensor(108.9326, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0630143247544765
distance x is tensor(57.6919, device='cuda:1')
benign distance is  tensor(57.6919, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.790558010339737
distance x is tensor(100.4555, device='cuda:1')
benign distance is  tensor(100.4555, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.185432355850935
distance x is tensor(112.6912, device='cuda:1')
benign distance is  tensor(112.6912, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.410254430025816
distance x is tensor(123.9610, device='cuda:1')
benign distance is  tensor(123.9610, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.2678691744804382
distance x is tensor(119.5592, device='cuda:1')
benign distance is  tensor(119.5592, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.2542543672025204
distance x is tensor(80.8310, device='cuda:1')
benign distance is  tensor(80.8310, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.1105984840542078
distance x is tensor(207.4120, device='cuda:1')
benign distance is  tensor(207.4120, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1991413831710815
distance x is tensor(162.0596, device='cuda:1')
benign distance is  tensor(162.0596, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.7795508224517107
distance x is tensor(127.2788, device='cuda:1')
benign distance is  tensor(127.2788, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(87.2497, device='cuda:1')
compute distance is  tensor(87.2497, device='cuda:1')
compute norm is  tensor(49.0644, device='cuda:1', dtype=torch.float64)
distance x is tensor(142.7494, device='cuda:1')
compute distance is  tensor(142.7494, device='cuda:1')
compute norm is  tensor(50.0679, device='cuda:1', dtype=torch.float64)
distance x is tensor(116.6524, device='cuda:1')
compute distance is  tensor(116.6524, device='cuda:1')
compute norm is  tensor(49.2745, device='cuda:1', dtype=torch.float64)
distance x is tensor(104.6611, device='cuda:1')
compute distance is  tensor(104.6611, device='cuda:1')
compute norm is  tensor(49.2392, device='cuda:1', dtype=torch.float64)
distance x is tensor(89.0650, device='cuda:1')
compute distance is  tensor(89.0650, device='cuda:1')
compute norm is  tensor(48.9784, device='cuda:1', dtype=torch.float64)
distance x is tensor(125.1377, device='cuda:1')
compute distance is  tensor(125.1377, device='cuda:1')
compute norm is  tensor(49.7453, device='cuda:1', dtype=torch.float64)
distance x is tensor(132.8591, device='cuda:1')
compute distance is  tensor(132.8591, device='cuda:1')
compute norm is  tensor(49.7396, device='cuda:1', dtype=torch.float64)
distance x is tensor(99.3444, device='cuda:1')
compute distance is  tensor(99.3444, device='cuda:1')
compute norm is  tensor(49.1702, device='cuda:1', dtype=torch.float64)
distance x is tensor(127.3066, device='cuda:1')
compute distance is  tensor(127.3066, device='cuda:1')
compute norm is  tensor(49.6746, device='cuda:1', dtype=torch.float64)
distance x is tensor(105.4573, device='cuda:1')
compute distance is  tensor(105.4573, device='cuda:1')
compute norm is  tensor(49.4342, device='cuda:1', dtype=torch.float64)
distance x is tensor(129.8432, device='cuda:1')
compute distance is  tensor(129.8432, device='cuda:1')
compute norm is  tensor(49.7101, device='cuda:1', dtype=torch.float64)
distance x is tensor(151.7963, device='cuda:1')
compute distance is  tensor(151.7963, device='cuda:1')
compute norm is  tensor(50.5784, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(151.7963, device='cuda:1')
distance x is tensor(102031.8750, device='cuda:1')
distance x is tensor(102031.8750, device='cuda:1')
________________________________
test distance is  tensor(102031.8750, device='cuda:1')
test distance1 is  tensor(102031.8750, device='cuda:1')
test similarity is  tensor(0.2063, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107663963268242.28
test entropy is  0.0
________________________________
cal ratio is  0.037799729336436244
distance x is tensor(3856.7820, device='cuda:1')
cal_distance is  tensor(3856.7820, device='cuda:1')
cal ratio is  0.194421403024682
distance x is tensor(749.8447, device='cuda:1')
cal_distance is  tensor(749.8447, device='cuda:1')
cal ratio is  0.4409313443306419
distance x is tensor(330.6325, device='cuda:1')
cal_distance is  tensor(330.6325, device='cuda:1')
cal ratio is  0.6640240999855027
distance x is tensor(219.5495, device='cuda:1')
cal_distance is  tensor(219.5495, device='cuda:1')
cal ratio is  0.8148738244158379
distance x is tensor(178.9060, device='cuda:1')
cal_distance is  tensor(178.9060, device='cuda:1')
cal ratio is  0.9027014633907434
distance x is tensor(161.4992, device='cuda:1')
cal_distance is  tensor(161.4992, device='cuda:1')
cal ratio is  0.950104733240286
distance x is tensor(153.4413, device='cuda:1')
cal_distance is  tensor(153.4413, device='cuda:1')
cal ratio is  0.9747324520702573
distance x is tensor(149.5644, device='cuda:1')
cal_distance is  tensor(149.5644, device='cuda:1')
distance x is tensor(149.5644, device='cuda:1')
return_distance is  tensor(149.5644, device='cuda:1')
distance x is tensor(149.5553, device='cuda:1')
distance x is tensor(149.5553, device='cuda:1')
________________________________
test distance is  tensor(149.5553, device='cuda:1')
test distance1 is  tensor(149.5553, device='cuda:1')
test similarity is  tensor(0.9539, device='cuda:1')
test acc is  0.10958333348966529
test loss is 181.26004459405505
test entropy is  0.0037359782481001177
________________________________
0
distance x is tensor(149.5553, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.003708403007931001
avg test loss is  180.910651379811
avg accuracy is  0.4791500001563419
solo acc is  0.10973333348966528
compute similarity  is  tensor(0.9539, device='cuda:1')
compute_distance is  tensor(149.5553, device='cuda:1')
compute_norm is  tensor(51.6331, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(153.8008, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.1356749275981237
avg test loss is  1.7705998404193788
avg accuracy is  0.6925333334896644
solo acc is  0.2424166668230047
compute similarity  is  tensor(0.9524, device='cuda:1')
compute_distance is  tensor(153.8008, device='cuda:1')
compute_norm is  tensor(52.2510, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(155.1696, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.6828402798694334
avg test loss is  2.6700496612581364
avg accuracy is  0.6907000001563313
solo acc is  0.11115000015633195
compute similarity  is  tensor(0.9519, device='cuda:1')
compute_distance is  tensor(155.1696, device='cuda:1')
compute_norm is  tensor(52.1327, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(156.3132, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.0051219831905893
avg test loss is  1.6118182084961994
avg accuracy is  0.7087000001563302
solo acc is  0.2519000001563383
compute similarity  is  tensor(0.9521, device='cuda:1')
compute_distance is  tensor(156.3132, device='cuda:1')
compute_norm is  tensor(51.7561, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(157.4435, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.6235494095760622
avg test loss is  2.459467992726674
avg accuracy is  0.7035333334896638
solo acc is  0.1117166668229986
compute similarity  is  tensor(0.9515, device='cuda:1')
compute_distance is  tensor(157.4435, device='cuda:1')
compute_norm is  tensor(51.6073, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(158.6039, device='cuda:1')
distance x is tensor(158.6039, device='cuda:1')
________________________________
test distance is  tensor(158.6039, device='cuda:1')
test distance1 is  tensor(158.6039, device='cuda:1')
test similarity is  tensor(0.9514, device='cuda:1')
test acc is  0.26691666682300547
test loss is 1.490915849264751
test entropy is  0.9522485300294881
________________________________
cal ratio is  0.9587374616123842
distance x is tensor(152.0671, device='cuda:1')
cal_distance is  tensor(152.0671, device='cuda:1')
cal ratio is  0.9791267814074581
distance x is tensor(148.8931, device='cuda:1')
cal_distance is  tensor(148.8931, device='cuda:1')
distance x is tensor(148.8931, device='cuda:1')
return_distance is  tensor(148.8931, device='cuda:1')
distance x is tensor(148.8853, device='cuda:1')
distance x is tensor(148.8853, device='cuda:1')
________________________________
test distance is  tensor(148.8853, device='cuda:1')
test distance1 is  tensor(148.8853, device='cuda:1')
test similarity is  tensor(0.9567, device='cuda:1')
test acc is  0.29566666682300613
test loss is 1.422619501410771
test entropy is  1.0318552692815948
________________________________
0
distance x is tensor(148.8853, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.0336740053157563
avg test loss is  1.4212257169457132
avg accuracy is  0.7262000001563291
solo acc is  0.29363333348967274
compute similarity  is  tensor(0.9567, device='cuda:1')
compute_distance is  tensor(148.8853, device='cuda:1')
compute_norm is  tensor(50.9300, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(150.4380, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.5996220147114064
avg test loss is  2.3566401929997687
avg accuracy is  0.7226666668229961
solo acc is  0.11001666682299861
compute similarity  is  tensor(0.9558, device='cuda:1')
compute_distance is  tensor(150.4380, device='cuda:1')
compute_norm is  tensor(50.7950, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(151.7550, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.9206921456973436
avg test loss is  1.4087653818415171
avg accuracy is  0.7419333334896616
solo acc is  0.2844166668230058
compute similarity  is  tensor(0.9556, device='cuda:1')
compute_distance is  tensor(151.7550, device='cuda:1')
compute_norm is  tensor(50.4390, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(151.7550, device='cuda:1')
distance x is tensor(151.7550, device='cuda:1')
________________________________
test distance is  tensor(151.7550, device='cuda:1')
test distance1 is  tensor(151.7550, device='cuda:1')
test similarity is  tensor(0.9556, device='cuda:1')
test acc is  0.2849666668230059
test loss is 1.4081934672683032
test entropy is  0.9213200657606633
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.30500000016000006
mal loss is 1.379353828728199
mal norm is  tensor(690.5132, device='cuda:1')
distance x is tensor(151.7627, device='cuda:1')
mal distance is  tensor(151.7627, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([12., 12., 35.,  6., 21., 23., 12., 16., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 13., 12.,  8., 12., 16., 12., 23., 13.,
         0.,  0., 12., 27., 12., 34., 31., 34.])
count_res tensor([5.8485e-11, 5.8485e-11, 5.6992e-01, 1.4497e-13, 4.7391e-07, 3.5017e-06,
        5.8485e-11, 3.1932e-09, 9.5187e-06, 9.5187e-06, 9.5187e-06, 9.5187e-06,
        9.5187e-06, 9.5187e-06, 9.5187e-06, 9.5187e-06, 9.5187e-06, 9.5187e-06,
        9.5187e-06, 9.5187e-06, 1.5898e-10, 5.8485e-11, 1.0712e-12, 5.8485e-11,
        3.1932e-09, 5.8485e-11, 3.5017e-06, 1.5898e-10, 3.5934e-16, 3.5934e-16,
        5.8485e-11, 1.9119e-04, 5.8485e-11, 2.0966e-01, 1.0439e-02, 2.0966e-01])
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 74.14% 

Test Accuracy: 82.26% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7341502513736486
distance x is tensor(131.0082, device='cuda:1')
benign distance is  tensor(131.0082, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2596323415637016
distance x is tensor(98.3575, device='cuda:1')
benign distance is  tensor(98.3575, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.3066879697144032
distance x is tensor(81.4589, device='cuda:1')
benign distance is  tensor(81.4589, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4450685195624828
distance x is tensor(150.7641, device='cuda:1')
benign distance is  tensor(150.7641, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.1702663153409958
distance x is tensor(120.3394, device='cuda:1')
benign distance is  tensor(120.3394, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7905342448502779
distance x is tensor(108.4547, device='cuda:1')
benign distance is  tensor(108.4547, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.225536946207285
distance x is tensor(108.9952, device='cuda:1')
benign distance is  tensor(108.9952, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9461466018110514
distance x is tensor(87.7401, device='cuda:1')
benign distance is  tensor(87.7401, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.389300737529993
distance x is tensor(118.6055, device='cuda:1')
benign distance is  tensor(118.6055, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.6950210649520159
distance x is tensor(134.7875, device='cuda:1')
benign distance is  tensor(134.7875, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.695486232638359
distance x is tensor(95.2239, device='cuda:1')
benign distance is  tensor(95.2239, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.3513399735093117
distance x is tensor(106.3783, device='cuda:1')
benign distance is  tensor(106.3783, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.8332072049379349
distance x is tensor(164.3504, device='cuda:1')
benign distance is  tensor(164.3504, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.1300925444811583
distance x is tensor(69.0771, device='cuda:1')
benign distance is  tensor(69.0771, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.066456638276577
distance x is tensor(145.4598, device='cuda:1')
benign distance is  tensor(145.4598, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.8798875026404858
distance x is tensor(117.4758, device='cuda:1')
benign distance is  tensor(117.4758, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.9010455124080181
distance x is tensor(137.2956, device='cuda:1')
benign distance is  tensor(137.2956, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.9469550848007202
distance x is tensor(110.3010, device='cuda:1')
benign distance is  tensor(110.3010, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.9478651806712151
distance x is tensor(148.2121, device='cuda:1')
benign distance is  tensor(148.2121, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.241368755698204
distance x is tensor(119.6568, device='cuda:1')
benign distance is  tensor(119.6568, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.763472056016326
distance x is tensor(129.2045, device='cuda:1')
benign distance is  tensor(129.2045, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.9868825115263462
distance x is tensor(98.1346, device='cuda:1')
benign distance is  tensor(98.1346, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.5003736019134521
distance x is tensor(100.7823, device='cuda:1')
benign distance is  tensor(100.7823, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.8740305658429861
distance x is tensor(137.0419, device='cuda:1')
benign distance is  tensor(137.0419, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(97.1426, device='cuda:1')
compute distance is  tensor(97.1426, device='cuda:1')
compute norm is  tensor(49.9384, device='cuda:1', dtype=torch.float64)
distance x is tensor(149.6131, device='cuda:1')
compute distance is  tensor(149.6131, device='cuda:1')
compute norm is  tensor(50.9765, device='cuda:1', dtype=torch.float64)
distance x is tensor(118.7121, device='cuda:1')
compute distance is  tensor(118.7121, device='cuda:1')
compute norm is  tensor(49.9846, device='cuda:1', dtype=torch.float64)
distance x is tensor(126.9133, device='cuda:1')
compute distance is  tensor(126.9133, device='cuda:1')
compute norm is  tensor(50.3082, device='cuda:1', dtype=torch.float64)
distance x is tensor(96.4364, device='cuda:1')
compute distance is  tensor(96.4364, device='cuda:1')
compute norm is  tensor(49.7913, device='cuda:1', dtype=torch.float64)
distance x is tensor(118.5242, device='cuda:1')
compute distance is  tensor(118.5242, device='cuda:1')
compute norm is  tensor(50.1504, device='cuda:1', dtype=torch.float64)
distance x is tensor(130.7300, device='cuda:1')
compute distance is  tensor(130.7300, device='cuda:1')
compute norm is  tensor(50.5015, device='cuda:1', dtype=torch.float64)
distance x is tensor(99.8727, device='cuda:1')
compute distance is  tensor(99.8727, device='cuda:1')
compute norm is  tensor(49.8739, device='cuda:1', dtype=torch.float64)
distance x is tensor(125.7113, device='cuda:1')
compute distance is  tensor(125.7113, device='cuda:1')
compute norm is  tensor(50.4695, device='cuda:1', dtype=torch.float64)
distance x is tensor(122.0282, device='cuda:1')
compute distance is  tensor(122.0282, device='cuda:1')
compute norm is  tensor(50.3964, device='cuda:1', dtype=torch.float64)
distance x is tensor(119.1951, device='cuda:1')
compute distance is  tensor(119.1951, device='cuda:1')
compute norm is  tensor(50.1706, device='cuda:1', dtype=torch.float64)
distance x is tensor(147.7685, device='cuda:1')
compute distance is  tensor(147.7685, device='cuda:1')
compute norm is  tensor(51.1719, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(149.6131, device='cuda:1')
distance x is tensor(102029.6719, device='cuda:1')
distance x is tensor(102029.6719, device='cuda:1')
________________________________
test distance is  tensor(102029.6719, device='cuda:1')
test distance1 is  tensor(102029.6719, device='cuda:1')
test similarity is  tensor(0.2214, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107532041094447.48
test entropy is  0.0
________________________________
cal ratio is  0.03752732821548893
distance x is tensor(3828.9067, device='cuda:1')
cal_distance is  tensor(3828.9067, device='cuda:1')
cal ratio is  0.19371956699686432
distance x is tensor(741.7377, device='cuda:1')
cal_distance is  tensor(741.7377, device='cuda:1')
cal ratio is  0.4401347921772382
distance x is tensor(326.4671, device='cuda:1')
cal_distance is  tensor(326.4671, device='cuda:1')
cal ratio is  0.6634239492411582
distance x is tensor(216.5877, device='cuda:1')
cal_distance is  tensor(216.5877, device='cuda:1')
cal ratio is  0.8145054944370009
distance x is tensor(176.4127, device='cuda:1')
cal_distance is  tensor(176.4127, device='cuda:1')
cal ratio is  0.9024973409618822
distance x is tensor(159.2124, device='cuda:1')
cal_distance is  tensor(159.2124, device='cuda:1')
cal ratio is  0.9499973004955286
distance x is tensor(151.2516, device='cuda:1')
cal_distance is  tensor(151.2516, device='cuda:1')
cal ratio is  0.9746773047126494
distance x is tensor(147.4216, device='cuda:1')
cal_distance is  tensor(147.4216, device='cuda:1')
distance x is tensor(147.4216, device='cuda:1')
return_distance is  tensor(147.4216, device='cuda:1')
distance x is tensor(147.4126, device='cuda:1')
distance x is tensor(147.4126, device='cuda:1')
________________________________
test distance is  tensor(147.4126, device='cuda:1')
test distance1 is  tensor(147.4126, device='cuda:1')
test similarity is  tensor(0.9570, device='cuda:1')
test acc is  0.2117500001563368
test loss is 110.14240801715647
test entropy is  0.03563247739547379
________________________________
0
distance x is tensor(147.4126, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.03433780447638997
avg test loss is  110.46620032629733
avg accuracy is  0.4740166668230085
solo acc is  0.21038333348967012
compute similarity  is  tensor(0.9570, device='cuda:1')
compute_distance is  tensor(147.4126, device='cuda:1')
compute_norm is  tensor(52.3610, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(141.9916, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9619520422238023
avg test loss is  1.4307513055262535
avg accuracy is  0.7940833334896591
solo acc is  0.3426166668230069
compute similarity  is  tensor(0.9572, device='cuda:1')
compute_distance is  tensor(141.9916, device='cuda:1')
compute_norm is  tensor(51.9539, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(141.9916, device='cuda:1')
distance x is tensor(141.9916, device='cuda:1')
________________________________
test distance is  tensor(141.9916, device='cuda:1')
test distance1 is  tensor(141.9916, device='cuda:1')
test similarity is  tensor(0.9572, device='cuda:1')
test acc is  0.3416333334896736
test loss is 1.4315543144242342
test entropy is  0.9626192833696093
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.35800000016000005
mal loss is 1.4208712205290794
mal norm is  tensor(721.8320, device='cuda:1')
distance x is tensor(142.0005, device='cuda:1')
mal distance is  tensor(142.0005, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 28.11% 

Test Accuracy: 31.10% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.1158999800682068
distance x is tensor(177.5556, device='cuda:1')
benign distance is  tensor(177.5556, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.938405767083168
distance x is tensor(149.0674, device='cuda:1')
benign distance is  tensor(149.0674, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.252583909779787
distance x is tensor(139.0735, device='cuda:1')
benign distance is  tensor(139.0735, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.7522627338767052
distance x is tensor(187.0809, device='cuda:1')
benign distance is  tensor(187.0809, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.7319101803004742
distance x is tensor(156.8527, device='cuda:1')
benign distance is  tensor(156.8527, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0942772440612316
distance x is tensor(156.2058, device='cuda:1')
benign distance is  tensor(156.2058, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.450694240629673
distance x is tensor(167.4807, device='cuda:1')
benign distance is  tensor(167.4807, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.6046893820166588
distance x is tensor(132.0402, device='cuda:1')
benign distance is  tensor(132.0402, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(124.6787, device='cuda:1')
compute distance is  tensor(124.6787, device='cuda:1')
compute norm is  tensor(53.4251, device='cuda:1', dtype=torch.float64)
distance x is tensor(171.5863, device='cuda:1')
compute distance is  tensor(171.5863, device='cuda:1')
compute norm is  tensor(54.3361, device='cuda:1', dtype=torch.float64)
distance x is tensor(143.0169, device='cuda:1')
compute distance is  tensor(143.0169, device='cuda:1')
compute norm is  tensor(53.5176, device='cuda:1', dtype=torch.float64)
distance x is tensor(159.5322, device='cuda:1')
compute distance is  tensor(159.5322, device='cuda:1')
compute norm is  tensor(54.0664, device='cuda:1', dtype=torch.float64)
distance x is tensor(135.6057, device='cuda:1')
compute distance is  tensor(135.6057, device='cuda:1')
compute norm is  tensor(53.4580, device='cuda:1', dtype=torch.float64)
distance x is tensor(143.7277, device='cuda:1')
compute distance is  tensor(143.7277, device='cuda:1')
compute norm is  tensor(53.6925, device='cuda:1', dtype=torch.float64)
distance x is tensor(162.0149, device='cuda:1')
compute distance is  tensor(162.0149, device='cuda:1')
compute norm is  tensor(54.2082, device='cuda:1', dtype=torch.float64)
distance x is tensor(136.3407, device='cuda:1')
compute distance is  tensor(136.3407, device='cuda:1')
compute norm is  tensor(53.3809, device='cuda:1', dtype=torch.float64)
distance x is tensor(160.2778, device='cuda:1')
compute distance is  tensor(160.2778, device='cuda:1')
compute norm is  tensor(54.2377, device='cuda:1', dtype=torch.float64)
distance x is tensor(153.9887, device='cuda:1')
compute distance is  tensor(153.9887, device='cuda:1')
compute norm is  tensor(54.2867, device='cuda:1', dtype=torch.float64)
distance x is tensor(160.7050, device='cuda:1')
compute distance is  tensor(160.7050, device='cuda:1')
compute norm is  tensor(54.1100, device='cuda:1', dtype=torch.float64)
distance x is tensor(191.9029, device='cuda:1')
compute distance is  tensor(191.9029, device='cuda:1')
compute norm is  tensor(55.3094, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(191.9029, device='cuda:1')
distance x is tensor(101917.1953, device='cuda:1')
distance x is tensor(101917.1953, device='cuda:1')
________________________________
test distance is  tensor(101917.1953, device='cuda:1')
test distance1 is  tensor(101917.1953, device='cuda:1')
test similarity is  tensor(0.4754, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107572826792722.02
test entropy is  0.0
________________________________
cal ratio is  0.04252487790278211
distance x is tensor(4334.0210, device='cuda:1')
cal_distance is  tensor(4334.0210, device='cuda:1')
cal ratio is  0.2062154952432765
distance x is tensor(893.7459, device='cuda:1')
cal_distance is  tensor(893.7459, device='cuda:1')
cal ratio is  0.454108649387639
distance x is tensor(405.8603, device='cuda:1')
cal_distance is  tensor(405.8603, device='cuda:1')
cal ratio is  0.6738737382836295
distance x is tensor(273.5001, device='cuda:1')
cal_distance is  tensor(273.5001, device='cuda:1')
cal ratio is  0.8208958907776528
distance x is tensor(224.5159, device='cuda:1')
cal_distance is  tensor(224.5159, device='cuda:1')
cal ratio is  0.9060313963218442
distance x is tensor(203.4189, device='cuda:1')
cal_distance is  tensor(203.4189, device='cuda:1')
cal ratio is  0.951855867259955
distance x is tensor(193.6257, device='cuda:1')
cal_distance is  tensor(193.6257, device='cuda:1')
cal ratio is  0.9756304333625341
distance x is tensor(188.9072, device='cuda:1')
cal_distance is  tensor(188.9072, device='cuda:1')
distance x is tensor(188.9072, device='cuda:1')
return_distance is  tensor(188.9072, device='cuda:1')
distance x is tensor(188.8982, device='cuda:1')
distance x is tensor(188.8982, device='cuda:1')
________________________________
test distance is  tensor(188.8982, device='cuda:1')
test distance1 is  tensor(188.8982, device='cuda:1')
test similarity is  tensor(0.9610, device='cuda:1')
test acc is  0.10000000015633198
test loss is 1273.4489979693121
test entropy is  0.0
________________________________
0
distance x is tensor(188.8982, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  4.481764811273402e-48
avg test loss is  1273.4062794764668
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9610, device='cuda:1')
compute_distance is  tensor(188.8982, device='cuda:1')
compute_norm is  tensor(59.1642, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(22637.2148, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.5537247964059875
avg test loss is  2.875206974015307
avg accuracy is  0.09995000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0183, device='cuda:1')
compute_distance is  tensor(22637.2148, device='cuda:1')
compute_norm is  tensor(1496.7458, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(22532.0293, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8461681017870588
avg test loss is  3.632045672900641
avg accuracy is  0.10010000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0183, device='cuda:1')
compute_distance is  tensor(22532.0293, device='cuda:1')
compute_norm is  tensor(1490.0280, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(22426.7012, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.5569708121102501
avg test loss is  2.8643078593048714
avg accuracy is  0.10036666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0183, device='cuda:1')
compute_distance is  tensor(22426.7012, device='cuda:1')
compute_norm is  tensor(1482.7108, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(22322.4902, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8503351264289701
avg test loss is  3.6133820710660043
avg accuracy is  0.09976666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0183, device='cuda:1')
compute_distance is  tensor(22322.4902, device='cuda:1')
compute_norm is  tensor(1476.0944, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(22218.1777, device='cuda:1')
distance x is tensor(22218.1777, device='cuda:1')
________________________________
test distance is  tensor(22218.1777, device='cuda:1')
test distance1 is  tensor(22218.1777, device='cuda:1')
test similarity is  tensor(-0.0184, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.861131398916753
test entropy is  1.5577612578995954
________________________________
cal ratio is  0.09107781222537278
distance x is tensor(2023.5797, device='cuda:1')
cal_distance is  tensor(2023.5797, device='cuda:1')
cal ratio is  0.30179124921215683
distance x is tensor(610.6967, device='cuda:1')
cal_distance is  tensor(610.6967, device='cuda:1')
cal ratio is  0.5493561792133417
distance x is tensor(335.4887, device='cuda:1')
cal_distance is  tensor(335.4887, device='cuda:1')
cal ratio is  0.7411871074157904
distance x is tensor(248.6592, device='cuda:1')
cal_distance is  tensor(248.6592, device='cuda:1')
cal ratio is  0.8609234516223035
distance x is tensor(214.0761, device='cuda:1')
cal_distance is  tensor(214.0761, device='cuda:1')
cal ratio is  0.9278604906312905
distance x is tensor(198.6326, device='cuda:1')
cal_distance is  tensor(198.6326, device='cuda:1')
cal ratio is  0.9632556376644943
distance x is tensor(191.3338, device='cuda:1')
cal_distance is  tensor(191.3338, device='cuda:1')
distance x is tensor(191.3338, device='cuda:1')
return_distance is  tensor(191.3338, device='cuda:1')
distance x is tensor(191.3397, device='cuda:1')
distance x is tensor(191.3397, device='cuda:1')
________________________________
test distance is  tensor(191.3397, device='cuda:1')
test distance1 is  tensor(191.3397, device='cuda:1')
test similarity is  tensor(0.9319, device='cuda:1')
test acc is  0.15305000015633344
test loss is 4.774335505611607
test entropy is  1.05750798035278
________________________________
0
distance x is tensor(191.3397, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.055714561423259
avg test loss is  4.783409934308229
avg accuracy is  0.2826000001563392
solo acc is  0.15221666682299997
compute similarity  is  tensor(0.9319, device='cuda:1')
compute_distance is  tensor(191.3397, device='cuda:1')
compute_norm is  tensor(55.2925, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(194.9195, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.6301811761947583
avg test loss is  2.6070757369751107
avg accuracy is  0.16895000015633466
solo acc is  0.11190000015633193
compute similarity  is  tensor(0.9321, device='cuda:1')
compute_distance is  tensor(194.9195, device='cuda:1')
compute_norm is  tensor(55.0605, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(198.2563, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.9587399541442074
avg test loss is  1.5411395688555134
avg accuracy is  0.25666666682300515
solo acc is  0.266433333489672
compute similarity  is  tensor(0.9318, device='cuda:1')
compute_distance is  tensor(198.2563, device='cuda:1')
compute_norm is  tensor(54.7481, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(198.2563, device='cuda:1')
distance x is tensor(198.2563, device='cuda:1')
________________________________
test distance is  tensor(198.2563, device='cuda:1')
test distance1 is  tensor(198.2563, device='cuda:1')
test similarity is  tensor(0.9318, device='cuda:1')
test acc is  0.2654166668230053
test loss is 1.5390067382662027
test entropy is  0.9587172898275258
________________________________
cal ratio is  0.9641694140017335
distance x is tensor(191.1484, device='cuda:1')
cal_distance is  tensor(191.1484, device='cuda:1')
distance x is tensor(191.1484, device='cuda:1')
return_distance is  tensor(191.1484, device='cuda:1')
distance x is tensor(191.1527, device='cuda:1')
distance x is tensor(191.1527, device='cuda:1')
________________________________
test distance is  tensor(191.1527, device='cuda:1')
test distance1 is  tensor(191.1527, device='cuda:1')
test similarity is  tensor(0.9362, device='cuda:1')
test acc is  0.26726666682300537
test loss is 1.540012760203022
test entropy is  0.9637563370946628
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2680000001600001
mal loss is 1.547081045806408
mal norm is  tensor(898.7715, device='cuda:1')
distance x is tensor(191.1484, device='cuda:1')
mal distance is  tensor(191.1484, device='cuda:1')
user_PLR len size 52
counter_tensor is  tensor([51., 48., 10., 49., 12., 38., 38., 35., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 40., 15., 12., 24., 25., 14., 14., 16.,
         0., 27.,  0., 12.,  0., 15., 22., 51., 51., 12., 14., 30., 13., 51.,
         0., 23., 34.,  0., 12.,  0.,  0., 47., 37., 32.])
count_res tensor([2.3789e-01, 1.1844e-02, 3.7179e-19, 3.2195e-02, 2.7472e-18, 5.3770e-07,
        5.3770e-07, 2.6771e-08, 3.9731e-06, 3.9731e-06, 3.9731e-06, 3.9731e-06,
        3.9731e-06, 3.9731e-06, 3.9731e-06, 3.9731e-06, 3.9731e-06, 3.9731e-06,
        3.9731e-06, 3.9731e-06, 3.9731e-06, 5.5179e-17, 2.7472e-18, 4.4712e-13,
        1.2154e-12, 2.0299e-17, 2.0299e-17, 1.4999e-16, 1.6879e-23, 8.9806e-12,
        1.6879e-23, 2.7472e-18, 1.6879e-23, 5.5179e-17, 6.0511e-14, 2.3789e-01,
        2.3789e-01, 2.7472e-18, 2.0299e-17, 1.8038e-10, 7.4676e-18, 2.3789e-01,
        1.6879e-23, 1.6449e-13, 9.8484e-09, 1.6879e-23, 2.7472e-18, 1.6879e-23,
        1.6879e-23, 4.3571e-03, 1.9781e-07, 1.3328e-09])
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 89.68% 

Test Accuracy: 86.66% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7278467863798141
distance x is tensor(107.7318, device='cuda:1')
benign distance is  tensor(107.7318, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.410612266510725
distance x is tensor(96.4670, device='cuda:1')
benign distance is  tensor(96.4670, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.7794945705682039
distance x is tensor(94.0804, device='cuda:1')
benign distance is  tensor(94.0804, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1947466805577278
distance x is tensor(159.7616, device='cuda:1')
benign distance is  tensor(159.7616, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2444462236016989
distance x is tensor(114.1206, device='cuda:1')
benign distance is  tensor(114.1206, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.649327103048563
distance x is tensor(99.8848, device='cuda:1')
benign distance is  tensor(99.8848, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6947706378996372
distance x is tensor(105.1325, device='cuda:1')
benign distance is  tensor(105.1325, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9644745960831642
distance x is tensor(82.0748, device='cuda:1')
benign distance is  tensor(82.0748, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.2566230781376362
distance x is tensor(100.0352, device='cuda:1')
benign distance is  tensor(100.0352, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.623387704603374
distance x is tensor(125.1303, device='cuda:1')
benign distance is  tensor(125.1303, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.0917174629867077
distance x is tensor(87.4905, device='cuda:1')
benign distance is  tensor(87.4905, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.051437593996525
distance x is tensor(104.9133, device='cuda:1')
benign distance is  tensor(104.9133, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2968629375100136
distance x is tensor(152.7310, device='cuda:1')
benign distance is  tensor(152.7310, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.0033702300861478
distance x is tensor(68.6008, device='cuda:1')
benign distance is  tensor(68.6008, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.4480991996824741
distance x is tensor(153.1417, device='cuda:1')
benign distance is  tensor(153.1417, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.3142849281430244
distance x is tensor(116.4601, device='cuda:1')
benign distance is  tensor(116.4601, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.323298141360283
distance x is tensor(81.1222, device='cuda:1')
benign distance is  tensor(81.1222, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.0766174271702766
distance x is tensor(115.0300, device='cuda:1')
benign distance is  tensor(115.0300, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.517623171210289
distance x is tensor(114.7071, device='cuda:1')
benign distance is  tensor(114.7071, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.4120514057576656
distance x is tensor(115.4619, device='cuda:1')
benign distance is  tensor(115.4619, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.0954436883330345
distance x is tensor(97.6399, device='cuda:1')
benign distance is  tensor(97.6399, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8789126630872488
distance x is tensor(200.5871, device='cuda:1')
benign distance is  tensor(200.5871, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0846862494945526
distance x is tensor(159.7542, device='cuda:1')
benign distance is  tensor(159.7542, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.5983672700822353
distance x is tensor(122.4095, device='cuda:1')
benign distance is  tensor(122.4095, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.4511581175029278
distance x is tensor(128.2981, device='cuda:1')
benign distance is  tensor(128.2981, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.1177046820521355
distance x is tensor(102.9884, device='cuda:1')
benign distance is  tensor(102.9884, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.3086865860968828
distance x is tensor(125.7008, device='cuda:1')
benign distance is  tensor(125.7008, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.780095487833023
distance x is tensor(104.4593, device='cuda:1')
benign distance is  tensor(104.4593, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.0126749835908413
distance x is tensor(121.2445, device='cuda:1')
benign distance is  tensor(121.2445, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9518744330853224
distance x is tensor(142.8382, device='cuda:1')
benign distance is  tensor(142.8382, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6163232177495956
distance x is tensor(112.6090, device='cuda:1')
benign distance is  tensor(112.6090, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.3525436334311962
distance x is tensor(149.9913, device='cuda:1')
benign distance is  tensor(149.9913, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.5675169974565506
distance x is tensor(100.5018, device='cuda:1')
benign distance is  tensor(100.5018, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.9939103797078133
distance x is tensor(127.6563, device='cuda:1')
benign distance is  tensor(127.6563, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.8731005787849426
distance x is tensor(142.4872, device='cuda:1')
benign distance is  tensor(142.4872, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.1334907785058022
distance x is tensor(91.8374, device='cuda:1')
benign distance is  tensor(91.8374, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.7611964587122202
distance x is tensor(159.2424, device='cuda:1')
benign distance is  tensor(159.2424, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.9841971416026354
distance x is tensor(137.0120, device='cuda:1')
benign distance is  tensor(137.0120, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.4947974979877472
distance x is tensor(99.0866, device='cuda:1')
benign distance is  tensor(99.0866, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.758292842656374
distance x is tensor(132.3027, device='cuda:1')
benign distance is  tensor(132.3027, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(79.7130, device='cuda:1')
compute distance is  tensor(79.7130, device='cuda:1')
compute norm is  tensor(51.1198, device='cuda:1', dtype=torch.float64)
distance x is tensor(134.0213, device='cuda:1')
compute distance is  tensor(134.0213, device='cuda:1')
compute norm is  tensor(51.8947, device='cuda:1', dtype=torch.float64)
distance x is tensor(91.5886, device='cuda:1')
compute distance is  tensor(91.5886, device='cuda:1')
compute norm is  tensor(51.2250, device='cuda:1', dtype=torch.float64)
distance x is tensor(100.2106, device='cuda:1')
compute distance is  tensor(100.2106, device='cuda:1')
compute norm is  tensor(51.3184, device='cuda:1', dtype=torch.float64)
distance x is tensor(85.8423, device='cuda:1')
compute distance is  tensor(85.8423, device='cuda:1')
compute norm is  tensor(51.0313, device='cuda:1', dtype=torch.float64)
distance x is tensor(101.5084, device='cuda:1')
compute distance is  tensor(101.5084, device='cuda:1')
compute norm is  tensor(51.4974, device='cuda:1', dtype=torch.float64)
distance x is tensor(120.9996, device='cuda:1')
compute distance is  tensor(120.9996, device='cuda:1')
compute norm is  tensor(51.6880, device='cuda:1', dtype=torch.float64)
distance x is tensor(84.5287, device='cuda:1')
compute distance is  tensor(84.5287, device='cuda:1')
compute norm is  tensor(51.1442, device='cuda:1', dtype=torch.float64)
distance x is tensor(120.9698, device='cuda:1')
compute distance is  tensor(120.9698, device='cuda:1')
compute norm is  tensor(51.5764, device='cuda:1', dtype=torch.float64)
distance x is tensor(101.5514, device='cuda:1')
compute distance is  tensor(101.5514, device='cuda:1')
compute norm is  tensor(51.4944, device='cuda:1', dtype=torch.float64)
distance x is tensor(113.9345, device='cuda:1')
compute distance is  tensor(113.9345, device='cuda:1')
compute norm is  tensor(51.4979, device='cuda:1', dtype=torch.float64)
distance x is tensor(146.6322, device='cuda:1')
compute distance is  tensor(146.6322, device='cuda:1')
compute norm is  tensor(52.6805, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(146.6322, device='cuda:1')
distance x is tensor(102019.0859, device='cuda:1')
distance x is tensor(102019.0859, device='cuda:1')
________________________________
test distance is  tensor(102019.0859, device='cuda:1')
test distance1 is  tensor(102019.0859, device='cuda:1')
test similarity is  tensor(0.2674, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107511662625781.08
test entropy is  0.0
________________________________
cal ratio is  0.03715353191441813
distance x is tensor(3790.3738, device='cuda:1')
cal_distance is  tensor(3790.3738, device='cuda:1')
cal ratio is  0.1927524069819469
distance x is tensor(730.6074, device='cuda:1')
cal_distance is  tensor(730.6074, device='cuda:1')
cal ratio is  0.43903464700043227
distance x is tensor(320.7645, device='cuda:1')
cal_distance is  tensor(320.7645, device='cuda:1')
cal ratio is  0.6625942420416108
distance x is tensor(212.5383, device='cuda:1')
cal_distance is  tensor(212.5383, device='cuda:1')
cal ratio is  0.8139959028390454
distance x is tensor(173.0061, device='cuda:1')
cal_distance is  tensor(173.0061, device='cuda:1')
cal ratio is  0.9022150070362778
distance x is tensor(156.0892, device='cuda:1')
cal_distance is  tensor(156.0892, device='cuda:1')
cal ratio is  0.9498486641632637
distance x is tensor(148.2613, device='cuda:1')
cal_distance is  tensor(148.2613, device='cuda:1')
cal ratio is  0.9746010681899174
distance x is tensor(144.4958, device='cuda:1')
cal_distance is  tensor(144.4958, device='cuda:1')
distance x is tensor(144.4958, device='cuda:1')
return_distance is  tensor(144.4958, device='cuda:1')
distance x is tensor(144.4867, device='cuda:1')
distance x is tensor(144.4867, device='cuda:1')
________________________________
test distance is  tensor(144.4867, device='cuda:1')
test distance1 is  tensor(144.4867, device='cuda:1')
test similarity is  tensor(0.9624, device='cuda:1')
test acc is  0.13111666682299858
test loss is 107.51531444785438
test entropy is  0.011676317757936941
________________________________
0
distance x is tensor(144.4867, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.012311709735425697
avg test loss is  107.27356606912511
avg accuracy is  0.5234333334896756
solo acc is  0.13251666682299856
compute similarity  is  tensor(0.9624, device='cuda:1')
compute_distance is  tensor(144.4867, device='cuda:1')
compute_norm is  tensor(53.9196, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(141.3377, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9875463445557714
avg test loss is  1.5130518124555983
avg accuracy is  0.7773500001563265
solo acc is  0.29413333348967274
compute similarity  is  tensor(0.9629, device='cuda:1')
compute_distance is  tensor(141.3377, device='cuda:1')
compute_norm is  tensor(53.7125, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(141.3377, device='cuda:1')
distance x is tensor(141.3377, device='cuda:1')
________________________________
test distance is  tensor(141.3377, device='cuda:1')
test distance1 is  tensor(141.3377, device='cuda:1')
test similarity is  tensor(0.9629, device='cuda:1')
test acc is  0.29300000015633937
test loss is 1.5140773735320898
test entropy is  0.9876511457251079
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.29900000016000006
mal loss is 1.4982277303934097
mal norm is  tensor(705.8198, device='cuda:1')
distance x is tensor(141.3465, device='cuda:1')
mal distance is  tensor(141.3465, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 26.23% 

Test Accuracy: 25.12% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8248786274343729
distance x is tensor(145.5730, device='cuda:1')
benign distance is  tensor(145.5730, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.5898061618208885
distance x is tensor(152.1415, device='cuda:1')
benign distance is  tensor(152.1415, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5107536017894745
distance x is tensor(145.4433, device='cuda:1')
benign distance is  tensor(145.4433, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4966043382883072
distance x is tensor(172.2606, device='cuda:1')
benign distance is  tensor(172.2606, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.5669382214546204
distance x is tensor(144.8214, device='cuda:1')
benign distance is  tensor(144.8214, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9910055920481682
distance x is tensor(127.3276, device='cuda:1')
benign distance is  tensor(127.3276, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.2521174550056458
distance x is tensor(157.8942, device='cuda:1')
benign distance is  tensor(157.8942, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.8266975954174995
distance x is tensor(117.4233, device='cuda:1')
benign distance is  tensor(117.4233, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(123.1486, device='cuda:1')
compute distance is  tensor(123.1486, device='cuda:1')
compute norm is  tensor(55.2047, device='cuda:1', dtype=torch.float64)
distance x is tensor(169.3355, device='cuda:1')
compute distance is  tensor(169.3355, device='cuda:1')
compute norm is  tensor(55.8940, device='cuda:1', dtype=torch.float64)
distance x is tensor(117.9636, device='cuda:1')
compute distance is  tensor(117.9636, device='cuda:1')
compute norm is  tensor(54.8552, device='cuda:1', dtype=torch.float64)
distance x is tensor(168.1490, device='cuda:1')
compute distance is  tensor(168.1490, device='cuda:1')
compute norm is  tensor(56.0455, device='cuda:1', dtype=torch.float64)
distance x is tensor(119.1615, device='cuda:1')
compute distance is  tensor(119.1615, device='cuda:1')
compute norm is  tensor(55.0323, device='cuda:1', dtype=torch.float64)
distance x is tensor(140.8264, device='cuda:1')
compute distance is  tensor(140.8264, device='cuda:1')
compute norm is  tensor(55.4770, device='cuda:1', dtype=torch.float64)
distance x is tensor(152.9158, device='cuda:1')
compute distance is  tensor(152.9158, device='cuda:1')
compute norm is  tensor(55.7335, device='cuda:1', dtype=torch.float64)
distance x is tensor(118.0980, device='cuda:1')
compute distance is  tensor(118.0980, device='cuda:1')
compute norm is  tensor(54.9590, device='cuda:1', dtype=torch.float64)
distance x is tensor(155.4074, device='cuda:1')
compute distance is  tensor(155.4074, device='cuda:1')
compute norm is  tensor(55.7448, device='cuda:1', dtype=torch.float64)
distance x is tensor(125.8997, device='cuda:1')
compute distance is  tensor(125.8997, device='cuda:1')
compute norm is  tensor(55.3483, device='cuda:1', dtype=torch.float64)
distance x is tensor(139.7948, device='cuda:1')
compute distance is  tensor(139.7948, device='cuda:1')
compute norm is  tensor(55.3413, device='cuda:1', dtype=torch.float64)
distance x is tensor(169.9602, device='cuda:1')
compute distance is  tensor(169.9602, device='cuda:1')
compute norm is  tensor(56.5110, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(169.9602, device='cuda:1')
distance x is tensor(101903.1172, device='cuda:1')
distance x is tensor(101903.1172, device='cuda:1')
________________________________
test distance is  tensor(101903.1172, device='cuda:1')
test distance1 is  tensor(101903.1172, device='cuda:1')
test similarity is  tensor(0.5006, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107600645822538.23
test entropy is  0.0
________________________________
cal ratio is  0.04002266362871949
distance x is tensor(4078.4390, device='cuda:1')
cal_distance is  tensor(4078.4390, device='cuda:1')
cal ratio is  0.20005652728917958
distance x is tensor(815.9221, device='cuda:1')
cal_distance is  tensor(815.9221, device='cuda:1')
cal ratio is  0.44727576282456
distance x is tensor(364.9446, device='cuda:1')
cal_distance is  tensor(364.9446, device='cuda:1')
cal ratio is  0.6687845417710123
distance x is tensor(244.0708, device='cuda:1')
cal_distance is  tensor(244.0708, device='cuda:1')
cal ratio is  0.8177899580353427
distance x is tensor(199.5995, device='cuda:1')
cal_distance is  tensor(199.5995, device='cuda:1')
cal ratio is  0.904315471443126
distance x is tensor(180.5014, device='cuda:1')
cal_distance is  tensor(180.5014, device='cuda:1')
cal ratio is  0.9509538559599233
distance x is tensor(171.6487, device='cuda:1')
cal_distance is  tensor(171.6487, device='cuda:1')
cal ratio is  0.9751680006881853
distance x is tensor(167.3865, device='cuda:1')
cal_distance is  tensor(167.3865, device='cuda:1')
distance x is tensor(167.3865, device='cuda:1')
return_distance is  tensor(167.3865, device='cuda:1')
distance x is tensor(167.3774, device='cuda:1')
distance x is tensor(167.3774, device='cuda:1')
________________________________
test distance is  tensor(167.3774, device='cuda:1')
test distance1 is  tensor(167.3774, device='cuda:1')
test similarity is  tensor(0.9711, device='cuda:1')
test acc is  0.10001666682299865
test loss is 332.7802790985433
test entropy is  3.113045077436281e-06
________________________________
0
distance x is tensor(167.3774, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.6451243584804934e-06
avg test loss is  332.88833670219634
avg accuracy is  0.11403333348966527
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9711, device='cuda:1')
compute_distance is  tensor(167.3774, device='cuda:1')
compute_norm is  tensor(60.1109, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(182.5761, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.2858435515401714
avg test loss is  2.0369770812835775
avg accuracy is  0.5383500001563423
solo acc is  0.19086666682300257
compute similarity  is  tensor(0.9687, device='cuda:1')
compute_distance is  tensor(182.5761, device='cuda:1')
compute_norm is  tensor(61.1252, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(182.7797, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.7207644848681208
avg test loss is  2.8738470555368516
avg accuracy is  0.5237500001563422
solo acc is  0.10756666682299862
compute similarity  is  tensor(0.9687, device='cuda:1')
compute_distance is  tensor(182.7797, device='cuda:1')
compute_norm is  tensor(61.0225, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(183.4952, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.1421633501296866
avg test loss is  1.850927543411377
avg accuracy is  0.5627000001563409
solo acc is  0.19841666682300296
compute similarity  is  tensor(0.9689, device='cuda:1')
compute_distance is  tensor(183.4952, device='cuda:1')
compute_norm is  tensor(60.6186, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(183.4482, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.6850945026254349
avg test loss is  2.6628097745655444
avg accuracy is  0.5236500001563422
solo acc is  0.10723333348966528
compute similarity  is  tensor(0.9688, device='cuda:1')
compute_distance is  tensor(183.4482, device='cuda:1')
compute_norm is  tensor(60.4682, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(184.1281, device='cuda:1')
distance x is tensor(184.1281, device='cuda:1')
________________________________
test distance is  tensor(184.1281, device='cuda:1')
test distance1 is  tensor(184.1281, device='cuda:1')
test similarity is  tensor(0.9687, device='cuda:1')
test acc is  0.199066666823003
test loss is 1.75764799855157
test entropy is  1.1009908096749645
________________________________
cal ratio is  0.9415419646770206
distance x is tensor(173.3714, device='cuda:1')
cal_distance is  tensor(173.3714, device='cuda:1')
cal ratio is  0.9703109656550611
distance x is tensor(168.2243, device='cuda:1')
cal_distance is  tensor(168.2243, device='cuda:1')
distance x is tensor(168.2243, device='cuda:1')
return_distance is  tensor(168.2243, device='cuda:1')
distance x is tensor(168.2170, device='cuda:1')
distance x is tensor(168.2170, device='cuda:1')
________________________________
test distance is  tensor(168.2170, device='cuda:1')
test distance1 is  tensor(168.2170, device='cuda:1')
test similarity is  tensor(0.9731, device='cuda:1')
test acc is  0.19003333348966917
test loss is 1.7758377504501262
test entropy is  1.1150524606074352
________________________________
0
distance x is tensor(168.2170, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.1148484925598479
avg test loss is  1.7781163869636145
avg accuracy is  0.5674833334896737
solo acc is  0.19135000015633585
compute similarity  is  tensor(0.9731, device='cuda:1')
compute_distance is  tensor(168.2170, device='cuda:1')
compute_norm is  tensor(59.4075, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(168.2857, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.6657704289661033
avg test loss is  2.5881465754783486
avg accuracy is  0.5057833334896755
solo acc is  0.1046833334896653
compute similarity  is  tensor(0.9730, device='cuda:1')
compute_distance is  tensor(168.2857, device='cuda:1')
compute_norm is  tensor(59.2515, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(169.5337, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.0615810080250698
avg test loss is  1.6675011303379084
avg accuracy is  0.57065000015634
solo acc is  0.21225000015633685
compute similarity  is  tensor(0.9728, device='cuda:1')
compute_distance is  tensor(169.5337, device='cuda:1')
compute_norm is  tensor(58.9009, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(169.5280, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.6431811100511409
avg test loss is  2.487447620963237
avg accuracy is  0.5003000001563421
solo acc is  0.10410000015633197
compute similarity  is  tensor(0.9726, device='cuda:1')
compute_distance is  tensor(169.5280, device='cuda:1')
compute_norm is  tensor(58.7269, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(170.6917, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  1.0320536704587022
avg test loss is  1.607258256945783
avg accuracy is  0.5717333334896734
solo acc is  0.2175166668230038
compute similarity  is  tensor(0.9724, device='cuda:1')
compute_distance is  tensor(170.6917, device='cuda:1')
compute_norm is  tensor(58.3893, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(170.6133, device='cuda:1')
distance x is tensor(170.6133, device='cuda:1')
________________________________
test distance is  tensor(170.6133, device='cuda:1')
test distance1 is  tensor(170.6133, device='cuda:1')
test similarity is  tensor(0.9722, device='cuda:1')
test acc is  0.10398333348966529
test loss is 2.4267703351943988
test entropy is  0.6325160470217276
________________________________
cal ratio is  0.9781226624165351
distance x is tensor(166.8878, device='cuda:1')
cal_distance is  tensor(166.8878, device='cuda:1')
distance x is tensor(166.8878, device='cuda:1')
return_distance is  tensor(166.8878, device='cuda:1')
distance x is tensor(166.8806, device='cuda:1')
distance x is tensor(166.8806, device='cuda:1')
________________________________
test distance is  tensor(166.8806, device='cuda:1')
test distance1 is  tensor(166.8806, device='cuda:1')
test similarity is  tensor(0.9733, device='cuda:1')
test acc is  0.10390000015633197
test loss is 2.3958064547733966
test entropy is  0.6526738382351678
________________________________
0
distance x is tensor(166.8806, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.6516808519231231
avg test loss is  2.3998541509164677
avg accuracy is  0.49408333348967537
solo acc is  0.1039333334896653
compute similarity  is  tensor(0.9733, device='cuda:1')
compute_distance is  tensor(166.8806, device='cuda:1')
compute_norm is  tensor(58.0807, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(167.9953, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.0098365912559444
avg test loss is  1.5604174013839347
avg accuracy is  0.5870000001563386
solo acc is  0.22295000015633734
compute similarity  is  tensor(0.9730, device='cuda:1')
compute_distance is  tensor(167.9953, device='cuda:1')
compute_norm is  tensor(57.7594, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(167.9591, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.6231457397881855
avg test loss is  2.375346088714437
avg accuracy is  0.49000000015634204
solo acc is  0.10358333348966531
compute similarity  is  tensor(0.9728, device='cuda:1')
compute_distance is  tensor(167.9591, device='cuda:1')
compute_norm is  tensor(57.5793, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(168.8932, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.9954614093435853
avg test loss is  1.5368348525277078
avg accuracy is  0.5854333334896722
solo acc is  0.21461666682300362
compute similarity  is  tensor(0.9726, device='cuda:1')
compute_distance is  tensor(168.8932, device='cuda:1')
compute_norm is  tensor(57.2668, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(168.9002, device='cuda:1')
________________________________
test distance is  tensor(168.9002, device='cuda:1')
test similarity is  tensor(0.9726, device='cuda:1')
test acc is  0.585933333489672
test loss is 1.5344951361227137
test entropy is  0.9932732113770076
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2280000001600001
mal loss is 1.524004027247429
mal norm is  tensor(692.5369, device='cuda:1')
distance x is tensor(168.9002, device='cuda:1')
mal distance is  tensor(168.9002, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([12., 12., 25., 14., 12., 14., 26., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 13., 16., 12., 12., 12., 12., 12.])
count_res tensor([6.0762e-07, 6.0762e-07, 2.6882e-01, 4.4898e-06, 6.0762e-07, 4.4898e-06,
        7.3073e-01, 6.0762e-07, 3.3175e-05, 3.3175e-05, 3.3175e-05, 3.3175e-05,
        3.3175e-05, 3.3175e-05, 3.3175e-05, 3.3175e-05, 3.3175e-05, 3.3175e-05,
        3.3175e-05, 3.3175e-05, 6.0762e-07, 1.6517e-06, 3.3175e-05, 6.0762e-07,
        6.0762e-07, 6.0762e-07, 6.0762e-07, 6.0762e-07])
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 62.90% 

Test Accuracy: 76.11% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8200816605240107
distance x is tensor(145.4304, device='cuda:1')
benign distance is  tensor(145.4304, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.4126720242202282
distance x is tensor(106.2352, device='cuda:1')
benign distance is  tensor(106.2352, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.7820133566856384
distance x is tensor(98.8027, device='cuda:1')
benign distance is  tensor(98.8027, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.5069818012416363
distance x is tensor(146.8341, device='cuda:1')
benign distance is  tensor(146.8341, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2885516248643398
distance x is tensor(134.8766, device='cuda:1')
benign distance is  tensor(134.8766, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1656690202653408
distance x is tensor(123.3924, device='cuda:1')
benign distance is  tensor(123.3924, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.7969950214028358
distance x is tensor(101.0819, device='cuda:1')
benign distance is  tensor(101.0819, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.6095608249306679
distance x is tensor(104.2824, device='cuda:1')
benign distance is  tensor(104.2824, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.905032031238079
distance x is tensor(116.2094, device='cuda:1')
benign distance is  tensor(116.2094, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.3295523151755333
distance x is tensor(155.4217, device='cuda:1')
benign distance is  tensor(155.4217, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3613265603780746
distance x is tensor(96.7676, device='cuda:1')
benign distance is  tensor(96.7676, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.2943920716643333
distance x is tensor(108.6306, device='cuda:1')
benign distance is  tensor(108.6306, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.667954482138157
distance x is tensor(150.2935, device='cuda:1')
benign distance is  tensor(150.2935, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.9923378545790911
distance x is tensor(77.2011, device='cuda:1')
benign distance is  tensor(77.2011, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.108990155160427
distance x is tensor(146.5361, device='cuda:1')
benign distance is  tensor(146.5361, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.796614423394203
distance x is tensor(122.4102, device='cuda:1')
benign distance is  tensor(122.4102, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(98.8172, device='cuda:1')
compute distance is  tensor(98.8172, device='cuda:1')
compute norm is  tensor(56.2374, device='cuda:1', dtype=torch.float64)
distance x is tensor(135.5101, device='cuda:1')
compute distance is  tensor(135.5101, device='cuda:1')
compute norm is  tensor(56.9435, device='cuda:1', dtype=torch.float64)
distance x is tensor(126.5623, device='cuda:1')
compute distance is  tensor(126.5623, device='cuda:1')
compute norm is  tensor(56.4344, device='cuda:1', dtype=torch.float64)
distance x is tensor(103.8012, device='cuda:1')
compute distance is  tensor(103.8012, device='cuda:1')
compute norm is  tensor(56.3206, device='cuda:1', dtype=torch.float64)
distance x is tensor(94.7763, device='cuda:1')
compute distance is  tensor(94.7763, device='cuda:1')
compute norm is  tensor(56.1395, device='cuda:1', dtype=torch.float64)
distance x is tensor(119.0677, device='cuda:1')
compute distance is  tensor(119.0677, device='cuda:1')
compute norm is  tensor(56.6004, device='cuda:1', dtype=torch.float64)
distance x is tensor(128.6877, device='cuda:1')
compute distance is  tensor(128.6877, device='cuda:1')
compute norm is  tensor(56.7457, device='cuda:1', dtype=torch.float64)
distance x is tensor(97.9678, device='cuda:1')
compute distance is  tensor(97.9678, device='cuda:1')
compute norm is  tensor(56.2541, device='cuda:1', dtype=torch.float64)
distance x is tensor(127.4732, device='cuda:1')
compute distance is  tensor(127.4732, device='cuda:1')
compute norm is  tensor(56.7118, device='cuda:1', dtype=torch.float64)
distance x is tensor(104.9166, device='cuda:1')
compute distance is  tensor(104.9166, device='cuda:1')
compute norm is  tensor(56.5222, device='cuda:1', dtype=torch.float64)
distance x is tensor(118.3364, device='cuda:1')
compute distance is  tensor(118.3364, device='cuda:1')
compute norm is  tensor(56.4478, device='cuda:1', dtype=torch.float64)
distance x is tensor(144.9953, device='cuda:1')
compute distance is  tensor(144.9953, device='cuda:1')
compute norm is  tensor(57.5717, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(144.9953, device='cuda:1')
distance x is tensor(101944.8281, device='cuda:1')
distance x is tensor(101944.8281, device='cuda:1')
________________________________
test distance is  tensor(101944.8281, device='cuda:1')
test distance1 is  tensor(101944.8281, device='cuda:1')
test similarity is  tensor(0.4558, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107536024180810.23
test entropy is  0.0
________________________________
cal ratio is  0.03695901915584831
distance x is tensor(3767.7854, device='cuda:1')
cal_distance is  tensor(3767.7854, device='cuda:1')
cal ratio is  0.1922471697140741
distance x is tensor(724.3497, device='cuda:1')
cal_distance is  tensor(724.3497, device='cuda:1')
cal ratio is  0.43845892167999706
distance x is tensor(317.6001, device='cuda:1')
cal_distance is  tensor(317.6001, device='cuda:1')
cal ratio is  0.6621596446711134
distance x is tensor(210.3035, device='cuda:1')
cal_distance is  tensor(210.3035, device='cuda:1')
cal ratio is  0.8137289051685199
distance x is tensor(171.1309, device='cuda:1')
cal_distance is  tensor(171.1309, device='cuda:1')
cal ratio is  0.902066969251031
distance x is tensor(154.3720, device='cuda:1')
cal_distance is  tensor(154.3720, device='cuda:1')
cal ratio is  0.9497706757750297
distance x is tensor(146.6183, device='cuda:1')
cal_distance is  tensor(146.6183, device='cuda:1')
cal ratio is  0.9745609799526546
distance x is tensor(142.8885, device='cuda:1')
cal_distance is  tensor(142.8885, device='cuda:1')
distance x is tensor(142.8885, device='cuda:1')
return_distance is  tensor(142.8885, device='cuda:1')
distance x is tensor(142.8795, device='cuda:1')
distance x is tensor(142.8795, device='cuda:1')
________________________________
test distance is  tensor(142.8795, device='cuda:1')
test distance1 is  tensor(142.8795, device='cuda:1')
test similarity is  tensor(0.9769, device='cuda:1')
test acc is  0.12095000015633192
test loss is 77.69858576239808
test entropy is  0.014458380031865895
________________________________
0
distance x is tensor(142.8795, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.01448866590410591
avg test loss is  77.68031989384308
avg accuracy is  0.48808333348967536
solo acc is  0.12028333348966526
compute similarity  is  tensor(0.9769, device='cuda:1')
compute_distance is  tensor(142.8795, device='cuda:1')
compute_norm is  tensor(60.1092, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(140.9258, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9965053398344816
avg test loss is  1.5379252141472628
avg accuracy is  0.7202333334896629
solo acc is  0.2875833334896726
compute similarity  is  tensor(0.9770, device='cuda:1')
compute_distance is  tensor(140.9258, device='cuda:1')
compute_norm is  tensor(59.7802, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(140.9258, device='cuda:1')
distance x is tensor(140.9258, device='cuda:1')
________________________________
test distance is  tensor(140.9258, device='cuda:1')
test distance1 is  tensor(140.9258, device='cuda:1')
test similarity is  tensor(0.9770, device='cuda:1')
test acc is  0.28661666682300596
test loss is 1.5428256470003108
test entropy is  0.9944890894488231
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.29100000016000005
mal loss is 1.5281049236655235
mal norm is  tensor(699.7104, device='cuda:1')
distance x is tensor(140.9345, device='cuda:1')
mal distance is  tensor(140.9345, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([ 4., 19., 20., 20., 16., 13., 16.,  6., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 21., 12., 19., 24., 14., 29., 12., 23.,
        28., 12., 13., 12., 12., 13., 23., 15.])
count_res tensor([9.5051e-12, 3.1072e-05, 8.4463e-05, 8.4463e-05, 1.5470e-06, 7.7020e-08,
        1.5470e-06, 7.0233e-11, 4.6115e-03, 4.6115e-03, 4.6115e-03, 4.6115e-03,
        4.6115e-03, 4.6115e-03, 4.6115e-03, 4.6115e-03, 4.6115e-03, 4.6115e-03,
        4.6115e-03, 4.6115e-03, 2.2959e-04, 2.8334e-08, 3.1072e-05, 4.6115e-03,
        2.0936e-07, 6.8441e-01, 2.8334e-08, 1.6965e-03, 2.5178e-01, 2.8334e-08,
        7.7020e-08, 2.8334e-08, 2.8334e-08, 7.7020e-08, 1.6965e-03, 5.6911e-07])
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 84.60% 

Test Accuracy: 84.28% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7902112789452076
distance x is tensor(141.5799, device='cuda:1')
benign distance is  tensor(141.5799, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0897130966186523
distance x is tensor(102.8975, device='cuda:1')
benign distance is  tensor(102.8975, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9427951704710722
distance x is tensor(93.1752, device='cuda:1')
benign distance is  tensor(93.1752, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4420590735971928
distance x is tensor(157.1534, device='cuda:1')
benign distance is  tensor(157.1534, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.5514854155480862
distance x is tensor(130.6663, device='cuda:1')
benign distance is  tensor(130.6663, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9235800821334124
distance x is tensor(105.8829, device='cuda:1')
benign distance is  tensor(105.8829, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.3622297644615173
distance x is tensor(105.9279, device='cuda:1')
benign distance is  tensor(105.9279, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1624867357313633
distance x is tensor(89.1517, device='cuda:1')
benign distance is  tensor(89.1517, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.183497428894043
distance x is tensor(106.4128, device='cuda:1')
benign distance is  tensor(106.4128, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.9770454429090023
distance x is tensor(125.3785, device='cuda:1')
benign distance is  tensor(125.3785, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.4889369793236256
distance x is tensor(126.5385, device='cuda:1')
benign distance is  tensor(126.5385, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.394993793219328
distance x is tensor(125.0465, device='cuda:1')
benign distance is  tensor(125.0465, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.1017223075032234
distance x is tensor(99.7161, device='cuda:1')
benign distance is  tensor(99.7161, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.2115837708115578
distance x is tensor(215.4447, device='cuda:1')
benign distance is  tensor(215.4447, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.4028759188950062
distance x is tensor(159.6297, device='cuda:1')
benign distance is  tensor(159.6297, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.0242075733840466
distance x is tensor(133.0361, device='cuda:1')
benign distance is  tensor(133.0361, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.899062592536211
distance x is tensor(125.4354, device='cuda:1')
benign distance is  tensor(125.4354, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.0106234326958656
distance x is tensor(112.5776, device='cuda:1')
benign distance is  tensor(112.5776, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.8615494128316641
distance x is tensor(147.5994, device='cuda:1')
benign distance is  tensor(147.5994, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.3148200437426567
distance x is tensor(131.2394, device='cuda:1')
benign distance is  tensor(131.2394, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7774770669639111
distance x is tensor(143.0788, device='cuda:1')
benign distance is  tensor(143.0788, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.1687115486711264
distance x is tensor(60.4982, device='cuda:1')
benign distance is  tensor(60.4982, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.590954028069973
distance x is tensor(107.3193, device='cuda:1')
benign distance is  tensor(107.3193, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9117059223353863
distance x is tensor(130.9003, device='cuda:1')
benign distance is  tensor(130.9003, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(91.1979, device='cuda:1')
compute distance is  tensor(91.1979, device='cuda:1')
compute norm is  tensor(50.6864, device='cuda:1', dtype=torch.float64)
distance x is tensor(142.7167, device='cuda:1')
compute distance is  tensor(142.7167, device='cuda:1')
compute norm is  tensor(51.6617, device='cuda:1', dtype=torch.float64)
distance x is tensor(102.7700, device='cuda:1')
compute distance is  tensor(102.7700, device='cuda:1')
compute norm is  tensor(50.8303, device='cuda:1', dtype=torch.float64)
distance x is tensor(118.6740, device='cuda:1')
compute distance is  tensor(118.6740, device='cuda:1')
compute norm is  tensor(51.1651, device='cuda:1', dtype=torch.float64)
distance x is tensor(95.6006, device='cuda:1')
compute distance is  tensor(95.6006, device='cuda:1')
compute norm is  tensor(50.6570, device='cuda:1', dtype=torch.float64)
distance x is tensor(120.2690, device='cuda:1')
compute distance is  tensor(120.2690, device='cuda:1')
compute norm is  tensor(51.1860, device='cuda:1', dtype=torch.float64)
distance x is tensor(127.4446, device='cuda:1')
compute distance is  tensor(127.4446, device='cuda:1')
compute norm is  tensor(51.3125, device='cuda:1', dtype=torch.float64)
distance x is tensor(103.5241, device='cuda:1')
compute distance is  tensor(103.5241, device='cuda:1')
compute norm is  tensor(50.7765, device='cuda:1', dtype=torch.float64)
distance x is tensor(129.0490, device='cuda:1')
compute distance is  tensor(129.0490, device='cuda:1')
compute norm is  tensor(51.5231, device='cuda:1', dtype=torch.float64)
distance x is tensor(113.9069, device='cuda:1')
compute distance is  tensor(113.9069, device='cuda:1')
compute norm is  tensor(51.2422, device='cuda:1', dtype=torch.float64)
distance x is tensor(125.0581, device='cuda:1')
compute distance is  tensor(125.0581, device='cuda:1')
compute norm is  tensor(51.2025, device='cuda:1', dtype=torch.float64)
distance x is tensor(145.5096, device='cuda:1')
compute distance is  tensor(145.5096, device='cuda:1')
compute norm is  tensor(52.0932, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(145.5096, device='cuda:1')
distance x is tensor(102017.7109, device='cuda:1')
distance x is tensor(102017.7109, device='cuda:1')
________________________________
test distance is  tensor(102017.7109, device='cuda:1')
test distance1 is  tensor(102017.7109, device='cuda:1')
test similarity is  tensor(0.2569, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107502172570298.67
test entropy is  0.0
________________________________
cal ratio is  0.03701127888020546
distance x is tensor(3775.8110, device='cuda:1')
cal_distance is  tensor(3775.8110, device='cuda:1')
cal ratio is  0.1923830230982833
distance x is tensor(726.4055, device='cuda:1')
cal_distance is  tensor(726.4055, device='cuda:1')
cal ratio is  0.43861381765484747
distance x is tensor(318.6141, device='cuda:1')
cal_distance is  tensor(318.6141, device='cuda:1')
cal ratio is  0.6622765375903055
distance x is tensor(211.0122, device='cuda:1')
cal_distance is  tensor(211.0122, device='cuda:1')
cal ratio is  0.8138007274321386
distance x is tensor(171.7227, device='cuda:1')
cal_distance is  tensor(171.7227, device='cuda:1')
cal ratio is  0.9021067889176412
distance x is tensor(154.9127, device='cuda:1')
cal_distance is  tensor(154.9127, device='cuda:1')
cal ratio is  0.9497916802330096
distance x is tensor(147.1350, device='cuda:1')
cal_distance is  tensor(147.1350, device='cuda:1')
cal ratio is  0.9745717584173509
distance x is tensor(143.3938, device='cuda:1')
cal_distance is  tensor(143.3938, device='cuda:1')
distance x is tensor(143.3938, device='cuda:1')
return_distance is  tensor(143.3938, device='cuda:1')
distance x is tensor(143.3847, device='cuda:1')
distance x is tensor(143.3847, device='cuda:1')
________________________________
test distance is  tensor(143.3847, device='cuda:1')
test distance1 is  tensor(143.3847, device='cuda:1')
test similarity is  tensor(0.9620, device='cuda:1')
test acc is  0.14600000015633283
test loss is 175.97748795043685
test entropy is  0.019489794560321006
________________________________
0
distance x is tensor(143.3847, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.019273796987729824
avg test loss is  175.760768451162
avg accuracy is  0.3341833334896734
solo acc is  0.14588333348966614
compute similarity  is  tensor(0.9620, device='cuda:1')
compute_distance is  tensor(143.3847, device='cuda:1')
compute_norm is  tensor(53.4607, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(137.6993, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9616471229712846
avg test loss is  1.465993275901656
avg accuracy is  0.753633333489661
solo acc is  0.3237666668230067
compute similarity  is  tensor(0.9626, device='cuda:1')
compute_distance is  tensor(137.6993, device='cuda:1')
compute_norm is  tensor(53.1214, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(137.6993, device='cuda:1')
distance x is tensor(137.6993, device='cuda:1')
________________________________
test distance is  tensor(137.6993, device='cuda:1')
test distance1 is  tensor(137.6993, device='cuda:1')
test similarity is  tensor(0.9626, device='cuda:1')
test acc is  0.32228333348967325
test loss is 1.4675594641964065
test entropy is  0.9613907806146373
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3260000001600001
mal loss is 1.4725874736905098
mal norm is  tensor(698.5670, device='cuda:1')
distance x is tensor(137.7079, device='cuda:1')
mal distance is  tensor(137.7079, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([19., 13., 30.,  0., 29., 19., 17., 14., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 12., 14., 12., 22., 12., 20., 13., 13.,
        12., 14., 18., 15., 18., 28., 19., 13.])
count_res tensor([1.0892e-05, 2.6998e-08, 6.5214e-01, 6.1025e-14, 2.3991e-01, 1.0892e-05,
        1.4741e-06, 7.3389e-08, 1.6165e-03, 1.6165e-03, 1.6165e-03, 1.6165e-03,
        1.6165e-03, 1.6165e-03, 1.6165e-03, 1.6165e-03, 1.6165e-03, 1.6165e-03,
        1.6165e-03, 1.6165e-03, 9.9321e-09, 7.3389e-08, 9.9321e-09, 2.1877e-04,
        9.9321e-09, 2.9607e-05, 2.6998e-08, 2.6998e-08, 9.9321e-09, 7.3389e-08,
        4.0069e-06, 1.9949e-07, 4.0069e-06, 8.8258e-02, 1.0892e-05, 2.6998e-08])
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 78.60% 

Test Accuracy: 82.02% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8204448949545622
distance x is tensor(133.3180, device='cuda:1')
benign distance is  tensor(133.3180, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2137437164783478
distance x is tensor(121.1220, device='cuda:1')
benign distance is  tensor(121.1220, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0682646445930004
distance x is tensor(68.7844, device='cuda:1')
benign distance is  tensor(68.7844, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0643928870558739
distance x is tensor(166.3593, device='cuda:1')
benign distance is  tensor(166.3593, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4132988341152668
distance x is tensor(115.0419, device='cuda:1')
benign distance is  tensor(115.0419, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2555370889604092
distance x is tensor(119.5582, device='cuda:1')
benign distance is  tensor(119.5582, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.580050379037857
distance x is tensor(118.1889, device='cuda:1')
benign distance is  tensor(118.1889, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.365415707230568
distance x is tensor(96.6290, device='cuda:1')
benign distance is  tensor(96.6290, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.4165710806846619
distance x is tensor(111.8298, device='cuda:1')
benign distance is  tensor(111.8298, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9010595120489597
distance x is tensor(139.9559, device='cuda:1')
benign distance is  tensor(139.9559, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3450582884252071
distance x is tensor(88.4169, device='cuda:1')
benign distance is  tensor(88.4169, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.9643299207091331
distance x is tensor(118.5505, device='cuda:1')
benign distance is  tensor(118.5505, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.9325165916234255
distance x is tensor(179.4118, device='cuda:1')
benign distance is  tensor(179.4118, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.0900936014950275
distance x is tensor(85.8058, device='cuda:1')
benign distance is  tensor(85.8058, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.232918918132782
distance x is tensor(165.2671, device='cuda:1')
benign distance is  tensor(165.2671, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.6563715860247612
distance x is tensor(130.4002, device='cuda:1')
benign distance is  tensor(130.4002, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.0920600350946188
distance x is tensor(126.7941, device='cuda:1')
benign distance is  tensor(126.7941, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.2490878887474537
distance x is tensor(145.7648, device='cuda:1')
benign distance is  tensor(145.7648, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.1966356188058853
distance x is tensor(146.6260, device='cuda:1')
benign distance is  tensor(146.6260, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.9270233139395714
distance x is tensor(114.3180, device='cuda:1')
benign distance is  tensor(114.3180, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.7768970914185047
distance x is tensor(138.4058, device='cuda:1')
benign distance is  tensor(138.4058, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.1969918981194496
distance x is tensor(131.7715, device='cuda:1')
benign distance is  tensor(131.7715, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5888760797679424
distance x is tensor(122.5752, device='cuda:1')
benign distance is  tensor(122.5752, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.2707377336919308
distance x is tensor(177.3637, device='cuda:1')
benign distance is  tensor(177.3637, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(104.7309, device='cuda:1')
compute distance is  tensor(104.7309, device='cuda:1')
compute norm is  tensor(52.0997, device='cuda:1', dtype=torch.float64)
distance x is tensor(156.4861, device='cuda:1')
compute distance is  tensor(156.4861, device='cuda:1')
compute norm is  tensor(52.7695, device='cuda:1', dtype=torch.float64)
distance x is tensor(110.0484, device='cuda:1')
compute distance is  tensor(110.0484, device='cuda:1')
compute norm is  tensor(51.8850, device='cuda:1', dtype=torch.float64)
distance x is tensor(114.8819, device='cuda:1')
compute distance is  tensor(114.8819, device='cuda:1')
compute norm is  tensor(52.1062, device='cuda:1', dtype=torch.float64)
distance x is tensor(103.7029, device='cuda:1')
compute distance is  tensor(103.7029, device='cuda:1')
compute norm is  tensor(51.9105, device='cuda:1', dtype=torch.float64)
distance x is tensor(132.3265, device='cuda:1')
compute distance is  tensor(132.3265, device='cuda:1')
compute norm is  tensor(52.2925, device='cuda:1', dtype=torch.float64)
distance x is tensor(153.4294, device='cuda:1')
compute distance is  tensor(153.4294, device='cuda:1')
compute norm is  tensor(52.8276, device='cuda:1', dtype=torch.float64)
distance x is tensor(99.7980, device='cuda:1')
compute distance is  tensor(99.7980, device='cuda:1')
compute norm is  tensor(51.7948, device='cuda:1', dtype=torch.float64)
distance x is tensor(136.9216, device='cuda:1')
compute distance is  tensor(136.9216, device='cuda:1')
compute norm is  tensor(52.4188, device='cuda:1', dtype=torch.float64)
distance x is tensor(120.3298, device='cuda:1')
compute distance is  tensor(120.3298, device='cuda:1')
compute norm is  tensor(52.2072, device='cuda:1', dtype=torch.float64)
distance x is tensor(134.4544, device='cuda:1')
compute distance is  tensor(134.4544, device='cuda:1')
compute norm is  tensor(52.2886, device='cuda:1', dtype=torch.float64)
distance x is tensor(156.5311, device='cuda:1')
compute distance is  tensor(156.5311, device='cuda:1')
compute norm is  tensor(53.1944, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(156.5311, device='cuda:1')
distance x is tensor(102015.1328, device='cuda:1')
distance x is tensor(102015.1328, device='cuda:1')
________________________________
test distance is  tensor(102015.1328, device='cuda:1')
test distance1 is  tensor(102015.1328, device='cuda:1')
test similarity is  tensor(0.2693, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107530865759247.28
test entropy is  0.0
________________________________
cal ratio is  0.03838788109653637
distance x is tensor(3916.1494, device='cuda:1')
cal_distance is  tensor(3916.1494, device='cuda:1')
cal ratio is  0.19592813719657798
distance x is tensor(767.2875, device='cuda:1')
cal_distance is  tensor(767.2875, device='cuda:1')
cal ratio is  0.4426366364940571
distance x is tensor(339.6321, device='cuda:1')
cal_distance is  tensor(339.6321, device='cuda:1')
cal ratio is  0.6653069745072191
distance x is tensor(225.9611, device='cuda:1')
cal_distance is  tensor(225.9611, device='cuda:1')
cal ratio is  0.8156607632597473
distance x is tensor(184.3085, device='cuda:1')
cal_distance is  tensor(184.3085, device='cuda:1')
cal ratio is  0.9031373006913568
distance x is tensor(166.4563, device='cuda:1')
cal_distance is  tensor(166.4563, device='cuda:1')
cal ratio is  0.9503340491574042
distance x is tensor(158.1893, device='cuda:1')
cal_distance is  tensor(158.1893, device='cuda:1')
cal ratio is  0.9748501069561266
distance x is tensor(154.2110, device='cuda:1')
cal_distance is  tensor(154.2110, device='cuda:1')
distance x is tensor(154.2110, device='cuda:1')
return_distance is  tensor(154.2110, device='cuda:1')
distance x is tensor(154.2020, device='cuda:1')
distance x is tensor(154.2020, device='cuda:1')
________________________________
test distance is  tensor(154.2020, device='cuda:1')
test distance1 is  tensor(154.2020, device='cuda:1')
test similarity is  tensor(0.9591, device='cuda:1')
test acc is  0.11730000015633192
test loss is 228.737786787151
test entropy is  0.007650174042671126
________________________________
0
distance x is tensor(154.2020, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.008090988470333493
avg test loss is  228.96684432690586
avg accuracy is  0.3961166668230078
solo acc is  0.11780000015633194
compute similarity  is  tensor(0.9591, device='cuda:1')
compute_distance is  tensor(154.2020, device='cuda:1')
compute_norm is  tensor(54.9478, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(176.2104, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.1774481738299958
avg test loss is  1.8240696981009135
avg accuracy is  0.6741166668229989
solo acc is  0.2308000001563376
compute similarity  is  tensor(0.9525, device='cuda:1')
compute_distance is  tensor(176.2104, device='cuda:1')
compute_norm is  tensor(56.4506, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(177.2189, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.6983378933691012
avg test loss is  2.7452138941933604
avg accuracy is  0.6724000001563323
solo acc is  0.10970000015633195
compute similarity  is  tensor(0.9520, device='cuda:1')
compute_distance is  tensor(177.2189, device='cuda:1')
compute_norm is  tensor(56.3206, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(178.0909, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.0515870245407895
avg test loss is  1.71291355575834
avg accuracy is  0.697833333489664
solo acc is  0.22486666682300405
compute similarity  is  tensor(0.9522, device='cuda:1')
compute_distance is  tensor(178.0909, device='cuda:1')
compute_norm is  tensor(55.9181, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(178.8051, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.6492696715189196
avg test loss is  2.5374768357287083
avg accuracy is  0.6965833334896641
solo acc is  0.10966666682299862
compute similarity  is  tensor(0.9517, device='cuda:1')
compute_distance is  tensor(178.8051, device='cuda:1')
compute_norm is  tensor(55.7574, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(179.3908, device='cuda:1')
distance x is tensor(179.3908, device='cuda:1')
________________________________
test distance is  tensor(179.3908, device='cuda:1')
test distance1 is  tensor(179.3908, device='cuda:1')
test similarity is  tensor(0.9519, device='cuda:1')
test acc is  0.23628333348967123
test loss is 1.5825948946511568
test entropy is  1.0039491002112308
________________________________
cal ratio is  0.9154324391044736
distance x is tensor(164.2266, device='cuda:1')
cal_distance is  tensor(164.2266, device='cuda:1')
cal ratio is  0.9567636625422327
distance x is tensor(157.1262, device='cuda:1')
cal_distance is  tensor(157.1262, device='cuda:1')
cal ratio is  0.9781425898618691
distance x is tensor(153.6919, device='cuda:1')
cal_distance is  tensor(153.6919, device='cuda:1')
distance x is tensor(153.6919, device='cuda:1')
return_distance is  tensor(153.6919, device='cuda:1')
distance x is tensor(153.6852, device='cuda:1')
distance x is tensor(153.6852, device='cuda:1')
________________________________
test distance is  tensor(153.6852, device='cuda:1')
test distance1 is  tensor(153.6852, device='cuda:1')
test similarity is  tensor(0.9634, device='cuda:1')
test acc is  0.34261666682300707
test loss is 1.3721795502756196
test entropy is  1.1718411933638648
________________________________
0
distance x is tensor(153.6852, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.1715186252268648
avg test loss is  1.3717746211013306
avg accuracy is  0.7373500001563286
solo acc is  0.3381333334896736
compute similarity  is  tensor(0.9634, device='cuda:1')
compute_distance is  tensor(153.6852, device='cuda:1')
compute_norm is  tensor(54.4544, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(155.5754, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.6281746242092108
avg test loss is  2.4272777156026635
avg accuracy is  0.7318500001563288
solo acc is  0.11008333348966529
compute similarity  is  tensor(0.9626, device='cuda:1')
compute_distance is  tensor(155.5754, device='cuda:1')
compute_norm is  tensor(54.3149, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(156.9040, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.9565305104896203
avg test loss is  1.4791386310479788
avg accuracy is  0.7499666668229945
solo acc is  0.261733333489672
compute similarity  is  tensor(0.9624, device='cuda:1')
compute_distance is  tensor(156.9040, device='cuda:1')
compute_norm is  tensor(53.9594, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(156.9040, device='cuda:1')
distance x is tensor(156.9040, device='cuda:1')
________________________________
test distance is  tensor(156.9040, device='cuda:1')
test distance1 is  tensor(156.9040, device='cuda:1')
test similarity is  tensor(0.9624, device='cuda:1')
test acc is  0.265183333489672
test loss is 1.4759382633512208
test entropy is  0.9564300053028155
________________________________
cal ratio is  0.9788349408650677
distance x is tensor(153.5895, device='cuda:1')
cal_distance is  tensor(153.5895, device='cuda:1')
distance x is tensor(153.5895, device='cuda:1')
return_distance is  tensor(153.5895, device='cuda:1')
distance x is tensor(153.5830, device='cuda:1')
distance x is tensor(153.5830, device='cuda:1')
________________________________
test distance is  tensor(153.5830, device='cuda:1')
test distance1 is  tensor(153.5830, device='cuda:1')
test similarity is  tensor(0.9638, device='cuda:1')
test acc is  0.28263333348967246
test loss is 1.4340704349058269
test entropy is  0.9845018965730281
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.28600000016000005
mal loss is 1.4353272914886475
mal norm is  tensor(672.7355, device='cuda:1')
distance x is tensor(153.5895, device='cuda:1')
mal distance is  tensor(153.5895, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 19.93% 

Test Accuracy: 25.02% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.9138151928782463
distance x is tensor(196.0763, device='cuda:1')
benign distance is  tensor(196.0763, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.652754232287407
distance x is tensor(183.4609, device='cuda:1')
benign distance is  tensor(183.4609, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.3137437030673027
distance x is tensor(173.6633, device='cuda:1')
benign distance is  tensor(173.6633, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.682323269546032
distance x is tensor(234.2015, device='cuda:1')
benign distance is  tensor(234.2015, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.5311909057199955
distance x is tensor(173.9213, device='cuda:1')
benign distance is  tensor(173.9213, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.7736316472291946
distance x is tensor(191.7680, device='cuda:1')
benign distance is  tensor(191.7680, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.7984686568379402
distance x is tensor(206.0883, device='cuda:1')
benign distance is  tensor(206.0883, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.7611100673675537
distance x is tensor(203.7449, device='cuda:1')
benign distance is  tensor(203.7449, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(232.9255, device='cuda:1')
compute distance is  tensor(232.9255, device='cuda:1')
compute norm is  tensor(58.8872, device='cuda:1', dtype=torch.float64)
distance x is tensor(203.2776, device='cuda:1')
compute distance is  tensor(203.2776, device='cuda:1')
compute norm is  tensor(56.3636, device='cuda:1', dtype=torch.float64)
distance x is tensor(158.3391, device='cuda:1')
compute distance is  tensor(158.3391, device='cuda:1')
compute norm is  tensor(55.3211, device='cuda:1', dtype=torch.float64)
distance x is tensor(161.3772, device='cuda:1')
compute distance is  tensor(161.3772, device='cuda:1')
compute norm is  tensor(55.6115, device='cuda:1', dtype=torch.float64)
distance x is tensor(148.4305, device='cuda:1')
compute distance is  tensor(148.4305, device='cuda:1')
compute norm is  tensor(55.2792, device='cuda:1', dtype=torch.float64)
distance x is tensor(155.4779, device='cuda:1')
compute distance is  tensor(155.4779, device='cuda:1')
compute norm is  tensor(55.9715, device='cuda:1', dtype=torch.float64)
distance x is tensor(165.7947, device='cuda:1')
compute distance is  tensor(165.7947, device='cuda:1')
compute norm is  tensor(55.6823, device='cuda:1', dtype=torch.float64)
distance x is tensor(160.8865, device='cuda:1')
compute distance is  tensor(160.8865, device='cuda:1')
compute norm is  tensor(55.3380, device='cuda:1', dtype=torch.float64)
distance x is tensor(172.4453, device='cuda:1')
compute distance is  tensor(172.4453, device='cuda:1')
compute norm is  tensor(55.9985, device='cuda:1', dtype=torch.float64)
distance x is tensor(181.4529, device='cuda:1')
compute distance is  tensor(181.4529, device='cuda:1')
compute norm is  tensor(56.2265, device='cuda:1', dtype=torch.float64)
distance x is tensor(171.1575, device='cuda:1')
compute distance is  tensor(171.1575, device='cuda:1')
compute norm is  tensor(55.6720, device='cuda:1', dtype=torch.float64)
distance x is tensor(185.9453, device='cuda:1')
compute distance is  tensor(185.9453, device='cuda:1')
compute norm is  tensor(56.5778, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(232.9255, device='cuda:1')
distance x is tensor(101925.5859, device='cuda:1')
distance x is tensor(101925.5859, device='cuda:1')
________________________________
test distance is  tensor(101925.5859, device='cuda:1')
test distance1 is  tensor(101925.5859, device='cuda:1')
test similarity is  tensor(0.4506, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107524983636911.22
test entropy is  0.0
________________________________
cal ratio is  0.046848209868505845
distance x is tensor(4775.0361, device='cuda:1')
cal_distance is  tensor(4775.0361, device='cuda:1')
cal ratio is  0.21644436552222315
distance x is tensor(1033.5333, device='cuda:1')
cal_distance is  tensor(1033.5333, device='cuda:1')
cal ratio is  0.4652349861326776
distance x is tensor(480.8382, device='cuda:1')
cal_distance is  tensor(480.8382, device='cuda:1')
cal ratio is  0.6820797328692768
distance x is tensor(327.9714, device='cuda:1')
cal_distance is  tensor(327.9714, device='cuda:1')
cal ratio is  0.8258794315404575
distance x is tensor(270.8657, device='cuda:1')
cal_distance is  tensor(270.8657, device='cuda:1')
cal ratio is  0.908777613987681
distance x is tensor(246.1571, device='cuda:1')
cal_distance is  tensor(246.1571, device='cuda:1')
cal ratio is  0.9532974662208078
distance x is tensor(234.6611, device='cuda:1')
cal_distance is  tensor(234.6611, device='cuda:1')
cal ratio is  0.9763691841131018
distance x is tensor(229.1160, device='cuda:1')
cal_distance is  tensor(229.1160, device='cuda:1')
distance x is tensor(229.1160, device='cuda:1')
return_distance is  tensor(229.1160, device='cuda:1')
distance x is tensor(229.1070, device='cuda:1')
distance x is tensor(229.1070, device='cuda:1')
________________________________
test distance is  tensor(229.1070, device='cuda:1')
test distance1 is  tensor(229.1070, device='cuda:1')
test similarity is  tensor(0.9466, device='cuda:1')
test acc is  0.10556666682299864
test loss is 1936.9282303344467
test entropy is  0.0025609578751611285
________________________________
0
distance x is tensor(229.1070, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.00245145877824197
avg test loss is  1933.3397245427439
avg accuracy is  0.18250000015633538
solo acc is  0.10461666682299865
compute similarity  is  tensor(0.9466, device='cuda:1')
compute_distance is  tensor(229.1070, device='cuda:1')
compute_norm is  tensor(62.4962, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1090.3669, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.5506668774558028
avg test loss is  2.8706275890630955
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4684, device='cuda:1')
compute_distance is  tensor(1090.3669, device='cuda:1')
compute_norm is  tensor(130.6534, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1085.3389, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8384221894527549
avg test loss is  3.6212149098483737
avg accuracy is  0.09995000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4687, device='cuda:1')
compute_distance is  tensor(1085.3389, device='cuda:1')
compute_norm is  tensor(130.2958, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1080.2574, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.556585921026242
avg test loss is  2.861740217788387
avg accuracy is  0.09995000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4683, device='cuda:1')
compute_distance is  tensor(1080.2574, device='cuda:1')
compute_norm is  tensor(129.4056, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1075.3352, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8388774413416888
avg test loss is  3.6188587217188593
avg accuracy is  0.09998333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4687, device='cuda:1')
compute_distance is  tensor(1075.3352, device='cuda:1')
compute_norm is  tensor(129.0717, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1070.3433, device='cuda:1')
distance x is tensor(1070.3433, device='cuda:1')
________________________________
test distance is  tensor(1070.3433, device='cuda:1')
test distance1 is  tensor(1070.3433, device='cuda:1')
test similarity is  tensor(0.4683, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.8598177018704445
test entropy is  1.5575854431337386
________________________________
cal ratio is  0.4571651012920525
distance x is tensor(489.3250, device='cuda:1')
cal_distance is  tensor(489.3250, device='cuda:1')
cal ratio is  0.676138895271784
distance x is tensor(330.8520, device='cuda:1')
cal_distance is  tensor(330.8520, device='cuda:1')
cal ratio is  0.8222762640547944
distance x is tensor(272.0519, device='cuda:1')
cal_distance is  tensor(272.0519, device='cuda:1')
cal ratio is  0.9067941797630027
distance x is tensor(246.6952, device='cuda:1')
cal_distance is  tensor(246.6952, device='cuda:1')
cal ratio is  0.9522572450224499
distance x is tensor(234.9173, device='cuda:1')
cal_distance is  tensor(234.9173, device='cuda:1')
cal ratio is  0.9758365632651735
distance x is tensor(229.2410, device='cuda:1')
cal_distance is  tensor(229.2410, device='cuda:1')
distance x is tensor(229.2410, device='cuda:1')
return_distance is  tensor(229.2410, device='cuda:1')
distance x is tensor(229.2390, device='cuda:1')
distance x is tensor(229.2390, device='cuda:1')
________________________________
test distance is  tensor(229.2390, device='cuda:1')
test distance1 is  tensor(229.2390, device='cuda:1')
test similarity is  tensor(0.9111, device='cuda:1')
test acc is  0.10010000015633198
test loss is 2.8643528177285753
test entropy is  1.1579520603868245
________________________________
0
distance x is tensor(229.2390, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.1594936297392286
avg test loss is  2.8644623118422943
avg accuracy is  0.13826666682299874
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.9111, device='cuda:1')
compute_distance is  tensor(229.2390, device='cuda:1')
compute_norm is  tensor(61.5749, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(229.3601, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.7509336690785788
avg test loss is  2.9485691651098254
avg accuracy is  0.13948333348966552
solo acc is  0.10031666682299864
compute similarity  is  tensor(0.9113, device='cuda:1')
compute_distance is  tensor(229.3601, device='cuda:1')
compute_norm is  tensor(61.4213, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(230.3747, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.144524749662322
avg test loss is  1.940598329247188
avg accuracy is  0.22490000015633746
solo acc is  0.1550000001563336
compute similarity  is  tensor(0.9113, device='cuda:1')
compute_distance is  tensor(230.3747, device='cuda:1')
compute_norm is  tensor(61.1207, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(229.4772, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.6886777584232501
avg test loss is  2.6876178654526344
avg accuracy is  0.1513833334896666
solo acc is  0.10081666682299864
compute similarity  is  tensor(0.9114, device='cuda:1')
compute_distance is  tensor(229.4772, device='cuda:1')
compute_norm is  tensor(60.9744, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(230.2637, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  1.0918780412755287
avg test loss is  1.845750126376081
avg accuracy is  0.2595000001563386
solo acc is  0.16366666682300093
compute similarity  is  tensor(0.9112, device='cuda:1')
compute_distance is  tensor(230.2637, device='cuda:1')
compute_norm is  tensor(60.6440, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(229.4689, device='cuda:1')
distance x is tensor(229.4689, device='cuda:1')
________________________________
test distance is  tensor(229.4689, device='cuda:1')
test distance1 is  tensor(229.4689, device='cuda:1')
test similarity is  tensor(0.9112, device='cuda:1')
test acc is  0.10060000015633198
test loss is 2.596282205856177
test entropy is  0.6634698940365553
________________________________
0
distance x is tensor(229.4689, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.6630370111734882
avg test loss is  2.5952522360693924
avg accuracy is  0.17296666682300146
solo acc is  0.10070000015633199
compute similarity  is  tensor(0.9112, device='cuda:1')
compute_distance is  tensor(229.4689, device='cuda:1')
compute_norm is  tensor(60.4750, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(230.3665, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.080746535299175
avg test loss is  1.755133923691219
avg accuracy is  0.2981666668230062
solo acc is  0.16910000015633458
compute similarity  is  tensor(0.9110, device='cuda:1')
compute_distance is  tensor(230.3665, device='cuda:1')
compute_norm is  tensor(60.1536, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(229.7389, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.6517566182593039
avg test loss is  2.5200195818313404
avg accuracy is  0.1960500001563361
solo acc is  0.10066666682299863
compute similarity  is  tensor(0.9110, device='cuda:1')
compute_distance is  tensor(229.7389, device='cuda:1')
compute_norm is  tensor(59.9750, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(230.6603, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.0429242492230462
avg test loss is  1.697469720581193
avg accuracy is  0.32438333348967335
solo acc is  0.18218333348966873
compute similarity  is  tensor(0.9107, device='cuda:1')
compute_distance is  tensor(230.6603, device='cuda:1')
compute_norm is  tensor(59.6523, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(230.1224, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.642324813329843
avg test loss is  2.464289379018202
avg accuracy is  0.21463333348967029
solo acc is  0.10068333348966532
compute similarity  is  tensor(0.9107, device='cuda:1')
compute_distance is  tensor(230.1224, device='cuda:1')
compute_norm is  tensor(59.4669, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(230.9861, device='cuda:1')
________________________________
test distance is  tensor(230.9861, device='cuda:1')
test similarity is  tensor(0.9104, device='cuda:1')
test acc is  0.35470000015634057
test loss is 1.6438768667452879
test entropy is  1.037761268839399
________________________________
final entropy
distance x is tensor(230.9855, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.0389620924173897
avg test loss is  1.6474511930937452
avg accuracy is  0.3514166668230071
solo acc is  0.18641666682300234
compute similarity  is  tensor(0.9104, device='cuda:1')
compute_distance is  tensor(230.9855, device='cuda:1')
compute_norm is  tensor(59.1493, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.11100000016000001
mal loss is 2.4089618176221848
mal norm is  tensor(1117.9606, device='cuda:1')
distance x is tensor(230.5393, device='cuda:1')
mal distance is  tensor(230.5393, device='cuda:1')
user_PLR len size 44
counter_tensor is  tensor([ 5., 30., 34., 31., 17., 30., 30., 15., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 35., 18., 12., 27., 15., 29., 12., 36.,
        12., 31., 12.,  0., 12.,  0., 12.,  9., 41., 13., 13., 12., 21., 23.,
        12., 29.])
count_res tensor([2.2926e-16, 1.6508e-05, 9.0128e-04, 4.4872e-05, 3.7312e-11, 1.6508e-05,
        1.6508e-05, 5.0497e-12, 1.2197e-04, 1.2197e-04, 1.2197e-04, 1.2197e-04,
        1.2197e-04, 1.2197e-04, 1.2197e-04, 1.2197e-04, 1.2197e-04, 1.2197e-04,
        1.2197e-04, 1.2197e-04, 2.4499e-03, 1.0143e-10, 2.5141e-13, 8.2186e-07,
        5.0497e-12, 6.0728e-06, 2.5141e-13, 6.6596e-03, 2.5141e-13, 4.4872e-05,
        2.5141e-13, 1.5447e-18, 2.5141e-13, 1.5447e-18, 2.5141e-13, 1.2517e-14,
        9.8837e-01, 6.8340e-13, 6.8340e-13, 2.5141e-13, 2.0372e-09, 1.5053e-08,
        2.5141e-13, 6.0728e-06])
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 59.67% 

Test Accuracy: 73.59% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7586363647133112
distance x is tensor(143.1302, device='cuda:1')
benign distance is  tensor(143.1302, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.4839657843112946
distance x is tensor(112.0869, device='cuda:1')
benign distance is  tensor(112.0869, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.366510320454836
distance x is tensor(104.0409, device='cuda:1')
benign distance is  tensor(104.0409, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.7041085585951805
distance x is tensor(163.6452, device='cuda:1')
benign distance is  tensor(163.6452, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.406548073515296
distance x is tensor(125.8000, device='cuda:1')
benign distance is  tensor(125.8000, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1962099932134151
distance x is tensor(117.9441, device='cuda:1')
benign distance is  tensor(117.9441, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.00557579100132
distance x is tensor(111.7370, device='cuda:1')
benign distance is  tensor(111.7370, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1584967635571957
distance x is tensor(111.5744, device='cuda:1')
benign distance is  tensor(111.5744, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.7262334451079369
distance x is tensor(62.0484, device='cuda:1')
benign distance is  tensor(62.0484, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9757235590368509
distance x is tensor(138.6361, device='cuda:1')
benign distance is  tensor(138.6361, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.672114860266447
distance x is tensor(96.6372, device='cuda:1')
benign distance is  tensor(96.6372, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.6390519812703133
distance x is tensor(123.9713, device='cuda:1')
benign distance is  tensor(123.9713, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.2983963638544083
distance x is tensor(161.9545, device='cuda:1')
benign distance is  tensor(161.9545, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.2133317962288857
distance x is tensor(78.2690, device='cuda:1')
benign distance is  tensor(78.2690, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.5508247762918472
distance x is tensor(153.6000, device='cuda:1')
benign distance is  tensor(153.6000, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.140551656484604
distance x is tensor(129.3703, device='cuda:1')
benign distance is  tensor(129.3703, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.880622036755085
distance x is tensor(129.3306, device='cuda:1')
benign distance is  tensor(129.3306, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.2596133910119534
distance x is tensor(114.5947, device='cuda:1')
benign distance is  tensor(114.5947, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.272035013884306
distance x is tensor(133.3810, device='cuda:1')
benign distance is  tensor(133.3810, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.5534937642514706
distance x is tensor(135.5502, device='cuda:1')
benign distance is  tensor(135.5502, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.3501409627497196
distance x is tensor(101.5500, device='cuda:1')
benign distance is  tensor(101.5500, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0153486654162407
distance x is tensor(202.7424, device='cuda:1')
benign distance is  tensor(202.7424, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1974111124873161
distance x is tensor(180.5227, device='cuda:1')
benign distance is  tensor(180.5227, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.2100323475897312
distance x is tensor(130.3265, device='cuda:1')
benign distance is  tensor(130.3265, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.399909630417824
distance x is tensor(127.2930, device='cuda:1')
benign distance is  tensor(127.2930, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.4056798070669174
distance x is tensor(151.4038, device='cuda:1')
benign distance is  tensor(151.4038, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.4543066285550594
distance x is tensor(149.5905, device='cuda:1')
benign distance is  tensor(149.5905, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.6346137300133705
distance x is tensor(104.6586, device='cuda:1')
benign distance is  tensor(104.6586, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.9863612316548824
distance x is tensor(166.1353, device='cuda:1')
benign distance is  tensor(166.1353, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.314622424542904
distance x is tensor(143.3296, device='cuda:1')
benign distance is  tensor(143.3296, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.5750081837177277
distance x is tensor(119.1138, device='cuda:1')
benign distance is  tensor(119.1138, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6793551761657
distance x is tensor(150.1039, device='cuda:1')
benign distance is  tensor(150.1039, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(85.0479, device='cuda:1')
compute distance is  tensor(85.0479, device='cuda:1')
compute norm is  tensor(52.4322, device='cuda:1', dtype=torch.float64)
distance x is tensor(156.3570, device='cuda:1')
compute distance is  tensor(156.3570, device='cuda:1')
compute norm is  tensor(53.6762, device='cuda:1', dtype=torch.float64)
distance x is tensor(116.1490, device='cuda:1')
compute distance is  tensor(116.1490, device='cuda:1')
compute norm is  tensor(52.7192, device='cuda:1', dtype=torch.float64)
distance x is tensor(112.9360, device='cuda:1')
compute distance is  tensor(112.9360, device='cuda:1')
compute norm is  tensor(52.8531, device='cuda:1', dtype=torch.float64)
distance x is tensor(115.0696, device='cuda:1')
compute distance is  tensor(115.0696, device='cuda:1')
compute norm is  tensor(52.5788, device='cuda:1', dtype=torch.float64)
distance x is tensor(121.3426, device='cuda:1')
compute distance is  tensor(121.3426, device='cuda:1')
compute norm is  tensor(53.0857, device='cuda:1', dtype=torch.float64)
distance x is tensor(133.0287, device='cuda:1')
compute distance is  tensor(133.0287, device='cuda:1')
compute norm is  tensor(53.1447, device='cuda:1', dtype=torch.float64)
distance x is tensor(110.1201, device='cuda:1')
compute distance is  tensor(110.1201, device='cuda:1')
compute norm is  tensor(52.7614, device='cuda:1', dtype=torch.float64)
distance x is tensor(129.8669, device='cuda:1')
compute distance is  tensor(129.8669, device='cuda:1')
compute norm is  tensor(53.1216, device='cuda:1', dtype=torch.float64)
distance x is tensor(116.2706, device='cuda:1')
compute distance is  tensor(116.2706, device='cuda:1')
compute norm is  tensor(52.9136, device='cuda:1', dtype=torch.float64)
distance x is tensor(134.0276, device='cuda:1')
compute distance is  tensor(134.0276, device='cuda:1')
compute norm is  tensor(53.0153, device='cuda:1', dtype=torch.float64)
distance x is tensor(155.9196, device='cuda:1')
compute distance is  tensor(155.9196, device='cuda:1')
compute norm is  tensor(53.8848, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(156.3570, device='cuda:1')
distance x is tensor(102029.9688, device='cuda:1')
distance x is tensor(102029.9688, device='cuda:1')
________________________________
test distance is  tensor(102029.9688, device='cuda:1')
test distance1 is  tensor(102029.9688, device='cuda:1')
test similarity is  tensor(0.2525, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107662702374606.33
test entropy is  0.0
________________________________
cal ratio is  0.038363733121748844
distance x is tensor(3914.2551, device='cuda:1')
cal_distance is  tensor(3914.2551, device='cuda:1')
cal ratio is  0.19586649791606334
distance x is tensor(766.6751, device='cuda:1')
cal_distance is  tensor(766.6751, device='cuda:1')
cal ratio is  0.442567021452023
distance x is tensor(339.3077, device='cuda:1')
cal_distance is  tensor(339.3077, device='cuda:1')
cal ratio is  0.6652545729038798
distance x is tensor(225.7275, device='cuda:1')
cal_distance is  tensor(225.7275, device='cuda:1')
cal ratio is  0.8156286545887185
distance x is tensor(184.1107, device='cuda:1')
cal_distance is  tensor(184.1107, device='cuda:1')
cal ratio is  0.9031194896595892
distance x is tensor(166.2744, device='cuda:1')
cal_distance is  tensor(166.2744, device='cuda:1')
cal ratio is  0.9503247426532401
distance x is tensor(158.0149, device='cuda:1')
cal_distance is  tensor(158.0149, device='cuda:1')
cal ratio is  0.9748452918114922
distance x is tensor(154.0402, device='cuda:1')
cal_distance is  tensor(154.0402, device='cuda:1')
distance x is tensor(154.0402, device='cuda:1')
return_distance is  tensor(154.0402, device='cuda:1')
distance x is tensor(154.0311, device='cuda:1')
distance x is tensor(154.0311, device='cuda:1')
________________________________
test distance is  tensor(154.0311, device='cuda:1')
test distance1 is  tensor(154.0311, device='cuda:1')
test similarity is  tensor(0.9596, device='cuda:1')
test acc is  0.17848333348966855
test loss is 140.45826489381446
test entropy is  0.025660321613043192
________________________________
0
distance x is tensor(154.0311, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.026571081130690788
avg test loss is  140.17056582680644
avg accuracy is  0.4817166668230086
solo acc is  0.17696666682300186
compute similarity  is  tensor(0.9596, device='cuda:1')
compute_distance is  tensor(154.0311, device='cuda:1')
compute_norm is  tensor(55.5454, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(151.3372, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9676722758995698
avg test loss is  1.5481877600206242
avg accuracy is  0.7716333334896601
solo acc is  0.30145000015633955
compute similarity  is  tensor(0.9594, device='cuda:1')
compute_distance is  tensor(151.3372, device='cuda:1')
compute_norm is  tensor(55.3988, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(151.3372, device='cuda:1')
distance x is tensor(151.3372, device='cuda:1')
________________________________
test distance is  tensor(151.3372, device='cuda:1')
test distance1 is  tensor(151.3372, device='cuda:1')
test similarity is  tensor(0.9594, device='cuda:1')
test acc is  0.30013333348967286
test loss is 1.5438516278510916
test entropy is  0.9675780453407434
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3190000001600001
mal loss is 1.5459481924772263
mal norm is  tensor(759.7344, device='cuda:1')
distance x is tensor(151.3461, device='cuda:1')
mal distance is  tensor(151.3461, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 22.77% 

Test Accuracy: 25.20% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0063751563429832
distance x is tensor(175.7981, device='cuda:1')
benign distance is  tensor(175.7981, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.5472976565361023
distance x is tensor(159.7510, device='cuda:1')
benign distance is  tensor(159.7510, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.902094841003418
distance x is tensor(162.4165, device='cuda:1')
benign distance is  tensor(162.4165, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.106923371553421
distance x is tensor(187.1265, device='cuda:1')
benign distance is  tensor(187.1265, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.334246166050434
distance x is tensor(171.0738, device='cuda:1')
benign distance is  tensor(171.0738, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9445589203387499
distance x is tensor(140.7704, device='cuda:1')
benign distance is  tensor(140.7704, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.0884726494550705
distance x is tensor(171.9966, device='cuda:1')
benign distance is  tensor(171.9966, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3361607268452644
distance x is tensor(141.3072, device='cuda:1')
benign distance is  tensor(141.3072, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(125.2762, device='cuda:1')
compute distance is  tensor(125.2762, device='cuda:1')
compute norm is  tensor(56.6990, device='cuda:1', dtype=torch.float64)
distance x is tensor(180.2271, device='cuda:1')
compute distance is  tensor(180.2271, device='cuda:1')
compute norm is  tensor(57.6705, device='cuda:1', dtype=torch.float64)
distance x is tensor(142.9371, device='cuda:1')
compute distance is  tensor(142.9371, device='cuda:1')
compute norm is  tensor(56.8467, device='cuda:1', dtype=torch.float64)
distance x is tensor(180.2091, device='cuda:1')
compute distance is  tensor(180.2091, device='cuda:1')
compute norm is  tensor(57.8302, device='cuda:1', dtype=torch.float64)
distance x is tensor(123.9120, device='cuda:1')
compute distance is  tensor(123.9120, device='cuda:1')
compute norm is  tensor(56.5287, device='cuda:1', dtype=torch.float64)
distance x is tensor(146.9288, device='cuda:1')
compute distance is  tensor(146.9288, device='cuda:1')
compute norm is  tensor(57.1207, device='cuda:1', dtype=torch.float64)
distance x is tensor(169.5850, device='cuda:1')
compute distance is  tensor(169.5850, device='cuda:1')
compute norm is  tensor(57.4810, device='cuda:1', dtype=torch.float64)
distance x is tensor(127.0503, device='cuda:1')
compute distance is  tensor(127.0503, device='cuda:1')
compute norm is  tensor(56.5595, device='cuda:1', dtype=torch.float64)
distance x is tensor(159.9567, device='cuda:1')
compute distance is  tensor(159.9567, device='cuda:1')
compute norm is  tensor(57.3857, device='cuda:1', dtype=torch.float64)
distance x is tensor(148.5493, device='cuda:1')
compute distance is  tensor(148.5493, device='cuda:1')
compute norm is  tensor(57.3040, device='cuda:1', dtype=torch.float64)
distance x is tensor(152.8944, device='cuda:1')
compute distance is  tensor(152.8944, device='cuda:1')
compute norm is  tensor(56.9794, device='cuda:1', dtype=torch.float64)
distance x is tensor(179.6825, device='cuda:1')
compute distance is  tensor(179.6825, device='cuda:1')
compute norm is  tensor(58.1573, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(180.2271, device='cuda:1')
distance x is tensor(101915.0781, device='cuda:1')
distance x is tensor(101915.0781, device='cuda:1')
________________________________
test distance is  tensor(101915.0781, device='cuda:1')
test distance1 is  tensor(101915.0781, device='cuda:1')
test similarity is  tensor(0.4901, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107573509382161.47
test entropy is  0.0
________________________________
cal ratio is  0.04121135517107578
distance x is tensor(4200.0640, device='cuda:1')
cal_distance is  tensor(4200.0640, device='cuda:1')
cal ratio is  0.20300567172200565
distance x is tensor(852.6404, device='cuda:1')
cal_distance is  tensor(852.6404, device='cuda:1')
cal ratio is  0.4505605620542164
distance x is tensor(384.1686, device='cuda:1')
cal_distance is  tensor(384.1686, device='cuda:1')
cal ratio is  0.6712359061084606
distance x is tensor(257.8693, device='cuda:1')
cal_distance is  tensor(257.8693, device='cuda:1')
cal ratio is  0.8192874009788736
distance x is tensor(211.2699, device='cuda:1')
cal_distance is  tensor(211.2699, device='cuda:1')
cal ratio is  0.9051432628414369
distance x is tensor(191.2300, device='cuda:1')
cal_distance is  tensor(191.2300, device='cuda:1')
cal ratio is  0.951389038849948
distance x is tensor(181.9343, device='cuda:1')
cal_distance is  tensor(181.9343, device='cuda:1')
cal ratio is  0.9753911601146472
distance x is tensor(177.4572, device='cuda:1')
cal_distance is  tensor(177.4572, device='cuda:1')
distance x is tensor(177.4572, device='cuda:1')
return_distance is  tensor(177.4572, device='cuda:1')
distance x is tensor(177.4481, device='cuda:1')
distance x is tensor(177.4481, device='cuda:1')
________________________________
test distance is  tensor(177.4481, device='cuda:1')
test distance1 is  tensor(177.4481, device='cuda:1')
test similarity is  tensor(0.9694, device='cuda:1')
test acc is  0.10000000015633198
test loss is 713.5471908471732
test entropy is  5.0903802736754e-36
________________________________
0
distance x is tensor(177.4481, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  8.536944491574255e-41
avg test loss is  713.8531947024087
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9694, device='cuda:1')
compute_distance is  tensor(177.4481, device='cuda:1')
compute_norm is  tensor(62.0615, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(552.4995, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.5468625211512357
avg test loss is  2.8888455286209007
avg accuracy is  0.0808333334896654
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8205, device='cuda:1')
compute_distance is  tensor(552.4995, device='cuda:1')
compute_norm is  tensor(82.5174, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(550.2227, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8398362858209021
avg test loss is  3.6398190656450513
avg accuracy is  0.07746666682299873
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8205, device='cuda:1')
compute_distance is  tensor(550.2227, device='cuda:1')
compute_norm is  tensor(82.4196, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(547.3021, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.5546947097473307
avg test loss is  2.870592072828492
avg accuracy is  0.0803333334896654
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8203, device='cuda:1')
compute_distance is  tensor(547.3021, device='cuda:1')
compute_norm is  tensor(81.6651, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(545.1561, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8438306028273568
avg test loss is  3.6219649591933942
avg accuracy is  0.07785000015633206
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8204, device='cuda:1')
compute_distance is  tensor(545.1561, device='cuda:1')
compute_norm is  tensor(81.6050, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(542.3469, device='cuda:1')
distance x is tensor(542.3469, device='cuda:1')
________________________________
test distance is  tensor(542.3469, device='cuda:1')
test distance1 is  tensor(542.3469, device='cuda:1')
test similarity is  tensor(0.8202, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.8630359500710134
test entropy is  1.5576931098376765
________________________________
cal ratio is  0.5649338019885466
distance x is tensor(306.3914, device='cuda:1')
cal_distance is  tensor(306.3914, device='cuda:1')
cal ratio is  0.751619154906277
distance x is tensor(230.2898, device='cuda:1')
cal_distance is  tensor(230.2898, device='cuda:1')
cal ratio is  0.8669593251585773
distance x is tensor(199.6520, device='cuda:1')
cal_distance is  tensor(199.6520, device='cuda:1')
cal ratio is  0.931106260509787
distance x is tensor(185.8973, device='cuda:1')
cal_distance is  tensor(185.8973, device='cuda:1')
cal ratio is  0.9649382667980734
distance x is tensor(179.3795, device='cuda:1')
cal_distance is  tensor(179.3795, device='cuda:1')
distance x is tensor(179.3795, device='cuda:1')
return_distance is  tensor(179.3795, device='cuda:1')
distance x is tensor(179.3778, device='cuda:1')
distance x is tensor(179.3778, device='cuda:1')
________________________________
test distance is  tensor(179.3778, device='cuda:1')
test distance1 is  tensor(179.3778, device='cuda:1')
test similarity is  tensor(0.9689, device='cuda:1')
test acc is  0.11031666682299862
test loss is 2.491907633443885
test entropy is  1.7228576511716538
________________________________
0
distance x is tensor(179.3778, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.723977550133459
avg test loss is  2.490008786797269
avg accuracy is  0.1525500001563334
solo acc is  0.11126666682299861
compute similarity  is  tensor(0.9689, device='cuda:1')
compute_distance is  tensor(179.3778, device='cuda:1')
compute_norm is  tensor(60.7371, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(180.6266, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.7551943004639672
avg test loss is  3.026659170193459
avg accuracy is  0.13273333348966523
solo acc is  0.1022333334896653
compute similarity  is  tensor(0.9687, device='cuda:1')
compute_distance is  tensor(180.6266, device='cuda:1')
compute_norm is  tensor(60.6119, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(182.5980, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.0267343484262414
avg test loss is  1.7762456570607004
avg accuracy is  0.18183333348966874
solo acc is  0.23171666682300437
compute similarity  is  tensor(0.9685, device='cuda:1')
compute_distance is  tensor(182.5980, device='cuda:1')
compute_norm is  tensor(60.1768, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(182.6054, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.6298604740389883
avg test loss is  2.583782145209404
avg accuracy is  0.1429333334896659
solo acc is  0.10851666682299863
compute similarity  is  tensor(0.9684, device='cuda:1')
compute_distance is  tensor(182.6054, device='cuda:1')
compute_norm is  tensor(59.9752, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(183.8997, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  1.0600820195191958
avg test loss is  1.6818751226356035
avg accuracy is  0.1780833334896685
solo acc is  0.1960333334896695
compute similarity  is  tensor(0.9681, device='cuda:1')
compute_distance is  tensor(183.8997, device='cuda:1')
compute_norm is  tensor(59.6028, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(183.8324, device='cuda:1')
distance x is tensor(183.8324, device='cuda:1')
________________________________
test distance is  tensor(183.8324, device='cuda:1')
test distance1 is  tensor(183.8324, device='cuda:1')
test similarity is  tensor(0.9679, device='cuda:1')
test acc is  0.10501666682299862
test loss is 2.4583064522316205
test entropy is  0.613204908968289
________________________________
cal ratio is  0.9703427048925363
distance x is tensor(178.3815, device='cuda:1')
cal_distance is  tensor(178.3815, device='cuda:1')
distance x is tensor(178.3815, device='cuda:1')
return_distance is  tensor(178.3815, device='cuda:1')
distance x is tensor(178.3804, device='cuda:1')
distance x is tensor(178.3804, device='cuda:1')
________________________________
test distance is  tensor(178.3804, device='cuda:1')
test distance1 is  tensor(178.3804, device='cuda:1')
test similarity is  tensor(0.9696, device='cuda:1')
test acc is  0.10473333348966529
test loss is 2.4372689241031087
test entropy is  0.6338437745438964
________________________________
0
distance x is tensor(178.3804, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.6335803915951044
avg test loss is  2.440438576344488
avg accuracy is  0.14233333348966584
solo acc is  0.10475000015633197
compute similarity  is  tensor(0.9696, device='cuda:1')
compute_distance is  tensor(178.3804, device='cuda:1')
compute_norm is  tensor(59.2019, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(179.8192, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.0002655911801466
avg test loss is  1.6003318183711852
avg accuracy is  0.18063333348966867
solo acc is  0.21355000015633696
compute similarity  is  tensor(0.9693, device='cuda:1')
compute_distance is  tensor(179.8192, device='cuda:1')
compute_norm is  tensor(58.8629, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(179.9275, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.6129753283981575
avg test loss is  2.3454414726828716
avg accuracy is  0.1450166668229994
solo acc is  0.10395000015633196
compute similarity  is  tensor(0.9691, device='cuda:1')
compute_distance is  tensor(179.9275, device='cuda:1')
compute_norm is  tensor(58.6475, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(181.1978, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8799166042032018
avg test loss is  1.4919565996127342
avg accuracy is  0.19741666682300293
solo acc is  0.2796666668230057
compute similarity  is  tensor(0.9687, device='cuda:1')
compute_distance is  tensor(181.1978, device='cuda:1')
compute_norm is  tensor(58.3204, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(181.1987, device='cuda:1')
________________________________
test distance is  tensor(181.1987, device='cuda:1')
test similarity is  tensor(0.9687, device='cuda:1')
test acc is  0.1955166668230028
test loss is 1.4895296033257361
test entropy is  0.8792361307627102
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.28700000016000005
mal loss is 1.4686637073755264
mal norm is  tensor(682.8813, device='cuda:1')
distance x is tensor(181.1987, device='cuda:1')
mal distance is  tensor(181.1987, device='cuda:1')
user_PLR len size 44
counter_tensor is  tensor([16., 39., 27., 34., 25., 18., 25., 29., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 13.,  0., 14., 14.,  2., 13., 12., 12.,
        42., 42.,  0., 43., 12., 43., 20., 12., 15., 13., 27., 13., 12., 12.,
        17., 12.])
count_res tensor([6.8237e-13, 6.6496e-03, 4.0857e-08, 4.4805e-05, 5.5293e-09, 5.0421e-12,
        5.5293e-09, 3.0189e-07, 6.0636e-06, 6.0636e-06, 6.0636e-06, 6.0636e-06,
        6.0636e-06, 6.0636e-06, 6.0636e-06, 6.0636e-06, 6.0636e-06, 6.0636e-06,
        6.0636e-06, 6.0636e-06, 3.3973e-14, 7.6791e-20, 9.2349e-14, 9.2349e-14,
        5.6741e-19, 3.3973e-14, 1.2498e-14, 1.2498e-14, 1.3356e-01, 1.3356e-01,
        7.6791e-20, 3.6306e-01, 1.2498e-14, 3.6306e-01, 3.7256e-11, 1.2498e-14,
        2.5103e-13, 3.3973e-14, 4.0857e-08, 3.3973e-14, 1.2498e-14, 1.2498e-14,
        1.8549e-12, 1.2498e-14])
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 71.67% 

Test Accuracy: 81.56% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7118910029530525
distance x is tensor(114.3973, device='cuda:1')
benign distance is  tensor(114.3973, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3365285396575928
distance x is tensor(105.5794, device='cuda:1')
benign distance is  tensor(105.5794, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.067329902201891
distance x is tensor(82.6403, device='cuda:1')
benign distance is  tensor(82.6403, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1126874648034573
distance x is tensor(156.7151, device='cuda:1')
benign distance is  tensor(156.7151, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.173228831961751
distance x is tensor(107.1655, device='cuda:1')
benign distance is  tensor(107.1655, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9695299807935953
distance x is tensor(114.4512, device='cuda:1')
benign distance is  tensor(114.4512, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.71696188300848
distance x is tensor(118.6997, device='cuda:1')
benign distance is  tensor(118.6997, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1881906315684319
distance x is tensor(84.0394, device='cuda:1')
benign distance is  tensor(84.0394, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.3011446855962276
distance x is tensor(103.0747, device='cuda:1')
benign distance is  tensor(103.0747, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.0330459512770176
distance x is tensor(136.2610, device='cuda:1')
benign distance is  tensor(136.2610, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.3219969794154167
distance x is tensor(93.7066, device='cuda:1')
benign distance is  tensor(93.7066, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.0216716527938843
distance x is tensor(101.7336, device='cuda:1')
benign distance is  tensor(101.7336, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.5279132835566998
distance x is tensor(176.2320, device='cuda:1')
benign distance is  tensor(176.2320, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.1452394425868988
distance x is tensor(68.5697, device='cuda:1')
benign distance is  tensor(68.5697, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.424315970391035
distance x is tensor(151.6142, device='cuda:1')
benign distance is  tensor(151.6142, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.7310829758644104
distance x is tensor(126.5956, device='cuda:1')
benign distance is  tensor(126.5956, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.5718051306903362
distance x is tensor(111.8687, device='cuda:1')
benign distance is  tensor(111.8687, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.3829923421144485
distance x is tensor(98.5999, device='cuda:1')
benign distance is  tensor(98.5999, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.1639693714678288
distance x is tensor(124.5909, device='cuda:1')
benign distance is  tensor(124.5909, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.480432912707329
distance x is tensor(106.5066, device='cuda:1')
benign distance is  tensor(106.5066, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.8267107252031565
distance x is tensor(123.2472, device='cuda:1')
benign distance is  tensor(123.2472, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.9898812230676413
distance x is tensor(115.9163, device='cuda:1')
benign distance is  tensor(115.9163, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5662018181756139
distance x is tensor(115.1265, device='cuda:1')
benign distance is  tensor(115.1265, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.2657457329332829
distance x is tensor(163.4783, device='cuda:1')
benign distance is  tensor(163.4783, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.9313854277133942
distance x is tensor(126.4018, device='cuda:1')
benign distance is  tensor(126.4018, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.0685399696230888
distance x is tensor(100.5613, device='cuda:1')
benign distance is  tensor(100.5613, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.2170746363699436
distance x is tensor(145.8979, device='cuda:1')
benign distance is  tensor(145.8979, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.793140210211277
distance x is tensor(118.5371, device='cuda:1')
benign distance is  tensor(118.5371, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.8329152073711157
distance x is tensor(117.1578, device='cuda:1')
benign distance is  tensor(117.1578, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.103374820202589
distance x is tensor(73.5209, device='cuda:1')
benign distance is  tensor(73.5209, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.0990218110382557
distance x is tensor(94.3120, device='cuda:1')
benign distance is  tensor(94.3120, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7724053766578436
distance x is tensor(124.8425, device='cuda:1')
benign distance is  tensor(124.8425, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(79.9284, device='cuda:1')
compute distance is  tensor(79.9284, device='cuda:1')
compute norm is  tensor(52.1974, device='cuda:1', dtype=torch.float64)
distance x is tensor(153.7449, device='cuda:1')
compute distance is  tensor(153.7449, device='cuda:1')
compute norm is  tensor(53.1731, device='cuda:1', dtype=torch.float64)
distance x is tensor(106.4821, device='cuda:1')
compute distance is  tensor(106.4821, device='cuda:1')
compute norm is  tensor(52.3723, device='cuda:1', dtype=torch.float64)
distance x is tensor(111.1236, device='cuda:1')
compute distance is  tensor(111.1236, device='cuda:1')
compute norm is  tensor(52.5001, device='cuda:1', dtype=torch.float64)
distance x is tensor(94.1037, device='cuda:1')
compute distance is  tensor(94.1037, device='cuda:1')
compute norm is  tensor(52.1729, device='cuda:1', dtype=torch.float64)
distance x is tensor(121.0905, device='cuda:1')
compute distance is  tensor(121.0905, device='cuda:1')
compute norm is  tensor(52.7364, device='cuda:1', dtype=torch.float64)
distance x is tensor(127.7915, device='cuda:1')
compute distance is  tensor(127.7915, device='cuda:1')
compute norm is  tensor(52.9605, device='cuda:1', dtype=torch.float64)
distance x is tensor(91.4639, device='cuda:1')
compute distance is  tensor(91.4639, device='cuda:1')
compute norm is  tensor(52.1517, device='cuda:1', dtype=torch.float64)
distance x is tensor(145.1156, device='cuda:1')
compute distance is  tensor(145.1156, device='cuda:1')
compute norm is  tensor(53.2468, device='cuda:1', dtype=torch.float64)
distance x is tensor(119.5582, device='cuda:1')
compute distance is  tensor(119.5582, device='cuda:1')
compute norm is  tensor(52.7744, device='cuda:1', dtype=torch.float64)
distance x is tensor(119.7073, device='cuda:1')
compute distance is  tensor(119.7073, device='cuda:1')
compute norm is  tensor(52.5542, device='cuda:1', dtype=torch.float64)
distance x is tensor(145.1187, device='cuda:1')
compute distance is  tensor(145.1187, device='cuda:1')
compute norm is  tensor(53.6553, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(153.7449, device='cuda:1')
distance x is tensor(102027.0547, device='cuda:1')
distance x is tensor(102027.0547, device='cuda:1')
________________________________
test distance is  tensor(102027.0547, device='cuda:1')
test distance1 is  tensor(102027.0547, device='cuda:1')
test similarity is  tensor(0.2540, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107564466570054.4
test entropy is  0.0
________________________________
cal ratio is  0.03804246977140434
distance x is tensor(3881.3660, device='cuda:1')
cal_distance is  tensor(3881.3660, device='cuda:1')
cal ratio is  0.1950446688172705
distance x is tensor(757.0434, device='cuda:1')
cal_distance is  tensor(757.0434, device='cuda:1')
cal ratio is  0.44163755089529905
distance x is tensor(334.3413, device='cuda:1')
cal_distance is  tensor(334.3413, device='cuda:1')
cal ratio is  0.6645556192349498
distance x is tensor(222.1900, device='cuda:1')
cal_distance is  tensor(222.1900, device='cuda:1')
cal ratio is  0.8151999968009795
distance x is tensor(181.1301, device='cuda:1')
cal_distance is  tensor(181.1301, device='cuda:1')
cal ratio is  0.9028821447333477
distance x is tensor(163.5396, device='cuda:1')
cal_distance is  tensor(163.5396, device='cuda:1')
cal ratio is  0.9501998037986819
distance x is tensor(155.3955, device='cuda:1')
cal_distance is  tensor(155.3955, device='cuda:1')
cal ratio is  0.9747811952732237
distance x is tensor(151.4767, device='cuda:1')
cal_distance is  tensor(151.4767, device='cuda:1')
distance x is tensor(151.4767, device='cuda:1')
return_distance is  tensor(151.4767, device='cuda:1')
distance x is tensor(151.4676, device='cuda:1')
distance x is tensor(151.4676, device='cuda:1')
________________________________
test distance is  tensor(151.4676, device='cuda:1')
test distance1 is  tensor(151.4676, device='cuda:1')
test similarity is  tensor(0.9602, device='cuda:1')
test acc is  0.17490000015633494
test loss is 134.0430138594052
test entropy is  0.024707557927693198
________________________________
0
distance x is tensor(151.4676, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.02532844114786154
avg test loss is  134.00320693221428
avg accuracy is  0.4898833334896753
solo acc is  0.17308333348966815
compute similarity  is  tensor(0.9602, device='cuda:1')
compute_distance is  tensor(151.4676, device='cuda:1')
compute_norm is  tensor(55.0692, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(147.6203, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.000946765261164
avg test loss is  1.46885670896278
avg accuracy is  0.7732500001563266
solo acc is  0.32060000015633994
compute similarity  is  tensor(0.9571, device='cuda:1')
compute_distance is  tensor(147.6203, device='cuda:1')
compute_norm is  tensor(55.0590, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(149.8600, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.6119822965883243
avg test loss is  2.419851864833059
avg accuracy is  0.7568500001563276
solo acc is  0.11708333348966525
compute similarity  is  tensor(0.9564, device='cuda:1')
compute_distance is  tensor(149.8600, device='cuda:1')
compute_norm is  tensor(54.8008, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(150.9569, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.954400296785684
avg test loss is  1.3939648435822427
avg accuracy is  0.7880833334896592
solo acc is  0.30466666682300625
compute similarity  is  tensor(0.9564, device='cuda:1')
compute_distance is  tensor(150.9569, device='cuda:1')
compute_norm is  tensor(54.5077, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(150.9569, device='cuda:1')
distance x is tensor(150.9569, device='cuda:1')
________________________________
test distance is  tensor(150.9569, device='cuda:1')
test distance1 is  tensor(150.9569, device='cuda:1')
test similarity is  tensor(0.9564, device='cuda:1')
test acc is  0.30610000015633965
test loss is 1.3915822046524935
test entropy is  0.9536400921563349
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3170000001600001
mal loss is 1.4347383715212345
mal norm is  tensor(765.5192, device='cuda:1')
distance x is tensor(150.9657, device='cuda:1')
mal distance is  tensor(150.9657, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([12., 12., 12., 13.,  0., 12., 12., 26., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 16., 12., 12., 27., 12., 25., 12., 13.])
count_res tensor([2.0347e-07, 2.0347e-07, 2.0347e-07, 5.5309e-07, 1.2502e-12, 2.0347e-07,
        2.0347e-07, 2.4469e-01, 1.1109e-05, 1.1109e-05, 1.1109e-05, 1.1109e-05,
        1.1109e-05, 1.1109e-05, 1.1109e-05, 1.1109e-05, 1.1109e-05, 1.1109e-05,
        1.1109e-05, 1.1109e-05, 1.1109e-05, 2.0347e-07, 2.0347e-07, 6.6514e-01,
        2.0347e-07, 9.0017e-02, 2.0347e-07, 5.5309e-07])
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 60.05% 

Test Accuracy: 75.73% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8859852086752653
distance x is tensor(120.9855, device='cuda:1')
benign distance is  tensor(120.9855, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3907747715711594
distance x is tensor(97.4470, device='cuda:1')
benign distance is  tensor(97.4470, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.443066518753767
distance x is tensor(88.7259, device='cuda:1')
benign distance is  tensor(88.7259, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.697948731482029
distance x is tensor(150.0400, device='cuda:1')
benign distance is  tensor(150.0400, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.5087470225989819
distance x is tensor(108.4633, device='cuda:1')
benign distance is  tensor(108.4633, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0860772337764502
distance x is tensor(107.8699, device='cuda:1')
benign distance is  tensor(107.8699, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.0388392582535744
distance x is tensor(101.1250, device='cuda:1')
benign distance is  tensor(101.1250, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9877474382519722
distance x is tensor(89.1408, device='cuda:1')
benign distance is  tensor(89.1408, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.7627108916640282
distance x is tensor(95.3342, device='cuda:1')
benign distance is  tensor(95.3342, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.1253492422401905
distance x is tensor(118.1252, device='cuda:1')
benign distance is  tensor(118.1252, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.8269038498401642
distance x is tensor(113.6038, device='cuda:1')
benign distance is  tensor(113.6038, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.7478131353855133
distance x is tensor(99.4347, device='cuda:1')
benign distance is  tensor(99.4347, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.3111467957496643
distance x is tensor(93.7659, device='cuda:1')
benign distance is  tensor(93.7659, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.9385641291737556
distance x is tensor(201.0044, device='cuda:1')
benign distance is  tensor(201.0044, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.4732855223119259
distance x is tensor(137.7028, device='cuda:1')
benign distance is  tensor(137.7028, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.2600875869393349
distance x is tensor(119.2903, device='cuda:1')
benign distance is  tensor(119.2903, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(78.6165, device='cuda:1')
compute distance is  tensor(78.6165, device='cuda:1')
compute norm is  tensor(53.0713, device='cuda:1', dtype=torch.float64)
distance x is tensor(139.7856, device='cuda:1')
compute distance is  tensor(139.7856, device='cuda:1')
compute norm is  tensor(53.9163, device='cuda:1', dtype=torch.float64)
distance x is tensor(104.1852, device='cuda:1')
compute distance is  tensor(104.1852, device='cuda:1')
compute norm is  tensor(53.2254, device='cuda:1', dtype=torch.float64)
distance x is tensor(99.3802, device='cuda:1')
compute distance is  tensor(99.3802, device='cuda:1')
compute norm is  tensor(53.2106, device='cuda:1', dtype=torch.float64)
distance x is tensor(96.9008, device='cuda:1')
compute distance is  tensor(96.9008, device='cuda:1')
compute norm is  tensor(53.1422, device='cuda:1', dtype=torch.float64)
distance x is tensor(110.8428, device='cuda:1')
compute distance is  tensor(110.8428, device='cuda:1')
compute norm is  tensor(53.5844, device='cuda:1', dtype=torch.float64)
distance x is tensor(122.7219, device='cuda:1')
compute distance is  tensor(122.7219, device='cuda:1')
compute norm is  tensor(53.5942, device='cuda:1', dtype=torch.float64)
distance x is tensor(96.0735, device='cuda:1')
compute distance is  tensor(96.0735, device='cuda:1')
compute norm is  tensor(53.1549, device='cuda:1', dtype=torch.float64)
distance x is tensor(123.9046, device='cuda:1')
compute distance is  tensor(123.9046, device='cuda:1')
compute norm is  tensor(53.6357, device='cuda:1', dtype=torch.float64)
distance x is tensor(90.1380, device='cuda:1')
compute distance is  tensor(90.1380, device='cuda:1')
compute norm is  tensor(53.2866, device='cuda:1', dtype=torch.float64)
distance x is tensor(116.5223, device='cuda:1')
compute distance is  tensor(116.5223, device='cuda:1')
compute norm is  tensor(53.5006, device='cuda:1', dtype=torch.float64)
distance x is tensor(146.0377, device='cuda:1')
compute distance is  tensor(146.0377, device='cuda:1')
compute norm is  tensor(54.4679, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(146.0377, device='cuda:1')
distance x is tensor(102038.0078, device='cuda:1')
distance x is tensor(102038.0078, device='cuda:1')
________________________________
test distance is  tensor(102038.0078, device='cuda:1')
test distance1 is  tensor(102038.0078, device='cuda:1')
test similarity is  tensor(0.2368, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107544863546815.6
test entropy is  0.0
________________________________
cal ratio is  0.0370746909656984
distance x is tensor(3783.0334, device='cuda:1')
cal_distance is  tensor(3783.0334, device='cuda:1')
cal ratio is  0.1925477415997265
distance x is tensor(728.4182, device='cuda:1')
cal_distance is  tensor(728.4182, device='cuda:1')
cal ratio is  0.4388015514027195
distance x is tensor(319.6336, device='cuda:1')
cal_distance is  tensor(319.6336, device='cuda:1')
cal ratio is  0.6624183200921203
distance x is tensor(211.7327, device='cuda:1')
cal_distance is  tensor(211.7327, device='cuda:1')
cal ratio is  0.8138878060629509
distance x is tensor(172.3275, device='cuda:1')
cal_distance is  tensor(172.3275, device='cuda:1')
cal ratio is  0.9021550460940063
distance x is tensor(155.4666, device='cuda:1')
cal_distance is  tensor(155.4666, device='cuda:1')
cal ratio is  0.9498170838563885
distance x is tensor(147.6651, device='cuda:1')
cal_distance is  tensor(147.6651, device='cuda:1')
cal ratio is  0.974584768775893
distance x is tensor(143.9123, device='cuda:1')
cal_distance is  tensor(143.9123, device='cuda:1')
distance x is tensor(143.9123, device='cuda:1')
return_distance is  tensor(143.9123, device='cuda:1')
distance x is tensor(143.9031, device='cuda:1')
distance x is tensor(143.9031, device='cuda:1')
________________________________
test distance is  tensor(143.9031, device='cuda:1')
test distance1 is  tensor(143.9031, device='cuda:1')
test similarity is  tensor(0.9641, device='cuda:1')
test acc is  0.12928333348966525
test loss is 122.94143751587696
test entropy is  0.014367053329414039
________________________________
0
distance x is tensor(143.9031, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.013868696199871992
avg test loss is  122.89753824815567
avg accuracy is  0.47043333348967514
solo acc is  0.12968333348966524
compute similarity  is  tensor(0.9641, device='cuda:1')
compute_distance is  tensor(143.9031, device='cuda:1')
compute_norm is  tensor(55.6550, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(145.1648, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9855784725532857
avg test loss is  1.5235470956576658
avg accuracy is  0.7602166668229939
solo acc is  0.2978333334896727
compute similarity  is  tensor(0.9640, device='cuda:1')
compute_distance is  tensor(145.1648, device='cuda:1')
compute_norm is  tensor(55.5895, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(145.1648, device='cuda:1')
distance x is tensor(145.1648, device='cuda:1')
________________________________
test distance is  tensor(145.1648, device='cuda:1')
test distance1 is  tensor(145.1648, device='cuda:1')
test similarity is  tensor(0.9640, device='cuda:1')
test acc is  0.2953333334896729
test loss is 1.5234160654580415
test entropy is  0.9846513893431438
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.29500000016000005
mal loss is 1.5079481080174446
mal norm is  tensor(710.1782, device='cuda:1')
distance x is tensor(145.1729, device='cuda:1')
mal distance is  tensor(145.1729, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([13., 12., 12., 12., 26., 17., 12., 13., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 15.,  0., 12., 27., 14., 12., 19., 12.])
count_res tensor([6.0763e-07, 2.2354e-07, 2.2354e-07, 2.2354e-07, 2.6882e-01, 3.3176e-05,
        2.2354e-07, 6.0763e-07, 1.2205e-05, 1.2205e-05, 1.2205e-05, 1.2205e-05,
        1.2205e-05, 1.2205e-05, 1.2205e-05, 1.2205e-05, 1.2205e-05, 1.2205e-05,
        1.2205e-05, 1.2205e-05, 4.4898e-06, 1.3734e-12, 2.2354e-07, 7.3074e-01,
        1.6517e-06, 2.2354e-07, 2.4514e-04, 2.2354e-07])
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 65.03% 

Test Accuracy: 78.40% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7756087463349104
distance x is tensor(114.1262, device='cuda:1')
benign distance is  tensor(114.1262, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2160844579339027
distance x is tensor(108.3836, device='cuda:1')
benign distance is  tensor(108.3836, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.193972572684288
distance x is tensor(96.7032, device='cuda:1')
benign distance is  tensor(96.7032, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.518859926611185
distance x is tensor(155.9315, device='cuda:1')
benign distance is  tensor(155.9315, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.9016969092190266
distance x is tensor(105.5345, device='cuda:1')
benign distance is  tensor(105.5345, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9411972146481276
distance x is tensor(111.0864, device='cuda:1')
benign distance is  tensor(111.0864, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.999650999903679
distance x is tensor(117.0655, device='cuda:1')
benign distance is  tensor(117.0655, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1048127673566341
distance x is tensor(90.6117, device='cuda:1')
benign distance is  tensor(90.6117, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.3334101773798466
distance x is tensor(108.9812, device='cuda:1')
benign distance is  tensor(108.9812, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.8594433255493641
distance x is tensor(123.9620, device='cuda:1')
benign distance is  tensor(123.9620, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.3970410600304604
distance x is tensor(81.9958, device='cuda:1')
benign distance is  tensor(81.9958, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  1.7624517418444157
distance x is tensor(87.4959, device='cuda:1')
benign distance is  tensor(87.4959, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.4916746281087399
distance x is tensor(168.4559, device='cuda:1')
benign distance is  tensor(168.4559, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.8576871305704117
distance x is tensor(72.3605, device='cuda:1')
benign distance is  tensor(72.3605, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.8130551055073738
distance x is tensor(141.9590, device='cuda:1')
benign distance is  tensor(141.9590, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.273641161620617
distance x is tensor(121.9120, device='cuda:1')
benign distance is  tensor(121.9120, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(82.7876, device='cuda:1')
compute distance is  tensor(82.7876, device='cuda:1')
compute norm is  tensor(52.7985, device='cuda:1', dtype=torch.float64)
distance x is tensor(136.4216, device='cuda:1')
compute distance is  tensor(136.4216, device='cuda:1')
compute norm is  tensor(53.7974, device='cuda:1', dtype=torch.float64)
distance x is tensor(107.7714, device='cuda:1')
compute distance is  tensor(107.7714, device='cuda:1')
compute norm is  tensor(53.0389, device='cuda:1', dtype=torch.float64)
distance x is tensor(97.4681, device='cuda:1')
compute distance is  tensor(97.4681, device='cuda:1')
compute norm is  tensor(53.0960, device='cuda:1', dtype=torch.float64)
distance x is tensor(90.1349, device='cuda:1')
compute distance is  tensor(90.1349, device='cuda:1')
compute norm is  tensor(52.8762, device='cuda:1', dtype=torch.float64)
distance x is tensor(117.8753, device='cuda:1')
compute distance is  tensor(117.8753, device='cuda:1')
compute norm is  tensor(53.3367, device='cuda:1', dtype=torch.float64)
distance x is tensor(123.9245, device='cuda:1')
compute distance is  tensor(123.9245, device='cuda:1')
compute norm is  tensor(53.3711, device='cuda:1', dtype=torch.float64)
distance x is tensor(106.3791, device='cuda:1')
compute distance is  tensor(106.3791, device='cuda:1')
compute norm is  tensor(52.9544, device='cuda:1', dtype=torch.float64)
distance x is tensor(143.0670, device='cuda:1')
compute distance is  tensor(143.0670, device='cuda:1')
compute norm is  tensor(53.6317, device='cuda:1', dtype=torch.float64)
distance x is tensor(112.0925, device='cuda:1')
compute distance is  tensor(112.0925, device='cuda:1')
compute norm is  tensor(53.2524, device='cuda:1', dtype=torch.float64)
distance x is tensor(119.6791, device='cuda:1')
compute distance is  tensor(119.6791, device='cuda:1')
compute norm is  tensor(53.2456, device='cuda:1', dtype=torch.float64)
distance x is tensor(151.7032, device='cuda:1')
compute distance is  tensor(151.7032, device='cuda:1')
compute norm is  tensor(54.2640, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(151.7032, device='cuda:1')
distance x is tensor(102031.7578, device='cuda:1')
distance x is tensor(102031.7578, device='cuda:1')
________________________________
test distance is  tensor(102031.7578, device='cuda:1')
test distance1 is  tensor(102031.7578, device='cuda:1')
test similarity is  tensor(0.2412, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107578586198129.53
test entropy is  0.0
________________________________
cal ratio is  0.0377881639202273
distance x is tensor(3855.5981, device='cuda:1')
cal_distance is  tensor(3855.5981, device='cuda:1')
cal ratio is  0.19439164449579122
distance x is tensor(749.4997, device='cuda:1')
cal_distance is  tensor(749.4997, device='cuda:1')
cal ratio is  0.44089760453858706
distance x is tensor(330.4552, device='cuda:1')
cal_distance is  tensor(330.4552, device='cuda:1')
cal ratio is  0.6639986249833347
distance x is tensor(219.4234, device='cuda:1')
cal_distance is  tensor(219.4234, device='cuda:1')
cal ratio is  0.8148581938007491
distance x is tensor(178.7998, device='cuda:1')
cal_distance is  tensor(178.7998, device='cuda:1')
cal ratio is  0.9026928706942696
distance x is tensor(161.4017, device='cuda:1')
cal_distance is  tensor(161.4017, device='cuda:1')
cal ratio is  0.9501002144408077
distance x is tensor(153.3480, device='cuda:1')
cal_distance is  tensor(153.3480, device='cuda:1')
cal ratio is  0.9747300442103072
distance x is tensor(149.4731, device='cuda:1')
cal_distance is  tensor(149.4731, device='cuda:1')
distance x is tensor(149.4731, device='cuda:1')
return_distance is  tensor(149.4731, device='cuda:1')
distance x is tensor(149.4640, device='cuda:1')
distance x is tensor(149.4640, device='cuda:1')
________________________________
test distance is  tensor(149.4640, device='cuda:1')
test distance1 is  tensor(149.4640, device='cuda:1')
test similarity is  tensor(0.9616, device='cuda:1')
test acc is  0.11263333348966527
test loss is 203.79799600044038
test entropy is  0.004695620895710165
________________________________
0
distance x is tensor(149.4640, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.004477591800035545
avg test loss is  203.064545328429
avg accuracy is  0.4280666668230081
solo acc is  0.11360000015633194
compute similarity  is  tensor(0.9616, device='cuda:1')
compute_distance is  tensor(149.4640, device='cuda:1')
compute_norm is  tensor(55.6471, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(170.0830, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.0602902385598816
avg test loss is  1.6156864111611584
avg accuracy is  0.6656166668229994
solo acc is  0.26791666682300547
compute similarity  is  tensor(0.9544, device='cuda:1')
compute_distance is  tensor(170.0830, device='cuda:1')
compute_norm is  tensor(56.8488, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(171.5728, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.6505686926053785
avg test loss is  2.5209284596351673
avg accuracy is  0.6574666668229999
solo acc is  0.1117666668229986
compute similarity  is  tensor(0.9537, device='cuda:1')
compute_distance is  tensor(171.5728, device='cuda:1')
compute_norm is  tensor(56.6115, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(172.9922, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.9805466403712088
avg test loss is  1.5148437287507535
avg accuracy is  0.6797666668229985
solo acc is  0.2690500001563388
compute similarity  is  tensor(0.9535, device='cuda:1')
compute_distance is  tensor(172.9922, device='cuda:1')
compute_norm is  tensor(56.2884, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(172.9922, device='cuda:1')
distance x is tensor(172.9922, device='cuda:1')
________________________________
test distance is  tensor(172.9922, device='cuda:1')
test distance1 is  tensor(172.9922, device='cuda:1')
test similarity is  tensor(0.9535, device='cuda:1')
test acc is  0.27116666682300555
test loss is 1.509899369816282
test entropy is  0.9811205876661516
________________________________
cal ratio is  0.9177201157216566
distance x is tensor(158.7646, device='cuda:1')
cal_distance is  tensor(158.7646, device='cuda:1')
cal ratio is  0.9579583138000235
distance x is tensor(152.0900, device='cuda:1')
cal_distance is  tensor(152.0900, device='cuda:1')
cal ratio is  0.9787530332886133
distance x is tensor(148.8586, device='cuda:1')
cal_distance is  tensor(148.8586, device='cuda:1')
distance x is tensor(148.8586, device='cuda:1')
return_distance is  tensor(148.8586, device='cuda:1')
distance x is tensor(148.8521, device='cuda:1')
distance x is tensor(148.8521, device='cuda:1')
________________________________
test distance is  tensor(148.8521, device='cuda:1')
test distance1 is  tensor(148.8521, device='cuda:1')
test similarity is  tensor(0.9645, device='cuda:1')
test acc is  0.4544666668230084
test loss is 1.215764207690001
test entropy is  1.1320539027261836
________________________________
0
distance x is tensor(148.8521, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.1292077349955594
avg test loss is  1.2171885427762705
avg accuracy is  0.6905333334896646
solo acc is  0.45490000015634163
compute similarity  is  tensor(0.9645, device='cuda:1')
compute_distance is  tensor(148.8521, device='cuda:1')
compute_norm is  tensor(55.4259, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(151.2303, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.609078093473591
avg test loss is  2.4091209489653616
avg accuracy is  0.6916666668229978
solo acc is  0.11228333348966527
compute similarity  is  tensor(0.9636, device='cuda:1')
compute_distance is  tensor(151.2303, device='cuda:1')
compute_norm is  tensor(55.2057, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(152.9937, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.9375995030916576
avg test loss is  1.4497688787578265
avg accuracy is  0.7077833334896636
solo acc is  0.2711500001563389
compute similarity  is  tensor(0.9633, device='cuda:1')
compute_distance is  tensor(152.9937, device='cuda:1')
compute_norm is  tensor(54.8906, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(152.9937, device='cuda:1')
distance x is tensor(152.9937, device='cuda:1')
________________________________
test distance is  tensor(152.9937, device='cuda:1')
test distance1 is  tensor(152.9937, device='cuda:1')
test similarity is  tensor(0.9633, device='cuda:1')
test acc is  0.2717166668230055
test loss is 1.4491147989911566
test entropy is  0.9376757631042619
________________________________
cal ratio is  0.9758582678790031
distance x is tensor(149.3063, device='cuda:1')
cal_distance is  tensor(149.3063, device='cuda:1')
distance x is tensor(149.3063, device='cuda:1')
return_distance is  tensor(149.3063, device='cuda:1')
distance x is tensor(149.3001, device='cuda:1')
distance x is tensor(149.3001, device='cuda:1')
________________________________
test distance is  tensor(149.3001, device='cuda:1')
test distance1 is  tensor(149.3001, device='cuda:1')
test similarity is  tensor(0.9649, device='cuda:1')
test acc is  0.3139666668230065
test loss is 1.3737300319839387
test entropy is  0.9714498527522789
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.30400000016000006
mal loss is 1.3737895712256432
mal norm is  tensor(670.5681, device='cuda:1')
distance x is tensor(149.3063, device='cuda:1')
mal distance is  tensor(149.3063, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 36.86% 

Test Accuracy: 32.69% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8689843285828829
distance x is tensor(196.4536, device='cuda:1')
benign distance is  tensor(196.4536, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3405980728566647
distance x is tensor(164.6675, device='cuda:1')
benign distance is  tensor(164.6675, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.9180405400693417
distance x is tensor(179.8063, device='cuda:1')
benign distance is  tensor(179.8063, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.8008386194705963
distance x is tensor(204.7055, device='cuda:1')
benign distance is  tensor(204.7055, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.0307082012295723
distance x is tensor(178.5930, device='cuda:1')
benign distance is  tensor(178.5930, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.405378520488739
distance x is tensor(173.0205, device='cuda:1')
benign distance is  tensor(173.0205, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.7171868458390236
distance x is tensor(151.3057, device='cuda:1')
benign distance is  tensor(151.3057, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2636764273047447
distance x is tensor(148.3901, device='cuda:1')
benign distance is  tensor(148.3901, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(147.4960, device='cuda:1')
compute distance is  tensor(147.4960, device='cuda:1')
compute norm is  tensor(56.0714, device='cuda:1', dtype=torch.float64)
distance x is tensor(189.5854, device='cuda:1')
compute distance is  tensor(189.5854, device='cuda:1')
compute norm is  tensor(57.0598, device='cuda:1', dtype=torch.float64)
distance x is tensor(154.6337, device='cuda:1')
compute distance is  tensor(154.6337, device='cuda:1')
compute norm is  tensor(55.9763, device='cuda:1', dtype=torch.float64)
distance x is tensor(171.1974, device='cuda:1')
compute distance is  tensor(171.1974, device='cuda:1')
compute norm is  tensor(56.7842, device='cuda:1', dtype=torch.float64)
distance x is tensor(144.8419, device='cuda:1')
compute distance is  tensor(144.8419, device='cuda:1')
compute norm is  tensor(56.0688, device='cuda:1', dtype=torch.float64)
distance x is tensor(152.8672, device='cuda:1')
compute distance is  tensor(152.8672, device='cuda:1')
compute norm is  tensor(56.0278, device='cuda:1', dtype=torch.float64)
distance x is tensor(182.2906, device='cuda:1')
compute distance is  tensor(182.2906, device='cuda:1')
compute norm is  tensor(56.8170, device='cuda:1', dtype=torch.float64)
distance x is tensor(145.0030, device='cuda:1')
compute distance is  tensor(145.0030, device='cuda:1')
compute norm is  tensor(56.2043, device='cuda:1', dtype=torch.float64)
distance x is tensor(165.1789, device='cuda:1')
compute distance is  tensor(165.1789, device='cuda:1')
compute norm is  tensor(56.3818, device='cuda:1', dtype=torch.float64)
distance x is tensor(162.1319, device='cuda:1')
compute distance is  tensor(162.1319, device='cuda:1')
compute norm is  tensor(56.4350, device='cuda:1', dtype=torch.float64)
distance x is tensor(192.5947, device='cuda:1')
compute distance is  tensor(192.5947, device='cuda:1')
compute norm is  tensor(57.1085, device='cuda:1', dtype=torch.float64)
distance x is tensor(271.6685, device='cuda:1')
compute distance is  tensor(271.6685, device='cuda:1')
compute norm is  tensor(62.5997, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(271.6685, device='cuda:1')
distance x is tensor(101951.9219, device='cuda:1')
distance x is tensor(101951.9219, device='cuda:1')
________________________________
test distance is  tensor(101951.9219, device='cuda:1')
test distance1 is  tensor(101951.9219, device='cuda:1')
test similarity is  tensor(0.4243, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107539554398601.0
test entropy is  0.0
________________________________
cal ratio is  0.05058806046979901
distance x is tensor(5157.5547, device='cuda:1')
cal_distance is  tensor(5157.5547, device='cuda:1')
cal ratio is  0.22491778998393588
distance x is tensor(1160.0294, device='cuda:1')
cal_distance is  tensor(1160.0294, device='cuda:1')
cal ratio is  0.47425425046867076
distance x is tensor(550.1513, device='cuda:1')
cal_distance is  tensor(550.1513, device='cuda:1')
cal ratio is  0.6886596731402123
distance x is tensor(378.8684, device='cuda:1')
cal_distance is  tensor(378.8684, device='cuda:1')
cal ratio is  0.829853676901965
distance x is tensor(314.4061, device='cuda:1')
cal_distance is  tensor(314.4061, device='cuda:1')
cal ratio is  0.9109619224768554
distance x is tensor(286.4124, device='cuda:1')
cal_distance is  tensor(286.4124, device='cuda:1')
cal ratio is  0.9544425982509667
distance x is tensor(273.3644, device='cuda:1')
cal_distance is  tensor(273.3644, device='cuda:1')
cal ratio is  0.9769554230770886
distance x is tensor(267.0649, device='cuda:1')
cal_distance is  tensor(267.0649, device='cuda:1')
distance x is tensor(267.0649, device='cuda:1')
return_distance is  tensor(267.0649, device='cuda:1')
distance x is tensor(267.0559, device='cuda:1')
distance x is tensor(267.0559, device='cuda:1')
________________________________
test distance is  tensor(267.0559, device='cuda:1')
test distance1 is  tensor(267.0559, device='cuda:1')
test similarity is  tensor(0.9312, device='cuda:1')
test acc is  0.10000000015633198
test loss is 4592.679421756313
test entropy is  0.0
________________________________
0
distance x is tensor(267.0559, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  4594.831341773971
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9312, device='cuda:1')
compute_distance is  tensor(267.0559, device='cuda:1')
compute_norm is  tensor(64.8211, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(9446.6504, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.5480307124570998
avg test loss is  2.8846474380127147
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0526, device='cuda:1')
compute_distance is  tensor(9446.6504, device='cuda:1')
compute_norm is  tensor(769.3883, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(9402.6689, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8406406385557992
avg test loss is  3.6300150900761454
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0527, device='cuda:1')
compute_distance is  tensor(9402.6689, device='cuda:1')
compute_norm is  tensor(766.0595, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(9358.7588, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.55899174025318
avg test loss is  2.863060681804665
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0526, device='cuda:1')
compute_distance is  tensor(9358.7588, device='cuda:1')
compute_norm is  tensor(762.1533, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(9315.2090, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8434090344255158
avg test loss is  3.6166094015402073
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0527, device='cuda:1')
compute_distance is  tensor(9315.2090, device='cuda:1')
compute_norm is  tensor(758.8864, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(9271.7275, device='cuda:1')
distance x is tensor(9271.7275, device='cuda:1')
________________________________
test distance is  tensor(9271.7275, device='cuda:1')
test distance1 is  tensor(9271.7275, device='cuda:1')
test similarity is  tensor(0.0526, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.8644285662087805
test entropy is  1.5569503714026673
________________________________
cal ratio is  0.16775110808248492
distance x is tensor(1555.3417, device='cuda:1')
cal_distance is  tensor(1555.3417, device='cuda:1')
cal ratio is  0.4095744176903561
distance x is tensor(637.0276, device='cuda:1')
cal_distance is  tensor(637.0276, device='cuda:1')
cal ratio is  0.6399802793597467
distance x is tensor(407.6849, device='cuda:1')
cal_distance is  tensor(407.6849, device='cuda:1')
cal ratio is  0.7999878973939489
distance x is tensor(326.1429, device='cuda:1')
cal_distance is  tensor(326.1429, device='cuda:1')
cal ratio is  0.8944205560684642
distance x is tensor(291.7088, device='cuda:1')
cal_distance is  tensor(291.7088, device='cuda:1')
cal ratio is  0.9457382860922953
distance x is tensor(275.8802, device='cuda:1')
cal_distance is  tensor(275.8802, device='cuda:1')
cal ratio is  0.9724907435047744
distance x is tensor(268.2909, device='cuda:1')
cal_distance is  tensor(268.2909, device='cuda:1')
distance x is tensor(268.2909, device='cuda:1')
return_distance is  tensor(268.2909, device='cuda:1')
distance x is tensor(268.2924, device='cuda:1')
distance x is tensor(268.2924, device='cuda:1')
________________________________
test distance is  tensor(268.2924, device='cuda:1')
test distance1 is  tensor(268.2924, device='cuda:1')
test similarity is  tensor(0.8562, device='cuda:1')
test acc is  0.11331666682299861
test loss is 2.576074076613892
test entropy is  1.1443913725139236
________________________________
0
distance x is tensor(268.2924, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.1441352764553607
avg test loss is  2.5765376285449273
avg accuracy is  0.1995000001563363
solo acc is  0.11413333348966527
compute similarity  is  tensor(0.8562, device='cuda:1')
compute_distance is  tensor(268.2924, device='cuda:1')
compute_norm is  tensor(63.8237, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(268.6381, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.6374116707076904
avg test loss is  2.613778973947456
avg accuracy is  0.17028333348966798
solo acc is  0.10365000015633197
compute similarity  is  tensor(0.8563, device='cuda:1')
compute_distance is  tensor(268.6381, device='cuda:1')
compute_norm is  tensor(63.5934, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(270.3501, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.9715730313426142
avg test loss is  1.5987348465014621
avg accuracy is  0.2871166668230059
solo acc is  0.23385000015633775
compute similarity  is  tensor(0.8563, device='cuda:1')
compute_distance is  tensor(270.3501, device='cuda:1')
compute_norm is  tensor(63.2056, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(270.3501, device='cuda:1')
distance x is tensor(270.3501, device='cuda:1')
________________________________
test distance is  tensor(270.3501, device='cuda:1')
test distance1 is  tensor(270.3501, device='cuda:1')
test similarity is  tensor(0.8563, device='cuda:1')
test acc is  0.23451666682300437
test loss is 1.5955355060634329
test entropy is  0.9707672183574644
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2420000001600001
mal loss is 1.5489258542656898
mal norm is  tensor(1519.4766, device='cuda:1')
distance x is tensor(270.3477, device='cuda:1')
mal distance is  tensor(270.3477, device='cuda:1')
user_PLR len size 52
counter_tensor is  tensor([30., 39., 13., 35., 35., 38.,  2.,  0., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 12., 51.,  0., 51., 48., 45., 42.,  0.,
        15., 37., 13., 14., 16., 28., 24., 36., 12., 12., 13., 30., 48.,  1.,
        46., 12., 12., 14., 12., 12., 12., 44.,  0., 20.])
count_res tensor([3.5936e-10, 2.9119e-06, 1.4877e-17, 5.3333e-08, 5.3333e-08, 1.0712e-06,
        2.4847e-22, 3.3627e-23, 7.9154e-06, 7.9154e-06, 7.9154e-06, 7.9154e-06,
        7.9154e-06, 7.9154e-06, 7.9154e-06, 7.9154e-06, 7.9154e-06, 7.9154e-06,
        7.9154e-06, 7.9154e-06, 5.4730e-18, 4.7393e-01, 3.3627e-23, 4.7393e-01,
        2.3595e-02, 1.1747e-03, 5.8487e-05, 3.3627e-23, 1.0993e-16, 3.9408e-07,
        1.4877e-17, 4.0440e-17, 2.9882e-16, 4.8634e-11, 8.9076e-13, 1.4497e-07,
        5.4730e-18, 5.4730e-18, 1.4877e-17, 3.5936e-10, 2.3595e-02, 9.1408e-23,
        3.1933e-03, 5.4730e-18, 5.4730e-18, 4.0440e-17, 5.4730e-18, 5.4730e-18,
        5.4730e-18, 4.3216e-04, 3.3627e-23, 1.6315e-14])
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 67.57% 

Test Accuracy: 79.42% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8246800843626261
distance x is tensor(115.6042, device='cuda:1')
benign distance is  tensor(115.6042, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3534399904310703
distance x is tensor(109.9475, device='cuda:1')
benign distance is  tensor(109.9475, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.2151408568024635
distance x is tensor(94.5684, device='cuda:1')
benign distance is  tensor(94.5684, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.3378499932587147
distance x is tensor(148.8208, device='cuda:1')
benign distance is  tensor(148.8208, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.873774066567421
distance x is tensor(93.5853, device='cuda:1')
benign distance is  tensor(93.5853, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.134311843663454
distance x is tensor(103.7011, device='cuda:1')
benign distance is  tensor(103.7011, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4718189053237438
distance x is tensor(109.7090, device='cuda:1')
benign distance is  tensor(109.7090, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.4620342515408993
distance x is tensor(94.4399, device='cuda:1')
benign distance is  tensor(94.4399, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.707592036575079
distance x is tensor(82.9069, device='cuda:1')
benign distance is  tensor(82.9069, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.2678636740893126
distance x is tensor(129.6753, device='cuda:1')
benign distance is  tensor(129.6753, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.6653254106640816
distance x is tensor(90.3643, device='cuda:1')
benign distance is  tensor(90.3643, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.8877944201231003
distance x is tensor(109.2207, device='cuda:1')
benign distance is  tensor(109.2207, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.638836145401001
distance x is tensor(156.4788, device='cuda:1')
benign distance is  tensor(156.4788, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.331832479685545
distance x is tensor(72.3874, device='cuda:1')
benign distance is  tensor(72.3874, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.5438137017190456
distance x is tensor(141.3014, device='cuda:1')
benign distance is  tensor(141.3014, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.778337389230728
distance x is tensor(125.9432, device='cuda:1')
benign distance is  tensor(125.9432, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.0098195374011993
distance x is tensor(86.3678, device='cuda:1')
benign distance is  tensor(86.3678, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.2893538773059845
distance x is tensor(106.0671, device='cuda:1')
benign distance is  tensor(106.0671, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.3476175591349602
distance x is tensor(126.8123, device='cuda:1')
benign distance is  tensor(126.8123, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.6695981472730637
distance x is tensor(114.5615, device='cuda:1')
benign distance is  tensor(114.5615, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.2091637440025806
distance x is tensor(84.1502, device='cuda:1')
benign distance is  tensor(84.1502, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8650033473968506
distance x is tensor(193.0145, device='cuda:1')
benign distance is  tensor(193.0145, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.0802339054644108
distance x is tensor(159.4962, device='cuda:1')
benign distance is  tensor(159.4962, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.4959585182368755
distance x is tensor(116.6171, device='cuda:1')
benign distance is  tensor(116.6171, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.4259459972381592
distance x is tensor(119.6879, device='cuda:1')
benign distance is  tensor(119.6879, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.0440046340227127
distance x is tensor(93.7856, device='cuda:1')
benign distance is  tensor(93.7856, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.4056284837424755
distance x is tensor(129.3654, device='cuda:1')
benign distance is  tensor(129.3654, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.776832528412342
distance x is tensor(107.7746, device='cuda:1')
benign distance is  tensor(107.7746, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.3162979446351528
distance x is tensor(127.3177, device='cuda:1')
benign distance is  tensor(127.3177, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.5062930211424828
distance x is tensor(116.8308, device='cuda:1')
benign distance is  tensor(116.8308, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5613152664154768
distance x is tensor(114.4345, device='cuda:1')
benign distance is  tensor(114.4345, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.238558106124401
distance x is tensor(155.9791, device='cuda:1')
benign distance is  tensor(155.9791, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.421188212931156
distance x is tensor(105.0822, device='cuda:1')
benign distance is  tensor(105.0822, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  1.8089194484055042
distance x is tensor(105.2689, device='cuda:1')
benign distance is  tensor(105.2689, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.8014444038271904
distance x is tensor(133.8780, device='cuda:1')
benign distance is  tensor(133.8780, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.4345380179584026
distance x is tensor(82.4179, device='cuda:1')
benign distance is  tensor(82.4179, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.8592371139675379
distance x is tensor(151.4904, device='cuda:1')
benign distance is  tensor(151.4904, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.4820569455623627
distance x is tensor(136.3177, device='cuda:1')
benign distance is  tensor(136.3177, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.5412372834980488
distance x is tensor(102.8745, device='cuda:1')
benign distance is  tensor(102.8745, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6068422123789787
distance x is tensor(134.7491, device='cuda:1')
benign distance is  tensor(134.7491, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(88.0605, device='cuda:1')
compute distance is  tensor(88.0605, device='cuda:1')
compute norm is  tensor(53.0321, device='cuda:1', dtype=torch.float64)
distance x is tensor(135.1985, device='cuda:1')
compute distance is  tensor(135.1985, device='cuda:1')
compute norm is  tensor(53.9628, device='cuda:1', dtype=torch.float64)
distance x is tensor(105.6090, device='cuda:1')
compute distance is  tensor(105.6090, device='cuda:1')
compute norm is  tensor(53.3393, device='cuda:1', dtype=torch.float64)
distance x is tensor(93.8622, device='cuda:1')
compute distance is  tensor(93.8622, device='cuda:1')
compute norm is  tensor(53.2663, device='cuda:1', dtype=torch.float64)
distance x is tensor(91.5880, device='cuda:1')
compute distance is  tensor(91.5880, device='cuda:1')
compute norm is  tensor(53.0743, device='cuda:1', dtype=torch.float64)
distance x is tensor(111.8989, device='cuda:1')
compute distance is  tensor(111.8989, device='cuda:1')
compute norm is  tensor(53.6977, device='cuda:1', dtype=torch.float64)
distance x is tensor(123.5789, device='cuda:1')
compute distance is  tensor(123.5789, device='cuda:1')
compute norm is  tensor(53.6584, device='cuda:1', dtype=torch.float64)
distance x is tensor(103.1964, device='cuda:1')
compute distance is  tensor(103.1964, device='cuda:1')
compute norm is  tensor(53.1758, device='cuda:1', dtype=torch.float64)
distance x is tensor(119.5834, device='cuda:1')
compute distance is  tensor(119.5834, device='cuda:1')
compute norm is  tensor(53.6325, device='cuda:1', dtype=torch.float64)
distance x is tensor(113.4434, device='cuda:1')
compute distance is  tensor(113.4434, device='cuda:1')
compute norm is  tensor(53.6768, device='cuda:1', dtype=torch.float64)
distance x is tensor(114.3868, device='cuda:1')
compute distance is  tensor(114.3868, device='cuda:1')
compute norm is  tensor(53.4493, device='cuda:1', dtype=torch.float64)
distance x is tensor(152.2835, device='cuda:1')
compute distance is  tensor(152.2835, device='cuda:1')
compute norm is  tensor(54.5846, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(152.2835, device='cuda:1')
distance x is tensor(102038.6406, device='cuda:1')
distance x is tensor(102038.6406, device='cuda:1')
________________________________
test distance is  tensor(102038.6406, device='cuda:1')
test distance1 is  tensor(102038.6406, device='cuda:1')
test similarity is  tensor(0.2384, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107558941437541.53
test entropy is  0.0
________________________________
cal ratio is  0.03785908636499409
distance x is tensor(3863.0947, device='cuda:1')
cal_distance is  tensor(3863.0947, device='cuda:1')
cal ratio is  0.19457398885391045
distance x is tensor(751.6614, device='cuda:1')
cal_distance is  tensor(751.6614, device='cuda:1')
cal ratio is  0.4411043358403114
distance x is tensor(331.5637, device='cuda:1')
cal_distance is  tensor(331.5637, device='cuda:1')
cal ratio is  0.6641543262048
distance x is tensor(220.2110, device='cuda:1')
cal_distance is  tensor(220.2110, device='cuda:1')
cal ratio is  0.8149537641773372
distance x is tensor(179.4627, device='cuda:1')
cal_distance is  tensor(179.4627, device='cuda:1')
cal ratio is  0.9027456621680127
distance x is tensor(162.0096, device='cuda:1')
cal_distance is  tensor(162.0096, device='cuda:1')
cal ratio is  0.9501279896549966
distance x is tensor(153.9301, device='cuda:1')
cal_distance is  tensor(153.9301, device='cuda:1')
cal ratio is  0.9747443738257935
distance x is tensor(150.0426, device='cuda:1')
cal_distance is  tensor(150.0426, device='cuda:1')
distance x is tensor(150.0426, device='cuda:1')
return_distance is  tensor(150.0426, device='cuda:1')
distance x is tensor(150.0334, device='cuda:1')
distance x is tensor(150.0334, device='cuda:1')
________________________________
test distance is  tensor(150.0334, device='cuda:1')
test distance1 is  tensor(150.0334, device='cuda:1')
test similarity is  tensor(0.9616, device='cuda:1')
test acc is  0.15076666682299986
test loss is 150.80424011490746
test entropy is  0.017694437688731843
________________________________
0
distance x is tensor(150.0334, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.017770043324874238
avg test loss is  150.7659465814196
avg accuracy is  0.454833333489675
solo acc is  0.14898333348966641
compute similarity  is  tensor(0.9616, device='cuda:1')
compute_distance is  tensor(150.0334, device='cuda:1')
compute_norm is  tensor(55.8215, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(146.0159, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9010699630927429
avg test loss is  1.5495432620363703
avg accuracy is  0.7763000001563266
solo acc is  0.30483333348967295
compute similarity  is  tensor(0.9619, device='cuda:1')
compute_distance is  tensor(146.0159, device='cuda:1')
compute_norm is  tensor(55.3986, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(146.0159, device='cuda:1')
distance x is tensor(146.0159, device='cuda:1')
________________________________
test distance is  tensor(146.0159, device='cuda:1')
test distance1 is  tensor(146.0159, device='cuda:1')
test similarity is  tensor(0.9619, device='cuda:1')
test acc is  0.3101833334896731
test loss is 1.543851793701969
test entropy is  0.901705603863893
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.29700000016000005
mal loss is 1.5951090902090073
mal norm is  tensor(733.4313, device='cuda:1')
distance x is tensor(146.0242, device='cuda:1')
mal distance is  tensor(146.0242, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([13., 13., 12., 12., 17., 12., 12., 15., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 14.,  0., 22., 12., 25., 12., 25., 12.])
count_res tensor([2.9947e-06, 2.9947e-06, 1.1017e-06, 1.1017e-06, 1.6351e-04, 1.1017e-06,
        1.1017e-06, 2.2128e-05, 6.0150e-05, 6.0150e-05, 6.0150e-05, 6.0150e-05,
        6.0150e-05, 6.0150e-05, 6.0150e-05, 6.0150e-05, 6.0150e-05, 6.0150e-05,
        6.0150e-05, 6.0150e-05, 8.1404e-06, 6.7690e-12, 2.4266e-02, 1.1017e-06,
        4.8740e-01, 1.1017e-06, 4.8740e-01, 1.1017e-06])
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 85.05% 

Test Accuracy: 83.94% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8892676047980785
distance x is tensor(122.2706, device='cuda:1')
benign distance is  tensor(122.2706, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.0473140198737383
distance x is tensor(103.2225, device='cuda:1')
benign distance is  tensor(103.2225, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.1036624256521463
distance x is tensor(96.3150, device='cuda:1')
benign distance is  tensor(96.3150, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1806682627648115
distance x is tensor(161.9181, device='cuda:1')
benign distance is  tensor(161.9181, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0966742914170027
distance x is tensor(117.0072, device='cuda:1')
benign distance is  tensor(117.0072, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.7932236362248659
distance x is tensor(106.4728, device='cuda:1')
benign distance is  tensor(106.4728, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.4835013002157211
distance x is tensor(98.5405, device='cuda:1')
benign distance is  tensor(98.5405, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.7631089305505157
distance x is tensor(88.8941, device='cuda:1')
benign distance is  tensor(88.8941, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7621495630592108
distance x is tensor(124.1021, device='cuda:1')
benign distance is  tensor(124.1021, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.3015619739890099
distance x is tensor(107.4419, device='cuda:1')
benign distance is  tensor(107.4419, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.8856263011693954
distance x is tensor(147.2309, device='cuda:1')
benign distance is  tensor(147.2309, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  1.7946734875440598
distance x is tensor(124.5156, device='cuda:1')
benign distance is  tensor(124.5156, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.049215093255043
distance x is tensor(105.8920, device='cuda:1')
benign distance is  tensor(105.8920, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.0300168991088867
distance x is tensor(85.7663, device='cuda:1')
benign distance is  tensor(85.7663, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.401192143559456
distance x is tensor(86.1734, device='cuda:1')
benign distance is  tensor(86.1734, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.0084289964288473
distance x is tensor(129.9119, device='cuda:1')
benign distance is  tensor(129.9119, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(81.9385, device='cuda:1')
compute distance is  tensor(81.9385, device='cuda:1')
compute norm is  tensor(52.7348, device='cuda:1', dtype=torch.float64)
distance x is tensor(149.3891, device='cuda:1')
compute distance is  tensor(149.3891, device='cuda:1')
compute norm is  tensor(53.7073, device='cuda:1', dtype=torch.float64)
distance x is tensor(110.7065, device='cuda:1')
compute distance is  tensor(110.7065, device='cuda:1')
compute norm is  tensor(52.9081, device='cuda:1', dtype=torch.float64)
distance x is tensor(118.9653, device='cuda:1')
compute distance is  tensor(118.9653, device='cuda:1')
compute norm is  tensor(53.2029, device='cuda:1', dtype=torch.float64)
distance x is tensor(100.2278, device='cuda:1')
compute distance is  tensor(100.2278, device='cuda:1')
compute norm is  tensor(52.8184, device='cuda:1', dtype=torch.float64)
distance x is tensor(111.2982, device='cuda:1')
compute distance is  tensor(111.2982, device='cuda:1')
compute norm is  tensor(53.1719, device='cuda:1', dtype=torch.float64)
distance x is tensor(125.9836, device='cuda:1')
compute distance is  tensor(125.9836, device='cuda:1')
compute norm is  tensor(53.3741, device='cuda:1', dtype=torch.float64)
distance x is tensor(96.3806, device='cuda:1')
compute distance is  tensor(96.3806, device='cuda:1')
compute norm is  tensor(52.8586, device='cuda:1', dtype=torch.float64)
distance x is tensor(133.9030, device='cuda:1')
compute distance is  tensor(133.9030, device='cuda:1')
compute norm is  tensor(53.6063, device='cuda:1', dtype=torch.float64)
distance x is tensor(106.2457, device='cuda:1')
compute distance is  tensor(106.2457, device='cuda:1')
compute norm is  tensor(53.1272, device='cuda:1', dtype=torch.float64)
distance x is tensor(114.4902, device='cuda:1')
compute distance is  tensor(114.4902, device='cuda:1')
compute norm is  tensor(53.0165, device='cuda:1', dtype=torch.float64)
distance x is tensor(155.0051, device='cuda:1')
compute distance is  tensor(155.0051, device='cuda:1')
compute norm is  tensor(54.1278, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(155.0051, device='cuda:1')
distance x is tensor(102033.2500, device='cuda:1')
distance x is tensor(102033.2500, device='cuda:1')
________________________________
test distance is  tensor(102033.2500, device='cuda:1')
test distance1 is  tensor(102033.2500, device='cuda:1')
test similarity is  tensor(0.2429, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107476224003318.72
test entropy is  0.0
________________________________
cal ratio is  0.0381969072023791
distance x is tensor(3897.3599, device='cuda:1')
cal_distance is  tensor(3897.3599, device='cuda:1')
cal ratio is  0.19544016277215084
distance x is tensor(761.7043, device='cuda:1')
cal_distance is  tensor(761.7043, device='cuda:1')
cal ratio is  0.44208509049199707
distance x is tensor(336.7407, device='cuda:1')
cal_distance is  tensor(336.7407, device='cuda:1')
cal ratio is  0.6648922736976892
distance x is tensor(223.8978, device='cuda:1')
cal_distance is  tensor(223.8978, device='cuda:1')
cal ratio is  0.8154064911207608
distance x is tensor(182.5686, device='cuda:1')
cal_distance is  tensor(182.5686, device='cuda:1')
cal ratio is  0.9029965142323245
distance x is tensor(164.8592, device='cuda:1')
cal_distance is  tensor(164.8592, device='cuda:1')
cal ratio is  0.9502599861364973
distance x is tensor(156.6594, device='cuda:1')
cal_distance is  tensor(156.6594, device='cuda:1')
cal ratio is  0.974812054920578
distance x is tensor(152.7135, device='cuda:1')
cal_distance is  tensor(152.7135, device='cuda:1')
distance x is tensor(152.7135, device='cuda:1')
return_distance is  tensor(152.7135, device='cuda:1')
distance x is tensor(152.7045, device='cuda:1')
distance x is tensor(152.7045, device='cuda:1')
________________________________
test distance is  tensor(152.7045, device='cuda:1')
test distance1 is  tensor(152.7045, device='cuda:1')
test similarity is  tensor(0.9599, device='cuda:1')
test acc is  0.17563333348966834
test loss is 96.86054845456121
test entropy is  0.024606254031901052
________________________________
0
distance x is tensor(152.7045, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.02528362616735038
avg test loss is  96.39862221593796
avg accuracy is  0.6558000001563334
solo acc is  0.17416666682300158
compute similarity  is  tensor(0.9599, device='cuda:1')
compute_distance is  tensor(152.7045, device='cuda:1')
compute_norm is  tensor(55.6512, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(149.3765, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9673183159406251
avg test loss is  1.4943892762605062
avg accuracy is  0.7913166668229924
solo acc is  0.3187833334896732
compute similarity  is  tensor(0.9598, device='cuda:1')
compute_distance is  tensor(149.3765, device='cuda:1')
compute_norm is  tensor(55.2748, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(149.3765, device='cuda:1')
distance x is tensor(149.3765, device='cuda:1')
________________________________
test distance is  tensor(149.3765, device='cuda:1')
test distance1 is  tensor(149.3765, device='cuda:1')
test similarity is  tensor(0.9598, device='cuda:1')
test acc is  0.3199000001563399
test loss is 1.4933340358835803
test entropy is  0.9655677721952833
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.31500000016000007
mal loss is 1.49751415848732
mal norm is  tensor(751.0568, device='cuda:1')
distance x is tensor(149.3851, device='cuda:1')
mal distance is  tensor(149.3851, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([14., 12., 12., 12., 12., 12., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 19., 12., 12., 19., 12., 27., 12., 17.])
count_res tensor([2.2582e-06, 3.0562e-07, 3.0562e-07, 3.0562e-07, 3.0562e-07, 3.0562e-07,
        3.0562e-07, 3.0562e-07, 1.6686e-05, 1.6686e-05, 1.6686e-05, 1.6686e-05,
        1.6686e-05, 1.6686e-05, 1.6686e-05, 1.6686e-05, 1.6686e-05, 1.6686e-05,
        1.6686e-05, 1.6686e-05, 3.3515e-04, 3.0562e-07, 3.0562e-07, 3.3515e-04,
        3.0562e-07, 9.9908e-01, 3.0562e-07, 4.5358e-05])
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 56.66% 

Test Accuracy: 77.23% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.812364362180233
distance x is tensor(132.3787, device='cuda:1')
benign distance is  tensor(132.3787, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.4554825574159622
distance x is tensor(106.8017, device='cuda:1')
benign distance is  tensor(106.8017, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.2623085603117943
distance x is tensor(100.7595, device='cuda:1')
benign distance is  tensor(100.7595, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2969201654195786
distance x is tensor(154.8443, device='cuda:1')
benign distance is  tensor(154.8443, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.9577445015311241
distance x is tensor(104.5435, device='cuda:1')
benign distance is  tensor(104.5435, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0859018601477146
distance x is tensor(113.8918, device='cuda:1')
benign distance is  tensor(113.8918, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.699838601052761
distance x is tensor(110.7735, device='cuda:1')
benign distance is  tensor(110.7735, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0806863959878683
distance x is tensor(94.4233, device='cuda:1')
benign distance is  tensor(94.4233, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.5899735502898693
distance x is tensor(103.9402, device='cuda:1')
benign distance is  tensor(103.9402, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.9933622758835554
distance x is tensor(151.8691, device='cuda:1')
benign distance is  tensor(151.8691, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.7438770160079002
distance x is tensor(120.8215, device='cuda:1')
benign distance is  tensor(120.8215, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.743909440934658
distance x is tensor(123.2735, device='cuda:1')
benign distance is  tensor(123.2735, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.2702400535345078
distance x is tensor(161.1382, device='cuda:1')
benign distance is  tensor(161.1382, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.271716272458434
distance x is tensor(42.5893, device='cuda:1')
benign distance is  tensor(42.5893, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.197460688650608
distance x is tensor(159.5447, device='cuda:1')
benign distance is  tensor(159.5447, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.225840710103512
distance x is tensor(130.5996, device='cuda:1')
benign distance is  tensor(130.5996, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(102.1218, device='cuda:1')
compute distance is  tensor(102.1218, device='cuda:1')
compute norm is  tensor(53.5163, device='cuda:1', dtype=torch.float64)
distance x is tensor(147.2711, device='cuda:1')
compute distance is  tensor(147.2711, device='cuda:1')
compute norm is  tensor(54.4103, device='cuda:1', dtype=torch.float64)
distance x is tensor(112.9541, device='cuda:1')
compute distance is  tensor(112.9541, device='cuda:1')
compute norm is  tensor(53.6083, device='cuda:1', dtype=torch.float64)
distance x is tensor(95.5170, device='cuda:1')
compute distance is  tensor(95.5170, device='cuda:1')
compute norm is  tensor(53.5880, device='cuda:1', dtype=torch.float64)
distance x is tensor(96.4691, device='cuda:1')
compute distance is  tensor(96.4691, device='cuda:1')
compute norm is  tensor(53.4653, device='cuda:1', dtype=torch.float64)
distance x is tensor(115.5268, device='cuda:1')
compute distance is  tensor(115.5268, device='cuda:1')
compute norm is  tensor(53.8566, device='cuda:1', dtype=torch.float64)
distance x is tensor(126.1035, device='cuda:1')
compute distance is  tensor(126.1035, device='cuda:1')
compute norm is  tensor(54.0120, device='cuda:1', dtype=torch.float64)
distance x is tensor(106.1019, device='cuda:1')
compute distance is  tensor(106.1019, device='cuda:1')
compute norm is  tensor(53.4764, device='cuda:1', dtype=torch.float64)
distance x is tensor(135.5774, device='cuda:1')
compute distance is  tensor(135.5774, device='cuda:1')
compute norm is  tensor(54.2912, device='cuda:1', dtype=torch.float64)
distance x is tensor(106.5689, device='cuda:1')
compute distance is  tensor(106.5689, device='cuda:1')
compute norm is  tensor(53.7097, device='cuda:1', dtype=torch.float64)
distance x is tensor(130.8720, device='cuda:1')
compute distance is  tensor(130.8720, device='cuda:1')
compute norm is  tensor(54.0362, device='cuda:1', dtype=torch.float64)
distance x is tensor(155.7888, device='cuda:1')
compute distance is  tensor(155.7888, device='cuda:1')
compute norm is  tensor(54.6660, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(155.7888, device='cuda:1')
distance x is tensor(102041.5703, device='cuda:1')
distance x is tensor(102041.5703, device='cuda:1')
________________________________
test distance is  tensor(102041.5703, device='cuda:1')
test distance1 is  tensor(102041.5703, device='cuda:1')
test similarity is  tensor(0.2329, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107529283996883.78
test entropy is  0.0
________________________________
cal ratio is  0.038291792014067405
distance x is tensor(3907.3596, device='cuda:1')
cal_distance is  tensor(3907.3596, device='cuda:1')
cal ratio is  0.1956827617109379
distance x is tensor(764.6066, device='cuda:1')
cal_distance is  tensor(764.6066, device='cuda:1')
cal ratio is  0.4423593884866544
distance x is tensor(338.2335, device='cuda:1')
cal_distance is  tensor(338.2335, device='cuda:1')
cal ratio is  0.6650984837362195
distance x is tensor(224.9601, device='cuda:1')
cal_distance is  tensor(224.9601, device='cuda:1')
cal ratio is  0.8155329176271827
distance x is tensor(183.4632, device='cuda:1')
cal_distance is  tensor(183.4632, device='cuda:1')
cal ratio is  0.9030664981782839
distance x is tensor(165.6800, device='cuda:1')
cal_distance is  tensor(165.6800, device='cuda:1')
cal ratio is  0.9502967623555626
distance x is tensor(157.4454, device='cuda:1')
cal_distance is  tensor(157.4454, device='cuda:1')
cal ratio is  0.9748309930406004
distance x is tensor(153.4827, device='cuda:1')
cal_distance is  tensor(153.4827, device='cuda:1')
distance x is tensor(153.4827, device='cuda:1')
return_distance is  tensor(153.4827, device='cuda:1')
distance x is tensor(153.4736, device='cuda:1')
distance x is tensor(153.4736, device='cuda:1')
________________________________
test distance is  tensor(153.4736, device='cuda:1')
test distance1 is  tensor(153.4736, device='cuda:1')
test similarity is  tensor(0.9604, device='cuda:1')
test acc is  0.15041666682299992
test loss is 154.59662951081037
test entropy is  0.016047576614572925
________________________________
0
distance x is tensor(153.4736, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.016344941389011106
avg test loss is  154.15104958345134
avg accuracy is  0.497850000156342
solo acc is  0.15038333348966654
compute similarity  is  tensor(0.9604, device='cuda:1')
compute_distance is  tensor(153.4736, device='cuda:1')
compute_norm is  tensor(56.2543, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(152.3855, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9677545739643609
avg test loss is  1.55341824628651
avg accuracy is  0.706416666822997
solo acc is  0.30180000015633957
compute similarity  is  tensor(0.9597, device='cuda:1')
compute_distance is  tensor(152.3855, device='cuda:1')
compute_norm is  tensor(56.0906, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(152.3855, device='cuda:1')
distance x is tensor(152.3855, device='cuda:1')
________________________________
test distance is  tensor(152.3855, device='cuda:1')
test distance1 is  tensor(152.3855, device='cuda:1')
test similarity is  tensor(0.9597, device='cuda:1')
test acc is  0.3016500001563396
test loss is 1.5544832760591243
test entropy is  0.9669008652157367
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.31500000016000007
mal loss is 1.5493824854493141
mal norm is  tensor(760.2370, device='cuda:1')
distance x is tensor(152.3937, device='cuda:1')
mal distance is  tensor(152.3937, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([12., 18., 12., 12., 13., 13., 12., 12., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 13., 23., 25., 12., 12.,  1., 26., 12.])
count_res tensor([5.8618e-07, 2.3648e-04, 5.8618e-07, 5.8618e-07, 1.5934e-06, 1.5934e-06,
        5.8618e-07, 5.8618e-07, 3.2004e-05, 3.2004e-05, 3.2004e-05, 3.2004e-05,
        3.2004e-05, 3.2004e-05, 3.2004e-05, 3.2004e-05, 3.2004e-05, 3.2004e-05,
        3.2004e-05, 3.2004e-05, 1.5934e-06, 3.5097e-02, 2.5933e-01, 5.8618e-07,
        5.8618e-07, 9.7902e-12, 7.0494e-01, 5.8618e-07])
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 76.05% 

Test Accuracy: 78.13% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8721216982230544
distance x is tensor(115.7009, device='cuda:1')
benign distance is  tensor(115.7009, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.4396193660795689
distance x is tensor(100.1541, device='cuda:1')
benign distance is  tensor(100.1541, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.0247645676136017
distance x is tensor(110.0121, device='cuda:1')
benign distance is  tensor(110.0121, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.1453531868755817
distance x is tensor(137.8629, device='cuda:1')
benign distance is  tensor(137.8629, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.8497115820646286
distance x is tensor(92.1281, device='cuda:1')
benign distance is  tensor(92.1281, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.116175465285778
distance x is tensor(114.7138, device='cuda:1')
benign distance is  tensor(114.7138, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6343905217945576
distance x is tensor(99.1282, device='cuda:1')
benign distance is  tensor(99.1282, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9873213097453117
distance x is tensor(99.4730, device='cuda:1')
benign distance is  tensor(99.4730, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.4159826077520847
distance x is tensor(95.1020, device='cuda:1')
benign distance is  tensor(95.1020, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.20802341401577
distance x is tensor(111.4715, device='cuda:1')
benign distance is  tensor(111.4715, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.2263944782316685
distance x is tensor(110.8978, device='cuda:1')
benign distance is  tensor(110.8978, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.1163555067032576
distance x is tensor(114.9491, device='cuda:1')
benign distance is  tensor(114.9491, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.4685133770108223
distance x is tensor(83.9934, device='cuda:1')
benign distance is  tensor(83.9934, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8373393248766661
distance x is tensor(195.2735, device='cuda:1')
benign distance is  tensor(195.2735, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.5903581008315086
distance x is tensor(121.6692, device='cuda:1')
benign distance is  tensor(121.6692, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.0002423077821732
distance x is tensor(114.7908, device='cuda:1')
benign distance is  tensor(114.7908, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(81.4302, device='cuda:1')
compute distance is  tensor(81.4302, device='cuda:1')
compute norm is  tensor(54.2982, device='cuda:1', dtype=torch.float64)
distance x is tensor(142.3920, device='cuda:1')
compute distance is  tensor(142.3920, device='cuda:1')
compute norm is  tensor(55.1114, device='cuda:1', dtype=torch.float64)
distance x is tensor(104.9156, device='cuda:1')
compute distance is  tensor(104.9156, device='cuda:1')
compute norm is  tensor(54.4842, device='cuda:1', dtype=torch.float64)
distance x is tensor(95.6790, device='cuda:1')
compute distance is  tensor(95.6790, device='cuda:1')
compute norm is  tensor(54.3954, device='cuda:1', dtype=torch.float64)
distance x is tensor(101.9978, device='cuda:1')
compute distance is  tensor(101.9978, device='cuda:1')
compute norm is  tensor(54.6013, device='cuda:1', dtype=torch.float64)
distance x is tensor(110.8278, device='cuda:1')
compute distance is  tensor(110.8278, device='cuda:1')
compute norm is  tensor(54.6850, device='cuda:1', dtype=torch.float64)
distance x is tensor(127.4233, device='cuda:1')
compute distance is  tensor(127.4233, device='cuda:1')
compute norm is  tensor(54.7971, device='cuda:1', dtype=torch.float64)
distance x is tensor(98.6674, device='cuda:1')
compute distance is  tensor(98.6674, device='cuda:1')
compute norm is  tensor(54.3774, device='cuda:1', dtype=torch.float64)
distance x is tensor(122.1196, device='cuda:1')
compute distance is  tensor(122.1196, device='cuda:1')
compute norm is  tensor(54.7492, device='cuda:1', dtype=torch.float64)
distance x is tensor(105.7473, device='cuda:1')
compute distance is  tensor(105.7473, device='cuda:1')
compute norm is  tensor(54.5562, device='cuda:1', dtype=torch.float64)
distance x is tensor(112.3123, device='cuda:1')
compute distance is  tensor(112.3123, device='cuda:1')
compute norm is  tensor(54.5751, device='cuda:1', dtype=torch.float64)
distance x is tensor(146.1235, device='cuda:1')
compute distance is  tensor(146.1235, device='cuda:1')
compute norm is  tensor(55.4088, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(146.1235, device='cuda:1')
distance x is tensor(102049.0703, device='cuda:1')
distance x is tensor(102049.0703, device='cuda:1')
________________________________
test distance is  tensor(102049.0703, device='cuda:1')
test distance1 is  tensor(102049.0703, device='cuda:1')
test similarity is  tensor(0.2172, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107492768591950.6
test entropy is  0.0
________________________________
cal ratio is  0.037083568054621235
distance x is tensor(3784.3484, device='cuda:1')
cal_distance is  tensor(3784.3484, device='cuda:1')
cal ratio is  0.19257082736133638
distance x is tensor(728.7588, device='cuda:1')
cal_distance is  tensor(728.7588, device='cuda:1')
cal ratio is  0.4388278048899391
distance x is tensor(319.8022, device='cuda:1')
cal_distance is  tensor(319.8022, device='cuda:1')
cal ratio is  0.6624381093230164
distance x is tensor(211.8507, device='cuda:1')
cal_distance is  tensor(211.8507, device='cuda:1')
cal ratio is  0.8139000089878091
distance x is tensor(172.4262, device='cuda:1')
cal_distance is  tensor(172.4262, device='cuda:1')
cal ratio is  0.9021618672486439
distance x is tensor(155.5568, device='cuda:1')
cal_distance is  tensor(155.5568, device='cuda:1')
cal ratio is  0.9498205493039464
distance x is tensor(147.7513, device='cuda:1')
cal_distance is  tensor(147.7513, device='cuda:1')
cal ratio is  0.9745866189933625
distance x is tensor(143.9966, device='cuda:1')
cal_distance is  tensor(143.9966, device='cuda:1')
distance x is tensor(143.9966, device='cuda:1')
return_distance is  tensor(143.9966, device='cuda:1')
distance x is tensor(143.9874, device='cuda:1')
distance x is tensor(143.9874, device='cuda:1')
________________________________
test distance is  tensor(143.9874, device='cuda:1')
test distance1 is  tensor(143.9874, device='cuda:1')
test similarity is  tensor(0.9648, device='cuda:1')
test acc is  0.1635833334896676
test loss is 77.87094346394163
test entropy is  0.025659372921159832
________________________________
0
distance x is tensor(143.9874, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.02541327991159113
avg test loss is  77.93556982418622
avg accuracy is  0.6016500001563374
solo acc is  0.1630666668230009
compute similarity  is  tensor(0.9648, device='cuda:1')
compute_distance is  tensor(143.9874, device='cuda:1')
compute_norm is  tensor(56.7617, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(142.5089, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9757516028276131
avg test loss is  1.5049900858641179
avg accuracy is  0.7723666668229934
solo acc is  0.3150166668230065
compute similarity  is  tensor(0.9648, device='cuda:1')
compute_distance is  tensor(142.5089, device='cuda:1')
compute_norm is  tensor(56.2024, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(142.5089, device='cuda:1')
distance x is tensor(142.5089, device='cuda:1')
________________________________
test distance is  tensor(142.5089, device='cuda:1')
test distance1 is  tensor(142.5089, device='cuda:1')
test similarity is  tensor(0.9648, device='cuda:1')
test acc is  0.31716666682300654
test loss is 1.5071539143001094
test entropy is  0.9757384139972963
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3450000001600001
mal loss is 1.467613659799099
mal norm is  tensor(707.0782, device='cuda:1')
distance x is tensor(142.5170, device='cuda:1')
mal distance is  tensor(142.5170, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([13., 18., 12.,  0.,  1., 16., 12., 12., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24.,  5., 14.,  0., 15.,  2., 12., 30., 34.,
        22., 33., 24., 31., 12., 34., 12., 32.])
count_res tensor([2.9482e-10, 4.3755e-08, 1.0846e-10, 6.6639e-16, 1.8114e-15, 5.9217e-09,
        1.0846e-10, 1.0846e-10, 1.7652e-05, 1.7652e-05, 1.7652e-05, 1.7652e-05,
        1.7652e-05, 1.7652e-05, 1.7652e-05, 1.7652e-05, 1.7652e-05, 1.7652e-05,
        1.7652e-05, 1.7652e-05, 9.8902e-14, 8.0141e-10, 6.6639e-16, 2.1785e-09,
        4.9240e-15, 1.0846e-10, 7.1214e-03, 3.8882e-01, 2.3890e-06, 1.4304e-01,
        1.7652e-05, 1.9358e-02, 1.0846e-10, 3.8882e-01, 1.0846e-10, 5.2620e-02])
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 75.26% 

Test Accuracy: 83.66% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7568072751164436
distance x is tensor(112.1061, device='cuda:1')
benign distance is  tensor(112.1061, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3371257856488228
distance x is tensor(102.4872, device='cuda:1')
benign distance is  tensor(102.4872, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.249632429331541
distance x is tensor(90.5010, device='cuda:1')
benign distance is  tensor(90.5010, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2423593327403069
distance x is tensor(155.3017, device='cuda:1')
benign distance is  tensor(155.3017, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.4247444570064545
distance x is tensor(103.2709, device='cuda:1')
benign distance is  tensor(103.2709, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1132610030472279
distance x is tensor(100.5888, device='cuda:1')
benign distance is  tensor(100.5888, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6804089918732643
distance x is tensor(102.2273, device='cuda:1')
benign distance is  tensor(102.2273, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.0584429781883955
distance x is tensor(84.7508, device='cuda:1')
benign distance is  tensor(84.7508, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.9895892590284348
distance x is tensor(75.5354, device='cuda:1')
benign distance is  tensor(75.5354, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.214273041114211
distance x is tensor(121.2465, device='cuda:1')
benign distance is  tensor(121.2465, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.6577770672738552
distance x is tensor(83.7664, device='cuda:1')
benign distance is  tensor(83.7664, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.8893604427576065
distance x is tensor(104.9280, device='cuda:1')
benign distance is  tensor(104.9280, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.1803180128335953
distance x is tensor(159.8153, device='cuda:1')
benign distance is  tensor(159.8153, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.2455373499542475
distance x is tensor(43.7497, device='cuda:1')
benign distance is  tensor(43.7497, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.6149507239460945
distance x is tensor(132.3496, device='cuda:1')
benign distance is  tensor(132.3496, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  1.589149035513401
distance x is tensor(115.5589, device='cuda:1')
benign distance is  tensor(115.5589, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.2612202912569046
distance x is tensor(111.6142, device='cuda:1')
benign distance is  tensor(111.6142, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.3728421665728092
distance x is tensor(83.9133, device='cuda:1')
benign distance is  tensor(83.9133, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.2100074216723442
distance x is tensor(128.0316, device='cuda:1')
benign distance is  tensor(128.0316, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.6397339925169945
distance x is tensor(106.7745, device='cuda:1')
benign distance is  tensor(106.7745, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.9636106304824352
distance x is tensor(115.5974, device='cuda:1')
benign distance is  tensor(115.5974, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.2347121126949787
distance x is tensor(111.7445, device='cuda:1')
benign distance is  tensor(111.7445, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5895505975931883
distance x is tensor(127.1070, device='cuda:1')
benign distance is  tensor(127.1070, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.2532871775329113
distance x is tensor(149.0014, device='cuda:1')
benign distance is  tensor(149.0014, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(79.5298, device='cuda:1')
compute distance is  tensor(79.5298, device='cuda:1')
compute norm is  tensor(53.7654, device='cuda:1', dtype=torch.float64)
distance x is tensor(137.3979, device='cuda:1')
compute distance is  tensor(137.3979, device='cuda:1')
compute norm is  tensor(54.6684, device='cuda:1', dtype=torch.float64)
distance x is tensor(94.2351, device='cuda:1')
compute distance is  tensor(94.2351, device='cuda:1')
compute norm is  tensor(53.8228, device='cuda:1', dtype=torch.float64)
distance x is tensor(90.1400, device='cuda:1')
compute distance is  tensor(90.1400, device='cuda:1')
compute norm is  tensor(53.8282, device='cuda:1', dtype=torch.float64)
distance x is tensor(90.1103, device='cuda:1')
compute distance is  tensor(90.1103, device='cuda:1')
compute norm is  tensor(53.8904, device='cuda:1', dtype=torch.float64)
distance x is tensor(109.6851, device='cuda:1')
compute distance is  tensor(109.6851, device='cuda:1')
compute norm is  tensor(54.2604, device='cuda:1', dtype=torch.float64)
distance x is tensor(125.6285, device='cuda:1')
compute distance is  tensor(125.6285, device='cuda:1')
compute norm is  tensor(54.4275, device='cuda:1', dtype=torch.float64)
distance x is tensor(94.8359, device='cuda:1')
compute distance is  tensor(94.8359, device='cuda:1')
compute norm is  tensor(53.9099, device='cuda:1', dtype=torch.float64)
distance x is tensor(114.2361, device='cuda:1')
compute distance is  tensor(114.2361, device='cuda:1')
compute norm is  tensor(54.4393, device='cuda:1', dtype=torch.float64)
distance x is tensor(106.1848, device='cuda:1')
compute distance is  tensor(106.1848, device='cuda:1')
compute norm is  tensor(54.2583, device='cuda:1', dtype=torch.float64)
distance x is tensor(102.5926, device='cuda:1')
compute distance is  tensor(102.5926, device='cuda:1')
compute norm is  tensor(54.0327, device='cuda:1', dtype=torch.float64)
distance x is tensor(140.5003, device='cuda:1')
compute distance is  tensor(140.5003, device='cuda:1')
compute norm is  tensor(55.2321, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(140.5003, device='cuda:1')
distance x is tensor(102046.0156, device='cuda:1')
distance x is tensor(102046.0156, device='cuda:1')
________________________________
test distance is  tensor(102046.0156, device='cuda:1')
test distance1 is  tensor(102046.0156, device='cuda:1')
test similarity is  tensor(0.2226, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107507557958260.81
test entropy is  0.0
________________________________
cal ratio is  0.03636357804004251
distance x is tensor(3710.7639, device='cuda:1')
cal_distance is  tensor(3710.7639, device='cuda:1')
cal ratio is  0.1906922196196776
distance x is tensor(707.6174, device='cuda:1')
cal_distance is  tensor(707.6174, device='cuda:1')
cal ratio is  0.4366820832284123
distance x is tensor(309.0064, device='cuda:1')
cal_distance is  tensor(309.0064, device='cuda:1')
cal ratio is  0.6608164995415743
distance x is tensor(204.1981, device='cuda:1')
cal_distance is  tensor(204.1981, device='cuda:1')
cal ratio is  0.8129031268161625
distance x is tensor(165.9942, device='cuda:1')
cal_distance is  tensor(165.9942, device='cuda:1')
cal ratio is  0.9016089960468375
distance x is tensor(149.6623, device='cuda:1')
cal_distance is  tensor(149.6623, device='cuda:1')
cal ratio is  0.9495294679063498
distance x is tensor(142.1090, device='cuda:1')
cal_distance is  tensor(142.1090, device='cuda:1')
cal ratio is  0.9744371512180389
distance x is tensor(138.4764, device='cuda:1')
cal_distance is  tensor(138.4764, device='cuda:1')
distance x is tensor(138.4764, device='cuda:1')
return_distance is  tensor(138.4764, device='cuda:1')
distance x is tensor(138.4672, device='cuda:1')
distance x is tensor(138.4672, device='cuda:1')
________________________________
test distance is  tensor(138.4672, device='cuda:1')
test distance1 is  tensor(138.4672, device='cuda:1')
test similarity is  tensor(0.9669, device='cuda:1')
test acc is  0.12705000015633192
test loss is 103.89566604516654
test entropy is  0.009101889388568596
________________________________
0
distance x is tensor(138.4672, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.009162135259785546
avg test loss is  103.85967881745621
avg accuracy is  0.5414000001563424
solo acc is  0.12551666682299858
compute similarity  is  tensor(0.9669, device='cuda:1')
compute_distance is  tensor(138.4672, device='cuda:1')
compute_norm is  tensor(56.1089, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(136.7449, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9284685487940367
avg test loss is  1.5530091436432878
avg accuracy is  0.7926000001563258
solo acc is  0.30238333348967295
compute similarity  is  tensor(0.9669, device='cuda:1')
compute_distance is  tensor(136.7449, device='cuda:1')
compute_norm is  tensor(55.6072, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(136.7449, device='cuda:1')
distance x is tensor(136.7449, device='cuda:1')
________________________________
test distance is  tensor(136.7449, device='cuda:1')
test distance1 is  tensor(136.7449, device='cuda:1')
test similarity is  tensor(0.9669, device='cuda:1')
test acc is  0.3023500001563396
test loss is 1.554397444608115
test entropy is  0.9247267132501866
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.31000000016000007
mal loss is 1.5481756776571274
mal norm is  tensor(678.7807, device='cuda:1')
distance x is tensor(136.7530, device='cuda:1')
mal distance is  tensor(136.7530, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 20.27% 

Test Accuracy: 24.35% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.0164077952504158
distance x is tensor(169.4905, device='cuda:1')
benign distance is  tensor(169.4905, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.7228372916579247
distance x is tensor(136.7425, device='cuda:1')
benign distance is  tensor(136.7425, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5486905239522457
distance x is tensor(135.9251, device='cuda:1')
benign distance is  tensor(135.9251, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.6190605014562607
distance x is tensor(177.4755, device='cuda:1')
benign distance is  tensor(177.4755, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3512603119015694
distance x is tensor(149.4964, device='cuda:1')
benign distance is  tensor(149.4964, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.4347396716475487
distance x is tensor(160.7546, device='cuda:1')
benign distance is  tensor(160.7546, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8821367025375366
distance x is tensor(150.2934, device='cuda:1')
benign distance is  tensor(150.2934, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.5274286195635796
distance x is tensor(127.1735, device='cuda:1')
benign distance is  tensor(127.1735, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(115.6743, device='cuda:1')
compute distance is  tensor(115.6743, device='cuda:1')
compute norm is  tensor(56.8546, device='cuda:1', dtype=torch.float64)
distance x is tensor(177.1886, device='cuda:1')
compute distance is  tensor(177.1886, device='cuda:1')
compute norm is  tensor(57.9218, device='cuda:1', dtype=torch.float64)
distance x is tensor(137.6664, device='cuda:1')
compute distance is  tensor(137.6664, device='cuda:1')
compute norm is  tensor(57.0253, device='cuda:1', dtype=torch.float64)
distance x is tensor(146.4612, device='cuda:1')
compute distance is  tensor(146.4612, device='cuda:1')
compute norm is  tensor(57.3937, device='cuda:1', dtype=torch.float64)
distance x is tensor(130.2086, device='cuda:1')
compute distance is  tensor(130.2086, device='cuda:1')
compute norm is  tensor(56.9635, device='cuda:1', dtype=torch.float64)
distance x is tensor(143.7171, device='cuda:1')
compute distance is  tensor(143.7171, device='cuda:1')
compute norm is  tensor(57.1349, device='cuda:1', dtype=torch.float64)
distance x is tensor(155.8508, device='cuda:1')
compute distance is  tensor(155.8508, device='cuda:1')
compute norm is  tensor(57.5271, device='cuda:1', dtype=torch.float64)
distance x is tensor(110.8538, device='cuda:1')
compute distance is  tensor(110.8538, device='cuda:1')
compute norm is  tensor(56.5022, device='cuda:1', dtype=torch.float64)
distance x is tensor(159.2047, device='cuda:1')
compute distance is  tensor(159.2047, device='cuda:1')
compute norm is  tensor(57.6161, device='cuda:1', dtype=torch.float64)
distance x is tensor(128.2526, device='cuda:1')
compute distance is  tensor(128.2526, device='cuda:1')
compute norm is  tensor(57.0163, device='cuda:1', dtype=torch.float64)
distance x is tensor(151.5542, device='cuda:1')
compute distance is  tensor(151.5542, device='cuda:1')
compute norm is  tensor(57.2174, device='cuda:1', dtype=torch.float64)
distance x is tensor(171.6373, device='cuda:1')
compute distance is  tensor(171.6373, device='cuda:1')
compute norm is  tensor(58.3144, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(177.1886, device='cuda:1')
distance x is tensor(101936.1641, device='cuda:1')
distance x is tensor(101936.1641, device='cuda:1')
________________________________
test distance is  tensor(101936.1641, device='cuda:1')
test distance1 is  tensor(101936.1641, device='cuda:1')
test similarity is  tensor(0.4482, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107452516473535.05
test entropy is  0.0
________________________________
cal ratio is  0.04085825206953117
distance x is tensor(4164.9390, device='cuda:1')
cal_distance is  tensor(4164.9390, device='cuda:1')
cal ratio is  0.20213411002870024
distance x is tensor(841.8798, device='cuda:1')
cal_distance is  tensor(841.8798, device='cuda:1')
cal ratio is  0.4495923278785041
distance x is tensor(378.5052, device='cuda:1')
cal_distance is  tensor(378.5052, device='cuda:1')
cal ratio is  0.6705141821274534
distance x is tensor(253.7947, device='cuda:1')
cal_distance is  tensor(253.7947, device='cuda:1')
cal ratio is  0.8188468516774055
distance x is tensor(207.8198, device='cuda:1')
cal_distance is  tensor(207.8198, device='cuda:1')
cal ratio is  0.904899743148796
distance x is tensor(188.0565, device='cuda:1')
cal_distance is  tensor(188.0565, device='cuda:1')
cal ratio is  0.9512610503894526
distance x is tensor(178.8911, device='cuda:1')
cal_distance is  tensor(178.8911, device='cuda:1')
cal ratio is  0.9753254854070574
distance x is tensor(174.4771, device='cuda:1')
cal_distance is  tensor(174.4771, device='cuda:1')
distance x is tensor(174.4771, device='cuda:1')
return_distance is  tensor(174.4771, device='cuda:1')
distance x is tensor(174.4680, device='cuda:1')
distance x is tensor(174.4680, device='cuda:1')
________________________________
test distance is  tensor(174.4680, device='cuda:1')
test distance1 is  tensor(174.4680, device='cuda:1')
test similarity is  tensor(0.9678, device='cuda:1')
test acc is  0.10000000015633198
test loss is 595.3946181502678
test entropy is  9.144161053505586e-36
________________________________
0
distance x is tensor(174.4680, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.3718470084099357e-32
avg test loss is  595.7801691311508
avg accuracy is  0.10003333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9678, device='cuda:1')
compute_distance is  tensor(174.4680, device='cuda:1')
compute_norm is  tensor(61.7203, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(512.0948, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.4920751397797802
avg test loss is  2.769860109032344
avg accuracy is  0.10005000015633199
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.8542, device='cuda:1')
compute_distance is  tensor(512.0948, device='cuda:1')
compute_norm is  tensor(76.0320, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(510.1830, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8255502279760487
avg test loss is  3.5120532662629573
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8542, device='cuda:1')
compute_distance is  tensor(510.1830, device='cuda:1')
compute_norm is  tensor(75.9028, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(508.1324, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.4909311685480797
avg test loss is  2.722550547453386
avg accuracy is  0.10005000015633199
solo acc is  0.09998333348966532
compute similarity  is  tensor(0.8540, device='cuda:1')
compute_distance is  tensor(508.1324, device='cuda:1')
compute_norm is  tensor(75.2849, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(506.3245, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8233968370885991
avg test loss is  3.473232517364437
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8540, device='cuda:1')
compute_distance is  tensor(506.3245, device='cuda:1')
compute_norm is  tensor(75.1779, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(504.2573, device='cuda:1')
distance x is tensor(504.2573, device='cuda:1')
________________________________
test distance is  tensor(504.2573, device='cuda:1')
test distance1 is  tensor(504.2573, device='cuda:1')
test similarity is  tensor(0.8538, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.705598810588373
test entropy is  1.4987230100103024
________________________________
cal ratio is  0.5809219842863107
distance x is tensor(292.9357, device='cuda:1')
cal_distance is  tensor(292.9357, device='cuda:1')
cal ratio is  0.762180387488005
distance x is tensor(223.2701, device='cuda:1')
cal_distance is  tensor(223.2701, device='cuda:1')
cal ratio is  0.8730290054028627
distance x is tensor(194.9214, device='cuda:1')
cal_distance is  tensor(194.9214, device='cuda:1')
cal ratio is  0.934359900859688
distance x is tensor(182.1268, device='cuda:1')
cal_distance is  tensor(182.1268, device='cuda:1')
cal ratio is  0.9666227934365842
distance x is tensor(176.0479, device='cuda:1')
cal_distance is  tensor(176.0479, device='cuda:1')
distance x is tensor(176.0479, device='cuda:1')
return_distance is  tensor(176.0479, device='cuda:1')
distance x is tensor(176.0460, device='cuda:1')
distance x is tensor(176.0460, device='cuda:1')
________________________________
test distance is  tensor(176.0460, device='cuda:1')
test distance1 is  tensor(176.0460, device='cuda:1')
test similarity is  tensor(0.9749, device='cuda:1')
test acc is  0.10665000015633196
test loss is 2.6219641966606253
test entropy is  1.7954335939655426
________________________________
0
distance x is tensor(176.0460, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.7965132787283549
avg test loss is  2.6229913875238218
avg accuracy is  0.12886666682299858
solo acc is  0.10638333348966529
compute similarity  is  tensor(0.9749, device='cuda:1')
compute_distance is  tensor(176.0460, device='cuda:1')
compute_norm is  tensor(59.4343, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(176.8248, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.817465814890892
avg test loss is  3.138144997391365
avg accuracy is  0.13273333348966523
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.9745, device='cuda:1')
compute_distance is  tensor(176.8248, device='cuda:1')
compute_norm is  tensor(59.4257, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(177.4652, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.145708178215698
avg test loss is  2.048276746450965
avg accuracy is  0.20881666682300348
solo acc is  0.15165000015633331
compute similarity  is  tensor(0.9748, device='cuda:1')
compute_distance is  tensor(177.4652, device='cuda:1')
compute_norm is  tensor(58.9959, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(177.5645, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.6918521505047772
avg test loss is  2.7517074941317916
avg accuracy is  0.16321666682300087
solo acc is  0.10175000015633197
compute similarity  is  tensor(0.9746, device='cuda:1')
compute_distance is  tensor(177.5645, device='cuda:1')
compute_norm is  tensor(58.8342, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(178.8531, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  1.0996757243106614
avg test loss is  1.8378381792670373
avg accuracy is  0.24565000015633817
solo acc is  0.1722166668230014
compute similarity  is  tensor(0.9746, device='cuda:1')
compute_distance is  tensor(178.8531, device='cuda:1')
compute_norm is  tensor(58.4717, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(178.6809, device='cuda:1')
distance x is tensor(178.6809, device='cuda:1')
________________________________
test distance is  tensor(178.6809, device='cuda:1')
test distance1 is  tensor(178.6809, device='cuda:1')
test similarity is  tensor(0.9744, device='cuda:1')
test acc is  0.10155000015633196
test loss is 2.5880913724268932
test entropy is  0.6721722291095424
________________________________
cal ratio is  0.9758990653803701
distance x is tensor(174.3758, device='cuda:1')
cal_distance is  tensor(174.3758, device='cuda:1')
distance x is tensor(174.3758, device='cuda:1')
return_distance is  tensor(174.3758, device='cuda:1')
distance x is tensor(174.3745, device='cuda:1')
distance x is tensor(174.3745, device='cuda:1')
________________________________
test distance is  tensor(174.3745, device='cuda:1')
test distance1 is  tensor(174.3745, device='cuda:1')
test similarity is  tensor(0.9756, device='cuda:1')
test acc is  0.10150000015633197
test loss is 2.5468234776942205
test entropy is  0.7017172161322921
________________________________
0
distance x is tensor(174.3745, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.7025217326846458
avg test loss is  2.545959496803121
avg accuracy is  0.18398333348966886
solo acc is  0.10161666682299864
compute similarity  is  tensor(0.9756, device='cuda:1')
compute_distance is  tensor(174.3745, device='cuda:1')
compute_norm is  tensor(58.1763, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(175.6714, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.0798873830197462
avg test loss is  1.7286033845151156
avg accuracy is  0.2757666668230057
solo acc is  0.18618333348966895
compute similarity  is  tensor(0.9754, device='cuda:1')
compute_distance is  tensor(175.6714, device='cuda:1')
compute_norm is  tensor(57.8465, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(175.5955, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.6379334644150378
avg test loss is  2.529964426687277
avg accuracy is  0.20288333348966986
solo acc is  0.10161666682299864
compute similarity  is  tensor(0.9752, device='cuda:1')
compute_distance is  tensor(175.5955, device='cuda:1')
compute_norm is  tensor(57.6602, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(176.8098, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.0427223844314688
avg test loss is  1.6605195089189737
avg accuracy is  0.3118333334896731
solo acc is  0.19175000015633598
compute similarity  is  tensor(0.9750, device='cuda:1')
compute_distance is  tensor(176.8098, device='cuda:1')
compute_norm is  tensor(57.3429, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(176.7876, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.6334210518580764
avg test loss is  2.4423550369897122
avg accuracy is  0.22270000015633734
solo acc is  0.10160000015633197
compute similarity  is  tensor(0.9748, device='cuda:1')
compute_distance is  tensor(176.7876, device='cuda:1')
compute_norm is  tensor(57.1556, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(177.8727, device='cuda:1')
________________________________
test distance is  tensor(177.8727, device='cuda:1')
test similarity is  tensor(0.9745, device='cuda:1')
test acc is  0.3453000001563404
test loss is 1.6136435464755305
test entropy is  0.956743090010401
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2340000001600001
mal loss is 1.5898135155439377
mal norm is  tensor(597.8425, device='cuda:1')
distance x is tensor(177.8727, device='cuda:1')
mal distance is  tensor(177.8727, device='cuda:1')
user_PLR len size 52
counter_tensor is  tensor([16., 50., 19., 26., 33., 35., 28., 43., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 13., 13., 12., 33.,  0., 12., 49., 35.,
        32.,  0., 47., 12.,  1., 12., 12.,  0., 12., 17., 44., 12., 15., 49.,
        46.,  0., 26.,  0., 24., 15., 13., 47., 22., 49.])
count_res tensor([7.7014e-16, 4.4934e-01, 1.5469e-14, 1.6963e-11, 1.8603e-08, 1.3746e-07,
        1.2534e-10, 4.0975e-04, 2.0400e-05, 2.0400e-05, 2.0400e-05, 2.0400e-05,
        2.0400e-05, 2.0400e-05, 2.0400e-05, 2.0400e-05, 2.0400e-05, 2.0400e-05,
        2.0400e-05, 2.0400e-05, 3.8343e-17, 3.8343e-17, 1.4106e-17, 1.8603e-08,
        8.6667e-23, 1.4106e-17, 1.6530e-01, 1.3746e-07, 6.8435e-09, 8.6667e-23,
        2.2372e-02, 1.4106e-17, 2.3559e-22, 1.4106e-17, 1.4106e-17, 8.6667e-23,
        1.4106e-17, 2.0934e-15, 1.1138e-03, 1.4106e-17, 2.8332e-16, 1.6530e-01,
        8.2300e-03, 8.6667e-23, 1.6963e-11, 8.6667e-23, 2.2957e-12, 2.8332e-16,
        3.8343e-17, 2.2372e-02, 3.1069e-13, 1.6530e-01])
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 71.11% 

Test Accuracy: 82.62% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8897145688533783
distance x is tensor(121.5977, device='cuda:1')
benign distance is  tensor(121.5977, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.0806135460734367
distance x is tensor(88.5742, device='cuda:1')
benign distance is  tensor(88.5742, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.4595725536346436
distance x is tensor(102.9068, device='cuda:1')
benign distance is  tensor(102.9068, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.2728593237698078
distance x is tensor(152.5425, device='cuda:1')
benign distance is  tensor(152.5425, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.7237534821033478
distance x is tensor(96.3874, device='cuda:1')
benign distance is  tensor(96.3874, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9101717956364155
distance x is tensor(109.3717, device='cuda:1')
benign distance is  tensor(109.3717, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.5845113471150398
distance x is tensor(113.1006, device='cuda:1')
benign distance is  tensor(113.1006, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.1006151549518108
distance x is tensor(87.9516, device='cuda:1')
benign distance is  tensor(87.9516, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.5778961479663849
distance x is tensor(87.5744, device='cuda:1')
benign distance is  tensor(87.5744, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.1586926877498627
distance x is tensor(127.7548, device='cuda:1')
benign distance is  tensor(127.7548, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.5447574816644192
distance x is tensor(80.2460, device='cuda:1')
benign distance is  tensor(80.2460, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.357608415186405
distance x is tensor(108.2524, device='cuda:1')
benign distance is  tensor(108.2524, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.4253014475107193
distance x is tensor(154.4660, device='cuda:1')
benign distance is  tensor(154.4660, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.1376624293625355
distance x is tensor(51.6119, device='cuda:1')
benign distance is  tensor(51.6119, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.3144973181188107
distance x is tensor(132.9901, device='cuda:1')
benign distance is  tensor(132.9901, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.312304601073265
distance x is tensor(108.4251, device='cuda:1')
benign distance is  tensor(108.4251, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.149820603430271
distance x is tensor(86.7820, device='cuda:1')
benign distance is  tensor(86.7820, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.2653418146073818
distance x is tensor(109.5639, device='cuda:1')
benign distance is  tensor(109.5639, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.3862154968082905
distance x is tensor(117.5931, device='cuda:1')
benign distance is  tensor(117.5931, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.324479840695858
distance x is tensor(123.4148, device='cuda:1')
benign distance is  tensor(123.4148, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.4288470968604088
distance x is tensor(103.1188, device='cuda:1')
benign distance is  tensor(103.1188, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0563375018537045
distance x is tensor(202.7645, device='cuda:1')
benign distance is  tensor(202.7645, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.1031130738556385
distance x is tensor(148.2660, device='cuda:1')
benign distance is  tensor(148.2660, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.9601167347282171
distance x is tensor(129.6838, device='cuda:1')
benign distance is  tensor(129.6838, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.7206307332962751
distance x is tensor(131.9105, device='cuda:1')
benign distance is  tensor(131.9105, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.3443700224161148
distance x is tensor(111.9345, device='cuda:1')
benign distance is  tensor(111.9345, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.0698991045355797
distance x is tensor(136.8109, device='cuda:1')
benign distance is  tensor(136.8109, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  3.0511235147714615
distance x is tensor(119.4809, device='cuda:1')
benign distance is  tensor(119.4809, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.766018582507968
distance x is tensor(118.5500, device='cuda:1')
benign distance is  tensor(118.5500, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.0893443785607815
distance x is tensor(90.3008, device='cuda:1')
benign distance is  tensor(90.3008, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.658878181129694
distance x is tensor(105.9494, device='cuda:1')
benign distance is  tensor(105.9494, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.7332880366593599
distance x is tensor(131.3675, device='cuda:1')
benign distance is  tensor(131.3675, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  2.203513592481613
distance x is tensor(111.2164, device='cuda:1')
benign distance is  tensor(111.2164, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.7203321009874344
distance x is tensor(116.3830, device='cuda:1')
benign distance is  tensor(116.3830, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.7055930867791176
distance x is tensor(137.5668, device='cuda:1')
benign distance is  tensor(137.5668, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.869835201650858
distance x is tensor(81.3592, device='cuda:1')
benign distance is  tensor(81.3592, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.0205888263881207
distance x is tensor(158.5238, device='cuda:1')
benign distance is  tensor(158.5238, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.5216731391847134
distance x is tensor(140.8448, device='cuda:1')
benign distance is  tensor(140.8448, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.3162024095654488
distance x is tensor(106.6873, device='cuda:1')
benign distance is  tensor(106.6873, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5666579315438867
distance x is tensor(142.1600, device='cuda:1')
benign distance is  tensor(142.1600, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(86.5186, device='cuda:1')
compute distance is  tensor(86.5186, device='cuda:1')
compute norm is  tensor(55.2763, device='cuda:1', dtype=torch.float64)
distance x is tensor(141.1893, device='cuda:1')
compute distance is  tensor(141.1893, device='cuda:1')
compute norm is  tensor(56.2186, device='cuda:1', dtype=torch.float64)
distance x is tensor(102.6648, device='cuda:1')
compute distance is  tensor(102.6648, device='cuda:1')
compute norm is  tensor(55.3489, device='cuda:1', dtype=torch.float64)
distance x is tensor(103.2004, device='cuda:1')
compute distance is  tensor(103.2004, device='cuda:1')
compute norm is  tensor(55.5309, device='cuda:1', dtype=torch.float64)
distance x is tensor(86.8156, device='cuda:1')
compute distance is  tensor(86.8156, device='cuda:1')
compute norm is  tensor(55.3354, device='cuda:1', dtype=torch.float64)
distance x is tensor(113.0260, device='cuda:1')
compute distance is  tensor(113.0260, device='cuda:1')
compute norm is  tensor(55.7038, device='cuda:1', dtype=torch.float64)
distance x is tensor(119.3843, device='cuda:1')
compute distance is  tensor(119.3843, device='cuda:1')
compute norm is  tensor(55.7981, device='cuda:1', dtype=torch.float64)
distance x is tensor(94.1125, device='cuda:1')
compute distance is  tensor(94.1125, device='cuda:1')
compute norm is  tensor(55.3782, device='cuda:1', dtype=torch.float64)
distance x is tensor(116.3021, device='cuda:1')
compute distance is  tensor(116.3021, device='cuda:1')
compute norm is  tensor(55.7985, device='cuda:1', dtype=torch.float64)
distance x is tensor(101.0352, device='cuda:1')
compute distance is  tensor(101.0352, device='cuda:1')
compute norm is  tensor(55.6538, device='cuda:1', dtype=torch.float64)
distance x is tensor(112.2549, device='cuda:1')
compute distance is  tensor(112.2549, device='cuda:1')
compute norm is  tensor(55.6424, device='cuda:1', dtype=torch.float64)
distance x is tensor(151.0906, device='cuda:1')
compute distance is  tensor(151.0906, device='cuda:1')
compute norm is  tensor(56.5720, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(151.0906, device='cuda:1')
distance x is tensor(102009.9375, device='cuda:1')
distance x is tensor(102009.9375, device='cuda:1')
________________________________
test distance is  tensor(102009.9375, device='cuda:1')
test distance1 is  tensor(102009.9375, device='cuda:1')
test similarity is  tensor(0.3134, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107553459401725.81
test entropy is  0.0
________________________________
cal ratio is  0.03771581861689512
distance x is tensor(3847.3933, device='cuda:1')
cal_distance is  tensor(3847.3933, device='cuda:1')
cal ratio is  0.19420548129388274
distance x is tensor(747.1886, device='cuda:1')
cal_distance is  tensor(747.1886, device='cuda:1')
cal ratio is  0.4406864246949864
distance x is tensor(329.2784, device='cuda:1')
cal_distance is  tensor(329.2784, device='cuda:1')
cal ratio is  0.6638395673141226
distance x is tensor(218.5896, device='cuda:1')
cal_distance is  tensor(218.5896, device='cuda:1')
cal ratio is  0.8147606098336364
distance x is tensor(178.0990, device='cuda:1')
cal_distance is  tensor(178.0990, device='cuda:1')
cal ratio is  0.9026387760477745
distance x is tensor(160.7596, device='cuda:1')
cal_distance is  tensor(160.7596, device='cuda:1')
cal ratio is  0.9500716852572605
distance x is tensor(152.7334, device='cuda:1')
cal_distance is  tensor(152.7334, device='cuda:1')
cal ratio is  0.9747153326441036
distance x is tensor(148.8717, device='cuda:1')
cal_distance is  tensor(148.8717, device='cuda:1')
distance x is tensor(148.8717, device='cuda:1')
return_distance is  tensor(148.8717, device='cuda:1')
distance x is tensor(148.8625, device='cuda:1')
distance x is tensor(148.8625, device='cuda:1')
________________________________
test distance is  tensor(148.8625, device='cuda:1')
test distance1 is  tensor(148.8625, device='cuda:1')
test similarity is  tensor(0.9679, device='cuda:1')
test acc is  0.16041666682300068
test loss is 131.6008024073359
test entropy is  0.025918644452603463
________________________________
0
distance x is tensor(148.8625, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.0264142590985973
avg test loss is  131.58245146045806
avg accuracy is  0.4757166668230085
solo acc is  0.15953333348966728
compute similarity  is  tensor(0.9679, device='cuda:1')
compute_distance is  tensor(148.8625, device='cuda:1')
compute_norm is  tensor(58.5644, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(143.7555, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8856241448855857
avg test loss is  1.4891005853600086
avg accuracy is  0.8108500001563249
solo acc is  0.3162333334896732
compute similarity  is  tensor(0.9683, device='cuda:1')
compute_distance is  tensor(143.7555, device='cuda:1')
compute_norm is  tensor(58.0354, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(144.8071, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8722399825861713
avg test loss is  1.499346171106611
avg accuracy is  0.8071166668229917
solo acc is  0.27963333348967234
compute similarity  is  tensor(0.9679, device='cuda:1')
compute_distance is  tensor(144.8071, device='cuda:1')
compute_norm is  tensor(57.6921, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(145.7576, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.85918478276938
avg test loss is  1.47169964133041
avg accuracy is  0.8058333334896585
solo acc is  0.2705500001563388
compute similarity  is  tensor(0.9675, device='cuda:1')
compute_distance is  tensor(145.7576, device='cuda:1')
compute_norm is  tensor(57.3688, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(146.5981, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8603889319434095
avg test loss is  1.4327811545400477
avg accuracy is  0.8083166668229917
solo acc is  0.2726833334896722
compute similarity  is  tensor(0.9672, device='cuda:1')
compute_distance is  tensor(146.5981, device='cuda:1')
compute_norm is  tensor(57.0587, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distillation for acc
distance x is tensor(147.5093, device='cuda:1')
distance x is tensor(147.5093, device='cuda:1')
________________________________
test distance is  tensor(147.5093, device='cuda:1')
test distance1 is  tensor(147.5093, device='cuda:1')
test similarity is  tensor(0.9669, device='cuda:1')
test acc is  0.264983333489672
test loss is 1.4236962926159027
test entropy is  0.8435989197637481
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2550000001600001
mal loss is 1.4516905769705772
mal norm is  tensor(710.3201, device='cuda:1')
distance x is tensor(147.5176, device='cuda:1')
mal distance is  tensor(147.5176, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 15.37% 

Test Accuracy: 20.91% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8203724324703217
distance x is tensor(152.7684, device='cuda:1')
benign distance is  tensor(152.7684, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3391117304563522
distance x is tensor(113.5513, device='cuda:1')
benign distance is  tensor(113.5513, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5874996781349182
distance x is tensor(121.1465, device='cuda:1')
benign distance is  tensor(121.1465, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.5693348124623299
distance x is tensor(161.2418, device='cuda:1')
benign distance is  tensor(161.2418, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6197859570384026
distance x is tensor(134.2738, device='cuda:1')
benign distance is  tensor(134.2738, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9741806462407112
distance x is tensor(117.1750, device='cuda:1')
benign distance is  tensor(117.1750, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.216858819127083
distance x is tensor(127.4300, device='cuda:1')
benign distance is  tensor(127.4300, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3180637173354626
distance x is tensor(110.2635, device='cuda:1')
benign distance is  tensor(110.2635, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(112.9052, device='cuda:1')
compute distance is  tensor(112.9052, device='cuda:1')
compute norm is  tensor(58.0856, device='cuda:1', dtype=torch.float64)
distance x is tensor(153.4997, device='cuda:1')
compute distance is  tensor(153.4997, device='cuda:1')
compute norm is  tensor(58.9578, device='cuda:1', dtype=torch.float64)
distance x is tensor(128.6759, device='cuda:1')
compute distance is  tensor(128.6759, device='cuda:1')
compute norm is  tensor(58.2407, device='cuda:1', dtype=torch.float64)
distance x is tensor(142.0034, device='cuda:1')
compute distance is  tensor(142.0034, device='cuda:1')
compute norm is  tensor(58.7741, device='cuda:1', dtype=torch.float64)
distance x is tensor(118.2107, device='cuda:1')
compute distance is  tensor(118.2107, device='cuda:1')
compute norm is  tensor(58.0282, device='cuda:1', dtype=torch.float64)
distance x is tensor(138.5398, device='cuda:1')
compute distance is  tensor(138.5398, device='cuda:1')
compute norm is  tensor(58.6937, device='cuda:1', dtype=torch.float64)
distance x is tensor(133.9826, device='cuda:1')
compute distance is  tensor(133.9826, device='cuda:1')
compute norm is  tensor(58.5566, device='cuda:1', dtype=torch.float64)
distance x is tensor(113.4907, device='cuda:1')
compute distance is  tensor(113.4907, device='cuda:1')
compute norm is  tensor(58.0664, device='cuda:1', dtype=torch.float64)
distance x is tensor(131.9176, device='cuda:1')
compute distance is  tensor(131.9176, device='cuda:1')
compute norm is  tensor(58.6634, device='cuda:1', dtype=torch.float64)
distance x is tensor(122.4852, device='cuda:1')
compute distance is  tensor(122.4852, device='cuda:1')
compute norm is  tensor(58.3646, device='cuda:1', dtype=torch.float64)
distance x is tensor(129.8467, device='cuda:1')
compute distance is  tensor(129.8467, device='cuda:1')
compute norm is  tensor(58.4799, device='cuda:1', dtype=torch.float64)
distance x is tensor(194.8340, device='cuda:1')
compute distance is  tensor(194.8340, device='cuda:1')
compute norm is  tensor(60.5510, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(194.8340, device='cuda:1')
distance x is tensor(101898.9375, device='cuda:1')
distance x is tensor(101898.9375, device='cuda:1')
________________________________
test distance is  tensor(101898.9375, device='cuda:1')
test distance1 is  tensor(101898.9375, device='cuda:1')
test similarity is  tensor(0.5245, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107497247053339.3
test entropy is  0.0
________________________________
cal ratio is  0.04285224738503918
distance x is tensor(4366.6035, device='cuda:1')
cal_distance is  tensor(4366.6035, device='cuda:1')
cal ratio is  0.20700772044508778
distance x is tensor(903.9243, device='cuda:1')
cal_distance is  tensor(903.9243, device='cuda:1')
cal ratio is  0.4549801072026912
distance x is tensor(411.2701, device='cuda:1')
cal_distance is  tensor(411.2701, device='cuda:1')
cal ratio is  0.6745200957930589
distance x is tensor(277.4114, device='cuda:1')
cal_distance is  tensor(277.4114, device='cuda:1')
cal ratio is  0.8212895142035768
distance x is tensor(227.8359, device='cuda:1')
cal_distance is  tensor(227.8359, device='cuda:1')
cal ratio is  0.9062486194073914
distance x is tensor(206.4764, device='cuda:1')
cal_distance is  tensor(206.4764, device='cuda:1')
cal ratio is  0.9519698251191543
distance x is tensor(196.5595, device='cuda:1')
cal_distance is  tensor(196.5595, device='cuda:1')
cal ratio is  0.9756889004158779
distance x is tensor(191.7811, device='cuda:1')
cal_distance is  tensor(191.7811, device='cuda:1')
distance x is tensor(191.7811, device='cuda:1')
return_distance is  tensor(191.7811, device='cuda:1')
distance x is tensor(191.7719, device='cuda:1')
distance x is tensor(191.7719, device='cuda:1')
________________________________
test distance is  tensor(191.7719, device='cuda:1')
test distance1 is  tensor(191.7719, device='cuda:1')
test similarity is  tensor(0.9693, device='cuda:1')
test acc is  0.10000000015633198
test loss is 1038.42331199402
test entropy is  0.0
________________________________
0
distance x is tensor(191.7719, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  5.473550979497735e-41
avg test loss is  1037.7785632168052
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9693, device='cuda:1')
compute_distance is  tensor(191.7719, device='cuda:1')
compute_norm is  tensor(64.3151, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(17700.6152, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.5427399085782993
avg test loss is  2.9075986429064002
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0032, device='cuda:1')
compute_distance is  tensor(17700.6152, device='cuda:1')
compute_norm is  tensor(1474.0056, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(17619.0527, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8254777931455356
avg test loss is  3.6628822901609865
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0031, device='cuda:1')
compute_distance is  tensor(17619.0527, device='cuda:1')
compute_norm is  tensor(1467.3018, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(17537.7891, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.5561861708474312
avg test loss is  2.8658958218499286
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0032, device='cuda:1')
compute_distance is  tensor(17537.7891, device='cuda:1')
compute_norm is  tensor(1460.1610, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(17456.9609, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8298401969836465
avg test loss is  3.631407740782065
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0032, device='cuda:1')
compute_distance is  tensor(17456.9609, device='cuda:1')
compute_norm is  tensor(1453.5643, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(17376.3770, device='cuda:1')
distance x is tensor(17376.3770, device='cuda:1')
________________________________
test distance is  tensor(17376.3770, device='cuda:1')
test distance1 is  tensor(17376.3770, device='cuda:1')
test similarity is  tensor(-0.0032, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.8587720424635834
test entropy is  1.5581795653300499
________________________________
cal ratio is  0.10377167220790703
distance x is tensor(1803.1732, device='cuda:1')
cal_distance is  tensor(1803.1732, device='cuda:1')
cal ratio is  0.3221363335809428
distance x is tensor(580.8659, device='cuda:1')
cal_distance is  tensor(580.8659, device='cuda:1')
cal ratio is  0.5675713747992279
distance x is tensor(329.6819, device='cuda:1')
cal_distance is  tensor(329.6819, device='cuda:1')
cal ratio is  0.7533743754128448
distance x is tensor(248.3734, device='cuda:1')
cal_distance is  tensor(248.3734, device='cuda:1')
cal ratio is  0.8679723747033523
distance x is tensor(215.5809, device='cuda:1')
cal_distance is  tensor(215.5809, device='cuda:1')
cal ratio is  0.9316509666140796
distance x is tensor(200.8461, device='cuda:1')
cal_distance is  tensor(200.8461, device='cuda:1')
cal ratio is  0.9652210540284547
distance x is tensor(193.8608, device='cuda:1')
cal_distance is  tensor(193.8608, device='cuda:1')
distance x is tensor(193.8608, device='cuda:1')
return_distance is  tensor(193.8608, device='cuda:1')
distance x is tensor(193.8656, device='cuda:1')
distance x is tensor(193.8656, device='cuda:1')
________________________________
test distance is  tensor(193.8656, device='cuda:1')
test distance1 is  tensor(193.8656, device='cuda:1')
test similarity is  tensor(0.9514, device='cuda:1')
test acc is  0.10060000015633197
test loss is 15.500806770853396
test entropy is  0.2966726069241317
________________________________
0
distance x is tensor(193.8656, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.2962106418555606
avg test loss is  15.4889124390413
avg accuracy is  0.10000000015633198
solo acc is  0.10065000015633196
compute similarity  is  tensor(0.9514, device='cuda:1')
compute_distance is  tensor(193.8656, device='cuda:1')
compute_norm is  tensor(61.1638, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(208.5022, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.232482080774775
avg test loss is  2.1315421327344897
avg accuracy is  0.10000000015633198
solo acc is  0.1455833334896661
compute similarity  is  tensor(0.9494, device='cuda:1')
compute_distance is  tensor(208.5022, device='cuda:1')
compute_norm is  tensor(60.8758, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(209.3139, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.7279678710869381
avg test loss is  2.828920092155684
avg accuracy is  0.10000000015633198
solo acc is  0.10070000015633197
compute similarity  is  tensor(0.9493, device='cuda:1')
compute_distance is  tensor(209.3139, device='cuda:1')
compute_norm is  tensor(60.7124, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(212.8169, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.141198495939088
avg test loss is  1.8816629959576165
avg accuracy is  0.10001666682299865
solo acc is  0.16930000015633462
compute similarity  is  tensor(0.9488, device='cuda:1')
compute_distance is  tensor(212.8169, device='cuda:1')
compute_norm is  tensor(60.3768, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(213.3083, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.6678195787009908
avg test loss is  2.669874913911067
avg accuracy is  0.10000000015633198
solo acc is  0.10171666682299864
compute similarity  is  tensor(0.9487, device='cuda:1')
compute_distance is  tensor(213.3083, device='cuda:1')
compute_norm is  tensor(60.1936, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(216.4459, device='cuda:1')
distance x is tensor(216.4459, device='cuda:1')
________________________________
test distance is  tensor(216.4459, device='cuda:1')
test distance1 is  tensor(216.4459, device='cuda:1')
test similarity is  tensor(0.9482, device='cuda:1')
test acc is  0.17871666682300189
test loss is 1.790189007833314
test entropy is  1.0890579258582231
________________________________
cal ratio is  0.9297876285263286
distance x is tensor(201.2443, device='cuda:1')
cal_distance is  tensor(201.2443, device='cuda:1')
cal ratio is  0.9642654724991307
distance x is tensor(194.0529, device='cuda:1')
cal_distance is  tensor(194.0529, device='cuda:1')
distance x is tensor(194.0529, device='cuda:1')
return_distance is  tensor(194.0529, device='cuda:1')
distance x is tensor(194.0574, device='cuda:1')
distance x is tensor(194.0574, device='cuda:1')
________________________________
test distance is  tensor(194.0574, device='cuda:1')
test distance1 is  tensor(194.0574, device='cuda:1')
test similarity is  tensor(0.9581, device='cuda:1')
test acc is  0.12336666682299857
test loss is 3.5617432726471665
test entropy is  0.5812717608487936
________________________________
0
distance x is tensor(194.0574, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.582729167489609
avg test loss is  3.5634815535311506
avg accuracy is  0.10000000015633198
solo acc is  0.12301666682299857
compute similarity  is  tensor(0.9581, device='cuda:1')
compute_distance is  tensor(194.0574, device='cuda:1')
compute_norm is  tensor(59.2383, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(199.0953, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.0616983002436948
avg test loss is  1.696547372636002
avg accuracy is  0.10005000015633199
solo acc is  0.1896166668230025
compute similarity  is  tensor(0.9571, device='cuda:1')
compute_distance is  tensor(199.0953, device='cuda:1')
compute_norm is  tensor(59.0201, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(199.5432, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.6290419525556219
avg test loss is  2.508055594938396
avg accuracy is  0.10000000015633198
solo acc is  0.1018833334896653
compute similarity  is  tensor(0.9570, device='cuda:1')
compute_distance is  tensor(199.5432, device='cuda:1')
compute_norm is  tensor(58.8181, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(202.2573, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.0191122951156804
avg test loss is  1.6466907949081615
avg accuracy is  0.10006666682299865
solo acc is  0.19781666682300286
compute similarity  is  tensor(0.9564, device='cuda:1')
compute_distance is  tensor(202.2573, device='cuda:1')
compute_norm is  tensor(58.5333, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(202.7232, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.6347184018539721
avg test loss is  2.4196562021017582
avg accuracy is  0.10000000015633198
solo acc is  0.10156666682299864
compute similarity  is  tensor(0.9563, device='cuda:1')
compute_distance is  tensor(202.7232, device='cuda:1')
compute_norm is  tensor(58.3299, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(205.0243, device='cuda:1')
________________________________
test distance is  tensor(205.0243, device='cuda:1')
test similarity is  tensor(0.9559, device='cuda:1')
test acc is  0.10013333348966531
test loss is 1.6167619496520393
test entropy is  1.00392263053831
________________________________
final entropy
distance x is tensor(205.0287, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.0045199749439255
avg test loss is  1.6155945193538788
avg accuracy is  0.10016666682299866
solo acc is  0.19073333348966925
compute similarity  is  tensor(0.9559, device='cuda:1')
compute_distance is  tensor(205.0287, device='cuda:1')
compute_norm is  tensor(58.0434, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 2.3929837197065353
mal norm is  tensor(806.4359, device='cuda:1')
distance x is tensor(205.5587, device='cuda:1')
mal distance is  tensor(205.5587, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([12., 32., 25., 23., 17., 16., 12., 30., 24., 24., 24., 24., 24., 24.,
        24., 24., 24., 24., 24., 24., 12., 27., 12., 12.,  2., 12., 20., 20.,
        12., 12., 16., 30., 12., 13.,  2., 15.])
count_res tensor([1.6072e-09, 7.7974e-01, 7.1103e-04, 9.6227e-05, 2.3852e-07, 8.7748e-08,
        1.6072e-09, 1.0553e-01, 2.6157e-04, 2.6157e-04, 2.6157e-04, 2.6157e-04,
        2.6157e-04, 2.6157e-04, 2.6157e-04, 2.6157e-04, 2.6157e-04, 2.6157e-04,
        2.6157e-04, 2.6157e-04, 1.6072e-09, 5.2538e-03, 1.6072e-09, 1.6072e-09,
        7.2965e-14, 1.6072e-09, 4.7909e-06, 4.7909e-06, 1.6072e-09, 1.6072e-09,
        8.7748e-08, 1.0553e-01, 1.6072e-09, 4.3687e-09, 7.2965e-14, 3.2281e-08])
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 45.32% 

Test Accuracy: 74.59% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8453725259751081
distance x is tensor(146.1243, device='cuda:1')
benign distance is  tensor(146.1243, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.1593258529901505
distance x is tensor(75.5271, device='cuda:1')
benign distance is  tensor(75.5271, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.40814745426178
distance x is tensor(116.1833, device='cuda:1')
benign distance is  tensor(116.1833, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.043620429933071
distance x is tensor(168.6800, device='cuda:1')
benign distance is  tensor(168.6800, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.2523372620344162
distance x is tensor(109.9049, device='cuda:1')
benign distance is  tensor(109.9049, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.266431089490652
distance x is tensor(120.5723, device='cuda:1')
benign distance is  tensor(120.5723, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.364001125097275
distance x is tensor(117.1264, device='cuda:1')
benign distance is  tensor(117.1264, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.4318729117512703
distance x is tensor(102.7361, device='cuda:1')
benign distance is  tensor(102.7361, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.8234896585345268
distance x is tensor(105.9615, device='cuda:1')
benign distance is  tensor(105.9615, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.256498895585537
distance x is tensor(148.4098, device='cuda:1')
benign distance is  tensor(148.4098, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.1855666600167751
distance x is tensor(98.6936, device='cuda:1')
benign distance is  tensor(98.6936, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.2137815803289413
distance x is tensor(111.3055, device='cuda:1')
benign distance is  tensor(111.3055, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.9541942775249481
distance x is tensor(173.3339, device='cuda:1')
benign distance is  tensor(173.3339, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.3102615401148796
distance x is tensor(89.0614, device='cuda:1')
benign distance is  tensor(89.0614, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.3822809532284737
distance x is tensor(147.8006, device='cuda:1')
benign distance is  tensor(147.8006, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  4.756545186042786
distance x is tensor(132.2249, device='cuda:1')
benign distance is  tensor(132.2249, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  1.541879277676344
distance x is tensor(130.8982, device='cuda:1')
benign distance is  tensor(130.8982, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.214831743389368
distance x is tensor(102.2489, device='cuda:1')
benign distance is  tensor(102.2489, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.9228715747594833
distance x is tensor(134.1750, device='cuda:1')
benign distance is  tensor(134.1750, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  3.1079228818416595
distance x is tensor(117.8930, device='cuda:1')
benign distance is  tensor(117.8930, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.4865924380719662
distance x is tensor(144.6736, device='cuda:1')
benign distance is  tensor(144.6736, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.6409263089299202
distance x is tensor(127.0832, device='cuda:1')
benign distance is  tensor(127.0832, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.648034768179059
distance x is tensor(130.2328, device='cuda:1')
benign distance is  tensor(130.2328, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.0320343747735023
distance x is tensor(173.3313, device='cuda:1')
benign distance is  tensor(173.3313, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(96.2933, device='cuda:1')
compute distance is  tensor(96.2933, device='cuda:1')
compute norm is  tensor(58.6578, device='cuda:1', dtype=torch.float64)
distance x is tensor(146.5641, device='cuda:1')
compute distance is  tensor(146.5641, device='cuda:1')
compute norm is  tensor(59.4064, device='cuda:1', dtype=torch.float64)
distance x is tensor(109.4706, device='cuda:1')
compute distance is  tensor(109.4706, device='cuda:1')
compute norm is  tensor(58.7552, device='cuda:1', dtype=torch.float64)
distance x is tensor(125.9592, device='cuda:1')
compute distance is  tensor(125.9592, device='cuda:1')
compute norm is  tensor(59.1726, device='cuda:1', dtype=torch.float64)
distance x is tensor(92.7115, device='cuda:1')
compute distance is  tensor(92.7115, device='cuda:1')
compute norm is  tensor(58.5557, device='cuda:1', dtype=torch.float64)
distance x is tensor(122.2908, device='cuda:1')
compute distance is  tensor(122.2908, device='cuda:1')
compute norm is  tensor(58.8642, device='cuda:1', dtype=torch.float64)
distance x is tensor(134.4398, device='cuda:1')
compute distance is  tensor(134.4398, device='cuda:1')
compute norm is  tensor(59.2570, device='cuda:1', dtype=torch.float64)
distance x is tensor(102.6428, device='cuda:1')
compute distance is  tensor(102.6428, device='cuda:1')
compute norm is  tensor(58.5237, device='cuda:1', dtype=torch.float64)
distance x is tensor(132.3174, device='cuda:1')
compute distance is  tensor(132.3174, device='cuda:1')
compute norm is  tensor(59.1063, device='cuda:1', dtype=torch.float64)
distance x is tensor(116.6535, device='cuda:1')
compute distance is  tensor(116.6535, device='cuda:1')
compute norm is  tensor(59.0434, device='cuda:1', dtype=torch.float64)
distance x is tensor(111.6700, device='cuda:1')
compute distance is  tensor(111.6700, device='cuda:1')
compute norm is  tensor(58.7156, device='cuda:1', dtype=torch.float64)
distance x is tensor(148.5663, device='cuda:1')
compute distance is  tensor(148.5663, device='cuda:1')
compute norm is  tensor(59.8697, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(148.5663, device='cuda:1')
distance x is tensor(101931.7109, device='cuda:1')
distance x is tensor(101931.7109, device='cuda:1')
________________________________
test distance is  tensor(101931.7109, device='cuda:1')
test distance1 is  tensor(101931.7109, device='cuda:1')
test similarity is  tensor(0.4782, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107545156557852.39
test entropy is  0.0
________________________________
cal ratio is  0.03741378204775676
distance x is tensor(3813.6560, device='cuda:1')
cal_distance is  tensor(3813.6560, device='cuda:1')
cal ratio is  0.19342629124423785
distance x is tensor(737.6650, device='cuda:1')
cal_distance is  tensor(737.6650, device='cuda:1')
cal ratio is  0.43980148261407126
distance x is tensor(324.4288, device='cuda:1')
cal_distance is  tensor(324.4288, device='cuda:1')
cal ratio is  0.6631726363614752
distance x is tensor(215.1538, device='cuda:1')
cal_distance is  tensor(215.1538, device='cuda:1')
cal ratio is  0.8143512129218975
distance x is tensor(175.2116, device='cuda:1')
cal_distance is  tensor(175.2116, device='cuda:1')
cal ratio is  0.9024118983572849
distance x is tensor(158.1135, device='cuda:1')
cal_distance is  tensor(158.1135, device='cuda:1')
cal ratio is  0.9499522570734974
distance x is tensor(150.2005, device='cuda:1')
cal_distance is  tensor(150.2005, device='cuda:1')
cal ratio is  0.9746541935769587
distance x is tensor(146.3937, device='cuda:1')
cal_distance is  tensor(146.3937, device='cuda:1')
distance x is tensor(146.3937, device='cuda:1')
return_distance is  tensor(146.3937, device='cuda:1')
distance x is tensor(146.3846, device='cuda:1')
distance x is tensor(146.3846, device='cuda:1')
________________________________
test distance is  tensor(146.3846, device='cuda:1')
test distance1 is  tensor(146.3846, device='cuda:1')
test similarity is  tensor(0.9788, device='cuda:1')
test acc is  0.16746666682300113
test loss is 97.9230059235335
test entropy is  0.03150516617976165
________________________________
0
distance x is tensor(146.3846, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.030174538503457575
avg test loss is  97.8837209266386
avg accuracy is  0.541466666823009
solo acc is  0.16995000015633455
compute similarity  is  tensor(0.9788, device='cuda:1')
compute_distance is  tensor(146.3846, device='cuda:1')
compute_norm is  tensor(62.8939, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(141.1216, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9063626974503368
avg test loss is  1.408376931826443
avg accuracy is  0.786900000156326
solo acc is  0.31595000015633984
compute similarity  is  tensor(0.9791, device='cuda:1')
compute_distance is  tensor(141.1216, device='cuda:1')
compute_norm is  tensor(62.4347, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(141.1216, device='cuda:1')
distance x is tensor(141.1216, device='cuda:1')
________________________________
test distance is  tensor(141.1216, device='cuda:1')
test distance1 is  tensor(141.1216, device='cuda:1')
test similarity is  tensor(0.9791, device='cuda:1')
test acc is  0.3160500001563398
test loss is 1.4080948858881301
test entropy is  0.9070237934081031
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.30800000016000006
mal loss is 1.4403747841715813
mal norm is  tensor(712.3865, device='cuda:1')
distance x is tensor(141.1303, device='cuda:1')
mal distance is  tensor(141.1303, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([25., 14., 13., 17., 12., 16., 12.,  8., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 21., 12., 15., 12., 12., 12., 15.])
count_res tensor([9.8002e-01, 1.6368e-05, 6.0215e-06, 3.2876e-04, 2.2152e-06, 1.2094e-04,
        2.2152e-06, 4.0572e-08, 1.2094e-04, 1.2094e-04, 1.2094e-04, 1.2094e-04,
        1.2094e-04, 1.2094e-04, 1.2094e-04, 1.2094e-04, 1.2094e-04, 1.2094e-04,
        1.2094e-04, 1.2094e-04, 2.2152e-06, 1.7950e-02, 2.2152e-06, 4.4493e-05,
        2.2152e-06, 2.2152e-06, 2.2152e-06, 4.4493e-05])
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 90.78% 

Test Accuracy: 80.80% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  1.3106257244944572
distance x is tensor(97.9208, device='cuda:1')
benign distance is  tensor(97.9208, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.0591124817728996
distance x is tensor(110.1218, device='cuda:1')
benign distance is  tensor(110.1218, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.233736053109169
distance x is tensor(121.8935, device='cuda:1')
benign distance is  tensor(121.8935, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.7483583725988865
distance x is tensor(162.2892, device='cuda:1')
benign distance is  tensor(162.2892, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.0533441919833422
distance x is tensor(139.2978, device='cuda:1')
benign distance is  tensor(139.2978, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0634913630783558
distance x is tensor(122.2302, device='cuda:1')
benign distance is  tensor(122.2302, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.613111861050129
distance x is tensor(130.2349, device='cuda:1')
benign distance is  tensor(130.2349, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.5993541218340397
distance x is tensor(107.8514, device='cuda:1')
benign distance is  tensor(107.8514, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.7733809128403664
distance x is tensor(133.4757, device='cuda:1')
benign distance is  tensor(133.4757, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.3870769627392292
distance x is tensor(123.1378, device='cuda:1')
benign distance is  tensor(123.1378, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.8113812506198883
distance x is tensor(136.8320, device='cuda:1')
benign distance is  tensor(136.8320, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.3544841967523098
distance x is tensor(137.6651, device='cuda:1')
benign distance is  tensor(137.6651, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  2.0491626635193825
distance x is tensor(119.8157, device='cuda:1')
benign distance is  tensor(119.8157, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.8571986444294453
distance x is tensor(215.3055, device='cuda:1')
benign distance is  tensor(215.3055, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.7589386999607086
distance x is tensor(174.5000, device='cuda:1')
benign distance is  tensor(174.5000, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.0335350558161736
distance x is tensor(146.8797, device='cuda:1')
benign distance is  tensor(146.8797, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(108.5945, device='cuda:1')
compute distance is  tensor(108.5945, device='cuda:1')
compute norm is  tensor(60.4834, device='cuda:1', dtype=torch.float64)
distance x is tensor(149.0231, device='cuda:1')
compute distance is  tensor(149.0231, device='cuda:1')
compute norm is  tensor(61.2625, device='cuda:1', dtype=torch.float64)
distance x is tensor(118.6272, device='cuda:1')
compute distance is  tensor(118.6272, device='cuda:1')
compute norm is  tensor(60.3997, device='cuda:1', dtype=torch.float64)
distance x is tensor(114.7994, device='cuda:1')
compute distance is  tensor(114.7994, device='cuda:1')
compute norm is  tensor(60.5234, device='cuda:1', dtype=torch.float64)
distance x is tensor(103.1591, device='cuda:1')
compute distance is  tensor(103.1591, device='cuda:1')
compute norm is  tensor(60.2929, device='cuda:1', dtype=torch.float64)
distance x is tensor(124.7442, device='cuda:1')
compute distance is  tensor(124.7442, device='cuda:1')
compute norm is  tensor(60.9419, device='cuda:1', dtype=torch.float64)
distance x is tensor(136.0957, device='cuda:1')
compute distance is  tensor(136.0957, device='cuda:1')
compute norm is  tensor(60.8666, device='cuda:1', dtype=torch.float64)
distance x is tensor(114.8836, device='cuda:1')
compute distance is  tensor(114.8836, device='cuda:1')
compute norm is  tensor(60.3713, device='cuda:1', dtype=torch.float64)
distance x is tensor(135.8931, device='cuda:1')
compute distance is  tensor(135.8931, device='cuda:1')
compute norm is  tensor(60.9509, device='cuda:1', dtype=torch.float64)
distance x is tensor(109.8543, device='cuda:1')
compute distance is  tensor(109.8543, device='cuda:1')
compute norm is  tensor(60.6009, device='cuda:1', dtype=torch.float64)
distance x is tensor(127.5513, device='cuda:1')
compute distance is  tensor(127.5513, device='cuda:1')
compute norm is  tensor(60.7012, device='cuda:1', dtype=torch.float64)
distance x is tensor(159.9892, device='cuda:1')
compute distance is  tensor(159.9892, device='cuda:1')
compute norm is  tensor(61.6698, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(159.9892, device='cuda:1')
distance x is tensor(101954.9844, device='cuda:1')
distance x is tensor(101954.9844, device='cuda:1')
________________________________
test distance is  tensor(101954.9844, device='cuda:1')
test distance1 is  tensor(101954.9844, device='cuda:1')
test similarity is  tensor(0.4391, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107612272057616.92
test entropy is  0.0
________________________________
cal ratio is  0.038821038834446694
distance x is tensor(3958.0042, device='cuda:1')
cal_distance is  tensor(3958.0042, device='cuda:1')
cal ratio is  0.19703040654473064
distance x is tensor(779.8508, device='cuda:1')
cal_distance is  tensor(779.8508, device='cuda:1')
cal ratio is  0.4438800542205814
distance x is tensor(346.1627, device='cuda:1')
cal_distance is  tensor(346.1627, device='cuda:1')
cal ratio is  0.6662408420781452
distance x is tensor(230.6293, device='cuda:1')
cal_distance is  tensor(230.6293, device='cuda:1')
cal ratio is  0.816232997985939
distance x is tensor(188.2481, device='cuda:1')
cal_distance is  tensor(188.2481, device='cuda:1')
cal ratio is  0.9034541642543317
distance x is tensor(170.0740, device='cuda:1')
cal_distance is  tensor(170.0740, device='cuda:1')
cal ratio is  0.950500767720558
distance x is tensor(161.6557, device='cuda:1')
cal_distance is  tensor(161.6557, device='cuda:1')
cal ratio is  0.9749356011739567
distance x is tensor(157.6040, device='cuda:1')
cal_distance is  tensor(157.6040, device='cuda:1')
distance x is tensor(157.6040, device='cuda:1')
return_distance is  tensor(157.6040, device='cuda:1')
distance x is tensor(157.5949, device='cuda:1')
distance x is tensor(157.5949, device='cuda:1')
________________________________
test distance is  tensor(157.5949, device='cuda:1')
test distance1 is  tensor(157.5949, device='cuda:1')
test similarity is  tensor(0.9755, device='cuda:1')
test acc is  0.15950000015633395
test loss is 88.93421846564645
test entropy is  0.01773906986790913
________________________________
0
distance x is tensor(157.5949, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.0175889549702657
avg test loss is  89.00613118641412
avg accuracy is  0.5660333334896738
solo acc is  0.15866666682300057
compute similarity  is  tensor(0.9755, device='cuda:1')
compute_distance is  tensor(157.5949, device='cuda:1')
compute_norm is  tensor(64.8330, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1840.0049, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.5386699870196996
avg test loss is  2.8987038010981547
avg accuracy is  0.04283333348966571
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2560, device='cuda:1')
compute_distance is  tensor(1840.0049, device='cuda:1')
compute_norm is  tensor(226.3134, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1831.6493, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8276085812908246
avg test loss is  3.661414678417035
avg accuracy is  0.04308333348966571
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2561, device='cuda:1')
compute_distance is  tensor(1831.6493, device='cuda:1')
compute_norm is  tensor(225.4473, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1822.7704, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.5557162339753434
avg test loss is  2.874301165660053
avg accuracy is  0.04410000015633237
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2559, device='cuda:1')
compute_distance is  tensor(1822.7704, device='cuda:1')
compute_norm is  tensor(224.1039, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1814.5575, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8313665247039754
avg test loss is  3.644348373545258
avg accuracy is  0.045816666822999
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2560, device='cuda:1')
compute_distance is  tensor(1814.5575, device='cuda:1')
compute_norm is  tensor(223.2794, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1805.8193, device='cuda:1')
distance x is tensor(1805.8193, device='cuda:1')
________________________________
test distance is  tensor(1805.8193, device='cuda:1')
test distance1 is  tensor(1805.8193, device='cuda:1')
test similarity is  tensor(0.2558, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.8732220971508067
test entropy is  1.5537988438026737
________________________________
cal ratio is  0.29169852407836955
distance x is tensor(526.7554, device='cuda:1')
cal_distance is  tensor(526.7554, device='cuda:1')
cal ratio is  0.5400909271444572
distance x is tensor(284.4961, device='cuda:1')
cal_distance is  tensor(284.4961, device='cuda:1')
cal ratio is  0.7349084423577673
distance x is tensor(209.0787, device='cuda:1')
cal_distance is  tensor(209.0787, device='cuda:1')
cal ratio is  0.8572678537843016
distance x is tensor(179.2365, device='cuda:1')
cal_distance is  tensor(179.2365, device='cuda:1')
cal ratio is  0.9258873316897794
distance x is tensor(165.9529, device='cuda:1')
cal_distance is  tensor(165.9529, device='cuda:1')
cal ratio is  0.9622302570364232
distance x is tensor(159.6849, device='cuda:1')
cal_distance is  tensor(159.6849, device='cuda:1')
distance x is tensor(159.6849, device='cuda:1')
return_distance is  tensor(159.6849, device='cuda:1')
distance x is tensor(159.6840, device='cuda:1')
distance x is tensor(159.6840, device='cuda:1')
________________________________
test distance is  tensor(159.6840, device='cuda:1')
test distance1 is  tensor(159.6840, device='cuda:1')
test similarity is  tensor(0.9383, device='cuda:1')
test acc is  0.09700000015633199
test loss is 289.0309165840718
test entropy is  0.10910361611457077
________________________________
0
distance x is tensor(159.6840, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.10903752896823544
avg test loss is  286.42571982442695
avg accuracy is  0.10483333348966532
solo acc is  0.09990000015633199
compute similarity  is  tensor(0.9383, device='cuda:1')
compute_distance is  tensor(159.6840, device='cuda:1')
compute_norm is  tensor(65.8738, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(297.1243, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.4904663602172186
avg test loss is  2.8009745152011862
avg accuracy is  0.14586666682299948
solo acc is  0.09998333348966532
compute similarity  is  tensor(0.8815, device='cuda:1')
compute_distance is  tensor(297.1243, device='cuda:1')
compute_norm is  tensor(69.2780, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(296.7878, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.822056148987589
avg test loss is  3.529548487937781
avg accuracy is  0.14503333348966604
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8812, device='cuda:1')
compute_distance is  tensor(296.7878, device='cuda:1')
compute_norm is  tensor(69.1284, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(296.6699, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.4528492864515228
avg test loss is  2.709843072301543
avg accuracy is  0.1488166668229998
solo acc is  0.10008333348966532
compute similarity  is  tensor(0.8811, device='cuda:1')
compute_distance is  tensor(296.6699, device='cuda:1')
compute_norm is  tensor(68.5824, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(296.6019, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8206541721881834
avg test loss is  3.399948929418633
avg accuracy is  0.148000000156333
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.8808, device='cuda:1')
compute_distance is  tensor(296.6019, device='cuda:1')
compute_norm is  tensor(68.4525, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(296.7864, device='cuda:1')
distance x is tensor(296.7864, device='cuda:1')
________________________________
test distance is  tensor(296.7864, device='cuda:1')
test distance1 is  tensor(296.7864, device='cuda:1')
test similarity is  tensor(0.8807, device='cuda:1')
test acc is  0.1012333334896653
test loss is 2.518159081432611
test entropy is  1.3651650680153609
________________________________
cal ratio is  0.7195307881605424
distance x is tensor(213.5441, device='cuda:1')
cal_distance is  tensor(213.5441, device='cuda:1')
cal ratio is  0.8482572872496432
distance x is tensor(181.1401, device='cuda:1')
cal_distance is  tensor(181.1401, device='cuda:1')
cal ratio is  0.921009547389638
distance x is tensor(166.8316, device='cuda:1')
cal_distance is  tensor(166.8316, device='cuda:1')
cal ratio is  0.9596927317355919
distance x is tensor(160.1070, device='cuda:1')
cal_distance is  tensor(160.1070, device='cuda:1')
cal ratio is  0.9796392360887746
distance x is tensor(156.8471, device='cuda:1')
cal_distance is  tensor(156.8471, device='cuda:1')
distance x is tensor(156.8471, device='cuda:1')
return_distance is  tensor(156.8471, device='cuda:1')
distance x is tensor(156.8504, device='cuda:1')
distance x is tensor(156.8504, device='cuda:1')
________________________________
test distance is  tensor(156.8504, device='cuda:1')
test distance1 is  tensor(156.8504, device='cuda:1')
test similarity is  tensor(0.9632, device='cuda:1')
test acc is  0.13021666682299857
test loss is 5.887934141067554
test entropy is  0.7881573644528257
________________________________
0
distance x is tensor(156.8504, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.7878505225692477
avg test loss is  5.862767727136103
avg accuracy is  0.18223333348966875
solo acc is  0.12930000015633192
compute similarity  is  tensor(0.9632, device='cuda:1')
compute_distance is  tensor(156.8504, device='cuda:1')
compute_norm is  tensor(61.6887, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(164.4381, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.1600914892357295
avg test loss is  1.8377846273532046
avg accuracy is  0.19666666682300282
solo acc is  0.19430000015633606
compute similarity  is  tensor(0.9623, device='cuda:1')
compute_distance is  tensor(164.4381, device='cuda:1')
compute_norm is  tensor(61.5028, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(165.8230, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.6846037857822264
avg test loss is  2.65598094082082
avg accuracy is  0.18325000015633544
solo acc is  0.10431666682299863
compute similarity  is  tensor(0.9618, device='cuda:1')
compute_distance is  tensor(165.8230, device='cuda:1')
compute_norm is  tensor(61.3294, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(168.4037, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.0727731376441556
avg test loss is  1.7300872993367566
avg accuracy is  0.2032500001563365
solo acc is  0.20851666682300335
compute similarity  is  tensor(0.9617, device='cuda:1')
compute_distance is  tensor(168.4037, device='cuda:1')
compute_norm is  tensor(60.9851, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(169.5083, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.6552285406508171
avg test loss is  2.532350298438245
avg accuracy is  0.1881333334896691
solo acc is  0.10470000015633196
compute similarity  is  tensor(0.9613, device='cuda:1')
compute_distance is  tensor(169.5083, device='cuda:1')
compute_norm is  tensor(60.7906, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(171.8060, device='cuda:1')
________________________________
test distance is  tensor(171.8060, device='cuda:1')
test similarity is  tensor(0.9612, device='cuda:1')
test acc is  0.21123333348967016
test loss is 1.6621864378325213
test entropy is  1.021694454938364
________________________________
final entropy
distance x is tensor(171.8100, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.0224270385973997
avg test loss is  1.6603520726090046
avg accuracy is  0.21145000015633683
solo acc is  0.21658333348967035
compute similarity  is  tensor(0.9612, device='cuda:1')
compute_distance is  tensor(171.8100, device='cuda:1')
compute_norm is  tensor(60.4418, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.11400000016000002
mal loss is 2.426998198032379
mal norm is  tensor(782.2527, device='cuda:1')
distance x is tensor(172.9844, device='cuda:1')
mal distance is  tensor(172.9844, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([12., 12., 12., 12.,  5., 12., 12., 14., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 13., 19., 21., 12., 20., 12., 26., 14.])
count_res tensor([8.2273e-07, 8.2273e-07, 8.2273e-07, 8.2273e-07, 7.5023e-10, 8.2273e-07,
        8.2273e-07, 6.0792e-06, 4.4920e-05, 4.4920e-05, 4.4920e-05, 4.4920e-05,
        4.4920e-05, 4.4920e-05, 4.4920e-05, 4.4920e-05, 4.4920e-05, 4.4920e-05,
        4.4920e-05, 4.4920e-05, 2.2364e-06, 9.0223e-04, 6.6667e-03, 8.2273e-07,
        2.4525e-03, 8.2273e-07, 9.8942e-01, 6.0792e-06])
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 50.20% 

Test Accuracy: 73.79% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7775032576173544
distance x is tensor(142.2419, device='cuda:1')
benign distance is  tensor(142.2419, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.0562883466482162
distance x is tensor(115.6912, device='cuda:1')
benign distance is  tensor(115.6912, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.5915036723017693
distance x is tensor(118.2655, device='cuda:1')
benign distance is  tensor(118.2655, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.7256445363163948
distance x is tensor(153.2723, device='cuda:1')
benign distance is  tensor(153.2723, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.040334891527891
distance x is tensor(138.6753, device='cuda:1')
benign distance is  tensor(138.6753, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.9009930193424225
distance x is tensor(120.3744, device='cuda:1')
benign distance is  tensor(120.3744, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6800466738641262
distance x is tensor(130.7480, device='cuda:1')
benign distance is  tensor(130.7480, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.5029931887984276
distance x is tensor(108.4934, device='cuda:1')
benign distance is  tensor(108.4934, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.8438853919506073
distance x is tensor(108.6527, device='cuda:1')
benign distance is  tensor(108.6527, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.2970854118466377
distance x is tensor(135.3352, device='cuda:1')
benign distance is  tensor(135.3352, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.3095100298523903
distance x is tensor(89.8656, device='cuda:1')
benign distance is  tensor(89.8656, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.8591685816645622
distance x is tensor(114.5498, device='cuda:1')
benign distance is  tensor(114.5498, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  3.112955868244171
distance x is tensor(168.4542, device='cuda:1')
benign distance is  tensor(168.4542, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.7394519671797752
distance x is tensor(86.4795, device='cuda:1')
benign distance is  tensor(86.4795, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.7502900324761868
distance x is tensor(120.3550, device='cuda:1')
benign distance is  tensor(120.3550, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.0259784907102585
distance x is tensor(127.7196, device='cuda:1')
benign distance is  tensor(127.7196, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(91.9068, device='cuda:1')
compute distance is  tensor(91.9068, device='cuda:1')
compute norm is  tensor(59.8950, device='cuda:1', dtype=torch.float64)
distance x is tensor(147.5539, device='cuda:1')
compute distance is  tensor(147.5539, device='cuda:1')
compute norm is  tensor(60.7108, device='cuda:1', dtype=torch.float64)
distance x is tensor(113.8105, device='cuda:1')
compute distance is  tensor(113.8105, device='cuda:1')
compute norm is  tensor(59.9998, device='cuda:1', dtype=torch.float64)
distance x is tensor(109.0486, device='cuda:1')
compute distance is  tensor(109.0486, device='cuda:1')
compute norm is  tensor(59.9867, device='cuda:1', dtype=torch.float64)
distance x is tensor(99.4968, device='cuda:1')
compute distance is  tensor(99.4968, device='cuda:1')
compute norm is  tensor(59.8746, device='cuda:1', dtype=torch.float64)
distance x is tensor(118.9844, device='cuda:1')
compute distance is  tensor(118.9844, device='cuda:1')
compute norm is  tensor(60.3126, device='cuda:1', dtype=torch.float64)
distance x is tensor(131.7661, device='cuda:1')
compute distance is  tensor(131.7661, device='cuda:1')
compute norm is  tensor(60.3432, device='cuda:1', dtype=torch.float64)
distance x is tensor(104.5889, device='cuda:1')
compute distance is  tensor(104.5889, device='cuda:1')
compute norm is  tensor(59.8428, device='cuda:1', dtype=torch.float64)
distance x is tensor(120.9470, device='cuda:1')
compute distance is  tensor(120.9470, device='cuda:1')
compute norm is  tensor(60.1878, device='cuda:1', dtype=torch.float64)
distance x is tensor(120.5883, device='cuda:1')
compute distance is  tensor(120.5883, device='cuda:1')
compute norm is  tensor(60.4856, device='cuda:1', dtype=torch.float64)
distance x is tensor(125.0338, device='cuda:1')
compute distance is  tensor(125.0338, device='cuda:1')
compute norm is  tensor(60.2415, device='cuda:1', dtype=torch.float64)
distance x is tensor(154.2182, device='cuda:1')
compute distance is  tensor(154.2182, device='cuda:1')
compute norm is  tensor(61.0938, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(154.2182, device='cuda:1')
distance x is tensor(101950.1250, device='cuda:1')
distance x is tensor(101950.1250, device='cuda:1')
________________________________
test distance is  tensor(101950.1250, device='cuda:1')
test distance1 is  tensor(101950.1250, device='cuda:1')
test similarity is  tensor(0.4495, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107617115682802.9
test entropy is  0.0
________________________________
cal ratio is  0.038115362543554715
distance x is tensor(3885.8711, device='cuda:1')
cal_distance is  tensor(3885.8711, device='cuda:1')
cal ratio is  0.1952314337340557
distance x is tensor(758.6478, device='cuda:1')
cal_distance is  tensor(758.6478, device='cuda:1')
cal ratio is  0.44184894012806664
distance x is tensor(335.2103, device='cuda:1')
cal_distance is  tensor(335.2103, device='cuda:1')
cal ratio is  0.6647146993290121
distance x is tensor(222.8207, device='cuda:1')
cal_distance is  tensor(222.8207, device='cuda:1')
cal ratio is  0.8152975281773255
distance x is tensor(181.6661, device='cuda:1')
cal_distance is  tensor(181.6661, device='cuda:1')
cal ratio is  0.9029361297027737
distance x is tensor(164.0333, device='cuda:1')
cal_distance is  tensor(164.0333, device='cuda:1')
cal ratio is  0.9502282387716376
distance x is tensor(155.8693, device='cuda:1')
cal_distance is  tensor(155.8693, device='cuda:1')
cal ratio is  0.9747958471210344
distance x is tensor(151.9408, device='cuda:1')
cal_distance is  tensor(151.9408, device='cuda:1')
distance x is tensor(151.9408, device='cuda:1')
return_distance is  tensor(151.9408, device='cuda:1')
distance x is tensor(151.9317, device='cuda:1')
distance x is tensor(151.9317, device='cuda:1')
________________________________
test distance is  tensor(151.9317, device='cuda:1')
test distance1 is  tensor(151.9317, device='cuda:1')
test similarity is  tensor(0.9772, device='cuda:1')
test acc is  0.24905000015633816
test loss is 77.88456563400561
test entropy is  0.05248489371488002
________________________________
0
distance x is tensor(151.9317, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.05315076379474801
avg test loss is  77.58740690267925
avg accuracy is  0.5363000001563423
solo acc is  0.25043333348967156
compute similarity  is  tensor(0.9772, device='cuda:1')
compute_distance is  tensor(151.9317, device='cuda:1')
compute_norm is  tensor(64.2186, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(164.7200, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.1630221514432415
avg test loss is  1.8788431270290284
avg accuracy is  0.392800000156341
solo acc is  0.17778333348966846
compute similarity  is  tensor(0.9617, device='cuda:1')
compute_distance is  tensor(164.7200, device='cuda:1')
compute_norm is  tensor(66.3278, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(165.5681, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.6792381704489051
avg test loss is  2.6698485684038986
avg accuracy is  0.35841666682300716
solo acc is  0.10325000015633197
compute similarity  is  tensor(0.9614, device='cuda:1')
compute_distance is  tensor(165.5681, device='cuda:1')
compute_norm is  tensor(66.0992, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(167.3612, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.0557418231770936
avg test loss is  1.7219791821579435
avg accuracy is  0.4200500001563413
solo acc is  0.20383333348966992
compute similarity  is  tensor(0.9613, device='cuda:1')
compute_distance is  tensor(167.3612, device='cuda:1')
compute_norm is  tensor(65.7367, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(167.8691, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.6426416197056963
avg test loss is  2.530542286728491
avg accuracy is  0.37763333348967415
solo acc is  0.10330000015633196
compute similarity  is  tensor(0.9610, device='cuda:1')
compute_distance is  tensor(167.8691, device='cuda:1')
compute_norm is  tensor(65.4961, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(169.2172, device='cuda:1')
distance x is tensor(169.2172, device='cuda:1')
________________________________
test distance is  tensor(169.2172, device='cuda:1')
test distance1 is  tensor(169.2172, device='cuda:1')
test similarity is  tensor(0.9609, device='cuda:1')
test acc is  0.20980000015633676
test loss is 1.647473604948536
test entropy is  1.0318742691199663
________________________________
cal ratio is  0.935560184532214
distance x is tensor(158.3200, device='cuda:1')
cal_distance is  tensor(158.3200, device='cuda:1')
cal ratio is  0.967221657243822
distance x is tensor(153.1307, device='cuda:1')
cal_distance is  tensor(153.1307, device='cuda:1')
distance x is tensor(153.1307, device='cuda:1')
return_distance is  tensor(153.1307, device='cuda:1')
distance x is tensor(153.1232, device='cuda:1')
distance x is tensor(153.1232, device='cuda:1')
________________________________
test distance is  tensor(153.1232, device='cuda:1')
test distance1 is  tensor(153.1232, device='cuda:1')
test similarity is  tensor(0.9671, device='cuda:1')
test acc is  0.2557666668230051
test loss is 1.5497313817935203
test entropy is  1.1269215665646453
________________________________
0
distance x is tensor(153.1232, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.1281633126074826
avg test loss is  1.5551259775659931
avg accuracy is  0.4493500001563416
solo acc is  0.2554666668230051
compute similarity  is  tensor(0.9671, device='cuda:1')
compute_distance is  tensor(153.1232, device='cuda:1')
compute_norm is  tensor(64.3140, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(154.1664, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.6329678247160495
avg test loss is  2.475442081880468
avg accuracy is  0.4025500001563412
solo acc is  0.10285000015633197
compute similarity  is  tensor(0.9667, device='cuda:1')
compute_distance is  tensor(154.1664, device='cuda:1')
compute_norm is  tensor(64.0917, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(156.0104, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.01339698479628
avg test loss is  1.6022138281671732
avg accuracy is  0.45873333348967504
solo acc is  0.21365000015633687
compute similarity  is  tensor(0.9665, device='cuda:1')
compute_distance is  tensor(156.0104, device='cuda:1')
compute_norm is  tensor(63.7389, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(156.6385, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.6234372364305484
avg test loss is  2.4068655691929717
avg accuracy is  0.41640000015634127
solo acc is  0.10211666682299864
compute similarity  is  tensor(0.9662, device='cuda:1')
compute_distance is  tensor(156.6385, device='cuda:1')
compute_norm is  tensor(63.5045, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(158.0643, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.9957978466807652
avg test loss is  1.5548887078695968
avg accuracy is  0.46616666682300845
solo acc is  0.21768333348967048
compute similarity  is  tensor(0.9661, device='cuda:1')
compute_distance is  tensor(158.0643, device='cuda:1')
compute_norm is  tensor(63.1613, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(158.0643, device='cuda:1')
distance x is tensor(158.0643, device='cuda:1')
________________________________
test distance is  tensor(158.0643, device='cuda:1')
test distance1 is  tensor(158.0643, device='cuda:1')
test similarity is  tensor(0.9661, device='cuda:1')
test acc is  0.21613333348967037
test loss is 1.561926292839335
test entropy is  0.9978004556729086
________________________________
cal ratio is  0.9680038752675316
distance x is tensor(153.0140, device='cuda:1')
cal_distance is  tensor(153.0140, device='cuda:1')
distance x is tensor(153.0140, device='cuda:1')
return_distance is  tensor(153.0140, device='cuda:1')
distance x is tensor(153.0067, device='cuda:1')
distance x is tensor(153.0067, device='cuda:1')
________________________________
test distance is  tensor(153.0067, device='cuda:1')
test distance1 is  tensor(153.0067, device='cuda:1')
test similarity is  tensor(0.9680, device='cuda:1')
test acc is  0.2370500001563379
test loss is 1.5198068199381392
test entropy is  1.034012928827485
________________________________
0
distance x is tensor(153.0067, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.0337027153099523
avg test loss is  1.5189159005435544
avg accuracy is  0.47263333348967523
solo acc is  0.23475000015633773
compute similarity  is  tensor(0.9680, device='cuda:1')
compute_distance is  tensor(153.0067, device='cuda:1')
compute_norm is  tensor(62.9557, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(153.8630, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.6129142944174789
avg test loss is  2.3681491337605376
avg accuracy is  0.43285000015634145
solo acc is  0.10200000015633197
compute similarity  is  tensor(0.9676, device='cuda:1')
compute_distance is  tensor(153.8630, device='cuda:1')
compute_norm is  tensor(62.7283, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(155.3036, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.9824720687830626
avg test loss is  1.5226425421771719
avg accuracy is  0.48210000015634197
solo acc is  0.22401666682300406
compute similarity  is  tensor(0.9675, device='cuda:1')
compute_distance is  tensor(155.3036, device='cuda:1')
compute_norm is  tensor(62.3899, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(155.3109, device='cuda:1')
________________________________
test distance is  tensor(155.3109, device='cuda:1')
test similarity is  tensor(0.9675, device='cuda:1')
test acc is  0.4822833334896752
test loss is 1.5238747620887594
test entropy is  0.9831938205370262
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2200000001600001
mal loss is 1.5133984312415123
mal norm is  tensor(778.2235, device='cuda:1')
distance x is tensor(155.3109, device='cuda:1')
mal distance is  tensor(155.3109, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([12., 14., 10., 12., 12., 14., 12., 23., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 13., 21., 17., 18., 12., 12., 12., 14.])
count_res tensor([1.4447e-05, 1.0675e-04, 1.9553e-06, 1.4447e-05, 1.4447e-05, 1.0675e-04,
        1.4447e-05, 8.6503e-01, 7.8881e-04, 7.8881e-04, 7.8881e-04, 7.8881e-04,
        7.8881e-04, 7.8881e-04, 7.8881e-04, 7.8881e-04, 7.8881e-04, 7.8881e-04,
        7.8881e-04, 7.8881e-04, 3.9272e-05, 1.1707e-01, 2.1442e-03, 5.8285e-03,
        1.4447e-05, 1.4447e-05, 1.4447e-05, 1.0675e-04])
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 46.75% 

Test Accuracy: 74.30% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8161053210496902
distance x is tensor(136.6324, device='cuda:1')
benign distance is  tensor(136.6324, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.455102786421776
distance x is tensor(101.9155, device='cuda:1')
benign distance is  tensor(101.9155, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.6180794201791286
distance x is tensor(111.2254, device='cuda:1')
benign distance is  tensor(111.2254, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.1998085379600525
distance x is tensor(156.3284, device='cuda:1')
benign distance is  tensor(156.3284, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3335420526564121
distance x is tensor(119.4506, device='cuda:1')
benign distance is  tensor(119.4506, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.4583126492798328
distance x is tensor(113.6274, device='cuda:1')
benign distance is  tensor(113.6274, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.6510987281799316
distance x is tensor(117.2133, device='cuda:1')
benign distance is  tensor(117.2133, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.0549150742590427
distance x is tensor(71.1629, device='cuda:1')
benign distance is  tensor(71.1629, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.8588451817631721
distance x is tensor(131.6524, device='cuda:1')
benign distance is  tensor(131.6524, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  1.969059981405735
distance x is tensor(109.7030, device='cuda:1')
benign distance is  tensor(109.7030, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.5775138884782791
distance x is tensor(141.5328, device='cuda:1')
benign distance is  tensor(141.5328, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  3.572240471839905
distance x is tensor(133.3813, device='cuda:1')
benign distance is  tensor(133.3813, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  1.023316252976656
distance x is tensor(139.2805, device='cuda:1')
benign distance is  tensor(139.2805, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.7370633706450462
distance x is tensor(98.8423, device='cuda:1')
benign distance is  tensor(98.8423, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.436128295958042
distance x is tensor(107.3526, device='cuda:1')
benign distance is  tensor(107.3526, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  1.0186185128986835
distance x is tensor(135.2861, device='cuda:1')
benign distance is  tensor(135.2861, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(111.1931, device='cuda:1')
compute distance is  tensor(111.1931, device='cuda:1')
compute norm is  tensor(60.3084, device='cuda:1', dtype=torch.float64)
distance x is tensor(158.7951, device='cuda:1')
compute distance is  tensor(158.7951, device='cuda:1')
compute norm is  tensor(60.8879, device='cuda:1', dtype=torch.float64)
distance x is tensor(119.6882, device='cuda:1')
compute distance is  tensor(119.6882, device='cuda:1')
compute norm is  tensor(60.0818, device='cuda:1', dtype=torch.float64)
distance x is tensor(121.1350, device='cuda:1')
compute distance is  tensor(121.1350, device='cuda:1')
compute norm is  tensor(60.4473, device='cuda:1', dtype=torch.float64)
distance x is tensor(103.2915, device='cuda:1')
compute distance is  tensor(103.2915, device='cuda:1')
compute norm is  tensor(60.0973, device='cuda:1', dtype=torch.float64)
distance x is tensor(119.4392, device='cuda:1')
compute distance is  tensor(119.4392, device='cuda:1')
compute norm is  tensor(60.4523, device='cuda:1', dtype=torch.float64)
distance x is tensor(132.0143, device='cuda:1')
compute distance is  tensor(132.0143, device='cuda:1')
compute norm is  tensor(60.6117, device='cuda:1', dtype=torch.float64)
distance x is tensor(110.3810, device='cuda:1')
compute distance is  tensor(110.3810, device='cuda:1')
compute norm is  tensor(60.1867, device='cuda:1', dtype=torch.float64)
distance x is tensor(126.8720, device='cuda:1')
compute distance is  tensor(126.8720, device='cuda:1')
compute norm is  tensor(60.4208, device='cuda:1', dtype=torch.float64)
distance x is tensor(109.5836, device='cuda:1')
compute distance is  tensor(109.5836, device='cuda:1')
compute norm is  tensor(60.2772, device='cuda:1', dtype=torch.float64)
distance x is tensor(130.5545, device='cuda:1')
compute distance is  tensor(130.5545, device='cuda:1')
compute norm is  tensor(60.4765, device='cuda:1', dtype=torch.float64)
distance x is tensor(156.8725, device='cuda:1')
compute distance is  tensor(156.8725, device='cuda:1')
compute norm is  tensor(61.3207, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(158.7951, device='cuda:1')
distance x is tensor(101965.0781, device='cuda:1')
distance x is tensor(101965.0781, device='cuda:1')
________________________________
test distance is  tensor(101965.0781, device='cuda:1')
test distance1 is  tensor(101965.0781, device='cuda:1')
test similarity is  tensor(0.4240, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107543459912697.45
test entropy is  0.0
________________________________
cal ratio is  0.038673977308855884
distance x is tensor(3943.4004, device='cuda:1')
cal_distance is  tensor(3943.4004, device='cuda:1')
cal ratio is  0.19665687796224066
distance x is tensor(775.5004, device='cuda:1')
cal_distance is  tensor(775.5004, device='cuda:1')
cal ratio is  0.4434590791152212
distance x is tensor(343.9053, device='cuda:1')
cal_distance is  tensor(343.9053, device='cuda:1')
cal ratio is  0.6659247484333348
distance x is tensor(229.0166, device='cuda:1')
cal_distance is  tensor(229.0166, device='cuda:1')
cal ratio is  0.8160393747952139
distance x is tensor(186.8874, device='cuda:1')
cal_distance is  tensor(186.8874, device='cuda:1')
cal ratio is  0.903346918381937
distance x is tensor(168.8246, device='cuda:1')
cal_distance is  tensor(168.8246, device='cuda:1')
cal ratio is  0.9504443649482556
distance x is tensor(160.4586, device='cuda:1')
cal_distance is  tensor(160.4586, device='cuda:1')
cal ratio is  0.9749068299184281
distance x is tensor(156.4323, device='cuda:1')
cal_distance is  tensor(156.4323, device='cuda:1')
distance x is tensor(156.4323, device='cuda:1')
return_distance is  tensor(156.4323, device='cuda:1')
distance x is tensor(156.4232, device='cuda:1')
distance x is tensor(156.4232, device='cuda:1')
________________________________
test distance is  tensor(156.4232, device='cuda:1')
test distance1 is  tensor(156.4232, device='cuda:1')
test similarity is  tensor(0.9748, device='cuda:1')
test acc is  0.10616666682299862
test loss is 157.6601618053054
test entropy is  0.0025091233139073435
________________________________
0
distance x is tensor(156.4232, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.0025280939069869997
avg test loss is  157.46623866847838
avg accuracy is  0.4823500001563419
solo acc is  0.10605000015633195
compute similarity  is  tensor(0.9748, device='cuda:1')
compute_distance is  tensor(156.4232, device='cuda:1')
compute_norm is  tensor(64.2844, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1536.5469, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.535495770257165
avg test loss is  2.906658993092681
avg accuracy is  0.1185166668229986
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3451, device='cuda:1')
compute_distance is  tensor(1536.5469, device='cuda:1')
compute_norm is  tensor(161.3945, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1529.9025, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8296644366753381
avg test loss is  3.6623279110455056
avg accuracy is  0.11648333348966528
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3452, device='cuda:1')
compute_distance is  tensor(1529.9025, device='cuda:1')
compute_norm is  tensor(160.8312, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1522.8602, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.5545904951563267
avg test loss is  2.8757920232154666
avg accuracy is  0.1182166668229986
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3449, device='cuda:1')
compute_distance is  tensor(1522.8602, device='cuda:1')
compute_norm is  tensor(159.7846, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1516.3787, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8363003827361409
avg test loss is  3.639537608699758
avg accuracy is  0.11853333348966527
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3451, device='cuda:1')
compute_distance is  tensor(1516.3787, device='cuda:1')
compute_norm is  tensor(159.2642, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1509.4956, device='cuda:1')
distance x is tensor(1509.4956, device='cuda:1')
________________________________
test distance is  tensor(1509.4956, device='cuda:1')
test distance1 is  tensor(1509.4956, device='cuda:1')
test similarity is  tensor(0.3448, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.8700121580156437
test entropy is  1.554721469055615
________________________________
cal ratio is  0.3178547017782904
distance x is tensor(479.8017, device='cuda:1')
cal_distance is  tensor(479.8017, device='cuda:1')
cal ratio is  0.5637852076153724
distance x is tensor(270.5056, device='cuda:1')
cal_distance is  tensor(270.5056, device='cuda:1')
cal ratio is  0.7508556307527744
distance x is tensor(203.1109, device='cuda:1')
cal_distance is  tensor(203.1109, device='cuda:1')
cal ratio is  0.8665186688865835
distance x is tensor(175.9996, device='cuda:1')
cal_distance is  tensor(175.9996, device='cuda:1')
cal ratio is  0.9308694098888578
distance x is tensor(163.8327, device='cuda:1')
cal_distance is  tensor(163.8327, device='cuda:1')
cal ratio is  0.9648155763165239
distance x is tensor(158.0683, device='cuda:1')
cal_distance is  tensor(158.0683, device='cuda:1')
distance x is tensor(158.0683, device='cuda:1')
return_distance is  tensor(158.0683, device='cuda:1')
distance x is tensor(158.0662, device='cuda:1')
distance x is tensor(158.0662, device='cuda:1')
________________________________
test distance is  tensor(158.0662, device='cuda:1')
test distance1 is  tensor(158.0662, device='cuda:1')
test similarity is  tensor(0.9611, device='cuda:1')
test acc is  0.10888333348966528
test loss is 115.95036148364102
test entropy is  0.18709603069560615
________________________________
0
distance x is tensor(158.0662, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.18732762325610688
avg test loss is  116.23106978849562
avg accuracy is  0.17066666682300136
solo acc is  0.10716666682299864
compute similarity  is  tensor(0.9611, device='cuda:1')
compute_distance is  tensor(158.0662, device='cuda:1')
compute_norm is  tensor(62.6809, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(242.8280, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.314356931999548
avg test loss is  2.2585893528802052
avg accuracy is  0.32135000015633997
solo acc is  0.14485000015633273
compute similarity  is  tensor(0.9449, device='cuda:1')
compute_distance is  tensor(242.8280, device='cuda:1')
compute_norm is  tensor(63.2367, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(242.8094, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.7385453759098867
avg test loss is  3.010943993068199
avg accuracy is  0.3116166668230064
solo acc is  0.1015333334896653
compute similarity  is  tensor(0.9446, device='cuda:1')
compute_distance is  tensor(242.8094, device='cuda:1')
compute_norm is  tensor(63.1140, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(243.7672, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.0900107079477452
avg test loss is  1.8651504275132853
avg accuracy is  0.33495000015634013
solo acc is  0.212800000156337
compute similarity  is  tensor(0.9450, device='cuda:1')
compute_distance is  tensor(243.7672, device='cuda:1')
compute_norm is  tensor(62.6389, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(244.1140, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.6738023809405532
avg test loss is  2.637199551057714
avg accuracy is  0.3114166668230064
solo acc is  0.10715000015633196
compute similarity  is  tensor(0.9446, device='cuda:1')
compute_distance is  tensor(244.1140, device='cuda:1')
compute_norm is  tensor(62.4133, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(246.2844, device='cuda:1')
distance x is tensor(246.2844, device='cuda:1')
________________________________
test distance is  tensor(246.2844, device='cuda:1')
test distance1 is  tensor(246.2844, device='cuda:1')
test similarity is  tensor(0.9446, device='cuda:1')
test acc is  0.24053333348967124
test loss is 1.6488895639936045
test entropy is  1.0262311857138107
________________________________
cal ratio is  0.786911852657636
distance x is tensor(193.8032, device='cuda:1')
cal_distance is  tensor(193.8032, device='cuda:1')
cal ratio is  0.8870825983841484
distance x is tensor(171.9194, device='cuda:1')
cal_distance is  tensor(171.9194, device='cuda:1')
cal ratio is  0.9418507702096024
distance x is tensor(161.9224, device='cuda:1')
cal_distance is  tensor(161.9224, device='cuda:1')
cal ratio is  0.9704900899594352
distance x is tensor(157.1441, device='cuda:1')
cal_distance is  tensor(157.1441, device='cuda:1')
distance x is tensor(157.1441, device='cuda:1')
return_distance is  tensor(157.1441, device='cuda:1')
distance x is tensor(157.1451, device='cuda:1')
distance x is tensor(157.1451, device='cuda:1')
________________________________
test distance is  tensor(157.1451, device='cuda:1')
test distance1 is  tensor(157.1451, device='cuda:1')
test similarity is  tensor(0.9768, device='cuda:1')
test acc is  0.33018333348967344
test loss is 1.9274647803957274
test entropy is  1.007825549604542
________________________________
0
distance x is tensor(157.1451, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.009435887847628
avg test loss is  1.9323879941694264
avg accuracy is  0.5064500001563421
solo acc is  0.32745000015634
compute similarity  is  tensor(0.9768, device='cuda:1')
compute_distance is  tensor(157.1451, device='cuda:1')
compute_norm is  tensor(60.0292, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(162.0628, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.6445298896415401
avg test loss is  2.4894046065395576
avg accuracy is  0.48416666682300863
solo acc is  0.11555000015633193
compute similarity  is  tensor(0.9759, device='cuda:1')
compute_distance is  tensor(162.0628, device='cuda:1')
compute_norm is  tensor(59.7617, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(165.8759, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.932400782606495
avg test loss is  1.4200432646884593
avg accuracy is  0.5771166668230061
solo acc is  0.30256666682300626
compute similarity  is  tensor(0.9755, device='cuda:1')
compute_distance is  tensor(165.8759, device='cuda:1')
compute_norm is  tensor(59.3631, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(165.8741, device='cuda:1')
________________________________
test distance is  tensor(165.8741, device='cuda:1')
test similarity is  tensor(0.9755, device='cuda:1')
test acc is  0.5787333334896727
test loss is 1.4200910460084741
test entropy is  0.9330257875705833
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.31200000016000007
mal loss is 1.4135586023330688
mal norm is  tensor(613.3953, device='cuda:1')
distance x is tensor(165.8741, device='cuda:1')
mal distance is  tensor(165.8741, device='cuda:1')
user_PLR len size 52
counter_tensor is  tensor([18., 36., 39., 50., 12., 36., 13., 14., 40., 40., 40., 40., 40., 40.,
        40., 40., 40., 40., 40., 40., 47., 19., 17., 30., 12., 43., 20., 15.,
        22., 51., 15., 42., 23., 39., 34., 47.,  2.,  8., 22., 27., 15., 30.,
         3.,  3., 12.,  1., 26., 12., 12., 29., 27.,  1.])
count_res tensor([3.3155e-15, 2.1770e-07, 4.3725e-06, 2.6180e-01, 8.2183e-18, 2.1770e-07,
        2.2340e-17, 6.0726e-17, 1.1886e-05, 1.1886e-05, 1.1886e-05, 1.1886e-05,
        1.1886e-05, 1.1886e-05, 1.1886e-05, 1.1886e-05, 1.1886e-05, 1.1886e-05,
        1.1886e-05, 1.1886e-05, 1.3034e-02, 9.0125e-15, 1.2197e-15, 5.3961e-10,
        8.2183e-18, 2.3873e-04, 2.4498e-14, 1.6507e-16, 1.8102e-13, 7.1165e-01,
        1.6507e-16, 8.7825e-05, 4.9206e-13, 4.3725e-06, 2.9462e-08, 1.3034e-02,
        3.7311e-22, 1.5052e-19, 1.8102e-13, 2.6866e-11, 1.6507e-16, 5.3961e-10,
        1.0142e-21, 1.0142e-21, 8.2183e-18, 1.3726e-22, 9.8834e-12, 8.2183e-18,
        8.2183e-18, 1.9851e-10, 2.6866e-11, 1.3726e-22])
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 49.92% 

Test Accuracy: 76.09% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8949672356247902
distance x is tensor(125.2910, device='cuda:1')
benign distance is  tensor(125.2910, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.5705236084759235
distance x is tensor(90.3397, device='cuda:1')
benign distance is  tensor(90.3397, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.3680033460259438
distance x is tensor(119.3722, device='cuda:1')
benign distance is  tensor(119.3722, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.90785201638937
distance x is tensor(130.7005, device='cuda:1')
benign distance is  tensor(130.7005, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.9682104960083961
distance x is tensor(108.0673, device='cuda:1')
benign distance is  tensor(108.0673, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.3662556372582912
distance x is tensor(109.7912, device='cuda:1')
benign distance is  tensor(109.7912, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.4161500707268715
distance x is tensor(109.0750, device='cuda:1')
benign distance is  tensor(109.0750, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2745101787149906
distance x is tensor(93.4233, device='cuda:1')
benign distance is  tensor(93.4233, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.9514523297548294
distance x is tensor(100.7277, device='cuda:1')
benign distance is  tensor(100.7277, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.1943265050649643
distance x is tensor(132.4041, device='cuda:1')
benign distance is  tensor(132.4041, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.665001802146435
distance x is tensor(95.8092, device='cuda:1')
benign distance is  tensor(95.8092, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.6780259013175964
distance x is tensor(110.8102, device='cuda:1')
benign distance is  tensor(110.8102, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.5245256647467613
distance x is tensor(158.5672, device='cuda:1')
benign distance is  tensor(158.5672, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.4266772978007793
distance x is tensor(73.6173, device='cuda:1')
benign distance is  tensor(73.6173, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.2597516998648643
distance x is tensor(134.3522, device='cuda:1')
benign distance is  tensor(134.3522, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.9821620285511017
distance x is tensor(115.3563, device='cuda:1')
benign distance is  tensor(115.3563, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.0211271569132805
distance x is tensor(87.5350, device='cuda:1')
benign distance is  tensor(87.5350, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.5905354917049408
distance x is tensor(110.6865, device='cuda:1')
benign distance is  tensor(110.6865, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.543919287621975
distance x is tensor(124.8103, device='cuda:1')
benign distance is  tensor(124.8103, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  2.154985286295414
distance x is tensor(115.7759, device='cuda:1')
benign distance is  tensor(115.7759, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.8723746612668037
distance x is tensor(84.2832, device='cuda:1')
benign distance is  tensor(84.2832, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0618632920086384
distance x is tensor(198.5833, device='cuda:1')
benign distance is  tensor(198.5833, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.6457476690411568
distance x is tensor(145.3148, device='cuda:1')
benign distance is  tensor(145.3148, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.3619370646774769
distance x is tensor(133.6030, device='cuda:1')
benign distance is  tensor(133.6030, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.1931004896759987
distance x is tensor(123.8424, device='cuda:1')
benign distance is  tensor(123.8424, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.6049995049834251
distance x is tensor(55.6797, device='cuda:1')
benign distance is  tensor(55.6797, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.3708171844482422
distance x is tensor(127.9938, device='cuda:1')
benign distance is  tensor(127.9938, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  4.238201811909676
distance x is tensor(108.2525, device='cuda:1')
benign distance is  tensor(108.2525, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.371562521904707
distance x is tensor(128.8042, device='cuda:1')
benign distance is  tensor(128.8042, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.504103634506464
distance x is tensor(113.5268, device='cuda:1')
benign distance is  tensor(113.5268, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5144769567996264
distance x is tensor(126.5991, device='cuda:1')
benign distance is  tensor(126.5991, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.2621407732367516
distance x is tensor(162.5529, device='cuda:1')
benign distance is  tensor(162.5529, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  1.8841376453638077
distance x is tensor(102.6901, device='cuda:1')
benign distance is  tensor(102.6901, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.8433302342891693
distance x is tensor(133.8271, device='cuda:1')
benign distance is  tensor(133.8271, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  1.946671575307846
distance x is tensor(148.1360, device='cuda:1')
benign distance is  tensor(148.1360, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  1.87409657984972
distance x is tensor(94.4945, device='cuda:1')
benign distance is  tensor(94.4945, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.1983690336346626
distance x is tensor(155.5953, device='cuda:1')
benign distance is  tensor(155.5953, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.7812549248337746
distance x is tensor(132.4932, device='cuda:1')
benign distance is  tensor(132.4932, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.6877173632383347
distance x is tensor(104.1017, device='cuda:1')
benign distance is  tensor(104.1017, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.6360722556710243
distance x is tensor(142.1559, device='cuda:1')
benign distance is  tensor(142.1559, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(75.4802, device='cuda:1')
compute distance is  tensor(75.4802, device='cuda:1')
compute norm is  tensor(59.2289, device='cuda:1', dtype=torch.float64)
distance x is tensor(142.2003, device='cuda:1')
compute distance is  tensor(142.2003, device='cuda:1')
compute norm is  tensor(60.2908, device='cuda:1', dtype=torch.float64)
distance x is tensor(105.3817, device='cuda:1')
compute distance is  tensor(105.3817, device='cuda:1')
compute norm is  tensor(59.5274, device='cuda:1', dtype=torch.float64)
distance x is tensor(106.5255, device='cuda:1')
compute distance is  tensor(106.5255, device='cuda:1')
compute norm is  tensor(59.7874, device='cuda:1', dtype=torch.float64)
distance x is tensor(97.5474, device='cuda:1')
compute distance is  tensor(97.5474, device='cuda:1')
compute norm is  tensor(59.3948, device='cuda:1', dtype=torch.float64)
distance x is tensor(107.9061, device='cuda:1')
compute distance is  tensor(107.9061, device='cuda:1')
compute norm is  tensor(59.6083, device='cuda:1', dtype=torch.float64)
distance x is tensor(124.2165, device='cuda:1')
compute distance is  tensor(124.2165, device='cuda:1')
compute norm is  tensor(59.9760, device='cuda:1', dtype=torch.float64)
distance x is tensor(95.7977, device='cuda:1')
compute distance is  tensor(95.7977, device='cuda:1')
compute norm is  tensor(59.3887, device='cuda:1', dtype=torch.float64)
distance x is tensor(114.1980, device='cuda:1')
compute distance is  tensor(114.1980, device='cuda:1')
compute norm is  tensor(59.8484, device='cuda:1', dtype=torch.float64)
distance x is tensor(95.8056, device='cuda:1')
compute distance is  tensor(95.8056, device='cuda:1')
compute norm is  tensor(59.6099, device='cuda:1', dtype=torch.float64)
distance x is tensor(111.6686, device='cuda:1')
compute distance is  tensor(111.6686, device='cuda:1')
compute norm is  tensor(59.5715, device='cuda:1', dtype=torch.float64)
distance x is tensor(145.2650, device='cuda:1')
compute distance is  tensor(145.2650, device='cuda:1')
compute norm is  tensor(60.7362, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(145.2650, device='cuda:1')
distance x is tensor(101952.8516, device='cuda:1')
distance x is tensor(101952.8516, device='cuda:1')
________________________________
test distance is  tensor(101952.8516, device='cuda:1')
test distance1 is  tensor(101952.8516, device='cuda:1')
test similarity is  tensor(0.4466, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107487418913702.48
test entropy is  0.0
________________________________
cal ratio is  0.0369919222961444
distance x is tensor(3771.4370, device='cuda:1')
cal_distance is  tensor(3771.4370, device='cuda:1')
cal ratio is  0.19233271132912444
distance x is tensor(725.3745, device='cuda:1')
cal_distance is  tensor(725.3745, device='cuda:1')
cal ratio is  0.43855640499722925
distance x is tensor(318.1202, device='cuda:1')
cal_distance is  tensor(318.1202, device='cuda:1')
cal ratio is  0.6622332103051076
distance x is tensor(210.6713, device='cuda:1')
cal_distance is  tensor(210.6713, device='cuda:1')
cal ratio is  0.8137741377542305
distance x is tensor(171.4397, device='cuda:1')
cal_distance is  tensor(171.4397, device='cuda:1')
cal ratio is  0.9020920986795126
distance x is tensor(154.6549, device='cuda:1')
cal_distance is  tensor(154.6549, device='cuda:1')
cal ratio is  0.9497838450519279
distance x is tensor(146.8889, device='cuda:1')
cal_distance is  tensor(146.8889, device='cuda:1')
cal ratio is  0.974567793600873
distance x is tensor(143.1533, device='cuda:1')
cal_distance is  tensor(143.1533, device='cuda:1')
distance x is tensor(143.1533, device='cuda:1')
return_distance is  tensor(143.1533, device='cuda:1')
distance x is tensor(143.1442, device='cuda:1')
distance x is tensor(143.1442, device='cuda:1')
________________________________
test distance is  tensor(143.1442, device='cuda:1')
test distance1 is  tensor(143.1442, device='cuda:1')
test similarity is  tensor(0.9789, device='cuda:1')
test acc is  0.22240000015633735
test loss is 51.975422464708274
test entropy is  0.05710406624165965
________________________________
0
distance x is tensor(143.1442, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.056412383465211526
avg test loss is  51.90933471142864
avg accuracy is  0.6328333334896683
solo acc is  0.22320000015633734
compute similarity  is  tensor(0.9789, device='cuda:1')
compute_distance is  tensor(143.1442, device='cuda:1')
compute_norm is  tensor(63.3181, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(139.9889, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8947054847979596
avg test loss is  1.368615529557535
avg accuracy is  0.7499166668229945
solo acc is  0.33605000015634023
compute similarity  is  tensor(0.9786, device='cuda:1')
compute_distance is  tensor(139.9889, device='cuda:1')
compute_norm is  tensor(62.6986, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(139.9889, device='cuda:1')
distance x is tensor(139.9889, device='cuda:1')
________________________________
test distance is  tensor(139.9889, device='cuda:1')
test distance1 is  tensor(139.9889, device='cuda:1')
test similarity is  tensor(0.9786, device='cuda:1')
test acc is  0.33651666682300685
test loss is 1.3685084348167185
test entropy is  0.8952546916536684
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3370000001600001
mal loss is 1.3645660132169724
mal norm is  tensor(701.2657, device='cuda:1')
distance x is tensor(139.9970, device='cuda:1')
mal distance is  tensor(139.9970, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 28.17% 

Test Accuracy: 31.69% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.716343343257904
distance x is tensor(171.1703, device='cuda:1')
benign distance is  tensor(171.1703, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.6631334647536278
distance x is tensor(118.5240, device='cuda:1')
benign distance is  tensor(118.5240, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.6780072301626205
distance x is tensor(127.9290, device='cuda:1')
benign distance is  tensor(127.9290, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.7527702301740646
distance x is tensor(165.8761, device='cuda:1')
benign distance is  tensor(165.8761, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.050370544195175
distance x is tensor(130.6281, device='cuda:1')
benign distance is  tensor(130.6281, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2112350966781378
distance x is tensor(131.0257, device='cuda:1')
benign distance is  tensor(131.0257, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.0695933550596237
distance x is tensor(153.0222, device='cuda:1')
benign distance is  tensor(153.0222, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.6922113001346588
distance x is tensor(116.4348, device='cuda:1')
benign distance is  tensor(116.4348, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(109.0868, device='cuda:1')
compute distance is  tensor(109.0868, device='cuda:1')
compute norm is  tensor(64.0101, device='cuda:1', dtype=torch.float64)
distance x is tensor(163.5918, device='cuda:1')
compute distance is  tensor(163.5918, device='cuda:1')
compute norm is  tensor(64.8943, device='cuda:1', dtype=torch.float64)
distance x is tensor(124.2834, device='cuda:1')
compute distance is  tensor(124.2834, device='cuda:1')
compute norm is  tensor(64.0530, device='cuda:1', dtype=torch.float64)
distance x is tensor(126.7740, device='cuda:1')
compute distance is  tensor(126.7740, device='cuda:1')
compute norm is  tensor(64.2780, device='cuda:1', dtype=torch.float64)
distance x is tensor(122.2516, device='cuda:1')
compute distance is  tensor(122.2516, device='cuda:1')
compute norm is  tensor(63.9653, device='cuda:1', dtype=torch.float64)
distance x is tensor(136.1175, device='cuda:1')
compute distance is  tensor(136.1175, device='cuda:1')
compute norm is  tensor(64.3689, device='cuda:1', dtype=torch.float64)
distance x is tensor(157.5836, device='cuda:1')
compute distance is  tensor(157.5836, device='cuda:1')
compute norm is  tensor(64.8940, device='cuda:1', dtype=torch.float64)
distance x is tensor(103.7707, device='cuda:1')
compute distance is  tensor(103.7707, device='cuda:1')
compute norm is  tensor(63.8698, device='cuda:1', dtype=torch.float64)
distance x is tensor(136.4622, device='cuda:1')
compute distance is  tensor(136.4622, device='cuda:1')
compute norm is  tensor(64.5967, device='cuda:1', dtype=torch.float64)
distance x is tensor(132.0289, device='cuda:1')
compute distance is  tensor(132.0289, device='cuda:1')
compute norm is  tensor(64.5413, device='cuda:1', dtype=torch.float64)
distance x is tensor(143.4420, device='cuda:1')
compute distance is  tensor(143.4420, device='cuda:1')
compute norm is  tensor(64.4484, device='cuda:1', dtype=torch.float64)
distance x is tensor(161.7121, device='cuda:1')
compute distance is  tensor(161.7121, device='cuda:1')
compute norm is  tensor(65.3751, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(163.5918, device='cuda:1')
distance x is tensor(101831.2188, device='cuda:1')
distance x is tensor(101831.2188, device='cuda:1')
________________________________
test distance is  tensor(101831.2188, device='cuda:1')
test distance1 is  tensor(101831.2188, device='cuda:1')
test similarity is  tensor(0.6133, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107603514887449.66
test entropy is  0.0
________________________________
cal ratio is  0.03927953728965082
distance x is tensor(3999.8884, device='cuda:1')
cal_distance is  tensor(3999.8884, device='cuda:1')
cal ratio is  0.19819053076854032
distance x is tensor(792.7437, device='cuda:1')
cal_distance is  tensor(792.7437, device='cuda:1')
cal ratio is  0.44518492285311734
distance x is tensor(352.9200, device='cuda:1')
cal_distance is  tensor(352.9200, device='cuda:1')
cal ratio is  0.6672194332547924
distance x is tensor(235.4767, device='cuda:1')
cal_distance is  tensor(235.4767, device='cuda:1')
cal ratio is  0.8168322689318251
distance x is tensor(192.3458, device='cuda:1')
cal_distance is  tensor(192.3458, device='cuda:1')
cal ratio is  0.9037857696899254
distance x is tensor(173.8398, device='cuda:1')
cal_distance is  tensor(173.8398, device='cuda:1')
cal ratio is  0.9506752548377133
distance x is tensor(165.2654, device='cuda:1')
cal_distance is  tensor(165.2654, device='cuda:1')
cal ratio is  0.9750251389343729
distance x is tensor(161.1381, device='cuda:1')
cal_distance is  tensor(161.1381, device='cuda:1')
distance x is tensor(161.1381, device='cuda:1')
return_distance is  tensor(161.1381, device='cuda:1')
distance x is tensor(161.1289, device='cuda:1')
distance x is tensor(161.1289, device='cuda:1')
________________________________
test distance is  tensor(161.1289, device='cuda:1')
test distance1 is  tensor(161.1289, device='cuda:1')
test similarity is  tensor(0.9846, device='cuda:1')
test acc is  0.10000000015633198
test loss is 628.7716079744449
test entropy is  7.788902731955499e-29
________________________________
0
distance x is tensor(161.1289, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  3.2068447232551365e-28
avg test loss is  629.1802938823253
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9846, device='cuda:1')
compute_distance is  tensor(161.1289, device='cuda:1')
compute_norm is  tensor(69.5976, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(6764.0308, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.5269413385818253
avg test loss is  2.9149726044648747
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0788, device='cuda:1')
compute_distance is  tensor(6764.0308, device='cuda:1')
compute_norm is  tensor(723.3401, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(6733.6865, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8263433222958783
avg test loss is  3.650937491388463
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0788, device='cuda:1')
compute_distance is  tensor(6733.6865, device='cuda:1')
compute_norm is  tensor(720.1350, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(6703.2617, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.553024831229944
avg test loss is  2.86987265035796
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0787, device='cuda:1')
compute_distance is  tensor(6703.2617, device='cuda:1')
compute_norm is  tensor(716.4928, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(6673.1885, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8315379323481497
avg test loss is  3.6307721605687253
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0788, device='cuda:1')
compute_distance is  tensor(6673.1885, device='cuda:1')
compute_norm is  tensor(713.3592, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(6643.0264, device='cuda:1')
distance x is tensor(6643.0264, device='cuda:1')
________________________________
test distance is  tensor(6643.0264, device='cuda:1')
test distance1 is  tensor(6643.0264, device='cuda:1')
test similarity is  tensor(0.0787, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.8658110477776924
test entropy is  1.5559543049665912
________________________________
cal ratio is  0.15378849596748134
distance x is tensor(1021.6189, device='cuda:1')
cal_distance is  tensor(1021.6189, device='cuda:1')
cal ratio is  0.3921591740139819
distance x is tensor(400.6361, device='cuda:1')
cal_distance is  tensor(400.6361, device='cuda:1')
cal ratio is  0.6262269877871318
distance x is tensor(250.8884, device='cuda:1')
cal_distance is  tensor(250.8884, device='cuda:1')
cal ratio is  0.7913461823634131
distance x is tensor(198.5393, device='cuda:1')
cal_distance is  tensor(198.5393, device='cuda:1')
cal ratio is  0.8895771815082064
distance x is tensor(176.6158, device='cuda:1')
cal_distance is  tensor(176.6158, device='cuda:1')
cal ratio is  0.9431745382814559
distance x is tensor(166.5794, device='cuda:1')
cal_distance is  tensor(166.5794, device='cuda:1')
cal ratio is  0.9711720112255886
distance x is tensor(161.7772, device='cuda:1')
cal_distance is  tensor(161.7772, device='cuda:1')
distance x is tensor(161.7772, device='cuda:1')
return_distance is  tensor(161.7772, device='cuda:1')
distance x is tensor(161.7810, device='cuda:1')
distance x is tensor(161.7810, device='cuda:1')
________________________________
test distance is  tensor(161.7810, device='cuda:1')
test distance1 is  tensor(161.7810, device='cuda:1')
test similarity is  tensor(0.9495, device='cuda:1')
test acc is  0.10000000015633198
test loss is 1801.6059606751398
test entropy is  3.070490128983191e-22
________________________________
0
distance x is tensor(161.7810, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.1556991549060404e-19
avg test loss is  1802.7381832553888
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9495, device='cuda:1')
compute_distance is  tensor(161.7810, device='cuda:1')
compute_norm is  tensor(69.3126, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(528.1133, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.3214115078515336
avg test loss is  2.4423301167833777
avg accuracy is  0.10358333348966532
solo acc is  0.13736666682299864
compute similarity  is  tensor(0.7845, device='cuda:1')
compute_distance is  tensor(528.1133, device='cuda:1')
compute_norm is  tensor(79.7427, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(527.7074, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.756237529869527
avg test loss is  3.1692540701518435
avg accuracy is  0.08960000015633202
solo acc is  0.10221666682299864
compute similarity  is  tensor(0.7845, device='cuda:1')
compute_distance is  tensor(527.7074, device='cuda:1')
compute_norm is  tensor(79.5262, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(528.6646, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.166263006516357
avg test loss is  2.3412076346655644
avg accuracy is  0.10980000015633196
solo acc is  0.15308333348966677
compute similarity  is  tensor(0.7843, device='cuda:1')
compute_distance is  tensor(528.6646, device='cuda:1')
compute_norm is  tensor(78.9154, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(528.2288, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.7309456125124177
avg test loss is  3.01557832333579
avg accuracy is  0.10658333348966528
solo acc is  0.10095000015633197
compute similarity  is  tensor(0.7843, device='cuda:1')
compute_distance is  tensor(528.2288, device='cuda:1')
compute_norm is  tensor(78.6786, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(529.1196, device='cuda:1')
distance x is tensor(529.1196, device='cuda:1')
________________________________
test distance is  tensor(529.1196, device='cuda:1')
test distance1 is  tensor(529.1196, device='cuda:1')
test similarity is  tensor(0.7841, device='cuda:1')
test acc is  0.12978333348966525
test loss is 2.169973153549471
test entropy is  1.198224568290751
________________________________
cal ratio is  0.5449164307024948
distance x is tensor(288.3224, device='cuda:1')
cal_distance is  tensor(288.3224, device='cuda:1')
cal ratio is  0.7381891434470089
distance x is tensor(212.8358, device='cuda:1')
cal_distance is  tensor(212.8358, device='cuda:1')
cal ratio is  0.8591805679098251
distance x is tensor(182.8641, device='cuda:1')
cal_distance is  tensor(182.8641, device='cuda:1')
cal ratio is  0.926920740062597
distance x is tensor(169.5003, device='cuda:1')
cal_distance is  tensor(169.5003, device='cuda:1')
cal ratio is  0.9627677890012765
distance x is tensor(163.1894, device='cuda:1')
cal_distance is  tensor(163.1894, device='cuda:1')
distance x is tensor(163.1894, device='cuda:1')
return_distance is  tensor(163.1894, device='cuda:1')
distance x is tensor(163.1941, device='cuda:1')
distance x is tensor(163.1941, device='cuda:1')
________________________________
test distance is  tensor(163.1941, device='cuda:1')
test distance1 is  tensor(163.1941, device='cuda:1')
test similarity is  tensor(0.9739, device='cuda:1')
test acc is  0.10581666682299862
test loss is 12.909417500628082
test entropy is  0.6698379256387255
________________________________
0
distance x is tensor(163.1941, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.66913858469107
avg test loss is  12.901000677649655
avg accuracy is  0.1767833334896684
solo acc is  0.10530000015633195
compute similarity  is  tensor(0.9739, device='cuda:1')
compute_distance is  tensor(163.1941, device='cuda:1')
compute_norm is  tensor(64.0433, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(170.0703, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.0214213197673563
avg test loss is  1.6135216909430936
avg accuracy is  0.278600000156339
solo acc is  0.23451666682300448
compute similarity  is  tensor(0.9739, device='cuda:1')
compute_distance is  tensor(170.0703, device='cuda:1')
compute_norm is  tensor(63.7281, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(171.4157, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.619504823994789
avg test loss is  2.4178538846054565
avg accuracy is  0.19533333348966944
solo acc is  0.10691666682299862
compute similarity  is  tensor(0.9738, device='cuda:1')
compute_distance is  tensor(171.4157, device='cuda:1')
compute_norm is  tensor(63.4767, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(173.6292, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.9391521583996347
avg test loss is  1.4597859078887174
avg accuracy is  0.28115000015633906
solo acc is  0.2524333334896717
compute similarity  is  tensor(0.9737, device='cuda:1')
compute_distance is  tensor(173.6292, device='cuda:1')
compute_norm is  tensor(63.1057, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(173.6245, device='cuda:1')
________________________________
test distance is  tensor(173.6245, device='cuda:1')
test similarity is  tensor(0.9737, device='cuda:1')
test acc is  0.28096666682300575
test loss is 1.4577073429439114
test entropy is  0.9393870787961143
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2640000001600001
mal loss is 1.4525422304868698
mal norm is  tensor(710.3654, device='cuda:1')
distance x is tensor(173.6245, device='cuda:1')
mal distance is  tensor(173.6245, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([17., 13., 24., 11., 13., 12., 12., 14., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 12., 25., 14., 12., 13., 12., 12., 12.])
count_res tensor([2.4491e-04, 4.4856e-06, 2.6857e-01, 6.0706e-07, 4.4856e-06, 1.6502e-06,
        1.6502e-06, 1.2193e-05, 9.0096e-05, 9.0096e-05, 9.0096e-05, 9.0096e-05,
        9.0096e-05, 9.0096e-05, 9.0096e-05, 9.0096e-05, 9.0096e-05, 9.0096e-05,
        9.0096e-05, 9.0096e-05, 1.6502e-06, 7.3005e-01, 1.2193e-05, 1.6502e-06,
        4.4856e-06, 1.6502e-06, 1.6502e-06, 1.6502e-06])
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 56.12% 

Test Accuracy: 76.30% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7443384528160095
distance x is tensor(139.4048, device='cuda:1')
benign distance is  tensor(139.4048, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3358485326170921
distance x is tensor(100.8282, device='cuda:1')
benign distance is  tensor(100.8282, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.8487525656819344
distance x is tensor(103.2299, device='cuda:1')
benign distance is  tensor(103.2299, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.7649908289313316
distance x is tensor(152.7429, device='cuda:1')
benign distance is  tensor(152.7429, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.8942536488175392
distance x is tensor(114.3810, device='cuda:1')
benign distance is  tensor(114.3810, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.5046351328492165
distance x is tensor(108.0401, device='cuda:1')
benign distance is  tensor(108.0401, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.289320930838585
distance x is tensor(115.5474, device='cuda:1')
benign distance is  tensor(115.5474, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.3506661802530289
distance x is tensor(92.8367, device='cuda:1')
benign distance is  tensor(92.8367, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.9751374274492264
distance x is tensor(98.9375, device='cuda:1')
benign distance is  tensor(98.9375, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.0990232452750206
distance x is tensor(108.0034, device='cuda:1')
benign distance is  tensor(108.0034, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.1970930695533752
distance x is tensor(101.5874, device='cuda:1')
benign distance is  tensor(101.5874, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.0407070964574814
distance x is tensor(117.3937, device='cuda:1')
benign distance is  tensor(117.3937, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.4708173647522926
distance x is tensor(191.6109, device='cuda:1')
benign distance is  tensor(191.6109, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.3724450506269932
distance x is tensor(76.1986, device='cuda:1')
benign distance is  tensor(76.1986, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.208036508411169
distance x is tensor(143.3656, device='cuda:1')
benign distance is  tensor(143.3656, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.762936368584633
distance x is tensor(127.7381, device='cuda:1')
benign distance is  tensor(127.7381, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(99.7199, device='cuda:1')
compute distance is  tensor(99.7199, device='cuda:1')
compute norm is  tensor(61.4821, device='cuda:1', dtype=torch.float64)
distance x is tensor(141.7616, device='cuda:1')
compute distance is  tensor(141.7616, device='cuda:1')
compute norm is  tensor(62.4821, device='cuda:1', dtype=torch.float64)
distance x is tensor(102.6823, device='cuda:1')
compute distance is  tensor(102.6823, device='cuda:1')
compute norm is  tensor(61.5073, device='cuda:1', dtype=torch.float64)
distance x is tensor(112.8062, device='cuda:1')
compute distance is  tensor(112.8062, device='cuda:1')
compute norm is  tensor(61.7677, device='cuda:1', dtype=torch.float64)
distance x is tensor(105.1356, device='cuda:1')
compute distance is  tensor(105.1356, device='cuda:1')
compute norm is  tensor(61.5788, device='cuda:1', dtype=torch.float64)
distance x is tensor(113.5664, device='cuda:1')
compute distance is  tensor(113.5664, device='cuda:1')
compute norm is  tensor(61.8531, device='cuda:1', dtype=torch.float64)
distance x is tensor(118.3000, device='cuda:1')
compute distance is  tensor(118.3000, device='cuda:1')
compute norm is  tensor(61.8498, device='cuda:1', dtype=torch.float64)
distance x is tensor(103.4755, device='cuda:1')
compute distance is  tensor(103.4755, device='cuda:1')
compute norm is  tensor(61.5667, device='cuda:1', dtype=torch.float64)
distance x is tensor(129.8373, device='cuda:1')
compute distance is  tensor(129.8373, device='cuda:1')
compute norm is  tensor(61.7659, device='cuda:1', dtype=torch.float64)
distance x is tensor(115.7719, device='cuda:1')
compute distance is  tensor(115.7719, device='cuda:1')
compute norm is  tensor(61.8449, device='cuda:1', dtype=torch.float64)
distance x is tensor(123.8681, device='cuda:1')
compute distance is  tensor(123.8681, device='cuda:1')
compute norm is  tensor(61.9259, device='cuda:1', dtype=torch.float64)
distance x is tensor(149.4799, device='cuda:1')
compute distance is  tensor(149.4799, device='cuda:1')
compute norm is  tensor(62.7018, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(149.4799, device='cuda:1')
distance x is tensor(101936.4766, device='cuda:1')
distance x is tensor(101936.4766, device='cuda:1')
________________________________
test distance is  tensor(101936.4766, device='cuda:1')
test distance1 is  tensor(101936.4766, device='cuda:1')
test similarity is  tensor(0.4746, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107581490865438.02
test entropy is  0.0
________________________________
cal ratio is  0.037527757232643885
distance x is tensor(3825.4526, device='cuda:1')
cal_distance is  tensor(3825.4526, device='cuda:1')
cal ratio is  0.19372068435631162
distance x is tensor(741.0729, device='cuda:1')
cal_distance is  tensor(741.0729, device='cuda:1')
cal ratio is  0.4401360440110442
distance x is tensor(326.1754, device='cuda:1')
cal_distance is  tensor(326.1754, device='cuda:1')
cal ratio is  0.663424919959677
distance x is tensor(216.3945, device='cuda:1')
cal_distance is  tensor(216.3945, device='cuda:1')
cal ratio is  0.8145061269661994
distance x is tensor(176.2555, device='cuda:1')
cal_distance is  tensor(176.2555, device='cuda:1')
cal ratio is  0.9024977215344523
distance x is tensor(159.0706, device='cuda:1')
cal_distance is  tensor(159.0706, device='cuda:1')
cal ratio is  0.9499974812675014
distance x is tensor(151.1169, device='cuda:1')
cal_distance is  tensor(151.1169, device='cuda:1')
cal ratio is  0.9746773634441893
distance x is tensor(147.2904, device='cuda:1')
cal_distance is  tensor(147.2904, device='cuda:1')
distance x is tensor(147.2904, device='cuda:1')
return_distance is  tensor(147.2904, device='cuda:1')
distance x is tensor(147.2812, device='cuda:1')
distance x is tensor(147.2812, device='cuda:1')
________________________________
test distance is  tensor(147.2812, device='cuda:1')
test distance1 is  tensor(147.2812, device='cuda:1')
test similarity is  tensor(0.9803, device='cuda:1')
test acc is  0.10041666682299864
test loss is 120.72673953774132
test entropy is  0.00039823245413846885
________________________________
0
distance x is tensor(147.2812, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.00046261384002662233
avg test loss is  120.32866521481512
avg accuracy is  0.34501666682300697
solo acc is  0.10056666682299865
compute similarity  is  tensor(0.9803, device='cuda:1')
compute_distance is  tensor(147.2812, device='cuda:1')
compute_norm is  tensor(65.8239, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(145.6385, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9441592621523688
avg test loss is  1.5178149107422656
avg accuracy is  0.6900500001563312
solo acc is  0.2869000001563392
compute similarity  is  tensor(0.9804, device='cuda:1')
compute_distance is  tensor(145.6385, device='cuda:1')
compute_norm is  tensor(65.6344, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(145.6385, device='cuda:1')
distance x is tensor(145.6385, device='cuda:1')
________________________________
test distance is  tensor(145.6385, device='cuda:1')
test distance1 is  tensor(145.6385, device='cuda:1')
test similarity is  tensor(0.9804, device='cuda:1')
test acc is  0.2842500001563392
test loss is 1.5253752665733225
test entropy is  0.9445029695405126
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.29300000016000005
mal loss is 1.4997447431087494
mal norm is  tensor(721.1419, device='cuda:1')
distance x is tensor(145.6470, device='cuda:1')
mal distance is  tensor(145.6470, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([13., 12., 12., 14., 12., 12., 15., 14., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 13., 13., 14., 12., 12., 19., 26., 15.])
count_res tensor([2.2569e-06, 8.3027e-07, 8.3027e-07, 6.1349e-06, 8.3027e-07, 8.3027e-07,
        1.6676e-05, 6.1349e-06, 4.5331e-05, 4.5331e-05, 4.5331e-05, 4.5331e-05,
        4.5331e-05, 4.5331e-05, 4.5331e-05, 4.5331e-05, 4.5331e-05, 4.5331e-05,
        4.5331e-05, 4.5331e-05, 2.2569e-06, 2.2569e-06, 6.1349e-06, 8.3027e-07,
        8.3027e-07, 9.1050e-04, 9.9848e-01, 1.6676e-05])
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 51.42% 

Test Accuracy: 68.97% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7944249678403139
distance x is tensor(201.2421, device='cuda:1')
benign distance is  tensor(201.2421, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.921393744647503
distance x is tensor(104.1802, device='cuda:1')
benign distance is  tensor(104.1802, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.685791827738285
distance x is tensor(119.4056, device='cuda:1')
benign distance is  tensor(119.4056, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.5655161514878273
distance x is tensor(150.3815, device='cuda:1')
benign distance is  tensor(150.3815, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.3616165332496166
distance x is tensor(108.3629, device='cuda:1')
benign distance is  tensor(108.3629, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.0639229975640774
distance x is tensor(132.2069, device='cuda:1')
benign distance is  tensor(132.2069, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.8217954598367214
distance x is tensor(126.2867, device='cuda:1')
benign distance is  tensor(126.2867, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.9727755300700665
distance x is tensor(118.3620, device='cuda:1')
benign distance is  tensor(118.3620, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  2.6765768229961395
distance x is tensor(162.1885, device='cuda:1')
benign distance is  tensor(162.1885, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.3664087392389774
distance x is tensor(128.2562, device='cuda:1')
benign distance is  tensor(128.2562, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.3245306517928839
distance x is tensor(122.2329, device='cuda:1')
benign distance is  tensor(122.2329, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.8071275241672993
distance x is tensor(138.3728, device='cuda:1')
benign distance is  tensor(138.3728, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.5387219116091728
distance x is tensor(103.3611, device='cuda:1')
benign distance is  tensor(103.3611, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.0968988966196775
distance x is tensor(202.8505, device='cuda:1')
benign distance is  tensor(202.8505, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.7121722847223282
distance x is tensor(114.6844, device='cuda:1')
benign distance is  tensor(114.6844, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.3648504354059696
distance x is tensor(129.0517, device='cuda:1')
benign distance is  tensor(129.0517, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(92.9471, device='cuda:1')
compute distance is  tensor(92.9471, device='cuda:1')
compute norm is  tensor(60.9736, device='cuda:1', dtype=torch.float64)
distance x is tensor(149.9132, device='cuda:1')
compute distance is  tensor(149.9132, device='cuda:1')
compute norm is  tensor(61.6425, device='cuda:1', dtype=torch.float64)
distance x is tensor(115.7158, device='cuda:1')
compute distance is  tensor(115.7158, device='cuda:1')
compute norm is  tensor(61.0954, device='cuda:1', dtype=torch.float64)
distance x is tensor(120.9838, device='cuda:1')
compute distance is  tensor(120.9838, device='cuda:1')
compute norm is  tensor(61.4008, device='cuda:1', dtype=torch.float64)
distance x is tensor(114.9903, device='cuda:1')
compute distance is  tensor(114.9903, device='cuda:1')
compute norm is  tensor(61.0724, device='cuda:1', dtype=torch.float64)
distance x is tensor(112.1135, device='cuda:1')
compute distance is  tensor(112.1135, device='cuda:1')
compute norm is  tensor(61.1478, device='cuda:1', dtype=torch.float64)
distance x is tensor(139.4513, device='cuda:1')
compute distance is  tensor(139.4513, device='cuda:1')
compute norm is  tensor(61.3144, device='cuda:1', dtype=torch.float64)
distance x is tensor(105.9626, device='cuda:1')
compute distance is  tensor(105.9626, device='cuda:1')
compute norm is  tensor(60.9541, device='cuda:1', dtype=torch.float64)
distance x is tensor(119.9191, device='cuda:1')
compute distance is  tensor(119.9191, device='cuda:1')
compute norm is  tensor(61.3265, device='cuda:1', dtype=torch.float64)
distance x is tensor(118.7171, device='cuda:1')
compute distance is  tensor(118.7171, device='cuda:1')
compute norm is  tensor(61.4297, device='cuda:1', dtype=torch.float64)
distance x is tensor(135.0682, device='cuda:1')
compute distance is  tensor(135.0682, device='cuda:1')
compute norm is  tensor(61.2926, device='cuda:1', dtype=torch.float64)
distance x is tensor(155.6886, device='cuda:1')
compute distance is  tensor(155.6886, device='cuda:1')
compute norm is  tensor(62.1928, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(155.6886, device='cuda:1')
distance x is tensor(101967.4375, device='cuda:1')
distance x is tensor(101967.4375, device='cuda:1')
________________________________
test distance is  tensor(101967.4375, device='cuda:1')
test distance1 is  tensor(101967.4375, device='cuda:1')
test similarity is  tensor(0.4195, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107518747556455.7
test entropy is  0.0
________________________________
cal ratio is  0.038293384744675044
distance x is tensor(3904.6831, device='cuda:1')
cal_distance is  tensor(3904.6831, device='cuda:1')
cal ratio is  0.19568682975084672
distance x is tensor(764.0987, device='cuda:1')
cal_distance is  tensor(764.0987, device='cuda:1')
cal ratio is  0.4423639985789099
distance x is tensor(338.0123, device='cuda:1')
cal_distance is  tensor(338.0123, device='cuda:1')
cal ratio is  0.6651019695178977
distance x is tensor(224.8142, device='cuda:1')
cal_distance is  tensor(224.8142, device='cuda:1')
cal ratio is  0.8155350584958667
distance x is tensor(183.3447, device='cuda:1')
cal_distance is  tensor(183.3447, device='cuda:1')
cal ratio is  0.9030677342590208
distance x is tensor(165.5731, device='cuda:1')
cal_distance is  tensor(165.5731, device='cuda:1')
cal ratio is  0.9502975454536787
distance x is tensor(157.3439, device='cuda:1')
cal_distance is  tensor(157.3439, device='cuda:1')
cal ratio is  0.974831345374231
distance x is tensor(153.3839, device='cuda:1')
cal_distance is  tensor(153.3839, device='cuda:1')
distance x is tensor(153.3839, device='cuda:1')
return_distance is  tensor(153.3839, device='cuda:1')
distance x is tensor(153.3748, device='cuda:1')
distance x is tensor(153.3748, device='cuda:1')
________________________________
test distance is  tensor(153.3748, device='cuda:1')
test distance1 is  tensor(153.3748, device='cuda:1')
test similarity is  tensor(0.9762, device='cuda:1')
test acc is  0.21458333348967035
test loss is 94.83867760761969
test entropy is  0.044857141459787656
________________________________
0
distance x is tensor(153.3748, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.044594347685216064
avg test loss is  94.90222956935989
avg accuracy is  0.45520000015634166
solo acc is  0.21415000015633695
compute similarity  is  tensor(0.9762, device='cuda:1')
compute_distance is  tensor(153.3748, device='cuda:1')
compute_norm is  tensor(65.2365, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(156.6578, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.0329518648607137
avg test loss is  1.6065332252842022
avg accuracy is  0.5987833334896709
solo acc is  0.263783333489672
compute similarity  is  tensor(0.9730, device='cuda:1')
compute_distance is  tensor(156.6578, device='cuda:1')
compute_norm is  tensor(65.0259, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(157.6873, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.619630356650871
avg test loss is  2.493327456496672
avg accuracy is  0.5525833334896751
solo acc is  0.11151666682299861
compute similarity  is  tensor(0.9726, device='cuda:1')
compute_distance is  tensor(157.6873, device='cuda:1')
compute_norm is  tensor(64.7275, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(159.0255, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.9582856333713288
avg test loss is  1.510099625536628
avg accuracy is  0.6465833334896673
solo acc is  0.2710000001563388
compute similarity  is  tensor(0.9726, device='cuda:1')
compute_distance is  tensor(159.0255, device='cuda:1')
compute_norm is  tensor(64.3444, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(159.0255, device='cuda:1')
distance x is tensor(159.0255, device='cuda:1')
________________________________
test distance is  tensor(159.0255, device='cuda:1')
test distance1 is  tensor(159.0255, device='cuda:1')
test similarity is  tensor(0.9726, device='cuda:1')
test acc is  0.2678833334896721
test loss is 1.516925926401671
test entropy is  0.9579738318793046
________________________________
cal ratio is  0.9696636539764085
distance x is tensor(154.2092, device='cuda:1')
cal_distance is  tensor(154.2092, device='cuda:1')
distance x is tensor(154.2092, device='cuda:1')
return_distance is  tensor(154.2092, device='cuda:1')
distance x is tensor(154.2011, device='cuda:1')
distance x is tensor(154.2011, device='cuda:1')
________________________________
test distance is  tensor(154.2011, device='cuda:1')
test distance1 is  tensor(154.2011, device='cuda:1')
test similarity is  tensor(0.9741, device='cuda:1')
test acc is  0.2998000001563395
test loss is 1.4439188161892678
test entropy is  1.0064785283511635
________________________________
0
distance x is tensor(154.2011, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.0065633402323164
avg test loss is  1.4396752870159109
avg accuracy is  0.6553000001563334
solo acc is  0.30348333348967294
compute similarity  is  tensor(0.9741, device='cuda:1')
compute_distance is  tensor(154.2011, device='cuda:1')
compute_norm is  tensor(64.1801, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(155.3158, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.5918867977570369
avg test loss is  2.382101188209265
avg accuracy is  0.6047833334896705
solo acc is  0.10993333348966529
compute similarity  is  tensor(0.9736, device='cuda:1')
compute_distance is  tensor(155.3158, device='cuda:1')
compute_norm is  tensor(63.9015, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(156.5082, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.9384561216017839
avg test loss is  1.454591754021675
avg accuracy is  0.681083333489665
solo acc is  0.2696000001563388
compute similarity  is  tensor(0.9736, device='cuda:1')
compute_distance is  tensor(156.5082, device='cuda:1')
compute_norm is  tensor(63.5276, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(156.5082, device='cuda:1')
distance x is tensor(156.5082, device='cuda:1')
________________________________
test distance is  tensor(156.5082, device='cuda:1')
test distance1 is  tensor(156.5082, device='cuda:1')
test similarity is  tensor(0.9736, device='cuda:1')
test acc is  0.27191666682300564
test loss is 1.4551381532317285
test entropy is  0.9396805871270104
________________________________
cal ratio is  0.9774306560881438
distance x is tensor(152.9838, device='cuda:1')
cal_distance is  tensor(152.9838, device='cuda:1')
distance x is tensor(152.9838, device='cuda:1')
return_distance is  tensor(152.9838, device='cuda:1')
distance x is tensor(152.9758, device='cuda:1')
distance x is tensor(152.9758, device='cuda:1')
________________________________
test distance is  tensor(152.9758, device='cuda:1')
test distance1 is  tensor(152.9758, device='cuda:1')
test similarity is  tensor(0.9746, device='cuda:1')
test acc is  0.2969166668230061
test loss is 1.3980688792047724
test entropy is  0.9733749439340156
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.29800000016000006
mal loss is 1.434590958058834
mal norm is  tensor(728.5555, device='cuda:1')
distance x is tensor(152.9838, device='cuda:1')
mal distance is  tensor(152.9838, device='cuda:1')
user_PLR len size 44
counter_tensor is  tensor([11., 15., 40., 12., 12., 38., 15., 40., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32.,  4., 27.,  2., 12., 12., 21., 17., 20.,
        12., 12., 14., 19., 31., 42., 13., 33., 12., 16., 23., 19., 12., 35.,
        22., 15.])
count_res tensor([2.6674e-14, 1.4563e-12, 1.0486e-01, 7.2507e-14, 7.2507e-14, 1.4192e-02,
        1.4563e-12, 1.0486e-01, 3.5178e-05, 3.5178e-05, 3.5178e-05, 3.5178e-05,
        3.5178e-05, 3.5178e-05, 3.5178e-05, 3.5178e-05, 3.5178e-05, 3.5178e-05,
        3.5178e-05, 3.5178e-05, 2.4323e-17, 2.3703e-07, 3.2918e-18, 7.2507e-14,
        7.2507e-14, 5.8753e-10, 1.0761e-11, 2.1614e-10, 7.2507e-14, 7.2507e-14,
        5.3576e-13, 7.9513e-11, 1.2941e-05, 7.7484e-01, 1.9709e-13, 9.5623e-05,
        7.2507e-14, 3.9587e-12, 4.3413e-09, 7.9513e-11, 7.2507e-14, 7.0657e-04,
        1.5971e-09, 1.4563e-12])
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 54.36% 

Test Accuracy: 76.34% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7176858223974705
distance x is tensor(126.6835, device='cuda:1')
benign distance is  tensor(126.6835, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.5515960790216923
distance x is tensor(92.7339, device='cuda:1')
benign distance is  tensor(92.7339, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.653641451150179
distance x is tensor(99.2151, device='cuda:1')
benign distance is  tensor(99.2151, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.4079458303749561
distance x is tensor(142.3947, device='cuda:1')
benign distance is  tensor(142.3947, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.8041753619909286
distance x is tensor(107.0108, device='cuda:1')
benign distance is  tensor(107.0108, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.373221680521965
distance x is tensor(102.2762, device='cuda:1')
benign distance is  tensor(102.2762, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.7909931242465973
distance x is tensor(105.6325, device='cuda:1')
benign distance is  tensor(105.6325, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.2238254211843014
distance x is tensor(93.2317, device='cuda:1')
benign distance is  tensor(93.2317, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.9418927803635597
distance x is tensor(91.7635, device='cuda:1')
benign distance is  tensor(91.7635, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.1463058609515429
distance x is tensor(129.7833, device='cuda:1')
benign distance is  tensor(129.7833, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  1.657357506453991
distance x is tensor(82.5781, device='cuda:1')
benign distance is  tensor(82.5781, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.1542254462838173
distance x is tensor(116.7359, device='cuda:1')
benign distance is  tensor(116.7359, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.3760709539055824
distance x is tensor(155.2075, device='cuda:1')
benign distance is  tensor(155.2075, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.6575726419687271
distance x is tensor(69.8383, device='cuda:1')
benign distance is  tensor(69.8383, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.5257239900529385
distance x is tensor(136.9153, device='cuda:1')
benign distance is  tensor(136.9153, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.2819628939032555
distance x is tensor(128.5911, device='cuda:1')
benign distance is  tensor(128.5911, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.118884861469269
distance x is tensor(129.6681, device='cuda:1')
benign distance is  tensor(129.6681, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  1.6086292080581188
distance x is tensor(71.5943, device='cuda:1')
benign distance is  tensor(71.5943, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  1.6819035038352013
distance x is tensor(127.8687, device='cuda:1')
benign distance is  tensor(127.8687, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  3.089944526553154
distance x is tensor(110.9432, device='cuda:1')
benign distance is  tensor(110.9432, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.4929090589284897
distance x is tensor(125.7942, device='cuda:1')
benign distance is  tensor(125.7942, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  1.8785037696361542
distance x is tensor(74.7768, device='cuda:1')
benign distance is  tensor(74.7768, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.6159770879894495
distance x is tensor(130.5293, device='cuda:1')
benign distance is  tensor(130.5293, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  1.154201041907072
distance x is tensor(158.3131, device='cuda:1')
benign distance is  tensor(158.3131, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.9397191181778908
distance x is tensor(129.6865, device='cuda:1')
benign distance is  tensor(129.6865, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  2.2750330418348312
distance x is tensor(100.9455, device='cuda:1')
benign distance is  tensor(100.9455, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  1.3706865534186363
distance x is tensor(139.4963, device='cuda:1')
benign distance is  tensor(139.4963, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  2.74953605979681
distance x is tensor(123.1995, device='cuda:1')
benign distance is  tensor(123.1995, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7523117233067751
distance x is tensor(115.6853, device='cuda:1')
benign distance is  tensor(115.6853, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  1.4035778380930424
distance x is tensor(89.2803, device='cuda:1')
benign distance is  tensor(89.2803, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  1.4024132676422596
distance x is tensor(96.4370, device='cuda:1')
benign distance is  tensor(96.4370, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.9630974158644676
distance x is tensor(128.2623, device='cuda:1')
benign distance is  tensor(128.2623, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(85.8227, device='cuda:1')
compute distance is  tensor(85.8227, device='cuda:1')
compute norm is  tensor(60.3522, device='cuda:1', dtype=torch.float64)
distance x is tensor(144.8487, device='cuda:1')
compute distance is  tensor(144.8487, device='cuda:1')
compute norm is  tensor(61.2222, device='cuda:1', dtype=torch.float64)
distance x is tensor(102.9963, device='cuda:1')
compute distance is  tensor(102.9963, device='cuda:1')
compute norm is  tensor(60.3541, device='cuda:1', dtype=torch.float64)
distance x is tensor(123.0591, device='cuda:1')
compute distance is  tensor(123.0591, device='cuda:1')
compute norm is  tensor(60.7953, device='cuda:1', dtype=torch.float64)
distance x is tensor(98.3692, device='cuda:1')
compute distance is  tensor(98.3692, device='cuda:1')
compute norm is  tensor(60.3115, device='cuda:1', dtype=torch.float64)
distance x is tensor(108.6118, device='cuda:1')
compute distance is  tensor(108.6118, device='cuda:1')
compute norm is  tensor(60.6253, device='cuda:1', dtype=torch.float64)
distance x is tensor(120.7065, device='cuda:1')
compute distance is  tensor(120.7065, device='cuda:1')
compute norm is  tensor(60.8393, device='cuda:1', dtype=torch.float64)
distance x is tensor(94.2885, device='cuda:1')
compute distance is  tensor(94.2885, device='cuda:1')
compute norm is  tensor(60.4068, device='cuda:1', dtype=torch.float64)
distance x is tensor(117.5233, device='cuda:1')
compute distance is  tensor(117.5233, device='cuda:1')
compute norm is  tensor(60.6601, device='cuda:1', dtype=torch.float64)
distance x is tensor(105.4192, device='cuda:1')
compute distance is  tensor(105.4192, device='cuda:1')
compute norm is  tensor(60.7699, device='cuda:1', dtype=torch.float64)
distance x is tensor(125.8180, device='cuda:1')
compute distance is  tensor(125.8180, device='cuda:1')
compute norm is  tensor(60.6639, device='cuda:1', dtype=torch.float64)
distance x is tensor(143.5601, device='cuda:1')
compute distance is  tensor(143.5601, device='cuda:1')
compute norm is  tensor(61.4704, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(144.8487, device='cuda:1')
distance x is tensor(101963.3516, device='cuda:1')
distance x is tensor(101963.3516, device='cuda:1')
________________________________
test distance is  tensor(101963.3516, device='cuda:1')
test distance1 is  tensor(101963.3516, device='cuda:1')
test similarity is  tensor(0.4282, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107498998501681.67
test entropy is  0.0
________________________________
cal ratio is  0.036936976133810466
distance x is tensor(3766.2224, device='cuda:1')
cal_distance is  tensor(3766.2224, device='cuda:1')
cal ratio is  0.1921898322739237
distance x is tensor(723.8333, device='cuda:1')
cal_distance is  tensor(723.8333, device='cuda:1')
cal ratio is  0.4383935072641266
distance x is tensor(317.3264, device='cuda:1')
cal_distance is  tensor(317.3264, device='cuda:1')
cal ratio is  0.6621102361352772
distance x is tensor(210.1066, device='cuda:1')
cal_distance is  tensor(210.1066, device='cuda:1')
cal ratio is  0.813698549387383
distance x is tensor(170.9643, device='cuda:1')
cal_distance is  tensor(170.9643, device='cuda:1')
cal ratio is  0.9020501841796802
distance x is tensor(154.2188, device='cuda:1')
cal_distance is  tensor(154.2188, device='cuda:1')
cal ratio is  0.9497618459287621
distance x is tensor(146.4714, device='cuda:1')
cal_distance is  tensor(146.4714, device='cuda:1')
cal ratio is  0.9745564864430637
distance x is tensor(142.7448, device='cuda:1')
cal_distance is  tensor(142.7448, device='cuda:1')
distance x is tensor(142.7448, device='cuda:1')
return_distance is  tensor(142.7448, device='cuda:1')
distance x is tensor(142.7356, device='cuda:1')
distance x is tensor(142.7356, device='cuda:1')
________________________________
test distance is  tensor(142.7356, device='cuda:1')
test distance1 is  tensor(142.7356, device='cuda:1')
test similarity is  tensor(0.9788, device='cuda:1')
test acc is  0.23991666682300458
test loss is 53.58260454857019
test entropy is  0.06417672211594229
________________________________
0
distance x is tensor(142.7356, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.06320848093350241
avg test loss is  53.60122248765502
avg accuracy is  0.5966333334896711
solo acc is  0.24121666682300466
compute similarity  is  tensor(0.9788, device='cuda:1')
compute_distance is  tensor(142.7356, device='cuda:1')
compute_norm is  tensor(64.1590, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(142.0044, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.869263787068792
avg test loss is  1.479662364098563
avg accuracy is  0.7610666668229941
solo acc is  0.3115166668230064
compute similarity  is  tensor(0.9783, device='cuda:1')
compute_distance is  tensor(142.0044, device='cuda:1')
compute_norm is  tensor(63.5307, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(142.0044, device='cuda:1')
distance x is tensor(142.0044, device='cuda:1')
________________________________
test distance is  tensor(142.0044, device='cuda:1')
test distance1 is  tensor(142.0044, device='cuda:1')
test similarity is  tensor(0.9783, device='cuda:1')
test acc is  0.3095666668230064
test loss is 1.4825627202672491
test entropy is  0.868369473704397
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.31300000016000007
mal loss is 1.478140264749527
mal norm is  tensor(702.6976, device='cuda:1')
distance x is tensor(142.0126, device='cuda:1')
mal distance is  tensor(142.0126, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 27.19% 

Test Accuracy: 28.82% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.815178144723177
distance x is tensor(173.3216, device='cuda:1')
benign distance is  tensor(173.3216, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.2465720511972904
distance x is tensor(129.2517, device='cuda:1')
benign distance is  tensor(129.2517, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.2427682392299175
distance x is tensor(142.2238, device='cuda:1')
benign distance is  tensor(142.2238, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.8988224118947983
distance x is tensor(171.4218, device='cuda:1')
benign distance is  tensor(171.4218, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.484924465417862
distance x is tensor(136.3584, device='cuda:1')
benign distance is  tensor(136.3584, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.2730065509676933
distance x is tensor(133.3626, device='cuda:1')
benign distance is  tensor(133.3626, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.6343182250857353
distance x is tensor(139.5936, device='cuda:1')
benign distance is  tensor(139.5936, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.5480103120207787
distance x is tensor(158.1405, device='cuda:1')
benign distance is  tensor(158.1405, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(115.5210, device='cuda:1')
compute distance is  tensor(115.5210, device='cuda:1')
compute norm is  tensor(64.6256, device='cuda:1', dtype=torch.float64)
distance x is tensor(167.4317, device='cuda:1')
compute distance is  tensor(167.4317, device='cuda:1')
compute norm is  tensor(65.7094, device='cuda:1', dtype=torch.float64)
distance x is tensor(119.1586, device='cuda:1')
compute distance is  tensor(119.1586, device='cuda:1')
compute norm is  tensor(64.6632, device='cuda:1', dtype=torch.float64)
distance x is tensor(150.3353, device='cuda:1')
compute distance is  tensor(150.3353, device='cuda:1')
compute norm is  tensor(65.4250, device='cuda:1', dtype=torch.float64)
distance x is tensor(121.0316, device='cuda:1')
compute distance is  tensor(121.0316, device='cuda:1')
compute norm is  tensor(64.6643, device='cuda:1', dtype=torch.float64)
distance x is tensor(137.6741, device='cuda:1')
compute distance is  tensor(137.6741, device='cuda:1')
compute norm is  tensor(65.2103, device='cuda:1', dtype=torch.float64)
distance x is tensor(149.2750, device='cuda:1')
compute distance is  tensor(149.2750, device='cuda:1')
compute norm is  tensor(65.4270, device='cuda:1', dtype=torch.float64)
distance x is tensor(118.9603, device='cuda:1')
compute distance is  tensor(118.9603, device='cuda:1')
compute norm is  tensor(64.5871, device='cuda:1', dtype=torch.float64)
distance x is tensor(143.9002, device='cuda:1')
compute distance is  tensor(143.9002, device='cuda:1')
compute norm is  tensor(65.2241, device='cuda:1', dtype=torch.float64)
distance x is tensor(133.2196, device='cuda:1')
compute distance is  tensor(133.2196, device='cuda:1')
compute norm is  tensor(65.1580, device='cuda:1', dtype=torch.float64)
distance x is tensor(145.9410, device='cuda:1')
compute distance is  tensor(145.9410, device='cuda:1')
compute norm is  tensor(65.1432, device='cuda:1', dtype=torch.float64)
distance x is tensor(169.5468, device='cuda:1')
compute distance is  tensor(169.5468, device='cuda:1')
compute norm is  tensor(66.0848, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(169.5468, device='cuda:1')
distance x is tensor(101841.6172, device='cuda:1')
distance x is tensor(101841.6172, device='cuda:1')
________________________________
test distance is  tensor(101841.6172, device='cuda:1')
test distance1 is  tensor(101841.6172, device='cuda:1')
test similarity is  tensor(0.5973, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107571728189138.69
test entropy is  0.0
________________________________
cal ratio is  0.03998602342850512
distance x is tensor(4072.2466, device='cuda:1')
cal_distance is  tensor(4072.2466, device='cuda:1')
cal ratio is  0.19996492343140984
distance x is tensor(814.3101, device='cuda:1')
cal_distance is  tensor(814.3101, device='cuda:1')
cal ratio is  0.44717339562086517
distance x is tensor(364.1404, device='cuda:1')
cal_distance is  tensor(364.1404, device='cuda:1')
cal ratio is  0.6687078660722513
distance x is tensor(243.5051, device='cuda:1')
cal_distance is  tensor(243.5051, device='cuda:1')
cal ratio is  0.8177430575066467
distance x is tensor(199.1254, device='cuda:1')
cal_distance is  tensor(199.1254, device='cuda:1')
cal ratio is  0.9042895492092194
distance x is tensor(180.0675, device='cuda:1')
cal_distance is  tensor(180.0675, device='cuda:1')
cal ratio is  0.9509402514044013
distance x is tensor(171.2336, device='cuda:1')
cal_distance is  tensor(171.2336, device='cuda:1')
cal ratio is  0.9751610151265236
distance x is tensor(166.9805, device='cuda:1')
cal_distance is  tensor(166.9805, device='cuda:1')
distance x is tensor(166.9805, device='cuda:1')
return_distance is  tensor(166.9805, device='cuda:1')
distance x is tensor(166.9713, device='cuda:1')
distance x is tensor(166.9713, device='cuda:1')
________________________________
test distance is  tensor(166.9713, device='cuda:1')
test distance1 is  tensor(166.9713, device='cuda:1')
test similarity is  tensor(0.9832, device='cuda:1')
test acc is  0.10000000015633198
test loss is 630.5315996182244
test entropy is  8.83770461106971e-28
________________________________
0
distance x is tensor(166.9713, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  6.931957769218264e-31
avg test loss is  629.7179739165153
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9832, device='cuda:1')
compute_distance is  tensor(166.9713, device='cuda:1')
compute_norm is  tensor(70.5445, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(9829.4932, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.529572666708086
avg test loss is  2.938249003912594
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0386, device='cuda:1')
compute_distance is  tensor(9829.4932, device='cuda:1')
compute_norm is  tensor(1039.9088, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(9784.8994, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8228158952711996
avg test loss is  3.685317204451002
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0386, device='cuda:1')
compute_distance is  tensor(9784.8994, device='cuda:1')
compute_norm is  tensor(1035.1844, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(9740.4570, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.5519217565369758
avg test loss is  2.873040315184766
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0385, device='cuda:1')
compute_distance is  tensor(9740.4570, device='cuda:1')
compute_norm is  tensor(1030.0882, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(9696.2402, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8280991358416421
avg test loss is  3.6435497378997965
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0386, device='cuda:1')
compute_distance is  tensor(9696.2402, device='cuda:1')
compute_norm is  tensor(1025.4571, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(9652.1152, device='cuda:1')
distance x is tensor(9652.1152, device='cuda:1')
________________________________
test distance is  tensor(9652.1152, device='cuda:1')
test distance1 is  tensor(9652.1152, device='cuda:1')
test similarity is  tensor(0.0385, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.861064352714685
test entropy is  1.5595077904048504
________________________________
cal ratio is  0.1298851808833973
distance x is tensor(1253.6644, device='cuda:1')
cal_distance is  tensor(1253.6644, device='cuda:1')
cal ratio is  0.36039619204167794
distance x is tensor(451.8145, device='cuda:1')
cal_distance is  tensor(451.8145, device='cuda:1')
cal ratio is  0.6003309643500727
distance x is tensor(271.2375, device='cuda:1')
cal_distance is  tensor(271.2375, device='cuda:1')
cal ratio is  0.7748114449716252
distance x is tensor(210.1574, device='cuda:1')
cal_distance is  tensor(210.1574, device='cuda:1')
cal ratio is  0.8802346623261879
distance x is tensor(184.9876, device='cuda:1')
cal_distance is  tensor(184.9876, device='cuda:1')
cal ratio is  0.9382088693466267
distance x is tensor(173.5569, device='cuda:1')
cal_distance is  tensor(173.5569, device='cuda:1')
cal ratio is  0.9686120503187996
distance x is tensor(168.1092, device='cuda:1')
cal_distance is  tensor(168.1092, device='cuda:1')
distance x is tensor(168.1092, device='cuda:1')
return_distance is  tensor(168.1092, device='cuda:1')
distance x is tensor(168.1135, device='cuda:1')
distance x is tensor(168.1135, device='cuda:1')
________________________________
test distance is  tensor(168.1135, device='cuda:1')
test distance1 is  tensor(168.1135, device='cuda:1')
test similarity is  tensor(0.9530, device='cuda:1')
test acc is  0.10001666682299865
test loss is 770.149975774639
test entropy is  0.0028503654229172413
________________________________
0
distance x is tensor(168.1135, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.0029903967895037117
avg test loss is  770.86928117504
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9530, device='cuda:1')
compute_distance is  tensor(168.1135, device='cuda:1')
compute_norm is  tensor(69.2775, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(386.0811, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.5386152154347028
avg test loss is  2.8881583739953762
avg accuracy is  0.10071666682299864
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8872, device='cuda:1')
compute_distance is  tensor(386.0811, device='cuda:1')
compute_norm is  tensor(72.5268, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(385.9498, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8266991948776408
avg test loss is  3.6466017305723892
avg accuracy is  0.10025000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8871, device='cuda:1')
compute_distance is  tensor(385.9498, device='cuda:1')
compute_norm is  tensor(72.3889, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(385.9268, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.5407031267436582
avg test loss is  2.8339293191173693
avg accuracy is  0.10071666682299864
solo acc is  0.10311666682299864
compute similarity  is  tensor(0.8871, device='cuda:1')
compute_distance is  tensor(385.9268, device='cuda:1')
compute_norm is  tensor(71.7752, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(385.9103, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8266776928515323
avg test loss is  3.593928989316863
avg accuracy is  0.10035000015633198
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.8870, device='cuda:1')
compute_distance is  tensor(385.9103, device='cuda:1')
compute_norm is  tensor(71.6677, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(385.8841, device='cuda:1')
distance x is tensor(385.8841, device='cuda:1')
________________________________
test distance is  tensor(385.8841, device='cuda:1')
test distance1 is  tensor(385.8841, device='cuda:1')
test similarity is  tensor(0.8870, device='cuda:1')
test acc is  0.11051666682299861
test loss is 2.8142153827874643
test entropy is  1.5274841366037886
________________________________
cal ratio is  0.6495945884595309
distance x is tensor(250.6642, device='cuda:1')
cal_distance is  tensor(250.6642, device='cuda:1')
cal ratio is  0.805980879129093
distance x is tensor(202.0301, device='cuda:1')
cal_distance is  tensor(202.0301, device='cuda:1')
cal ratio is  0.8977653908776635
distance x is tensor(181.3753, device='cuda:1')
cal_distance is  tensor(181.3753, device='cuda:1')
cal ratio is  0.9475055254068031
distance x is tensor(171.8540, device='cuda:1')
cal_distance is  tensor(171.8540, device='cuda:1')
cal ratio is  0.973399290727953
distance x is tensor(167.2825, device='cuda:1')
cal_distance is  tensor(167.2825, device='cuda:1')
distance x is tensor(167.2825, device='cuda:1')
return_distance is  tensor(167.2825, device='cuda:1')
distance x is tensor(167.2874, device='cuda:1')
distance x is tensor(167.2874, device='cuda:1')
________________________________
test distance is  tensor(167.2874, device='cuda:1')
test distance1 is  tensor(167.2874, device='cuda:1')
test similarity is  tensor(0.9770, device='cuda:1')
test acc is  0.10066666682299863
test loss is 15.24308305661053
test entropy is  0.6325054030492108
________________________________
0
distance x is tensor(167.2874, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.6325044216377649
avg test loss is  15.207337425207532
avg accuracy is  0.10981666682299862
solo acc is  0.1005833334896653
compute similarity  is  tensor(0.9770, device='cuda:1')
compute_distance is  tensor(167.2874, device='cuda:1')
compute_norm is  tensor(64.3626, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(179.3093, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.062036375247085
avg test loss is  1.7514421048957403
avg accuracy is  0.12508333348966524
solo acc is  0.216450000156337
compute similarity  is  tensor(0.9765, device='cuda:1')
compute_distance is  tensor(179.3093, device='cuda:1')
compute_norm is  tensor(64.1273, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(180.6205, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.6453739575612774
avg test loss is  2.5575452735429125
avg accuracy is  0.11036666682299862
solo acc is  0.10440000015633197
compute similarity  is  tensor(0.9764, device='cuda:1')
compute_distance is  tensor(180.6205, device='cuda:1')
compute_norm is  tensor(63.8837, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(183.8863, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.9942115576409581
avg test loss is  1.6370413785041777
avg accuracy is  0.1302500001563319
solo acc is  0.22940000015633757
compute similarity  is  tensor(0.9763, device='cuda:1')
compute_distance is  tensor(183.8863, device='cuda:1')
compute_norm is  tensor(63.5517, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(183.8818, device='cuda:1')
________________________________
test distance is  tensor(183.8818, device='cuda:1')
test similarity is  tensor(0.9763, device='cuda:1')
test acc is  0.1298500001563319
test loss is 1.6353030976201934
test entropy is  0.9930112856283371
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2330000001600001
mal loss is 1.614233523607254
mal norm is  tensor(678.1321, device='cuda:1')
distance x is tensor(183.8818, device='cuda:1')
mal distance is  tensor(183.8818, device='cuda:1')
user_PLR len size 44
counter_tensor is  tensor([12., 40., 30., 29., 31., 30., 19., 27., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32., 18., 15., 13., 14., 43., 13., 32., 12.,
        12., 18.,  1., 15., 13., 12., 14., 30., 13., 12., 12., 27., 30., 24.,
        12.,  5.])
count_res tensor([3.2785e-14, 4.7415e-02, 2.1527e-06, 7.9192e-07, 5.8515e-06, 2.1527e-06,
        3.5953e-11, 1.0717e-07, 1.5906e-05, 1.5906e-05, 1.5906e-05, 1.5906e-05,
        1.5906e-05, 1.5906e-05, 1.5906e-05, 1.5906e-05, 1.5906e-05, 1.5906e-05,
        1.5906e-05, 1.5906e-05, 1.3226e-11, 6.5850e-13, 8.9118e-14, 2.4225e-13,
        9.5236e-01, 8.9118e-14, 1.5906e-05, 3.2785e-14, 3.2785e-14, 1.3226e-11,
        5.4756e-19, 6.5850e-13, 8.9118e-14, 3.2785e-14, 2.4225e-13, 2.1527e-06,
        8.9118e-14, 3.2785e-14, 3.2785e-14, 1.0717e-07, 2.1527e-06, 5.3359e-09,
        3.2785e-14, 2.9896e-17])
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 51.50% 

Test Accuracy: 75.94% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8090841714292765
distance x is tensor(138.7076, device='cuda:1')
benign distance is  tensor(138.7076, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.290177658200264
distance x is tensor(98.7615, device='cuda:1')
benign distance is  tensor(98.7615, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  1.6864655539393425
distance x is tensor(115.2819, device='cuda:1')
benign distance is  tensor(115.2819, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.8127198815345764
distance x is tensor(146.6823, device='cuda:1')
benign distance is  tensor(146.6823, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  1.6195501424372196
distance x is tensor(135.0583, device='cuda:1')
benign distance is  tensor(135.0583, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.444144356995821
distance x is tensor(125.3706, device='cuda:1')
benign distance is  tensor(125.3706, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.624819092452526
distance x is tensor(123.9252, device='cuda:1')
benign distance is  tensor(123.9252, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  1.9108921214938164
distance x is tensor(98.1042, device='cuda:1')
benign distance is  tensor(98.1042, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  1.8524647131562233
distance x is tensor(102.2045, device='cuda:1')
benign distance is  tensor(102.2045, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  1.376988485455513
distance x is tensor(130.9475, device='cuda:1')
benign distance is  tensor(130.9475, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.1744029596447945
distance x is tensor(95.6122, device='cuda:1')
benign distance is  tensor(95.6122, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.3395547419786453
distance x is tensor(120.5343, device='cuda:1')
benign distance is  tensor(120.5343, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  1.7348628640174866
distance x is tensor(152.7971, device='cuda:1')
benign distance is  tensor(152.7971, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  1.703399159014225
distance x is tensor(83.8674, device='cuda:1')
benign distance is  tensor(83.8674, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  1.6919190660119057
distance x is tensor(135.9664, device='cuda:1')
benign distance is  tensor(135.9664, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.745296612381935
distance x is tensor(123.9133, device='cuda:1')
benign distance is  tensor(123.9133, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  1.8578961193561554
distance x is tensor(110.6420, device='cuda:1')
benign distance is  tensor(110.6420, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  1.4995600208640099
distance x is tensor(123.6873, device='cuda:1')
benign distance is  tensor(123.6873, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  1.640020564198494
distance x is tensor(138.3996, device='cuda:1')
benign distance is  tensor(138.3996, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  1.8992434069514275
distance x is tensor(133.1269, device='cuda:1')
benign distance is  tensor(133.1269, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  1.8639430850744247
distance x is tensor(104.1677, device='cuda:1')
benign distance is  tensor(104.1677, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  1.2630521841347218
distance x is tensor(197.6756, device='cuda:1')
benign distance is  tensor(197.6756, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  1.7208916172385216
distance x is tensor(173.5974, device='cuda:1')
benign distance is  tensor(173.5974, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.3833072781562805
distance x is tensor(127.5358, device='cuda:1')
benign distance is  tensor(127.5358, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  3.31387697160244
distance x is tensor(109.8992, device='cuda:1')
benign distance is  tensor(109.8992, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  2.514154814183712
distance x is tensor(131.1262, device='cuda:1')
benign distance is  tensor(131.1262, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.19516983628273
distance x is tensor(163.8692, device='cuda:1')
benign distance is  tensor(163.8692, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  2.013533130288124
distance x is tensor(88.6444, device='cuda:1')
benign distance is  tensor(88.6444, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  1.6053902357816696
distance x is tensor(127.2860, device='cuda:1')
benign distance is  tensor(127.2860, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  1.583000898361206
distance x is tensor(133.9132, device='cuda:1')
benign distance is  tensor(133.9132, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.609825573861599
distance x is tensor(107.5048, device='cuda:1')
benign distance is  tensor(107.5048, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.5682991556823254
distance x is tensor(149.9681, device='cuda:1')
benign distance is  tensor(149.9681, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(93.7631, device='cuda:1')
compute distance is  tensor(93.7631, device='cuda:1')
compute norm is  tensor(61.2663, device='cuda:1', dtype=torch.float64)
distance x is tensor(138.4754, device='cuda:1')
compute distance is  tensor(138.4754, device='cuda:1')
compute norm is  tensor(61.9162, device='cuda:1', dtype=torch.float64)
distance x is tensor(110.2707, device='cuda:1')
compute distance is  tensor(110.2707, device='cuda:1')
compute norm is  tensor(61.4329, device='cuda:1', dtype=torch.float64)
distance x is tensor(102.8843, device='cuda:1')
compute distance is  tensor(102.8843, device='cuda:1')
compute norm is  tensor(61.4600, device='cuda:1', dtype=torch.float64)
distance x is tensor(99.1068, device='cuda:1')
compute distance is  tensor(99.1068, device='cuda:1')
compute norm is  tensor(61.3094, device='cuda:1', dtype=torch.float64)
distance x is tensor(111.5688, device='cuda:1')
compute distance is  tensor(111.5688, device='cuda:1')
compute norm is  tensor(61.5631, device='cuda:1', dtype=torch.float64)
distance x is tensor(125.4908, device='cuda:1')
compute distance is  tensor(125.4908, device='cuda:1')
compute norm is  tensor(61.7370, device='cuda:1', dtype=torch.float64)
distance x is tensor(96.2325, device='cuda:1')
compute distance is  tensor(96.2325, device='cuda:1')
compute norm is  tensor(61.3267, device='cuda:1', dtype=torch.float64)
distance x is tensor(113.8813, device='cuda:1')
compute distance is  tensor(113.8813, device='cuda:1')
compute norm is  tensor(61.7386, device='cuda:1', dtype=torch.float64)
distance x is tensor(99.3891, device='cuda:1')
compute distance is  tensor(99.3891, device='cuda:1')
compute norm is  tensor(61.5070, device='cuda:1', dtype=torch.float64)
distance x is tensor(127.0782, device='cuda:1')
compute distance is  tensor(127.0782, device='cuda:1')
compute norm is  tensor(61.7204, device='cuda:1', dtype=torch.float64)
distance x is tensor(165.5207, device='cuda:1')
compute distance is  tensor(165.5207, device='cuda:1')
compute norm is  tensor(62.7443, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(165.5207, device='cuda:1')
distance x is tensor(101969.7422, device='cuda:1')
distance x is tensor(101969.7422, device='cuda:1')
________________________________
test distance is  tensor(101969.7422, device='cuda:1')
test distance1 is  tensor(101969.7422, device='cuda:1')
test similarity is  tensor(0.4241, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107633861508595.98
test entropy is  0.0
________________________________
cal ratio is  0.03948358943120092
distance x is tensor(4026.1367, device='cuda:1')
cal_distance is  tensor(4026.1367, device='cuda:1')
cal ratio is  0.1987046485979552
distance x is tensor(800.0156, device='cuda:1')
cal_distance is  tensor(800.0156, device='cuda:1')
cal ratio is  0.4457620099726156
distance x is tensor(356.6192, device='cuda:1')
cal_distance is  tensor(356.6192, device='cuda:1')
cal ratio is  0.6676516587420687
distance x is tensor(238.0989, device='cuda:1')
cal_distance is  tensor(238.0989, device='cuda:1')
cal ratio is  0.8170969914921226
distance x is tensor(194.5507, device='cuda:1')
cal_distance is  tensor(194.5507, device='cuda:1')
cal ratio is  0.9039321644331529
distance x is tensor(175.8611, device='cuda:1')
cal_distance is  tensor(175.8611, device='cuda:1')
cal ratio is  0.9507522658833404
distance x is tensor(167.2006, device='cuda:1')
cal_distance is  tensor(167.2006, device='cuda:1')
cal ratio is  0.975064650360645
distance x is tensor(163.0315, device='cuda:1')
cal_distance is  tensor(163.0315, device='cuda:1')
distance x is tensor(163.0315, device='cuda:1')
return_distance is  tensor(163.0315, device='cuda:1')
distance x is tensor(163.0224, device='cuda:1')
distance x is tensor(163.0224, device='cuda:1')
________________________________
test distance is  tensor(163.0224, device='cuda:1')
test distance1 is  tensor(163.0224, device='cuda:1')
test similarity is  tensor(0.9740, device='cuda:1')
test acc is  0.12158333348966525
test loss is 120.49271671807588
test entropy is  0.009784281124384345
________________________________
0
distance x is tensor(163.0224, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.009483624648416664
avg test loss is  120.79290756030377
avg accuracy is  0.5312000001563423
solo acc is  0.12075000015633192
compute similarity  is  tensor(0.9740, device='cuda:1')
compute_distance is  tensor(163.0224, device='cuda:1')
compute_norm is  tensor(65.8705, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(608.6645, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.5504364122205705
avg test loss is  2.8917766148601767
avg accuracy is  0.12015000015633194
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4611, device='cuda:1')
compute_distance is  tensor(608.6645, device='cuda:1')
compute_norm is  tensor(122.9752, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(606.3522, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8468450678945351
avg test loss is  3.6449094230432246
avg accuracy is  0.11693333348966528
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4611, device='cuda:1')
compute_distance is  tensor(606.3522, device='cuda:1')
compute_norm is  tensor(122.5073, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(603.8238, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.5515978337605116
avg test loss is  2.876640729812671
avg accuracy is  0.11775000015633194
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4609, device='cuda:1')
compute_distance is  tensor(603.8238, device='cuda:1')
compute_norm is  tensor(121.7677, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(601.6503, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.833432972621816
avg test loss is  3.6460260948392627
avg accuracy is  0.11588333348966527
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4610, device='cuda:1')
compute_distance is  tensor(601.6503, device='cuda:1')
compute_norm is  tensor(121.3788, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(599.0919, device='cuda:1')
distance x is tensor(599.0919, device='cuda:1')
________________________________
test distance is  tensor(599.0919, device='cuda:1')
test distance1 is  tensor(599.0919, device='cuda:1')
test similarity is  tensor(0.4607, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.872258185069444
test entropy is  1.5514349950147843
________________________________
cal ratio is  0.5151165972470729
distance x is tensor(308.6042, device='cuda:1')
cal_distance is  tensor(308.6042, device='cuda:1')
cal ratio is  0.7177139794709383
distance x is tensor(221.4899, device='cuda:1')
cal_distance is  tensor(221.4899, device='cuda:1')
cal ratio is  0.8471793119400001
distance x is tensor(187.6418, device='cuda:1')
cal_distance is  tensor(187.6418, device='cuda:1')
cal ratio is  0.9204229388851476
distance x is tensor(172.7099, device='cuda:1')
cal_distance is  tensor(172.7099, device='cuda:1')
cal ratio is  0.9593865067602712
distance x is tensor(165.6957, device='cuda:1')
cal_distance is  tensor(165.6957, device='cuda:1')
cal ratio is  0.9794825326156565
distance x is tensor(162.2961, device='cuda:1')
cal_distance is  tensor(162.2961, device='cuda:1')
distance x is tensor(162.2961, device='cuda:1')
return_distance is  tensor(162.2961, device='cuda:1')
distance x is tensor(162.2934, device='cuda:1')
distance x is tensor(162.2934, device='cuda:1')
________________________________
test distance is  tensor(162.2934, device='cuda:1')
test distance1 is  tensor(162.2934, device='cuda:1')
test similarity is  tensor(0.8800, device='cuda:1')
test acc is  0.23943333348967136
test loss is 3.7170854021491273
test entropy is  1.2951726095000309
________________________________
0
distance x is tensor(162.2934, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.2930145981723566
avg test loss is  3.723513351828813
avg accuracy is  0.23491666682300438
solo acc is  0.24085000015633803
compute similarity  is  tensor(0.8800, device='cuda:1')
compute_distance is  tensor(162.2934, device='cuda:1')
compute_norm is  tensor(70.5781, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(166.3688, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.7509083522916603
avg test loss is  3.043049509845563
avg accuracy is  0.21470000015633692
solo acc is  0.10265000015633197
compute similarity  is  tensor(0.8792, device='cuda:1')
compute_distance is  tensor(166.3688, device='cuda:1')
compute_norm is  tensor(70.3021, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(168.1816, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.1161590974722335
avg test loss is  1.8121416188760606
avg accuracy is  0.25391666682300507
solo acc is  0.20711666682300334
compute similarity  is  tensor(0.8790, device='cuda:1')
compute_distance is  tensor(168.1816, device='cuda:1')
compute_norm is  tensor(69.9511, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(169.0987, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.6707238859332192
avg test loss is  2.625219028895852
avg accuracy is  0.24300000015633802
solo acc is  0.10768333348966529
compute similarity  is  tensor(0.8786, device='cuda:1')
compute_distance is  tensor(169.0987, device='cuda:1')
compute_norm is  tensor(69.6864, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(170.9681, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  1.041377259152276
avg test loss is  1.6366631805515492
avg accuracy is  0.26863333348967205
solo acc is  0.23611666682300447
compute similarity  is  tensor(0.8784, device='cuda:1')
compute_distance is  tensor(170.9681, device='cuda:1')
compute_norm is  tensor(69.3180, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(171.8123, device='cuda:1')
distance x is tensor(171.8123, device='cuda:1')
________________________________
test distance is  tensor(171.8123, device='cuda:1')
test distance1 is  tensor(171.8123, device='cuda:1')
test similarity is  tensor(0.8780, device='cuda:1')
test acc is  0.10883333348966528
test loss is 2.4757102102613144
test entropy is  0.6313351758126257
________________________________
cal ratio is  0.9618894604320357
distance x is tensor(165.2659, device='cuda:1')
cal_distance is  tensor(165.2659, device='cuda:1')
distance x is tensor(165.2659, device='cuda:1')
return_distance is  tensor(165.2659, device='cuda:1')
distance x is tensor(165.2644, device='cuda:1')
distance x is tensor(165.2644, device='cuda:1')
________________________________
test distance is  tensor(165.2644, device='cuda:1')
test distance1 is  tensor(165.2644, device='cuda:1')
test similarity is  tensor(0.8857, device='cuda:1')
test acc is  0.11553333348966527
test loss is 2.320618393070408
test entropy is  0.7009027825871001
________________________________
0
distance x is tensor(165.2644, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.6992188146246522
avg test loss is  2.3292912886595167
avg accuracy is  0.25478333348967175
solo acc is  0.1160166668229986
compute similarity  is  tensor(0.8857, device='cuda:1')
compute_distance is  tensor(165.2644, device='cuda:1')
compute_norm is  tensor(68.5174, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(167.4930, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.0001997490808654
avg test loss is  1.5550811327596716
avg accuracy is  0.2733333334896722
solo acc is  0.24486666682300479
compute similarity  is  tensor(0.8854, device='cuda:1')
compute_distance is  tensor(167.4930, device='cuda:1')
compute_norm is  tensor(68.1548, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(168.5360, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.6175300022686468
avg test loss is  2.3805139208399155
avg accuracy is  0.264133333489672
solo acc is  0.10865000015633196
compute similarity  is  tensor(0.8850, device='cuda:1')
compute_distance is  tensor(168.5360, device='cuda:1')
compute_norm is  tensor(67.8860, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(170.3166, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.9732128828446239
avg test loss is  1.4914950310294308
avg accuracy is  0.28373333348967245
solo acc is  0.255516666823005
compute similarity  is  tensor(0.8847, device='cuda:1')
compute_distance is  tensor(170.3166, device='cuda:1')
compute_norm is  tensor(67.5232, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
distance x is tensor(170.3175, device='cuda:1')
________________________________
test distance is  tensor(170.3175, device='cuda:1')
test similarity is  tensor(0.8847, device='cuda:1')
test acc is  0.2822166668230058
test loss is 1.4860479486014035
test entropy is  0.972698832879951
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2660000001600001
mal loss is 1.4927432388067245
mal norm is  tensor(1456.2848, device='cuda:1')
distance x is tensor(170.3175, device='cuda:1')
mal distance is  tensor(170.3175, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([12., 12., 12., 12., 12., 12., 12., 12., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05, 2.7949e-05,
        2.7949e-05, 2.7949e-05, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02, 8.3315e-02,
        8.3315e-02, 8.3315e-02])
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 23.81% 

Test Accuracy: 24.36% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.7318499237298965
distance x is tensor(402.2415, device='cuda:1')
benign distance is  tensor(402.2415, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.5538060665130615
distance x is tensor(752.5150, device='cuda:1')
benign distance is  tensor(752.5150, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.2419662922620773
distance x is tensor(220.5608, device='cuda:1')
benign distance is  tensor(220.5608, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.563357353210449
distance x is tensor(296.7070, device='cuda:1')
benign distance is  tensor(296.7070, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.625209480524063
distance x is tensor(331.9770, device='cuda:1')
benign distance is  tensor(331.9770, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.575289562344551
distance x is tensor(285.2112, device='cuda:1')
benign distance is  tensor(285.2112, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.964476525783539
distance x is tensor(289.8258, device='cuda:1')
benign distance is  tensor(289.8258, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  3.2694654315710068
distance x is tensor(507.8128, device='cuda:1')
benign distance is  tensor(507.8128, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(442.3541, device='cuda:1')
compute distance is  tensor(442.3541, device='cuda:1')
compute norm is  tensor(84.3028, device='cuda:1', dtype=torch.float64)
distance x is tensor(440.1201, device='cuda:1')
compute distance is  tensor(440.1201, device='cuda:1')
compute norm is  tensor(95.0397, device='cuda:1', dtype=torch.float64)
distance x is tensor(293.3885, device='cuda:1')
compute distance is  tensor(293.3885, device='cuda:1')
compute norm is  tensor(75.3806, device='cuda:1', dtype=torch.float64)
distance x is tensor(300.3863, device='cuda:1')
compute distance is  tensor(300.3863, device='cuda:1')
compute norm is  tensor(74.8595, device='cuda:1', dtype=torch.float64)
distance x is tensor(133.6852, device='cuda:1')
compute distance is  tensor(133.6852, device='cuda:1')
compute norm is  tensor(69.6918, device='cuda:1', dtype=torch.float64)
distance x is tensor(269.3337, device='cuda:1')
compute distance is  tensor(269.3337, device='cuda:1')
compute norm is  tensor(73.4989, device='cuda:1', dtype=torch.float64)
distance x is tensor(432.0044, device='cuda:1')
compute distance is  tensor(432.0044, device='cuda:1')
compute norm is  tensor(97.5839, device='cuda:1', dtype=torch.float64)
distance x is tensor(338.4163, device='cuda:1')
compute distance is  tensor(338.4163, device='cuda:1')
compute norm is  tensor(76.7476, device='cuda:1', dtype=torch.float64)
distance x is tensor(893.3004, device='cuda:1')
compute distance is  tensor(893.3004, device='cuda:1')
compute norm is  tensor(141.9375, device='cuda:1', dtype=torch.float64)
distance x is tensor(256.5363, device='cuda:1')
compute distance is  tensor(256.5363, device='cuda:1')
compute norm is  tensor(74.7859, device='cuda:1', dtype=torch.float64)
distance x is tensor(434.9484, device='cuda:1')
compute distance is  tensor(434.9484, device='cuda:1')
compute norm is  tensor(99.9518, device='cuda:1', dtype=torch.float64)
distance x is tensor(315.0093, device='cuda:1')
compute distance is  tensor(315.0093, device='cuda:1')
compute norm is  tensor(77.5572, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(893.3004, device='cuda:1')
distance x is tensor(101938.9766, device='cuda:1')
distance x is tensor(101938.9766, device='cuda:1')
________________________________
test distance is  tensor(101938.9766, device='cuda:1')
test distance1 is  tensor(101938.9766, device='cuda:1')
test similarity is  tensor(0.4140, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107604739329096.05
test entropy is  0.0
________________________________
cal ratio is  0.09173914391613741
distance x is tensor(9351.8008, device='cuda:1')
cal_distance is  tensor(9351.8008, device='cuda:1')
cal ratio is  0.30288460978157494
distance x is tensor(2832.5195, device='cuda:1')
cal_distance is  tensor(2832.5195, device='cuda:1')
cal ratio is  0.5503492434710888
distance x is tensor(1558.8772, device='cuda:1')
cal_distance is  tensor(1558.8772, device='cuda:1')
cal ratio is  0.7418547586091604
distance x is tensor(1156.4615, device='cuda:1')
cal_distance is  tensor(1156.4615, device='cuda:1')
cal ratio is  0.8613094826270306
distance x is tensor(996.0720, device='cuda:1')
cal_distance is  tensor(996.0720, device='cuda:1')
cal ratio is  0.9280672998827654
distance x is tensor(924.4222, device='cuda:1')
cal_distance is  tensor(924.4222, device='cuda:1')
cal ratio is  0.963362304915682
distance x is tensor(890.5537, device='cuda:1')
cal_distance is  tensor(890.5537, device='cuda:1')
distance x is tensor(890.5537, device='cuda:1')
return_distance is  tensor(890.5537, device='cuda:1')
distance x is tensor(890.5446, device='cuda:1')
distance x is tensor(890.5446, device='cuda:1')
________________________________
test distance is  tensor(890.5446, device='cuda:1')
test distance1 is  tensor(890.5446, device='cuda:1')
test similarity is  tensor(0.7722, device='cuda:1')
test acc is  0.10000000015633198
test loss is 4155773.2412046907
test entropy is  0.0
________________________________
0
distance x is tensor(890.5446, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  4151579.7486673775
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7722, device='cuda:1')
compute_distance is  tensor(890.5446, device='cuda:1')
compute_norm is  tensor(113.4023, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(157068.4062, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.5369409687483488
avg test loss is  2.893124752969884
avg accuracy is  0.10003333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0378, device='cuda:1')
compute_distance is  tensor(157068.4062, device='cuda:1')
compute_norm is  tensor(10708.8346, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(156334.2812, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8295502529850901
avg test loss is  3.6512202276095653
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0378, device='cuda:1')
compute_distance is  tensor(156334.2812, device='cuda:1')
compute_norm is  tensor(10658.8635, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(155603.2812, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.5454040868704253
avg test loss is  2.8775098959265994
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0378, device='cuda:1')
compute_distance is  tensor(155603.2812, device='cuda:1')
compute_norm is  tensor(10608.7640, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(154876., device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8357434807809939
avg test loss is  3.6307883999749286
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0378, device='cuda:1')
compute_distance is  tensor(154876., device='cuda:1')
compute_norm is  tensor(10559.3138, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(154151.9062, device='cuda:1')
distance x is tensor(154151.9062, device='cuda:1')
________________________________
test distance is  tensor(154151.9062, device='cuda:1')
test distance1 is  tensor(154151.9062, device='cuda:1')
test similarity is  tensor(-0.0378, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.866423315585041
test entropy is  1.5550932144559522
________________________________
cal ratio is  0.07460198356929247
distance x is tensor(11500.0342, device='cuda:1')
cal_distance is  tensor(11500.0342, device='cuda:1')
cal ratio is  0.27313368661824144
distance x is tensor(3141.0437, device='cuda:1')
cal_distance is  tensor(3141.0437, device='cuda:1')
cal ratio is  0.5226221771652128
distance x is tensor(1641.5768, device='cuda:1')
cal_distance is  tensor(1641.5768, device='cuda:1')
cal ratio is  0.7229266559852429
distance x is tensor(1186.7384, device='cuda:1')
cal_distance is  tensor(1186.7384, device='cuda:1')
cal ratio is  0.8502513402963611
distance x is tensor(1009.0255, device='cuda:1')
cal_distance is  tensor(1009.0255, device='cuda:1')
cal ratio is  0.9220909801607938
distance x is tensor(930.4128, device='cuda:1')
cal_distance is  tensor(930.4128, device='cuda:1')
cal ratio is  0.9602558876156042
distance x is tensor(893.4343, device='cuda:1')
cal_distance is  tensor(893.4343, device='cuda:1')
cal ratio is  0.979926514254554
distance x is tensor(875.4998, device='cuda:1')
cal_distance is  tensor(875.4998, device='cuda:1')
distance x is tensor(875.4998, device='cuda:1')
return_distance is  tensor(875.4998, device='cuda:1')
distance x is tensor(875.5088, device='cuda:1')
distance x is tensor(875.5088, device='cuda:1')
________________________________
test distance is  tensor(875.5088, device='cuda:1')
test distance1 is  tensor(875.5088, device='cuda:1')
test similarity is  tensor(0.5878, device='cuda:1')
test acc is  0.10008333348966532
test loss is 10751.230624396156
test entropy is  0.031514339298028486
________________________________
0
distance x is tensor(875.5088, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.03145934087152335
avg test loss is  10761.033432690065
avg accuracy is  0.10000000015633198
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.5878, device='cuda:1')
compute_distance is  tensor(875.5088, device='cuda:1')
compute_norm is  tensor(103.8403, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1774.6879, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.4874778203110197
avg test loss is  2.6267888182516037
avg accuracy is  0.11396666682299861
solo acc is  0.10765000015633196
compute similarity  is  tensor(0.3721, device='cuda:1')
compute_distance is  tensor(1774.6879, device='cuda:1')
compute_norm is  tensor(130.0764, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1767.7242, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8063214915012246
avg test loss is  3.3759526794653203
avg accuracy is  0.11278333348966528
solo acc is  0.10066666682299863
compute similarity  is  tensor(0.3723, device='cuda:1')
compute_distance is  tensor(1767.7242, device='cuda:1')
compute_norm is  tensor(129.6927, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1763.4725, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.4058314696557994
avg test loss is  2.351863363531353
avg accuracy is  0.11273333348966529
solo acc is  0.12195000015633192
compute similarity  is  tensor(0.3720, device='cuda:1')
compute_distance is  tensor(1763.4725, device='cuda:1')
compute_norm is  tensor(128.9783, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(1756.6895, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.7745462281744617
avg test loss is  3.132112346224185
avg accuracy is  0.11155000015633196
solo acc is  0.1013333334896653
compute similarity  is  tensor(0.3722, device='cuda:1')
compute_distance is  tensor(1756.6895, device='cuda:1')
compute_norm is  tensor(128.5983, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(1752.3213, device='cuda:1')
distance x is tensor(1752.3213, device='cuda:1')
________________________________
test distance is  tensor(1752.3213, device='cuda:1')
test distance1 is  tensor(1752.3213, device='cuda:1')
test similarity is  tensor(0.3718, device='cuda:1')
test acc is  0.13816666682299872
test loss is 2.1511681950422745
test entropy is  1.3051716040954915
________________________________
cal ratio is  0.6997097896758476
distance x is tensor(1226.1106, device='cuda:1')
cal_distance is  tensor(1226.1106, device='cuda:1')
cal ratio is  0.8364885639382569
distance x is tensor(1025.6270, device='cuda:1')
cal_distance is  tensor(1025.6270, device='cuda:1')
cal ratio is  0.9145977183422171
distance x is tensor(938.0358, device='cuda:1')
cal_distance is  tensor(938.0358, device='cuda:1')
cal ratio is  0.9563461891364842
distance x is tensor(897.0867, device='cuda:1')
cal_distance is  tensor(897.0867, device='cuda:1')
cal ratio is  0.9779296582928427
distance x is tensor(877.2878, device='cuda:1')
cal_distance is  tensor(877.2878, device='cuda:1')
distance x is tensor(877.2878, device='cuda:1')
return_distance is  tensor(877.2878, device='cuda:1')
distance x is tensor(877.2945, device='cuda:1')
distance x is tensor(877.2945, device='cuda:1')
________________________________
test distance is  tensor(877.2945, device='cuda:1')
test distance1 is  tensor(877.2945, device='cuda:1')
test similarity is  tensor(0.6831, device='cuda:1')
test acc is  0.10383333348966531
test loss is 2.722032527425396
test entropy is  1.2996000950016193
________________________________
0
distance x is tensor(877.2945, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.3000649821275332
avg test loss is  2.720394248138867
avg accuracy is  0.10365000015633197
solo acc is  0.10366666682299863
compute similarity  is  tensor(0.6831, device='cuda:1')
compute_distance is  tensor(877.2945, device='cuda:1')
compute_norm is  tensor(89.5336, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(875.4078, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.7797361454729841
avg test loss is  3.201775109844167
avg accuracy is  0.10281666682299863
solo acc is  0.10006666682299865
compute similarity  is  tensor(0.6831, device='cuda:1')
compute_distance is  tensor(875.4078, device='cuda:1')
compute_norm is  tensor(89.2439, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(876.1541, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.330251112675616
avg test loss is  2.1244785811092806
avg accuracy is  0.09896666682299865
solo acc is  0.13691666682299858
compute similarity  is  tensor(0.6822, device='cuda:1')
compute_distance is  tensor(876.1541, device='cuda:1')
compute_norm is  tensor(88.7875, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(873.5635, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.7543424555360635
avg test loss is  2.879542161152561
avg accuracy is  0.09988333348966531
solo acc is  0.10053333348966531
compute similarity  is  tensor(0.6822, device='cuda:1')
compute_distance is  tensor(873.5635, device='cuda:1')
compute_norm is  tensor(88.5676, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(873.4564, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  1.2239465881258185
avg test loss is  1.9506210111605842
avg accuracy is  0.09771666682299865
solo acc is  0.160500000156334
compute similarity  is  tensor(0.6813, device='cuda:1')
compute_distance is  tensor(873.4564, device='cuda:1')
compute_norm is  tensor(88.1271, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(870.6309, device='cuda:1')
________________________________
test distance is  tensor(870.6309, device='cuda:1')
test similarity is  tensor(0.6814, device='cuda:1')
test acc is  0.09848333348966531
test loss is 2.7279604675927396
test entropy is  0.7112151028505013
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.11000000016000001
mal loss is 2.7069325000047684
mal norm is  tensor(2890.6655, device='cuda:1')
distance x is tensor(870.6309, device='cuda:1')
mal distance is  tensor(870.6309, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([34., 34., 33., 31.,  2., 33., 30., 34., 21., 21., 21., 21., 21., 21.,
        21., 21., 21., 21., 21., 21., 16., 16.,  4., 16., 17., 16.,  4.,  4.,
        16., 16., 17., 16., 16., 17.,  4., 16.])
count_res tensor([2.6289e-01, 2.6289e-01, 9.6711e-02, 1.3088e-02, 3.3293e-15, 9.6711e-02,
        4.8150e-03, 2.6289e-01, 5.9422e-07, 5.9422e-07, 5.9422e-07, 5.9422e-07,
        5.9422e-07, 5.9422e-07, 5.9422e-07, 5.9422e-07, 5.9422e-07, 5.9422e-07,
        5.9422e-07, 5.9422e-07, 4.0038e-09, 4.0038e-09, 2.4600e-14, 4.0038e-09,
        1.0883e-08, 4.0038e-09, 2.4600e-14, 2.4600e-14, 4.0038e-09, 4.0038e-09,
        1.0883e-08, 4.0038e-09, 4.0038e-09, 1.0883e-08, 2.4600e-14, 4.0038e-09])
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.7392418384552
distance x is tensor(4.7517, device='cuda:1')
benign distance is  tensor(4.7517, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.3294005542993546
distance x is tensor(3.7817, device='cuda:1')
benign distance is  tensor(3.7817, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.390201896429062
distance x is tensor(4.9588, device='cuda:1')
benign distance is  tensor(4.9588, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.1330025643110275
distance x is tensor(6.5283, device='cuda:1')
benign distance is  tensor(6.5283, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.291038915514946
distance x is tensor(7.3518, device='cuda:1')
benign distance is  tensor(7.3518, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.790340408682823
distance x is tensor(3.6076, device='cuda:1')
benign distance is  tensor(3.6076, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.140551745891571
distance x is tensor(5.8143, device='cuda:1')
benign distance is  tensor(5.8143, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.9778198897838593
distance x is tensor(3.8579, device='cuda:1')
benign distance is  tensor(3.8579, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  3.137942224740982
distance x is tensor(5.6069, device='cuda:1')
benign distance is  tensor(5.6069, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.910270243883133
distance x is tensor(6.2725, device='cuda:1')
benign distance is  tensor(6.2725, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  3.37845578789711
distance x is tensor(6.1995, device='cuda:1')
benign distance is  tensor(6.1995, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.602273479104042
distance x is tensor(7.4846, device='cuda:1')
benign distance is  tensor(7.4846, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  3.2267586290836334
distance x is tensor(6.6382, device='cuda:1')
benign distance is  tensor(6.6382, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.7041315138339996
distance x is tensor(3.0369, device='cuda:1')
benign distance is  tensor(3.0369, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.741881638765335
distance x is tensor(5.2338, device='cuda:1')
benign distance is  tensor(5.2338, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.5697401612997055
distance x is tensor(7.5275, device='cuda:1')
benign distance is  tensor(7.5275, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  3.0404282063245773
distance x is tensor(6.3635, device='cuda:1')
benign distance is  tensor(6.3635, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  2.756693497300148
distance x is tensor(4.3773, device='cuda:1')
benign distance is  tensor(4.3773, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  3.1714533120393753
distance x is tensor(6.6609, device='cuda:1')
benign distance is  tensor(6.6609, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  3.5183475017547607
distance x is tensor(7.0386, device='cuda:1')
benign distance is  tensor(7.0386, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  2.8424850702285767
distance x is tensor(6.1472, device='cuda:1')
benign distance is  tensor(6.1472, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  3.0143397003412247
distance x is tensor(28.2000, device='cuda:1')
benign distance is  tensor(28.2000, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  2.580673411488533
distance x is tensor(5.1568, device='cuda:1')
benign distance is  tensor(5.1568, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  3.335951641201973
distance x is tensor(24.4564, device='cuda:1')
benign distance is  tensor(24.4564, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(5.2185, device='cuda:1')
compute distance is  tensor(5.2185, device='cuda:1')
compute norm is  tensor(82.8102, device='cuda:1', dtype=torch.float64)
distance x is tensor(5.1388, device='cuda:1')
compute distance is  tensor(5.1388, device='cuda:1')
compute norm is  tensor(83.2662, device='cuda:1', dtype=torch.float64)
distance x is tensor(5.4564, device='cuda:1')
compute distance is  tensor(5.4564, device='cuda:1')
compute norm is  tensor(83.1160, device='cuda:1', dtype=torch.float64)
distance x is tensor(6.0380, device='cuda:1')
compute distance is  tensor(6.0380, device='cuda:1')
compute norm is  tensor(83.2776, device='cuda:1', dtype=torch.float64)
distance x is tensor(5.5520, device='cuda:1')
compute distance is  tensor(5.5520, device='cuda:1')
compute norm is  tensor(83.4186, device='cuda:1', dtype=torch.float64)
distance x is tensor(3.7002, device='cuda:1')
compute distance is  tensor(3.7002, device='cuda:1')
compute norm is  tensor(83.2696, device='cuda:1', dtype=torch.float64)
distance x is tensor(133.4511, device='cuda:1')
compute distance is  tensor(133.4511, device='cuda:1')
compute norm is  tensor(93.1596, device='cuda:1', dtype=torch.float64)
distance x is tensor(7.1674, device='cuda:1')
compute distance is  tensor(7.1674, device='cuda:1')
compute norm is  tensor(83.3499, device='cuda:1', dtype=torch.float64)
distance x is tensor(4.9339, device='cuda:1')
compute distance is  tensor(4.9339, device='cuda:1')
compute norm is  tensor(83.1556, device='cuda:1', dtype=torch.float64)
distance x is tensor(34.5231, device='cuda:1')
compute distance is  tensor(34.5231, device='cuda:1')
compute norm is  tensor(83.9619, device='cuda:1', dtype=torch.float64)
distance x is tensor(6.1000, device='cuda:1')
compute distance is  tensor(6.1000, device='cuda:1')
compute norm is  tensor(83.1269, device='cuda:1', dtype=torch.float64)
distance x is tensor(5.5819, device='cuda:1')
compute distance is  tensor(5.5819, device='cuda:1')
compute norm is  tensor(83.2576, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(133.4511, device='cuda:1')
distance x is tensor(102117.7812, device='cuda:1')
distance x is tensor(102117.7812, device='cuda:1')
________________________________
test distance is  tensor(102117.7812, device='cuda:1')
test distance1 is  tensor(102117.7812, device='cuda:1')
test similarity is  tensor(0.2466, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107576267991105.5
test entropy is  0.0
________________________________
cal ratio is  0.03542716758229839
distance x is tensor(3617.7495, device='cuda:1')
cal_distance is  tensor(3617.7495, device='cuda:1')
cal ratio is  0.18822091593328213
distance x is tensor(680.9398, device='cuda:1')
cal_distance is  tensor(680.9398, device='cuda:1')
cal ratio is  0.4338431638930627
distance x is tensor(295.4237, device='cuda:1')
cal_distance is  tensor(295.4237, device='cuda:1')
cal ratio is  0.6586648295770814
distance x is tensor(194.5868, device='cuda:1')
cal_distance is  tensor(194.5868, device='cuda:1')
cal ratio is  0.8115783704249572
distance x is tensor(157.9233, device='cuda:1')
cal_distance is  tensor(157.9233, device='cuda:1')
cal ratio is  0.9008739754559971
distance x is tensor(142.2694, device='cuda:1')
cal_distance is  tensor(142.2694, device='cuda:1')
cal ratio is  0.9491423161757145
distance x is tensor(135.0342, device='cuda:1')
cal_distance is  tensor(135.0342, device='cuda:1')
cal ratio is  0.9742384519320872
distance x is tensor(131.5556, device='cuda:1')
cal_distance is  tensor(131.5556, device='cuda:1')
distance x is tensor(131.5556, device='cuda:1')
return_distance is  tensor(131.5556, device='cuda:1')
distance x is tensor(131.5464, device='cuda:1')
distance x is tensor(131.5464, device='cuda:1')
________________________________
test distance is  tensor(131.5464, device='cuda:1')
test distance1 is  tensor(131.5464, device='cuda:1')
test similarity is  tensor(0.9873, device='cuda:1')
test acc is  0.12400000015633193
test loss is 2.572472646546516
test entropy is  1.9781634093347642
________________________________
0
distance x is tensor(131.5464, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.9770877367652047
avg test loss is  2.5736155352358625
avg accuracy is  0.10286666682299865
solo acc is  0.12555000015633194
compute similarity  is  tensor(0.9873, device='cuda:1')
compute_distance is  tensor(131.5464, device='cuda:1')
compute_norm is  tensor(85.7937, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(136.3981, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9374218802335166
avg test loss is  3.3798501252619695
avg accuracy is  0.10055000015633196
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9865, device='cuda:1')
compute_distance is  tensor(136.3981, device='cuda:1')
compute_norm is  tensor(85.5960, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(138.9797, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.4673042504518017
avg test loss is  2.512461910878163
avg accuracy is  0.10565000015633196
solo acc is  0.10495000015633196
compute similarity  is  tensor(0.9865, device='cuda:1')
compute_distance is  tensor(138.9797, device='cuda:1')
compute_norm is  tensor(85.0937, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(140.7393, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8155635655688833
avg test loss is  3.2207925045159835
avg accuracy is  0.10246666682299864
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9861, device='cuda:1')
compute_distance is  tensor(140.7393, device='cuda:1')
compute_norm is  tensor(84.8772, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(142.6612, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  1.3416469450444302
avg test loss is  2.3446584784908335
avg accuracy is  0.10666666682299862
solo acc is  0.11848333348966525
compute similarity  is  tensor(0.9862, device='cuda:1')
compute_distance is  tensor(142.6612, device='cuda:1')
compute_norm is  tensor(84.3830, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(144.0917, device='cuda:1')
distance x is tensor(144.0917, device='cuda:1')
________________________________
test distance is  tensor(144.0917, device='cuda:1')
test distance1 is  tensor(144.0917, device='cuda:1')
test similarity is  tensor(0.9858, device='cuda:1')
test acc is  0.10008333348966532
test loss is 3.0611635161869564
test entropy is  0.7888745868892304
________________________________
cal ratio is  0.9431215819593292
distance x is tensor(135.9053, device='cuda:1')
cal_distance is  tensor(135.9053, device='cuda:1')
cal ratio is  0.9711112680243797
distance x is tensor(131.9793, device='cuda:1')
cal_distance is  tensor(131.9793, device='cuda:1')
distance x is tensor(131.9793, device='cuda:1')
return_distance is  tensor(131.9793, device='cuda:1')
distance x is tensor(131.9697, device='cuda:1')
distance x is tensor(131.9697, device='cuda:1')
________________________________
test distance is  tensor(131.9697, device='cuda:1')
test distance1 is  tensor(131.9697, device='cuda:1')
test similarity is  tensor(0.9880, device='cuda:1')
test acc is  0.10003333348966531
test loss is 2.8703031201860796
test entropy is  1.0112724977134386
________________________________
0
distance x is tensor(131.9697, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.0095026697050025
avg test loss is  2.8718842824639035
avg accuracy is  0.10503333348966529
solo acc is  0.10010000015633198
compute similarity  is  tensor(0.9880, device='cuda:1')
compute_distance is  tensor(131.9697, device='cuda:1')
compute_norm is  tensor(83.9356, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(133.8053, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.7678036104514401
avg test loss is  3.07729871542469
avg accuracy is  0.10285000015633197
solo acc is  0.10010000015633198
compute similarity  is  tensor(0.9878, device='cuda:1')
compute_distance is  tensor(133.8053, device='cuda:1')
compute_norm is  tensor(83.6292, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(135.8314, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.2852357500143397
avg test loss is  2.303796800341942
avg accuracy is  0.10515000015633195
solo acc is  0.12413333348966524
compute similarity  is  tensor(0.9879, device='cuda:1')
compute_distance is  tensor(135.8314, device='cuda:1')
compute_norm is  tensor(83.1410, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(137.6654, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.7692911121001376
avg test loss is  2.9862539862264703
avg accuracy is  0.10355000015633196
solo acc is  0.10011666682299865
compute similarity  is  tensor(0.9875, device='cuda:1')
compute_distance is  tensor(137.6654, device='cuda:1')
compute_norm is  tensor(82.9008, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(139.7120, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  1.2799817284287165
avg test loss is  2.2234828154415465
avg accuracy is  0.10681666682299862
solo acc is  0.1330500001563319
compute similarity  is  tensor(0.9876, device='cuda:1')
compute_distance is  tensor(139.7120, device='cuda:1')
compute_norm is  tensor(82.4279, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(141.7065, device='cuda:1')
distance x is tensor(141.7065, device='cuda:1')
________________________________
test distance is  tensor(141.7065, device='cuda:1')
test distance1 is  tensor(141.7065, device='cuda:1')
test similarity is  tensor(0.9873, device='cuda:1')
test acc is  0.10021666682299865
test loss is 2.9416815304298645
test entropy is  0.7580214073535985
________________________________
cal ratio is  0.9510257883170465
distance x is tensor(134.7758, device='cuda:1')
cal_distance is  tensor(134.7758, device='cuda:1')
cal ratio is  0.9751718456608572
distance x is tensor(131.4297, device='cuda:1')
cal_distance is  tensor(131.4297, device='cuda:1')
distance x is tensor(131.4297, device='cuda:1')
return_distance is  tensor(131.4297, device='cuda:1')
distance x is tensor(131.4202, device='cuda:1')
distance x is tensor(131.4202, device='cuda:1')
________________________________
test distance is  tensor(131.4202, device='cuda:1')
test distance1 is  tensor(131.4202, device='cuda:1')
test similarity is  tensor(0.9890, device='cuda:1')
test acc is  0.10026666682299865
test loss is 2.7441281591142928
test entropy is  0.9577656967807681
________________________________
0
distance x is tensor(131.4202, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.9582392892349504
avg test loss is  2.745101811789246
avg accuracy is  0.10470000015633195
solo acc is  0.10016666682299863
compute similarity  is  tensor(0.9890, device='cuda:1')
compute_distance is  tensor(131.4202, device='cuda:1')
compute_norm is  tensor(82.1584, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(134.1710, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.2889449466774459
avg test loss is  2.159289215038072
avg accuracy is  0.10890000015633196
solo acc is  0.13038333348966524
compute similarity  is  tensor(0.9890, device='cuda:1')
compute_distance is  tensor(134.1710, device='cuda:1')
compute_norm is  tensor(81.7405, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(136.4220, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.7578251562647219
avg test loss is  2.9029882157535187
avg accuracy is  0.10468333348966528
solo acc is  0.1002333334896653
compute similarity  is  tensor(0.9886, device='cuda:1')
compute_distance is  tensor(136.4220, device='cuda:1')
compute_norm is  tensor(81.5116, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(138.9742, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.2434234389109906
avg test loss is  2.1590409666490453
avg accuracy is  0.11068333348966529
solo acc is  0.1384333334896654
compute similarity  is  tensor(0.9886, device='cuda:1')
compute_distance is  tensor(138.9742, device='cuda:1')
compute_norm is  tensor(81.0623, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(141.2987, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.7408662771365282
avg test loss is  2.8528085764028877
avg accuracy is  0.10673333348966528
solo acc is  0.10026666682299865
compute similarity  is  tensor(0.9882, device='cuda:1')
compute_distance is  tensor(141.2987, device='cuda:1')
compute_norm is  tensor(80.8370, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(144.0884, device='cuda:1')
________________________________
test distance is  tensor(144.0884, device='cuda:1')
test similarity is  tensor(0.9883, device='cuda:1')
test acc is  0.11146666682299862
test loss is 2.040248631922675
test entropy is  1.2323967475118414
________________________________
final entropy
distance x is tensor(144.0793, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.2327159780429116
avg test loss is  2.0389068637575423
avg accuracy is  0.11190000015633193
solo acc is  0.14568333348966614
compute similarity  is  tensor(0.9883, device='cuda:1')
compute_distance is  tensor(144.0793, device='cuda:1')
compute_norm is  tensor(80.4104, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 2.707423433661461
mal norm is  tensor(592.6229, device='cuda:1')
distance x is tensor(146.4644, device='cuda:1')
mal distance is  tensor(146.4644, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([35., 33., 35., 30., 34., 30., 32., 31., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 20., 20., 20.,  7.,  7., 20.,  7., 20.,
        20.,  3., 20., 20., 20., 20., 20.,  4.])
count_res tensor([3.8688e-01, 5.2358e-02, 3.8688e-01, 2.6068e-03, 1.4232e-01, 2.6068e-03,
        1.9261e-02, 7.0859e-03, 2.1676e-09, 2.1676e-09, 2.1676e-09, 2.1676e-09,
        2.1676e-09, 2.1676e-09, 2.1676e-09, 2.1676e-09, 2.1676e-09, 2.1676e-09,
        2.1676e-09, 2.1676e-09, 1.1835e-07, 1.1835e-07, 1.1835e-07, 2.6750e-13,
        2.6750e-13, 1.1835e-07, 2.6750e-13, 1.1835e-07, 1.1835e-07, 4.8995e-15,
        1.1835e-07, 1.1835e-07, 1.1835e-07, 1.1835e-07, 1.1835e-07, 1.3318e-14])
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.686690032482147
distance x is tensor(4.4822, device='cuda:1')
benign distance is  tensor(4.4822, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.434910550713539
distance x is tensor(4.7951, device='cuda:1')
benign distance is  tensor(4.7951, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.354904979467392
distance x is tensor(3.8262, device='cuda:1')
benign distance is  tensor(3.8262, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.103262171149254
distance x is tensor(5.9079, device='cuda:1')
benign distance is  tensor(5.9079, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.2237973511219025
distance x is tensor(5.9525, device='cuda:1')
benign distance is  tensor(5.9525, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.7021686285734177
distance x is tensor(3.2955, device='cuda:1')
benign distance is  tensor(3.2955, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.123937338590622
distance x is tensor(5.1989, device='cuda:1')
benign distance is  tensor(5.1989, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.9752614498138428
distance x is tensor(4.7860, device='cuda:1')
benign distance is  tensor(4.7860, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.4128142297267914
distance x is tensor(5.8419, device='cuda:1')
benign distance is  tensor(5.8419, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  3.0027004778385162
distance x is tensor(5.1736, device='cuda:1')
benign distance is  tensor(5.1736, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  3.366876259446144
distance x is tensor(26.8320, device='cuda:1')
benign distance is  tensor(26.8320, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  3.128273129463196
distance x is tensor(6.2034, device='cuda:1')
benign distance is  tensor(6.2034, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  3.029754191637039
distance x is tensor(5.3953, device='cuda:1')
benign distance is  tensor(5.3953, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  2.7740006297826767
distance x is tensor(4.9051, device='cuda:1')
benign distance is  tensor(4.9051, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  3.0337706953287125
distance x is tensor(7.2431, device='cuda:1')
benign distance is  tensor(7.2431, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.9539959728717804
distance x is tensor(6.0242, device='cuda:1')
benign distance is  tensor(6.0242, device='cuda:1')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  2.6456050872802734
distance x is tensor(5.1471, device='cuda:1')
benign distance is  tensor(5.1471, device='cuda:1')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  3.129533112049103
distance x is tensor(5.9930, device='cuda:1')
benign distance is  tensor(5.9930, device='cuda:1')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  3.4043792337179184
distance x is tensor(4.6295, device='cuda:1')
benign distance is  tensor(4.6295, device='cuda:1')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  3.6893815398216248
distance x is tensor(37.0171, device='cuda:1')
benign distance is  tensor(37.0171, device='cuda:1')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  2.9016809463500977
distance x is tensor(6.5002, device='cuda:1')
benign distance is  tensor(6.5002, device='cuda:1')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  2.8726240396499634
distance x is tensor(5.0497, device='cuda:1')
benign distance is  tensor(5.0497, device='cuda:1')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  2.864949017763138
distance x is tensor(4.2584, device='cuda:1')
benign distance is  tensor(4.2584, device='cuda:1')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  2.68449467420578
distance x is tensor(5.6761, device='cuda:1')
benign distance is  tensor(5.6761, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(4.2019, device='cuda:1')
compute distance is  tensor(4.2019, device='cuda:1')
compute norm is  tensor(82.7243, device='cuda:1', dtype=torch.float64)
distance x is tensor(5.2877, device='cuda:1')
compute distance is  tensor(5.2877, device='cuda:1')
compute norm is  tensor(83.3498, device='cuda:1', dtype=torch.float64)
distance x is tensor(4.8917, device='cuda:1')
compute distance is  tensor(4.8917, device='cuda:1')
compute norm is  tensor(83.1242, device='cuda:1', dtype=torch.float64)
distance x is tensor(5.9150, device='cuda:1')
compute distance is  tensor(5.9150, device='cuda:1')
compute norm is  tensor(83.2546, device='cuda:1', dtype=torch.float64)
distance x is tensor(6.2952, device='cuda:1')
compute distance is  tensor(6.2952, device='cuda:1')
compute norm is  tensor(83.4623, device='cuda:1', dtype=torch.float64)
distance x is tensor(4.6585, device='cuda:1')
compute distance is  tensor(4.6585, device='cuda:1')
compute norm is  tensor(83.4476, device='cuda:1', dtype=torch.float64)
distance x is tensor(25.1577, device='cuda:1')
compute distance is  tensor(25.1577, device='cuda:1')
compute norm is  tensor(83.5365, device='cuda:1', dtype=torch.float64)
distance x is tensor(6.7160, device='cuda:1')
compute distance is  tensor(6.7160, device='cuda:1')
compute norm is  tensor(83.3837, device='cuda:1', dtype=torch.float64)
distance x is tensor(4.7593, device='cuda:1')
compute distance is  tensor(4.7593, device='cuda:1')
compute norm is  tensor(83.2499, device='cuda:1', dtype=torch.float64)
distance x is tensor(20.2951, device='cuda:1')
compute distance is  tensor(20.2951, device='cuda:1')
compute norm is  tensor(83.6317, device='cuda:1', dtype=torch.float64)
distance x is tensor(6.6173, device='cuda:1')
compute distance is  tensor(6.6173, device='cuda:1')
compute norm is  tensor(83.1570, device='cuda:1', dtype=torch.float64)
distance x is tensor(5.2909, device='cuda:1')
compute distance is  tensor(5.2909, device='cuda:1')
compute norm is  tensor(83.2854, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(25.1577, device='cuda:1')
distance x is tensor(102117.6875, device='cuda:1')
distance x is tensor(102117.6875, device='cuda:1')
________________________________
test distance is  tensor(102117.6875, device='cuda:1')
test distance1 is  tensor(102117.6875, device='cuda:1')
test similarity is  tensor(0.2468, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107551208598687.39
test entropy is  0.0
________________________________
cal ratio is  0.015381935648879236
distance x is tensor(1570.7726, device='cuda:1')
cal_distance is  tensor(1570.7726, device='cuda:1')
cal ratio is  0.12402373604325534
distance x is tensor(194.8171, device='cuda:1')
cal_distance is  tensor(194.8171, device='cuda:1')
cal ratio is  0.35216638957899743
distance x is tensor(68.6111, device='cuda:1')
cal_distance is  tensor(68.6111, device='cuda:1')
cal ratio is  0.593422972685631
distance x is tensor(40.7173, device='cuda:1')
cal_distance is  tensor(40.7173, device='cuda:1')
cal ratio is  0.7703211353119758
distance x is tensor(31.3665, device='cuda:1')
cal_distance is  tensor(31.3665, device='cuda:1')
cal ratio is  0.8776638932020069
distance x is tensor(27.5299, device='cuda:1')
cal_distance is  tensor(27.5299, device='cuda:1')
cal ratio is  0.9368269419925164
distance x is tensor(25.7910, device='cuda:1')
cal_distance is  tensor(25.7910, device='cuda:1')
cal ratio is  0.9678923079485037
distance x is tensor(24.9631, device='cuda:1')
cal_distance is  tensor(24.9631, device='cuda:1')
distance x is tensor(24.9631, device='cuda:1')
return_distance is  tensor(24.9631, device='cuda:1')
distance x is tensor(24.9539, device='cuda:1')
distance x is tensor(24.9539, device='cuda:1')
________________________________
test distance is  tensor(24.9539, device='cuda:1')
test distance1 is  tensor(24.9539, device='cuda:1')
test similarity is  tensor(0.9995, device='cuda:1')
test acc is  0.099600000156332
test loss is 2.4851526245633675
test entropy is  2.139843281906551
________________________________
0
distance x is tensor(24.9539, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  2.140051706513362
avg test loss is  2.4851531761287373
avg accuracy is  0.10028333348966534
solo acc is  0.099750000156332
compute similarity  is  tensor(0.9995, device='cuda:1')
compute_distance is  tensor(24.9539, device='cuda:1')
compute_norm is  tensor(83.0031, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(30.8395, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9505206679484484
avg test loss is  3.3243811921015984
avg accuracy is  0.10025000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9987, device='cuda:1')
compute_distance is  tensor(30.8395, device='cuda:1')
compute_norm is  tensor(82.9547, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(34.4221, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.4553517670011216
avg test loss is  2.5563334005473775
avg accuracy is  0.1015833334896653
solo acc is  0.10806666682299862
compute similarity  is  tensor(0.9988, device='cuda:1')
compute_distance is  tensor(34.4221, device='cuda:1')
compute_norm is  tensor(82.4680, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(37.4888, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.822903031797043
avg test loss is  3.266520071131334
avg accuracy is  0.10040000015633198
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.9984, device='cuda:1')
compute_distance is  tensor(37.4888, device='cuda:1')
compute_norm is  tensor(82.2835, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(41.0261, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  1.4125412794064358
avg test loss is  2.4416169535630803
avg accuracy is  0.10166666682299863
solo acc is  0.1121166668229986
compute similarity  is  tensor(0.9986, device='cuda:1')
compute_distance is  tensor(41.0261, device='cuda:1')
compute_norm is  tensor(81.7762, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(44.6808, device='cuda:1')
distance x is tensor(44.6808, device='cuda:1')
________________________________
test distance is  tensor(44.6808, device='cuda:1')
test distance1 is  tensor(44.6808, device='cuda:1')
test similarity is  tensor(0.9981, device='cuda:1')
test acc is  0.10006666682299865
test loss is 3.154881056183691
test entropy is  0.7871259944652443
________________________________
cal ratio is  0.7353614069589992
distance x is tensor(32.8640, device='cuda:1')
cal_distance is  tensor(32.8640, device='cuda:1')
cal ratio is  0.8574353432121098
distance x is tensor(28.1794, device='cuda:1')
cal_distance is  tensor(28.1794, device='cuda:1')
cal ratio is  0.9259679807447541
distance x is tensor(26.0935, device='cuda:1')
cal_distance is  tensor(26.0935, device='cuda:1')
cal ratio is  0.9622663973047716
distance x is tensor(25.1091, device='cuda:1')
cal_distance is  tensor(25.1091, device='cuda:1')
distance x is tensor(25.1091, device='cuda:1')
return_distance is  tensor(25.1091, device='cuda:1')
distance x is tensor(25.1005, device='cuda:1')
distance x is tensor(25.1005, device='cuda:1')
________________________________
test distance is  tensor(25.1005, device='cuda:1')
test distance1 is  tensor(25.1005, device='cuda:1')
test similarity is  tensor(0.9994, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.484157347729974
test entropy is  1.8637757977442955
________________________________
0
distance x is tensor(25.1005, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.8631869870970752
avg test loss is  2.4855732930494523
avg accuracy is  0.10275000015633197
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9994, device='cuda:1')
compute_distance is  tensor(25.1005, device='cuda:1')
compute_norm is  tensor(81.8718, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(30.5623, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8312325625658543
avg test loss is  3.2111922728735753
avg accuracy is  0.10041666682299863
solo acc is  0.10008333348966532
compute similarity  is  tensor(0.9988, device='cuda:1')
compute_distance is  tensor(30.5623, device='cuda:1')
compute_norm is  tensor(81.7556, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(36.1403, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.3574339147569783
avg test loss is  2.3416726079576815
avg accuracy is  0.10171666682299864
solo acc is  0.11555000015633193
compute similarity  is  tensor(0.9988, device='cuda:1')
compute_distance is  tensor(36.1403, device='cuda:1')
compute_norm is  tensor(81.2846, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(40.2913, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.7866367413672303
avg test loss is  3.05063598318649
avg accuracy is  0.1004833334896653
solo acc is  0.10011666682299865
compute similarity  is  tensor(0.9984, device='cuda:1')
compute_distance is  tensor(40.2913, device='cuda:1')
compute_norm is  tensor(81.0668, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(44.9551, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  1.3202468719817937
avg test loss is  2.262237240256531
avg accuracy is  0.10181666682299864
solo acc is  0.11745000015633192
compute similarity  is  tensor(0.9985, device='cuda:1')
compute_distance is  tensor(44.9551, device='cuda:1')
compute_norm is  tensor(80.6200, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(48.9379, device='cuda:1')
distance x is tensor(48.9379, device='cuda:1')
________________________________
test distance is  tensor(48.9379, device='cuda:1')
test distance1 is  tensor(48.9379, device='cuda:1')
test similarity is  tensor(0.9981, device='cuda:1')
test acc is  0.10015000015633198
test loss is 2.9691890206164135
test entropy is  0.7809601987221602
________________________________
cal ratio is  0.7026493196185944
distance x is tensor(34.3908, device='cuda:1')
cal_distance is  tensor(34.3908, device='cuda:1')
cal ratio is  0.8381860590461495
distance x is tensor(28.8263, device='cuda:1')
cal_distance is  tensor(28.8263, device='cuda:1')
cal ratio is  0.9155180733905656
distance x is tensor(26.3912, device='cuda:1')
cal_distance is  tensor(26.3912, device='cuda:1')
cal ratio is  0.9568229534064788
distance x is tensor(25.2519, device='cuda:1')
cal_distance is  tensor(25.2519, device='cuda:1')
cal ratio is  0.9781710903777033
distance x is tensor(24.7007, device='cuda:1')
cal_distance is  tensor(24.7007, device='cuda:1')
distance x is tensor(24.7007, device='cuda:1')
return_distance is  tensor(24.7007, device='cuda:1')
distance x is tensor(24.6953, device='cuda:1')
distance x is tensor(24.6953, device='cuda:1')
________________________________
test distance is  tensor(24.6953, device='cuda:1')
test distance1 is  tensor(24.6953, device='cuda:1')
test similarity is  tensor(0.9995, device='cuda:1')
test acc is  0.10008333348966532
test loss is 2.4228694853243797
test entropy is  1.9610004339899336
________________________________
0
distance x is tensor(24.6953, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.9613566307116672
avg test loss is  2.4226557354428877
avg accuracy is  0.1032833334896653
solo acc is  0.10005000015633199
compute similarity  is  tensor(0.9995, device='cuda:1')
compute_distance is  tensor(24.6953, device='cuda:1')
compute_norm is  tensor(81.3215, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(31.4854, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8098357126021436
avg test loss is  3.1293149645140432
avg accuracy is  0.10045000015633197
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9988, device='cuda:1')
compute_distance is  tensor(31.4854, device='cuda:1')
compute_norm is  tensor(81.2034, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(37.8910, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.3317566916886678
avg test loss is  2.279779571332911
avg accuracy is  0.10151666682299863
solo acc is  0.1134166668229986
compute similarity  is  tensor(0.9987, device='cuda:1')
compute_distance is  tensor(37.8910, device='cuda:1')
compute_norm is  tensor(80.7665, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(42.3315, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.7861782043600387
avg test loss is  2.98072340112251
avg accuracy is  0.10061666682299863
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9984, device='cuda:1')
compute_distance is  tensor(42.3315, device='cuda:1')
compute_norm is  tensor(80.5451, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(48.0854, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  1.310102414983168
avg test loss is  2.1888678617823096
avg accuracy is  0.1023833334896653
solo acc is  0.12270000015633192
compute similarity  is  tensor(0.9983, device='cuda:1')
compute_distance is  tensor(48.0854, device='cuda:1')
compute_norm is  tensor(80.1174, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(52.4958, device='cuda:1')
________________________________
test distance is  tensor(52.4958, device='cuda:1')
test similarity is  tensor(0.9979, device='cuda:1')
test acc is  0.1010333334896653
test loss is 2.90332388420349
test entropy is  0.7644404455034464
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 2.9057675153017044
mal norm is  tensor(279.3234, device='cuda:1')
distance x is tensor(52.4958, device='cuda:1')
mal distance is  tensor(52.4958, device='cuda:1')
user_PLR len size 28
counter_tensor is  tensor([27., 26., 26., 24., 25., 21., 23., 24., 16., 16., 16., 16., 16., 16.,
        16., 16., 16., 16., 16., 16., 26., 24., 13., 26., 26., 23., 23., 26.])
count_res tensor([2.8172e-01, 1.0364e-01, 1.0364e-01, 1.4026e-02, 3.8127e-02, 6.9832e-04,
        5.1599e-03, 1.4026e-02, 4.7052e-06, 4.7052e-06, 4.7052e-06, 4.7052e-06,
        4.7052e-06, 4.7052e-06, 4.7052e-06, 4.7052e-06, 4.7052e-06, 4.7052e-06,
        4.7052e-06, 4.7052e-06, 1.0364e-01, 1.4026e-02, 2.3426e-07, 1.0364e-01,
        1.0364e-01, 5.1599e-03, 5.1599e-03, 1.0364e-01])
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.695317655801773
distance x is tensor(4.3363, device='cuda:1')
benign distance is  tensor(4.3363, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.4568697959184647
distance x is tensor(4.2825, device='cuda:1')
benign distance is  tensor(4.2825, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.446793869137764
distance x is tensor(4.6211, device='cuda:1')
benign distance is  tensor(4.6211, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.2242963165044785
distance x is tensor(6.0068, device='cuda:1')
benign distance is  tensor(6.0068, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.1908077001571655
distance x is tensor(6.4050, device='cuda:1')
benign distance is  tensor(6.4050, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.7892812341451645
distance x is tensor(3.3746, device='cuda:1')
benign distance is  tensor(3.3746, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.222726747393608
distance x is tensor(5.1403, device='cuda:1')
benign distance is  tensor(5.1403, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.9786197543144226
distance x is tensor(3.9951, device='cuda:1')
benign distance is  tensor(3.9951, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  3.265851855278015
distance x is tensor(5.4642, device='cuda:1')
benign distance is  tensor(5.4642, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.9304378926754
distance x is tensor(5.9176, device='cuda:1')
benign distance is  tensor(5.9176, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  3.39343298971653
distance x is tensor(5.3547, device='cuda:1')
benign distance is  tensor(5.3547, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.5642372518777847
distance x is tensor(6.6258, device='cuda:1')
benign distance is  tensor(6.6258, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  3.1976551562547684
distance x is tensor(6.8119, device='cuda:1')
benign distance is  tensor(6.8119, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.697155714035034
distance x is tensor(3.3058, device='cuda:1')
benign distance is  tensor(3.3058, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.732586920261383
distance x is tensor(4.9042, device='cuda:1')
benign distance is  tensor(4.9042, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.562481164932251
distance x is tensor(6.8061, device='cuda:1')
benign distance is  tensor(6.8061, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(4.9457, device='cuda:1')
compute distance is  tensor(4.9457, device='cuda:1')
compute norm is  tensor(82.7787, device='cuda:1', dtype=torch.float64)
distance x is tensor(4.8976, device='cuda:1')
compute distance is  tensor(4.8976, device='cuda:1')
compute norm is  tensor(83.3290, device='cuda:1', dtype=torch.float64)
distance x is tensor(4.9098, device='cuda:1')
compute distance is  tensor(4.9098, device='cuda:1')
compute norm is  tensor(83.1303, device='cuda:1', dtype=torch.float64)
distance x is tensor(5.3663, device='cuda:1')
compute distance is  tensor(5.3663, device='cuda:1')
compute norm is  tensor(83.3077, device='cuda:1', dtype=torch.float64)
distance x is tensor(5.6805, device='cuda:1')
compute distance is  tensor(5.6805, device='cuda:1')
compute norm is  tensor(83.5015, device='cuda:1', dtype=torch.float64)
distance x is tensor(4.4282, device='cuda:1')
compute distance is  tensor(4.4282, device='cuda:1')
compute norm is  tensor(83.4344, device='cuda:1', dtype=torch.float64)
distance x is tensor(24.4886, device='cuda:1')
compute distance is  tensor(24.4886, device='cuda:1')
compute norm is  tensor(83.5771, device='cuda:1', dtype=torch.float64)
distance x is tensor(6.8643, device='cuda:1')
compute distance is  tensor(6.8643, device='cuda:1')
compute norm is  tensor(83.3874, device='cuda:1', dtype=torch.float64)
distance x is tensor(4.1658, device='cuda:1')
compute distance is  tensor(4.1658, device='cuda:1')
compute norm is  tensor(83.2000, device='cuda:1', dtype=torch.float64)
distance x is tensor(72.0394, device='cuda:1')
compute distance is  tensor(72.0394, device='cuda:1')
compute norm is  tensor(86.9608, device='cuda:1', dtype=torch.float64)
distance x is tensor(6.0636, device='cuda:1')
compute distance is  tensor(6.0636, device='cuda:1')
compute norm is  tensor(83.1527, device='cuda:1', dtype=torch.float64)
distance x is tensor(5.1881, device='cuda:1')
compute distance is  tensor(5.1881, device='cuda:1')
compute norm is  tensor(83.3034, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(72.0394, device='cuda:1')
distance x is tensor(102117.6719, device='cuda:1')
distance x is tensor(102117.6719, device='cuda:1')
________________________________
test distance is  tensor(102117.6719, device='cuda:1')
test distance1 is  tensor(102117.6719, device='cuda:1')
test similarity is  tensor(0.2468, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107570326325750.17
test entropy is  0.0
________________________________
cal ratio is  0.026029191992904696
distance x is tensor(2658.0457, device='cuda:1')
cal_distance is  tensor(2658.0457, device='cuda:1')
cal ratio is  0.16133549211135897
distance x is tensor(428.8409, device='cuda:1')
cal_distance is  tensor(428.8409, device='cuda:1')
cal ratio is  0.40166411372896293
distance x is tensor(172.2528, device='cuda:1')
cal_distance is  tensor(172.2528, device='cuda:1')
cal ratio is  0.6337646583596216
distance x is tensor(109.1694, device='cuda:1')
cal_distance is  tensor(109.1694, device='cuda:1')
cal ratio is  0.7960871111711856
distance x is tensor(86.9093, device='cuda:1')
cal_distance is  tensor(86.9093, device='cuda:1')
cal ratio is  0.8922321940649709
distance x is tensor(77.5438, device='cuda:1')
cal_distance is  tensor(77.5438, device='cuda:1')
cal ratio is  0.9445774202003264
distance x is tensor(73.2464, device='cuda:1')
cal_distance is  tensor(73.2464, device='cuda:1')
cal ratio is  0.9718919752791142
distance x is tensor(71.1877, device='cuda:1')
cal_distance is  tensor(71.1877, device='cuda:1')
distance x is tensor(71.1877, device='cuda:1')
return_distance is  tensor(71.1877, device='cuda:1')
distance x is tensor(71.1786, device='cuda:1')
distance x is tensor(71.1786, device='cuda:1')
________________________________
test distance is  tensor(71.1786, device='cuda:1')
test distance1 is  tensor(71.1786, device='cuda:1')
test similarity is  tensor(0.9961, device='cuda:1')
test acc is  0.10065000015633198
test loss is 2.5185674850874618
test entropy is  2.080154278639283
________________________________
0
distance x is tensor(71.1786, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  2.0800497564933957
avg test loss is  2.5178207410678173
avg accuracy is  0.10173333348966532
solo acc is  0.10058333348966532
compute similarity  is  tensor(0.9961, device='cuda:1')
compute_distance is  tensor(71.1786, device='cuda:1')
compute_norm is  tensor(84.1221, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(76.4340, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9380830846615692
avg test loss is  3.3759765617374673
avg accuracy is  0.10020000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9953, device='cuda:1')
compute_distance is  tensor(76.4340, device='cuda:1')
compute_norm is  tensor(84.0100, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(79.2618, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.4259560423365025
avg test loss is  2.598500227368971
avg accuracy is  0.10125000015633197
solo acc is  0.10818333348966529
compute similarity  is  tensor(0.9954, device='cuda:1')
compute_distance is  tensor(79.2618, device='cuda:1')
compute_norm is  tensor(83.4979, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(81.3503, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8170902290578081
avg test loss is  3.276612759653185
avg accuracy is  0.1004833334896653
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9950, device='cuda:1')
compute_distance is  tensor(81.3503, device='cuda:1')
compute_norm is  tensor(83.3011, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(83.8503, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  1.4103344666169906
avg test loss is  2.4406220313074236
avg accuracy is  0.10220000015633197
solo acc is  0.11161666682299862
compute similarity  is  tensor(0.9951, device='cuda:1')
compute_distance is  tensor(83.8503, device='cuda:1')
compute_norm is  tensor(82.7932, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(86.1868, device='cuda:1')
distance x is tensor(86.1868, device='cuda:1')
________________________________
test distance is  tensor(86.1868, device='cuda:1')
test distance1 is  tensor(86.1868, device='cuda:1')
test similarity is  tensor(0.9947, device='cuda:1')
test acc is  0.10010000015633198
test loss is 3.1682819613515694
test entropy is  0.8001980873694552
________________________________
cal ratio is  0.8959644449823844
distance x is tensor(77.2293, device='cuda:1')
cal_distance is  tensor(77.2293, device='cuda:1')
cal ratio is  0.9464986142588172
distance x is tensor(73.0977, device='cuda:1')
cal_distance is  tensor(73.0977, device='cuda:1')
cal ratio is  0.9728797834799039
distance x is tensor(71.1154, device='cuda:1')
cal_distance is  tensor(71.1154, device='cuda:1')
distance x is tensor(71.1154, device='cuda:1')
return_distance is  tensor(71.1154, device='cuda:1')
distance x is tensor(71.1059, device='cuda:1')
distance x is tensor(71.1059, device='cuda:1')
________________________________
test distance is  tensor(71.1059, device='cuda:1')
test distance1 is  tensor(71.1059, device='cuda:1')
test similarity is  tensor(0.9964, device='cuda:1')
test acc is  0.10005000015633199
test loss is 2.8121516277540977
test entropy is  1.2149995295986185
________________________________
0
distance x is tensor(71.1059, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.2146414043044231
avg test loss is  2.8113951118770184
avg accuracy is  0.1012333334896653
solo acc is  0.10011666682299865
compute similarity  is  tensor(0.9964, device='cuda:1')
compute_distance is  tensor(71.1059, device='cuda:1')
compute_norm is  tensor(82.5048, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(73.9577, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.7941357494671462
avg test loss is  3.1930412737799605
avg accuracy is  0.10071666682299864
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9961, device='cuda:1')
compute_distance is  tensor(73.9577, device='cuda:1')
compute_norm is  tensor(82.2561, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(77.0168, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.3497530230835302
avg test loss is  2.353755091426215
avg accuracy is  0.1017333334896653
solo acc is  0.12058333348966525
compute similarity  is  tensor(0.9962, device='cuda:1')
compute_distance is  tensor(77.0168, device='cuda:1')
compute_norm is  tensor(81.7613, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(79.8414, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.7816008598184281
avg test loss is  3.054002452760871
avg accuracy is  0.10081666682299864
solo acc is  0.10020000015633197
compute similarity  is  tensor(0.9958, device='cuda:1')
compute_distance is  tensor(79.8414, device='cuda:1')
compute_norm is  tensor(81.5413, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(83.0738, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  1.3189297580261474
avg test loss is  2.2555580976675316
avg accuracy is  0.10156666682299864
solo acc is  0.11623333348966527
compute similarity  is  tensor(0.9958, device='cuda:1')
compute_distance is  tensor(83.0738, device='cuda:1')
compute_norm is  tensor(81.0842, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(85.8953, device='cuda:1')
distance x is tensor(85.8953, device='cuda:1')
________________________________
test distance is  tensor(85.8953, device='cuda:1')
test distance1 is  tensor(85.8953, device='cuda:1')
test similarity is  tensor(0.9954, device='cuda:1')
test acc is  0.10015000015633198
test loss is 2.983480001817634
test entropy is  0.7680543973755989
________________________________
cal ratio is  0.8974834180670836
distance x is tensor(77.0982, device='cuda:1')
cal_distance is  tensor(77.0982, device='cuda:1')
cal ratio is  0.947303473440475
distance x is tensor(73.0356, device='cuda:1')
cal_distance is  tensor(73.0356, device='cuda:1')
cal ratio is  0.9732935764342401
distance x is tensor(71.0852, device='cuda:1')
cal_distance is  tensor(71.0852, device='cuda:1')
distance x is tensor(71.0852, device='cuda:1')
return_distance is  tensor(71.0852, device='cuda:1')
distance x is tensor(71.0762, device='cuda:1')
distance x is tensor(71.0762, device='cuda:1')
________________________________
test distance is  tensor(71.0762, device='cuda:1')
test distance1 is  tensor(71.0762, device='cuda:1')
test similarity is  tensor(0.9969, device='cuda:1')
test acc is  0.10016666682299866
test loss is 2.6026066556922407
test entropy is  1.2555024510761823
________________________________
0
distance x is tensor(71.0762, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.2558478146219558
avg test loss is  2.601760670066134
avg accuracy is  0.1009333334896653
solo acc is  0.10018333348966531
compute similarity  is  tensor(0.9969, device='cuda:1')
compute_distance is  tensor(71.0762, device='cuda:1')
compute_norm is  tensor(81.0675, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(74.5729, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.766840517266727
avg test loss is  3.01941485623561
avg accuracy is  0.10061666682299863
solo acc is  0.10011666682299865
compute similarity  is  tensor(0.9965, device='cuda:1')
compute_distance is  tensor(74.5729, device='cuda:1')
compute_norm is  tensor(80.8156, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(78.1885, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.3089636496897699
avg test loss is  2.2387049428181354
avg accuracy is  0.1016833334896653
solo acc is  0.11453333348966527
compute similarity  is  tensor(0.9965, device='cuda:1')
compute_distance is  tensor(78.1885, device='cuda:1')
compute_norm is  tensor(80.3652, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(81.2017, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.7617014193458598
avg test loss is  2.9589332199808376
avg accuracy is  0.10065000015633196
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9961, device='cuda:1')
compute_distance is  tensor(81.2017, device='cuda:1')
compute_norm is  tensor(80.1374, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(84.5653, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  1.2852323674189765
avg test loss is  2.2025473553742936
avg accuracy is  0.1016333334896653
solo acc is  0.11538333348966527
compute similarity  is  tensor(0.9962, device='cuda:1')
compute_distance is  tensor(84.5653, device='cuda:1')
compute_norm is  tensor(79.6949, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(87.5974, device='cuda:1')
________________________________
test distance is  tensor(87.5974, device='cuda:1')
test similarity is  tensor(0.9958, device='cuda:1')
test acc is  0.10090000015633196
test loss is 2.9290653769649677
test entropy is  0.751637392524463
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 2.9260485619306564
mal norm is  tensor(371.3805, device='cuda:1')
distance x is tensor(87.5974, device='cuda:1')
mal distance is  tensor(87.5974, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([19., 19., 19., 17., 18., 15., 17., 18., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([0.0273, 0.0273, 0.0273, 0.0037, 0.0100, 0.0005, 0.0037, 0.0100, 0.0742,
        0.0742, 0.0742, 0.0742, 0.0742, 0.0742, 0.0742, 0.0742, 0.0742, 0.0742,
        0.0742, 0.0742])
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.6912327259778976
distance x is tensor(53.5187, device='cuda:1')
benign distance is  tensor(53.5187, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.543633818626404
distance x is tensor(199.6407, device='cuda:1')
benign distance is  tensor(199.6407, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.4993586391210556
distance x is tensor(21.7910, device='cuda:1')
benign distance is  tensor(21.7910, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.1265649497509003
distance x is tensor(34.0239, device='cuda:1')
benign distance is  tensor(34.0239, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.345750242471695
distance x is tensor(62.9081, device='cuda:1')
benign distance is  tensor(62.9081, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.728674218058586
distance x is tensor(109.6365, device='cuda:1')
benign distance is  tensor(109.6365, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.117104321718216
distance x is tensor(145.8675, device='cuda:1')
benign distance is  tensor(145.8675, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.984214410185814
distance x is tensor(50.3936, device='cuda:1')
benign distance is  tensor(50.3936, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(34.7649, device='cuda:1')
compute distance is  tensor(34.7649, device='cuda:1')
compute norm is  tensor(79.7360, device='cuda:1', dtype=torch.float64)
distance x is tensor(83.9257, device='cuda:1')
compute distance is  tensor(83.9257, device='cuda:1')
compute norm is  tensor(82.5889, device='cuda:1', dtype=torch.float64)
distance x is tensor(15.1890, device='cuda:1')
compute distance is  tensor(15.1890, device='cuda:1')
compute norm is  tensor(79.9598, device='cuda:1', dtype=torch.float64)
distance x is tensor(35.5283, device='cuda:1')
compute distance is  tensor(35.5283, device='cuda:1')
compute norm is  tensor(80.1932, device='cuda:1', dtype=torch.float64)
distance x is tensor(10.9725, device='cuda:1')
compute distance is  tensor(10.9725, device='cuda:1')
compute norm is  tensor(80.2317, device='cuda:1', dtype=torch.float64)
distance x is tensor(21.3762, device='cuda:1')
compute distance is  tensor(21.3762, device='cuda:1')
compute norm is  tensor(80.1357, device='cuda:1', dtype=torch.float64)
distance x is tensor(18.0170, device='cuda:1')
compute distance is  tensor(18.0170, device='cuda:1')
compute norm is  tensor(80.0309, device='cuda:1', dtype=torch.float64)
distance x is tensor(27.1922, device='cuda:1')
compute distance is  tensor(27.1922, device='cuda:1')
compute norm is  tensor(80.2407, device='cuda:1', dtype=torch.float64)
distance x is tensor(49.7074, device='cuda:1')
compute distance is  tensor(49.7074, device='cuda:1')
compute norm is  tensor(80.4892, device='cuda:1', dtype=torch.float64)
distance x is tensor(34.4067, device='cuda:1')
compute distance is  tensor(34.4067, device='cuda:1')
compute norm is  tensor(80.4408, device='cuda:1', dtype=torch.float64)
distance x is tensor(40.9566, device='cuda:1')
compute distance is  tensor(40.9566, device='cuda:1')
compute norm is  tensor(80.4594, device='cuda:1', dtype=torch.float64)
distance x is tensor(62.0550, device='cuda:1')
compute distance is  tensor(62.0550, device='cuda:1')
compute norm is  tensor(81.4702, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(83.9257, device='cuda:1')
distance x is tensor(102064.8750, device='cuda:1')
distance x is tensor(102064.8750, device='cuda:1')
________________________________
test distance is  tensor(102064.8750, device='cuda:1')
test distance1 is  tensor(102064.8750, device='cuda:1')
test similarity is  tensor(0.2968, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107525637921505.98
test entropy is  0.0
________________________________
cal ratio is  0.028101873915160818
distance x is tensor(2868.2192, device='cuda:1')
cal_distance is  tensor(2868.2192, device='cuda:1')
cal ratio is  0.16763598888922338
distance x is tensor(480.8206, device='cuda:1')
cal_distance is  tensor(480.8206, device='cuda:1')
cal ratio is  0.4094321293461892
distance x is tensor(196.8661, device='cuda:1')
cal_distance is  tensor(196.8661, device='cuda:1')
cal ratio is  0.6398643903093038
distance x is tensor(125.9693, device='cuda:1')
cal_distance is  tensor(125.9693, device='cuda:1')
cal ratio is  0.7999098970515087
distance x is tensor(100.7650, device='cuda:1')
cal_distance is  tensor(100.7650, device='cuda:1')
cal ratio is  0.8943727456336996
distance x is tensor(90.1220, device='cuda:1')
cal_distance is  tensor(90.1220, device='cuda:1')
cal ratio is  0.9457101700972185
distance x is tensor(85.2295, device='cuda:1')
cal_distance is  tensor(85.2295, device='cuda:1')
cal ratio is  0.9724749090689259
distance x is tensor(82.8837, device='cuda:1')
cal_distance is  tensor(82.8837, device='cuda:1')
distance x is tensor(82.8837, device='cuda:1')
return_distance is  tensor(82.8837, device='cuda:1')
distance x is tensor(82.8746, device='cuda:1')
distance x is tensor(82.8746, device='cuda:1')
________________________________
test distance is  tensor(82.8746, device='cuda:1')
test distance1 is  tensor(82.8746, device='cuda:1')
test similarity is  tensor(0.9946, device='cuda:1')
test acc is  0.10000000015633198
test loss is 15.837949514897394
test entropy is  0.4079567472627168
________________________________
0
distance x is tensor(82.8746, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.4051175855560852
avg test loss is  15.865144057568711
avg accuracy is  0.10006666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9946, device='cuda:1')
compute_distance is  tensor(82.8746, device='cuda:1')
compute_norm is  tensor(81.7910, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(88.3568, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.5423458392686173
avg test loss is  2.872071674637703
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9939, device='cuda:1')
compute_distance is  tensor(88.3568, device='cuda:1')
compute_norm is  tensor(81.1386, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(89.3708, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8547022533950521
avg test loss is  3.529743566950247
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9939, device='cuda:1')
compute_distance is  tensor(89.3708, device='cuda:1')
compute_norm is  tensor(80.9724, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(92.7697, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.487399330652599
avg test loss is  2.6541971319011535
avg accuracy is  0.10000000015633198
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9936, device='cuda:1')
compute_distance is  tensor(92.7697, device='cuda:1')
compute_norm is  tensor(80.3931, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(93.9818, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8352367937056495
avg test loss is  3.3421586990864802
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9936, device='cuda:1')
compute_distance is  tensor(93.9818, device='cuda:1')
compute_norm is  tensor(80.2236, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(97.1397, device='cuda:1')
distance x is tensor(97.1397, device='cuda:1')
________________________________
test distance is  tensor(97.1397, device='cuda:1')
test distance1 is  tensor(97.1397, device='cuda:1')
test similarity is  tensor(0.9934, device='cuda:1')
test acc is  0.10006666682299865
test loss is 2.542832253838399
test entropy is  1.4614702283954824
________________________________
cal ratio is  0.9109093558018927
distance x is tensor(88.4944, device='cuda:1')
cal_distance is  tensor(88.4944, device='cuda:1')
cal ratio is  0.9543675344808455
distance x is tensor(84.4564, device='cuda:1')
cal_distance is  tensor(84.4564, device='cuda:1')
cal ratio is  0.9769160760186629
distance x is tensor(82.5069, device='cuda:1')
cal_distance is  tensor(82.5069, device='cuda:1')
distance x is tensor(82.5069, device='cuda:1')
return_distance is  tensor(82.5069, device='cuda:1')
distance x is tensor(82.4975, device='cuda:1')
distance x is tensor(82.4975, device='cuda:1')
________________________________
test distance is  tensor(82.4975, device='cuda:1')
test distance1 is  tensor(82.4975, device='cuda:1')
test similarity is  tensor(0.9952, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.7560985355234857
test entropy is  1.3992940027322343
________________________________
0
distance x is tensor(82.4975, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.3997233365136168
avg test loss is  2.7580651296481395
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9952, device='cuda:1')
compute_distance is  tensor(82.4975, device='cuda:1')
compute_norm is  tensor(79.6422, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(84.7209, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8104587169344237
avg test loss is  3.264080713298529
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9951, device='cuda:1')
compute_distance is  tensor(84.7209, device='cuda:1')
compute_norm is  tensor(79.4557, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(89.7961, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.3885531374640556
avg test loss is  2.3262385344708654
avg accuracy is  0.10010000015633198
solo acc is  0.10035000015633197
compute similarity  is  tensor(0.9947, device='cuda:1')
compute_distance is  tensor(89.7961, device='cuda:1')
compute_norm is  tensor(78.9790, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(91.8355, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.7855667936395226
avg test loss is  3.0148268533922207
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9947, device='cuda:1')
compute_distance is  tensor(91.8355, device='cuda:1')
compute_norm is  tensor(78.7816, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(96.4786, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  1.325359678344686
avg test loss is  2.15870049945327
avg accuracy is  0.10015000015633198
solo acc is  0.11756666682299859
compute similarity  is  tensor(0.9943, device='cuda:1')
compute_distance is  tensor(96.4786, device='cuda:1')
compute_norm is  tensor(78.3760, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(98.3985, device='cuda:1')
distance x is tensor(98.3985, device='cuda:1')
________________________________
test distance is  tensor(98.3985, device='cuda:1')
test distance1 is  tensor(98.3985, device='cuda:1')
test similarity is  tensor(0.9943, device='cuda:1')
test acc is  0.10031666682299864
test loss is 2.8789039212249237
test entropy is  0.7293866982719283
________________________________
cal ratio is  0.9050639521938381
distance x is tensor(89.0654, device='cuda:1')
cal_distance is  tensor(89.0654, device='cuda:1')
cal ratio is  0.951303173551536
distance x is tensor(84.7284, device='cuda:1')
cal_distance is  tensor(84.7284, device='cuda:1')
cal ratio is  0.9753464090624483
distance x is tensor(82.6397, device='cuda:1')
cal_distance is  tensor(82.6397, device='cuda:1')
distance x is tensor(82.6397, device='cuda:1')
return_distance is  tensor(82.6397, device='cuda:1')
distance x is tensor(82.6308, device='cuda:1')
distance x is tensor(82.6308, device='cuda:1')
________________________________
test distance is  tensor(82.6308, device='cuda:1')
test distance1 is  tensor(82.6308, device='cuda:1')
test similarity is  tensor(0.9960, device='cuda:1')
test acc is  0.10000000015633198
test loss is 3.015782063195446
test entropy is  0.9459721957569691
________________________________
0
distance x is tensor(82.6308, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.9459663836051152
avg test loss is  3.016966505345505
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9960, device='cuda:1')
compute_distance is  tensor(82.6308, device='cuda:1')
compute_norm is  tensor(78.3433, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(87.9178, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.2091458139897409
avg test loss is  2.076578806839518
avg accuracy is  0.10040000015633196
solo acc is  0.13496666682299857
compute similarity  is  tensor(0.9955, device='cuda:1')
compute_distance is  tensor(87.9178, device='cuda:1')
compute_norm is  tensor(77.9447, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(90.0546, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.7145833188791011
avg test loss is  2.8107374337182116
avg accuracy is  0.10001666682299865
solo acc is  0.10023333348966532
compute similarity  is  tensor(0.9955, device='cuda:1')
compute_distance is  tensor(90.0546, device='cuda:1')
compute_norm is  tensor(77.6945, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(94.0626, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.149758856052529
avg test loss is  2.0063613279541928
avg accuracy is  0.10065000015633198
solo acc is  0.13561666682299856
compute similarity  is  tensor(0.9951, device='cuda:1')
compute_distance is  tensor(94.0626, device='cuda:1')
compute_norm is  tensor(77.2902, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(96.3328, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.6915662644514396
avg test loss is  2.733372122239965
avg accuracy is  0.10008333348966532
solo acc is  0.10033333348966532
compute similarity  is  tensor(0.9951, device='cuda:1')
compute_distance is  tensor(96.3328, device='cuda:1')
compute_norm is  tensor(77.0339, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(100.1447, device='cuda:1')
________________________________
test distance is  tensor(100.1447, device='cuda:1')
test similarity is  tensor(0.9948, device='cuda:1')
test acc is  0.10035000015633198
test loss is 1.9088656676095177
test entropy is  1.1547113321483262
________________________________
final entropy
distance x is tensor(100.1367, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.1562246872163784
avg test loss is  1.9071592349233404
avg accuracy is  0.10058333348966532
solo acc is  0.14420000015633266
compute similarity  is  tensor(0.9948, device='cuda:1')
compute_distance is  tensor(100.1367, device='cuda:1')
compute_norm is  tensor(76.6390, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 2.6455064564943314
mal norm is  tensor(394.3201, device='cuda:1')
distance x is tensor(102.4135, device='cuda:1')
mal distance is  tensor(102.4135, device='cuda:1')
user_PLR len size 52
counter_tensor is  tensor([48., 42., 40., 37., 42., 30., 39., 43., 26., 26., 26., 26., 26., 26.,
        26., 26., 26., 26., 26., 26.,  0.,  1.,  0.,  3.,  3.,  2.,  0.,  3.,
        44., 41., 37., 43., 36., 40., 47., 28., 30., 27., 47., 40., 37., 33.,
        39., 26., 44., 30., 39., 46., 36., 37., 29., 46.])
count_res tensor([4.8453e-01, 1.2010e-03, 1.6254e-04, 8.0924e-06, 1.2010e-03, 7.3794e-09,
        5.9796e-05, 3.2647e-03, 1.3516e-10, 1.3516e-10, 1.3516e-10, 1.3516e-10,
        1.3516e-10, 1.3516e-10, 1.3516e-10, 1.3516e-10, 1.3516e-10, 1.3516e-10,
        1.3516e-10, 1.3516e-10, 6.9053e-22, 1.8771e-21, 6.9053e-22, 1.3870e-20,
        1.3870e-20, 5.1024e-21, 6.9053e-22, 1.3870e-20, 8.8744e-03, 4.4183e-04,
        8.0924e-06, 3.2647e-03, 2.9770e-06, 1.6254e-04, 1.7825e-01, 9.9869e-10,
        7.3794e-09, 3.6740e-10, 1.7825e-01, 1.6254e-04, 8.0924e-06, 1.4822e-07,
        5.9796e-05, 1.3516e-10, 8.8744e-03, 7.3794e-09, 5.9796e-05, 6.5574e-02,
        2.9770e-06, 8.0924e-06, 2.7147e-09, 6.5574e-02])
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.8627439439296722
distance x is tensor(4.1300, device='cuda:1')
benign distance is  tensor(4.1300, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.3265479654073715
distance x is tensor(6.2816, device='cuda:1')
benign distance is  tensor(6.2816, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.3611686527729034
distance x is tensor(7.0273, device='cuda:1')
benign distance is  tensor(7.0273, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.1310277730226517
distance x is tensor(6.9834, device='cuda:1')
benign distance is  tensor(6.9834, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.2356676906347275
distance x is tensor(7.3761, device='cuda:1')
benign distance is  tensor(7.3761, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.7209080308675766
distance x is tensor(4.0495, device='cuda:1')
benign distance is  tensor(4.0495, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.132479041814804
distance x is tensor(6.1159, device='cuda:1')
benign distance is  tensor(6.1159, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.9601276367902756
distance x is tensor(4.8359, device='cuda:1')
benign distance is  tensor(4.8359, device='cuda:1')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  3.055135950446129
distance x is tensor(5.5605, device='cuda:1')
benign distance is  tensor(5.5605, device='cuda:1')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.8849839866161346
distance x is tensor(6.1315, device='cuda:1')
benign distance is  tensor(6.1315, device='cuda:1')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  3.3116200864315033
distance x is tensor(6.2669, device='cuda:1')
benign distance is  tensor(6.2669, device='cuda:1')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  3.6136414855718613
distance x is tensor(6.9406, device='cuda:1')
benign distance is  tensor(6.9406, device='cuda:1')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  3.2500260323286057
distance x is tensor(8.1215, device='cuda:1')
benign distance is  tensor(8.1215, device='cuda:1')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.698926866054535
distance x is tensor(3.6736, device='cuda:1')
benign distance is  tensor(3.6736, device='cuda:1')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.7095604240894318
distance x is tensor(5.1602, device='cuda:1')
benign distance is  tensor(5.1602, device='cuda:1')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  3.551211357116699
distance x is tensor(7.2035, device='cuda:1')
benign distance is  tensor(7.2035, device='cuda:1')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  3.3213726729154587
distance x is tensor(6.0804, device='cuda:1')
benign distance is  tensor(6.0804, device='cuda:1')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  3.0981225073337555
distance x is tensor(4.5361, device='cuda:1')
benign distance is  tensor(4.5361, device='cuda:1')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  3.3206558227539062
distance x is tensor(6.6591, device='cuda:1')
benign distance is  tensor(6.6591, device='cuda:1')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  3.079341173171997
distance x is tensor(7.5178, device='cuda:1')
benign distance is  tensor(7.5178, device='cuda:1')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  3.0062909722328186
distance x is tensor(5.6510, device='cuda:1')
benign distance is  tensor(5.6510, device='cuda:1')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  2.8449762612581253
distance x is tensor(6.8080, device='cuda:1')
benign distance is  tensor(6.8080, device='cuda:1')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  3.022527039051056
distance x is tensor(8.1867, device='cuda:1')
benign distance is  tensor(8.1867, device='cuda:1')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  2.774906247854233
distance x is tensor(5.9801, device='cuda:1')
benign distance is  tensor(5.9801, device='cuda:1')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.9494390040636063
distance x is tensor(6.4209, device='cuda:1')
benign distance is  tensor(6.4209, device='cuda:1')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  2.664688065648079
distance x is tensor(4.7612, device='cuda:1')
benign distance is  tensor(4.7612, device='cuda:1')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  3.1963242441415787
distance x is tensor(6.4601, device='cuda:1')
benign distance is  tensor(6.4601, device='cuda:1')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  3.630707561969757
distance x is tensor(7.4154, device='cuda:1')
benign distance is  tensor(7.4154, device='cuda:1')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  2.8139957189559937
distance x is tensor(6.6464, device='cuda:1')
benign distance is  tensor(6.6464, device='cuda:1')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  3.075553074479103
distance x is tensor(7.4677, device='cuda:1')
benign distance is  tensor(7.4677, device='cuda:1')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  2.5863583832979202
distance x is tensor(4.6128, device='cuda:1')
benign distance is  tensor(4.6128, device='cuda:1')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  3.3614079654216766
distance x is tensor(7.5035, device='cuda:1')
benign distance is  tensor(7.5035, device='cuda:1')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  3.7522723376750946
distance x is tensor(8.1202, device='cuda:1')
benign distance is  tensor(8.1202, device='cuda:1')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  3.557200312614441
distance x is tensor(7.4316, device='cuda:1')
benign distance is  tensor(7.4316, device='cuda:1')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  2.9040927588939667
distance x is tensor(6.2481, device='cuda:1')
benign distance is  tensor(6.2481, device='cuda:1')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  3.1241451650857925
distance x is tensor(6.9047, device='cuda:1')
benign distance is  tensor(6.9047, device='cuda:1')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  2.6816472113132477
distance x is tensor(4.9580, device='cuda:1')
benign distance is  tensor(4.9580, device='cuda:1')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  3.298370346426964
distance x is tensor(8.0755, device='cuda:1')
benign distance is  tensor(8.0755, device='cuda:1')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  3.19679656624794
distance x is tensor(5.7615, device='cuda:1')
benign distance is  tensor(5.7615, device='cuda:1')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  2.5494114756584167
distance x is tensor(4.0845, device='cuda:1')
benign distance is  tensor(4.0845, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(5.8251, device='cuda:1')
compute distance is  tensor(5.8251, device='cuda:1')
compute norm is  tensor(81.2063, device='cuda:1', dtype=torch.float64)
distance x is tensor(6.8830, device='cuda:1')
compute distance is  tensor(6.8830, device='cuda:1')
compute norm is  tensor(82.3134, device='cuda:1', dtype=torch.float64)
distance x is tensor(6.0851, device='cuda:1')
compute distance is  tensor(6.0851, device='cuda:1')
compute norm is  tensor(81.8525, device='cuda:1', dtype=torch.float64)
distance x is tensor(6.4120, device='cuda:1')
compute distance is  tensor(6.4120, device='cuda:1')
compute norm is  tensor(81.9154, device='cuda:1', dtype=torch.float64)
distance x is tensor(6.3621, device='cuda:1')
compute distance is  tensor(6.3621, device='cuda:1')
compute norm is  tensor(82.1461, device='cuda:1', dtype=torch.float64)
distance x is tensor(6.0960, device='cuda:1')
compute distance is  tensor(6.0960, device='cuda:1')
compute norm is  tensor(82.2711, device='cuda:1', dtype=torch.float64)
distance x is tensor(6.7786, device='cuda:1')
compute distance is  tensor(6.7786, device='cuda:1')
compute norm is  tensor(81.9957, device='cuda:1', dtype=torch.float64)
distance x is tensor(8.3929, device='cuda:1')
compute distance is  tensor(8.3929, device='cuda:1')
compute norm is  tensor(82.1899, device='cuda:1', dtype=torch.float64)
distance x is tensor(5.6574, device='cuda:1')
compute distance is  tensor(5.6574, device='cuda:1')
compute norm is  tensor(81.9885, device='cuda:1', dtype=torch.float64)
distance x is tensor(7.1803, device='cuda:1')
compute distance is  tensor(7.1803, device='cuda:1')
compute norm is  tensor(82.1994, device='cuda:1', dtype=torch.float64)
distance x is tensor(6.3897, device='cuda:1')
compute distance is  tensor(6.3897, device='cuda:1')
compute norm is  tensor(81.6367, device='cuda:1', dtype=torch.float64)
distance x is tensor(6.4616, device='cuda:1')
compute distance is  tensor(6.4616, device='cuda:1')
compute norm is  tensor(82.1131, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(8.3929, device='cuda:1')
distance x is tensor(102096.6406, device='cuda:1')
distance x is tensor(102096.6406, device='cuda:1')
________________________________
test distance is  tensor(102096.6406, device='cuda:1')
test distance1 is  tensor(102096.6406, device='cuda:1')
test similarity is  tensor(0.2677, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107584328084045.52
test entropy is  0.0
________________________________
cal ratio is  0.008885399467173233
distance x is tensor(907.1741, device='cuda:1')
cal_distance is  tensor(907.1741, device='cuda:1')
cal ratio is  0.09426215538654749
distance x is tensor(85.5164, device='cuda:1')
cal_distance is  tensor(85.5164, device='cuda:1')
cal ratio is  0.3070138546138718
distance x is tensor(26.2581, device='cuda:1')
cal_distance is  tensor(26.2581, device='cuda:1')
cal ratio is  0.5540530105957246
distance x is tensor(14.5506, device='cuda:1')
cal_distance is  tensor(14.5506, device='cuda:1')
cal ratio is  0.744289254535621
distance x is tensor(10.8312, device='cuda:1')
cal_distance is  tensor(10.8312, device='cuda:1')
cal ratio is  0.8626675918405613
distance x is tensor(9.3445, device='cuda:1')
cal_distance is  tensor(9.3445, device='cuda:1')
cal ratio is  0.9287614163740603
distance x is tensor(8.6792, device='cuda:1')
cal_distance is  tensor(8.6792, device='cuda:1')
cal ratio is  0.9637005016588633
distance x is tensor(8.3644, device='cuda:1')
cal_distance is  tensor(8.3644, device='cuda:1')
distance x is tensor(8.3644, device='cuda:1')
return_distance is  tensor(8.3644, device='cuda:1')
distance x is tensor(8.3552, device='cuda:1')
distance x is tensor(8.3552, device='cuda:1')
________________________________
test distance is  tensor(8.3552, device='cuda:1')
test distance1 is  tensor(8.3552, device='cuda:1')
test similarity is  tensor(0.9999, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.4742704291841875
test entropy is  2.1226415362185254
________________________________
0
distance x is tensor(8.3552, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  2.1225205471774915
avg test loss is  2.4739467002181357
avg accuracy is  0.10006666682299865
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9999, device='cuda:1')
compute_distance is  tensor(8.3552, device='cuda:1')
compute_norm is  tensor(81.1370, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(13.1579, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.9399232765886066
avg test loss is  3.5386433786929037
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9992, device='cuda:1')
compute_distance is  tensor(13.1579, device='cuda:1')
compute_norm is  tensor(81.1370, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(15.3285, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.5629638283491643
avg test loss is  2.8607364903126697
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9994, device='cuda:1')
compute_distance is  tensor(15.3285, device='cuda:1')
compute_norm is  tensor(80.5358, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(19.1493, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.866734197208368
avg test loss is  3.5839695218783705
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9990, device='cuda:1')
compute_distance is  tensor(19.1493, device='cuda:1')
compute_norm is  tensor(80.4036, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(21.8548, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  1.5596481979782901
avg test loss is  2.855967954277738
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9993, device='cuda:1')
compute_distance is  tensor(21.8548, device='cuda:1')
compute_norm is  tensor(79.8067, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(26.1176, device='cuda:1')
distance x is tensor(26.1176, device='cuda:1')
________________________________
test distance is  tensor(26.1176, device='cuda:1')
test distance1 is  tensor(26.1176, device='cuda:1')
test similarity is  tensor(0.9989, device='cuda:1')
test acc is  0.10000000015633198
test loss is 3.57560070135446
test entropy is  0.865405189075958
________________________________
cal ratio is  0.5555409268728799
distance x is tensor(14.5138, device='cuda:1')
cal_distance is  tensor(14.5138, device='cuda:1')
cal ratio is  0.7452323210352322
distance x is tensor(10.8169, device='cuda:1')
cal_distance is  tensor(10.8169, device='cuda:1')
cal ratio is  0.8632394355002644
distance x is tensor(9.3380, device='cuda:1')
cal_distance is  tensor(9.3380, device='cuda:1')
cal ratio is  0.9290872856039193
distance x is tensor(8.6760, device='cuda:1')
cal_distance is  tensor(8.6760, device='cuda:1')
cal ratio is  0.9638804683987787
distance x is tensor(8.3627, device='cuda:1')
cal_distance is  tensor(8.3627, device='cuda:1')
distance x is tensor(8.3627, device='cuda:1')
return_distance is  tensor(8.3627, device='cuda:1')
distance x is tensor(8.3570, device='cuda:1')
distance x is tensor(8.3570, device='cuda:1')
________________________________
test distance is  tensor(8.3570, device='cuda:1')
test distance1 is  tensor(8.3570, device='cuda:1')
test similarity is  tensor(0.9999, device='cuda:1')
test acc is  0.10005000015633199
test loss is 2.495063432752451
test entropy is  2.0935254386747317
________________________________
0
distance x is tensor(8.3570, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  2.0933110744460053
avg test loss is  2.4951494505156333
avg accuracy is  0.10003333348966531
solo acc is  0.09993333348966532
compute similarity  is  tensor(0.9999, device='cuda:1')
compute_distance is  tensor(8.3570, device='cuda:1')
compute_norm is  tensor(80.4468, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(14.2634, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8942514378378894
avg test loss is  3.5735763331720314
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9991, device='cuda:1')
compute_distance is  tensor(14.2634, device='cuda:1')
compute_norm is  tensor(80.4398, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(17.7973, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.5618502000755847
avg test loss is  2.858917967851228
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9994, device='cuda:1')
compute_distance is  tensor(17.7973, device='cuda:1')
compute_norm is  tensor(79.8385, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(22.6567, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8621868742808604
avg test loss is  3.5867862304898974
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9990, device='cuda:1')
compute_distance is  tensor(22.6567, device='cuda:1')
compute_norm is  tensor(79.7073, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(26.1104, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  1.5604578264232383
avg test loss is  2.854322048138454
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9993, device='cuda:1')
compute_distance is  tensor(26.1104, device='cuda:1')
compute_norm is  tensor(79.1114, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(30.8900, device='cuda:1')
distance x is tensor(30.8900, device='cuda:1')
________________________________
test distance is  tensor(30.8900, device='cuda:1')
test distance1 is  tensor(30.8900, device='cuda:1')
test similarity is  tensor(0.9989, device='cuda:1')
test acc is  0.10000000015633198
test loss is 3.5767746233482605
test entropy is  0.8648739246798477
________________________________
cal ratio is  0.5108272243451327
distance x is tensor(15.7806, device='cuda:1')
cal_distance is  tensor(15.7806, device='cuda:1')
cal ratio is  0.714696286493157
distance x is tensor(11.2785, device='cuda:1')
cal_distance is  tensor(11.2785, device='cuda:1')
cal ratio is  0.845389100501626
distance x is tensor(9.5349, device='cuda:1')
cal_distance is  tensor(9.5349, device='cuda:1')
cal ratio is  0.9194448310477323
distance x is tensor(8.7668, device='cuda:1')
cal_distance is  tensor(8.7668, device='cuda:1')
cal ratio is  0.958873466800284
distance x is tensor(8.4063, device='cuda:1')
cal_distance is  tensor(8.4063, device='cuda:1')
cal ratio is  0.9792190927322589
distance x is tensor(8.2316, device='cuda:1')
cal_distance is  tensor(8.2316, device='cuda:1')
distance x is tensor(8.2316, device='cuda:1')
return_distance is  tensor(8.2316, device='cuda:1')
distance x is tensor(8.2302, device='cuda:1')
distance x is tensor(8.2302, device='cuda:1')
________________________________
test distance is  tensor(8.2302, device='cuda:1')
test distance1 is  tensor(8.2302, device='cuda:1')
test similarity is  tensor(0.9999, device='cuda:1')
test acc is  0.10025000015633197
test loss is 2.4746582238658914
test entropy is  2.123188226461919
________________________________
0
distance x is tensor(8.2302, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  2.1229520497291583
avg test loss is  2.4742758424043148
avg accuracy is  0.09950000015633197
solo acc is  0.09983333348966532
compute similarity  is  tensor(0.9999, device='cuda:1')
compute_distance is  tensor(8.2302, device='cuda:1')
compute_norm is  tensor(80.3433, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(14.5701, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8975412152342196
avg test loss is  3.571699445944097
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9992, device='cuda:1')
compute_distance is  tensor(14.5701, device='cuda:1')
compute_norm is  tensor(80.3464, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(18.2303, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.5608933386263817
avg test loss is  2.8593490932033516
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9994, device='cuda:1')
compute_distance is  tensor(18.2303, device='cuda:1')
compute_norm is  tensor(79.7460, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(23.1565, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8617551483070927
avg test loss is  3.584902716343845
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9990, device='cuda:1')
compute_distance is  tensor(23.1565, device='cuda:1')
compute_norm is  tensor(79.6139, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(26.6506, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  1.560863359142214
avg test loss is  2.8554123162206557
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9993, device='cuda:1')
compute_distance is  tensor(26.6506, device='cuda:1')
compute_norm is  tensor(79.0189, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(31.4600, device='cuda:1')
________________________________
test distance is  tensor(31.4600, device='cuda:1')
test similarity is  tensor(0.9989, device='cuda:1')
test acc is  0.10000000015633198
test loss is 3.5774758029848273
test entropy is  0.8633579888196388
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 3.54336017370224
mal norm is  tensor(205.0277, device='cuda:1')
distance x is tensor(31.4600, device='cuda:1')
mal distance is  tensor(31.4600, device='cuda:1')
user_PLR len size 20
counter_tensor is  tensor([18., 15., 15., 14., 16., 13., 14., 15., 20., 20., 20., 20., 20., 20.,
        20., 20., 20., 20., 20., 20.])
count_res tensor([1.1112e-02, 5.5321e-04, 5.5321e-04, 2.0351e-04, 1.5038e-03, 7.4869e-05,
        2.0351e-04, 5.5321e-04, 8.2104e-02, 8.2104e-02, 8.2104e-02, 8.2104e-02,
        8.2104e-02, 8.2104e-02, 8.2104e-02, 8.2104e-02, 8.2104e-02, 8.2104e-02,
        8.2104e-02, 8.2104e-02])
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 0.00% 

Test Accuracy: 10.00% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.721530109643936
distance x is tensor(6.7893, device='cuda:1')
benign distance is  tensor(6.7893, device='cuda:1')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  3.3713171184062958
distance x is tensor(8.9140, device='cuda:1')
benign distance is  tensor(8.9140, device='cuda:1')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  3.312400758266449
distance x is tensor(8.0069, device='cuda:1')
benign distance is  tensor(8.0069, device='cuda:1')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  3.158560410141945
distance x is tensor(9.0114, device='cuda:1')
benign distance is  tensor(9.0114, device='cuda:1')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  3.2655640095472336
distance x is tensor(7.0049, device='cuda:1')
benign distance is  tensor(7.0049, device='cuda:1')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.7471127063035965
distance x is tensor(6.3183, device='cuda:1')
benign distance is  tensor(6.3183, device='cuda:1')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  3.101409688591957
distance x is tensor(7.3683, device='cuda:1')
benign distance is  tensor(7.3683, device='cuda:1')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.8760616928339005
distance x is tensor(6.8131, device='cuda:1')
benign distance is  tensor(6.8131, device='cuda:1')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
len of model dicts is  12
distance x is tensor(6.4929, device='cuda:1')
compute distance is  tensor(6.4929, device='cuda:1')
compute norm is  tensor(78.7601, device='cuda:1', dtype=torch.float64)
distance x is tensor(8.1875, device='cuda:1')
compute distance is  tensor(8.1875, device='cuda:1')
compute norm is  tensor(79.9044, device='cuda:1', dtype=torch.float64)
distance x is tensor(6.3973, device='cuda:1')
compute distance is  tensor(6.3973, device='cuda:1')
compute norm is  tensor(79.4108, device='cuda:1', dtype=torch.float64)
distance x is tensor(8.6390, device='cuda:1')
compute distance is  tensor(8.6390, device='cuda:1')
compute norm is  tensor(79.5864, device='cuda:1', dtype=torch.float64)
distance x is tensor(9.2466, device='cuda:1')
compute distance is  tensor(9.2466, device='cuda:1')
compute norm is  tensor(79.8787, device='cuda:1', dtype=torch.float64)
distance x is tensor(8.9272, device='cuda:1')
compute distance is  tensor(8.9272, device='cuda:1')
compute norm is  tensor(80.0287, device='cuda:1', dtype=torch.float64)
distance x is tensor(7.9532, device='cuda:1')
compute distance is  tensor(7.9532, device='cuda:1')
compute norm is  tensor(79.5727, device='cuda:1', dtype=torch.float64)
distance x is tensor(7.5208, device='cuda:1')
compute distance is  tensor(7.5208, device='cuda:1')
compute norm is  tensor(79.6813, device='cuda:1', dtype=torch.float64)
distance x is tensor(7.8636, device='cuda:1')
compute distance is  tensor(7.8636, device='cuda:1')
compute norm is  tensor(79.6012, device='cuda:1', dtype=torch.float64)
distance x is tensor(7.3539, device='cuda:1')
compute distance is  tensor(7.3539, device='cuda:1')
compute norm is  tensor(79.7846, device='cuda:1', dtype=torch.float64)
distance x is tensor(7.8210, device='cuda:1')
compute distance is  tensor(7.8210, device='cuda:1')
compute norm is  tensor(79.2736, device='cuda:1', dtype=torch.float64)
distance x is tensor(7.2268, device='cuda:1')
compute distance is  tensor(7.2268, device='cuda:1')
compute norm is  tensor(79.6487, device='cuda:1', dtype=torch.float64)
distance Threshold  is  tensor(9.2466, device='cuda:1')
distance x is tensor(102089.1484, device='cuda:1')
distance x is tensor(102089.1484, device='cuda:1')
________________________________
test distance is  tensor(102089.1484, device='cuda:1')
test distance1 is  tensor(102089.1484, device='cuda:1')
test similarity is  tensor(0.2683, device='cuda:1')
test acc is  0.10000000015633198
test loss is 107570932058369.64
test entropy is  0.0
________________________________
cal ratio is  0.009326677961810801
distance x is tensor(952.1573, device='cuda:1')
cal_distance is  tensor(952.1573, device='cuda:1')
cal ratio is  0.09657449127210967
distance x is tensor(91.9583, device='cuda:1')
cal_distance is  tensor(91.9583, device='cuda:1')
cal ratio is  0.3107572860166672
distance x is tensor(28.5800, device='cuda:1')
cal_distance is  tensor(28.5800, device='cuda:1')
cal ratio is  0.5574237994325884
distance x is tensor(15.9334, device='cuda:1')
cal_distance is  tensor(15.9334, device='cuda:1')
cal ratio is  0.7465556504872268
distance x is tensor(11.8965, device='cuda:1')
cal_distance is  tensor(11.8965, device='cuda:1')
cal ratio is  0.8639858343179501
distance x is tensor(10.2792, device='cuda:1')
cal_distance is  tensor(10.2792, device='cuda:1')
cal ratio is  0.9294748151854662
distance x is tensor(9.5546, device='cuda:1')
cal_distance is  tensor(9.5546, device='cuda:1')
cal ratio is  0.9640730490455129
distance x is tensor(9.2116, device='cuda:1')
cal_distance is  tensor(9.2116, device='cuda:1')
distance x is tensor(9.2116, device='cuda:1')
return_distance is  tensor(9.2116, device='cuda:1')
distance x is tensor(9.2024, device='cuda:1')
distance x is tensor(9.2024, device='cuda:1')
________________________________
test distance is  tensor(9.2024, device='cuda:1')
test distance1 is  tensor(9.2024, device='cuda:1')
test similarity is  tensor(0.9999, device='cuda:1')
test acc is  0.10000000015633198
test loss is 3.534700126790289
test entropy is  0.8949737690532131
________________________________
0
distance x is tensor(9.2024, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.8963385948748477
avg test loss is  3.5336394538757387
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:1')
compute_distance is  tensor(9.2024, device='cuda:1')
compute_norm is  tensor(79.1073, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(11.6011, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.5587005439851838
avg test loss is  2.855569947248837
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:1')
compute_distance is  tensor(11.6011, device='cuda:1')
compute_norm is  tensor(78.5233, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(13.4337, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8608129435637867
avg test loss is  3.5790760303611187
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:1')
compute_distance is  tensor(13.4337, device='cuda:1')
compute_norm is  tensor(78.4066, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(16.8163, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.555645818903502
avg test loss is  2.857915355706774
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:1')
compute_distance is  tensor(16.8163, device='cuda:1')
compute_norm is  tensor(77.8053, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(19.5152, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8623595092215264
avg test loss is  3.573721122131673
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:1')
compute_distance is  tensor(19.5152, device='cuda:1')
compute_norm is  tensor(77.6993, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(23.2707, device='cuda:1')
distance x is tensor(23.2707, device='cuda:1')
________________________________
test distance is  tensor(23.2707, device='cuda:1')
test distance1 is  tensor(23.2707, device='cuda:1')
test similarity is  tensor(0.9999, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.8572643197167404
test entropy is  1.5568663832475382
________________________________
cal ratio is  0.6177487064974807
distance x is tensor(14.3806, device='cuda:1')
cal_distance is  tensor(14.3806, device='cuda:1')
cal ratio is  0.7858281076644523
distance x is tensor(11.3014, device='cuda:1')
cal_distance is  tensor(11.3014, device='cuda:1')
cal ratio is  0.8864424460377376
distance x is tensor(10.0184, device='cuda:1')
cal_distance is  tensor(10.0184, device='cuda:1')
cal ratio is  0.9414935374587666
distance x is tensor(9.4325, device='cuda:1')
cal_distance is  tensor(9.4325, device='cuda:1')
cal ratio is  0.9702962755821739
distance x is tensor(9.1524, device='cuda:1')
cal_distance is  tensor(9.1524, device='cuda:1')
distance x is tensor(9.1524, device='cuda:1')
return_distance is  tensor(9.1524, device='cuda:1')
distance x is tensor(9.1460, device='cuda:1')
distance x is tensor(9.1460, device='cuda:1')
________________________________
test distance is  tensor(9.1460, device='cuda:1')
test distance1 is  tensor(9.1460, device='cuda:1')
test similarity is  tensor(1.0000, device='cuda:1')
test acc is  0.10000000015633198
test loss is 3.224143369111425
test entropy is  1.156483009425816
________________________________
0
distance x is tensor(9.1460, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.156496680875831
avg test loss is  3.225207987116344
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:1')
compute_distance is  tensor(9.1460, device='cuda:1')
compute_norm is  tensor(78.1976, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(12.7569, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  0.8435829949658563
avg test loss is  3.6019373794100176
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:1')
compute_distance is  tensor(12.7569, device='cuda:1')
compute_norm is  tensor(77.9606, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(17.1128, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  1.5588653312563134
avg test loss is  2.854723698548925
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:1')
compute_distance is  tensor(17.1128, device='cuda:1')
compute_norm is  tensor(77.3505, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(20.6700, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  0.8636679364038683
avg test loss is  3.5720420178574033
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:1')
compute_distance is  tensor(20.6700, device='cuda:1')
compute_norm is  tensor(77.2478, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(24.9927, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  1.5583614788329931
avg test loss is  2.8559656631209447
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:1')
compute_distance is  tensor(24.9927, device='cuda:1')
compute_norm is  tensor(76.6450, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(28.6841, device='cuda:1')
distance x is tensor(28.6841, device='cuda:1')
________________________________
test distance is  tensor(28.6841, device='cuda:1')
test distance1 is  tensor(28.6841, device='cuda:1')
test similarity is  tensor(1.0000, device='cuda:1')
test acc is  0.10000000015633198
test loss is 3.5712248770667037
test entropy is  0.8627356327037567
________________________________
cal ratio is  0.5564117773949672
distance x is tensor(15.9617, device='cuda:1')
cal_distance is  tensor(15.9617, device='cuda:1')
cal ratio is  0.7458950083200041
distance x is tensor(11.9060, device='cuda:1')
cal_distance is  tensor(11.9060, device='cuda:1')
cal ratio is  0.8636431562530751
distance x is tensor(10.2826, device='cuda:1')
cal_distance is  tensor(10.2826, device='cuda:1')
cal ratio is  0.92931799944054
distance x is tensor(9.5559, device='cuda:1')
cal_distance is  tensor(9.5559, device='cuda:1')
cal ratio is  0.9640079690482158
distance x is tensor(9.2120, device='cuda:1')
cal_distance is  tensor(9.2120, device='cuda:1')
distance x is tensor(9.2120, device='cuda:1')
return_distance is  tensor(9.2120, device='cuda:1')
distance x is tensor(9.2101, device='cuda:1')
distance x is tensor(9.2101, device='cuda:1')
________________________________
test distance is  tensor(9.2101, device='cuda:1')
test distance1 is  tensor(9.2101, device='cuda:1')
test similarity is  tensor(1.0000, device='cuda:1')
test acc is  0.10000000015633198
test loss is 3.5418729693142335
test entropy is  0.8874255932216197
________________________________
0
distance x is tensor(9.2101, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  0.8863920641860474
avg test loss is  3.5430624108833038
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:1')
compute_distance is  tensor(9.2101, device='cuda:1')
compute_norm is  tensor(78.1569, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(13.7981, device='cuda:1')
++++++++++++++++++++
after training  1
avg test entropy is  1.5559831242571507
avg test loss is  2.858171345328471
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:1')
compute_distance is  tensor(13.7981, device='cuda:1')
compute_norm is  tensor(77.5697, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(17.4253, device='cuda:1')
++++++++++++++++++++
after training  2
avg test entropy is  0.8633622999892814
avg test loss is  3.5731427471266626
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:1')
compute_distance is  tensor(17.4253, device='cuda:1')
compute_norm is  tensor(77.4614, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(21.8624, device='cuda:1')
++++++++++++++++++++
after training  3
avg test entropy is  1.5586834227098332
avg test loss is  2.855049842202079
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:1')
compute_distance is  tensor(21.8624, device='cuda:1')
compute_norm is  tensor(76.8586, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
distance x is tensor(25.5763, device='cuda:1')
++++++++++++++++++++
after training  4
avg test entropy is  0.8643129255725885
avg test loss is  3.5712313700332317
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(1.0000, device='cuda:1')
compute_distance is  tensor(25.5763, device='cuda:1')
compute_norm is  tensor(76.7626, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
change alpha
distance x is tensor(29.8910, device='cuda:1')
________________________________
test distance is  tensor(29.8910, device='cuda:1')
test similarity is  tensor(0.9999, device='cuda:1')
test acc is  0.10000000015633198
test loss is 2.855748675779493
test entropy is  1.5569116179622822
________________________________
final entropy
distance x is tensor(29.8902, device='cuda:1')
++++++++++++++++++++
after training  0
avg test entropy is  1.5573690382402334
avg test loss is  2.8556784945510345
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9999, device='cuda:1')
compute_distance is  tensor(29.8902, device='cuda:1')
compute_norm is  tensor(76.1594, device='cuda:1', dtype=torch.float64)
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.10900000016000001
mal loss is 3.543949618935585
mal norm is  tensor(138.3756, device='cuda:1')
distance x is tensor(33.6568, device='cuda:1')
mal distance is  tensor(33.6568, device='cuda:1')
user_PLR len size 36
counter_tensor is  tensor([28., 27., 28., 22., 11., 16., 22., 26., 19., 19., 19., 19., 19., 19.,
        19., 19., 19., 19., 19., 19., 18., 11., 32., 28., 30.,  7., 20., 31.,
        27., 17., 25., 31., 25., 24., 17., 30.])
count_res tensor([8.8072e-03, 3.2400e-03, 8.8072e-03, 2.1831e-05, 3.6461e-10, 5.4113e-08,
        2.1831e-05, 1.1919e-03, 1.0869e-06, 1.0869e-06, 1.0869e-06, 1.0869e-06,
        1.0869e-06, 1.0869e-06, 1.0869e-06, 1.0869e-06, 1.0869e-06, 1.0869e-06,
        1.0869e-06, 1.0869e-06, 3.9985e-07, 3.6461e-10, 4.8086e-01, 8.8072e-03,
        6.5077e-02, 6.6781e-12, 2.9545e-06, 1.7690e-01, 3.2400e-03, 1.4710e-07,
        4.3849e-04, 1.7690e-01, 4.3849e-04, 1.6131e-04, 1.4710e-07, 6.5077e-02])
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 6.33% 

Test Accuracy: 10.01% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 6.33%
|----0th round Training Accuracy : 9.55%
|----1th round Training Accuracy : 85.63%
|----2th round Training Accuracy : 75.81%
|----3th round Training Accuracy : 73.19%
|----4th round Training Accuracy : 64.76%
|----5th round Training Accuracy : 77.76%
|----6th round Training Accuracy : 20.63%
|----7th round Training Accuracy : 88.74%
|----8th round Training Accuracy : 76.52%
|----9th round Training Accuracy : 74.14%
|----10th round Training Accuracy : 28.11%
|----11th round Training Accuracy : 89.68%
|----12th round Training Accuracy : 26.23%
|----13th round Training Accuracy : 62.90%
|----14th round Training Accuracy : 84.60%
|----15th round Training Accuracy : 78.60%
|----16th round Training Accuracy : 19.93%
|----17th round Training Accuracy : 59.67%
|----18th round Training Accuracy : 22.77%
|----19th round Training Accuracy : 71.67%
|----20th round Training Accuracy : 60.05%
|----21th round Training Accuracy : 65.03%
|----22th round Training Accuracy : 36.86%
|----23th round Training Accuracy : 67.57%
|----24th round Training Accuracy : 85.05%
|----25th round Training Accuracy : 56.66%
|----26th round Training Accuracy : 76.05%
|----27th round Training Accuracy : 75.26%
|----28th round Training Accuracy : 20.27%
|----29th round Training Accuracy : 71.11%
|----30th round Training Accuracy : 15.37%
|----31th round Training Accuracy : 45.32%
|----32th round Training Accuracy : 90.78%
|----33th round Training Accuracy : 50.20%
|----34th round Training Accuracy : 46.75%
|----35th round Training Accuracy : 49.92%
|----36th round Training Accuracy : 28.17%
|----37th round Training Accuracy : 56.12%
|----38th round Training Accuracy : 51.42%
|----39th round Training Accuracy : 54.36%
|----40th round Training Accuracy : 27.19%
|----41th round Training Accuracy : 51.50%
|----42th round Training Accuracy : 23.81%
|----43th round Training Accuracy : 0.00%
|----44th round Training Accuracy : 0.00%
|----45th round Training Accuracy : 0.00%
|----46th round Training Accuracy : 0.00%
|----47th round Training Accuracy : 0.00%
|----48th round Training Accuracy : 0.00%
|----49th round Training Accuracy : 6.33%
|----Final Test Accuracy: 10.01%
|----0th round Final Test Accuracy : 16.96%
|----1th round Final Test Accuracy : 82.00%
|----2th round Final Test Accuracy : 82.77%
|----3th round Final Test Accuracy : 81.64%
|----4th round Final Test Accuracy : 77.99%
|----5th round Final Test Accuracy : 83.01%
|----6th round Final Test Accuracy : 24.66%
|----7th round Final Test Accuracy : 83.13%
|----8th round Final Test Accuracy : 82.88%
|----9th round Final Test Accuracy : 82.26%
|----10th round Final Test Accuracy : 31.10%
|----11th round Final Test Accuracy : 86.66%
|----12th round Final Test Accuracy : 25.12%
|----13th round Final Test Accuracy : 76.11%
|----14th round Final Test Accuracy : 84.28%
|----15th round Final Test Accuracy : 82.02%
|----16th round Final Test Accuracy : 25.02%
|----17th round Final Test Accuracy : 73.59%
|----18th round Final Test Accuracy : 25.20%
|----19th round Final Test Accuracy : 81.56%
|----20th round Final Test Accuracy : 75.73%
|----21th round Final Test Accuracy : 78.40%
|----22th round Final Test Accuracy : 32.69%
|----23th round Final Test Accuracy : 79.42%
|----24th round Final Test Accuracy : 83.94%
|----25th round Final Test Accuracy : 77.23%
|----26th round Final Test Accuracy : 78.13%
|----27th round Final Test Accuracy : 83.66%
|----28th round Final Test Accuracy : 24.35%
|----29th round Final Test Accuracy : 82.62%
|----30th round Final Test Accuracy : 20.91%
|----31th round Final Test Accuracy : 74.59%
|----32th round Final Test Accuracy : 80.80%
|----33th round Final Test Accuracy : 73.79%
|----34th round Final Test Accuracy : 74.30%
|----35th round Final Test Accuracy : 76.09%
|----36th round Final Test Accuracy : 31.69%
|----37th round Final Test Accuracy : 76.30%
|----38th round Final Test Accuracy : 68.97%
|----39th round Final Test Accuracy : 76.34%
|----40th round Final Test Accuracy : 28.82%
|----41th round Final Test Accuracy : 75.94%
|----42th round Final Test Accuracy : 24.36%
|----43th round Final Test Accuracy : 10.00%
|----44th round Final Test Accuracy : 10.00%
|----45th round Final Test Accuracy : 10.00%
|----46th round Final Test Accuracy : 10.00%
|----47th round Final Test Accuracy : 10.00%
|----48th round Final Test Accuracy : 10.00%
|----49th round Final Test Accuracy : 10.01%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    Non-IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 20644.4325
