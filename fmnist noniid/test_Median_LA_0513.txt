
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 30

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.3300348222255707
benign distance is  tensor(122.9836, device='cuda:3')
norm1 res is  tensor(5.5423, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3220083713531494
benign distance is  tensor(114.7010, device='cuda:3')
norm1 res is  tensor(5.3125, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4604976773262024
benign distance is  tensor(125.0546, device='cuda:3')
norm1 res is  tensor(5.6356, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.3346908688545227
benign distance is  tensor(118.4104, device='cuda:3')
norm1 res is  tensor(5.3694, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.8142387270927429
benign distance is  tensor(105.3811, device='cuda:3')
norm1 res is  tensor(4.7664, device='cuda:3')
current submit client idx and staleness is  5 1

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 30

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5176737904548645
benign distance is  tensor(109.2460, device='cuda:3')
norm1 res is  tensor(4.8817, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5996419191360474
benign distance is  tensor(119.7648, device='cuda:3')
norm1 res is  tensor(5.5868, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4926905632019043
benign distance is  tensor(126.1188, device='cuda:3')
norm1 res is  tensor(5.6051, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.6860523223876953
benign distance is  tensor(112.8422, device='cuda:3')
norm1 res is  tensor(5.1537, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4799732267856598
benign distance is  tensor(114.9917, device='cuda:3')
norm1 res is  tensor(5.2072, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.3159365952014923
benign distance is  tensor(122.3399, device='cuda:3')
norm1 res is  tensor(5.5691, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  1.0896066427230835
benign distance is  tensor(124.5948, device='cuda:3')
norm1 res is  tensor(5.6397, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3769811987876892
benign distance is  tensor(129.6047, device='cuda:3')
norm1 res is  tensor(5.8988, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.25099897384643555
benign distance is  tensor(133.6770, device='cuda:3')
norm1 res is  tensor(5.9831, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.47159910202026367
benign distance is  tensor(137.4498, device='cuda:3')
norm1 res is  tensor(6.1140, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6870734095573425
benign distance is  tensor(116.0135, device='cuda:3')
norm1 res is  tensor(5.3387, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.4037856459617615
benign distance is  tensor(132.0589, device='cuda:3')
norm1 res is  tensor(5.9806, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.48105335235595703
benign distance is  tensor(133.9042, device='cuda:3')
norm1 res is  tensor(6.0314, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.24489521980285645
benign distance is  tensor(137.6437, device='cuda:3')
norm1 res is  tensor(6.3651, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.6787801384925842
benign distance is  tensor(136.6717, device='cuda:3')
norm1 res is  tensor(6.2242, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.29554110765457153
benign distance is  tensor(138.9337, device='cuda:3')
norm1 res is  tensor(6.2172, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.11942879110574722
benign distance is  tensor(129.4793, device='cuda:3')
norm1 res is  tensor(5.8187, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.5044581294059753
benign distance is  tensor(148.1382, device='cuda:3')
norm1 res is  tensor(6.7039, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.43130093812942505
benign distance is  tensor(125.3177, device='cuda:3')
norm1 res is  tensor(5.7551, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.8178167343139648
benign distance is  tensor(123.0705, device='cuda:3')
norm1 res is  tensor(5.7271, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.19996921718120575
benign distance is  tensor(125.4214, device='cuda:3')
norm1 res is  tensor(5.7205, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.23973700404167175
benign distance is  tensor(122.5366, device='cuda:3')
norm1 res is  tensor(5.5038, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.2651636600494385
benign distance is  tensor(144.1424, device='cuda:3')
norm1 res is  tensor(6.5463, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.948752760887146
benign distance is  tensor(133.9292, device='cuda:3')
norm1 res is  tensor(5.8339, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.33795592188835144
benign distance is  tensor(147.3231, device='cuda:3')
norm1 res is  tensor(6.6943, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7071067094802856
benign distance is  tensor(122.2723, device='cuda:3')
norm1 res is  tensor(5.4320, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.5448786616325378
benign distance is  tensor(139.9520, device='cuda:3')
norm1 res is  tensor(6.3898, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  0.2946298122406006
benign distance is  tensor(142.7288, device='cuda:3')
norm1 res is  tensor(6.3544, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  0.6352490782737732
benign distance is  tensor(122.2606, device='cuda:3')
norm1 res is  tensor(5.5229, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.6195007562637329
benign distance is  tensor(135.9957, device='cuda:3')
norm1 res is  tensor(6.2753, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.5513818860054016
benign distance is  tensor(123.6889, device='cuda:3')
norm1 res is  tensor(5.6925, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.8943055272102356
benign distance is  tensor(135.0310, device='cuda:3')
norm1 res is  tensor(6.2774, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.3860079348087311
benign distance is  tensor(133.9693, device='cuda:3')
norm1 res is  tensor(6.1269, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.3398025333881378
benign distance is  tensor(129.8981, device='cuda:3')
norm1 res is  tensor(5.8796, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.2295294553041458
benign distance is  tensor(133.2247, device='cuda:3')
norm1 res is  tensor(6.1871, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.06752389669418335
benign distance is  tensor(122.5446, device='cuda:3')
norm1 res is  tensor(5.5610, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.6238099336624146
benign distance is  tensor(130.2871, device='cuda:3')
norm1 res is  tensor(5.9595, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.2851788401603699
benign distance is  tensor(130.4841, device='cuda:3')
norm1 res is  tensor(5.7839, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.3989999294281006
benign distance is  tensor(125.3074, device='cuda:3')
norm1 res is  tensor(5.7203, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.22063401341438293
benign distance is  tensor(129.8792, device='cuda:3')
norm1 res is  tensor(5.7143, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.21543750166893005
benign distance is  tensor(123.4207, device='cuda:3')
norm1 res is  tensor(5.6762, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.2772510051727295
benign distance is  tensor(122.2788, device='cuda:3')
norm1 res is  tensor(5.5607, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.06817848980426788
benign distance is  tensor(130.2364, device='cuda:3')
norm1 res is  tensor(5.8374, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.44429582357406616
benign distance is  tensor(128.1889, device='cuda:3')
norm1 res is  tensor(5.7863, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.2776210308074951
benign distance is  tensor(152.8707, device='cuda:3')
norm1 res is  tensor(6.6939, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.674430251121521
benign distance is  tensor(126.5312, device='cuda:3')
norm1 res is  tensor(5.6586, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  1.1818113327026367
benign distance is  tensor(134.0216, device='cuda:3')
norm1 res is  tensor(6.0533, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.16529464721679688
benign distance is  tensor(139.6327, device='cuda:3')
norm1 res is  tensor(6.3196, device='cuda:3')
current submit client idx and staleness is  48 1
grad,shape is torch.Size([215370])
 benign loss is  0.29542288184165955
benign distance is  tensor(117.2023, device='cuda:3')
norm1 res is  tensor(5.3581, device='cuda:3')
current submit client idx and staleness is  49 1
grad,shape is torch.Size([215370])
 benign loss is  0.32955846190452576
benign distance is  tensor(110.7823, device='cuda:3')
norm1 res is  tensor(5.0968, device='cuda:3')
current submit client idx and staleness is  50 1
grad,shape is torch.Size([215370])
 benign loss is  0.7481569051742554
benign distance is  tensor(127.6711, device='cuda:3')
norm1 res is  tensor(5.8176, device='cuda:3')
current submit client idx and staleness is  51 1
grad,shape is torch.Size([215370])
 benign loss is  0.34781593084335327
benign distance is  tensor(125.8206, device='cuda:3')
norm1 res is  tensor(5.7378, device='cuda:3')
current submit client idx and staleness is  52 1
grad,shape is torch.Size([215370])
 benign loss is  0.6834248900413513
benign distance is  tensor(126.1540, device='cuda:3')
norm1 res is  tensor(5.7909, device='cuda:3')
current submit client idx and staleness is  53 1
grad,shape is torch.Size([215370])
 benign loss is  0.5607643127441406
benign distance is  tensor(115.7017, device='cuda:3')
norm1 res is  tensor(5.3327, device='cuda:3')
current submit client idx and staleness is  54 1
grad,shape is torch.Size([215370])
 benign loss is  0.04289757460355759
benign distance is  tensor(121.5545, device='cuda:3')
norm1 res is  tensor(5.6107, device='cuda:3')
current submit client idx and staleness is  55 1
grad,shape is torch.Size([215370])
 benign loss is  0.7329427003860474
benign distance is  tensor(121.0924, device='cuda:3')
norm1 res is  tensor(5.4994, device='cuda:3')
current submit client idx and staleness is  56 1
grad,shape is torch.Size([215370])
 benign loss is  0.5001934766769409
benign distance is  tensor(130.2233, device='cuda:3')
norm1 res is  tensor(5.9436, device='cuda:3')
current submit client idx and staleness is  57 1
grad,shape is torch.Size([215370])
 benign loss is  0.7307397723197937
benign distance is  tensor(113.6028, device='cuda:3')
norm1 res is  tensor(5.0747, device='cuda:3')
current submit client idx and staleness is  58 1
grad,shape is torch.Size([215370])
 benign loss is  0.13351429998874664
benign distance is  tensor(122.6883, device='cuda:3')
norm1 res is  tensor(5.5303, device='cuda:3')
current submit client idx and staleness is  59 1
grad,shape is torch.Size([215370])
 benign loss is  0.35612425208091736
benign distance is  tensor(124.7197, device='cuda:3')
norm1 res is  tensor(5.5911, device='cuda:3')
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
median_weights acc is  0.8780000001569995
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 89.33% 

Test Accuracy: 88.65% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.7568632364273071
benign distance is  tensor(120.2334, device='cuda:3')
norm1 res is  tensor(5.6684, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.3309619426727295
benign distance is  tensor(125.5770, device='cuda:3')
norm1 res is  tensor(5.7167, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.18400810658931732
benign distance is  tensor(134.4640, device='cuda:3')
norm1 res is  tensor(5.9905, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  1.0608118772506714
benign distance is  tensor(112.2257, device='cuda:3')
norm1 res is  tensor(5.0195, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.6272009611129761
benign distance is  tensor(106.6313, device='cuda:3')
norm1 res is  tensor(4.7631, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5062170028686523
benign distance is  tensor(123.9227, device='cuda:3')
norm1 res is  tensor(5.6886, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5367064476013184
benign distance is  tensor(110.1545, device='cuda:3')
norm1 res is  tensor(5.0118, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.10310515016317368
benign distance is  tensor(133.0413, device='cuda:3')
norm1 res is  tensor(6.0602, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
curent length is  8
the length of epoch_weights is  1
alpha 1 is [0]
alphas 3 is [1.  0.5]
alphas is  [0.66666667 0.33333333]
median_weights acc is  0.8701000001569995
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 89.02% 

Test Accuracy: 88.47% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5801287889480591
benign distance is  tensor(114.0732, device='cuda:3')
norm1 res is  tensor(5.1946, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5597180128097534
benign distance is  tensor(123.8001, device='cuda:3')
norm1 res is  tensor(5.7352, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.4062587320804596
benign distance is  tensor(118.8335, device='cuda:3')
norm1 res is  tensor(5.3795, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.22285635769367218
benign distance is  tensor(112.4278, device='cuda:3')
norm1 res is  tensor(5.0547, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.5833600163459778
benign distance is  tensor(95.4400, device='cuda:3')
norm1 res is  tensor(4.2107, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.6184659600257874
benign distance is  tensor(114.8169, device='cuda:3')
norm1 res is  tensor(5.2223, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.18019185960292816
benign distance is  tensor(110.4033, device='cuda:3')
norm1 res is  tensor(4.9249, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.21565189957618713
benign distance is  tensor(118.5757, device='cuda:3')
norm1 res is  tensor(5.5231, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.21501998603343964
benign distance is  tensor(142.9654, device='cuda:3')
norm1 res is  tensor(6.5237, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.26138097047805786
benign distance is  tensor(138.2155, device='cuda:3')
norm1 res is  tensor(6.2431, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.553986132144928
benign distance is  tensor(124.5750, device='cuda:3')
norm1 res is  tensor(5.6316, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.9029232263565063
benign distance is  tensor(120.5901, device='cuda:3')
norm1 res is  tensor(5.5054, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.7639043927192688
benign distance is  tensor(123.2637, device='cuda:3')
norm1 res is  tensor(5.5210, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3890385031700134
benign distance is  tensor(125.9723, device='cuda:3')
norm1 res is  tensor(5.7180, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.37313514947891235
benign distance is  tensor(126.0480, device='cuda:3')
norm1 res is  tensor(5.7559, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.3992840647697449
benign distance is  tensor(127.0781, device='cuda:3')
norm1 res is  tensor(5.7922, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
curent length is  8
the length of epoch_weights is  1
alpha 1 is [0]
alphas 3 is [1.         0.33333333]
alphas is  [0.75 0.25]
median_weights acc is  0.8681000001569995
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 88.91% 

Test Accuracy: 88.36% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.6425892114639282
benign distance is  tensor(101.1735, device='cuda:3')
norm1 res is  tensor(4.6872, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  1.3935645818710327
benign distance is  tensor(120.9177, device='cuda:3')
norm1 res is  tensor(5.5813, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2504374086856842
benign distance is  tensor(125.8447, device='cuda:3')
norm1 res is  tensor(5.5809, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.38575777411460876
benign distance is  tensor(103.7195, device='cuda:3')
norm1 res is  tensor(4.5526, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.1613938808441162
benign distance is  tensor(107.5334, device='cuda:3')
norm1 res is  tensor(4.9501, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.5240862965583801
benign distance is  tensor(128.9869, device='cuda:3')
norm1 res is  tensor(5.7931, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.5303558111190796
benign distance is  tensor(113.9251, device='cuda:3')
norm1 res is  tensor(5.0527, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.8892984390258789
benign distance is  tensor(108.1202, device='cuda:3')
norm1 res is  tensor(4.9713, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.33985215425491333
benign distance is  tensor(122.8336, device='cuda:3')
norm1 res is  tensor(5.4872, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.6303068399429321
benign distance is  tensor(149.2289, device='cuda:3')
norm1 res is  tensor(6.8447, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.7260697484016418
benign distance is  tensor(126.1042, device='cuda:3')
norm1 res is  tensor(5.6123, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.13274723291397095
benign distance is  tensor(123.3672, device='cuda:3')
norm1 res is  tensor(5.6330, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.25573644042015076
benign distance is  tensor(135.8214, device='cuda:3')
norm1 res is  tensor(5.9953, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5251632928848267
benign distance is  tensor(122.4019, device='cuda:3')
norm1 res is  tensor(5.5740, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.48467326164245605
benign distance is  tensor(135.7833, device='cuda:3')
norm1 res is  tensor(6.2938, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  1.1171175241470337
benign distance is  tensor(124.9413, device='cuda:3')
norm1 res is  tensor(5.6621, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
curent length is  8
the length of epoch_weights is  2
alpha 1 is [0, 2]
alphas 3 is [1.   0.25 0.5 ]
alphas is  [0.57142857 0.14285714 0.28571429]
median_weights acc is  0.8741000001569995
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 88.75% 

Test Accuracy: 88.17% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.8670989871025085
benign distance is  tensor(96.4823, device='cuda:3')
norm1 res is  tensor(4.5121, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7697197198867798
benign distance is  tensor(106.5464, device='cuda:3')
norm1 res is  tensor(4.9163, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.2790166437625885
benign distance is  tensor(121.2006, device='cuda:3')
norm1 res is  tensor(5.5321, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.34931808710098267
benign distance is  tensor(103.0900, device='cuda:3')
norm1 res is  tensor(4.6144, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.4349551796913147
benign distance is  tensor(90.2720, device='cuda:3')
norm1 res is  tensor(4.0532, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.9216947555541992
benign distance is  tensor(118.6904, device='cuda:3')
norm1 res is  tensor(5.4580, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2926906943321228
benign distance is  tensor(102.7944, device='cuda:3')
norm1 res is  tensor(4.6023, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6851874589920044
benign distance is  tensor(104.9959, device='cuda:3')
norm1 res is  tensor(4.8092, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.4112628102302551
benign distance is  tensor(131.4398, device='cuda:3')
norm1 res is  tensor(5.8849, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.2891647219657898
benign distance is  tensor(135.2846, device='cuda:3')
norm1 res is  tensor(6.0745, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.6000584363937378
benign distance is  tensor(133.7781, device='cuda:3')
norm1 res is  tensor(6.0931, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.7470645308494568
benign distance is  tensor(121.2423, device='cuda:3')
norm1 res is  tensor(5.5144, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.5611146688461304
benign distance is  tensor(122.6252, device='cuda:3')
norm1 res is  tensor(5.5599, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.38802817463874817
benign distance is  tensor(126.3829, device='cuda:3')
norm1 res is  tensor(5.7736, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.746490478515625
benign distance is  tensor(133.4854, device='cuda:3')
norm1 res is  tensor(6.1697, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.717459499835968
benign distance is  tensor(133.8997, device='cuda:3')
norm1 res is  tensor(6.0843, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  0.1884869635105133
benign distance is  tensor(124.2128, device='cuda:3')
norm1 res is  tensor(5.7416, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  0.7393283843994141
benign distance is  tensor(117.7284, device='cuda:3')
norm1 res is  tensor(5.2458, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  0.7496775984764099
benign distance is  tensor(134.7722, device='cuda:3')
norm1 res is  tensor(5.9979, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  1.009782075881958
benign distance is  tensor(127.0720, device='cuda:3')
norm1 res is  tensor(5.8102, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  1.5808048248291016
benign distance is  tensor(121.4503, device='cuda:3')
norm1 res is  tensor(5.4356, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  0.37673842906951904
benign distance is  tensor(120.9645, device='cuda:3')
norm1 res is  tensor(5.3909, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  0.3097319006919861
benign distance is  tensor(121.8288, device='cuda:3')
norm1 res is  tensor(5.5855, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  0.3987467885017395
benign distance is  tensor(124.2074, device='cuda:3')
norm1 res is  tensor(5.8517, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
curent length is  8
the length of epoch_weights is  1
alpha 1 is [0]
alphas 3 is [1.  0.2]
alphas is  [0.83333333 0.16666667]
median_weights acc is  0.8731000001569995
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 88.95% 

Test Accuracy: 87.99% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.5361179113388062
benign distance is  tensor(110.2302, device='cuda:3')
norm1 res is  tensor(5.0129, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.5209383368492126
benign distance is  tensor(117.2112, device='cuda:3')
norm1 res is  tensor(5.4838, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.38817098736763
benign distance is  tensor(109.0523, device='cuda:3')
norm1 res is  tensor(4.9332, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.7813252210617065
benign distance is  tensor(101.9489, device='cuda:3')
norm1 res is  tensor(4.5468, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.41452088952064514
benign distance is  tensor(93.3880, device='cuda:3')
norm1 res is  tensor(4.1555, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  1.1105265617370605
benign distance is  tensor(116.5511, device='cuda:3')
norm1 res is  tensor(5.3923, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.3362807631492615
benign distance is  tensor(101.1786, device='cuda:3')
norm1 res is  tensor(4.5573, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.3639979660511017
benign distance is  tensor(120.8855, device='cuda:3')
norm1 res is  tensor(5.4150, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  0.5658814907073975
benign distance is  tensor(135.0012, device='cuda:3')
norm1 res is  tensor(6.0435, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  0.1783289760351181
benign distance is  tensor(134.7139, device='cuda:3')
norm1 res is  tensor(6.2581, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  0.25181812047958374
benign distance is  tensor(141.4379, device='cuda:3')
norm1 res is  tensor(6.4848, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  0.11332516372203827
benign distance is  tensor(127.3991, device='cuda:3')
norm1 res is  tensor(5.7827, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  0.7127102613449097
benign distance is  tensor(130.9442, device='cuda:3')
norm1 res is  tensor(5.9993, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  0.25735047459602356
benign distance is  tensor(123.4987, device='cuda:3')
norm1 res is  tensor(5.5384, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  0.7254728078842163
benign distance is  tensor(117.4560, device='cuda:3')
norm1 res is  tensor(5.4656, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  0.02900712564587593
benign distance is  tensor(123.4187, device='cuda:3')
norm1 res is  tensor(5.6199, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
curent length is  8
the length of epoch_weights is  3
alpha 1 is [0, 3, 4]
alphas 3 is [1.         0.16666667 0.33333333 0.5       ]
alphas is  [0.5        0.08333333 0.16666667 0.25      ]
median_weights acc is  0.8730000001569995
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 89.11% 

Test Accuracy: 88.23% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  0.4136880338191986
benign distance is  tensor(95.1861, device='cuda:3')
norm1 res is  tensor(4.3419, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  0.7747881412506104
benign distance is  tensor(104.3525, device='cuda:3')
norm1 res is  tensor(4.7486, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  0.6692630648612976
benign distance is  tensor(122.5442, device='cuda:3')
norm1 res is  tensor(5.4791, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  0.5635867118835449
benign distance is  tensor(94.8313, device='cuda:3')
norm1 res is  tensor(4.1917, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  0.570511519908905
benign distance is  tensor(96.8729, device='cuda:3')
norm1 res is  tensor(4.3292, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  0.540340006351471
benign distance is  tensor(116.7056, device='cuda:3')
norm1 res is  tensor(5.2595, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  0.2695642411708832
benign distance is  tensor(96.1153, device='cuda:3')
norm1 res is  tensor(4.3398, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  0.6380444765090942
benign distance is  tensor(114.0655, device='cuda:3')
norm1 res is  tensor(5.3388, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  0.19816997647285461
benign distance is  tensor(129.4529, device='cuda:3')
norm1 res is  tensor(5.9542, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  0.5738127827644348
benign distance is  tensor(126.7767, device='cuda:3')
norm1 res is  tensor(5.7101, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  0.5109914541244507
benign distance is  tensor(109.6601, device='cuda:3')
norm1 res is  tensor(4.9357, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  0.3863423466682434
benign distance is  tensor(138.3979, device='cuda:3')
norm1 res is  tensor(6.4016, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  0.37514135241508484
benign distance is  tensor(121.5058, device='cuda:3')
norm1 res is  tensor(5.5905, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  0.3270694613456726
benign distance is  tensor(134.3371, device='cuda:3')
norm1 res is  tensor(6.0228, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  0.31296905875205994
benign distance is  tensor(131.3571, device='cuda:3')
norm1 res is  tensor(5.9413, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  0.5503756403923035
benign distance is  tensor(126.6660, device='cuda:3')
norm1 res is  tensor(5.8797, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  0.36376044154167175
benign distance is  tensor(129.1712, device='cuda:3')
norm1 res is  tensor(5.8650, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  0.7560914158821106
benign distance is  tensor(142.7288, device='cuda:3')
norm1 res is  tensor(6.6080, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  0.2554856836795807
benign distance is  tensor(119.0329, device='cuda:3')
norm1 res is  tensor(5.5021, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  0.1436367779970169
benign distance is  tensor(119.3639, device='cuda:3')
norm1 res is  tensor(5.6099, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  0.15184515714645386
benign distance is  tensor(131.7241, device='cuda:3')
norm1 res is  tensor(5.8965, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  0.5762178301811218
benign distance is  tensor(116.6156, device='cuda:3')
norm1 res is  tensor(5.2174, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  0.23345598578453064
benign distance is  tensor(132.8849, device='cuda:3')
norm1 res is  tensor(6.0784, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  0.2459036409854889
benign distance is  tensor(118.0084, device='cuda:3')
norm1 res is  tensor(5.3254, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  0.13598039746284485
benign distance is  tensor(123.1930, device='cuda:3')
norm1 res is  tensor(5.5929, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  0.2943964898586273
benign distance is  tensor(125.5639, device='cuda:3')
norm1 res is  tensor(5.7312, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  0.25532159209251404
benign distance is  tensor(124.2641, device='cuda:3')
norm1 res is  tensor(5.7529, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  0.3135387599468231
benign distance is  tensor(127.2470, device='cuda:3')
norm1 res is  tensor(5.7328, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  0.4069501757621765
benign distance is  tensor(118.3061, device='cuda:3')
norm1 res is  tensor(5.4324, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  0.627829372882843
benign distance is  tensor(124.8339, device='cuda:3')
norm1 res is  tensor(5.6889, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  0.7601704597473145
benign distance is  tensor(126.6858, device='cuda:3')
norm1 res is  tensor(5.7583, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  0.3533596098423004
benign distance is  tensor(128.7651, device='cuda:3')
norm1 res is  tensor(5.9865, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal norm is  tensor(21.2705, device='cuda:3')
mal distance is  tensor(614.0179, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal norm is  tensor(21.2549, device='cuda:3')
mal distance is  tensor(614.0275, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal norm is  tensor(21.2566, device='cuda:3')
mal distance is  tensor(612.8062, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal norm is  tensor(21.2557, device='cuda:3')
mal distance is  tensor(613.1189, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal norm is  tensor(21.2580, device='cuda:3')
mal distance is  tensor(613.2887, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal norm is  tensor(21.2623, device='cuda:3')
mal distance is  tensor(613.1914, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal norm is  tensor(21.2566, device='cuda:3')
mal distance is  tensor(612.7190, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal norm is  tensor(21.2571, device='cuda:3')
mal distance is  tensor(613.0402, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal norm is  tensor(21.2570, device='cuda:3')
mal distance is  tensor(613.2145, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal norm is  tensor(21.2614, device='cuda:3')
mal distance is  tensor(613.5058, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal norm is  tensor(21.2760, device='cuda:3')
mal distance is  tensor(613.8032, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.2000000005
mal norm is  tensor(21.2330, device='cuda:3')
mal distance is  tensor(612.4100, device='cuda:3')
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
median_weights acc is  0.1366000001569997
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 13.67% 

Test Accuracy: 13.19% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.294790744781494
benign distance is  tensor(45863.6055, device='cuda:3')
norm1 res is  tensor(2390.2620, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.300649404525757
benign distance is  tensor(38025.9609, device='cuda:3')
norm1 res is  tensor(1819.7727, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.303560256958008
benign distance is  tensor(43906.8711, device='cuda:3')
norm1 res is  tensor(2038.8715, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.286801815032959
benign distance is  tensor(36088.1797, device='cuda:3')
norm1 res is  tensor(1994.5040, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.3125643730163574
benign distance is  tensor(22171.4785, device='cuda:3')
norm1 res is  tensor(1423.2660, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.323193311691284
benign distance is  tensor(117428.9297, device='cuda:3')
norm1 res is  tensor(6209.9985, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2963449954986572
benign distance is  tensor(126290.7344, device='cuda:3')
norm1 res is  tensor(6126.5137, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.3070247173309326
benign distance is  tensor(14501.9932, device='cuda:3')
norm1 res is  tensor(839.9081, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(1114.4279, device='cuda:3')
mal distance is  tensor(18207.1523, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 5e-10
mal norm is  tensor(1103.5721, device='cuda:3')
mal distance is  tensor(17405.7363, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 5e-10
mal norm is  tensor(1124.7938, device='cuda:3')
mal distance is  tensor(17976.4316, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(1121.3694, device='cuda:3')
mal distance is  tensor(18019.3125, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(1138.7153, device='cuda:3')
mal distance is  tensor(18279.2129, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(1128.4006, device='cuda:3')
mal distance is  tensor(18137.4473, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(1134.0277, device='cuda:3')
mal distance is  tensor(18306.8496, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(1139.1732, device='cuda:3')
mal distance is  tensor(18187.1875, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(1089.7421, device='cuda:3')
mal distance is  tensor(17331.6484, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 5e-10
mal norm is  tensor(1121.3179, device='cuda:3')
mal distance is  tensor(18222.2773, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(1119.6698, device='cuda:3')
mal distance is  tensor(18019.9199, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(1132.9218, device='cuda:3')
mal distance is  tensor(18208.9121, device='cuda:3')
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [4, 6]
alphas 3 is [1.   0.25 0.5 ]
alphas is  [0.57142857 0.14285714 0.28571429]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 9.73% 

Test Accuracy: 10.00% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  2.2932019233703613
benign distance is  tensor(1.1462e+08, device='cuda:3')
norm1 res is  tensor(7285238., device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  2.298917531967163
benign distance is  tensor(77913832., device='cuda:3')
norm1 res is  tensor(4844914.5000, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  2.30356502532959
benign distance is  tensor(1.2970e+08, device='cuda:3')
norm1 res is  tensor(8446464., device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  2.292304515838623
benign distance is  tensor(1.0680e+08, device='cuda:3')
norm1 res is  tensor(6656913.5000, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  2.298602342605591
benign distance is  tensor(1.6185e+08, device='cuda:3')
norm1 res is  tensor(10074033., device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  2.310133695602417
benign distance is  tensor(89966896., device='cuda:3')
norm1 res is  tensor(5599363., device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  2.2956748008728027
benign distance is  tensor(1.1893e+08, device='cuda:3')
norm1 res is  tensor(7719779.5000, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  2.304698944091797
benign distance is  tensor(1.2527e+08, device='cuda:3')
norm1 res is  tensor(7480612., device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  2.334712505340576
benign distance is  tensor(1.6216e+08, device='cuda:3')
norm1 res is  tensor(10426596., device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  2.314906120300293
benign distance is  tensor(1.3464e+08, device='cuda:3')
norm1 res is  tensor(8579684., device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  2.2891831398010254
benign distance is  tensor(1.0424e+08, device='cuda:3')
norm1 res is  tensor(6196707.5000, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  2.304654598236084
benign distance is  tensor(1.3465e+08, device='cuda:3')
norm1 res is  tensor(8541590., device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  2.3188140392303467
benign distance is  tensor(1.1134e+08, device='cuda:3')
norm1 res is  tensor(6669383.5000, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  2.2953715324401855
benign distance is  tensor(1.2822e+08, device='cuda:3')
norm1 res is  tensor(8231383.5000, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  2.298271894454956
benign distance is  tensor(1.4751e+08, device='cuda:3')
norm1 res is  tensor(9357977., device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  2.288419246673584
benign distance is  tensor(94140616., device='cuda:3')
norm1 res is  tensor(5716556., device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  2.3436553478240967
benign distance is  tensor(1.6393e+08, device='cuda:3')
norm1 res is  tensor(10698788., device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  2.3175246715545654
benign distance is  tensor(1.1776e+08, device='cuda:3')
norm1 res is  tensor(7503296., device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  2.27878999710083
benign distance is  tensor(1.0035e+08, device='cuda:3')
norm1 res is  tensor(6210554., device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  2.348778009414673
benign distance is  tensor(99348088., device='cuda:3')
norm1 res is  tensor(6122019., device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  2.291257381439209
benign distance is  tensor(1.5997e+08, device='cuda:3')
norm1 res is  tensor(10163612., device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  2.2840185165405273
benign distance is  tensor(1.1672e+08, device='cuda:3')
norm1 res is  tensor(7126823.5000, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  2.340595245361328
benign distance is  tensor(1.4911e+08, device='cuda:3')
norm1 res is  tensor(9625553., device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 5e-10
mal norm is  tensor(49342.9297, device='cuda:3')
mal distance is  tensor(704216.6250, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 5e-10
mal norm is  tensor(49054.6836, device='cuda:3')
mal distance is  tensor(693694.1875, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.10000000049999999
mal norm is  tensor(49364.1992, device='cuda:3')
mal distance is  tensor(705311.8750, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 5e-10
mal norm is  tensor(49057.0977, device='cuda:3')
mal distance is  tensor(692485.5000, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 5e-10
mal norm is  tensor(49909.7773, device='cuda:3')
mal distance is  tensor(703430.5000, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 5e-10
mal norm is  tensor(49905.1328, device='cuda:3')
mal distance is  tensor(705357.1250, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 5e-10
mal norm is  tensor(48989.1680, device='cuda:3')
mal distance is  tensor(690740.6250, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 5e-10
mal norm is  tensor(50037.1797, device='cuda:3')
mal distance is  tensor(704556.9375, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 5e-10
mal norm is  tensor(50120.7266, device='cuda:3')
mal distance is  tensor(706421.8125, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 5e-10
mal norm is  tensor(50602.9766, device='cuda:3')
mal distance is  tensor(704891.6875, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 5e-10
mal norm is  tensor(49256.3477, device='cuda:3')
mal distance is  tensor(700270.6250, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 5e-10
mal norm is  tensor(48852.6680, device='cuda:3')
mal distance is  tensor(698100.8125, device='cuda:3')
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [6]
alphas 3 is [1.         0.33333333]
alphas is  [0.75 0.25]
median_weights acc is  0.1010000001570001
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 9.86% 

Test Accuracy: 10.00% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [5, 8]
alphas 3 is [1.  0.2 0.5]
alphas is  [0.58823529 0.11764706 0.29411765]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
curent length is  20
the length of epoch_weights is  4
the length of weights_d is  4
alpha 1 is [6, 8, 9, 10]
alphas 3 is [1.         0.16666667 0.25       0.33333333 0.5       ]
alphas is  [0.44444444 0.07407407 0.11111111 0.14814815 0.22222222]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [12]
alphas 3 is [1.  0.5]
alphas is  [0.66666667 0.33333333]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [10, 12]
alphas 3 is [1.         0.2        0.33333333]
alphas is  [0.65217391 0.13043478 0.2173913 ]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [12, 14]
alphas 3 is [1.   0.25 0.5 ]
alphas is  [0.57142857 0.14285714 0.28571429]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
curent length is  20
the length of epoch_weights is  3
the length of weights_d is  3
alpha 1 is [12, 15, 16]
alphas 3 is [1.         0.16666667 0.33333333 0.5       ]
alphas is  [0.5        0.08333333 0.16666667 0.25      ]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
curent length is  20
the length of epoch_weights is  3
the length of weights_d is  3
alpha 1 is [15, 16, 18]
alphas 3 is [1.   0.2  0.25 0.5 ]
alphas is  [0.51282051 0.1025641  0.12820513 0.25641026]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [18]
alphas 3 is [1.         0.33333333]
alphas is  [0.75 0.25]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [20]
alphas 3 is [1.  0.5]
alphas is  [0.66666667 0.33333333]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
curent length is  20
the length of epoch_weights is  4
the length of weights_d is  4
alpha 1 is [18, 20, 21, 22]
alphas 3 is [1.         0.16666667 0.25       0.33333333 0.5       ]
alphas is  [0.44444444 0.07407407 0.11111111 0.14814815 0.22222222]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  40 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  41 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  42 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  43 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  44 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  45 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  46 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  47 6
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [20]
alphas 3 is [1.  0.2]
alphas is  [0.83333333 0.16666667]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  32 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  33 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  34 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  35 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  36 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  37 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  38 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  39 5
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [24]
alphas 3 is [1.  0.5]
alphas is  [0.66666667 0.33333333]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [24]
alphas 3 is [1.         0.33333333]
alphas is  [0.75 0.25]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  16 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  17 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  18 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  19 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  20 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  21 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  22 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  23 3
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [24, 26]
alphas 3 is [1.   0.25 0.5 ]
alphas is  [0.57142857 0.14285714 0.28571429]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  8 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  9 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  10 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  11 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  12 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  13 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  14 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  15 2
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  24 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  25 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  26 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  27 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  28 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  29 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  30 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  31 4
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  1 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  2 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  3 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  4 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  5 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  6 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  7 1
grad,shape is torch.Size([215370])
 benign loss is  nan
benign distance is  tensor(nan, device='cuda:3')
norm1 res is  tensor(nan, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
all_updates shape is  torch.Size([12, 215370])
n_attacker is  12
mal_vec shape is  torch.Size([12, 215370])
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
grad,shape is torch.Size([215370])
mal_acc is 0.050000000499999996
mal norm is  tensor(nan, device='cuda:3')
mal distance is  tensor(nan, device='cuda:3')
curent length is  20
the length of epoch_weights is  4
the length of weights_d is  4
alpha 1 is [24, 25, 27, 28]
alphas 3 is [1.         0.16666667 0.2        0.33333333 0.5       ]
alphas is  [0.45454545 0.07575758 0.09090909 0.15151515 0.22727273]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 9.71% 

Test Accuracy: 10.00% 

 
 Results after 30 global rounds of training:
|---- Avg testing Accuracy across each device's data: 9.71%
|----0th round Training Accuracy : 89.33%
|----1th round Training Accuracy : 89.02%
|----2th round Training Accuracy : 88.91%
|----3th round Training Accuracy : 88.75%
|----4th round Training Accuracy : 88.95%
|----5th round Training Accuracy : 89.11%
|----6th round Training Accuracy : 13.67%
|----7th round Training Accuracy : 9.73%
|----8th round Training Accuracy : 9.86%
|----9th round Training Accuracy : 9.71%
|----10th round Training Accuracy : 9.71%
|----11th round Training Accuracy : 9.71%
|----12th round Training Accuracy : 9.71%
|----13th round Training Accuracy : 9.71%
|----14th round Training Accuracy : 9.71%
|----15th round Training Accuracy : 9.71%
|----16th round Training Accuracy : 9.71%
|----17th round Training Accuracy : 9.71%
|----18th round Training Accuracy : 9.71%
|----19th round Training Accuracy : 9.71%
|----20th round Training Accuracy : 9.71%
|----21th round Training Accuracy : 9.71%
|----22th round Training Accuracy : 9.71%
|----23th round Training Accuracy : 9.71%
|----24th round Training Accuracy : 9.71%
|----25th round Training Accuracy : 9.71%
|----26th round Training Accuracy : 9.71%
|----27th round Training Accuracy : 9.71%
|----28th round Training Accuracy : 9.71%
|----29th round Training Accuracy : 9.71%
|----Final Test Accuracy: 10.00%
|----0th round Final Test Accuracy : 88.65%
|----1th round Final Test Accuracy : 88.47%
|----2th round Final Test Accuracy : 88.36%
|----3th round Final Test Accuracy : 88.17%
|----4th round Final Test Accuracy : 87.99%
|----5th round Final Test Accuracy : 88.23%
|----6th round Final Test Accuracy : 13.19%
|----7th round Final Test Accuracy : 10.00%
|----8th round Final Test Accuracy : 10.00%
|----9th round Final Test Accuracy : 10.00%
|----10th round Final Test Accuracy : 10.00%
|----11th round Final Test Accuracy : 10.00%
|----12th round Final Test Accuracy : 10.00%
|----13th round Final Test Accuracy : 10.00%
|----14th round Final Test Accuracy : 10.00%
|----15th round Final Test Accuracy : 10.00%
|----16th round Final Test Accuracy : 10.00%
|----17th round Final Test Accuracy : 10.00%
|----18th round Final Test Accuracy : 10.00%
|----19th round Final Test Accuracy : 10.00%
|----20th round Final Test Accuracy : 10.00%
|----21th round Final Test Accuracy : 10.00%
|----22th round Final Test Accuracy : 10.00%
|----23th round Final Test Accuracy : 10.00%
|----24th round Final Test Accuracy : 10.00%
|----25th round Final Test Accuracy : 10.00%
|----26th round Final Test Accuracy : 10.00%
|----27th round Final Test Accuracy : 10.00%
|----28th round Final Test Accuracy : 10.00%
|----29th round Final Test Accuracy : 10.00%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 30

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 1929.5262
