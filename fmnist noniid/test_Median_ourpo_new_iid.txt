
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 30

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3376077711582184
benign distance is  tensor(121.5696, device='cuda:3')
norm1 res is  tensor(0.1371, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.5712725520133972
benign distance is  tensor(123.3119, device='cuda:3')
norm1 res is  tensor(0.1445, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.6941438913345337
benign distance is  tensor(125.2438, device='cuda:3')
norm1 res is  tensor(0.1424, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.49068108201026917
benign distance is  tensor(112.2996, device='cuda:3')
norm1 res is  tensor(0.1276, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.7076507806777954
benign distance is  tensor(113.6376, device='cuda:3')
norm1 res is  tensor(0.1315, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.45190587639808655
benign distance is  tensor(122.9278, device='cuda:3')
norm1 res is  tensor(0.1405, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.9998615384101868
benign distance is  tensor(130.3735, device='cuda:3')
norm1 res is  tensor(0.1485, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.36729902029037476
benign distance is  tensor(122.9840, device='cuda:3')
norm1 res is  tensor(0.1461, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.3517957925796509
benign distance is  tensor(138.9762, device='cuda:3')
norm1 res is  tensor(0.1611, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.38158005475997925
benign distance is  tensor(138.4961, device='cuda:3')
norm1 res is  tensor(0.1580, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.47383469343185425
benign distance is  tensor(118.8482, device='cuda:3')
norm1 res is  tensor(0.1388, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.4456664025783539
benign distance is  tensor(127.4036, device='cuda:3')
norm1 res is  tensor(0.1490, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.5357704758644104
benign distance is  tensor(124.5033, device='cuda:3')
norm1 res is  tensor(0.1440, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.27908164262771606
benign distance is  tensor(142.3461, device='cuda:3')
norm1 res is  tensor(0.1627, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.7559681534767151
benign distance is  tensor(138.8337, device='cuda:3')
norm1 res is  tensor(0.1596, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.38623881340026855
benign distance is  tensor(136.6377, device='cuda:3')
norm1 res is  tensor(0.1556, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.20335368812084198
benign distance is  tensor(127.6282, device='cuda:3')
norm1 res is  tensor(0.1450, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.8197975158691406
benign distance is  tensor(144.1137, device='cuda:3')
norm1 res is  tensor(0.1670, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.40375199913978577
benign distance is  tensor(125.9596, device='cuda:3')
norm1 res is  tensor(0.1475, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.641274631023407
benign distance is  tensor(121.2735, device='cuda:3')
norm1 res is  tensor(0.1429, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.17208831012248993
benign distance is  tensor(129.8308, device='cuda:3')
norm1 res is  tensor(0.1483, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.27489399909973145
benign distance is  tensor(120.7205, device='cuda:3')
norm1 res is  tensor(0.1384, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.2825258672237396
benign distance is  tensor(137.6870, device='cuda:3')
norm1 res is  tensor(0.1605, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.9566537141799927
benign distance is  tensor(134.0062, device='cuda:3')
norm1 res is  tensor(0.1500, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.6939713358879089
benign distance is  tensor(143.8074, device='cuda:3')
norm1 res is  tensor(0.1661, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.6839929819107056
benign distance is  tensor(123.5520, device='cuda:3')
norm1 res is  tensor(0.1383, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.9702693819999695
benign distance is  tensor(143.3094, device='cuda:3')
norm1 res is  tensor(0.1640, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.1870669424533844
benign distance is  tensor(139.7080, device='cuda:3')
norm1 res is  tensor(0.1550, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.5863841772079468
benign distance is  tensor(127.3059, device='cuda:3')
norm1 res is  tensor(0.1467, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.801973819732666
benign distance is  tensor(139.4867, device='cuda:3')
norm1 res is  tensor(0.1624, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.403952032327652
benign distance is  tensor(123.3767, device='cuda:3')
norm1 res is  tensor(0.1448, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.9976159930229187
benign distance is  tensor(130.9905, device='cuda:3')
norm1 res is  tensor(0.1565, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.5708374381065369
benign distance is  tensor(132.5796, device='cuda:3')
norm1 res is  tensor(0.1511, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.22811730206012726
benign distance is  tensor(124.1352, device='cuda:3')
norm1 res is  tensor(0.1415, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.5657156109809875
benign distance is  tensor(136.8654, device='cuda:3')
norm1 res is  tensor(0.1586, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.06075110286474228
benign distance is  tensor(124.6695, device='cuda:3')
norm1 res is  tensor(0.1417, device='cuda:3')
current submit client idx and staleness is  36 5

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 30

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  8
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
 benign loss is  0.35292482376098633
benign distance is  tensor(106.4332, device='cuda:3')
norm1 res is  tensor(0.1220, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.4825380742549896
benign distance is  tensor(114.3504, device='cuda:3')
norm1 res is  tensor(0.1349, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.5173353552818298
benign distance is  tensor(124.7406, device='cuda:3')
norm1 res is  tensor(0.1437, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.7450876235961914
benign distance is  tensor(114.5904, device='cuda:3')
norm1 res is  tensor(0.1297, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.9453929662704468
benign distance is  tensor(107.6313, device='cuda:3')
norm1 res is  tensor(0.1272, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.37752214074134827
benign distance is  tensor(126.7158, device='cuda:3')
norm1 res is  tensor(0.1484, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.6903331875801086
benign distance is  tensor(109.1694, device='cuda:3')
norm1 res is  tensor(0.1251, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.16559556126594543
benign distance is  tensor(121.9827, device='cuda:3')
norm1 res is  tensor(0.1442, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.22992758452892303
benign distance is  tensor(135.3295, device='cuda:3')
norm1 res is  tensor(0.1554, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.49020567536354065
benign distance is  tensor(140.0975, device='cuda:3')
norm1 res is  tensor(0.1581, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.32269006967544556
benign distance is  tensor(127.5712, device='cuda:3')
norm1 res is  tensor(0.1484, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.5197402238845825
benign distance is  tensor(126.6799, device='cuda:3')
norm1 res is  tensor(0.1460, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.4531685709953308
benign distance is  tensor(125.0250, device='cuda:3')
norm1 res is  tensor(0.1443, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.39162585139274597
benign distance is  tensor(143.4577, device='cuda:3')
norm1 res is  tensor(0.1655, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  1.0215420722961426
benign distance is  tensor(134.1720, device='cuda:3')
norm1 res is  tensor(0.1562, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.394559770822525
benign distance is  tensor(146.9647, device='cuda:3')
norm1 res is  tensor(0.1664, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.226517915725708
benign distance is  tensor(129.5647, device='cuda:3')
norm1 res is  tensor(0.1488, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  1.041935920715332
benign distance is  tensor(152.4812, device='cuda:3')
norm1 res is  tensor(0.1784, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.884502112865448
benign distance is  tensor(126.2082, device='cuda:3')
norm1 res is  tensor(0.1504, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.6413516998291016
benign distance is  tensor(125.1790, device='cuda:3')
norm1 res is  tensor(0.1492, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.19368687272071838
benign distance is  tensor(126.6611, device='cuda:3')
norm1 res is  tensor(0.1457, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.31894177198410034
benign distance is  tensor(130.1891, device='cuda:3')
norm1 res is  tensor(0.1493, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.4314400553703308
benign distance is  tensor(140.6463, device='cuda:3')
norm1 res is  tensor(0.1627, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  1.0261762142181396
benign distance is  tensor(133.9390, device='cuda:3')
norm1 res is  tensor(0.1493, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.33230650424957275
benign distance is  tensor(137.6804, device='cuda:3')
norm1 res is  tensor(0.1596, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.8101205825805664
benign distance is  tensor(124.7300, device='cuda:3')
norm1 res is  tensor(0.1382, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.7697247266769409
benign distance is  tensor(142.0572, device='cuda:3')
norm1 res is  tensor(0.1595, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.36469942331314087
benign distance is  tensor(134.3241, device='cuda:3')
norm1 res is  tensor(0.1502, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  1.001144289970398
benign distance is  tensor(125.6000, device='cuda:3')
norm1 res is  tensor(0.1444, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.9327579736709595
benign distance is  tensor(135.8125, device='cuda:3')
norm1 res is  tensor(0.1582, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.5196936726570129
benign distance is  tensor(122.7356, device='cuda:3')
norm1 res is  tensor(0.1434, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.8847716450691223
benign distance is  tensor(132.8113, device='cuda:3')
norm1 res is  tensor(0.1559, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.33808061480522156
benign distance is  tensor(132.8885, device='cuda:3')
norm1 res is  tensor(0.1531, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.21730594336986542
benign distance is  tensor(128.9080, device='cuda:3')
norm1 res is  tensor(0.1485, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.3836672604084015
benign distance is  tensor(135.8701, device='cuda:3')
norm1 res is  tensor(0.1595, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.08614765107631683
benign distance is  tensor(122.7834, device='cuda:3')
norm1 res is  tensor(0.1412, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.4646877348423004
benign distance is  tensor(130.3016, device='cuda:3')
norm1 res is  tensor(0.1509, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.3253141939640045
benign distance is  tensor(129.9839, device='cuda:3')
norm1 res is  tensor(0.1502, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.5168893337249756
benign distance is  tensor(121.8157, device='cuda:3')
norm1 res is  tensor(0.1426, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.2589670419692993
benign distance is  tensor(124.7229, device='cuda:3')
norm1 res is  tensor(0.1430, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.07342905551195145
benign distance is  tensor(132.2665, device='cuda:3')
norm1 res is  tensor(0.1520, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.455371230840683
benign distance is  tensor(121.5156, device='cuda:3')
norm1 res is  tensor(0.1393, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.2723161578178406
benign distance is  tensor(129.8042, device='cuda:3')
norm1 res is  tensor(0.1466, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.25806960463523865
benign distance is  tensor(135.9693, device='cuda:3')
norm1 res is  tensor(0.1554, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.4980030059814453
benign distance is  tensor(137.4718, device='cuda:3')
norm1 res is  tensor(0.1599, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.788984477519989
benign distance is  tensor(131.9730, device='cuda:3')
norm1 res is  tensor(0.1471, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.7153486013412476
benign distance is  tensor(134.8908, device='cuda:3')
norm1 res is  tensor(0.1539, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.09025435149669647
benign distance is  tensor(139.5662, device='cuda:3')
norm1 res is  tensor(0.1616, device='cuda:3')
current submit client idx and staleness is  48 1
 benign loss is  0.12221956253051758
benign distance is  tensor(106.6696, device='cuda:3')
norm1 res is  tensor(0.1263, device='cuda:3')
current submit client idx and staleness is  49 1
 benign loss is  0.5209795236587524
benign distance is  tensor(108.5126, device='cuda:3')
norm1 res is  tensor(0.1272, device='cuda:3')
current submit client idx and staleness is  50 1
 benign loss is  0.5517446994781494
benign distance is  tensor(124.9215, device='cuda:3')
norm1 res is  tensor(0.1430, device='cuda:3')
current submit client idx and staleness is  51 1
 benign loss is  0.23824019730091095
benign distance is  tensor(121.8895, device='cuda:3')
norm1 res is  tensor(0.1416, device='cuda:3')
current submit client idx and staleness is  52 1
 benign loss is  0.5045163035392761
benign distance is  tensor(121.4354, device='cuda:3')
norm1 res is  tensor(0.1434, device='cuda:3')
current submit client idx and staleness is  53 1
 benign loss is  0.44427284598350525
benign distance is  tensor(127.8575, device='cuda:3')
norm1 res is  tensor(0.1514, device='cuda:3')
current submit client idx and staleness is  54 1
 benign loss is  0.027422431856393814
benign distance is  tensor(128.3586, device='cuda:3')
norm1 res is  tensor(0.1495, device='cuda:3')
current submit client idx and staleness is  55 1
 benign loss is  0.3572012186050415
benign distance is  tensor(108.7011, device='cuda:3')
norm1 res is  tensor(0.1223, device='cuda:3')
current submit client idx and staleness is  56 1
 benign loss is  0.3883393406867981
benign distance is  tensor(123.0423, device='cuda:3')
norm1 res is  tensor(0.1448, device='cuda:3')
current submit client idx and staleness is  57 1
 benign loss is  0.8640776872634888
benign distance is  tensor(111.9194, device='cuda:3')
norm1 res is  tensor(0.1265, device='cuda:3')
current submit client idx and staleness is  58 1
 benign loss is  0.2954772114753723
benign distance is  tensor(120.5437, device='cuda:3')
norm1 res is  tensor(0.1398, device='cuda:3')
current submit client idx and staleness is  59 1
 benign loss is  0.4102594256401062
benign distance is  tensor(126.4544, device='cuda:3')
norm1 res is  tensor(0.1489, device='cuda:3')
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
median_weights acc is  0.8782000001569995
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 89.36% 

Test Accuracy: 88.67% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
 benign loss is  0.2307504117488861
benign distance is  tensor(109.1227, device='cuda:3')
norm1 res is  tensor(0.1309, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.4114719033241272
benign distance is  tensor(113.4253, device='cuda:3')
norm1 res is  tensor(0.1337, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.24421052634716034
benign distance is  tensor(131.8934, device='cuda:3')
norm1 res is  tensor(0.1497, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  1.181722640991211
benign distance is  tensor(109.9178, device='cuda:3')
norm1 res is  tensor(0.1267, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.5322272181510925
benign distance is  tensor(111.8160, device='cuda:3')
norm1 res is  tensor(0.1273, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.5824283361434937
benign distance is  tensor(122.4574, device='cuda:3')
norm1 res is  tensor(0.1424, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.3955739140510559
benign distance is  tensor(113.6665, device='cuda:3')
norm1 res is  tensor(0.1292, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.284819096326828
benign distance is  tensor(126.7855, device='cuda:3')
norm1 res is  tensor(0.1476, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
curent length is  8
the length of epoch_weights is  1
alpha 1 is [0]
alphas 3 is [1.  0.5]
alphas is  [0.66666667 0.33333333]
median_weights acc is  0.8708000001569995
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 89.00% 

Test Accuracy: 88.22% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
 benign loss is  0.48637399077415466
benign distance is  tensor(104.3643, device='cuda:3')
norm1 res is  tensor(0.1226, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.8986091613769531
benign distance is  tensor(128.1160, device='cuda:3')
norm1 res is  tensor(0.1508, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.29787692427635193
benign distance is  tensor(117.5417, device='cuda:3')
norm1 res is  tensor(0.1327, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.5607848763465881
benign distance is  tensor(116.3334, device='cuda:3')
norm1 res is  tensor(0.1325, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.11873297393321991
benign distance is  tensor(89.9035, device='cuda:3')
norm1 res is  tensor(0.1024, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.5129320621490479
benign distance is  tensor(126.3598, device='cuda:3')
norm1 res is  tensor(0.1472, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.450282484292984
benign distance is  tensor(117.4369, device='cuda:3')
norm1 res is  tensor(0.1350, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.23455993831157684
benign distance is  tensor(116.4762, device='cuda:3')
norm1 res is  tensor(0.1368, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.19879069924354553
benign distance is  tensor(140.5594, device='cuda:3')
norm1 res is  tensor(0.1621, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.726897120475769
benign distance is  tensor(130.6236, device='cuda:3')
norm1 res is  tensor(0.1498, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.38238033652305603
benign distance is  tensor(126.3990, device='cuda:3')
norm1 res is  tensor(0.1445, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.9038777351379395
benign distance is  tensor(120.2976, device='cuda:3')
norm1 res is  tensor(0.1395, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.9466766119003296
benign distance is  tensor(124.1370, device='cuda:3')
norm1 res is  tensor(0.1423, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.41914862394332886
benign distance is  tensor(130.7821, device='cuda:3')
norm1 res is  tensor(0.1487, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.7442106604576111
benign distance is  tensor(135.7267, device='cuda:3')
norm1 res is  tensor(0.1594, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.5045068264007568
benign distance is  tensor(128.6477, device='cuda:3')
norm1 res is  tensor(0.1502, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
curent length is  8
the length of epoch_weights is  1
alpha 1 is [0]
alphas 3 is [1.         0.33333333]
alphas is  [0.75 0.25]
median_weights acc is  0.8714000001569995
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 89.07% 

Test Accuracy: 88.33% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
 benign loss is  0.4820018410682678
benign distance is  tensor(105.9226, device='cuda:3')
norm1 res is  tensor(0.1238, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.8433469533920288
benign distance is  tensor(115.2633, device='cuda:3')
norm1 res is  tensor(0.1321, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.13756240904331207
benign distance is  tensor(115.5735, device='cuda:3')
norm1 res is  tensor(0.1339, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.6425126194953918
benign distance is  tensor(101.2797, device='cuda:3')
norm1 res is  tensor(0.1153, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.4750593602657318
benign distance is  tensor(101.8575, device='cuda:3')
norm1 res is  tensor(0.1143, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.7240709066390991
benign distance is  tensor(115.1500, device='cuda:3')
norm1 res is  tensor(0.1343, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.15895910561084747
benign distance is  tensor(117.7478, device='cuda:3')
norm1 res is  tensor(0.1333, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  1.3730589151382446
benign distance is  tensor(111.7932, device='cuda:3')
norm1 res is  tensor(0.1310, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.5115770101547241
benign distance is  tensor(120.5707, device='cuda:3')
norm1 res is  tensor(0.1380, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.43272027373313904
benign distance is  tensor(139.2600, device='cuda:3')
norm1 res is  tensor(0.1606, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.6415938138961792
benign distance is  tensor(127.0600, device='cuda:3')
norm1 res is  tensor(0.1439, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.3637194037437439
benign distance is  tensor(120.8298, device='cuda:3')
norm1 res is  tensor(0.1417, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.25573262572288513
benign distance is  tensor(134.6112, device='cuda:3')
norm1 res is  tensor(0.1550, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.8865798115730286
benign distance is  tensor(118.2185, device='cuda:3')
norm1 res is  tensor(0.1374, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.3182244896888733
benign distance is  tensor(124.9836, device='cuda:3')
norm1 res is  tensor(0.1478, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.6359723210334778
benign distance is  tensor(129.7679, device='cuda:3')
norm1 res is  tensor(0.1461, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
curent length is  8
the length of epoch_weights is  2
alpha 1 is [0, 2]
alphas 3 is [1.   0.25 0.5 ]
alphas is  [0.57142857 0.14285714 0.28571429]
median_weights acc is  0.8748000001569995
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 88.96% 

Test Accuracy: 88.25% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8883693814277649
benign distance is  tensor(97.9349, device='cuda:3')
norm1 res is  tensor(0.1158, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.8518055081367493
benign distance is  tensor(112.7959, device='cuda:3')
norm1 res is  tensor(0.1320, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.2570030987262726
benign distance is  tensor(123.8923, device='cuda:3')
norm1 res is  tensor(0.1418, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.20798620581626892
benign distance is  tensor(99.9146, device='cuda:3')
norm1 res is  tensor(0.1120, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.9330035448074341
benign distance is  tensor(91.5779, device='cuda:3')
norm1 res is  tensor(0.1062, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.9419109225273132
benign distance is  tensor(116.6076, device='cuda:3')
norm1 res is  tensor(0.1355, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.25298696756362915
benign distance is  tensor(106.6547, device='cuda:3')
norm1 res is  tensor(0.1210, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.3900211751461029
benign distance is  tensor(108.8583, device='cuda:3')
norm1 res is  tensor(0.1299, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.38430872559547424
benign distance is  tensor(135.8141, device='cuda:3')
norm1 res is  tensor(0.1561, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.2405218631029129
benign distance is  tensor(135.1349, device='cuda:3')
norm1 res is  tensor(0.1554, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.9923537969589233
benign distance is  tensor(125.6342, device='cuda:3')
norm1 res is  tensor(0.1423, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.8775236010551453
benign distance is  tensor(123.5960, device='cuda:3')
norm1 res is  tensor(0.1405, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.46282100677490234
benign distance is  tensor(117.0182, device='cuda:3')
norm1 res is  tensor(0.1374, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.13441696763038635
benign distance is  tensor(130.4201, device='cuda:3')
norm1 res is  tensor(0.1474, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.7196407318115234
benign distance is  tensor(132.0475, device='cuda:3')
norm1 res is  tensor(0.1556, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.3058563768863678
benign distance is  tensor(126.2867, device='cuda:3')
norm1 res is  tensor(0.1458, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.14351721107959747
benign distance is  tensor(143.2355, device='cuda:3')
norm1 res is  tensor(0.1678, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.7048900723457336
benign distance is  tensor(121.5997, device='cuda:3')
norm1 res is  tensor(0.1393, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.4616168141365051
benign distance is  tensor(135.7490, device='cuda:3')
norm1 res is  tensor(0.1597, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.95655757188797
benign distance is  tensor(129.6449, device='cuda:3')
norm1 res is  tensor(0.1509, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  1.2414753437042236
benign distance is  tensor(124.6315, device='cuda:3')
norm1 res is  tensor(0.1426, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.7101272344589233
benign distance is  tensor(129.6480, device='cuda:3')
norm1 res is  tensor(0.1503, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.554857611656189
benign distance is  tensor(116.7255, device='cuda:3')
norm1 res is  tensor(0.1357, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.38913819193840027
benign distance is  tensor(131.1337, device='cuda:3')
norm1 res is  tensor(0.1558, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
curent length is  8
the length of epoch_weights is  1
alpha 1 is [0]
alphas 3 is [1.  0.2]
alphas is  [0.83333333 0.16666667]
median_weights acc is  0.8749000001569995
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 89.04% 

Test Accuracy: 88.08% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
 benign loss is  0.27162227034568787
benign distance is  tensor(109.1243, device='cuda:3')
norm1 res is  tensor(0.1332, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.8318770527839661
benign distance is  tensor(116.7935, device='cuda:3')
norm1 res is  tensor(0.1364, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.9424942135810852
benign distance is  tensor(123.9060, device='cuda:3')
norm1 res is  tensor(0.1468, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.6454702615737915
benign distance is  tensor(97.6396, device='cuda:3')
norm1 res is  tensor(0.1107, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.3716196119785309
benign distance is  tensor(96.7584, device='cuda:3')
norm1 res is  tensor(0.1101, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.46435222029685974
benign distance is  tensor(113.5639, device='cuda:3')
norm1 res is  tensor(0.1310, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.3799766004085541
benign distance is  tensor(114.8250, device='cuda:3')
norm1 res is  tensor(0.1328, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.5043918490409851
benign distance is  tensor(106.9953, device='cuda:3')
norm1 res is  tensor(0.1250, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.3980044424533844
benign distance is  tensor(140.6381, device='cuda:3')
norm1 res is  tensor(0.1606, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.12345071136951447
benign distance is  tensor(121.9454, device='cuda:3')
norm1 res is  tensor(0.1439, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.5438235998153687
benign distance is  tensor(136.3493, device='cuda:3')
norm1 res is  tensor(0.1606, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.08358890563249588
benign distance is  tensor(126.2087, device='cuda:3')
norm1 res is  tensor(0.1466, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.4779341220855713
benign distance is  tensor(132.7234, device='cuda:3')
norm1 res is  tensor(0.1529, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.17984238266944885
benign distance is  tensor(124.8960, device='cuda:3')
norm1 res is  tensor(0.1435, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.9077004194259644
benign distance is  tensor(119.5834, device='cuda:3')
norm1 res is  tensor(0.1455, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.03390759229660034
benign distance is  tensor(121.3660, device='cuda:3')
norm1 res is  tensor(0.1412, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
curent length is  8
the length of epoch_weights is  3
alpha 1 is [0, 3, 4]
alphas 3 is [1.         0.16666667 0.33333333 0.5       ]
alphas is  [0.5        0.08333333 0.16666667 0.25      ]
median_weights acc is  0.8734000001569995
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 89.04% 

Test Accuracy: 88.15% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
 benign loss is  0.4499177038669586
benign distance is  tensor(104.7737, device='cuda:3')
norm1 res is  tensor(0.1229, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.3944797217845917
benign distance is  tensor(112.0206, device='cuda:3')
norm1 res is  tensor(0.1287, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.5703402757644653
benign distance is  tensor(114.9160, device='cuda:3')
norm1 res is  tensor(0.1294, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.42462897300720215
benign distance is  tensor(96.8787, device='cuda:3')
norm1 res is  tensor(0.1085, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.43814048171043396
benign distance is  tensor(105.3770, device='cuda:3')
norm1 res is  tensor(0.1252, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.3258778750896454
benign distance is  tensor(108.6336, device='cuda:3')
norm1 res is  tensor(0.1252, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.28868016600608826
benign distance is  tensor(95.3373, device='cuda:3')
norm1 res is  tensor(0.1073, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.16236978769302368
benign distance is  tensor(114.1850, device='cuda:3')
norm1 res is  tensor(0.1336, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.3810320496559143
benign distance is  tensor(124.8137, device='cuda:3')
norm1 res is  tensor(0.1439, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.4369587302207947
benign distance is  tensor(118.8967, device='cuda:3')
norm1 res is  tensor(0.1372, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.17198534309864044
benign distance is  tensor(116.1106, device='cuda:3')
norm1 res is  tensor(0.1355, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.8109679222106934
benign distance is  tensor(133.3247, device='cuda:3')
norm1 res is  tensor(0.1528, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.22050245106220245
benign distance is  tensor(110.1413, device='cuda:3')
norm1 res is  tensor(0.1307, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.27692776918411255
benign distance is  tensor(128.0630, device='cuda:3')
norm1 res is  tensor(0.1457, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.4312557280063629
benign distance is  tensor(127.7500, device='cuda:3')
norm1 res is  tensor(0.1510, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.5029689073562622
benign distance is  tensor(126.0698, device='cuda:3')
norm1 res is  tensor(0.1458, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.14720231294631958
benign distance is  tensor(133.9140, device='cuda:3')
norm1 res is  tensor(0.1503, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.5125304460525513
benign distance is  tensor(146.6791, device='cuda:3')
norm1 res is  tensor(0.1708, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.29569920897483826
benign distance is  tensor(116.5186, device='cuda:3')
norm1 res is  tensor(0.1361, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.09413443505764008
benign distance is  tensor(112.8435, device='cuda:3')
norm1 res is  tensor(0.1339, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.2692703604698181
benign distance is  tensor(126.0744, device='cuda:3')
norm1 res is  tensor(0.1491, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.38093113899230957
benign distance is  tensor(120.7636, device='cuda:3')
norm1 res is  tensor(0.1368, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.042645297944545746
benign distance is  tensor(138.1824, device='cuda:3')
norm1 res is  tensor(0.1640, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.4681212306022644
benign distance is  tensor(120.5539, device='cuda:3')
norm1 res is  tensor(0.1369, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.10274207592010498
benign distance is  tensor(121.4201, device='cuda:3')
norm1 res is  tensor(0.1410, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.19804814457893372
benign distance is  tensor(123.1695, device='cuda:3')
norm1 res is  tensor(0.1436, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.15618404746055603
benign distance is  tensor(128.1554, device='cuda:3')
norm1 res is  tensor(0.1478, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.33385100960731506
benign distance is  tensor(127.6229, device='cuda:3')
norm1 res is  tensor(0.1460, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.8119488954544067
benign distance is  tensor(124.3820, device='cuda:3')
norm1 res is  tensor(0.1409, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.7361174821853638
benign distance is  tensor(127.5200, device='cuda:3')
norm1 res is  tensor(0.1455, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.9738569259643555
benign distance is  tensor(128.2462, device='cuda:3')
norm1 res is  tensor(0.1477, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.32172098755836487
benign distance is  tensor(127.1596, device='cuda:3')
norm1 res is  tensor(0.1496, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(125.1242, device='cuda:3')
compute norm is  tensor(45.9596, device='cuda:3')
compute distance is  tensor(127.0275, device='cuda:3')
compute norm is  tensor(46.0763, device='cuda:3')
compute distance is  tensor(134.0868, device='cuda:3')
compute norm is  tensor(46.3865, device='cuda:3')
compute distance is  tensor(129.3633, device='cuda:3')
compute norm is  tensor(46.1711, device='cuda:3')
compute distance is  tensor(134.2142, device='cuda:3')
compute norm is  tensor(46.2540, device='cuda:3')
compute distance is  tensor(134.6285, device='cuda:3')
compute norm is  tensor(46.2994, device='cuda:3')
compute distance is  tensor(133.7326, device='cuda:3')
compute norm is  tensor(46.3575, device='cuda:3')
compute distance is  tensor(138.7740, device='cuda:3')
compute norm is  tensor(46.3602, device='cuda:3')
compute distance is  tensor(133.2774, device='cuda:3')
compute norm is  tensor(46.2828, device='cuda:3')
compute distance is  tensor(117.9603, device='cuda:3')
compute norm is  tensor(46.0276, device='cuda:3')
compute distance is  tensor(139.9364, device='cuda:3')
compute norm is  tensor(46.5637, device='cuda:3')
compute distance is  tensor(137.3615, device='cuda:3')
compute norm is  tensor(46.2904, device='cuda:3')
batch acc is 0.1022666668229986
batch acc is 0.1011333334896699
batch acc is 0.10075555571189523
batch acc is 0.1005666668230079
batch acc is 0.1004533334896755
batch acc is 0.10037777793411515
batch acc is 0.10032380968013999
batch acc is 0.10028333348965862
batch acc is 0.1002518520081731
batch acc is 0.1002266668229847
mal_rand_acc is 0.1500000005
mal_rand loss is 6.592794040813486e+17
len of model dicts is  12
compute distance is  tensor(125.1242, device='cuda:3')
compute norm is  tensor(45.9596, device='cuda:3')
compute distance is  tensor(127.0275, device='cuda:3')
compute norm is  tensor(46.0763, device='cuda:3')
compute distance is  tensor(134.0868, device='cuda:3')
compute norm is  tensor(46.3865, device='cuda:3')
compute distance is  tensor(129.3633, device='cuda:3')
compute norm is  tensor(46.1711, device='cuda:3')
compute distance is  tensor(134.2142, device='cuda:3')
compute norm is  tensor(46.2540, device='cuda:3')
compute distance is  tensor(134.6285, device='cuda:3')
compute norm is  tensor(46.2994, device='cuda:3')
compute distance is  tensor(133.7326, device='cuda:3')
compute norm is  tensor(46.3575, device='cuda:3')
compute distance is  tensor(138.7740, device='cuda:3')
compute norm is  tensor(46.3602, device='cuda:3')
compute distance is  tensor(133.2774, device='cuda:3')
compute norm is  tensor(46.2828, device='cuda:3')
compute distance is  tensor(117.9603, device='cuda:3')
compute norm is  tensor(46.0276, device='cuda:3')
compute distance is  tensor(139.9364, device='cuda:3')
compute norm is  tensor(46.5637, device='cuda:3')
compute distance is  tensor(137.3615, device='cuda:3')
compute norm is  tensor(46.2904, device='cuda:3')
distance Threshold  is  tensor(139.9364, device='cuda:3')
________________________________
test distance is  tensor(1105792.3750, device='cuda:3')
test similarity is  tensor(-0.1448, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.360000595341321e+17
test entropy is  0.0
________________________________
cal ratio is  0.010124439576032008
cal_distance is  tensor(11195.5352, device='cuda:3')
cal ratio is  0.10062024082493347
cal_distance is  tensor(1126.5042, device='cuda:3')
cal ratio is  0.317206001446832
cal_distance is  tensor(357.3389, device='cuda:3')
cal ratio is  0.5632064793518987
cal_distance is  tensor(201.2588, device='cuda:3')
cal ratio is  0.7504648079610744
cal_distance is  tensor(151.0395, device='cuda:3')
cal ratio is  0.8662883509779085
cal_distance is  tensor(130.8448, device='cuda:3')
________________________________
test distance is  tensor(130.8448, device='cuda:3')
test similarity is  tensor(0.9503, device='cuda:3')
test acc is  0.8891000001563218
test loss is 16.015940443030807
test entropy is  0.03359443510586305
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.034054526297285205
avg test loss is  15.994664272519826
avg accuracy is  0.8893666668229885
solo acc is  0.5231000001563423
compute similarity  is  tensor(0.9503, device='cuda:3')
compute_distance is  tensor(130.8448, device='cuda:3')
compute_norm is  tensor(46.1013, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  0.8660867070592543
avg test loss is  1.4409387170124663
avg accuracy is  0.8596166668229897
solo acc is  0.32561666682300666
compute similarity  is  tensor(0.9515, device='cuda:3')
compute_distance is  tensor(121.9721, device='cuda:3')
compute_norm is  tensor(44.8062, device='cuda:3')
++++++++++++++++++++
distillation for acc
++++++++++++++++++++
after training  2
avg test entropy is  0.8253414431995929
avg test loss is  1.5095346756835482
avg accuracy is  0.8585333334896563
solo acc is  0.2692166668230055
compute similarity  is  tensor(0.9510, device='cuda:3')
compute_distance is  tensor(124.3018, device='cuda:3')
compute_norm is  tensor(44.4687, device='cuda:3')
++++++++++++++++++++
distillation for acc
++++++++++++++++++++
after training  3
avg test entropy is  0.8220551993165698
avg test loss is  1.4383351500354595
avg accuracy is  0.8600166668229897
solo acc is  0.27825000015633905
compute similarity  is  tensor(0.9506, device='cuda:3')
compute_distance is  tensor(126.4063, device='cuda:3')
compute_norm is  tensor(44.1540, device='cuda:3')
++++++++++++++++++++
distillation for acc
++++++++++++++++++++
after training  4
avg test entropy is  0.8073799713715307
avg test loss is  1.4108274762056021
avg accuracy is  0.8633333334896562
solo acc is  0.2744000001563389
compute similarity  is  tensor(0.9503, device='cuda:3')
compute_distance is  tensor(128.3457, device='cuda:3')
compute_norm is  tensor(43.8636, device='cuda:3')
++++++++++++++++++++
distillation for acc
________________________________
test distance is  tensor(130.2684, device='cuda:3')
test similarity is  tensor(0.9499, device='cuda:3')
test acc is  0.8617333334896562
test loss is 1.393698050777541
test entropy is  0.8086465515815882
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.8087007952397312
avg test loss is  1.3939860037394933
avg accuracy is  0.8614833334896563
solo acc is  0.263633333489672
compute similarity  is  tensor(0.9499, device='cuda:3')
compute_distance is  tensor(130.2684, device='cuda:3')
compute_norm is  tensor(43.5864, device='cuda:3')
++++++++++++++++++++
distillation for acc
++++++++++++++++++++
after training  1
avg test entropy is  0.7983547376671325
avg test loss is  1.361698784680763
avg accuracy is  0.8638833334896562
solo acc is  0.26730000015633876
compute similarity  is  tensor(0.9496, device='cuda:3')
compute_distance is  tensor(132.1056, device='cuda:3')
compute_norm is  tensor(43.3214, device='cuda:3')
++++++++++++++++++++
distillation for acc
++++++++++++++++++++
after training  2
avg test entropy is  0.7901262641588508
avg test loss is  1.343693803241258
avg accuracy is  0.8638166668229895
solo acc is  0.26358333348967206
compute similarity  is  tensor(0.9493, device='cuda:3')
compute_distance is  tensor(133.9211, device='cuda:3')
compute_norm is  tensor(43.0659, device='cuda:3')
++++++++++++++++++++
distillation for acc
++++++++++++++++++++
after training  3
avg test entropy is  0.7948058473784277
avg test loss is  1.317532072189266
avg accuracy is  0.8657500001563228
solo acc is  0.2662000001563388
compute similarity  is  tensor(0.9490, device='cuda:3')
compute_distance is  tensor(135.6765, device='cuda:3')
compute_norm is  tensor(42.8168, device='cuda:3')
++++++++++++++++++++
distillation for acc
++++++++++++++++++++
after training  4
avg test entropy is  0.789170007461678
avg test loss is  1.3024523621047739
avg accuracy is  0.8649166668229894
solo acc is  0.26260000015633866
compute similarity  is  tensor(0.9487, device='cuda:3')
compute_distance is  tensor(137.4186, device='cuda:3')
compute_norm is  tensor(42.5766, device='cuda:3')
++++++++++++++++++++
distillation for acc
________________________________
test distance is  tensor(139.0739, device='cuda:3')
test similarity is  tensor(0.9484, device='cuda:3')
test acc is  0.8684000001563226
test loss is 1.2865058718078426
test entropy is  0.7859666627099011
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.7863244299949613
avg test loss is  1.28565286941874
avg accuracy is  0.8666666668229894
solo acc is  0.2620000001563387
compute similarity  is  tensor(0.9484, device='cuda:3')
compute_distance is  tensor(139.0739, device='cuda:3')
compute_norm is  tensor(42.3425, device='cuda:3')
++++++++++++++++++++
distillation for acc
++++++++++++++++++++
after training  1
avg test entropy is  0.7824697429056107
avg test loss is  1.2783986002143257
avg accuracy is  0.8666333334896561
solo acc is  0.2593500001563385
compute similarity  is  tensor(0.9481, device='cuda:3')
compute_distance is  tensor(140.7534, device='cuda:3')
compute_norm is  tensor(42.1152, device='cuda:3')
++++++++++++++++++++
distillation for acc
++++++++++++++++++++
after training  2
avg test entropy is  0.777441638237886
avg test loss is  1.2600041162738922
avg accuracy is  0.8684333334896559
solo acc is  0.2649333334896721
compute similarity  is  tensor(0.9479, device='cuda:3')
compute_distance is  tensor(142.3790, device='cuda:3')
compute_norm is  tensor(41.8908, device='cuda:3')
++++++++++++++++++++
distillation for acc
++++++++++++++++++++
after training  3
avg test entropy is  0.7776673606463841
avg test loss is  1.2539329061757272
avg accuracy is  0.8693833334896559
solo acc is  0.2578333334896719
compute similarity  is  tensor(0.9476, device='cuda:3')
compute_distance is  tensor(144.0227, device='cuda:3')
compute_norm is  tensor(41.6700, device='cuda:3')
++++++++++++++++++++
distillation for acc
++++++++++++++++++++
after training  4
avg test entropy is  0.7772647334314359
avg test loss is  1.2455441602892967
avg accuracy is  0.870633333489656
solo acc is  0.25396666682300506
compute similarity  is  tensor(0.9474, device='cuda:3')
compute_distance is  tensor(145.6690, device='cuda:3')
compute_norm is  tensor(41.4535, device='cuda:3')
++++++++++++++++++++
distillation for acc
________________________________
test distance is  tensor(147.3153, device='cuda:3')
test similarity is  tensor(0.9471, device='cuda:3')
test acc is  0.8711500001563226
test loss is 1.24110344922873
test entropy is  0.7721644869364147
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.0993207693099976
mal norm is  tensor(6.6210, device='cuda:3')
mal distance is  tensor(147.3153, device='cuda:3')
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
median_weights acc is  0.7078000001569986
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 77.55% 

Test Accuracy: 76.23% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
 benign loss is  0.2567972242832184
benign distance is  tensor(132.0420, device='cuda:3')
norm1 res is  tensor(0.1427, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.4853096604347229
benign distance is  tensor(139.2088, device='cuda:3')
norm1 res is  tensor(0.1507, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.6923092007637024
benign distance is  tensor(146.6453, device='cuda:3')
norm1 res is  tensor(0.1598, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.6693915128707886
benign distance is  tensor(131.4802, device='cuda:3')
norm1 res is  tensor(0.1395, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.46705588698387146
benign distance is  tensor(137.0870, device='cuda:3')
norm1 res is  tensor(0.1475, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.41073617339134216
benign distance is  tensor(143.4828, device='cuda:3')
norm1 res is  tensor(0.1565, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.5871412754058838
benign distance is  tensor(134.8678, device='cuda:3')
norm1 res is  tensor(0.1427, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.2580470144748688
benign distance is  tensor(143.2881, device='cuda:3')
norm1 res is  tensor(0.1576, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(168.4608, device='cuda:3')
compute norm is  tensor(46.4839, device='cuda:3')
compute distance is  tensor(163.9974, device='cuda:3')
compute norm is  tensor(46.3257, device='cuda:3')
compute distance is  tensor(182.8954, device='cuda:3')
compute norm is  tensor(47.0383, device='cuda:3')
compute distance is  tensor(163.2870, device='cuda:3')
compute norm is  tensor(46.4011, device='cuda:3')
compute distance is  tensor(165.7896, device='cuda:3')
compute norm is  tensor(46.5181, device='cuda:3')
compute distance is  tensor(161.4759, device='cuda:3')
compute norm is  tensor(46.3672, device='cuda:3')
compute distance is  tensor(163.2191, device='cuda:3')
compute norm is  tensor(46.4721, device='cuda:3')
compute distance is  tensor(178.1210, device='cuda:3')
compute norm is  tensor(46.8369, device='cuda:3')
compute distance is  tensor(170.5750, device='cuda:3')
compute norm is  tensor(46.7472, device='cuda:3')
compute distance is  tensor(177.1597, device='cuda:3')
compute norm is  tensor(46.8834, device='cuda:3')
compute distance is  tensor(172.8873, device='cuda:3')
compute norm is  tensor(46.8114, device='cuda:3')
compute distance is  tensor(164.5798, device='cuda:3')
compute norm is  tensor(46.4186, device='cuda:3')
distance Threshold  is  tensor(182.8954, device='cuda:3')
________________________________
test distance is  tensor(1105720., device='cuda:3')
test similarity is  tensor(0.0716, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.356154034719204e+17
test entropy is  0.0
________________________________
cal ratio is  0.01157500839625577
cal_distance is  tensor(12798.7275, device='cuda:3')
cal ratio is  0.10758717667141154
cal_distance is  tensor(1376.9854, device='cuda:3')
cal ratio is  0.32800407088620326
cal_distance is  tensor(451.6618, device='cuda:3')
cal ratio is  0.5727132282299991
cal_distance is  tensor(258.6759, device='cuda:3')
cal ratio is  0.7567735298267972
cal_distance is  tensor(195.7608, device='cuda:3')
cal ratio is  0.8699233515452414
cal_distance is  tensor(170.2979, device='cuda:3')
________________________________
test distance is  tensor(170.2979, device='cuda:3')
test similarity is  tensor(0.9174, device='cuda:3')
test acc is  0.10000000015633198
test loss is 533.6264531312466
test entropy is  0.0
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  533.5132722508932
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9174, device='cuda:3')
compute_distance is  tensor(170.2979, device='cuda:3')
compute_norm is  tensor(45.2824, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  0.8854065101538131
avg test loss is  1.3812756415750427
avg accuracy is  0.4195833334896747
solo acc is  0.3172833334896732
compute similarity  is  tensor(0.9209, device='cuda:3')
compute_distance is  tensor(160.7680, device='cuda:3')
compute_norm is  tensor(45.0108, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(160.7680, device='cuda:3')
test similarity is  tensor(0.9209, device='cuda:3')
test acc is  0.42050000015634137
test loss is 1.3820186753008665
test entropy is  0.8844739221560676
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.3757295608520508
mal norm is  tensor(8.1221, device='cuda:3')
mal distance is  tensor(160.7680, device='cuda:3')
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [4, 6]
alphas 3 is [1.   0.25 0.5 ]
alphas is  [0.57142857 0.14285714 0.28571429]
median_weights acc is  0.8115000001569986
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 85.75% 

Test Accuracy: 84.74% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
 benign loss is  0.8411596417427063
benign distance is  tensor(163.5564, device='cuda:3')
norm1 res is  tensor(0.1747, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.8156194686889648
benign distance is  tensor(149.6887, device='cuda:3')
norm1 res is  tensor(0.1634, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.20542111992835999
benign distance is  tensor(162.3282, device='cuda:3')
norm1 res is  tensor(0.1722, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.4878903925418854
benign distance is  tensor(151.9792, device='cuda:3')
norm1 res is  tensor(0.1638, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  1.30298912525177
benign distance is  tensor(156.7254, device='cuda:3')
norm1 res is  tensor(0.1612, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.8255847096443176
benign distance is  tensor(150.6053, device='cuda:3')
norm1 res is  tensor(0.1612, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.5334206819534302
benign distance is  tensor(157.9781, device='cuda:3')
norm1 res is  tensor(0.1680, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  1.3277454376220703
benign distance is  tensor(151.2857, device='cuda:3')
norm1 res is  tensor(0.1637, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.3065198063850403
benign distance is  tensor(163.0139, device='cuda:3')
norm1 res is  tensor(0.1720, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.8292334675788879
benign distance is  tensor(177.5949, device='cuda:3')
norm1 res is  tensor(0.1874, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.545036792755127
benign distance is  tensor(144.9067, device='cuda:3')
norm1 res is  tensor(0.1506, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.6196216344833374
benign distance is  tensor(155.1153, device='cuda:3')
norm1 res is  tensor(0.1649, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.7680285573005676
benign distance is  tensor(155.6043, device='cuda:3')
norm1 res is  tensor(0.1664, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.4102934002876282
benign distance is  tensor(165.4152, device='cuda:3')
norm1 res is  tensor(0.1742, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.34531277418136597
benign distance is  tensor(153.4456, device='cuda:3')
norm1 res is  tensor(0.1627, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.6974579691886902
benign distance is  tensor(172.7447, device='cuda:3')
norm1 res is  tensor(0.1842, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.22865211963653564
benign distance is  tensor(166.2507, device='cuda:3')
norm1 res is  tensor(0.1788, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.8020262718200684
benign distance is  tensor(164.3204, device='cuda:3')
norm1 res is  tensor(0.1731, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.43898025155067444
benign distance is  tensor(167.0401, device='cuda:3')
norm1 res is  tensor(0.1767, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.8584230542182922
benign distance is  tensor(171.7320, device='cuda:3')
norm1 res is  tensor(0.1772, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.7414346933364868
benign distance is  tensor(167.1212, device='cuda:3')
norm1 res is  tensor(0.1757, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.5281397700309753
benign distance is  tensor(179.2710, device='cuda:3')
norm1 res is  tensor(0.1898, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.4490528106689453
benign distance is  tensor(160.6718, device='cuda:3')
norm1 res is  tensor(0.1750, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.73898845911026
benign distance is  tensor(152.5969, device='cuda:3')
norm1 res is  tensor(0.1633, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(183.6656, device='cuda:3')
compute norm is  tensor(46.7703, device='cuda:3')
compute distance is  tensor(183.3901, device='cuda:3')
compute norm is  tensor(46.7575, device='cuda:3')
compute distance is  tensor(193.0604, device='cuda:3')
compute norm is  tensor(47.0619, device='cuda:3')
compute distance is  tensor(180.9399, device='cuda:3')
compute norm is  tensor(46.6890, device='cuda:3')
compute distance is  tensor(187.3673, device='cuda:3')
compute norm is  tensor(46.9565, device='cuda:3')
compute distance is  tensor(194.8401, device='cuda:3')
compute norm is  tensor(47.2432, device='cuda:3')
compute distance is  tensor(185.5188, device='cuda:3')
compute norm is  tensor(46.9492, device='cuda:3')
compute distance is  tensor(186.4135, device='cuda:3')
compute norm is  tensor(46.9785, device='cuda:3')
compute distance is  tensor(185.9662, device='cuda:3')
compute norm is  tensor(46.9348, device='cuda:3')
compute distance is  tensor(184.4719, device='cuda:3')
compute norm is  tensor(46.9610, device='cuda:3')
compute distance is  tensor(197.8488, device='cuda:3')
compute norm is  tensor(47.4126, device='cuda:3')
compute distance is  tensor(190.2532, device='cuda:3')
compute norm is  tensor(47.0851, device='cuda:3')
distance Threshold  is  tensor(197.8488, device='cuda:3')
________________________________
test distance is  tensor(1105705.5000, device='cuda:3')
test similarity is  tensor(0.1626, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.353701122301793e+17
test entropy is  0.0
________________________________
cal ratio is  0.012038974995837762
cal_distance is  tensor(13311.5674, device='cuda:3')
cal ratio is  0.10972223612158859
cal_distance is  tensor(1460.5815, device='cuda:3')
cal ratio is  0.33124273040280017
cal_distance is  tensor(483.8120, device='cuda:3')
cal ratio is  0.5755339379925927
cal_distance is  tensor(278.4534, device='cuda:3')
cal ratio is  0.7586351923519515
cal_distance is  tensor(211.2463, device='cuda:3')
cal ratio is  0.8709930727816793
cal_distance is  tensor(183.9950, device='cuda:3')
________________________________
test distance is  tensor(183.9950, device='cuda:3')
test similarity is  tensor(0.9193, device='cuda:3')
test acc is  0.24573333348967152
test loss is 219.1163202867325
test entropy is  6.59619289397848e-12
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.191949057184984e-13
avg test loss is  219.38537680619817
avg accuracy is  0.24463333348967148
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9193, device='cuda:3')
compute_distance is  tensor(183.9950, device='cuda:3')
compute_norm is  tensor(48.1769, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  0.9324898354407313
avg test loss is  1.4967276680189918
avg accuracy is  0.4764666668230086
solo acc is  0.30018333348967285
compute similarity  is  tensor(0.9235, device='cuda:3')
compute_distance is  tensor(164.2650, device='cuda:3')
compute_norm is  tensor(47.6614, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(164.2650, device='cuda:3')
test similarity is  tensor(0.9235, device='cuda:3')
test acc is  0.4762000001563419
test loss is 1.4930096538082114
test entropy is  0.9317162653911851
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.40000000050000006
mal loss is 1.3573517799377441
mal norm is  tensor(8.7265, device='cuda:3')
mal distance is  tensor(164.2650, device='cuda:3')
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [6]
alphas 3 is [1.         0.33333333]
alphas is  [0.75 0.25]
median_weights acc is  0.5899000001569987
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 66.91% 

Test Accuracy: 65.54% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
 benign loss is  0.3414759039878845
benign distance is  tensor(216.9690, device='cuda:3')
norm1 res is  tensor(0.2111, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.4351997971534729
benign distance is  tensor(207.3518, device='cuda:3')
norm1 res is  tensor(0.2073, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.3549650311470032
benign distance is  tensor(203.5842, device='cuda:3')
norm1 res is  tensor(0.2061, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.5938767194747925
benign distance is  tensor(208.4626, device='cuda:3')
norm1 res is  tensor(0.2075, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.5025781393051147
benign distance is  tensor(196.2417, device='cuda:3')
norm1 res is  tensor(0.1925, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  1.0756938457489014
benign distance is  tensor(196.8116, device='cuda:3')
norm1 res is  tensor(0.1980, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.7494869232177734
benign distance is  tensor(202.4655, device='cuda:3')
norm1 res is  tensor(0.2036, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.7120333909988403
benign distance is  tensor(219.0137, device='cuda:3')
norm1 res is  tensor(0.2221, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.27507883310317993
benign distance is  tensor(205.2669, device='cuda:3')
norm1 res is  tensor(0.2077, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.4831344485282898
benign distance is  tensor(203.8824, device='cuda:3')
norm1 res is  tensor(0.2061, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.627212643623352
benign distance is  tensor(215.5987, device='cuda:3')
norm1 res is  tensor(0.2161, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.3099619150161743
benign distance is  tensor(216.9970, device='cuda:3')
norm1 res is  tensor(0.2177, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.42222341895103455
benign distance is  tensor(194.3847, device='cuda:3')
norm1 res is  tensor(0.1938, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.7903121709823608
benign distance is  tensor(203.5986, device='cuda:3')
norm1 res is  tensor(0.2045, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.19072498381137848
benign distance is  tensor(212.8854, device='cuda:3')
norm1 res is  tensor(0.2121, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.84534752368927
benign distance is  tensor(197.5472, device='cuda:3')
norm1 res is  tensor(0.1970, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(232.5005, device='cuda:3')
compute norm is  tensor(47.1308, device='cuda:3')
compute distance is  tensor(232.9904, device='cuda:3')
compute norm is  tensor(47.1174, device='cuda:3')
compute distance is  tensor(233.6830, device='cuda:3')
compute norm is  tensor(47.3404, device='cuda:3')
compute distance is  tensor(235.0582, device='cuda:3')
compute norm is  tensor(47.1902, device='cuda:3')
compute distance is  tensor(235.5432, device='cuda:3')
compute norm is  tensor(47.2442, device='cuda:3')
compute distance is  tensor(236.8692, device='cuda:3')
compute norm is  tensor(47.3248, device='cuda:3')
compute distance is  tensor(235.2850, device='cuda:3')
compute norm is  tensor(47.4149, device='cuda:3')
compute distance is  tensor(234.5179, device='cuda:3')
compute norm is  tensor(47.2673, device='cuda:3')
compute distance is  tensor(234.3327, device='cuda:3')
compute norm is  tensor(47.3007, device='cuda:3')
compute distance is  tensor(235.6545, device='cuda:3')
compute norm is  tensor(47.4113, device='cuda:3')
compute distance is  tensor(228.6052, device='cuda:3')
compute norm is  tensor(47.0874, device='cuda:3')
compute distance is  tensor(229.4054, device='cuda:3')
compute norm is  tensor(46.9795, device='cuda:3')
distance Threshold  is  tensor(236.8692, device='cuda:3')
________________________________
test distance is  tensor(1105638.2500, device='cuda:3')
test similarity is  tensor(0.3380, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.356933054605272e+17
test entropy is  0.0
________________________________
cal ratio is  0.013173170141333613
cal_distance is  tensor(14564.7676, device='cuda:3')
cal ratio is  0.11477440837763402
cal_distance is  tensor(1671.6693, device='cuda:3')
cal ratio is  0.3387830367025809
cal_distance is  tensor(566.3381, device='cuda:3')
cal ratio is  0.5820481987860022
cal_distance is  tensor(329.6391, device='cuda:3')
cal ratio is  0.7629172992877292
cal_distance is  tensor(251.4891, device='cuda:3')
cal ratio is  0.873448324392324
cal_distance is  tensor(219.6637, device='cuda:3')
________________________________
test distance is  tensor(219.6637, device='cuda:3')
test similarity is  tensor(0.9218, device='cuda:3')
test acc is  0.12256666682299859
test loss is 624.8083529929871
test entropy is  2.8484986145975507e-33
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  9.469870925449765e-40
avg test loss is  624.976738057411
avg accuracy is  0.12188333348966525
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9218, device='cuda:3')
compute_distance is  tensor(219.6637, device='cuda:3')
compute_norm is  tensor(52.9045, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.5614525349155417
avg test loss is  2.8442191800583148
avg accuracy is  0.13451666682299857
solo acc is  0.1022833334896653
compute similarity  is  tensor(0.9192, device='cuda:3')
compute_distance is  tensor(234.1932, device='cuda:3')
compute_norm is  tensor(54.1132, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.864634800948568
avg test loss is  3.571220101069794
avg accuracy is  0.11760000015633194
solo acc is  0.10016666682299866
compute similarity  is  tensor(0.9193, device='cuda:3')
compute_distance is  tensor(233.7205, device='cuda:3')
compute_norm is  tensor(54.2475, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.5196409832948305
avg test loss is  2.765819462123456
avg accuracy is  0.13491666682299858
solo acc is  0.11016666682299862
compute similarity  is  tensor(0.9191, device='cuda:3')
compute_distance is  tensor(232.2983, device='cuda:3')
compute_norm is  tensor(53.6276, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  0.8590144049892547
avg test loss is  3.4731413029404337
avg accuracy is  0.1180666668229986
solo acc is  0.10140000015633198
compute similarity  is  tensor(0.9192, device='cuda:3')
compute_distance is  tensor(231.7234, device='cuda:3')
compute_norm is  tensor(53.7443, device='cuda:3')
++++++++++++++++++++
change alpha
________________________________
test distance is  tensor(231.5597, device='cuda:3')
test similarity is  tensor(0.9192, device='cuda:3')
test acc is  0.13186666682299858
test loss is 2.2633133875027394
test entropy is  1.2893671467105972
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.2900801349296245
avg test loss is  2.2611423644429838
avg accuracy is  0.13163333348966524
solo acc is  0.1616166668230008
compute similarity  is  tensor(0.9192, device='cuda:3')
compute_distance is  tensor(231.5597, device='cuda:3')
compute_norm is  tensor(53.0777, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  0.7405617481101551
avg test loss is  3.020377519034119
avg accuracy is  0.11620000015633193
solo acc is  0.10460000015633197
compute similarity  is  tensor(0.9191, device='cuda:3')
compute_distance is  tensor(231.2359, device='cuda:3')
compute_norm is  tensor(53.0498, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.1759721261860212
avg test loss is  2.0693784786948264
avg accuracy is  0.13018333348966526
solo acc is  0.1667833334896679
compute similarity  is  tensor(0.9190, device='cuda:3')
compute_distance is  tensor(230.7204, device='cuda:3')
compute_norm is  tensor(52.4940, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.6953718178053655
avg test loss is  2.7599275114693875
avg accuracy is  0.1153666668229986
solo acc is  0.11016666682299862
compute similarity  is  tensor(0.9189, device='cuda:3')
compute_distance is  tensor(230.2956, device='cuda:3')
compute_norm is  tensor(52.4190, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.0544604559951245
avg test loss is  1.7868158326728512
avg accuracy is  0.12768333348966526
solo acc is  0.22648333348967079
compute similarity  is  tensor(0.9188, device='cuda:3')
compute_distance is  tensor(229.7267, device='cuda:3')
compute_norm is  tensor(51.8787, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(229.2098, device='cuda:3')
test similarity is  tensor(0.9187, device='cuda:3')
test acc is  0.1156666668229986
test loss is 2.607005919220605
test entropy is  0.6391381525408739
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.6408149554277025
avg test loss is  2.6053301838161085
avg accuracy is  0.11565000015633194
solo acc is  0.10928333348966529
compute similarity  is  tensor(0.9187, device='cuda:3')
compute_distance is  tensor(229.2098, device='cuda:3')
compute_norm is  tensor(51.7532, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.0450266064611324
avg test loss is  1.731224293393621
avg accuracy is  0.12908333348966525
solo acc is  0.20805000015633676
compute similarity  is  tensor(0.9184, device='cuda:3')
compute_distance is  tensor(228.7792, device='cuda:3')
compute_norm is  tensor(51.2887, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.6551984320444338
avg test loss is  2.4942696140264906
avg accuracy is  0.11603333348966527
solo acc is  0.10638333348966529
compute similarity  is  tensor(0.9183, device='cuda:3')
compute_distance is  tensor(228.2963, device='cuda:3')
compute_norm is  tensor(51.1514, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9870551372133592
avg test loss is  1.5977491216618878
avg accuracy is  0.12900000015633192
solo acc is  0.250016666823005
compute similarity  is  tensor(0.9180, device='cuda:3')
compute_distance is  tensor(228.0612, device='cuda:3')
compute_norm is  tensor(50.7500, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(228.0612, device='cuda:3')
test similarity is  tensor(0.9180, device='cuda:3')
test acc is  0.13006666682299858
test loss is 1.598994111963935
test entropy is  0.9870452817950421
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.3500000005
mal loss is 1.1079031229019165
mal norm is  tensor(10.1125, device='cuda:3')
mal distance is  tensor(228.0612, device='cuda:3')
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [5, 8]
alphas 3 is [1.  0.2 0.5]
alphas is  [0.58823529 0.11764706 0.29411765]
median_weights acc is  0.18040000015699933
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 18.68% 

Test Accuracy: 18.29% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
 benign loss is  0.2142200767993927
benign distance is  tensor(211.3391, device='cuda:3')
norm1 res is  tensor(0.2108, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.3851422369480133
benign distance is  tensor(202.3664, device='cuda:3')
norm1 res is  tensor(0.1998, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.18546512722969055
benign distance is  tensor(193.7445, device='cuda:3')
norm1 res is  tensor(0.1934, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.7484055757522583
benign distance is  tensor(202.0141, device='cuda:3')
norm1 res is  tensor(0.2055, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.7771288156509399
benign distance is  tensor(198.3092, device='cuda:3')
norm1 res is  tensor(0.1975, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.8833104372024536
benign distance is  tensor(190.3261, device='cuda:3')
norm1 res is  tensor(0.1936, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.6582810282707214
benign distance is  tensor(204.7225, device='cuda:3')
norm1 res is  tensor(0.2034, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  1.1788400411605835
benign distance is  tensor(196.4773, device='cuda:3')
norm1 res is  tensor(0.2015, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.3241659998893738
benign distance is  tensor(202.0878, device='cuda:3')
norm1 res is  tensor(0.2039, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  1.2103757858276367
benign distance is  tensor(197.9455, device='cuda:3')
norm1 res is  tensor(0.1975, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.4067078232765198
benign distance is  tensor(190.9785, device='cuda:3')
norm1 res is  tensor(0.1933, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  0.4934731125831604
benign distance is  tensor(209.1447, device='cuda:3')
norm1 res is  tensor(0.2075, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.4713729918003082
benign distance is  tensor(192.5765, device='cuda:3')
norm1 res is  tensor(0.1950, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.5338557958602905
benign distance is  tensor(205.0291, device='cuda:3')
norm1 res is  tensor(0.2069, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.4170600473880768
benign distance is  tensor(206.5079, device='cuda:3')
norm1 res is  tensor(0.2144, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.5750885009765625
benign distance is  tensor(216.0273, device='cuda:3')
norm1 res is  tensor(0.2164, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  0.3429078459739685
benign distance is  tensor(210.5599, device='cuda:3')
norm1 res is  tensor(0.2115, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  0.15641990303993225
benign distance is  tensor(195.9585, device='cuda:3')
norm1 res is  tensor(0.1975, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  0.5123715996742249
benign distance is  tensor(200.4041, device='cuda:3')
norm1 res is  tensor(0.2019, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  0.6821115612983704
benign distance is  tensor(189.7317, device='cuda:3')
norm1 res is  tensor(0.1903, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  0.6613849997520447
benign distance is  tensor(189.4567, device='cuda:3')
norm1 res is  tensor(0.1870, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  0.12621146440505981
benign distance is  tensor(194.2769, device='cuda:3')
norm1 res is  tensor(0.1945, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  0.6887609362602234
benign distance is  tensor(200.4930, device='cuda:3')
norm1 res is  tensor(0.2010, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  0.6381767988204956
benign distance is  tensor(190.3949, device='cuda:3')
norm1 res is  tensor(0.1884, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(287.6556, device='cuda:3')
compute norm is  tensor(47.5145, device='cuda:3')
compute distance is  tensor(290.5116, device='cuda:3')
compute norm is  tensor(47.7426, device='cuda:3')
compute distance is  tensor(293.8168, device='cuda:3')
compute norm is  tensor(47.9408, device='cuda:3')
compute distance is  tensor(285.8630, device='cuda:3')
compute norm is  tensor(47.4778, device='cuda:3')
compute distance is  tensor(290.1562, device='cuda:3')
compute norm is  tensor(47.5564, device='cuda:3')
compute distance is  tensor(287.8939, device='cuda:3')
compute norm is  tensor(47.5231, device='cuda:3')
compute distance is  tensor(291.6964, device='cuda:3')
compute norm is  tensor(47.7645, device='cuda:3')
compute distance is  tensor(293.6268, device='cuda:3')
compute norm is  tensor(47.6176, device='cuda:3')
compute distance is  tensor(286.8787, device='cuda:3')
compute norm is  tensor(47.4813, device='cuda:3')
compute distance is  tensor(285.2203, device='cuda:3')
compute norm is  tensor(47.3778, device='cuda:3')
compute distance is  tensor(288.3146, device='cuda:3')
compute norm is  tensor(47.5785, device='cuda:3')
compute distance is  tensor(290.5499, device='cuda:3')
compute norm is  tensor(47.6698, device='cuda:3')
distance Threshold  is  tensor(293.8168, device='cuda:3')
________________________________
test distance is  tensor(1105628., device='cuda:3')
test similarity is  tensor(0.4174, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.359420534091668e+17
test entropy is  0.0
________________________________
cal ratio is  0.014671560365939338
cal_distance is  tensor(16221.2969, device='cuda:3')
cal ratio is  0.12112618581070343
cal_distance is  tensor(1964.8304, device='cuda:3')
cal ratio is  0.3480312864107132
cal_distance is  tensor(683.8271, device='cuda:3')
cal ratio is  0.5899397348785341
cal_distance is  tensor(403.4198, device='cuda:3')
cal ratio is  0.7680724833563919
cal_distance is  tensor(309.8574, device='cuda:3')
cal ratio is  0.8763949504388425
cal_distance is  tensor(271.5584, device='cuda:3')
________________________________
test distance is  tensor(271.5584, device='cuda:3')
test similarity is  tensor(0.9102, device='cuda:3')
test acc is  0.2167500001563371
test loss is 197.50519306369935
test entropy is  9.618162744760697e-06
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.8559793629378828e-05
avg test loss is  197.11617183075276
avg accuracy is  0.2145333334896704
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9102, device='cuda:3')
compute_distance is  tensor(271.5584, device='cuda:3')
compute_norm is  tensor(56.1885, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.119538339724673
avg test loss is  1.9171340882396901
avg accuracy is  0.13655000015633192
solo acc is  0.19570000015633623
compute similarity  is  tensor(0.9139, device='cuda:3')
compute_distance is  tensor(255.6891, device='cuda:3')
compute_norm is  tensor(56.1321, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.6704129036555666
avg test loss is  2.7069437351308143
avg accuracy is  0.12061666682299861
solo acc is  0.11001666682299861
compute similarity  is  tensor(0.9138, device='cuda:3')
compute_distance is  tensor(254.8070, device='cuda:3')
compute_norm is  tensor(55.9613, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.0078215149801169
avg test loss is  1.6889889625343941
avg accuracy is  0.13766666682299875
solo acc is  0.23900000015633802
compute similarity  is  tensor(0.9137, device='cuda:3')
compute_distance is  tensor(253.6369, device='cuda:3')
compute_norm is  tensor(55.4550, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  0.6137226758354
avg test loss is  2.509338085331134
avg accuracy is  0.12138333348966526
solo acc is  0.11165000015633195
compute similarity  is  tensor(0.9136, device='cuda:3')
compute_distance is  tensor(252.8113, device='cuda:3')
compute_norm is  tensor(55.2668, device='cuda:3')
++++++++++++++++++++
change alpha
________________________________
test distance is  tensor(252.0646, device='cuda:3')
test similarity is  tensor(0.9134, device='cuda:3')
test acc is  0.13703333348966532
test loss is 1.6292089580981208
test entropy is  1.023612600844552
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.022267403887279
avg test loss is  1.6291548014958022
avg accuracy is  0.137300000156332
solo acc is  0.21625000015633716
compute similarity  is  tensor(0.9134, device='cuda:3')
compute_distance is  tensor(252.0646, device='cuda:3')
compute_norm is  tensor(54.8363, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  0.6367896954769264
avg test loss is  2.3948749256794897
avg accuracy is  0.12125000015633194
solo acc is  0.10825000015633197
compute similarity  is  tensor(0.9133, device='cuda:3')
compute_distance is  tensor(251.4176, device='cuda:3')
compute_norm is  tensor(54.6561, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.9869416805981065
avg test loss is  1.5263116709204878
avg accuracy is  0.1378333334896654
solo acc is  0.24365000015633817
compute similarity  is  tensor(0.9131, device='cuda:3')
compute_distance is  tensor(250.9330, device='cuda:3')
compute_norm is  tensor(54.2683, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(250.9330, device='cuda:3')
test similarity is  tensor(0.9131, device='cuda:3')
test acc is  0.1370833334896653
test loss is 1.5300967749247927
test entropy is  0.9873396838778881
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.3000000005
mal loss is 1.2100722789764404
mal norm is  tensor(12.4929, device='cuda:3')
mal distance is  tensor(250.9330, device='cuda:3')
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
median_weights acc is  0.14460000015699956
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 12.62% 

Test Accuracy: 12.16% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
 benign loss is  0.605198323726654
benign distance is  tensor(197.4632, device='cuda:3')
norm1 res is  tensor(0.1994, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  1.1286836862564087
benign distance is  tensor(202.1795, device='cuda:3')
norm1 res is  tensor(0.2068, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.5872794389724731
benign distance is  tensor(212.3853, device='cuda:3')
norm1 res is  tensor(0.2111, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.6841825246810913
benign distance is  tensor(227.3955, device='cuda:3')
norm1 res is  tensor(0.2227, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.4151914119720459
benign distance is  tensor(211.8554, device='cuda:3')
norm1 res is  tensor(0.2145, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.4454713463783264
benign distance is  tensor(210.2276, device='cuda:3')
norm1 res is  tensor(0.2077, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.9483026266098022
benign distance is  tensor(205.0821, device='cuda:3')
norm1 res is  tensor(0.2074, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.47486263513565063
benign distance is  tensor(250.4230, device='cuda:3')
norm1 res is  tensor(0.2668, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(454.3301, device='cuda:3')
compute norm is  tensor(47.5582, device='cuda:3')
compute distance is  tensor(456.7319, device='cuda:3')
compute norm is  tensor(47.6688, device='cuda:3')
compute distance is  tensor(459.0042, device='cuda:3')
compute norm is  tensor(48.0034, device='cuda:3')
compute distance is  tensor(457.6166, device='cuda:3')
compute norm is  tensor(47.7487, device='cuda:3')
compute distance is  tensor(456.9030, device='cuda:3')
compute norm is  tensor(47.7241, device='cuda:3')
compute distance is  tensor(454.9752, device='cuda:3')
compute norm is  tensor(47.6893, device='cuda:3')
compute distance is  tensor(458.7938, device='cuda:3')
compute norm is  tensor(47.9263, device='cuda:3')
compute distance is  tensor(459.1397, device='cuda:3')
compute norm is  tensor(47.8689, device='cuda:3')
compute distance is  tensor(462.2428, device='cuda:3')
compute norm is  tensor(48.0785, device='cuda:3')
compute distance is  tensor(457.3422, device='cuda:3')
compute norm is  tensor(47.7942, device='cuda:3')
compute distance is  tensor(460.5330, device='cuda:3')
compute norm is  tensor(47.9563, device='cuda:3')
compute distance is  tensor(458.6774, device='cuda:3')
compute norm is  tensor(47.9222, device='cuda:3')
distance Threshold  is  tensor(462.2428, device='cuda:3')
________________________________
test distance is  tensor(1105448.7500, device='cuda:3')
test similarity is  tensor(0.6977, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.355580703655832e+17
test entropy is  0.0
________________________________
cal ratio is  0.018403832154773685
cal_distance is  tensor(20344.5000, device='cuda:3')
cal ratio is  0.13566070155410598
cal_distance is  tensor(2759.9558, device='cuda:3')
cal ratio is  0.36832102113729015
cal_distance is  tensor(1016.5544, device='cuda:3')
cal ratio is  0.6068931982295667
cal_distance is  tensor(616.9429, device='cuda:3')
cal ratio is  0.7790316263684784
cal_distance is  tensor(480.6196, device='cuda:3')
cal ratio is  0.8826262036120716
cal_distance is  tensor(424.2083, device='cuda:3')
________________________________
test distance is  tensor(424.2083, device='cuda:3')
test similarity is  tensor(0.9397, device='cuda:3')
test acc is  0.10000000015633198
test loss is 9009.08293753748
test entropy is  0.0
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  8998.915538795976
avg accuracy is  0.10001666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9397, device='cuda:3')
compute_distance is  tensor(424.2083, device='cuda:3')
compute_norm is  tensor(73.3519, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.6778220450446042
avg test loss is  2.7645337446920397
avg accuracy is  0.11838333348966527
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5298, device='cuda:3')
compute_distance is  tensor(1989.2274, device='cuda:3')
compute_norm is  tensor(176.7234, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.1141787023940828
avg test loss is  3.268553613345506
avg accuracy is  0.11158333348966529
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5300, device='cuda:3')
compute_distance is  tensor(1979.3700, device='cuda:3')
compute_norm is  tensor(176.5933, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9249596401318304
avg test loss is  3.490778265731421
avg accuracy is  0.10745000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5300, device='cuda:3')
compute_distance is  tensor(1969.1742, device='cuda:3')
compute_norm is  tensor(176.0025, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.4895887997613024
avg test loss is  2.910238065190915
avg accuracy is  0.11668333348966528
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5298, device='cuda:3')
compute_distance is  tensor(1958.2955, device='cuda:3')
compute_norm is  tensor(174.5064, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(1948.4475, device='cuda:3')
test similarity is  tensor(0.5300, device='cuda:3')
test acc is  0.1113333334896653
test loss is 3.3283216938026934
test entropy is  1.0545775187549307
________________________________
cal ratio is  0.4383623257274097
cal_distance is  tensor(854.1279, device='cuda:3')
cal ratio is  0.6620886011156164
cal_distance is  tensor(565.5095, device='cuda:3')
cal ratio is  0.8136874830605054
cal_distance is  tensor(460.1487, device='cuda:3')
________________________________
test distance is  tensor(460.1487, device='cuda:3')
test similarity is  tensor(0.8837, device='cuda:3')
test acc is  0.11015000015633197
test loss is 253.2034764564368
test entropy is  0.16260835226140677
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16358986008030646
avg test loss is  253.03371355426845
avg accuracy is  0.11030000015633196
solo acc is  0.09890000015633198
compute similarity  is  tensor(0.8837, device='cuda:3')
compute_distance is  tensor(460.1487, device='cuda:3')
compute_norm is  tensor(72.2076, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.6120253952581491
avg test loss is  2.8144815392585705
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4071, device='cuda:3')
compute_distance is  tensor(1445.3624, device='cuda:3')
compute_norm is  tensor(132.0091, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.056180504339336
avg test loss is  3.333963914466565
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4074, device='cuda:3')
compute_distance is  tensor(1438.3892, device='cuda:3')
compute_norm is  tensor(132.0292, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9003964951043444
avg test loss is  3.5229887001550018
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4074, device='cuda:3')
compute_distance is  tensor(1431.0769, device='cuda:3')
compute_norm is  tensor(131.6062, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.507713838045531
avg test loss is  2.893569115382522
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4072, device='cuda:3')
compute_distance is  tensor(1423.0787, device='cuda:3')
compute_norm is  tensor(130.3156, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(1416.1920, device='cuda:3')
test similarity is  tensor(0.4074, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.354604807743894
test entropy is  1.031847655328352
________________________________
cal ratio is  0.5141815650590933
cal_distance is  tensor(728.1810, device='cuda:3')
cal ratio is  0.7170639941514904
cal_distance is  tensor(522.1530, device='cuda:3')
cal ratio is  0.8467957551063462
cal_distance is  tensor(442.1573, device='cuda:3')
________________________________
test distance is  tensor(442.1573, device='cuda:3')
test similarity is  tensor(0.8122, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.661041369316166
test entropy is  1.8397064877471436
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.8397264335709593
avg test loss is  2.6617502426541946
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8122, device='cuda:3')
compute_distance is  tensor(442.1573, device='cuda:3')
compute_norm is  tensor(68.4612, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  0.9890966384903963
avg test loss is  3.4240208953174194
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8124, device='cuda:3')
compute_distance is  tensor(440.1056, device='cuda:3')
compute_norm is  tensor(68.8812, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.5516127102664794
avg test loss is  2.8585550706269642
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8122, device='cuda:3')
compute_distance is  tensor(437.1594, device='cuda:3')
compute_norm is  tensor(68.0734, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9427545379473965
avg test loss is  3.4620702625083517
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8123, device='cuda:3')
compute_distance is  tensor(435.0570, device='cuda:3')
compute_norm is  tensor(68.3142, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.5459982409660242
avg test loss is  2.861694261209289
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8122, device='cuda:3')
compute_distance is  tensor(432.2901, device='cuda:3')
compute_norm is  tensor(67.4799, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(430.4048, device='cuda:3')
test similarity is  tensor(0.8123, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.4633683156865493
test entropy is  0.9385093684389647
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 3.3570542335510254
mal norm is  tensor(18.9330, device='cuda:3')
mal distance is  tensor(430.4048, device='cuda:3')
curent length is  20
the length of epoch_weights is  4
the length of weights_d is  4
alpha 1 is [6, 8, 9, 10]
alphas 3 is [1.         0.16666667 0.25       0.33333333 0.5       ]
alphas is  [0.44444444 0.07407407 0.11111111 0.14814815 0.22222222]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
 benign loss is  0.40814223885536194
benign distance is  tensor(170.4137, device='cuda:3')
norm1 res is  tensor(0.1874, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.4301814138889313
benign distance is  tensor(173.1820, device='cuda:3')
norm1 res is  tensor(0.1833, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.5681239366531372
benign distance is  tensor(165.0809, device='cuda:3')
norm1 res is  tensor(0.1762, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  0.20767149329185486
benign distance is  tensor(201.2251, device='cuda:3')
norm1 res is  tensor(0.2069, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.5313597917556763
benign distance is  tensor(182.4206, device='cuda:3')
norm1 res is  tensor(0.1929, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  0.2910957932472229
benign distance is  tensor(193.8020, device='cuda:3')
norm1 res is  tensor(0.2160, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.34293875098228455
benign distance is  tensor(174.0951, device='cuda:3')
norm1 res is  tensor(0.1876, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.5744355916976929
benign distance is  tensor(174.3297, device='cuda:3')
norm1 res is  tensor(0.1866, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  0.6256863474845886
benign distance is  tensor(176.8787, device='cuda:3')
norm1 res is  tensor(0.1895, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.9462467432022095
benign distance is  tensor(170.4955, device='cuda:3')
norm1 res is  tensor(0.1843, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  0.8312026262283325
benign distance is  tensor(206.3907, device='cuda:3')
norm1 res is  tensor(0.2166, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  1.0746046304702759
benign distance is  tensor(170.6744, device='cuda:3')
norm1 res is  tensor(0.1872, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  0.3990834653377533
benign distance is  tensor(179.6480, device='cuda:3')
norm1 res is  tensor(0.1989, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  0.20559485256671906
benign distance is  tensor(186.6038, device='cuda:3')
norm1 res is  tensor(0.2053, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  0.5374047756195068
benign distance is  tensor(194.1878, device='cuda:3')
norm1 res is  tensor(0.2133, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  0.19338098168373108
benign distance is  tensor(170.0901, device='cuda:3')
norm1 res is  tensor(0.1802, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  0.5636417269706726
benign distance is  tensor(164.9583, device='cuda:3')
norm1 res is  tensor(0.1777, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  0.6263629198074341
benign distance is  tensor(182.8382, device='cuda:3')
norm1 res is  tensor(0.1916, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  0.44248685240745544
benign distance is  tensor(216.1820, device='cuda:3')
norm1 res is  tensor(0.2378, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  0.3886304795742035
benign distance is  tensor(170.6139, device='cuda:3')
norm1 res is  tensor(0.1850, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  0.38583964109420776
benign distance is  tensor(169.8039, device='cuda:3')
norm1 res is  tensor(0.1887, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  0.3635348677635193
benign distance is  tensor(180.0764, device='cuda:3')
norm1 res is  tensor(0.1929, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  0.48868101835250854
benign distance is  tensor(170.0650, device='cuda:3')
norm1 res is  tensor(0.1809, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  0.9175812005996704
benign distance is  tensor(173.2002, device='cuda:3')
norm1 res is  tensor(0.1888, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  0.183660089969635
benign distance is  tensor(169.2185, device='cuda:3')
norm1 res is  tensor(0.1826, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  0.3904961943626404
benign distance is  tensor(170.6577, device='cuda:3')
norm1 res is  tensor(0.1872, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  0.40424856543540955
benign distance is  tensor(168.8715, device='cuda:3')
norm1 res is  tensor(0.1825, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  0.46009713411331177
benign distance is  tensor(174.9117, device='cuda:3')
norm1 res is  tensor(0.1860, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  0.6280519962310791
benign distance is  tensor(188.7319, device='cuda:3')
norm1 res is  tensor(0.2023, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  0.4208919405937195
benign distance is  tensor(158.0905, device='cuda:3')
norm1 res is  tensor(0.1774, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  0.2567240297794342
benign distance is  tensor(153.9322, device='cuda:3')
norm1 res is  tensor(0.1717, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  0.46997156739234924
benign distance is  tensor(157.2591, device='cuda:3')
norm1 res is  tensor(0.1750, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  0.41221585869789124
benign distance is  tensor(190.1333, device='cuda:3')
norm1 res is  tensor(0.2034, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  0.8676864504814148
benign distance is  tensor(173.2742, device='cuda:3')
norm1 res is  tensor(0.1914, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  0.6164523363113403
benign distance is  tensor(170.7601, device='cuda:3')
norm1 res is  tensor(0.1828, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  0.5733490586280823
benign distance is  tensor(163.4600, device='cuda:3')
norm1 res is  tensor(0.1807, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  0.08386560529470444
benign distance is  tensor(167.5912, device='cuda:3')
norm1 res is  tensor(0.1888, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  0.5698816776275635
benign distance is  tensor(173.9178, device='cuda:3')
norm1 res is  tensor(0.1901, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  0.7736982107162476
benign distance is  tensor(175.2639, device='cuda:3')
norm1 res is  tensor(0.1896, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  0.2543148398399353
benign distance is  tensor(170.5321, device='cuda:3')
norm1 res is  tensor(0.1879, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(356.5663, device='cuda:3')
compute norm is  tensor(43.8223, device='cuda:3')
compute distance is  tensor(350.9222, device='cuda:3')
compute norm is  tensor(43.6689, device='cuda:3')
compute distance is  tensor(360.5092, device='cuda:3')
compute norm is  tensor(44.2677, device='cuda:3')
compute distance is  tensor(350.4272, device='cuda:3')
compute norm is  tensor(43.6705, device='cuda:3')
compute distance is  tensor(349.9845, device='cuda:3')
compute norm is  tensor(43.7787, device='cuda:3')
compute distance is  tensor(351.5866, device='cuda:3')
compute norm is  tensor(44.0765, device='cuda:3')
compute distance is  tensor(357.1287, device='cuda:3')
compute norm is  tensor(44.1131, device='cuda:3')
compute distance is  tensor(352.7451, device='cuda:3')
compute norm is  tensor(43.9289, device='cuda:3')
compute distance is  tensor(356.4477, device='cuda:3')
compute norm is  tensor(43.8921, device='cuda:3')
compute distance is  tensor(348.1916, device='cuda:3')
compute norm is  tensor(43.7138, device='cuda:3')
compute distance is  tensor(358.7641, device='cuda:3')
compute norm is  tensor(44.1854, device='cuda:3')
compute distance is  tensor(350.8507, device='cuda:3')
compute norm is  tensor(43.6892, device='cuda:3')
distance Threshold  is  tensor(360.5092, device='cuda:3')
________________________________
test distance is  tensor(1105657.2500, device='cuda:3')
test similarity is  tensor(0.4775, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.356375915477029e+17
test entropy is  0.0
________________________________
cal ratio is  0.016251385549403932
cal_distance is  tensor(17968.4707, device='cuda:3')
cal ratio is  0.12748089408774332
cal_distance is  tensor(2290.6431, device='cuda:3')
cal ratio is  0.3570441704880886
cal_distance is  tensor(817.8655, device='cuda:3')
cal ratio is  0.5975300150678414
cal_distance is  tensor(488.7021, device='cuda:3')
cal ratio is  0.7729982967061848
cal_distance is  tensor(377.7676, device='cuda:3')
cal ratio is  0.8792012657947601
cal_distance is  tensor(332.1346, device='cuda:3')
________________________________
test distance is  tensor(332.1346, device='cuda:3')
test similarity is  tensor(0.9102, device='cuda:3')
test acc is  0.11438333348966527
test loss is 54.79352155982304
test entropy is  0.00012119571404464078
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0001444174622140098
avg test loss is  54.637767218323404
avg accuracy is  0.1141666668229986
solo acc is  0.10003333348966531
compute similarity  is  tensor(0.9102, device='cuda:3')
compute_distance is  tensor(332.1346, device='cuda:3')
compute_norm is  tensor(63.4820, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.0874739879611204
avg test loss is  1.7752319415495086
avg accuracy is  0.10015000015633198
solo acc is  0.21375000015633708
compute similarity  is  tensor(0.9122, device='cuda:3')
compute_distance is  tensor(321.8301, device='cuda:3')
compute_norm is  tensor(63.1762, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.6613896680412008
avg test loss is  2.5793555959709673
avg accuracy is  0.10000000015633198
solo acc is  0.10783333348966528
compute similarity  is  tensor(0.9122, device='cuda:3')
compute_distance is  tensor(320.5358, device='cuda:3')
compute_norm is  tensor(62.9635, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.0604137417985433
avg test loss is  1.6808519997576405
avg accuracy is  0.10010000015633198
solo acc is  0.21918333348967065
compute similarity  is  tensor(0.9121, device='cuda:3')
compute_distance is  tensor(319.4742, device='cuda:3')
compute_norm is  tensor(62.5190, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  0.618153599343066
avg test loss is  2.5009756393269944
avg accuracy is  0.10001666682299865
solo acc is  0.10795000015633195
compute similarity  is  tensor(0.9120, device='cuda:3')
compute_distance is  tensor(318.4723, device='cuda:3')
compute_norm is  tensor(62.3075, device='cuda:3')
++++++++++++++++++++
change alpha
________________________________
test distance is  tensor(317.6084, device='cuda:3')
test similarity is  tensor(0.9120, device='cuda:3')
test acc is  0.10006666682299865
test loss is 1.6038760311567961
test entropy is  1.0303871973491172
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.0301680841933945
avg test loss is  1.604142978120206
avg accuracy is  0.10001666682299865
solo acc is  0.22973333348967093
compute similarity  is  tensor(0.9120, device='cuda:3')
compute_distance is  tensor(317.6084, device='cuda:3')
compute_norm is  tensor(61.8885, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  0.6109470968434552
avg test loss is  2.430160953800307
avg accuracy is  0.10003333348966531
solo acc is  0.10685000015633196
compute similarity  is  tensor(0.9119, device='cuda:3')
compute_distance is  tensor(316.6517, device='cuda:3')
compute_norm is  tensor(61.6761, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.979135560773329
avg test loss is  1.5529589974549787
avg accuracy is  0.10003333348966531
solo acc is  0.2439166668230048
compute similarity  is  tensor(0.9118, device='cuda:3')
compute_distance is  tensor(315.8542, device='cuda:3')
compute_norm is  tensor(61.2812, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(315.8542, device='cuda:3')
test similarity is  tensor(0.9118, device='cuda:3')
test acc is  0.10003333348966531
test loss is 1.5547384251155325
test entropy is  0.9785829603926205
________________________________
grad,shape is torch.Size([215370])
mal_acc is 0.2500000005
mal loss is 1.6132409572601318
mal norm is  tensor(15.4033, device='cuda:3')
mal distance is  tensor(315.8542, device='cuda:3')
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
median_weights acc is  0.10710000015700002
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 10.38% 

Test Accuracy: 10.17% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
 benign loss is  1.7283445596694946
benign distance is  tensor(222.8399, device='cuda:3')
norm1 res is  tensor(0.2499, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  0.49479833245277405
benign distance is  tensor(214.5796, device='cuda:3')
norm1 res is  tensor(0.2285, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  0.7245582938194275
benign distance is  tensor(209.5428, device='cuda:3')
norm1 res is  tensor(0.2181, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  1.0313647985458374
benign distance is  tensor(214.9333, device='cuda:3')
norm1 res is  tensor(0.2201, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  0.42611202597618103
benign distance is  tensor(194.4317, device='cuda:3')
norm1 res is  tensor(0.1998, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  1.4012112617492676
benign distance is  tensor(199.5061, device='cuda:3')
norm1 res is  tensor(0.2090, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  0.7555248141288757
benign distance is  tensor(190.2115, device='cuda:3')
norm1 res is  tensor(0.2013, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  0.7741069197654724
benign distance is  tensor(184.2648, device='cuda:3')
norm1 res is  tensor(0.2002, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(493.5638, device='cuda:3')
compute norm is  tensor(45.6352, device='cuda:3')
compute distance is  tensor(494.0910, device='cuda:3')
compute norm is  tensor(45.9606, device='cuda:3')
compute distance is  tensor(493.4763, device='cuda:3')
compute norm is  tensor(45.8821, device='cuda:3')
compute distance is  tensor(492.6309, device='cuda:3')
compute norm is  tensor(45.7476, device='cuda:3')
compute distance is  tensor(497.9571, device='cuda:3')
compute norm is  tensor(46.0045, device='cuda:3')
compute distance is  tensor(489.2525, device='cuda:3')
compute norm is  tensor(45.6581, device='cuda:3')
compute distance is  tensor(490.9632, device='cuda:3')
compute norm is  tensor(45.6919, device='cuda:3')
compute distance is  tensor(505.0145, device='cuda:3')
compute norm is  tensor(46.3113, device='cuda:3')
compute distance is  tensor(495.6421, device='cuda:3')
compute norm is  tensor(45.7391, device='cuda:3')
compute distance is  tensor(500.0540, device='cuda:3')
compute norm is  tensor(46.3261, device='cuda:3')
compute distance is  tensor(504.0472, device='cuda:3')
compute norm is  tensor(46.2762, device='cuda:3')
compute distance is  tensor(494.7523, device='cuda:3')
compute norm is  tensor(45.7488, device='cuda:3')
distance Threshold  is  tensor(505.0145, device='cuda:3')
________________________________
test distance is  tensor(1105418.1250, device='cuda:3')
test similarity is  tensor(0.7527, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.36140299062697e+17
test entropy is  0.0
________________________________
cal ratio is  0.019236724696449218
cal_distance is  tensor(21264.6309, device='cuda:3')
cal ratio is  0.1386964968193122
cal_distance is  tensor(2949.3362, device='cuda:3')
cal ratio is  0.3724193791857395
cal_distance is  tensor(1098.3944, device='cuda:3')
cal ratio is  0.6102604946709319
cal_distance is  tensor(670.3097, device='cuda:3')
cal ratio is  0.7811899822069625
cal_distance is  tensor(523.6409, device='cuda:3')
cal ratio is  0.8838480970361233
cal_distance is  tensor(462.8198, device='cuda:3')
________________________________
test distance is  tensor(462.8198, device='cuda:3')
test similarity is  tensor(0.9551, device='cuda:3')
test acc is  0.10000000015633198
test loss is 12529.160057344416
test entropy is  0.0
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  12525.687086678772
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9551, device='cuda:3')
compute_distance is  tensor(462.8198, device='cuda:3')
compute_norm is  tensor(81.8678, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.6276212173230105
avg test loss is  2.809240495218143
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0591, device='cuda:3')
compute_distance is  tensor(495917.9688, device='cuda:3')
compute_norm is  tensor(30253.3613, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.0603555674746092
avg test loss is  3.3971393110909696
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0591, device='cuda:3')
compute_distance is  tensor(493598.7500, device='cuda:3')
compute_norm is  tensor(30112.0801, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9779115056813653
avg test loss is  3.456779890477276
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0591, device='cuda:3')
compute_distance is  tensor(491290.5312, device='cuda:3')
compute_norm is  tensor(29971.3984, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.5372504602108936
avg test loss is  2.8700175819112292
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0591, device='cuda:3')
compute_distance is  tensor(488992.6562, device='cuda:3')
compute_norm is  tensor(29830.9258, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(486705.9688, device='cuda:3')
test similarity is  tensor(-0.0591, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.34434598569931
test entropy is  1.0430724718677464
________________________________
cal ratio is  0.028990859651957447
cal_distance is  tensor(14110.0205, device='cuda:3')
cal ratio is  0.1702670422749092
cal_distance is  tensor(2402.4680, device='cuda:3')
cal ratio is  0.41263456479733374
cal_distance is  tensor(991.3389, device='cuda:3')
cal ratio is  0.6423671763423016
cal_distance is  tensor(636.8020, device='cuda:3')
cal ratio is  0.801479104371742
cal_distance is  tensor(510.3828, device='cuda:3')
cal ratio is  0.8952542740427667
cal_distance is  tensor(456.9220, device='cuda:3')
________________________________
test distance is  tensor(456.9220, device='cuda:3')
test similarity is  tensor(0.8554, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.802737204504928
test entropy is  1.6574793365210103
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.6573159892930152
avg test loss is  2.8034324241853725
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8554, device='cuda:3')
compute_distance is  tensor(456.9220, device='cuda:3')
compute_norm is  tensor(70.8996, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  0.7274479677300971
avg test loss is  2.8987409557615007
avg accuracy is  0.10005000015633199
solo acc is  0.10051666682299865
compute similarity  is  tensor(0.8555, device='cuda:3')
compute_distance is  tensor(456.8097, device='cuda:3')
compute_norm is  tensor(70.7432, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.1029504948079205
avg test loss is  1.899746582452168
avg accuracy is  0.10180000015633196
solo acc is  0.16518333348966768
compute similarity  is  tensor(0.8554, device='cuda:3')
compute_distance is  tensor(457.9045, device='cuda:3')
compute_norm is  tensor(70.2264, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.6708468877430409
avg test loss is  2.614725197047821
avg accuracy is  0.10018333348966532
solo acc is  0.10140000015633197
compute similarity  is  tensor(0.8554, device='cuda:3')
compute_distance is  tensor(457.6371, device='cuda:3')
compute_norm is  tensor(70.0132, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.0362658780902179
avg test loss is  1.8251388920649791
avg accuracy is  0.10256666682299863
solo acc is  0.18345000015633553
compute similarity  is  tensor(0.8552, device='cuda:3')
compute_distance is  tensor(459.0514, device='cuda:3')
compute_norm is  tensor(69.5824, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(458.8576, device='cuda:3')
test similarity is  tensor(0.8551, device='cuda:3')
test acc is  0.10028333348966531
test loss is 2.5205991735844724
test entropy is  0.6492843838897087
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.6492020092539187
avg test loss is  2.521785068613634
avg accuracy is  0.10048333348966532
solo acc is  0.1019333334896653
compute similarity  is  tensor(0.8551, device='cuda:3')
compute_distance is  tensor(458.8576, device='cuda:3')
compute_norm is  tensor(69.3497, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.0138802355540586
avg test loss is  1.683758038320521
avg accuracy is  0.10241666682299863
solo acc is  0.2067833334896701
compute similarity  is  tensor(0.8549, device='cuda:3')
compute_distance is  tensor(460.3181, device='cuda:3')
compute_norm is  tensor(68.9469, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.6324232597467996
avg test loss is  2.445997375415078
avg accuracy is  0.10038333348966531
solo acc is  0.10295000015633197
compute similarity  is  tensor(0.8548, device='cuda:3')
compute_distance is  tensor(460.1013, device='cuda:3')
compute_norm is  tensor(68.7040, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9879179093629312
avg test loss is  1.628477998506794
avg accuracy is  0.10155000015633196
solo acc is  0.22126666682300403
compute similarity  is  tensor(0.8546, device='cuda:3')
compute_distance is  tensor(461.2959, device='cuda:3')
compute_norm is  tensor(68.3127, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(461.2959, device='cuda:3')
test similarity is  tensor(0.8546, device='cuda:3')
test acc is  0.10173333348966532
test loss is 1.6236479624248008
test entropy is  0.9858343826809417
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.4056259393692017
mal norm is  tensor(17.7961, device='cuda:3')
mal distance is  tensor(461.2959, device='cuda:3')
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [12]
alphas 3 is [1.  0.5]
alphas is  [0.66666667 0.33333333]
median_weights acc is  0.1010000001570001
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 10.21% 

Test Accuracy: 10.00% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
 benign loss is  2.290587902069092
benign distance is  tensor(86.5505, device='cuda:3')
norm1 res is  tensor(0.1755, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  2.0818541049957275
benign distance is  tensor(90.1774, device='cuda:3')
norm1 res is  tensor(0.1995, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  2.303281784057617
benign distance is  tensor(94.4304, device='cuda:3')
norm1 res is  tensor(0.2470, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  2.2394840717315674
benign distance is  tensor(76.3721, device='cuda:3')
norm1 res is  tensor(0.1451, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  1.3816440105438232
benign distance is  tensor(99.1940, device='cuda:3')
norm1 res is  tensor(0.1558, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  2.3337318897247314
benign distance is  tensor(82.9242, device='cuda:3')
norm1 res is  tensor(0.1574, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  1.7635475397109985
benign distance is  tensor(106.9339, device='cuda:3')
norm1 res is  tensor(0.2114, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  2.1804380416870117
benign distance is  tensor(54.1346, device='cuda:3')
norm1 res is  tensor(0.1051, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  2.1536736488342285
benign distance is  tensor(115.4603, device='cuda:3')
norm1 res is  tensor(0.3119, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  1.5928105115890503
benign distance is  tensor(123.5777, device='cuda:3')
norm1 res is  tensor(0.2123, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  2.196787118911743
benign distance is  tensor(256.6821, device='cuda:3')
norm1 res is  tensor(0.7019, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  1.2024176120758057
benign distance is  tensor(99.2208, device='cuda:3')
norm1 res is  tensor(0.1562, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  2.4141812324523926
benign distance is  tensor(164.6493, device='cuda:3')
norm1 res is  tensor(0.4664, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  2.1640985012054443
benign distance is  tensor(92.2664, device='cuda:3')
norm1 res is  tensor(0.1746, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  2.313119649887085
benign distance is  tensor(84.7353, device='cuda:3')
norm1 res is  tensor(0.1539, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  1.329779863357544
benign distance is  tensor(83.0834, device='cuda:3')
norm1 res is  tensor(0.1375, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(484.0754, device='cuda:3')
compute norm is  tensor(48.1528, device='cuda:3')
compute distance is  tensor(478.0522, device='cuda:3')
compute norm is  tensor(47.9321, device='cuda:3')
compute distance is  tensor(478.6440, device='cuda:3')
compute norm is  tensor(48.3825, device='cuda:3')
compute distance is  tensor(482.6080, device='cuda:3')
compute norm is  tensor(48.1675, device='cuda:3')
compute distance is  tensor(489.4524, device='cuda:3')
compute norm is  tensor(48.7524, device='cuda:3')
compute distance is  tensor(476.4680, device='cuda:3')
compute norm is  tensor(48.0910, device='cuda:3')
compute distance is  tensor(480.0942, device='cuda:3')
compute norm is  tensor(47.8499, device='cuda:3')
compute distance is  tensor(470.4282, device='cuda:3')
compute norm is  tensor(47.7726, device='cuda:3')
compute distance is  tensor(481.2679, device='cuda:3')
compute norm is  tensor(48.0638, device='cuda:3')
compute distance is  tensor(473.8587, device='cuda:3')
compute norm is  tensor(48.0949, device='cuda:3')
compute distance is  tensor(488.1595, device='cuda:3')
compute norm is  tensor(48.4603, device='cuda:3')
compute distance is  tensor(492.0360, device='cuda:3')
compute norm is  tensor(48.2971, device='cuda:3')
distance Threshold  is  tensor(492.0360, device='cuda:3')
________________________________
test distance is  tensor(1105596.8750, device='cuda:3')
test similarity is  tensor(0.6135, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.3550021754073e+17
test entropy is  0.0
________________________________
cal ratio is  0.018986397675209363
cal_distance is  tensor(20991.3066, device='cuda:3')
cal ratio is  0.13779111796054658
cal_distance is  tensor(2892.4224, device='cuda:3')
cal ratio is  0.3712018367563374
cal_distance is  tensor(1073.6772, device='cuda:3')
cal ratio is  0.6092619989232599
cal_distance is  tensor(654.1536, device='cuda:3')
cal ratio is  0.7805506792110367
cal_distance is  tensor(510.6016, device='cuda:3')
cal ratio is  0.8834864088269538
cal_distance is  tensor(451.1104, device='cuda:3')
________________________________
test distance is  tensor(451.1104, device='cuda:3')
test similarity is  tensor(0.9255, device='cuda:3')
test acc is  0.10000000015633198
test loss is 5214.018957597615
test entropy is  0.0
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  5215.0534886602145
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9255, device='cuda:3')
compute_distance is  tensor(451.1104, device='cuda:3')
compute_norm is  tensor(77.3433, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.6426669934919393
avg test loss is  2.7880225504385128
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2778, device='cuda:3')
compute_distance is  tensor(4099.3315, device='cuda:3')
compute_norm is  tensor(294.6441, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.0637021618865445
avg test loss is  3.3221263603360924
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2779, device='cuda:3')
compute_distance is  tensor(4079.7715, device='cuda:3')
compute_norm is  tensor(293.9116, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9043935132560446
avg test loss is  3.516785272148881
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2779, device='cuda:3')
compute_distance is  tensor(4059.8774, device='cuda:3')
compute_norm is  tensor(292.7320, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.5050122885307524
avg test loss is  2.8960646319745194
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2778, device='cuda:3')
compute_distance is  tensor(4039.2939, device='cuda:3')
compute_norm is  tensor(290.6932, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(4019.9165, device='cuda:3')
test similarity is  tensor(0.2779, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.3512252398899625
test entropy is  1.0347441345898074
________________________________
cal ratio is  0.31487084738312754
cal_distance is  tensor(1265.7571, device='cuda:3')
cal ratio is  0.5611329657252017
cal_distance is  tensor(710.2596, device='cuda:3')
cal ratio is  0.7490872324368428
cal_distance is  tensor(532.0473, device='cuda:3')
cal ratio is  0.8654975466767817
cal_distance is  tensor(460.4861, device='cuda:3')
________________________________
test distance is  tensor(460.4861, device='cuda:3')
test similarity is  tensor(0.8496, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.485446783016994
test entropy is  2.064204191856547
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.0640630409407463
avg test loss is  2.485368471664152
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8496, device='cuda:3')
compute_distance is  tensor(460.4861, device='cuda:3')
compute_norm is  tensor(75.0835, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.07563007106659
avg test loss is  3.313211631419054
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8496, device='cuda:3')
compute_distance is  tensor(458.6245, device='cuda:3')
compute_norm is  tensor(75.6678, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.8728194330165635
avg test loss is  3.55789332679594
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8496, device='cuda:3')
compute_distance is  tensor(455.8461, device='cuda:3')
compute_norm is  tensor(75.5240, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.5376073388911005
avg test loss is  2.86992527884461
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8496, device='cuda:3')
compute_distance is  tensor(452.1083, device='cuda:3')
compute_norm is  tensor(74.5533, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  0.9554223585992988
avg test loss is  3.4453548025220697
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8496, device='cuda:3')
compute_distance is  tensor(449.8811, device='cuda:3')
compute_norm is  tensor(74.7638, device='cuda:3')
++++++++++++++++++++
change alpha
________________________________
test distance is  tensor(446.4268, device='cuda:3')
test similarity is  tensor(0.8496, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.867734700377816
test entropy is  1.539124530515691
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.5389460658213732
avg test loss is  2.8674043480521325
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8496, device='cuda:3')
compute_distance is  tensor(446.4268, device='cuda:3')
compute_norm is  tensor(73.8718, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  0.9599230387953045
avg test loss is  3.4366291680061485
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8496, device='cuda:3')
compute_distance is  tensor(444.3287, device='cuda:3')
compute_norm is  tensor(74.0912, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.5376693955870833
avg test loss is  2.8682670687307428
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8496, device='cuda:3')
compute_distance is  tensor(441.0444, device='cuda:3')
compute_norm is  tensor(73.1987, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9618224913377498
avg test loss is  3.4333591613688195
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8495, device='cuda:3')
compute_distance is  tensor(439.1067, device='cuda:3')
compute_norm is  tensor(73.4247, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.5361791657232273
avg test loss is  2.869090249797683
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8496, device='cuda:3')
compute_distance is  tensor(436.0365, device='cuda:3')
compute_norm is  tensor(72.5310, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(434.2940, device='cuda:3')
test similarity is  tensor(0.8495, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.430588704944928
test entropy is  0.9637353364338499
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 3.2992141246795654
mal norm is  tensor(18.8150, device='cuda:3')
mal distance is  tensor(434.2940, device='cuda:3')
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [10, 12]
alphas 3 is [1.         0.2        0.33333333]
alphas is  [0.65217391 0.13043478 0.2173913 ]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
 benign loss is  2.344092845916748
benign distance is  tensor(3.6754, device='cuda:3')
norm1 res is  tensor(0.0362, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  2.3327224254608154
benign distance is  tensor(3.5729, device='cuda:3')
norm1 res is  tensor(0.0363, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  2.261133909225464
benign distance is  tensor(3.8230, device='cuda:3')
norm1 res is  tensor(0.0389, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  2.231156826019287
benign distance is  tensor(3.4721, device='cuda:3')
norm1 res is  tensor(0.0362, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  2.3236193656921387
benign distance is  tensor(3.8108, device='cuda:3')
norm1 res is  tensor(0.0384, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  2.3421263694763184
benign distance is  tensor(3.5223, device='cuda:3')
norm1 res is  tensor(0.0363, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  2.3312857151031494
benign distance is  tensor(3.5297, device='cuda:3')
norm1 res is  tensor(0.0356, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  2.3024964332580566
benign distance is  tensor(3.3530, device='cuda:3')
norm1 res is  tensor(0.0333, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  2.2954940795898438
benign distance is  tensor(3.5466, device='cuda:3')
norm1 res is  tensor(0.0363, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  2.2731449604034424
benign distance is  tensor(3.6862, device='cuda:3')
norm1 res is  tensor(0.0386, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  2.274977207183838
benign distance is  tensor(3.4066, device='cuda:3')
norm1 res is  tensor(0.0348, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  2.3116683959960938
benign distance is  tensor(3.5355, device='cuda:3')
norm1 res is  tensor(0.0363, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  2.3472139835357666
benign distance is  tensor(3.6207, device='cuda:3')
norm1 res is  tensor(0.0376, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  2.3714356422424316
benign distance is  tensor(3.3244, device='cuda:3')
norm1 res is  tensor(0.0335, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  2.2685718536376953
benign distance is  tensor(3.5243, device='cuda:3')
norm1 res is  tensor(0.0358, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  2.325191020965576
benign distance is  tensor(3.5397, device='cuda:3')
norm1 res is  tensor(0.0373, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  2.3040359020233154
benign distance is  tensor(3.4291, device='cuda:3')
norm1 res is  tensor(0.0367, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  2.287196636199951
benign distance is  tensor(3.9279, device='cuda:3')
norm1 res is  tensor(0.0388, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  2.4436774253845215
benign distance is  tensor(3.6880, device='cuda:3')
norm1 res is  tensor(0.0381, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  2.3482394218444824
benign distance is  tensor(3.7818, device='cuda:3')
norm1 res is  tensor(0.0380, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  2.2724804878234863
benign distance is  tensor(3.4034, device='cuda:3')
norm1 res is  tensor(0.0338, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  2.26632022857666
benign distance is  tensor(3.8243, device='cuda:3')
norm1 res is  tensor(0.0383, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  2.2964818477630615
benign distance is  tensor(3.8125, device='cuda:3')
norm1 res is  tensor(0.0381, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  2.28322434425354
benign distance is  tensor(3.6056, device='cuda:3')
norm1 res is  tensor(0.0367, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(498.6570, device='cuda:3')
compute norm is  tensor(49.1650, device='cuda:3')
compute distance is  tensor(498.1845, device='cuda:3')
compute norm is  tensor(49.0460, device='cuda:3')
compute distance is  tensor(489.2522, device='cuda:3')
compute norm is  tensor(48.8195, device='cuda:3')
compute distance is  tensor(488.1642, device='cuda:3')
compute norm is  tensor(48.5199, device='cuda:3')
compute distance is  tensor(498.1713, device='cuda:3')
compute norm is  tensor(49.3260, device='cuda:3')
compute distance is  tensor(497.6291, device='cuda:3')
compute norm is  tensor(49.4748, device='cuda:3')
compute distance is  tensor(487.1927, device='cuda:3')
compute norm is  tensor(49.0040, device='cuda:3')
compute distance is  tensor(487.8006, device='cuda:3')
compute norm is  tensor(48.6744, device='cuda:3')
compute distance is  tensor(491.1853, device='cuda:3')
compute norm is  tensor(48.9331, device='cuda:3')
compute distance is  tensor(494.8210, device='cuda:3')
compute norm is  tensor(48.7707, device='cuda:3')
compute distance is  tensor(494.8285, device='cuda:3')
compute norm is  tensor(49.5664, device='cuda:3')
compute distance is  tensor(490.9584, device='cuda:3')
compute norm is  tensor(48.8339, device='cuda:3')
distance Threshold  is  tensor(498.6570, device='cuda:3')
________________________________
test distance is  tensor(1105703.8750, device='cuda:3')
test similarity is  tensor(0.5175, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.358656598790099e+17
test entropy is  0.0
________________________________
cal ratio is  0.019112788502392224
cal_distance is  tensor(21133.0918, device='cuda:3')
cal ratio is  0.13824898759652737
cal_distance is  tensor(2921.6353, device='cuda:3')
cal ratio is  0.3718180532689984
cal_distance is  tensor(1086.3214, device='cuda:3')
cal ratio is  0.6097675379662624
cal_distance is  tensor(662.4064, device='cuda:3')
cal ratio is  0.780874445866632
cal_distance is  tensor(517.2579, device='cuda:3')
cal ratio is  0.8836696207676922
cal_distance is  tensor(457.0859, device='cuda:3')
________________________________
test distance is  tensor(457.0859, device='cuda:3')
test similarity is  tensor(0.9038, device='cuda:3')
test acc is  0.10000000015633198
test loss is 56.588290497184055
test entropy is  0.07044123488166598
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07030168327310288
avg test loss is  56.67202735608066
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9038, device='cuda:3')
compute_distance is  tensor(457.0859, device='cuda:3')
compute_norm is  tensor(77.7525, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.5348605142473413
avg test loss is  2.78890354851924
avg accuracy is  0.10000000015633198
solo acc is  0.10911666682299861
compute similarity  is  tensor(0.9046, device='cuda:3')
compute_distance is  tensor(450.3022, device='cuda:3')
compute_norm is  tensor(77.4010, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.9130284138071512
avg test loss is  3.4437600305593854
avg accuracy is  0.10000000015633198
solo acc is  0.10045000015633199
compute similarity  is  tensor(0.9047, device='cuda:3')
compute_distance is  tensor(448.8810, device='cuda:3')
compute_norm is  tensor(77.3296, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.5091918799668742
avg test loss is  2.766394121560461
avg accuracy is  0.10000000015633198
solo acc is  0.11106666682299862
compute similarity  is  tensor(0.9046, device='cuda:3')
compute_distance is  tensor(446.6458, device='cuda:3')
compute_norm is  tensor(76.6693, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  0.8752583574130337
avg test loss is  3.2797542581680235
avg accuracy is  0.10000000015633198
solo acc is  0.10175000015633198
compute similarity  is  tensor(0.9047, device='cuda:3')
compute_distance is  tensor(445.0340, device='cuda:3')
compute_norm is  tensor(76.5382, device='cuda:3')
++++++++++++++++++++
change alpha
________________________________
test distance is  tensor(443.4305, device='cuda:3')
test similarity is  tensor(0.9045, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.230248190700881
test entropy is  1.3187303981547163
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.317982273315316
avg test loss is  2.233283135047091
avg accuracy is  0.10000000015633198
solo acc is  0.16626666682300115
compute similarity  is  tensor(0.9045, device='cuda:3')
compute_distance is  tensor(443.4305, device='cuda:3')
compute_norm is  tensor(75.9632, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  0.8062877093932268
avg test loss is  2.9616969234145274
avg accuracy is  0.10000000015633198
solo acc is  0.10606666682299862
compute similarity  is  tensor(0.9045, device='cuda:3')
compute_distance is  tensor(441.9504, device='cuda:3')
compute_norm is  tensor(75.8302, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.2499599909223218
avg test loss is  2.087767381530835
avg accuracy is  0.10000000015633198
solo acc is  0.17715000015633525
compute similarity  is  tensor(0.9043, device='cuda:3')
compute_distance is  tensor(440.6248, device='cuda:3')
compute_norm is  tensor(75.3472, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.7859498594742594
avg test loss is  2.8059535377315368
avg accuracy is  0.10000000015633198
solo acc is  0.10943333348966529
compute similarity  is  tensor(0.9043, device='cuda:3')
compute_distance is  tensor(439.1296, device='cuda:3')
compute_norm is  tensor(75.1980, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.1865358127713965
avg test loss is  1.969956910813541
avg accuracy is  0.10000000015633198
solo acc is  0.20950000015633694
compute similarity  is  tensor(0.9040, device='cuda:3')
compute_distance is  tensor(437.8520, device='cuda:3')
compute_norm is  tensor(74.7482, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(436.4146, device='cuda:3')
test similarity is  tensor(0.9040, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.736058701584334
test entropy is  0.7624205599969892
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.7606413000936447
avg test loss is  2.7424997586939637
avg accuracy is  0.10000000015633198
solo acc is  0.10550000015633197
compute similarity  is  tensor(0.9040, device='cuda:3')
compute_distance is  tensor(436.4146, device='cuda:3')
compute_norm is  tensor(74.5655, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.2007722351342631
avg test loss is  1.9298169455294416
avg accuracy is  0.10000000015633198
solo acc is  0.17593333348966847
compute similarity  is  tensor(0.9038, device='cuda:3')
compute_distance is  tensor(435.1144, device='cuda:3')
compute_norm is  tensor(74.1567, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.7425338617647126
avg test loss is  2.6434591024923426
avg accuracy is  0.10000000015633198
solo acc is  0.10713333348966529
compute similarity  is  tensor(0.9037, device='cuda:3')
compute_distance is  tensor(433.8073, device='cuda:3')
compute_norm is  tensor(73.9584, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.1160526046239492
avg test loss is  1.851291447433073
avg accuracy is  0.10000000015633198
solo acc is  0.20011666682300308
compute similarity  is  tensor(0.9035, device='cuda:3')
compute_distance is  tensor(432.7440, device='cuda:3')
compute_norm is  tensor(73.5517, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  0.7315888909388707
avg test loss is  2.5549960408383594
avg accuracy is  0.10000000015633198
solo acc is  0.1054333334896653
compute similarity  is  tensor(0.9035, device='cuda:3')
compute_distance is  tensor(431.4788, device='cuda:3')
compute_norm is  tensor(73.3290, device='cuda:3')
++++++++++++++++++++
change alpha
________________________________
test distance is  tensor(430.6685, device='cuda:3')
test similarity is  tensor(0.9032, device='cuda:3')
test acc is  0.10000000015633198
test loss is 1.7620571588656542
test entropy is  1.0612939982526084
________________________________
final entropy
++++++++++++++++++++
after training  0
avg test entropy is  1.061323416639747
avg test loss is  1.7570569736362776
avg accuracy is  0.10000000015633198
solo acc is  0.2181166668230039
compute similarity  is  tensor(0.9032, device='cuda:3')
compute_distance is  tensor(430.6685, device='cuda:3')
compute_norm is  tensor(72.9185, device='cuda:3')
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 1.9673086404800415
mal norm is  tensor(19.9627, device='cuda:3')
mal distance is  tensor(429.4251, device='cuda:3')
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [12, 14]
alphas 3 is [1.   0.25 0.5 ]
alphas is  [0.57142857 0.14285714 0.28571429]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
 benign loss is  2.226466655731201
benign distance is  tensor(36.4197, device='cuda:3')
norm1 res is  tensor(0.0715, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  1.6823351383209229
benign distance is  tensor(66.8271, device='cuda:3')
norm1 res is  tensor(0.1191, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  2.320760488510132
benign distance is  tensor(37.6251, device='cuda:3')
norm1 res is  tensor(0.1228, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  2.2895445823669434
benign distance is  tensor(108.7303, device='cuda:3')
norm1 res is  tensor(0.4022, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  1.6806116104125977
benign distance is  tensor(33.4849, device='cuda:3')
norm1 res is  tensor(0.0730, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  1.8543651103973389
benign distance is  tensor(58.1366, device='cuda:3')
norm1 res is  tensor(0.1022, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  1.6441062688827515
benign distance is  tensor(67.2692, device='cuda:3')
norm1 res is  tensor(0.1322, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  1.6790130138397217
benign distance is  tensor(37.9185, device='cuda:3')
norm1 res is  tensor(0.0759, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  2.095111131668091
benign distance is  tensor(60.7993, device='cuda:3')
norm1 res is  tensor(0.1100, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  0.9964573979377747
benign distance is  tensor(84.1789, device='cuda:3')
norm1 res is  tensor(0.1297, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  2.288050889968872
benign distance is  tensor(63.8551, device='cuda:3')
norm1 res is  tensor(0.1994, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  1.9864790439605713
benign distance is  tensor(43.9806, device='cuda:3')
norm1 res is  tensor(0.0980, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  1.6171867847442627
benign distance is  tensor(66.9956, device='cuda:3')
norm1 res is  tensor(0.1206, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  1.8726648092269897
benign distance is  tensor(51.0429, device='cuda:3')
norm1 res is  tensor(0.1001, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  1.3035852909088135
benign distance is  tensor(77.4394, device='cuda:3')
norm1 res is  tensor(0.1331, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  1.7894493341445923
benign distance is  tensor(87.7637, device='cuda:3')
norm1 res is  tensor(0.1642, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  2.0403828620910645
benign distance is  tensor(85.2192, device='cuda:3')
norm1 res is  tensor(0.1502, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  1.4223319292068481
benign distance is  tensor(113.8381, device='cuda:3')
norm1 res is  tensor(0.2835, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  1.980187177658081
benign distance is  tensor(74.0024, device='cuda:3')
norm1 res is  tensor(0.2318, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  1.6287479400634766
benign distance is  tensor(72.5927, device='cuda:3')
norm1 res is  tensor(0.1196, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  2.3107292652130127
benign distance is  tensor(27.7666, device='cuda:3')
norm1 res is  tensor(0.0746, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  2.2911298274993896
benign distance is  tensor(3.2786, device='cuda:3')
norm1 res is  tensor(0.0343, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  2.0520553588867188
benign distance is  tensor(61.8263, device='cuda:3')
norm1 res is  tensor(0.1154, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  2.233243703842163
benign distance is  tensor(290.0840, device='cuda:3')
norm1 res is  tensor(0.8795, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(412.1330, device='cuda:3')
compute norm is  tensor(55.3160, device='cuda:3')
compute distance is  tensor(424.9874, device='cuda:3')
compute norm is  tensor(56.3013, device='cuda:3')
compute distance is  tensor(420.8545, device='cuda:3')
compute norm is  tensor(56.0463, device='cuda:3')
compute distance is  tensor(420.9332, device='cuda:3')
compute norm is  tensor(55.7674, device='cuda:3')
compute distance is  tensor(425.7224, device='cuda:3')
compute norm is  tensor(55.7341, device='cuda:3')
compute distance is  tensor(419.9832, device='cuda:3')
compute norm is  tensor(55.4922, device='cuda:3')
compute distance is  tensor(416.6979, device='cuda:3')
compute norm is  tensor(55.6645, device='cuda:3')
compute distance is  tensor(409.5889, device='cuda:3')
compute norm is  tensor(55.2343, device='cuda:3')
compute distance is  tensor(422.2754, device='cuda:3')
compute norm is  tensor(55.8209, device='cuda:3')
compute distance is  tensor(433.9340, device='cuda:3')
compute norm is  tensor(57.1314, device='cuda:3')
compute distance is  tensor(428.0519, device='cuda:3')
compute norm is  tensor(55.9052, device='cuda:3')
compute distance is  tensor(419.1598, device='cuda:3')
compute norm is  tensor(55.6479, device='cuda:3')
distance Threshold  is  tensor(433.9340, device='cuda:3')
________________________________
test distance is  tensor(1105490.3750, device='cuda:3')
test similarity is  tensor(0.7258, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.355912956464914e+17
test entropy is  0.0
________________________________
cal ratio is  0.01783104820586666
cal_distance is  tensor(19712.0605, device='cuda:3')
cal ratio is  0.13353292059104435
cal_distance is  tensor(2632.2156, device='cuda:3')
cal ratio is  0.36542111177234676
cal_distance is  tensor(961.8718, device='cuda:3')
cal ratio is  0.6044992619656679
cal_distance is  tensor(581.4537, device='cuda:3')
cal ratio is  0.7774935538708537
cal_distance is  tensor(452.0782, device='cuda:3')
cal ratio is  0.8817542905808559
cal_distance is  tensor(398.6228, device='cuda:3')
________________________________
test distance is  tensor(398.6228, device='cuda:3')
test similarity is  tensor(0.9617, device='cuda:3')
test acc is  0.10246666682299864
test loss is 1433.575894158532
test entropy is  1.9363119068595674e-26
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  3.357179758660938e-36
avg test loss is  1436.3471010773421
avg accuracy is  0.10255000015633196
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9617, device='cuda:3')
compute_distance is  tensor(398.6228, device='cuda:3')
compute_norm is  tensor(79.9308, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.6419953775050036
avg test loss is  2.7911798702374195
avg accuracy is  0.09928333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0330, device='cuda:3')
compute_distance is  tensor(517036.9375, device='cuda:3')
compute_norm is  tensor(30154.4316, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.0910298951399098
avg test loss is  3.294051275578643
avg accuracy is  0.10166666682299863
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0330, device='cuda:3')
compute_distance is  tensor(514618.7188, device='cuda:3')
compute_norm is  tensor(30013.9258, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9153331570279624
avg test loss is  3.5010878165393495
avg accuracy is  0.10140000015633197
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0330, device='cuda:3')
compute_distance is  tensor(512211.5312, device='cuda:3')
compute_norm is  tensor(29873.6914, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.4934841900237843
avg test loss is  2.9055375300490778
avg accuracy is  0.09913333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0330, device='cuda:3')
compute_distance is  tensor(509814.9375, device='cuda:3')
compute_norm is  tensor(29733.3125, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(507430.4688, device='cuda:3')
test similarity is  tensor(-0.0330, device='cuda:3')
test acc is  0.09646666682299868
test loss is 3.336502124251587
test entropy is  1.0459118099736253
________________________________
cal ratio is  0.026318800755304704
cal_distance is  tensor(13354.9590, device='cuda:3')
cal ratio is  0.16223071268230543
cal_distance is  tensor(2166.5818, device='cuda:3')
cal ratio is  0.4027790020804415
cal_distance is  tensor(872.6520, device='cuda:3')
cal ratio is  0.6346493193666708
cal_distance is  tensor(553.8268, device='cuda:3')
cal ratio is  0.7966496743667159
cal_distance is  tensor(441.2054, device='cuda:3')
cal ratio is  0.8925528271051273
cal_distance is  tensor(393.7989, device='cuda:3')
________________________________
test distance is  tensor(393.7989, device='cuda:3')
test similarity is  tensor(0.8418, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.5607049284713357
test entropy is  1.9771087455597005
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.9768144626861441
avg test loss is  2.5606211510294283
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8418, device='cuda:3')
compute_distance is  tensor(393.7989, device='cuda:3')
compute_norm is  tensor(73.8716, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.0644624714912383
avg test loss is  3.331743378883232
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8418, device='cuda:3')
compute_distance is  tensor(394.5590, device='cuda:3')
compute_norm is  tensor(74.3900, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.8726702571423577
avg test loss is  3.5597060087647265
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8417, device='cuda:3')
compute_distance is  tensor(394.3650, device='cuda:3')
compute_norm is  tensor(74.2366, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.536891772040426
avg test loss is  2.8698487729151876
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8418, device='cuda:3')
compute_distance is  tensor(393.1299, device='cuda:3')
compute_norm is  tensor(73.2634, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  0.962255803379677
avg test loss is  3.435783070033547
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8417, device='cuda:3')
compute_distance is  tensor(393.7957, device='cuda:3')
compute_norm is  tensor(73.4821, device='cuda:3')
++++++++++++++++++++
change alpha
________________________________
test distance is  tensor(393.0492, device='cuda:3')
test similarity is  tensor(0.8418, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8670033938340795
test entropy is  1.5378102947399814
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.5375206052367367
avg test loss is  2.8676320680423077
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8418, device='cuda:3')
compute_distance is  tensor(393.0492, device='cuda:3')
compute_norm is  tensor(72.5970, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  0.9643657991626878
avg test loss is  3.4314801286278502
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8417, device='cuda:3')
compute_distance is  tensor(393.9205, device='cuda:3')
compute_norm is  tensor(72.8234, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.5363309445665843
avg test loss is  2.868636003181116
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8417, device='cuda:3')
compute_distance is  tensor(393.4525, device='cuda:3')
compute_norm is  tensor(71.9373, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9665601522937767
avg test loss is  3.4262352658233155
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8417, device='cuda:3')
compute_distance is  tensor(394.5122, device='cuda:3')
compute_norm is  tensor(72.1689, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.5339103227993574
avg test loss is  2.870415878448405
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8417, device='cuda:3')
compute_distance is  tensor(394.2462, device='cuda:3')
compute_norm is  tensor(71.2849, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(395.4532, device='cuda:3')
test similarity is  tensor(0.8417, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.4247986464612263
test entropy is  0.9679510286494867
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 3.277559757232666
mal norm is  tensor(20.0744, device='cuda:3')
mal distance is  tensor(395.4532, device='cuda:3')
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
 benign loss is  2.3354105949401855
benign distance is  tensor(4.8834, device='cuda:3')
norm1 res is  tensor(0.0523, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  2.3233509063720703
benign distance is  tensor(5.0470, device='cuda:3')
norm1 res is  tensor(0.0524, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  2.2906837463378906
benign distance is  tensor(4.7191, device='cuda:3')
norm1 res is  tensor(0.0508, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  2.3080220222473145
benign distance is  tensor(4.7264, device='cuda:3')
norm1 res is  tensor(0.0513, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  2.328294515609741
benign distance is  tensor(4.9162, device='cuda:3')
norm1 res is  tensor(0.0533, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  2.3164587020874023
benign distance is  tensor(4.7384, device='cuda:3')
norm1 res is  tensor(0.0506, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  2.141233444213867
benign distance is  tensor(14.4843, device='cuda:3')
norm1 res is  tensor(0.0588, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  2.297252655029297
benign distance is  tensor(4.5232, device='cuda:3')
norm1 res is  tensor(0.0493, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(630.0044, device='cuda:3')
compute norm is  tensor(52.2840, device='cuda:3')
compute distance is  tensor(629.1867, device='cuda:3')
compute norm is  tensor(52.3380, device='cuda:3')
compute distance is  tensor(630.1245, device='cuda:3')
compute norm is  tensor(52.6263, device='cuda:3')
compute distance is  tensor(626.3674, device='cuda:3')
compute norm is  tensor(52.3479, device='cuda:3')
compute distance is  tensor(639.3000, device='cuda:3')
compute norm is  tensor(52.8590, device='cuda:3')
compute distance is  tensor(636.1509, device='cuda:3')
compute norm is  tensor(52.5492, device='cuda:3')
compute distance is  tensor(629.4319, device='cuda:3')
compute norm is  tensor(52.0326, device='cuda:3')
compute distance is  tensor(628.2928, device='cuda:3')
compute norm is  tensor(52.1392, device='cuda:3')
compute distance is  tensor(635.6957, device='cuda:3')
compute norm is  tensor(52.5155, device='cuda:3')
compute distance is  tensor(640.7266, device='cuda:3')
compute norm is  tensor(52.6039, device='cuda:3')
compute distance is  tensor(634.2236, device='cuda:3')
compute norm is  tensor(52.3305, device='cuda:3')
compute distance is  tensor(627.0382, device='cuda:3')
compute norm is  tensor(52.3014, device='cuda:3')
distance Threshold  is  tensor(640.7266, device='cuda:3')
________________________________
test distance is  tensor(1105653., device='cuda:3')
test similarity is  tensor(0.6019, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.356993485985631e+17
test entropy is  0.0
________________________________
cal ratio is  0.021665537370943937
cal_distance is  tensor(23954.5762, device='cuda:3')
cal ratio is  0.14719215243725348
cal_distance is  tensor(3525.9324, device='cuda:3')
cal ratio is  0.3836559175354885
cal_distance is  tensor(1352.7493, device='cuda:3')
cal ratio is  0.6193986375553696
cal_distance is  tensor(837.8939, device='cuda:3')
cal ratio is  0.7870175143798974
cal_distance is  tensor(659.4387, device='cuda:3')
cal ratio is  0.8871389961084613
cal_distance is  tensor(585.0147, device='cuda:3')
________________________________
test distance is  tensor(585.0147, device='cuda:3')
test similarity is  tensor(0.9161, device='cuda:3')
test acc is  0.10000000015633198
test loss is 18139.32277056403
test entropy is  0.0
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  18135.73358583755
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9161, device='cuda:3')
compute_distance is  tensor(585.0147, device='cuda:3')
compute_norm is  tensor(93.0988, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.5575828927158037
avg test loss is  2.8528602496901554
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0454, device='cuda:3')
compute_distance is  tensor(170749.6719, device='cuda:3')
compute_norm is  tensor(12782.3379, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.0622746873257765
avg test loss is  3.3187574778538522
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0454, device='cuda:3')
compute_distance is  tensor(169951.1094, device='cuda:3')
compute_norm is  tensor(12723.0918, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9058679322571134
avg test loss is  3.507013455636974
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0454, device='cuda:3')
compute_distance is  tensor(169156.0781, device='cuda:3')
compute_norm is  tensor(12663.7510, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.4899549660906355
avg test loss is  2.9068144219262257
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0454, device='cuda:3')
compute_distance is  tensor(168364.3281, device='cuda:3')
compute_norm is  tensor(12603.8545, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(167576.8750, device='cuda:3')
test similarity is  tensor(0.0454, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.333494254012606
test entropy is  1.0466783278659462
________________________________
cal ratio is  0.055650855806597
cal_distance is  tensor(9325.7959, device='cuda:3')
cal ratio is  0.2359043511731034
cal_distance is  tensor(2199.9934, device='cuda:3')
cal ratio is  0.4857001117295602
cal_distance is  tensor(1068.5356, device='cuda:3')
cal ratio is  0.6969223292918696
cal_distance is  tensor(744.6854, device='cuda:3')
cal ratio is  0.8348192885861753
cal_distance is  tensor(621.6774, device='cuda:3')
________________________________
test distance is  tensor(621.6774, device='cuda:3')
test similarity is  tensor(0.7116, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.3420549409984273
test entropy is  1.0469526010535672
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.0470489069088689
avg test loss is  3.3416043395426738
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7116, device='cuda:3')
compute_distance is  tensor(621.6774, device='cuda:3')
compute_norm is  tensor(95.5921, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  0.8617690711387439
avg test loss is  3.56758287059727
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7116, device='cuda:3')
compute_distance is  tensor(619.3712, device='cuda:3')
compute_norm is  tensor(95.3321, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.5459192879418575
avg test loss is  2.86161362743581
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7113, device='cuda:3')
compute_distance is  tensor(617.7178, device='cuda:3')
compute_norm is  tensor(94.2923, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9405726282072983
avg test loss is  3.4599839309131157
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7116, device='cuda:3')
compute_distance is  tensor(615.7811, device='cuda:3')
compute_norm is  tensor(94.4093, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.5460567691687073
avg test loss is  2.860743269228986
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7113, device='cuda:3')
compute_distance is  tensor(614.7646, device='cuda:3')
compute_norm is  tensor(93.4378, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(613.3713, device='cuda:3')
test similarity is  tensor(0.7117, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.456781463328201
test entropy is  0.941422967260072
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.9417409877151822
avg test loss is  3.4564829675881845
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7117, device='cuda:3')
compute_distance is  tensor(613.3713, device='cuda:3')
compute_norm is  tensor(93.5602, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.5429362306462677
avg test loss is  2.8629402806763964
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7114, device='cuda:3')
compute_distance is  tensor(612.7001, device='cuda:3')
compute_norm is  tensor(92.5867, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.9428025862174247
avg test loss is  3.4539332799057463
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7117, device='cuda:3')
compute_distance is  tensor(611.6442, device='cuda:3')
compute_norm is  tensor(92.7148, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.5418881890870362
avg test loss is  2.862842810687734
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7114, device='cuda:3')
compute_distance is  tensor(611.2083, device='cuda:3')
compute_norm is  tensor(91.7419, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  0.9447618330846718
avg test loss is  3.450890209629083
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7117, device='cuda:3')
compute_distance is  tensor(610.3756, device='cuda:3')
compute_norm is  tensor(91.8769, device='cuda:3')
++++++++++++++++++++
change alpha
________________________________
test distance is  tensor(610.1010, device='cuda:3')
test similarity is  tensor(0.7114, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.863293972605073
test entropy is  1.5412619853578906
________________________________
final entropy
++++++++++++++++++++
after training  0
avg test entropy is  1.5417334560646432
avg test loss is  2.863168798784203
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7114, device='cuda:3')
compute_distance is  tensor(610.1010, device='cuda:3')
compute_norm is  tensor(90.9027, device='cuda:3')
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 3.2749602794647217
mal norm is  tensor(34.5830, device='cuda:3')
mal distance is  tensor(609.4448, device='cuda:3')
curent length is  20
the length of epoch_weights is  3
the length of weights_d is  3
alpha 1 is [12, 15, 16]
alphas 3 is [1.         0.16666667 0.33333333 0.5       ]
alphas is  [0.5        0.08333333 0.16666667 0.25      ]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
 benign loss is  2.282005548477173
benign distance is  tensor(3.4798, device='cuda:3')
norm1 res is  tensor(0.0364, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  2.286750078201294
benign distance is  tensor(3.5970, device='cuda:3')
norm1 res is  tensor(0.0367, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  2.3247740268707275
benign distance is  tensor(3.3494, device='cuda:3')
norm1 res is  tensor(0.0356, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  2.3014578819274902
benign distance is  tensor(3.4329, device='cuda:3')
norm1 res is  tensor(0.0377, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  2.301882743835449
benign distance is  tensor(3.4299, device='cuda:3')
norm1 res is  tensor(0.0371, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  2.3233084678649902
benign distance is  tensor(3.1499, device='cuda:3')
norm1 res is  tensor(0.0331, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  2.3100228309631348
benign distance is  tensor(3.4363, device='cuda:3')
norm1 res is  tensor(0.0359, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  2.294137477874756
benign distance is  tensor(3.0817, device='cuda:3')
norm1 res is  tensor(0.0313, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  2.3419206142425537
benign distance is  tensor(3.1059, device='cuda:3')
norm1 res is  tensor(0.0323, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  2.352398157119751
benign distance is  tensor(3.2407, device='cuda:3')
norm1 res is  tensor(0.0350, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  2.2618813514709473
benign distance is  tensor(3.3943, device='cuda:3')
norm1 res is  tensor(0.0348, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  2.3243257999420166
benign distance is  tensor(3.3178, device='cuda:3')
norm1 res is  tensor(0.0353, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  2.3123834133148193
benign distance is  tensor(3.4679, device='cuda:3')
norm1 res is  tensor(0.0370, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  2.2810304164886475
benign distance is  tensor(3.4208, device='cuda:3')
norm1 res is  tensor(0.0360, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  2.304598093032837
benign distance is  tensor(3.3732, device='cuda:3')
norm1 res is  tensor(0.0353, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  2.3052546977996826
benign distance is  tensor(3.3895, device='cuda:3')
norm1 res is  tensor(0.0349, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  2.3340632915496826
benign distance is  tensor(3.3639, device='cuda:3')
norm1 res is  tensor(0.0348, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  2.2514736652374268
benign distance is  tensor(3.3695, device='cuda:3')
norm1 res is  tensor(0.0356, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  2.2747926712036133
benign distance is  tensor(3.1629, device='cuda:3')
norm1 res is  tensor(0.0336, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  2.324843406677246
benign distance is  tensor(3.2755, device='cuda:3')
norm1 res is  tensor(0.0352, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  2.328545570373535
benign distance is  tensor(3.5027, device='cuda:3')
norm1 res is  tensor(0.0374, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  2.300790786743164
benign distance is  tensor(3.2811, device='cuda:3')
norm1 res is  tensor(0.0337, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  2.2438266277313232
benign distance is  tensor(3.3619, device='cuda:3')
norm1 res is  tensor(0.0357, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  2.3429596424102783
benign distance is  tensor(3.1769, device='cuda:3')
norm1 res is  tensor(0.0331, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  2.3056087493896484
benign distance is  tensor(3.5966, device='cuda:3')
norm1 res is  tensor(0.0371, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  2.307039976119995
benign distance is  tensor(3.2486, device='cuda:3')
norm1 res is  tensor(0.0353, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  2.330681085586548
benign distance is  tensor(3.5714, device='cuda:3')
norm1 res is  tensor(0.0367, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  2.3212738037109375
benign distance is  tensor(3.4484, device='cuda:3')
norm1 res is  tensor(0.0354, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  2.266584873199463
benign distance is  tensor(3.3386, device='cuda:3')
norm1 res is  tensor(0.0340, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  2.369565010070801
benign distance is  tensor(3.3059, device='cuda:3')
norm1 res is  tensor(0.0334, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  2.274118185043335
benign distance is  tensor(3.4329, device='cuda:3')
norm1 res is  tensor(0.0352, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  2.3729159832000732
benign distance is  tensor(3.3484, device='cuda:3')
norm1 res is  tensor(0.0362, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(636.2043, device='cuda:3')
compute norm is  tensor(62.0804, device='cuda:3')
compute distance is  tensor(639.1442, device='cuda:3')
compute norm is  tensor(61.5163, device='cuda:3')
compute distance is  tensor(726.5517, device='cuda:3')
compute norm is  tensor(78.5133, device='cuda:3')
compute distance is  tensor(640.8165, device='cuda:3')
compute norm is  tensor(61.5596, device='cuda:3')
compute distance is  tensor(635.6685, device='cuda:3')
compute norm is  tensor(61.5608, device='cuda:3')
compute distance is  tensor(632.1714, device='cuda:3')
compute norm is  tensor(60.6517, device='cuda:3')
compute distance is  tensor(636.0235, device='cuda:3')
compute norm is  tensor(62.0182, device='cuda:3')
compute distance is  tensor(637.6535, device='cuda:3')
compute norm is  tensor(61.4126, device='cuda:3')
compute distance is  tensor(648.5032, device='cuda:3')
compute norm is  tensor(62.7176, device='cuda:3')
compute distance is  tensor(642.1852, device='cuda:3')
compute norm is  tensor(61.5616, device='cuda:3')
compute distance is  tensor(639.0726, device='cuda:3')
compute norm is  tensor(61.4371, device='cuda:3')
compute distance is  tensor(641.0103, device='cuda:3')
compute norm is  tensor(61.9152, device='cuda:3')
distance Threshold  is  tensor(726.5517, device='cuda:3')
________________________________
test distance is  tensor(1105783.6250, device='cuda:3')
test similarity is  tensor(0.5080, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.358125686618653e+17
test entropy is  0.0
________________________________
cal ratio is  0.02306963369697884
cal_distance is  tensor(25510.0293, device='cuda:3')
cal ratio is  0.1518868902638252
cal_distance is  tensor(3874.6458, device='cuda:3')
cal ratio is  0.38972634418623286
cal_distance is  tensor(1510.0562, device='cuda:3')
cal ratio is  0.6242797067453856
cal_distance is  tensor(942.7000, device='cuda:3')
cal ratio is  0.7901126437821062
cal_distance is  tensor(744.8408, device='cuda:3')
cal ratio is  0.888881885907449
cal_distance is  tensor(662.0763, device='cuda:3')
________________________________
test distance is  tensor(662.0763, device='cuda:3')
test similarity is  tensor(0.8781, device='cuda:3')
test acc is  0.10000000015633198
test loss is 38537.63826375933
test entropy is  0.0
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  38564.18451201026
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8781, device='cuda:3')
compute_distance is  tensor(662.0763, device='cuda:3')
compute_norm is  tensor(95.1735, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.6152111242320746
avg test loss is  2.807602165604451
avg accuracy is  0.09895000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2746, device='cuda:3')
compute_distance is  tensor(6234.1001, device='cuda:3')
compute_norm is  tensor(453.6104, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.0865497003231983
avg test loss is  3.2930692457186894
avg accuracy is  0.10063333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2747, device='cuda:3')
compute_distance is  tensor(6204.9336, device='cuda:3')
compute_norm is  tensor(452.1133, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9128475923782219
avg test loss is  3.498940334899593
avg accuracy is  0.10051666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2748, device='cuda:3')
compute_distance is  tensor(6175.5947, device='cuda:3')
compute_norm is  tensor(450.2086, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.4923818303323757
avg test loss is  2.9046517252159525
avg accuracy is  0.0984333334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.2747, device='cuda:3')
compute_distance is  tensor(6145.7114, device='cuda:3')
compute_norm is  tensor(447.4446, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(6116.9155, device='cuda:3')
test similarity is  tensor(0.2748, device='cuda:3')
test acc is  0.09931666682299867
test loss is 3.3294187413095666
test entropy is  1.0495401009567764
________________________________
cal ratio is  0.3101769554519983
cal_distance is  tensor(1897.3291, device='cuda:3')
cal ratio is  0.556934910932706
cal_distance is  tensor(1056.6908, device='cuda:3')
cal ratio is  0.7462800098020882
cal_distance is  tensor(788.5883, device='cuda:3')
cal ratio is  0.8638744225437298
cal_distance is  tensor(681.2418, device='cuda:3')
________________________________
test distance is  tensor(681.2418, device='cuda:3')
test similarity is  tensor(0.8404, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.3594001168127
test entropy is  2.2342300623464686
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.234346680041315
avg test loss is  2.359500974480277
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8404, device='cuda:3')
compute_distance is  tensor(681.2418, device='cuda:3')
compute_norm is  tensor(93.4611, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.1770232539695462
avg test loss is  3.1990388141257933
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8405, device='cuda:3')
compute_distance is  tensor(678.7278, device='cuda:3')
compute_norm is  tensor(93.8322, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.9358927640579403
avg test loss is  3.472654493887033
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8405, device='cuda:3')
compute_distance is  tensor(675.4699, device='cuda:3')
compute_norm is  tensor(93.6764, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.5032790952654027
avg test loss is  2.896383593839877
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8405, device='cuda:3')
compute_distance is  tensor(671.4550, device='cuda:3')
compute_norm is  tensor(92.6122, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.039189677629898
avg test loss is  3.3439466877024313
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8405, device='cuda:3')
compute_distance is  tensor(668.6149, device='cuda:3')
compute_norm is  tensor(92.7199, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(665.5385, device='cuda:3')
test similarity is  tensor(0.8405, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.5156348097298955
test entropy is  0.8988260683347421
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.8988047507780192
avg test loss is  3.516256597504687
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8405, device='cuda:3')
compute_distance is  tensor(665.5385, device='cuda:3')
compute_norm is  tensor(92.4657, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.4928624352920792
avg test loss is  2.903501467409927
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8405, device='cuda:3')
compute_distance is  tensor(661.7596, device='cuda:3')
compute_norm is  tensor(91.3603, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.0438816976953926
avg test loss is  3.3370086531649266
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8405, device='cuda:3')
compute_distance is  tensor(659.1187, device='cuda:3')
compute_norm is  tensor(91.4699, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.901307205719226
avg test loss is  3.5103163175237206
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8404, device='cuda:3')
compute_distance is  tensor(656.2416, device='cuda:3')
compute_norm is  tensor(91.2276, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.487080586236169
avg test loss is  2.9079595644082596
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8405, device='cuda:3')
compute_distance is  tensor(652.6683, device='cuda:3')
compute_norm is  tensor(90.1217, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(650.2055, device='cuda:3')
test similarity is  tensor(0.8405, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.3309578699852103
test entropy is  1.0483687471733418
________________________________
final entropy
++++++++++++++++++++
after training  0
avg test entropy is  1.0493023859412431
avg test loss is  3.329350955196535
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8405, device='cuda:3')
compute_distance is  tensor(650.2055, device='cuda:3')
compute_norm is  tensor(90.2362, device='cuda:3')
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 3.2605412006378174
mal norm is  tensor(23.4761, device='cuda:3')
mal distance is  tensor(647.5231, device='cuda:3')
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
 benign loss is  2.344987392425537
benign distance is  tensor(2.8480, device='cuda:3')
norm1 res is  tensor(0.0280, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  2.308647632598877
benign distance is  tensor(2.7207, device='cuda:3')
norm1 res is  tensor(0.0254, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  2.2824161052703857
benign distance is  tensor(2.7474, device='cuda:3')
norm1 res is  tensor(0.0264, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  2.268686532974243
benign distance is  tensor(2.9557, device='cuda:3')
norm1 res is  tensor(0.0325, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  2.242009401321411
benign distance is  tensor(2.8107, device='cuda:3')
norm1 res is  tensor(0.0269, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  2.3553194999694824
benign distance is  tensor(2.9225, device='cuda:3')
norm1 res is  tensor(0.0303, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  2.266500234603882
benign distance is  tensor(2.7654, device='cuda:3')
norm1 res is  tensor(0.0273, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  2.277294158935547
benign distance is  tensor(2.6886, device='cuda:3')
norm1 res is  tensor(0.0269, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(836.8907, device='cuda:3')
compute norm is  tensor(61.1055, device='cuda:3')
compute distance is  tensor(813.0866, device='cuda:3')
compute norm is  tensor(58.5249, device='cuda:3')
compute distance is  tensor(815.9717, device='cuda:3')
compute norm is  tensor(59.0820, device='cuda:3')
compute distance is  tensor(866.0814, device='cuda:3')
compute norm is  tensor(65.3883, device='cuda:3')
compute distance is  tensor(817.3223, device='cuda:3')
compute norm is  tensor(59.9026, device='cuda:3')
compute distance is  tensor(925.8785, device='cuda:3')
compute norm is  tensor(75.5232, device='cuda:3')
compute distance is  tensor(824.3282, device='cuda:3')
compute norm is  tensor(60.8334, device='cuda:3')
compute distance is  tensor(1098.7822, device='cuda:3')
compute norm is  tensor(106.5716, device='cuda:3')
compute distance is  tensor(946.0419, device='cuda:3')
compute norm is  tensor(77.9493, device='cuda:3')
compute distance is  tensor(817.0364, device='cuda:3')
compute norm is  tensor(59.5302, device='cuda:3')
compute distance is  tensor(814.1929, device='cuda:3')
compute norm is  tensor(59.7035, device='cuda:3')
compute distance is  tensor(892.5234, device='cuda:3')
compute norm is  tensor(71.4349, device='cuda:3')
distance Threshold  is  tensor(1098.7822, device='cuda:3')
________________________________
test distance is  tensor(1106049.8750, device='cuda:3')
test similarity is  tensor(0.4203, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.36045476844379e+17
test entropy is  0.0
________________________________
cal ratio is  0.028366840962027035
cal_distance is  tensor(31375.1504, device='cuda:3')
cal ratio is  0.16842455774862558
cal_distance is  tensor(5284.3521, device='cuda:3')
cal ratio is  0.41039537162366846
cal_distance is  tensor(2168.6780, device='cuda:3')
cal ratio is  0.6406204330467633
cal_distance is  tensor(1389.3020, device='cuda:3')
cal ratio is  0.8003869320517557
cal_distance is  tensor(1111.9807, device='cuda:3')
cal ratio is  0.8946428390932041
cal_distance is  tensor(994.8264, device='cuda:3')
________________________________
test distance is  tensor(994.8264, device='cuda:3')
test similarity is  tensor(0.8088, device='cuda:3')
test acc is  0.10000000015633198
test loss is 5546.275079072411
test entropy is  0.023107916104914788
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.022830861997359914
avg test loss is  5543.208352680654
avg accuracy is  0.10000000015633198
solo acc is  0.10140000015633199
compute similarity  is  tensor(0.8088, device='cuda:3')
compute_distance is  tensor(994.8264, device='cuda:3')
compute_norm is  tensor(120.4429, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.5043101079428374
avg test loss is  2.8945793231158876
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0853, device='cuda:3')
compute_distance is  tensor(23967.0156, device='cuda:3')
compute_norm is  tensor(2130.6985, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.0467896746165717
avg test loss is  3.330820603411335
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0853, device='cuda:3')
compute_distance is  tensor(23854.2012, device='cuda:3')
compute_norm is  tensor(2121.2480, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9061583869619918
avg test loss is  3.500614466951854
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0853, device='cuda:3')
compute_distance is  tensor(23742.1074, device='cuda:3')
compute_norm is  tensor(2111.5122, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.4719564302135377
avg test loss is  2.9202096975688487
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0853, device='cuda:3')
compute_distance is  tensor(23630.4473, device='cuda:3')
compute_norm is  tensor(2100.9351, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(23519.2793, device='cuda:3')
test similarity is  tensor(0.0853, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.3123222292105017
test entropy is  1.0627721821321354
________________________________
cal ratio is  0.19452987894471294
cal_distance is  tensor(4575.2031, device='cuda:3')
cal ratio is  0.44105538897669294
cal_distance is  tensor(2017.9182, device='cuda:3')
cal ratio is  0.6641199639084734
cal_distance is  tensor(1340.1400, device='cuda:3')
cal ratio is  0.8149354881222584
cal_distance is  tensor(1092.1276, device='cuda:3')
________________________________
test distance is  tensor(1092.1276, device='cuda:3')
test similarity is  tensor(0.5132, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.1936537586549707
test entropy is  1.1771239271041936
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.178778293290372
avg test loss is  3.1913696202133766
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5132, device='cuda:3')
compute_distance is  tensor(1092.1276, device='cuda:3')
compute_norm is  tensor(144.5467, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  0.9240747701003353
avg test loss is  3.480399764422923
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5133, device='cuda:3')
compute_distance is  tensor(1086.7941, device='cuda:3')
compute_norm is  tensor(144.1262, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.4914145130338445
avg test loss is  2.904285320086774
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5130, device='cuda:3')
compute_distance is  tensor(1081.5571, device='cuda:3')
compute_norm is  tensor(142.7964, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.0486785614414256
avg test loss is  3.330014366330877
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5133, device='cuda:3')
compute_distance is  tensor(1075.9801, device='cuda:3')
compute_norm is  tensor(142.6699, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  0.9021850358575646
avg test loss is  3.507107216157893
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5134, device='cuda:3')
compute_distance is  tensor(1070.9963, device='cuda:3')
compute_norm is  tensor(142.1962, device='cuda:3')
++++++++++++++++++++
change alpha
________________________________
test distance is  tensor(1066.1539, device='cuda:3')
test similarity is  tensor(0.5130, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.910456616995431
test entropy is  1.4833057076692073
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.4833014346897475
avg test loss is  2.9110804722507373
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5130, device='cuda:3')
compute_distance is  tensor(1066.1539, device='cuda:3')
compute_norm is  tensor(140.8417, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.0521409352705169
avg test loss is  3.324321448167504
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5133, device='cuda:3')
compute_distance is  tensor(1061.0673, device='cuda:3')
compute_norm is  tensor(140.7213, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.9063965170495292
avg test loss is  3.4999337254810943
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5134, device='cuda:3')
compute_distance is  tensor(1056.5170, device='cuda:3')
compute_norm is  tensor(140.2603, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.4777136737349699
avg test loss is  2.9152066707611084
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5131, device='cuda:3')
compute_distance is  tensor(1052.1150, device='cuda:3')
compute_norm is  tensor(138.9109, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.0559940127167367
avg test loss is  3.320197919284357
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5133, device='cuda:3')
compute_distance is  tensor(1047.5201, device='cuda:3')
compute_norm is  tensor(138.7979, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(1043.3862, device='cuda:3')
test similarity is  tensor(0.5134, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.4967199530937014
test entropy is  0.9080209564298455
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 3.3230388164520264
mal norm is  tensor(72.2891, device='cuda:3')
mal distance is  tensor(1043.3862, device='cuda:3')
curent length is  20
the length of epoch_weights is  3
the length of weights_d is  3
alpha 1 is [15, 16, 18]
alphas 3 is [1.   0.2  0.25 0.5 ]
alphas is  [0.51282051 0.1025641  0.12820513 0.25641026]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
 benign loss is  2.2743310928344727
benign distance is  tensor(2.8177, device='cuda:3')
norm1 res is  tensor(0.0270, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  2.3659961223602295
benign distance is  tensor(3.0585, device='cuda:3')
norm1 res is  tensor(0.0315, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  2.294487714767456
benign distance is  tensor(2.7383, device='cuda:3')
norm1 res is  tensor(0.0251, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  2.290552854537964
benign distance is  tensor(2.6925, device='cuda:3')
norm1 res is  tensor(0.0275, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  2.2911438941955566
benign distance is  tensor(3.0149, device='cuda:3')
norm1 res is  tensor(0.0303, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  2.3469204902648926
benign distance is  tensor(2.9232, device='cuda:3')
norm1 res is  tensor(0.0287, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  2.3040335178375244
benign distance is  tensor(2.9543, device='cuda:3')
norm1 res is  tensor(0.0304, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  2.283041000366211
benign distance is  tensor(2.5073, device='cuda:3')
norm1 res is  tensor(0.0255, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  2.322019338607788
benign distance is  tensor(2.6939, device='cuda:3')
norm1 res is  tensor(0.0268, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  2.3178069591522217
benign distance is  tensor(2.7642, device='cuda:3')
norm1 res is  tensor(0.0260, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  2.304318904876709
benign distance is  tensor(2.8993, device='cuda:3')
norm1 res is  tensor(0.0289, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  2.312514305114746
benign distance is  tensor(2.8225, device='cuda:3')
norm1 res is  tensor(0.0287, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  2.331129312515259
benign distance is  tensor(2.9806, device='cuda:3')
norm1 res is  tensor(0.0302, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  2.31335711479187
benign distance is  tensor(2.7720, device='cuda:3')
norm1 res is  tensor(0.0265, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  2.2973837852478027
benign distance is  tensor(2.9373, device='cuda:3')
norm1 res is  tensor(0.0283, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  2.311478614807129
benign distance is  tensor(2.8273, device='cuda:3')
norm1 res is  tensor(0.0287, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  2.3271126747131348
benign distance is  tensor(3.0005, device='cuda:3')
norm1 res is  tensor(0.0299, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  2.3590898513793945
benign distance is  tensor(3.1403, device='cuda:3')
norm1 res is  tensor(0.0289, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  2.2717044353485107
benign distance is  tensor(2.8070, device='cuda:3')
norm1 res is  tensor(0.0288, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  2.3552238941192627
benign distance is  tensor(2.8371, device='cuda:3')
norm1 res is  tensor(0.0278, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  2.314934253692627
benign distance is  tensor(2.6054, device='cuda:3')
norm1 res is  tensor(0.0264, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  2.2905123233795166
benign distance is  tensor(2.7981, device='cuda:3')
norm1 res is  tensor(0.0278, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  2.2946465015411377
benign distance is  tensor(2.6900, device='cuda:3')
norm1 res is  tensor(0.0285, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  2.324404239654541
benign distance is  tensor(2.7184, device='cuda:3')
norm1 res is  tensor(0.0250, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  2.3695790767669678
benign distance is  tensor(2.8537, device='cuda:3')
norm1 res is  tensor(0.0271, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  2.2989468574523926
benign distance is  tensor(2.9261, device='cuda:3')
norm1 res is  tensor(0.0290, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  2.362250328063965
benign distance is  tensor(2.9675, device='cuda:3')
norm1 res is  tensor(0.0309, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  2.335644483566284
benign distance is  tensor(2.9371, device='cuda:3')
norm1 res is  tensor(0.0309, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  2.2746739387512207
benign distance is  tensor(2.8557, device='cuda:3')
norm1 res is  tensor(0.0285, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  2.338111162185669
benign distance is  tensor(2.8296, device='cuda:3')
norm1 res is  tensor(0.0282, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  2.3073670864105225
benign distance is  tensor(2.7697, device='cuda:3')
norm1 res is  tensor(0.0278, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  2.333897113800049
benign distance is  tensor(2.8072, device='cuda:3')
norm1 res is  tensor(0.0266, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(784.7913, device='cuda:3')
compute norm is  tensor(59.2033, device='cuda:3')
compute distance is  tensor(784.8920, device='cuda:3')
compute norm is  tensor(59.1681, device='cuda:3')
compute distance is  tensor(784.7706, device='cuda:3')
compute norm is  tensor(59.1108, device='cuda:3')
compute distance is  tensor(784.9789, device='cuda:3')
compute norm is  tensor(59.2505, device='cuda:3')
compute distance is  tensor(784.7274, device='cuda:3')
compute norm is  tensor(59.2023, device='cuda:3')
compute distance is  tensor(784.7915, device='cuda:3')
compute norm is  tensor(59.2260, device='cuda:3')
compute distance is  tensor(784.7114, device='cuda:3')
compute norm is  tensor(59.1652, device='cuda:3')
compute distance is  tensor(784.7637, device='cuda:3')
compute norm is  tensor(59.2355, device='cuda:3')
compute distance is  tensor(784.5837, device='cuda:3')
compute norm is  tensor(59.2102, device='cuda:3')
compute distance is  tensor(784.9005, device='cuda:3')
compute norm is  tensor(59.1839, device='cuda:3')
compute distance is  tensor(784.6738, device='cuda:3')
compute norm is  tensor(59.1651, device='cuda:3')
compute distance is  tensor(784.8333, device='cuda:3')
compute norm is  tensor(59.1952, device='cuda:3')
distance Threshold  is  tensor(784.9789, device='cuda:3')
________________________________
test distance is  tensor(1106082.1250, device='cuda:3')
test similarity is  tensor(0.3304, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.361591277231217e+17
test entropy is  0.0
________________________________
cal ratio is  0.023976059496370303
cal_distance is  tensor(26519.4961, device='cuda:3')
cal ratio is  0.15484203021781429
cal_distance is  tensor(4106.3394, device='cuda:3')
cal ratio is  0.39349940193275024
cal_distance is  tensor(1615.8464, device='cuda:3')
cal ratio is  0.6272944574717361
cal_distance is  tensor(1013.6144, device='cuda:3')
cal ratio is  0.7920181025582004
cal_distance is  tensor(802.8025, device='cuda:3')
cal ratio is  0.8899531500652739
cal_distance is  tensor(714.4573, device='cuda:3')
________________________________
test distance is  tensor(714.4573, device='cuda:3')
test similarity is  tensor(0.8726, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.5351764634728178
test entropy is  1.993645748604081
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.993471126185297
avg test loss is  2.5349851717064373
avg accuracy is  0.10000000015633198
solo acc is  0.10010000015633198
compute similarity  is  tensor(0.8726, device='cuda:3')
compute_distance is  tensor(714.4573, device='cuda:3')
compute_norm is  tensor(116.8602, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  0.9749031355386095
avg test loss is  3.416885714541112
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8726, device='cuda:3')
compute_distance is  tensor(713.8148, device='cuda:3')
compute_norm is  tensor(116.8655, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.5403925002510868
avg test loss is  2.8644700167275694
avg accuracy is  0.10000000015633198
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.8726, device='cuda:3')
compute_distance is  tensor(711.9853, device='cuda:3')
compute_norm is  tensor(115.8631, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9544596374670326
avg test loss is  3.440456839258483
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8726, device='cuda:3')
compute_distance is  tensor(711.3569, device='cuda:3')
compute_norm is  tensor(115.8075, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.5336848089435715
avg test loss is  2.869549135155261
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8726, device='cuda:3')
compute_distance is  tensor(709.5724, device='cuda:3')
compute_norm is  tensor(114.7495, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(709.0276, device='cuda:3')
test similarity is  tensor(0.8726, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.418609383772177
test entropy is  0.971853403330866
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.9715897619470096
avg test loss is  3.4190101176182597
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8726, device='cuda:3')
compute_distance is  tensor(709.0276, device='cuda:3')
compute_norm is  tensor(114.7326, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.53095442043947
avg test loss is  2.8717537010148138
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8726, device='cuda:3')
compute_distance is  tensor(707.3298, device='cuda:3')
compute_norm is  tensor(113.6761, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.9794206972569545
avg test loss is  3.409055370257607
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8726, device='cuda:3')
compute_distance is  tensor(706.8509, device='cuda:3')
compute_norm is  tensor(113.6793, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.5277398022761477
avg test loss is  2.874237522133378
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8726, device='cuda:3')
compute_distance is  tensor(705.2222, device='cuda:3')
compute_norm is  tensor(112.6187, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  0.9859025074856114
avg test loss is  3.400700634222295
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8726, device='cuda:3')
compute_distance is  tensor(704.8041, device='cuda:3')
compute_norm is  tensor(112.6369, device='cuda:3')
++++++++++++++++++++
change alpha
________________________________
test distance is  tensor(703.2426, device='cuda:3')
test similarity is  tensor(0.8726, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.875926340566769
test entropy is  1.5259622961981718
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.5262423308927622
avg test loss is  2.8753612440532206
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8726, device='cuda:3')
compute_distance is  tensor(703.2426, device='cuda:3')
compute_norm is  tensor(111.5785, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  0.9888613265968843
avg test loss is  3.3969244171561463
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8726, device='cuda:3')
compute_distance is  tensor(702.8725, device='cuda:3')
compute_norm is  tensor(111.6085, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.5241761630786252
avg test loss is  2.877169845963338
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8726, device='cuda:3')
compute_distance is  tensor(701.3538, device='cuda:3')
compute_norm is  tensor(110.5437, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9952999555479998
avg test loss is  3.388739762275712
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8726, device='cuda:3')
compute_distance is  tensor(701.0472, device='cuda:3')
compute_norm is  tensor(110.5895, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.52307458447495
avg test loss is  2.87782083467634
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8726, device='cuda:3')
compute_distance is  tensor(699.5966, device='cuda:3')
compute_norm is  tensor(109.5330, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(699.3213, device='cuda:3')
test similarity is  tensor(0.8726, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.3863380499231788
test entropy is  0.9970841118648871
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 3.237414598464966
mal norm is  tensor(31.9567, device='cuda:3')
mal distance is  tensor(699.3213, device='cuda:3')
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [18]
alphas 3 is [1.         0.33333333]
alphas is  [0.75 0.25]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
 benign loss is  2.316572904586792
benign distance is  tensor(3.5314, device='cuda:3')
norm1 res is  tensor(0.0365, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  2.2962327003479004
benign distance is  tensor(3.4791, device='cuda:3')
norm1 res is  tensor(0.0370, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  2.2552709579467773
benign distance is  tensor(3.6189, device='cuda:3')
norm1 res is  tensor(0.0385, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  2.285407066345215
benign distance is  tensor(3.5412, device='cuda:3')
norm1 res is  tensor(0.0366, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  2.307568073272705
benign distance is  tensor(3.6709, device='cuda:3')
norm1 res is  tensor(0.0394, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  2.337374210357666
benign distance is  tensor(3.3924, device='cuda:3')
norm1 res is  tensor(0.0357, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  2.293330192565918
benign distance is  tensor(3.6709, device='cuda:3')
norm1 res is  tensor(0.0396, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  2.337578773498535
benign distance is  tensor(3.3099, device='cuda:3')
norm1 res is  tensor(0.0360, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  2.3020167350769043
benign distance is  tensor(3.4369, device='cuda:3')
norm1 res is  tensor(0.0372, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  2.3175220489501953
benign distance is  tensor(3.6330, device='cuda:3')
norm1 res is  tensor(0.0379, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  2.2839198112487793
benign distance is  tensor(3.2210, device='cuda:3')
norm1 res is  tensor(0.0337, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  2.285264730453491
benign distance is  tensor(3.4244, device='cuda:3')
norm1 res is  tensor(0.0369, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  2.3064005374908447
benign distance is  tensor(3.5208, device='cuda:3')
norm1 res is  tensor(0.0372, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  2.3246374130249023
benign distance is  tensor(3.4350, device='cuda:3')
norm1 res is  tensor(0.0362, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  2.261704206466675
benign distance is  tensor(3.4465, device='cuda:3')
norm1 res is  tensor(0.0372, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  2.3410484790802
benign distance is  tensor(3.4825, device='cuda:3')
norm1 res is  tensor(0.0369, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(746.3061, device='cuda:3')
compute norm is  tensor(65.4476, device='cuda:3')
compute distance is  tensor(701.4307, device='cuda:3')
compute norm is  tensor(61.5002, device='cuda:3')
compute distance is  tensor(701.3909, device='cuda:3')
compute norm is  tensor(61.4966, device='cuda:3')
compute distance is  tensor(715.3889, device='cuda:3')
compute norm is  tensor(62.7080, device='cuda:3')
compute distance is  tensor(747.7694, device='cuda:3')
compute norm is  tensor(65.2326, device='cuda:3')
compute distance is  tensor(715.4451, device='cuda:3')
compute norm is  tensor(62.6674, device='cuda:3')
compute distance is  tensor(713.4576, device='cuda:3')
compute norm is  tensor(62.5015, device='cuda:3')
compute distance is  tensor(705.8839, device='cuda:3')
compute norm is  tensor(61.9164, device='cuda:3')
compute distance is  tensor(714.9271, device='cuda:3')
compute norm is  tensor(62.6048, device='cuda:3')
compute distance is  tensor(714.6569, device='cuda:3')
compute norm is  tensor(62.6954, device='cuda:3')
compute distance is  tensor(714.1179, device='cuda:3')
compute norm is  tensor(62.3506, device='cuda:3')
compute distance is  tensor(728.0538, device='cuda:3')
compute norm is  tensor(63.0830, device='cuda:3')
distance Threshold  is  tensor(747.7694, device='cuda:3')
________________________________
test distance is  tensor(1105605.5000, device='cuda:3')
test similarity is  tensor(0.6722, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.360452059592348e+17
test entropy is  0.0
________________________________
cal ratio is  0.023405949620783545
cal_distance is  tensor(25877.7559, device='cuda:3')
cal ratio is  0.1529900037273334
cal_distance is  tensor(3959.0444, device='cuda:3')
cal ratio is  0.3911390488955156
cal_distance is  tensor(1548.5414, device='cuda:3')
cal ratio is  0.6254101778174957
cal_distance is  tensor(968.4763, device='cuda:3')
cal ratio is  0.7908276754249903
cal_distance is  tensor(765.8994, device='cuda:3')
cal ratio is  0.8892840258620052
cal_distance is  tensor(681.1030, device='cuda:3')
________________________________
test distance is  tensor(681.1030, device='cuda:3')
test similarity is  tensor(0.9491, device='cuda:3')
test acc is  0.10600000015633197
test loss is 1549.5748533074027
test entropy is  1.32902135473526e-05
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.8700692313087117e-06
avg test loss is  1549.4489127933853
avg accuracy is  0.1063833334896653
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9491, device='cuda:3')
compute_distance is  tensor(681.1030, device='cuda:3')
compute_norm is  tensor(123.7871, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.5557132997492482
avg test loss is  2.8531671660795395
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7376, device='cuda:3')
compute_distance is  tensor(1636.2681, device='cuda:3')
compute_norm is  tensor(184.9805, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.0172807722966046
avg test loss is  3.3656033155506355
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7376, device='cuda:3')
compute_distance is  tensor(1628.2327, device='cuda:3')
compute_norm is  tensor(184.6069, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.8915434347541094
avg test loss is  3.521107960611518
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7377, device='cuda:3')
compute_distance is  tensor(1619.9451, device='cuda:3')
compute_norm is  tensor(183.9081, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.4853812275664893
avg test loss is  2.9093584678828845
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.7376, device='cuda:3')
compute_distance is  tensor(1611.0001, device='cuda:3')
compute_norm is  tensor(182.3551, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(1603.1134, device='cuda:3')
test similarity is  tensor(0.7376, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.33183593307731
test entropy is  1.046044951181676
________________________________
cal ratio is  0.6146731296230648
cal_distance is  tensor(985.3931, device='cuda:3')
cal ratio is  0.7840099929250568
cal_distance is  tensor(772.5594, device='cuda:3')
cal ratio is  0.8854426227953728
cal_distance is  tensor(684.0578, device='cuda:3')
________________________________
test distance is  tensor(684.0578, device='cuda:3')
test similarity is  tensor(0.9033, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8864172237005823
test entropy is  1.51415745243589
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.5133491100024568
avg test loss is  2.8871365249284042
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9033, device='cuda:3')
compute_distance is  tensor(684.0578, device='cuda:3')
compute_norm is  tensor(123.1834, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  0.9973307783796843
avg test loss is  3.389369303229521
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9033, device='cuda:3')
compute_distance is  tensor(680.6577, device='cuda:3')
compute_norm is  tensor(123.0863, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.5042282203113093
avg test loss is  2.893557906150818
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9032, device='cuda:3')
compute_distance is  tensor(676.2778, device='cuda:3')
compute_norm is  tensor(121.9192, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.03976547095313
avg test loss is  3.339316126125962
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9033, device='cuda:3')
compute_distance is  tensor(672.9550, device='cuda:3')
compute_norm is  tensor(121.9191, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  0.8951873061245185
avg test loss is  3.515268219559432
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9033, device='cuda:3')
compute_distance is  tensor(669.3965, device='cuda:3')
compute_norm is  tensor(121.5423, device='cuda:3')
++++++++++++++++++++
change alpha
________________________________
test distance is  tensor(665.1009, device='cuda:3')
test similarity is  tensor(0.9032, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.9050198943376033
test entropy is  1.4893950803447633
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.489834734498819
avg test loss is  2.9053294976382875
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9032, device='cuda:3')
compute_distance is  tensor(665.1009, device='cuda:3')
compute_norm is  tensor(120.2626, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.040638031354591
avg test loss is  3.3372052447882288
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9033, device='cuda:3')
compute_distance is  tensor(661.9039, device='cuda:3')
compute_norm is  tensor(120.2626, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.8953708745142036
avg test loss is  3.5139440953858627
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9033, device='cuda:3')
compute_distance is  tensor(658.4993, device='cuda:3')
compute_norm is  tensor(119.8960, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.4863631909590032
avg test loss is  2.9079667540755607
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9033, device='cuda:3')
compute_distance is  tensor(654.3804, device='cuda:3')
compute_norm is  tensor(118.6170, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.0443727158025893
avg test loss is  3.331934593125447
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9033, device='cuda:3')
compute_distance is  tensor(651.3029, device='cuda:3')
compute_norm is  tensor(118.6247, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(648.0372, device='cuda:3')
test similarity is  tensor(0.9033, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.509686060043286
test entropy is  0.8978148199983244
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 3.3439764976501465
mal norm is  tensor(29.2731, device='cuda:3')
mal distance is  tensor(648.0372, device='cuda:3')
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [20]
alphas 3 is [1.  0.5]
alphas is  [0.66666667 0.33333333]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
 benign loss is  2.2397327423095703
benign distance is  tensor(3.1051, device='cuda:3')
norm1 res is  tensor(0.0305, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  2.3004069328308105
benign distance is  tensor(3.1799, device='cuda:3')
norm1 res is  tensor(0.0306, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  2.302887201309204
benign distance is  tensor(3.2578, device='cuda:3')
norm1 res is  tensor(0.0312, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  2.296233654022217
benign distance is  tensor(3.1484, device='cuda:3')
norm1 res is  tensor(0.0334, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  2.293181896209717
benign distance is  tensor(3.1714, device='cuda:3')
norm1 res is  tensor(0.0300, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  2.296654224395752
benign distance is  tensor(3.0019, device='cuda:3')
norm1 res is  tensor(0.0291, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  2.262218475341797
benign distance is  tensor(3.2038, device='cuda:3')
norm1 res is  tensor(0.0315, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  2.2949037551879883
benign distance is  tensor(2.7663, device='cuda:3')
norm1 res is  tensor(0.0268, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  2.329303741455078
benign distance is  tensor(3.0701, device='cuda:3')
norm1 res is  tensor(0.0306, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  2.3071987628936768
benign distance is  tensor(3.1662, device='cuda:3')
norm1 res is  tensor(0.0324, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  2.2802932262420654
benign distance is  tensor(3.4674, device='cuda:3')
norm1 res is  tensor(0.0347, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  2.3239798545837402
benign distance is  tensor(3.1749, device='cuda:3')
norm1 res is  tensor(0.0306, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  2.294142961502075
benign distance is  tensor(3.0943, device='cuda:3')
norm1 res is  tensor(0.0300, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  2.265446901321411
benign distance is  tensor(3.0533, device='cuda:3')
norm1 res is  tensor(0.0304, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  2.3123884201049805
benign distance is  tensor(3.2338, device='cuda:3')
norm1 res is  tensor(0.0331, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  2.290085792541504
benign distance is  tensor(3.1049, device='cuda:3')
norm1 res is  tensor(0.0305, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(931.7396, device='cuda:3')
compute norm is  tensor(67.0611, device='cuda:3')
compute distance is  tensor(931.6143, device='cuda:3')
compute norm is  tensor(66.9705, device='cuda:3')
compute distance is  tensor(931.6245, device='cuda:3')
compute norm is  tensor(66.8878, device='cuda:3')
compute distance is  tensor(931.6639, device='cuda:3')
compute norm is  tensor(66.8917, device='cuda:3')
compute distance is  tensor(931.6061, device='cuda:3')
compute norm is  tensor(66.9983, device='cuda:3')
compute distance is  tensor(932.3279, device='cuda:3')
compute norm is  tensor(67.1841, device='cuda:3')
compute distance is  tensor(931.5731, device='cuda:3')
compute norm is  tensor(66.9563, device='cuda:3')
compute distance is  tensor(931.5602, device='cuda:3')
compute norm is  tensor(67.0223, device='cuda:3')
compute distance is  tensor(931.5919, device='cuda:3')
compute norm is  tensor(67.0329, device='cuda:3')
compute distance is  tensor(931.7585, device='cuda:3')
compute norm is  tensor(67.0445, device='cuda:3')
compute distance is  tensor(931.5889, device='cuda:3')
compute norm is  tensor(67.0807, device='cuda:3')
compute distance is  tensor(931.8295, device='cuda:3')
compute norm is  tensor(66.9765, device='cuda:3')
distance Threshold  is  tensor(932.3279, device='cuda:3')
________________________________
test distance is  tensor(1105675.1250, device='cuda:3')
test similarity is  tensor(0.6263, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.353859855135341e+17
test entropy is  0.0
________________________________
cal ratio is  0.026134433426109473
cal_distance is  tensor(28896.1992, device='cuda:3')
cal ratio is  0.16166145719617936
cal_distance is  tensor(4671.4082, device='cuda:3')
cal ratio is  0.40207118199653863
cal_distance is  tensor(1878.2429, device='cuda:3')
cal ratio is  0.6340901066300972
cal_distance is  tensor(1190.9779, device='cuda:3')
cal ratio is  0.7962968535389499
cal_distance is  tensor(948.3735, device='cuda:3')
cal ratio is  0.8923539636047796
cal_distance is  tensor(846.2856, device='cuda:3')
________________________________
test distance is  tensor(846.2856, device='cuda:3')
test similarity is  tensor(0.9296, device='cuda:3')
test acc is  0.10000000015633198
test loss is 8.661427152182247
test entropy is  0.7832199423424979
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.7804789126300609
avg test loss is  8.693498361847801
avg accuracy is  0.10000000015633198
solo acc is  0.1571500001563338
compute similarity  is  tensor(0.9296, device='cuda:3')
compute_distance is  tensor(846.2856, device='cuda:3')
compute_norm is  tensor(138.5393, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.552717658502461
avg test loss is  2.8568709460911212
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9297, device='cuda:3')
compute_distance is  tensor(844.5775, device='cuda:3')
compute_norm is  tensor(137.9527, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.8820776399264711
avg test loss is  3.531198569198153
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9297, device='cuda:3')
compute_distance is  tensor(841.2637, device='cuda:3')
compute_norm is  tensor(137.6329, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.5496837847522582
avg test loss is  2.8579486700009182
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9297, device='cuda:3')
compute_distance is  tensor(836.9339, device='cuda:3')
compute_norm is  tensor(136.6239, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  0.8912816929664693
avg test loss is  3.5192612216416705
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9297, device='cuda:3')
compute_distance is  tensor(833.7394, device='cuda:3')
compute_norm is  tensor(136.3371, device='cuda:3')
++++++++++++++++++++
change alpha
________________________________
test distance is  tensor(829.5134, device='cuda:3')
test similarity is  tensor(0.9297, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8578598476422115
test entropy is  1.5494580038829144
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.5496627932418383
avg test loss is  2.8572354509886395
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9297, device='cuda:3')
compute_distance is  tensor(829.5134, device='cuda:3')
compute_norm is  tensor(135.3268, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  0.8966613997147281
avg test loss is  3.511366304049868
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9297, device='cuda:3')
compute_distance is  tensor(826.4152, device='cuda:3')
compute_norm is  tensor(135.0613, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.5481943202171244
avg test loss is  2.858439400506172
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9297, device='cuda:3')
compute_distance is  tensor(822.2760, device='cuda:3')
compute_norm is  tensor(134.0481, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9020735278312586
avg test loss is  3.5039390038325586
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9296, device='cuda:3')
compute_distance is  tensor(819.2685, device='cuda:3')
compute_norm is  tensor(133.8021, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.548306889371323
avg test loss is  2.858133939791844
avg accuracy is  0.10000000015633198
solo acc is  0.10001666682299865
compute similarity  is  tensor(0.9297, device='cuda:3')
compute_distance is  tensor(815.2227, device='cuda:3')
compute_norm is  tensor(132.7762, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(812.3113, device='cuda:3')
test similarity is  tensor(0.9296, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.492858637624712
test entropy is  0.9095976270083934
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.9098030670619468
avg test loss is  3.4939222907715006
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9296, device='cuda:3')
compute_distance is  tensor(812.3113, device='cuda:3')
compute_norm is  tensor(132.5540, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.54499424634966
avg test loss is  2.8600864867920053
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9297, device='cuda:3')
compute_distance is  tensor(808.3332, device='cuda:3')
compute_norm is  tensor(131.5264, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.913944790485317
avg test loss is  3.487870449704656
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9296, device='cuda:3')
compute_distance is  tensor(805.5068, device='cuda:3')
compute_norm is  tensor(131.3221, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.5457486826727893
avg test loss is  2.8592948524682504
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9297, device='cuda:3')
compute_distance is  tensor(801.6140, device='cuda:3')
compute_norm is  tensor(130.2910, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  0.9186285940060483
avg test loss is  3.480978565175396
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9296, device='cuda:3')
compute_distance is  tensor(798.8706, device='cuda:3')
compute_norm is  tensor(130.1052, device='cuda:3')
++++++++++++++++++++
change alpha
________________________________
test distance is  tensor(795.1022, device='cuda:3')
test similarity is  tensor(0.9296, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.8622537609864906
test entropy is  1.5423792554879747
________________________________
final entropy
++++++++++++++++++++
after training  0
avg test entropy is  1.5424993796897595
avg test loss is  2.862272098374519
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9296, device='cuda:3')
compute_distance is  tensor(795.1022, device='cuda:3')
compute_norm is  tensor(129.0669, device='cuda:3')
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 3.1488709449768066
mal norm is  tensor(36.3808, device='cuda:3')
mal distance is  tensor(792.4803, device='cuda:3')
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
 benign loss is  2.2720260620117188
benign distance is  tensor(4.2982, device='cuda:3')
norm1 res is  tensor(0.0459, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  2.3496413230895996
benign distance is  tensor(4.4255, device='cuda:3')
norm1 res is  tensor(0.0460, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  2.284687042236328
benign distance is  tensor(4.4816, device='cuda:3')
norm1 res is  tensor(0.0467, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  2.2678334712982178
benign distance is  tensor(4.2422, device='cuda:3')
norm1 res is  tensor(0.0452, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  2.304443597793579
benign distance is  tensor(4.5251, device='cuda:3')
norm1 res is  tensor(0.0472, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  2.3314175605773926
benign distance is  tensor(4.2677, device='cuda:3')
norm1 res is  tensor(0.0445, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  2.31333589553833
benign distance is  tensor(4.3442, device='cuda:3')
norm1 res is  tensor(0.0446, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  2.3176300525665283
benign distance is  tensor(4.0973, device='cuda:3')
norm1 res is  tensor(0.0429, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(1209.4082, device='cuda:3')
compute norm is  tensor(68.1601, device='cuda:3')
compute distance is  tensor(1209.3141, device='cuda:3')
compute norm is  tensor(68.0842, device='cuda:3')
compute distance is  tensor(1209.3091, device='cuda:3')
compute norm is  tensor(68.0538, device='cuda:3')
compute distance is  tensor(1209.3932, device='cuda:3')
compute norm is  tensor(68.0942, device='cuda:3')
compute distance is  tensor(1209.2576, device='cuda:3')
compute norm is  tensor(68.1408, device='cuda:3')
compute distance is  tensor(1209.2692, device='cuda:3')
compute norm is  tensor(68.0534, device='cuda:3')
compute distance is  tensor(1209.3241, device='cuda:3')
compute norm is  tensor(68.1357, device='cuda:3')
compute distance is  tensor(1209.3981, device='cuda:3')
compute norm is  tensor(68.1106, device='cuda:3')
compute distance is  tensor(1209.2902, device='cuda:3')
compute norm is  tensor(68.1152, device='cuda:3')
compute distance is  tensor(1209.3491, device='cuda:3')
compute norm is  tensor(68.1449, device='cuda:3')
compute distance is  tensor(1209.2415, device='cuda:3')
compute norm is  tensor(68.1207, device='cuda:3')
compute distance is  tensor(1209.4641, device='cuda:3')
compute norm is  tensor(68.0787, device='cuda:3')
distance Threshold  is  tensor(1209.4641, device='cuda:3')
________________________________
test distance is  tensor(1105049.7500, device='cuda:3')
test similarity is  tensor(0.8406, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.356061230824152e+17
test entropy is  0.0
________________________________
cal ratio is  0.029774748124959824
cal_distance is  tensor(32902.5859, device='cuda:3')
cal ratio is  0.17255358275827015
cal_distance is  tensor(5677.4653, device='cuda:3')
cal ratio is  0.41539546357486956
cal_distance is  tensor(2358.3977, device='cuda:3')
cal ratio is  0.6445112329322424
cal_distance is  tensor(1520.0162, device='cuda:3')
cal ratio is  0.8028138983102918
cal_distance is  tensor(1220.2916, device='cuda:3')
cal ratio is  0.8959983136308076
cal_distance is  tensor(1093.3802, device='cuda:3')
________________________________
test distance is  tensor(1093.3802, device='cuda:3')
test similarity is  tensor(0.9722, device='cuda:3')
test acc is  0.10000000015633198
test loss is 477822.76062766527
test entropy is  0.0
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  478034.33568763325
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9722, device='cuda:3')
compute_distance is  tensor(1093.3802, device='cuda:3')
compute_norm is  tensor(179.7750, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.5425079386117362
avg test loss is  2.863589378816487
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0080, device='cuda:3')
compute_distance is  tensor(1.3552e+08, device='cuda:3')
compute_norm is  tensor(10602059., device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.0246680635633245
avg test loss is  3.3633507980720827
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0080, device='cuda:3')
compute_distance is  tensor(1.3488e+08, device='cuda:3')
compute_norm is  tensor(10552453., device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9054102510658663
avg test loss is  3.510600983969438
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0080, device='cuda:3')
compute_distance is  tensor(1.3425e+08, device='cuda:3')
compute_norm is  tensor(10503079., device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.4896941136703816
avg test loss is  2.90529963100897
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0080, device='cuda:3')
compute_distance is  tensor(1.3362e+08, device='cuda:3')
compute_norm is  tensor(10453935., device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(1.3300e+08, device='cuda:3')
test similarity is  tensor(-0.0080, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.2428565609938045
test entropy is  1.1250223948248923
________________________________
cal ratio is  0.002714043187279392
cal_distance is  tensor(360961.8125, device='cuda:3')
cal ratio is  0.05209647842266237
cal_distance is  tensor(18804.8359, device='cuda:3')
cal ratio is  0.22824655243687028
cal_distance is  tensor(4292.1367, device='cuda:3')
cal ratio is  0.477751692725496
cal_distance is  tensor(2050.5745, device='cuda:3')
cal ratio is  0.6911960308087647
cal_distance is  tensor(1417.3481, device='cuda:3')
cal ratio is  0.8313822200136435
cal_distance is  tensor(1178.3577, device='cuda:3')
________________________________
test distance is  tensor(1178.3577, device='cuda:3')
test similarity is  tensor(0.6773, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.310418281219661
test entropy is  1.0672754998654446
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.0675964063164523
avg test loss is  3.3098718024520224
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6773, device='cuda:3')
compute_distance is  tensor(1178.3577, device='cuda:3')
compute_norm is  tensor(180.1156, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  0.8634731155722889
avg test loss is  3.5562116466859766
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6773, device='cuda:3')
compute_distance is  tensor(1176.1979, device='cuda:3')
compute_norm is  tensor(179.4623, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.5385176797411335
avg test loss is  2.865666328208533
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6772, device='cuda:3')
compute_distance is  tensor(1174.4346, device='cuda:3')
compute_norm is  tensor(178.0835, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9367574018710203
avg test loss is  3.4592052095734487
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6773, device='cuda:3')
compute_distance is  tensor(1172.2046, device='cuda:3')
compute_norm is  tensor(177.7344, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.5401585564684512
avg test loss is  2.8639867379467114
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6772, device='cuda:3')
compute_distance is  tensor(1170.7583, device='cuda:3')
compute_norm is  tensor(176.4222, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(1168.7947, device='cuda:3')
test similarity is  tensor(0.6773, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.452866324483713
test entropy is  0.9412998661939015
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.9407846524771343
avg test loss is  3.4534888913128166
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6773, device='cuda:3')
compute_distance is  tensor(1168.7947, device='cuda:3')
compute_norm is  tensor(176.0912, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.5384136223589688
avg test loss is  2.8652930857021928
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6772, device='cuda:3')
compute_distance is  tensor(1167.6166, device='cuda:3')
compute_norm is  tensor(174.7763, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.9465330421670414
avg test loss is  3.445727255806994
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6773, device='cuda:3')
compute_distance is  tensor(1165.9653, device='cuda:3')
compute_norm is  tensor(174.4647, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.5363371486602815
avg test loss is  2.8666472625630752
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6772, device='cuda:3')
compute_distance is  tensor(1165.1008, device='cuda:3')
compute_norm is  tensor(173.1455, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  0.9518897509269877
avg test loss is  3.4394050717099645
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6773, device='cuda:3')
compute_distance is  tensor(1163.7147, device='cuda:3')
compute_norm is  tensor(172.8549, device='cuda:3')
++++++++++++++++++++
change alpha
________________________________
test distance is  tensor(1163.0507, device='cuda:3')
test similarity is  tensor(0.6772, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.866723266491758
test entropy is  1.5361136741983865
________________________________
final entropy
++++++++++++++++++++
after training  0
avg test entropy is  1.5358680686208486
avg test loss is  2.866955847882513
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6772, device='cuda:3')
compute_distance is  tensor(1163.0507, device='cuda:3')
compute_norm is  tensor(171.5373, device='cuda:3')
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 3.312805652618408
mal norm is  tensor(78.0303, device='cuda:3')
mal distance is  tensor(1161.8372, device='cuda:3')
curent length is  20
the length of epoch_weights is  4
the length of weights_d is  4
alpha 1 is [18, 20, 21, 22]
alphas 3 is [1.         0.16666667 0.25       0.33333333 0.5       ]
alphas is  [0.44444444 0.07407407 0.11111111 0.14814815 0.22222222]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
 benign loss is  2.324877977371216
benign distance is  tensor(2.9051, device='cuda:3')
norm1 res is  tensor(0.0287, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  2.318591594696045
benign distance is  tensor(2.7431, device='cuda:3')
norm1 res is  tensor(0.0270, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  2.3343710899353027
benign distance is  tensor(2.8813, device='cuda:3')
norm1 res is  tensor(0.0293, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  2.2662975788116455
benign distance is  tensor(2.9074, device='cuda:3')
norm1 res is  tensor(0.0287, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  2.314824342727661
benign distance is  tensor(2.8807, device='cuda:3')
norm1 res is  tensor(0.0297, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  2.2960572242736816
benign distance is  tensor(2.8684, device='cuda:3')
norm1 res is  tensor(0.0280, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  2.307039737701416
benign distance is  tensor(2.9459, device='cuda:3')
norm1 res is  tensor(0.0289, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  2.3192360401153564
benign distance is  tensor(2.6035, device='cuda:3')
norm1 res is  tensor(0.0241, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  2.3000762462615967
benign distance is  tensor(2.7764, device='cuda:3')
norm1 res is  tensor(0.0270, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  2.3249218463897705
benign distance is  tensor(2.9054, device='cuda:3')
norm1 res is  tensor(0.0291, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  2.303601026535034
benign distance is  tensor(2.8449, device='cuda:3')
norm1 res is  tensor(0.0281, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  2.2881152629852295
benign distance is  tensor(2.8426, device='cuda:3')
norm1 res is  tensor(0.0277, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  2.3054096698760986
benign distance is  tensor(2.9375, device='cuda:3')
norm1 res is  tensor(0.0302, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  2.327501058578491
benign distance is  tensor(2.8359, device='cuda:3')
norm1 res is  tensor(0.0288, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  2.3163020610809326
benign distance is  tensor(3.0860, device='cuda:3')
norm1 res is  tensor(0.0307, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  2.2883501052856445
benign distance is  tensor(2.9438, device='cuda:3')
norm1 res is  tensor(0.0290, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  2.34259033203125
benign distance is  tensor(2.7293, device='cuda:3')
norm1 res is  tensor(0.0284, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  2.264739513397217
benign distance is  tensor(3.0226, device='cuda:3')
norm1 res is  tensor(0.0296, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  2.3106160163879395
benign distance is  tensor(2.7482, device='cuda:3')
norm1 res is  tensor(0.0279, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  2.282193183898926
benign distance is  tensor(2.9294, device='cuda:3')
norm1 res is  tensor(0.0294, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  2.2763915061950684
benign distance is  tensor(2.9367, device='cuda:3')
norm1 res is  tensor(0.0283, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  2.313734292984009
benign distance is  tensor(2.7194, device='cuda:3')
norm1 res is  tensor(0.0274, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  2.315568685531616
benign distance is  tensor(2.8393, device='cuda:3')
norm1 res is  tensor(0.0287, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  2.3166675567626953
benign distance is  tensor(2.8863, device='cuda:3')
norm1 res is  tensor(0.0284, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  2.3530962467193604
benign distance is  tensor(3.0564, device='cuda:3')
norm1 res is  tensor(0.0301, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  2.3422586917877197
benign distance is  tensor(3.2511, device='cuda:3')
norm1 res is  tensor(0.0305, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  2.3246049880981445
benign distance is  tensor(2.9148, device='cuda:3')
norm1 res is  tensor(0.0281, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  2.353264331817627
benign distance is  tensor(2.6887, device='cuda:3')
norm1 res is  tensor(0.0268, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  2.299877882003784
benign distance is  tensor(2.6479, device='cuda:3')
norm1 res is  tensor(0.0266, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  2.2792744636535645
benign distance is  tensor(2.7547, device='cuda:3')
norm1 res is  tensor(0.0271, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  2.290865898132324
benign distance is  tensor(2.8244, device='cuda:3')
norm1 res is  tensor(0.0286, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  2.3210232257843018
benign distance is  tensor(2.8996, device='cuda:3')
norm1 res is  tensor(0.0292, device='cuda:3')
current submit client idx and staleness is  40 6
 benign loss is  2.2883291244506836
benign distance is  tensor(3.2150, device='cuda:3')
norm1 res is  tensor(0.0326, device='cuda:3')
current submit client idx and staleness is  41 6
 benign loss is  2.2875003814697266
benign distance is  tensor(2.7156, device='cuda:3')
norm1 res is  tensor(0.0262, device='cuda:3')
current submit client idx and staleness is  42 6
 benign loss is  2.3178489208221436
benign distance is  tensor(3.0031, device='cuda:3')
norm1 res is  tensor(0.0298, device='cuda:3')
current submit client idx and staleness is  43 6
 benign loss is  2.31363844871521
benign distance is  tensor(2.8306, device='cuda:3')
norm1 res is  tensor(0.0269, device='cuda:3')
current submit client idx and staleness is  44 6
 benign loss is  2.282677173614502
benign distance is  tensor(2.8300, device='cuda:3')
norm1 res is  tensor(0.0293, device='cuda:3')
current submit client idx and staleness is  45 6
 benign loss is  2.3423125743865967
benign distance is  tensor(2.8746, device='cuda:3')
norm1 res is  tensor(0.0285, device='cuda:3')
current submit client idx and staleness is  46 6
 benign loss is  2.2985382080078125
benign distance is  tensor(2.8968, device='cuda:3')
norm1 res is  tensor(0.0289, device='cuda:3')
current submit client idx and staleness is  47 6
 benign loss is  2.3757805824279785
benign distance is  tensor(3.0383, device='cuda:3')
norm1 res is  tensor(0.0293, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(1262.7993, device='cuda:3')
compute norm is  tensor(83.2679, device='cuda:3')
compute distance is  tensor(1262.5977, device='cuda:3')
compute norm is  tensor(83.2943, device='cuda:3')
compute distance is  tensor(1262.7056, device='cuda:3')
compute norm is  tensor(83.2410, device='cuda:3')
compute distance is  tensor(1262.8085, device='cuda:3')
compute norm is  tensor(83.2998, device='cuda:3')
compute distance is  tensor(1262.8486, device='cuda:3')
compute norm is  tensor(83.3505, device='cuda:3')
compute distance is  tensor(1262.6141, device='cuda:3')
compute norm is  tensor(83.2794, device='cuda:3')
compute distance is  tensor(1262.6941, device='cuda:3')
compute norm is  tensor(83.2978, device='cuda:3')
compute distance is  tensor(1262.7616, device='cuda:3')
compute norm is  tensor(83.3270, device='cuda:3')
compute distance is  tensor(1262.6929, device='cuda:3')
compute norm is  tensor(83.3224, device='cuda:3')
compute distance is  tensor(1262.6545, device='cuda:3')
compute norm is  tensor(83.2355, device='cuda:3')
compute distance is  tensor(1262.6940, device='cuda:3')
compute norm is  tensor(83.2777, device='cuda:3')
compute distance is  tensor(1262.8210, device='cuda:3')
compute norm is  tensor(83.3338, device='cuda:3')
distance Threshold  is  tensor(1262.8486, device='cuda:3')
________________________________
test distance is  tensor(1105687.2500, device='cuda:3')
test similarity is  tensor(0.6292, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.35646847357907e+17
test entropy is  0.0
________________________________
cal ratio is  0.030415993416928185
cal_distance is  tensor(33630.5859, device='cuda:3')
cal ratio is  0.17440179096038366
cal_distance is  tensor(5865.2412, device='cuda:3')
cal ratio is  0.4176141625208185
cal_distance is  tensor(2449.4121, device='cuda:3')
cal ratio is  0.6462301647639703
cal_distance is  tensor(1582.8865, device='cuda:3')
cal ratio is  0.803883795243891
cal_distance is  tensor(1272.4584, device='cuda:3')
cal ratio is  0.8965951200410078
cal_distance is  tensor(1140.8806, device='cuda:3')
________________________________
test distance is  tensor(1140.8806, device='cuda:3')
test similarity is  tensor(0.9210, device='cuda:3')
test acc is  0.10073333348966532
test loss is 77540.86134478278
test entropy is  0.0
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  77517.58978128331
avg accuracy is  0.10096666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.9210, device='cuda:3')
compute_distance is  tensor(1140.8806, device='cuda:3')
compute_norm is  tensor(168.5404, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.596502889702315
avg test loss is  2.8199660201062526
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0024, device='cuda:3')
compute_distance is  tensor(19358164., device='cuda:3')
compute_norm is  tensor(1847492.2500, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.1552238960001768
avg test loss is  3.2131506649415886
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0024, device='cuda:3')
compute_distance is  tensor(19267584., device='cuda:3')
compute_norm is  tensor(1838848.1250, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9675566394573082
avg test loss is  3.4218920088017675
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0024, device='cuda:3')
compute_distance is  tensor(19177434., device='cuda:3')
compute_norm is  tensor(1830244.2500, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.4451495430616936
avg test loss is  2.9424676818888327
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0024, device='cuda:3')
compute_distance is  tensor(19087706., device='cuda:3')
compute_norm is  tensor(1821680.3750, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(18998390., device='cuda:3')
test similarity is  tensor(-0.0024, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.272515780635988
test entropy is  1.097689416235698
________________________________
cal ratio is  0.007337696831931376
cal_distance is  tensor(139404.4219, device='cuda:3')
cal ratio is  0.0856603588237713
cal_distance is  tensor(11941.4336, device='cuda:3')
cal ratio is  0.2926778947908536
cal_distance is  tensor(3494.9927, device='cuda:3')
cal ratio is  0.5409972069975807
cal_distance is  tensor(1890.7808, device='cuda:3')
cal ratio is  0.7355252405065293
cal_distance is  tensor(1390.7167, device='cuda:3')
cal ratio is  0.8576277612092104
cal_distance is  tensor(1192.7170, device='cuda:3')
________________________________
test distance is  tensor(1192.7170, device='cuda:3')
test similarity is  tensor(0.5433, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.553583177167978
test entropy is  1.957098247272882
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.9570902607588372
avg test loss is  2.553411003369004
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5433, device='cuda:3')
compute_distance is  tensor(1192.7170, device='cuda:3')
compute_norm is  tensor(188.4839, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.0224537815747738
avg test loss is  3.3623903034084135
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5434, device='cuda:3')
compute_distance is  tensor(1191.3649, device='cuda:3')
compute_norm is  tensor(188.3185, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.8702514789887329
avg test loss is  3.5481522136659764
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5434, device='cuda:3')
compute_distance is  tensor(1189.5850, device='cuda:3')
compute_norm is  tensor(187.6227, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.5265391843913714
avg test loss is  2.8754363853031637
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5434, device='cuda:3')
compute_distance is  tensor(1186.9019, device='cuda:3')
compute_norm is  tensor(186.0818, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  0.976569286859366
avg test loss is  3.411822284208432
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5434, device='cuda:3')
compute_distance is  tensor(1186.0542, device='cuda:3')
compute_norm is  tensor(185.7907, device='cuda:3')
++++++++++++++++++++
change alpha
________________________________
test distance is  tensor(1183.9249, device='cuda:3')
test similarity is  tensor(0.5434, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.872447613205737
test entropy is  1.529187486369981
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.5294143169927699
avg test loss is  2.872147909359637
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5434, device='cuda:3')
compute_distance is  tensor(1183.9249, device='cuda:3')
compute_norm is  tensor(184.3655, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  0.9787445111569565
avg test loss is  3.4084465813789286
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5434, device='cuda:3')
compute_distance is  tensor(1183.2902, device='cuda:3')
compute_norm is  tensor(184.0849, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.527706189831691
avg test loss is  2.873961282945645
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5434, device='cuda:3')
compute_distance is  tensor(1181.4084, device='cuda:3')
compute_norm is  tensor(182.6613, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9803189559023517
avg test loss is  3.4054809750270234
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5434, device='cuda:3')
compute_distance is  tensor(1180.9222, device='cuda:3')
compute_norm is  tensor(182.3933, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.5258269423106585
avg test loss is  2.8751302347508574
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.5434, device='cuda:3')
compute_distance is  tensor(1179.2373, device='cuda:3')
compute_norm is  tensor(180.9684, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(1178.8723, device='cuda:3')
test similarity is  tensor(0.5434, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.4004041164922816
test entropy is  0.9852057701107789
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 3.2733700275421143
mal norm is  tensor(100.1133, device='cuda:3')
mal distance is  tensor(1178.8723, device='cuda:3')
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [20]
alphas 3 is [1.  0.2]
alphas is  [0.83333333 0.16666667]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
 benign loss is  2.3484349250793457
benign distance is  tensor(3.6212, device='cuda:3')
norm1 res is  tensor(0.0370, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  2.2942845821380615
benign distance is  tensor(3.6607, device='cuda:3')
norm1 res is  tensor(0.0386, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  2.3135554790496826
benign distance is  tensor(3.5984, device='cuda:3')
norm1 res is  tensor(0.0375, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  2.28928804397583
benign distance is  tensor(3.6874, device='cuda:3')
norm1 res is  tensor(0.0368, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  2.288532018661499
benign distance is  tensor(3.8410, device='cuda:3')
norm1 res is  tensor(0.0395, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  2.295574426651001
benign distance is  tensor(3.5302, device='cuda:3')
norm1 res is  tensor(0.0363, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  2.2986533641815186
benign distance is  tensor(3.6602, device='cuda:3')
norm1 res is  tensor(0.0387, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  2.314572811126709
benign distance is  tensor(3.3306, device='cuda:3')
norm1 res is  tensor(0.0360, device='cuda:3')
current submit client idx and staleness is  32 5
 benign loss is  2.32500958442688
benign distance is  tensor(3.6005, device='cuda:3')
norm1 res is  tensor(0.0401, device='cuda:3')
current submit client idx and staleness is  33 5
 benign loss is  2.2781450748443604
benign distance is  tensor(3.8280, device='cuda:3')
norm1 res is  tensor(0.0380, device='cuda:3')
current submit client idx and staleness is  34 5
 benign loss is  2.3331971168518066
benign distance is  tensor(3.6354, device='cuda:3')
norm1 res is  tensor(0.0372, device='cuda:3')
current submit client idx and staleness is  35 5
 benign loss is  2.3340888023376465
benign distance is  tensor(3.7864, device='cuda:3')
norm1 res is  tensor(0.0399, device='cuda:3')
current submit client idx and staleness is  36 5
 benign loss is  2.2855095863342285
benign distance is  tensor(3.4720, device='cuda:3')
norm1 res is  tensor(0.0367, device='cuda:3')
current submit client idx and staleness is  37 5
 benign loss is  2.2965896129608154
benign distance is  tensor(3.7048, device='cuda:3')
norm1 res is  tensor(0.0391, device='cuda:3')
current submit client idx and staleness is  38 5
 benign loss is  2.3061447143554688
benign distance is  tensor(3.6701, device='cuda:3')
norm1 res is  tensor(0.0394, device='cuda:3')
current submit client idx and staleness is  39 5
 benign loss is  2.294069528579712
benign distance is  tensor(3.7085, device='cuda:3')
norm1 res is  tensor(0.0390, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(1434.8160, device='cuda:3')
compute norm is  tensor(89.6339, device='cuda:3')
compute distance is  tensor(1434.7651, device='cuda:3')
compute norm is  tensor(89.6038, device='cuda:3')
compute distance is  tensor(1434.7842, device='cuda:3')
compute norm is  tensor(89.6340, device='cuda:3')
compute distance is  tensor(1434.9548, device='cuda:3')
compute norm is  tensor(89.6643, device='cuda:3')
compute distance is  tensor(1434.6678, device='cuda:3')
compute norm is  tensor(89.5805, device='cuda:3')
compute distance is  tensor(1434.6809, device='cuda:3')
compute norm is  tensor(89.5900, device='cuda:3')
compute distance is  tensor(1434.6577, device='cuda:3')
compute norm is  tensor(89.4932, device='cuda:3')
compute distance is  tensor(1434.7513, device='cuda:3')
compute norm is  tensor(89.6447, device='cuda:3')
compute distance is  tensor(1434.6418, device='cuda:3')
compute norm is  tensor(89.6843, device='cuda:3')
compute distance is  tensor(1434.7515, device='cuda:3')
compute norm is  tensor(89.6105, device='cuda:3')
compute distance is  tensor(1434.8387, device='cuda:3')
compute norm is  tensor(89.6529, device='cuda:3')
compute distance is  tensor(1434.9248, device='cuda:3')
compute norm is  tensor(89.6057, device='cuda:3')
distance Threshold  is  tensor(1434.9548, device='cuda:3')
________________________________
test distance is  tensor(1106104.2500, device='cuda:3')
test similarity is  tensor(0.3608, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.358301661593832e+17
test entropy is  0.0
________________________________
cal ratio is  0.03241631116509394
cal_distance is  tensor(35855.8320, device='cuda:3')
cal ratio is  0.18004527133623735
cal_distance is  tensor(6455.6782, device='cuda:3')
cal ratio is  0.4243172525939578
cal_distance is  tensor(2739.2598, device='cuda:3')
cal ratio is  0.6513958765943846
cal_distance is  tensor(1784.3452, device='cuda:3')
cal ratio is  0.8070904199525096
cal_distance is  tensor(1440.1293, device='cuda:3')
cal ratio is  0.8983816826108594
cal_distance is  tensor(1293.7865, device='cuda:3')
________________________________
test distance is  tensor(1293.7865, device='cuda:3')
test similarity is  tensor(0.8867, device='cuda:3')
test acc is  0.10030000015633199
test loss is 103718.91948460821
test entropy is  0.0
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  103570.28633062367
avg accuracy is  0.10043333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8867, device='cuda:3')
compute_distance is  tensor(1293.7865, device='cuda:3')
compute_norm is  tensor(204.9283, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.5514704391900411
avg test loss is  2.85484493312551
avg accuracy is  0.09933333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1899, device='cuda:3')
compute_distance is  tensor(18971.2676, device='cuda:3')
compute_norm is  tensor(1442.1366, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.087875371421578
avg test loss is  3.283212609128403
avg accuracy is  0.09968333348966532
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1900, device='cuda:3')
compute_distance is  tensor(18884.0039, device='cuda:3')
compute_norm is  tensor(1435.8717, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9269213000340248
avg test loss is  3.471087062282603
avg accuracy is  0.10055000015633199
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1900, device='cuda:3')
compute_distance is  tensor(18797.0801, device='cuda:3')
compute_norm is  tensor(1429.3560, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.4584714676271369
avg test loss is  2.930814029565498
avg accuracy is  0.09978333348966531
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.1899, device='cuda:3')
compute_distance is  tensor(18710.0898, device='cuda:3')
compute_norm is  tensor(1422.0619, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(18624.2969, device='cuda:3')
test similarity is  tensor(0.1900, device='cuda:3')
test acc is  0.09903333348966532
test loss is 3.292650283780942
test entropy is  1.0785798168639893
________________________________
cal ratio is  0.24981682981280084
cal_distance is  tensor(4652.6670, device='cuda:3')
cal ratio is  0.4998165473559459
cal_distance is  tensor(2325.4824, device='cuda:3')
cal ratio is  0.7069766939306475
cal_distance is  tensor(1644.0632, device='cuda:3')
cal ratio is  0.8408187111231212
cal_distance is  tensor(1382.3600, device='cuda:3')
________________________________
test distance is  tensor(1382.3600, device='cuda:3')
test similarity is  tensor(0.8630, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.335279660438424
test entropy is  2.2766013262368467
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.2766039478245066
avg test loss is  2.3347441873062396
avg accuracy is  0.10000000015633198
solo acc is  0.09805000015633199
compute similarity  is  tensor(0.8630, device='cuda:3')
compute_distance is  tensor(1382.3600, device='cuda:3')
compute_norm is  tensor(213.2480, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.0762774911262334
avg test loss is  3.297549562159378
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8631, device='cuda:3')
compute_distance is  tensor(1378.6123, device='cuda:3')
compute_norm is  tensor(212.7651, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.9153506219514144
avg test loss is  3.4886778877742253
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8631, device='cuda:3')
compute_distance is  tensor(1374.5621, device='cuda:3')
compute_norm is  tensor(211.9884, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.472357451280297
avg test loss is  2.9198631376091604
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8631, device='cuda:3')
compute_distance is  tensor(1370.0260, device='cuda:3')
compute_norm is  tensor(210.2792, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.064170804359257
avg test loss is  3.3098199405649833
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8631, device='cuda:3')
compute_distance is  tensor(1366.5670, device='cuda:3')
compute_norm is  tensor(209.8519, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(1362.9888, device='cuda:3')
test similarity is  tensor(0.8631, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.488238346856286
test entropy is  0.9141027552486737
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.9140472169369777
avg test loss is  3.488146877746338
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8631, device='cuda:3')
compute_distance is  tensor(1362.9888, device='cuda:3')
compute_norm is  tensor(209.0820, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.467967158187427
avg test loss is  2.9227516613026925
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8631, device='cuda:3')
compute_distance is  tensor(1358.8243, device='cuda:3')
compute_norm is  tensor(207.3798, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.0662794025467912
avg test loss is  3.307042667606492
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8631, device='cuda:3')
compute_distance is  tensor(1355.6603, device='cuda:3')
compute_norm is  tensor(206.9644, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9148927458695003
avg test loss is  3.486915653194192
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8631, device='cuda:3')
compute_distance is  tensor(1352.3668, device='cuda:3')
compute_norm is  tensor(206.2120, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.4649362044293743
avg test loss is  2.92519009825009
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8631, device='cuda:3')
compute_distance is  tensor(1348.4921, device='cuda:3')
compute_norm is  tensor(204.5192, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(1345.6136, device='cuda:3')
test similarity is  tensor(0.8631, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.302132382067536
test entropy is  1.070125832105242
________________________________
final entropy
++++++++++++++++++++
after training  0
avg test entropy is  1.0698428846625632
avg test loss is  3.302836468224841
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8631, device='cuda:3')
compute_distance is  tensor(1345.6136, device='cuda:3')
compute_norm is  tensor(204.1166, device='cuda:3')
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 3.313079357147217
mal norm is  tensor(53.0086, device='cuda:3')
mal distance is  tensor(1342.6458, device='cuda:3')
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [24]
alphas 3 is [1.  0.5]
alphas is  [0.66666667 0.33333333]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
 benign loss is  2.313098430633545
benign distance is  tensor(1.8378, device='cuda:3')
norm1 res is  tensor(0.0191, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  2.3592023849487305
benign distance is  tensor(1.7608, device='cuda:3')
norm1 res is  tensor(0.0173, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  2.3371310234069824
benign distance is  tensor(1.7304, device='cuda:3')
norm1 res is  tensor(0.0156, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  2.3056693077087402
benign distance is  tensor(1.7803, device='cuda:3')
norm1 res is  tensor(0.0188, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  2.281364679336548
benign distance is  tensor(1.9967, device='cuda:3')
norm1 res is  tensor(0.0196, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  2.302849292755127
benign distance is  tensor(1.9154, device='cuda:3')
norm1 res is  tensor(0.0222, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  2.302792549133301
benign distance is  tensor(1.8003, device='cuda:3')
norm1 res is  tensor(0.0176, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  2.3298137187957764
benign distance is  tensor(1.8670, device='cuda:3')
norm1 res is  tensor(0.0182, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  2.36106014251709
benign distance is  tensor(1.9344, device='cuda:3')
norm1 res is  tensor(0.0222, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  2.3222196102142334
benign distance is  tensor(1.8873, device='cuda:3')
norm1 res is  tensor(0.0194, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  2.3183155059814453
benign distance is  tensor(1.9011, device='cuda:3')
norm1 res is  tensor(0.0220, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  2.3454771041870117
benign distance is  tensor(2.0928, device='cuda:3')
norm1 res is  tensor(0.0237, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  2.32808518409729
benign distance is  tensor(1.7025, device='cuda:3')
norm1 res is  tensor(0.0160, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  2.323953151702881
benign distance is  tensor(1.8707, device='cuda:3')
norm1 res is  tensor(0.0229, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  2.34196400642395
benign distance is  tensor(1.7847, device='cuda:3')
norm1 res is  tensor(0.0204, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  2.263362169265747
benign distance is  tensor(1.8234, device='cuda:3')
norm1 res is  tensor(0.0200, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(1533.3069, device='cuda:3')
compute norm is  tensor(93.7405, device='cuda:3')
compute distance is  tensor(1533.2412, device='cuda:3')
compute norm is  tensor(93.7540, device='cuda:3')
compute distance is  tensor(1533.1339, device='cuda:3')
compute norm is  tensor(93.7808, device='cuda:3')
compute distance is  tensor(1533.2587, device='cuda:3')
compute norm is  tensor(93.7555, device='cuda:3')
compute distance is  tensor(1533.0787, device='cuda:3')
compute norm is  tensor(93.7473, device='cuda:3')
compute distance is  tensor(1533.1072, device='cuda:3')
compute norm is  tensor(93.7564, device='cuda:3')
compute distance is  tensor(1533.1958, device='cuda:3')
compute norm is  tensor(93.7398, device='cuda:3')
compute distance is  tensor(1533.2612, device='cuda:3')
compute norm is  tensor(93.7981, device='cuda:3')
compute distance is  tensor(1533.0848, device='cuda:3')
compute norm is  tensor(93.7201, device='cuda:3')
compute distance is  tensor(1533.2062, device='cuda:3')
compute norm is  tensor(93.7204, device='cuda:3')
compute distance is  tensor(1533.1183, device='cuda:3')
compute norm is  tensor(93.7687, device='cuda:3')
compute distance is  tensor(1533.3356, device='cuda:3')
compute norm is  tensor(93.7997, device='cuda:3')
distance Threshold  is  tensor(1533.3356, device='cuda:3')
________________________________
test distance is  tensor(1106365.6250, device='cuda:3')
test similarity is  tensor(0.4021, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.353125387155661e+17
test entropy is  0.0
________________________________
cal ratio is  0.033505165703869084
cal_distance is  tensor(37068.9609, device='cuda:3')
cal ratio is  0.18304417034256168
cal_distance is  tensor(6785.2642, device='cuda:3')
cal ratio is  0.4278364080724592
cal_distance is  tensor(2902.9875, device='cuda:3')
cal ratio is  0.6540915442013053
cal_distance is  tensor(1898.8219, device='cuda:3')
cal ratio is  0.8087587669168603
cal_distance is  tensor(1535.6902, device='cuda:3')
cal ratio is  0.8993097638719466
cal_distance is  tensor(1381.0619, device='cuda:3')
________________________________
test distance is  tensor(1381.0619, device='cuda:3')
test similarity is  tensor(0.8744, device='cuda:3')
test acc is  0.096400000156332
test loss is 47156.230066881
test entropy is  0.07467367826465422
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07495692464561711
avg test loss is  47166.19973410015
avg accuracy is  0.096350000156332
solo acc is  0.09840000015633198
compute similarity  is  tensor(0.8744, device='cuda:3')
compute_distance is  tensor(1381.0619, device='cuda:3')
compute_norm is  tensor(214.3587, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.5663335850752238
avg test loss is  2.843792143152721
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0405, device='cuda:3')
compute_distance is  tensor(49954568., device='cuda:3')
compute_norm is  tensor(5690331.5000, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.9621017605129843
avg test loss is  3.4649182847822146
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0405, device='cuda:3')
compute_distance is  tensor(49720832., device='cuda:3')
compute_norm is  tensor(5663705., device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.5311221613812802
avg test loss is  2.871872269522661
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0405, device='cuda:3')
compute_distance is  tensor(49488188., device='cuda:3')
compute_norm is  tensor(5637205., device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.1532897438321794
avg test loss is  3.2138705357813886
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0405, device='cuda:3')
compute_distance is  tensor(49256632., device='cuda:3')
compute_norm is  tensor(5610829., device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(49026176., device='cuda:3')
test similarity is  tensor(0.0405, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.409020263503101
test entropy is  0.9764061558094106
________________________________
cal ratio is  0.005033233935129447
cal_distance is  tensor(246760.2188, device='cuda:3')
cal ratio is  0.07094528516432402
cal_distance is  tensor(17506.4727, device='cuda:3')
cal ratio is  0.26635557836634144
cal_distance is  tensor(4662.9453, device='cuda:3')
cal ratio is  0.5160965358648547
cal_distance is  tensor(2406.5293, device='cuda:3')
cal ratio is  0.7183987094882163
cal_distance is  tensor(1728.8472, device='cuda:3')
cal ratio is  0.8475841287615996
cal_distance is  tensor(1465.3433, device='cuda:3')
________________________________
test distance is  tensor(1465.3433, device='cuda:3')
test similarity is  tensor(0.4898, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.4475919798747308
test entropy is  2.108182137963106
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.108431858802909
avg test loss is  2.4481892939061245
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4898, device='cuda:3')
compute_distance is  tensor(1465.3433, device='cuda:3')
compute_norm is  tensor(274.5724, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.0510438049017494
avg test loss is  3.325276820390209
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4899, device='cuda:3')
compute_distance is  tensor(1463.7407, device='cuda:3')
compute_norm is  tensor(273.8344, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.9061317426055225
avg test loss is  3.4996576443918226
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4899, device='cuda:3')
compute_distance is  tensor(1463.5231, device='cuda:3')
compute_norm is  tensor(272.7581, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.4748348293782296
avg test loss is  2.917165257529155
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4899, device='cuda:3')
compute_distance is  tensor(1462.7352, device='cuda:3')
compute_norm is  tensor(270.7423, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.059369976205358
avg test loss is  3.3158111770524146
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4899, device='cuda:3')
compute_distance is  tensor(1463.6326, device='cuda:3')
compute_norm is  tensor(270.0467, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(1464.7195, device='cuda:3')
test similarity is  tensor(0.4899, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.4947411063383385
test entropy is  0.9094755479903109
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.9099363026969722
avg test loss is  3.493653574477889
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4899, device='cuda:3')
compute_distance is  tensor(1464.7195, device='cuda:3')
compute_norm is  tensor(268.9966, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.471469386427133
avg test loss is  2.920092695811664
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4899, device='cuda:3')
compute_distance is  tensor(1465.2230, device='cuda:3')
compute_norm is  tensor(266.9980, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.0629010627518838
avg test loss is  3.310614731266046
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4899, device='cuda:3')
compute_distance is  tensor(1467.0800, device='cuda:3')
compute_norm is  tensor(266.3182, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9121748473344327
avg test loss is  3.4905696975142715
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4899, device='cuda:3')
compute_distance is  tensor(1468.8876, device='cuda:3')
compute_norm is  tensor(265.2891, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.4681291140472965
avg test loss is  2.9226721400645244
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4899, device='cuda:3')
compute_distance is  tensor(1469.9570, device='cuda:3')
compute_norm is  tensor(263.3059, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(1472.1575, device='cuda:3')
test similarity is  tensor(0.4899, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.3064239208123833
test entropy is  1.0661811373635395
________________________________
final entropy
++++++++++++++++++++
after training  0
avg test entropy is  1.065575508166478
avg test loss is  3.3076715286352485
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.4899, device='cuda:3')
compute_distance is  tensor(1472.1575, device='cuda:3')
compute_norm is  tensor(262.6421, device='cuda:3')
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 3.268371105194092
mal norm is  tensor(155.1532, device='cuda:3')
mal distance is  tensor(1474.2493, device='cuda:3')
curent length is  20
the length of epoch_weights is  1
the length of weights_d is  1
alpha 1 is [24]
alphas 3 is [1.         0.33333333]
alphas is  [0.75 0.25]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
 benign loss is  2.339632511138916
benign distance is  tensor(2.0415, device='cuda:3')
norm1 res is  tensor(0.0212, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  2.3247294425964355
benign distance is  tensor(2.0638, device='cuda:3')
norm1 res is  tensor(0.0207, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  2.3173468112945557
benign distance is  tensor(2.0944, device='cuda:3')
norm1 res is  tensor(0.0198, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  2.2952449321746826
benign distance is  tensor(2.1235, device='cuda:3')
norm1 res is  tensor(0.0208, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  2.319047212600708
benign distance is  tensor(2.1294, device='cuda:3')
norm1 res is  tensor(0.0216, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  2.3329648971557617
benign distance is  tensor(1.9720, device='cuda:3')
norm1 res is  tensor(0.0208, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  2.3326468467712402
benign distance is  tensor(2.0142, device='cuda:3')
norm1 res is  tensor(0.0200, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  2.3444080352783203
benign distance is  tensor(2.0047, device='cuda:3')
norm1 res is  tensor(0.0242, device='cuda:3')
current submit client idx and staleness is  16 3
 benign loss is  2.3029942512512207
benign distance is  tensor(1.9742, device='cuda:3')
norm1 res is  tensor(0.0168, device='cuda:3')
current submit client idx and staleness is  17 3
 benign loss is  2.2748427391052246
benign distance is  tensor(2.0013, device='cuda:3')
norm1 res is  tensor(0.0181, device='cuda:3')
current submit client idx and staleness is  18 3
 benign loss is  2.220188617706299
benign distance is  tensor(2.0969, device='cuda:3')
norm1 res is  tensor(0.0195, device='cuda:3')
current submit client idx and staleness is  19 3
 benign loss is  2.34039568901062
benign distance is  tensor(1.8915, device='cuda:3')
norm1 res is  tensor(0.0178, device='cuda:3')
current submit client idx and staleness is  20 3
 benign loss is  2.3604798316955566
benign distance is  tensor(2.2599, device='cuda:3')
norm1 res is  tensor(0.0232, device='cuda:3')
current submit client idx and staleness is  21 3
 benign loss is  2.3350894451141357
benign distance is  tensor(2.0536, device='cuda:3')
norm1 res is  tensor(0.0227, device='cuda:3')
current submit client idx and staleness is  22 3
 benign loss is  2.315356969833374
benign distance is  tensor(2.1674, device='cuda:3')
norm1 res is  tensor(0.0233, device='cuda:3')
current submit client idx and staleness is  23 3
 benign loss is  2.281919479370117
benign distance is  tensor(2.1329, device='cuda:3')
norm1 res is  tensor(0.0189, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(1867.2830, device='cuda:3')
compute norm is  tensor(101.8442, device='cuda:3')
compute distance is  tensor(1867.1527, device='cuda:3')
compute norm is  tensor(101.8167, device='cuda:3')
compute distance is  tensor(1867.0793, device='cuda:3')
compute norm is  tensor(101.8424, device='cuda:3')
compute distance is  tensor(1867.2802, device='cuda:3')
compute norm is  tensor(101.8429, device='cuda:3')
compute distance is  tensor(1867.1499, device='cuda:3')
compute norm is  tensor(101.7524, device='cuda:3')
compute distance is  tensor(1867.0203, device='cuda:3')
compute norm is  tensor(101.7867, device='cuda:3')
compute distance is  tensor(1867.2006, device='cuda:3')
compute norm is  tensor(101.8074, device='cuda:3')
compute distance is  tensor(1867.2307, device='cuda:3')
compute norm is  tensor(101.7645, device='cuda:3')
compute distance is  tensor(1867.0117, device='cuda:3')
compute norm is  tensor(101.7669, device='cuda:3')
compute distance is  tensor(1867.0969, device='cuda:3')
compute norm is  tensor(101.7904, device='cuda:3')
compute distance is  tensor(1867.0789, device='cuda:3')
compute norm is  tensor(101.7684, device='cuda:3')
compute distance is  tensor(1867.2938, device='cuda:3')
compute norm is  tensor(101.8336, device='cuda:3')
distance Threshold  is  tensor(1867.2938, device='cuda:3')
________________________________
test distance is  tensor(1106698.7500, device='cuda:3')
test similarity is  tensor(0.2379, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.355731726427831e+17
test entropy is  0.0
________________________________
cal ratio is  0.036968695708794845
cal_distance is  tensor(40913.2227, device='cuda:3')
cal ratio is  0.19227241873024659
cal_distance is  tensor(7866.4907, device='cuda:3')
cal ratio is  0.4384886205157963
cal_distance is  tensor(3449.3711, device='cuda:3')
cal ratio is  0.6621843022174322
cal_distance is  tensor(2284.1218, device='cuda:3')
cal ratio is  0.8137466374340989
cal_distance is  tensor(1858.6979, device='cuda:3')
________________________________
test distance is  tensor(1858.6979, device='cuda:3')
test similarity is  tensor(0.8511, device='cuda:3')
test acc is  0.09670000015633198
test loss is 53211.18171766724
test entropy is  0.0002156166308992799
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0001746129722484602
avg test loss is  53051.52060151253
avg accuracy is  0.09561666682299866
solo acc is  0.10018333348966531
compute similarity  is  tensor(0.8511, device='cuda:3')
compute_distance is  tensor(1858.6979, device='cuda:3')
compute_norm is  tensor(275.7526, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.5295560272263566
avg test loss is  2.874477293191434
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0067, device='cuda:3')
compute_distance is  tensor(4748555.5000, device='cuda:3')
compute_norm is  tensor(247511.1250, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.0280475007699752
avg test loss is  3.348475097593214
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0067, device='cuda:3')
compute_distance is  tensor(4726341.5000, device='cuda:3')
compute_norm is  tensor(246353.2500, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9160452392309714
avg test loss is  3.4833895824611316
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0067, device='cuda:3')
compute_distance is  tensor(4704230.5000, device='cuda:3')
compute_norm is  tensor(245200.7812, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.4264497097367164
avg test loss is  2.958309109022877
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(-0.0067, device='cuda:3')
compute_distance is  tensor(4682222.5000, device='cuda:3')
compute_norm is  tensor(244052.9062, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(4660318., device='cuda:3')
test similarity is  tensor(-0.0067, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.2726616091819714
test entropy is  1.0963675791520808
________________________________
cal ratio is  0.018015281746065114
cal_distance is  tensor(83956.9297, device='cuda:3')
cal ratio is  0.13422103228199567
cal_distance is  tensor(11268.7832, device='cuda:3')
cal ratio is  0.3663619226105253
cal_distance is  tensor(4128.4526, device='cuda:3')
cal ratio is  0.6052784050795781
cal_distance is  tensor(2498.8623, device='cuda:3')
cal ratio is  0.7779965604924268
cal_distance is  tensor(1944.1060, device='cuda:3')
cal ratio is  0.8820412107298855
cal_distance is  tensor(1714.7814, device='cuda:3')
________________________________
test distance is  tensor(1714.7814, device='cuda:3')
test similarity is  tensor(0.8505, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.648108450588641
test entropy is  1.8248475013511267
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.8249016950633734
avg test loss is  2.648174006547501
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8505, device='cuda:3')
compute_distance is  tensor(1714.7814, device='cuda:3')
compute_norm is  tensor(220.6349, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.0008499448868766
avg test loss is  3.3829305327014882
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8505, device='cuda:3')
compute_distance is  tensor(1712.5040, device='cuda:3')
compute_norm is  tensor(220.0521, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.8889014766668715
avg test loss is  3.521940265637217
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8505, device='cuda:3')
compute_distance is  tensor(1710.5223, device='cuda:3')
compute_norm is  tensor(219.1872, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.4722794002053072
avg test loss is  2.9193438451681564
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8505, device='cuda:3')
compute_distance is  tensor(1708.1384, device='cuda:3')
compute_norm is  tensor(217.3969, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.0582272573066418
avg test loss is  3.3168550577245033
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8505, device='cuda:3')
compute_distance is  tensor(1706.7042, device='cuda:3')
compute_norm is  tensor(216.9528, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(1705.4092, device='cuda:3')
test similarity is  tensor(0.8505, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.494845135888057
test entropy is  0.9089807196339564
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.9089844963952168
avg test loss is  3.4952877701472627
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8505, device='cuda:3')
compute_distance is  tensor(1705.4092, device='cuda:3')
compute_norm is  tensor(216.1522, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.4710867871353621
avg test loss is  2.9206043733462597
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8505, device='cuda:3')
compute_distance is  tensor(1703.5933, device='cuda:3')
compute_norm is  tensor(214.3951, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.062239648817953
avg test loss is  3.311133325735389
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8505, device='cuda:3')
compute_distance is  tensor(1702.5574, device='cuda:3')
compute_norm is  tensor(213.9659, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9117863323769844
avg test loss is  3.491007963731599
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8505, device='cuda:3')
compute_distance is  tensor(1701.6124, device='cuda:3')
compute_norm is  tensor(213.1828, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.4683419262676605
avg test loss is  2.9226022470734523
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8505, device='cuda:3')
compute_distance is  tensor(1700.1539, device='cuda:3')
compute_norm is  tensor(211.4376, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(1699.4246, device='cuda:3')
test similarity is  tensor(0.8505, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.3071127278464183
test entropy is  1.0653880887956761
________________________________
final entropy
++++++++++++++++++++
after training  0
avg test entropy is  1.0656959803373829
avg test loss is  3.307181579217728
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8505, device='cuda:3')
compute_distance is  tensor(1699.4246, device='cuda:3')
compute_norm is  tensor(211.0209, device='cuda:3')
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 3.300910234451294
mal norm is  tensor(72.1076, device='cuda:3')
mal distance is  tensor(1698.7577, device='cuda:3')
curent length is  20
the length of epoch_weights is  2
the length of weights_d is  2
alpha 1 is [24, 26]
alphas 3 is [1.   0.25 0.5 ]
alphas is  [0.57142857 0.14285714 0.28571429]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
 benign loss is  2.3425097465515137
benign distance is  tensor(2.0077, device='cuda:3')
norm1 res is  tensor(0.0186, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  2.3228659629821777
benign distance is  tensor(2.0667, device='cuda:3')
norm1 res is  tensor(0.0205, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  2.3153507709503174
benign distance is  tensor(2.0426, device='cuda:3')
norm1 res is  tensor(0.0206, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  2.292069435119629
benign distance is  tensor(2.0834, device='cuda:3')
norm1 res is  tensor(0.0212, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  2.316462278366089
benign distance is  tensor(1.9693, device='cuda:3')
norm1 res is  tensor(0.0210, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  2.2760307788848877
benign distance is  tensor(2.0182, device='cuda:3')
norm1 res is  tensor(0.0227, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  2.2999582290649414
benign distance is  tensor(1.8309, device='cuda:3')
norm1 res is  tensor(0.0186, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  2.253826856613159
benign distance is  tensor(2.0021, device='cuda:3')
norm1 res is  tensor(0.0219, device='cuda:3')
current submit client idx and staleness is  8 2
 benign loss is  2.3117270469665527
benign distance is  tensor(2.0391, device='cuda:3')
norm1 res is  tensor(0.0220, device='cuda:3')
current submit client idx and staleness is  9 2
 benign loss is  2.375626564025879
benign distance is  tensor(2.1532, device='cuda:3')
norm1 res is  tensor(0.0233, device='cuda:3')
current submit client idx and staleness is  10 2
 benign loss is  2.2901878356933594
benign distance is  tensor(2.1425, device='cuda:3')
norm1 res is  tensor(0.0204, device='cuda:3')
current submit client idx and staleness is  11 2
 benign loss is  2.3350043296813965
benign distance is  tensor(2.0580, device='cuda:3')
norm1 res is  tensor(0.0206, device='cuda:3')
current submit client idx and staleness is  12 2
 benign loss is  2.3457396030426025
benign distance is  tensor(2.1260, device='cuda:3')
norm1 res is  tensor(0.0203, device='cuda:3')
current submit client idx and staleness is  13 2
 benign loss is  2.2652461528778076
benign distance is  tensor(1.9299, device='cuda:3')
norm1 res is  tensor(0.0185, device='cuda:3')
current submit client idx and staleness is  14 2
 benign loss is  2.312901258468628
benign distance is  tensor(2.1479, device='cuda:3')
norm1 res is  tensor(0.0215, device='cuda:3')
current submit client idx and staleness is  15 2
 benign loss is  2.2867023944854736
benign distance is  tensor(2.0507, device='cuda:3')
norm1 res is  tensor(0.0197, device='cuda:3')
current submit client idx and staleness is  24 4
 benign loss is  2.3267529010772705
benign distance is  tensor(2.0242, device='cuda:3')
norm1 res is  tensor(0.0203, device='cuda:3')
current submit client idx and staleness is  25 4
 benign loss is  2.3220865726470947
benign distance is  tensor(2.4300, device='cuda:3')
norm1 res is  tensor(0.0232, device='cuda:3')
current submit client idx and staleness is  26 4
 benign loss is  2.3464839458465576
benign distance is  tensor(2.0552, device='cuda:3')
norm1 res is  tensor(0.0215, device='cuda:3')
current submit client idx and staleness is  27 4
 benign loss is  2.351102113723755
benign distance is  tensor(2.1995, device='cuda:3')
norm1 res is  tensor(0.0208, device='cuda:3')
current submit client idx and staleness is  28 4
 benign loss is  2.3053319454193115
benign distance is  tensor(1.8685, device='cuda:3')
norm1 res is  tensor(0.0175, device='cuda:3')
current submit client idx and staleness is  29 4
 benign loss is  2.282858371734619
benign distance is  tensor(2.0136, device='cuda:3')
norm1 res is  tensor(0.0224, device='cuda:3')
current submit client idx and staleness is  30 4
 benign loss is  2.357302188873291
benign distance is  tensor(2.0202, device='cuda:3')
norm1 res is  tensor(0.0205, device='cuda:3')
current submit client idx and staleness is  31 4
 benign loss is  2.3387527465820312
benign distance is  tensor(2.0270, device='cuda:3')
norm1 res is  tensor(0.0215, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(2328.8521, device='cuda:3')
compute norm is  tensor(122.1259, device='cuda:3')
compute distance is  tensor(2328.8379, device='cuda:3')
compute norm is  tensor(122.1501, device='cuda:3')
compute distance is  tensor(2328.7319, device='cuda:3')
compute norm is  tensor(122.0913, device='cuda:3')
compute distance is  tensor(2328.8298, device='cuda:3')
compute norm is  tensor(122.0868, device='cuda:3')
compute distance is  tensor(2328.8665, device='cuda:3')
compute norm is  tensor(122.0893, device='cuda:3')
compute distance is  tensor(2328.7078, device='cuda:3')
compute norm is  tensor(122.0045, device='cuda:3')
compute distance is  tensor(2328.7700, device='cuda:3')
compute norm is  tensor(122.1139, device='cuda:3')
compute distance is  tensor(2328.8511, device='cuda:3')
compute norm is  tensor(122.1256, device='cuda:3')
compute distance is  tensor(2328.8579, device='cuda:3')
compute norm is  tensor(122.0856, device='cuda:3')
compute distance is  tensor(2328.7930, device='cuda:3')
compute norm is  tensor(122.0699, device='cuda:3')
compute distance is  tensor(2328.7690, device='cuda:3')
compute norm is  tensor(122.0503, device='cuda:3')
compute distance is  tensor(2328.7935, device='cuda:3')
compute norm is  tensor(122.1195, device='cuda:3')
distance Threshold  is  tensor(2328.8665, device='cuda:3')
________________________________
test distance is  tensor(1106731.3750, device='cuda:3')
test similarity is  tensor(0.2665, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.357056726585961e+17
test entropy is  0.0
________________________________
cal ratio is  0.04128513430952951
cal_distance is  tensor(45691.5625, device='cuda:3')
cal ratio is  0.20318740876347427
cal_distance is  tensor(9283.9551, device='cuda:3')
cal ratio is  0.4507630316426228
cal_distance is  tensor(4184.8682, device='cuda:3')
cal ratio is  0.6713885253881943
cal_distance is  tensor(2809.6748, device='cuda:3')
cal ratio is  0.8193826538880723
cal_distance is  tensor(2302.2002, device='cuda:3')
________________________________
test distance is  tensor(2302.2002, device='cuda:3')
test similarity is  tensor(0.7694, device='cuda:3')
test acc is  0.09823333348966531
test loss is 46741.09778326559
test entropy is  0.00026189346487495957
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0002779705480237014
avg test loss is  46827.26558751999
avg accuracy is  0.09698333348966531
solo acc is  0.09848333348966531
compute similarity  is  tensor(0.7694, device='cuda:3')
compute_distance is  tensor(2302.2002, device='cuda:3')
compute_norm is  tensor(267.7144, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.5309277296320463
avg test loss is  2.872351767157695
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0365, device='cuda:3')
compute_distance is  tensor(1.1164e+09, device='cuda:3')
compute_norm is  tensor(1.2862e+08, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.167840600013733
avg test loss is  3.198266047404519
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0365, device='cuda:3')
compute_distance is  tensor(1.1112e+09, device='cuda:3')
compute_norm is  tensor(1.2802e+08, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.0337339639663696
avg test loss is  3.3404226465774243
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0365, device='cuda:3')
compute_distance is  tensor(1.1060e+09, device='cuda:3')
compute_norm is  tensor(1.2742e+08, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  0.9566972255706787
avg test loss is  3.429577935987444
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0365, device='cuda:3')
compute_distance is  tensor(1.1008e+09, device='cuda:3')
compute_norm is  tensor(1.2682e+08, device='cuda:3')
++++++++++++++++++++
change alpha
________________________________
test distance is  tensor(1.0957e+09, device='cuda:3')
test similarity is  tensor(0.0365, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.0318414664217657
test entropy is  1.3421008586883545
________________________________
cal ratio is  0.0013121353692916397
cal_distance is  tensor(1437642.7500, device='cuda:3')
cal ratio is  0.03622340830155194
cal_distance is  tensor(52076.3203, device='cuda:3')
cal ratio is  0.1903244845957638
cal_distance is  tensor(9911.3975, device='cuda:3')
cal ratio is  0.4362619715294067
cal_distance is  tensor(4323.9648, device='cuda:3')
cal ratio is  0.6605013727344222
cal_distance is  tensor(2855.9839, device='cuda:3')
cal ratio is  0.8127124776313243
cal_distance is  tensor(2321.0935, device='cuda:3')
________________________________
test distance is  tensor(2321.0935, device='cuda:3')
test similarity is  tensor(0.3972, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.7547277974675715
test entropy is  1.6799200234382645
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.6803897080390946
avg test loss is  2.7548466969146403
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3972, device='cuda:3')
compute_distance is  tensor(2321.0935, device='cuda:3')
compute_norm is  tensor(359.2568, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.0197861551094665
avg test loss is  3.360015405266524
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3973, device='cuda:3')
compute_distance is  tensor(2318.9419, device='cuda:3')
compute_norm is  tensor(358.0667, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.8962752180440086
avg test loss is  3.5118144570129006
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3973, device='cuda:3')
compute_distance is  tensor(2317.1743, device='cuda:3')
compute_norm is  tensor(356.5726, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.4707817079415961
avg test loss is  2.9207573869843473
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3972, device='cuda:3')
compute_distance is  tensor(2314.7305, device='cuda:3')
compute_norm is  tensor(354.1382, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.0607695142343354
avg test loss is  3.3131805111858634
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3973, device='cuda:3')
compute_distance is  tensor(2313.3440, device='cuda:3')
compute_norm is  tensor(353.0586, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(2311.9639, device='cuda:3')
test similarity is  tensor(0.3973, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.4914063322010325
test entropy is  0.9109087526035715
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.9114279361930229
avg test loss is  3.4912987772081454
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3973, device='cuda:3')
compute_distance is  tensor(2311.9639, device='cuda:3')
compute_norm is  tensor(351.6253, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.4696601331869423
avg test loss is  2.9213252649632597
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3972, device='cuda:3')
compute_distance is  tensor(2309.8870, device='cuda:3')
compute_norm is  tensor(349.2267, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.0640093316909855
avg test loss is  3.309038656098502
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3973, device='cuda:3')
compute_distance is  tensor(2308.7253, device='cuda:3')
compute_norm is  tensor(348.1706, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.9133765548785359
avg test loss is  3.487914784376555
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3973, device='cuda:3')
compute_distance is  tensor(2307.5527, device='cuda:3')
compute_norm is  tensor(346.7638, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.4670095034499666
avg test loss is  2.9235353281757215
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3972, device='cuda:3')
compute_distance is  tensor(2305.7222, device='cuda:3')
compute_norm is  tensor(344.3864, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(2304.7478, device='cuda:3')
test similarity is  tensor(0.3973, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.305528711154263
test entropy is  1.0669732602166215
________________________________
final entropy
++++++++++++++++++++
after training  0
avg test entropy is  1.066897831618913
avg test loss is  3.305501114076643
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.3973, device='cuda:3')
compute_distance is  tensor(2304.7478, device='cuda:3')
compute_norm is  tensor(343.3512, device='cuda:3')
++++++++++++++++++++
restore alpha
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 3.247074842453003
mal norm is  tensor(243.9534, device='cuda:3')
mal distance is  tensor(2303.7568, device='cuda:3')
curent length is  20
the length of epoch_weights is  0
alpha 1 is []
alphas 3 is [1.]
alphas is  [1.]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
 benign loss is  2.3311610221862793
benign distance is  tensor(2.7830, device='cuda:3')
norm1 res is  tensor(0.0308, device='cuda:3')
current submit client idx and staleness is  1 1
 benign loss is  2.289670944213867
benign distance is  tensor(2.6537, device='cuda:3')
norm1 res is  tensor(0.0280, device='cuda:3')
current submit client idx and staleness is  2 1
 benign loss is  2.3089993000030518
benign distance is  tensor(2.8659, device='cuda:3')
norm1 res is  tensor(0.0285, device='cuda:3')
current submit client idx and staleness is  3 1
 benign loss is  2.299605369567871
benign distance is  tensor(2.6124, device='cuda:3')
norm1 res is  tensor(0.0264, device='cuda:3')
current submit client idx and staleness is  4 1
 benign loss is  2.3336575031280518
benign distance is  tensor(2.7496, device='cuda:3')
norm1 res is  tensor(0.0313, device='cuda:3')
current submit client idx and staleness is  5 1
 benign loss is  2.312814235687256
benign distance is  tensor(2.7985, device='cuda:3')
norm1 res is  tensor(0.0287, device='cuda:3')
current submit client idx and staleness is  6 1
 benign loss is  2.302309513092041
benign distance is  tensor(2.7660, device='cuda:3')
norm1 res is  tensor(0.0276, device='cuda:3')
current submit client idx and staleness is  7 1
 benign loss is  2.2754809856414795
benign distance is  tensor(2.6069, device='cuda:3')
norm1 res is  tensor(0.0279, device='cuda:3')
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(3428.9983, device='cuda:3')
compute norm is  tensor(117.3398, device='cuda:3')
compute distance is  tensor(3429.0745, device='cuda:3')
compute norm is  tensor(117.3729, device='cuda:3')
compute distance is  tensor(3429.0020, device='cuda:3')
compute norm is  tensor(117.2948, device='cuda:3')
compute distance is  tensor(3429.0681, device='cuda:3')
compute norm is  tensor(117.3870, device='cuda:3')
compute distance is  tensor(3429.1230, device='cuda:3')
compute norm is  tensor(117.4208, device='cuda:3')
compute distance is  tensor(3428.9709, device='cuda:3')
compute norm is  tensor(117.4177, device='cuda:3')
compute distance is  tensor(3428.9934, device='cuda:3')
compute norm is  tensor(117.3332, device='cuda:3')
compute distance is  tensor(3429.0486, device='cuda:3')
compute norm is  tensor(117.3309, device='cuda:3')
compute distance is  tensor(3428.9966, device='cuda:3')
compute norm is  tensor(117.3402, device='cuda:3')
compute distance is  tensor(3429.0967, device='cuda:3')
compute norm is  tensor(117.3430, device='cuda:3')
compute distance is  tensor(3428.9912, device='cuda:3')
compute norm is  tensor(117.3792, device='cuda:3')
compute distance is  tensor(3429.0684, device='cuda:3')
compute norm is  tensor(117.3441, device='cuda:3')
distance Threshold  is  tensor(3429.1230, device='cuda:3')
________________________________
test distance is  tensor(1107527.7500, device='cuda:3')
test similarity is  tensor(0.0703, device='cuda:3')
test acc is  0.10000000015633198
test loss is 7.358187815838962e+17
test entropy is  0.0
________________________________
cal ratio is  0.05007912581707594
cal_distance is  tensor(55464.0273, device='cuda:3')
cal ratio is  0.22378364290748737
cal_distance is  tensor(12411.9473, device='cuda:3')
cal ratio is  0.47305766439064256
cal_distance is  tensor(5871.5708, device='cuda:3')
cal ratio is  0.6877916294070235
cal_distance is  tensor(4038.4197, device='cuda:3')
cal ratio is  0.8293317937484656
cal_distance is  tensor(3349.1912, device='cuda:3')
________________________________
test distance is  tensor(3349.1912, device='cuda:3')
test similarity is  tensor(0.8159, device='cuda:3')
test acc is  0.09976666682299863
test loss is 782330.854477612
test entropy is  0.0
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0
avg test loss is  783131.672641258
avg accuracy is  0.09836666682299865
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.8159, device='cuda:3')
compute_distance is  tensor(3349.1912, device='cuda:3')
compute_norm is  tensor(444.1932, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.428257419991849
avg test loss is  2.9576734423891566
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0243, device='cuda:3')
compute_distance is  tensor(32195858., device='cuda:3')
compute_norm is  tensor(2686922., device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.0457864585461647
avg test loss is  3.3272363488862253
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0243, device='cuda:3')
compute_distance is  tensor(32045220., device='cuda:3')
compute_norm is  tensor(2674350.5000, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  0.910587059981279
avg test loss is  3.4877199646252306
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0243, device='cuda:3')
compute_distance is  tensor(31895288., device='cuda:3')
compute_norm is  tensor(2661837.7500, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.4600338067835583
avg test loss is  2.9301576024687876
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.0243, device='cuda:3')
compute_distance is  tensor(31746052., device='cuda:3')
compute_norm is  tensor(2649382.5000, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(31597530., device='cuda:3')
test similarity is  tensor(0.0243, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.307161512659557
test entropy is  1.0635041171299624
________________________________
cal ratio is  0.009375781405282738
cal_distance is  tensor(296251.5312, device='cuda:3')
cal ratio is  0.09682862167606514
cal_distance is  tensor(28685.6250, device='cuda:3')
cal ratio is  0.31117298060897647
cal_distance is  tensor(8926.1885, device='cuda:3')
cal ratio is  0.5578289037584541
cal_distance is  tensor(4979.2852, device='cuda:3')
cal ratio is  0.7468795137787734
cal_distance is  tensor(3718.9258, device='cuda:3')
cal ratio is  0.8642219448082274
cal_distance is  tensor(3213.9766, device='cuda:3')
________________________________
test distance is  tensor(3213.9766, device='cuda:3')
test similarity is  tensor(0.6944, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.3197595371620485
test entropy is  1.054969948237893
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.0554558491147656
avg test loss is  3.318599285093198
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6944, device='cuda:3')
compute_distance is  tensor(3213.9766, device='cuda:3')
compute_norm is  tensor(409.8138, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  0.8932046472136654
avg test loss is  3.5139453187426017
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6944, device='cuda:3')
compute_distance is  tensor(3210.3586, device='cuda:3')
compute_norm is  tensor(408.0714, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  2
avg test entropy is  1.4616375378708342
avg test loss is  2.928007372660932
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6944, device='cuda:3')
compute_distance is  tensor(3207.8911, device='cuda:3')
compute_norm is  tensor(405.3835, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.0663733132866655
avg test loss is  3.306062391063552
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6944, device='cuda:3')
compute_distance is  tensor(3204.4893, device='cuda:3')
compute_norm is  tensor(404.0592, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  0.9152388971751687
avg test loss is  3.48508430340651
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6944, device='cuda:3')
compute_distance is  tensor(3202.0813, device='cuda:3')
compute_norm is  tensor(402.3930, device='cuda:3')
++++++++++++++++++++
change alpha
________________________________
test distance is  tensor(3200.4216, device='cuda:3')
test similarity is  tensor(0.6944, device='cuda:3')
test acc is  0.10000000015633198
test loss is 2.926952747139595
test entropy is  1.4629820420035422
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.4627428697878873
avg test loss is  2.927020804205937
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6944, device='cuda:3')
compute_distance is  tensor(3200.4216, device='cuda:3')
compute_norm is  tensor(399.7538, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  1
avg test entropy is  1.0706336606285973
avg test loss is  3.3008294438502426
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6944, device='cuda:3')
compute_distance is  tensor(3197.6812, device='cuda:3')
compute_norm is  tensor(398.4569, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  2
avg test entropy is  0.9179941716987187
avg test loss is  3.4811686902666397
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6944, device='cuda:3')
compute_distance is  tensor(3195.7793, device='cuda:3')
compute_norm is  tensor(396.8207, device='cuda:3')
++++++++++++++++++++
change alpha
++++++++++++++++++++
after training  3
avg test entropy is  1.4614242213621322
avg test loss is  2.9281494185360257
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6944, device='cuda:3')
compute_distance is  tensor(3194.5679, device='cuda:3')
compute_norm is  tensor(394.2066, device='cuda:3')
++++++++++++++++++++
restore alpha
++++++++++++++++++++
after training  4
avg test entropy is  1.0730795872999406
avg test loss is  3.297888072314801
avg accuracy is  0.10000000015633198
solo acc is  0.10000000015633198
compute similarity  is  tensor(0.6944, device='cuda:3')
compute_distance is  tensor(3192.3218, device='cuda:3')
compute_norm is  tensor(392.9344, device='cuda:3')
++++++++++++++++++++
restore alpha
________________________________
test distance is  tensor(3190.8533, device='cuda:3')
test similarity is  tensor(0.6944, device='cuda:3')
test acc is  0.10000000015633198
test loss is 3.4785997593072433
test entropy is  0.9197600483258904
________________________________
final entropy
reach max round
optimization failed
grad,shape is torch.Size([215370])
mal_acc is 0.1500000005
mal loss is 3.33000111579895
mal norm is  tensor(224.7257, device='cuda:3')
mal distance is  tensor(3190.8533, device='cuda:3')
curent length is  20
the length of epoch_weights is  4
the length of weights_d is  4
alpha 1 is [24, 25, 27, 28]
alphas 3 is [1.         0.16666667 0.2        0.33333333 0.5       ]
alphas is  [0.45454545 0.07575758 0.09090909 0.15151515 0.22727273]
median_weights acc is  0.1000000001570001
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 10.20% 

Test Accuracy: 10.00% 

 
 Results after 30 global rounds of training:
|---- Avg testing Accuracy across each device's data: 10.20%
|----0th round Training Accuracy : 89.36%
|----1th round Training Accuracy : 89.00%
|----2th round Training Accuracy : 89.07%
|----3th round Training Accuracy : 88.96%
|----4th round Training Accuracy : 89.04%
|----5th round Training Accuracy : 89.04%
|----6th round Training Accuracy : 77.55%
|----7th round Training Accuracy : 85.75%
|----8th round Training Accuracy : 66.91%
|----9th round Training Accuracy : 18.68%
|----10th round Training Accuracy : 12.62%
|----11th round Training Accuracy : 10.20%
|----12th round Training Accuracy : 10.38%
|----13th round Training Accuracy : 10.21%
|----14th round Training Accuracy : 10.20%
|----15th round Training Accuracy : 10.20%
|----16th round Training Accuracy : 10.20%
|----17th round Training Accuracy : 10.20%
|----18th round Training Accuracy : 10.20%
|----19th round Training Accuracy : 10.20%
|----20th round Training Accuracy : 10.20%
|----21th round Training Accuracy : 10.20%
|----22th round Training Accuracy : 10.20%
|----23th round Training Accuracy : 10.20%
|----24th round Training Accuracy : 10.20%
|----25th round Training Accuracy : 10.20%
|----26th round Training Accuracy : 10.20%
|----27th round Training Accuracy : 10.20%
|----28th round Training Accuracy : 10.20%
|----29th round Training Accuracy : 10.20%
|----Final Test Accuracy: 10.00%
|----0th round Final Test Accuracy : 88.67%
|----1th round Final Test Accuracy : 88.22%
|----2th round Final Test Accuracy : 88.33%
|----3th round Final Test Accuracy : 88.25%
|----4th round Final Test Accuracy : 88.08%
|----5th round Final Test Accuracy : 88.15%
|----6th round Final Test Accuracy : 76.23%
|----7th round Final Test Accuracy : 84.74%
|----8th round Final Test Accuracy : 65.54%
|----9th round Final Test Accuracy : 18.29%
|----10th round Final Test Accuracy : 12.16%
|----11th round Final Test Accuracy : 10.00%
|----12th round Final Test Accuracy : 10.17%
|----13th round Final Test Accuracy : 10.00%
|----14th round Final Test Accuracy : 10.00%
|----15th round Final Test Accuracy : 10.00%
|----16th round Final Test Accuracy : 10.00%
|----17th round Final Test Accuracy : 10.00%
|----18th round Final Test Accuracy : 10.00%
|----19th round Final Test Accuracy : 10.00%
|----20th round Final Test Accuracy : 10.00%
|----21th round Final Test Accuracy : 10.00%
|----22th round Final Test Accuracy : 10.00%
|----23th round Final Test Accuracy : 10.00%
|----24th round Final Test Accuracy : 10.00%
|----25th round Final Test Accuracy : 10.00%
|----26th round Final Test Accuracy : 10.00%
|----27th round Final Test Accuracy : 10.00%
|----28th round Final Test Accuracy : 10.00%
|----29th round Final Test Accuracy : 10.00%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : resnet
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 30

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 17101.6147
